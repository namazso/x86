<!DOCTYPE html> <html lang="en">  <head>     <meta charset="utf-8">     <title>SYSENTER</title>     <link rel="stylesheet" href="styles.css">     <link rel="stylesheet" href="../intel.css"> </head>  <body>     <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="513.23999pt" height="623.9964pt" viewBox="0 0 513.23999 623.9964" sodipodi:docname="1404.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="348.24" inkscape:cy="395.83893" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg220" /><g transform="translate(-44.82,-68.882812)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="12" class="cA49CCA52 cD0BE81C2 c209E837B"><tspan y="-714" x="45.119999 51.655201 58.8144 65.473206 72.190804 80.172005 86.769608 93.427208 101.04481 110.82481 117.00241 123.42001 128.99881 133.80002 136.80002 143.33522 149.99283 155.56802 160.36923 167.08803 177.04683 180.04683 186.64922 193.00682 196.06682">SYSENTER—Fast System Call</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-626.34003" x="235.2 237.83939 243.59726 248.27646 252.23755 255.89984 261.59796 266.17657 270.18747 272.64758 278.28693 283.98505 286.50494 293.15524 298.73483 304.34927 307.8313 313.1091 318.867 324.50137 326.96152 332.53613 338.29004 342.66946 348.28391 353.86349 356.39035 362.08847">Instruction Operand Encoding</tspan><tspan y="-568.32007" x="45.120377 51.602345 57.207832 61.986641 66.486572 70.1399 72.657791 78.117867 82.078964 84.596855 90.202347">Description</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-552" x="45.119999 50.799 55.960499 61.363197 66.043198 71.731201 75.268204 80.623207 85.303207 87.707108 93.107109 95.57132 98.730316 104.13032 108.81032 112.34732 114.81152 119.49152 124.89153 127.34853 129.74522 132.20943 135.74643 141.20042 143.60432 149.00432 151.40822 153.86522 159.22021 164.53922 169.89421 172.35121 174.75511 180.47011 182.93431 187.61432 192.93332 197.61331 201.15031 206.55301 215.31631 217.72021 223.31822 227.15222 232.60622 237.28622 242.64122 248.23923 253.92723 257.70905 263.11176 265.51566 270.96967 274.80368 277.20758 281.0416 286.49561 292.18359 295.61969 298.07849 303.76828 309.12509 312.39389 314.85809 321.0069 326.5347 332.6835 338.36429 345.08908 350.62589 356.30667 362.55447 364.95837 367.41718 372.09897 374.50287 379.90466 382.30856 387.04886 392.44977 401.19955 406.79935 412.20114 417.89093 420.34973 425.80554 431.49533 433.89923 436.35803 442.04782 446.72961 450.2684 454.10419 459.79398 464.47577 468.01456 470.41125 475.87155 481.56134 484.02554 487.56433 492.96524 495.42944 501.57825 507.10605 513.25482 518.93561 525.09338 528.87518 533.13312 536.43524 538.83917 544.37598 550.0658 555.42261">Executes a fast call to a level 0 system procedure or routine. SYSENTER is a companion instruction to SYSEXIT. The </tspan><tspan y="-541.02002" x="45.119995 47.574295 53.259594 57.936893 61.471195 65.302498 70.987801 75.6651 79.199402 81.653702 87.105003 92.790306 95.493904 97.948204 102.6255 105.3894 110.79031 116.4297 119.964 122.4183 131.1636 133.6179 138.33121 143.6835 149.27881 152.04271 155.57701 161.02831 163.7319 169.32721 173.15851 178.4991 183.84061 186.29491 191.89021 197.24251 200.00641 203.54071 209.22601 214.57831 217.34221 226.08751 231.4848 236.8011 239.2554 248.0007 253.686 262.4313 265.19522 270.79053 276.14282 279.97412 283.13043 288.58173 292.41302 301.15833 306.55563 312.24094 316.85971 322.26242 324.96603 328.12775 333.58444 337.42114 340.12476 344.80746 350.12915 354.81186 358.35156 363.70926 372.45996 375.16357 379.84628 385.31018 387.70596 390.16205 394.84476 397.60867 400.77039 404.60709 410.06378 418.81448 421.5181 427.2088 431.89151 437.24921 441.08591 443.84982 448.53253 453.98923 459.58994 464.94763 467.71155 471.54825 477.23895 482.92966 488.57175 491.03143 496.72214 502.32285 505.08676 510.48947 514.02917 516.73273 522.33344 526.1701 528.56683 533.90833 536.36804 538.76385 544.16656 549.74658 555.10431">instruction is optimized to provide the maximum performance for system calls from user code running at privilege </tspan><tspan y="-529.97974" x="45.119995 47.579697 52.937397 58.159199 63.501598 65.961296 68.844894 74.562592 77.386787 80.926491 86.383194 89.266792 94.723495 100.3242 105.6819 109.4043 114.807 118.3467 120.7434 126.4449 132.04559 134.8698 139.55249 144.87419 149.55688 153.09659 158.45428 167.20499 170.02919 175.48589 179.32259 182.20619 187.56389 192.78569 198.14339 202.82608 208.51678 212.05649 214.51619 219.73799 225.09569 227.97929 233.57999 237.41669 242.87338 247.55608 252.91377 258.51447 264.15656 267.99866 273.35635 278.03906 280.86328 284.69998 290.39069 296.08139 301.77209 304.16879 309.8595 315.46021 318.34381 323.74652 327.28622 330.11044 335.71115 339.54785 341.94455 347.28604 349.74573 352.20541 357.56311 363.16382 368.52151 371.34573 373.80542 379.16312 384.38489 389.7876 392.1843 395.0679 400.78561">level 3 to operating system or executive procedures running at privilege level 0.</tspan><tspan y="-513.95972" x="45.119995 54.009296 59.694595 65.046898 70.732201 73.556404 78.908707 84.130508 89.482811 94.16011 99.845413 103.37971 108.73202 114.37141 117.13531 119.58961 125.27492 128.09911 131.8764 137.82001 141.8943 147.6066 153.31889 158.67119 161.49538 170.24068 175.69197 181.28728 186.63957 189.94167 192.76585 196.30016 201.98546 207.38815 210.15204 216.33594 221.85384 227.99814 233.67444 240.39474 245.92705 251.60335 257.84665 260.67087 263.12518 268.81049 273.48779 277.02209 280.85339 286.5387 291.216 294.75031 297.20462 302.65591 308.34122 311.0997 314.6358 318.29791 323.69702 329.38412 334.06323 336.51932 340.05542 342.45212 347.90521 353.59232 358.27142 361.09564 364.63174 370.31885 375.67294 378.49716 380.89386 386.35416 391.99356 394.39026 399.13055 404.53415 406.93085 409.75507 415.35217 419.18527 424.63837 429.31747 434.72018 439.39929 444.0784 449.53149 453.36459 456.12851 459.66461 465.11771 467.94193 473.65604 479.37015 483.44626 489.08566 491.54175 495.07785 497.84177 506.58887 512.04199 517.6391 523.04181 527.11792 529.88177 535.3349 538.87097 544.55804 549.91217 553.7453">When executed in IA-32e mode, the SYSENTER instruction transitions the logical processor to 64-bit mode; other-</tspan><tspan y="-502.97971" x="45.119995 52.473896 54.931797 59.612698 64.968597 68.236496 71.060692 74.598595 80.287498 85.690201 88.514397 90.972298 96.4272 102.0261 104.484 109.1649 114.5658 117.0237 119.8479 125.4468 129.28171 134.7366 139.41751 144.82021 149.5011 154.18201 159.6369 163.4718 166.29601 170.13091 175.4868 184.2357 189.6366 192.0945 197.7834 202.46429 205.2885 207.7464 213.4353 216.25951 221.85841 225.69331 231.14821 234.68611 240.08881 244.76881 248.30672 253.66261 259.26151 262.14511 270.89401 276.34891 281.94781 287.30371">wise, the logical processor remains in protected mode.</tspan><tspan y="-486.95972" x="45.119995 50.536194 54.368393 56.823593 62.275795 66.107994 68.932198 72.4674 77.919601 80.803207 86.15641 91.378212 96.731415 101.40961 107.09582 110.63102 113.08622 118.77242 124.36862 127.19283 130.72803 136.41423 141.76743 144.65103 150.79623 156.32043 162.50433 168.20134 174.92255 180.45575 186.13295 192.37715 195.20135 197.65656 203.34276 208.02097 211.55617 215.38837 221.07457 225.75278 229.28798 231.68468 237.14497 242.83118 246.13327 248.95747 253.63568 259.08789 262.24509 265.78027 273.03696 278.44055 282.27277 287.62598 290.50955 299.25574 304.97971 309.6543 313.18588 316.06949 320.74408 326.33667 331.68628 336.36087 338.81247 341.96606 347.27966 350.10388 353.63547 359.31805 364.66766 367.55127 373.14386 376.97247 379.42407 384.73767 387.18927 389.64087 394.99048 400.58307 405.93268 408.7569 411.2085 416.55811 421.8717 427.19971 429.65402 432.47824 438.19055 441.07416 445.75146 451.20276 456.79807 462.15036 465.03397 469.71127 475.06357 480.65887 489.40417 494.80688 500.44897 503.98328 506.86688 512.26416 517.94946 523.54474 526.42834 531.10565 536.50653 542.10181 547.4541">Prior to executing the SYSENTER instruction, software must specify the privilege level 0 code segment and code </tspan><tspan y="-475.97971" x="45.119995 50.477695 56.168396 59.708096 63.544796 68.866493 71.690689 77.291389 82.748093 85.207794 90.898491 94.438194 97.707893 100.59149 105.99419 111.68489 117.28559 120.16919 123.70889 129.3996 134.80229 137.6265 143.2272 147.0639 149.52361 154.84531 157.30501 159.70171 165.1044 170.6844 176.0421 178.9257 181.3224 186.7251 191.9469 197.28929 199.74899 202.5732 208.33589 211.1601 215.84279 219.38249 224.78519 229.46788 234.78958 237.61378 242.29648 247.69917 253.29987 262.05057 267.40826 273.09897 276.63867 279.46289 284.8656 290.5563 296.15701 298.85968 303.53967 307.07666 312.47665 317.15665 322.47565 325.29987 330.89786 336.35187 338.74857 344.45004 347.98703 353.34204 357.17606 360.05966 365.65765 370.97665 373.80087 381.15387 384.98788 387.38458 390.92426 393.38126 399.06924 404.66724 407.55084 412.65295 418.05655 420.51355 426.20154 431.55655 436.23654 439.12015 442.65714 448.11115 450.93536 454.47235 460.16034 465.51535 468.39896 471.55795 477.01196 479.46896 481.92596 487.37997 494.73297 497.18997 502.87796 508.47595 511.35956 518.93756 525.08453 531.33051 536.0105">entry point, and the privilege level 0 stack segment and stack pointer by writing values to the following MSRs:</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-460.98001" x="45.119999">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c89C0ADDA"><tspan y="-460.98001" x="62.099998 67.024796 73.981789 80.391586 86.751884 93.161682 99.517487 106.11899 112.53509 118.65419 126.27719 132.42599 138.5838 145.6326 151.9929 158.5197">IA32_SYSENTER_CS</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-460.98001" x="164.88 167.70419 171.77039 179.39249 185.52869 191.76389 194.64748 200.03668 205.62389 211.21109 215.03429 220.43698 225.10619 229.77539 232.59958 238.30377 244.06647 249.77066 256.50986 260.64896 263.47314 272.45334 275.27753 280.80173 286.47894 291.88165 294.70584 297.15204 302.59525 309.93744 315.34015 319.16336 322.04694 327.75113 333.45532 336.3389 341.92609 344.37228 347.8985 352.56769 355.45126 360.89447 364.04266 366.9003 370.44 376.08209 378.54178 383.22449 386.10809 393.68878 399.83847 406.13577 408.95999 414.3627 418.1994 423.5571 426.4407 429.98041 435.67111 441.02881 443.85303 448.53574 453.89343 459.49414 468.24484 473.60254 479.29324 482.83295 485.65717 490.33987 495.69757 498.09427 503.49698 508.17969 511.71939 517.17609 521.01276 523.83691 526.9986 532.45532 536.29199 539.11615 542.65582 548.3465 553.70422"> (MSR address 174H) — The lower 16 bits of this MSR are the segment selector for the </tspan><tspan y="-450" x="62.100006 67.700706 71.481606 73.941307 79.263008 81.72271 84.118507 89.520309 95.099411 100.45711 103.22011 105.67981 111.03751 116.25841 121.6602 124.1199 126.8226 132.5844 135.28709 140.02649 145.42648 151.02719 156.38489 159.14789 163.83058 169.18828 174.78897 183.53967 188.94147 194.58267 198.12238 201.39207 204.15508 209.69278 215.38348 217.84319 222.52588 225.28888 230.39008 235.79277 238.25247 243.94318 249.30087 252.06387 254.52357 259.20627 261.96927 267.37198 269.76776 274.45047 279.90717 282.67017 288.36087 293.04358 298.40128 304.00198 306.78033 310.31464 315.71552 318.47943 324.07474 329.42703 332.96133 338.31363 342.14493 350.89023 353.34454 359.02985 364.38214 367.14606 370.68036 376.36566 381.76837 384.53229 389.20959 394.56189 400.1572 408.9025 414.25479 419.94009 423.4744 426.23831 430.91562 436.26791 438.72223 444.07452 448.75183 452.28613 457.73743 461.56873 464.33264 469.78394 472.94025 475.70416 479.23846 484.92377 490.32648 493.09039 498.6857 502.517 504.97131 510.28763 512.74194 515.19623 520.54852 526.1438 531.54651 534.31042 536.70709 542.1098 547.3316 552.67401 555.1283">privilege level 0 code segment. This value is also used to determine the segment selector of the privilege level </tspan><tspan y="-438.95969" x="62.100021 67.817719 70.701317 75.384018 78.923721 84.326424 89.009125 94.330826 97.155022 101.83772 107.24042 112.84112 121.59182 126.94952 132.64023 136.17993 139.00412 143.08382 147.76651 153.12421 158.5269 161.35109 164.89079 170.5815 175.93919 178.82278 185.89949 191.50018 196.85788 200.58028 205.98297 209.52267 211.91937 217.37967 223.07037 225.95396 230.63666 235.99435 240.67705 244.21675 246.67645 252.13315 257.77524 261.85406 265.12378 267.948 273.48569 279.17639 281.57309 286.25311 289.13672 294.2388 299.6424 302.10208 307.79279 313.15048 316.03409 320.7168 326.11951 331.81021 337.4523 342.909 346.4487 349.33231 351.79199 357.43408 363.03479 365.49448 370.17719 375.5799 379.1196 384.47729 387.30151 392.70422 395.58783 401.27853 406.92062 409.38031 411.84 414.66422 419.34692 424.74963 427.14633 432.54904 437.23175 440.77145 446.22815 448.74994">0 stack segment (see the Operation section). This value cannot indicate a null selector.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-423.95999" x="45.119999">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c89C0ADDA"><tspan y="-423.95999" x="62.099998 67.022095 73.979088 80.386185 86.746483 93.15358 99.509384 106.11089 112.52699 118.64608 126.26908 132.41518 138.57028 145.61638 151.97668 158.09579 163.017">IA32_SYSENTER_EIP</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-423.95999" x="169.6203 172.50391 176.58272 184.14452 190.26811 196.50511 199.38872 204.81842 210.39842 215.97842 219.82051 225.20522 229.88522 234.56523 237.38943 243.13414 248.83655 254.53896 261.31506 265.39386 268.21805 277.23874 280.06293 285.62762 291.26974 296.65445 299.47864 304.64014 310.04373 312.49982 318.14194 323.52664 326.35083 331.83453 335.02322 337.84741 341.41412 347.13184 349.58792 354.26791 357.00031 364.57559 370.71988 376.96317 379.84677 382.2435 386.92349 389.8071 392.26141 397.71271 403.11002 408.70532 414.05762 419.65292 422.47714 424.93146 430.61676 434.15106 439.55194 442.43555 448.67883 452.45615 457.87146 460.75507 464.82938 468.36368 474.04898 479.73428 484.41159 487.6759 490.55951 494.09381 499.77911 502.23343 506.91074 509.79434 514.89648 520.30005 522.75433 528.43964 533.79193"> (MSR address 176H) — The value of this MSR is loaded into RIP (thus, this value </tspan><tspan y="-412.97998" x="62.100006 65.941208 71.303406 74.469604 79.831802 83.673004 89.035202 94.677299 99.417603 104.7798 109.467 112.2912 115.8354 121.53059 126.89279 129.7764 132.9426 135.33929 139.1805 143.86769 147.4119 150.2955 152.7597 158.40181 163.089 166.63321 170.47441 176.16962 180.85681 184.40102 186.86522 192.32642 198.02162 200.84583 206.30702 209.47322 212.29742 215.84163 221.53683 226.89903 229.72324 234.41043 239.77263 242.23683 247.59903 252.28622 255.83043 261.19263 266.79782 269.62201 275.08322 280.68842 286.05063 289.62 295.01639 298.54977 301.00317 306.68756 312.28195 315.16553 320.75992 324.59033 330.04074 334.71713 340.06854 345.66293 351.34732 355.17773 360.58044 363.40463 368.85504 372.68546 375.50964 379.34006 384.79047 390.47485 394.00824 396.46164 402.14603 407.49744 411.57083 414.83423 417.7178 421.4942 427.17859 430.00278 435.64218 439.48428 444.93469 448.46808 453.87079 458.55078 462.08417 467.43558 473.02997 475.91354 484.65796 490.10837 495.70276 501.05417 504.35626 507.18045 512.63086 518.31525 520.76868 526.08411">references the first instruction of the selected operating procedure or routine). In protected mode, only </tspan><tspan y="-401.99997" x="62.099991 67.711494 70.108192 73.658691 81.518387 87.246887 92.975388 97.065887 102.79439 105.61859 111.03209 114.87959 120.24809 123.0723 125.54279 131.0103 136.4238 142.03529 147.40379 153.01529">bits31:0 are loaded.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-387" x="45.119999">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c89C0ADDA"><tspan y="-387" x="62.099998 67.022095 73.979088 80.386185 86.746483 93.15358 99.509384 106.11089 112.52699 118.64608 126.26908 132.41518 138.57028 145.61638 151.97668 158.09579 164.5119">IA32_SYSENTER_ESP</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-387" x="171.11969 173.94388 178.01187 185.58087 191.76477 198.00177 200.82596 206.21696 211.85637 217.44537 221.27037 226.61636 231.28737 235.95837 238.84196 244.54796 250.25395 256.01663 262.75763 266.82562 269.70923 278.69122 281.57483 287.10083 292.77982 298.12582 301.00943 306.11154 311.51514 313.96313 319.64212 324.98813 327.87173 333.31674 336.46674 339.35034 342.87836 348.55734 350.95404 355.63403 358.49969 366.0741 372.2175 378.4599 381.28412 383.73752 388.41391 391.23813 393.69153 399.14194 404.53833 410.13272 415.53543 421.11542 423.99902 426.39572 432.0972 435.63058 441.08099 443.90521 450.20251 456.32611 461.74051 464.62411 468.69751 472.2309 477.91528 483.59967 488.27606 491.53946 494.42307 497.95645 503.64084 506.09424 510.77063 513.65424 518.75635 524.15997 526.6134 532.29779 537.64917"> (MSR address 175H) — The value of this MSR is loaded into RSP (thus, this value </tspan><tspan y="-375.95969" x="62.100006 66.778206 72.230408 77.916611 81.451813 86.850014 89.305214 94.991417 99.669617 102.13382 105.66902 111.35522 116.70843 119.23203 123.91023 127.44543 132.84363 137.52184 142.83904 145.36264 150.95885 156.41104 158.86624 164.55244 168.08765 173.44084 177.27304 179.73724 182.89444 188.34663 192.17883 194.64304 198.17824 203.86444 209.21764 211.74124 217.33745 221.16965 223.62485 228.94205 231.33875 233.79485 239.14804 244.78745 250.14064 252.60484 255.06004 260.41324 265.73044 271.08365 273.53885 276.00305 281.71625 284.23984 288.91803 292.45322 297.85141 302.51971 307.8432 311.92471 315.19623 317.71985 323.25934 328.95184 331.34854 336.02856 338.55219 343.71368 349.11731 351.51401 357.21552 362.57501 365.09863 369.78314 375.18765 380.88016 386.57266 391.97357 395.51508 398.0387 401.8772 407.23669 412.8392 416.6777 422.0372 426.72171 432.08121 437.77371 441.31522 443.77945 449.18396 451.70758 457.34967 462.80997 468.50247 472.58398 477.26849 482.673 488.36551 493.82401 499.51651 501.978 506.66251 512.06702 514.46368 516.9873 522.39178 527.99426 533.59674 537.37854 542.73804 547.42255 552.10706 555.37854">contains the stack pointer for the privilege level 0 stack). This value cannot represent a non-canonical address. </tspan><tspan y="-364.97968" x="62.100006 65.878204 71.564407 74.448013 80.044212 83.876411 89.328613 92.863815 98.217018 102.89522 106.43042 111.78362 117.42302 120.24722 128.99342 134.44562 140.04182 145.39502 148.69711 151.52132 156.97351 162.65971 165.11491 170.43211 173.25632 178.85252 181.30772 184.84293 192.70264 198.41583 204.12903 208.20422 213.96692 216.79112 222.18932 226.02151 231.37471 234.25832 236.71352 242.16571 247.5639 253.16011 258.51331 264.15271">In protected mode, only bits31:0 are loaded.</tspan><tspan y="-348.95969" x="45.119705 50.661007 56.355309 61.71661 66.402908 71.764206 74.588402 82.172699 88.325996 94.5783 99.264603 102.0888 106.7751 112.1814 117.8757 120.7593 126.3636 131.7249 134.60851 138.44881 143.8101 149.2164 154.82069 157.7043 160.8696 164.6514 170.11169 178.866 181.7496 187.1559 192.798 198.4023 201.2265 208.5858 212.4261 214.8228 218.42281 221.96611 227.32741 233.02171 235.84592 239.38922 244.84952 247.67372 253.36803 258.05432 260.51761 266.21191 271.81622 274.55939 280.80539 287.73538 295.35748 301.48108 307.72708 311.80408 320.69608 326.94208 334.56418 340.68777 346.93378 350.20078 353.02496 358.60318 364.24527 369.64798 372.47217 381.36417 387.61017 395.23227 401.35587 407.60187 410.48544 412.88214 418.58362 423.26361 426.8006 430.63461 436.3226 441.00259 444.53958 446.99658 452.45059 458.13858 460.96277 466.31778 472.00577 476.68576 482.37375 486.20776 491.56277 496.24277 499.12634 502.66333 508.35132 513.75134 517.28833 520.11255 523.64954 529.33752 534.6925">These MSRs can be read from and written to using RDMSR/WRMSR. The WRMSR instruction ensures that the </tspan><tspan y="-337.97968" x="45.11969 48.88979 55.02689 60.789589 66.49469 72.199791 78.38369 83.899788 90.036888 95.705986 102.41908 107.94418 113.61328 119.84938 125.55448 131.22359 134.99368 140.40178 143.28537 148.67548 154.35358 159.94168 162.76587 166.53596 172.71986 178.42496 184.13005 189.89275 196.02985 201.54594 207.72984 213.36655 220.14626 225.66415 231.33325 237.63055 243.33565 249.00475 255.14185 260.54996 263.43356 271.00168 277.13971 283.43701 288.117 290.94122 296.34302 298.80182 306.0585 311.40179 316.7226 321.40439 324.28799 328.96979 334.4256 340.11539 343.65417 349.05597 351.51477 357.15686 360.04047 364.72226 370.12405 375.81384 381.26965 386.91174 389.36786 394.04965 399.45145 401.91025 404.73447 410.13626 415.73605 421.33585 425.17163 430.52844 435.21024 439.89203 445.29474 449.97653">IA32_SYSENTER_EIP and IA32_SYSENTER_ESP MSRs always contain canonical addresses.</tspan><tspan y="-321.95969" x="45.119705 54.017105 59.710506 62.172905 64.569611 69.972305 72.376205 78.528603 84.060005 90.212402 95.896805 102.62521 108.1656 113.85001 120.10141 122.56561 124.96232 130.42262 135.82802 141.43141 146.11681 148.52071 152.06311 157.75652 163.11691 165.58112 171.85951 178.01192 180.47612 185.88152 191.52362 197.12701 199.53091 205.59422 211.77812 214.18202 218.86742 224.27011 226.66681 232.0695 236.7549 240.2973 245.7567 249.5961 254.28149 256.68539 264.04379 266.44049 270.04047 275.68256 278.14676 283.30826 288.71185 291.10855 296.7597 302.10751 306.84781 309.25171 314.8425 320.24521 324.07202 326.46872 331.78052 337.12833 342.71912 345.18332 348.33511 352.16193 357.60873 366.34955 368.81375 372.34354 378.02432 383.37213 385.83633 389.60913 395.74893 401.45673 407.21942 412.92722 419.06702 424.6452 430.7688 436.44061 443.1564 448.6842 454.35602 460.59482 466.30261 472.56842 478.70822 481.17242 488.74323 494.88303 501.18033 504.42212 506.88632 510.41611 516.09692 521.4447 523.84857 530.11438 536.25415 538.71832 544.11115 549.79193 555.38275">While SYSENTER loads the CS and SS selectors with values derived from the IA32_SYSENTER_CS MSR, the CS and </tspan><tspan y="-310.97968" x="45.11972 51.183022 57.306622 60.190224 65.788223 71.143227 75.823227 80.503227 84.337227 86.794228 92.392227 95.92923 101.38323 105.21723 108.10084 112.78084 118.18084 122.86084 128.54884 133.90384 138.58383 141.40802 146.80801 150.64201 156.04471">SS descriptor caches are </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c89C0ADDA"><tspan y="-310.97968" x="158.81943 165.23193 171.41943">not</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-310.97968" x="175.49913 178.32333 180.78123 186.23613 191.63702 197.23593 202.63863 208.21863 211.10223 214.26213 218.09703 223.55193 232.30083 235.12503 238.66293 244.35184 249.70773 252.59134 258.19025 263.59296 268.27386 272.95477 276.78967 279.18637 284.82578 288.36368 293.81857 297.65347 302.33438 305.1586 309.23651 311.6944 317.3833 320.20752 327.17441 333.89923 339.43512 342.31873 347.77362 351.60852 354.43274 359.43765 366.10217 371.63806 375.71597 378.54019 382.37509 387.73099 390.8909 396.2468 400.0817 405.48441 411.17331 415.85422 421.21011 426.80902 429.69263 435.29153 440.61145 443.49506 447.03296 452.72186 458.17676 462.85767 468.21356 471.03778 475.71869 481.1214 483.51718 488.91989 493.6008 497.1387 502.5936 506.4285 511.10941 514.37732 517.26093 521.04181 526.73071 531.41162 534.94952 540.30542 545.7063 551.30518 554.57306"> loaded from the descriptors (in GDT or LDT) referenced by those selectors. Instead, </tspan><tspan y="-299.99966" x="45.118835 48.657635 54.347435 59.704235 62.528439 68.128235 73.485031 78.166832 82.848633 86.684433 89.143234 94.743034 98.281837 103.73764 107.57344 110.45704 115.13884 120.54064 125.22244 130.86455 136.26724 140.94724 143.77142 149.17322 153.00902 158.36581 161.2494 163.70821 169.164 174.5658 180.16559 185.52238 191.12219 193.94638 201.30118 203.69788 207.23668 212.92648 215.81007 218.97087 221.42967 226.65147 231.99387 237.59366 240.41785 245.57935 250.98294 253.37964 259.08112 264.48383 269.16382 272.43262 275.31622 281.46503 286.82184 292.22455 295.04877 298.58755 304.27734 309.63416 312.51776 319.59357 325.19336 330.55017 334.21225 339.61404 343.15283 345.61163 351.06744 356.75723 359.58145 364.26324 369.66595 374.34775 377.88654 380.34534 385.74625 391.43604 394.31964 397.48044 402.93625 406.77203 409.65564 415.25543 420.61224 424.15103 429.55283 432.01163 434.47043 439.15222 442.42102 445.24524 449.02704 452.56583 455.44943 457.84613 462.52612 465.40973 468.94852 474.63831 479.99512 482.81934 486.65512 492.05783 496.73962 502.33942 507.79523 513.48505 518.16687 520.5636 526.16339 528.62219 531.01892 533.47504 536.95447 542.29596 545.12018 550.57599 553.73682">the descriptor caches are loaded with fixed values. See the Operation section for details. It is the responsibility of </tspan><tspan y="-288.95935" x="45.118835 52.193737 58.341637 61.225235 65.906136 71.361038 74.520935 78.058838 85.315536 90.719139 94.554039 99.956741 102.78094 106.31884 111.77374 114.65734 120.01324 125.70215 130.38306 136.02516 139.86006 145.26276 148.08696 151.62486 157.31377 162.71466 166.25256 169.13617 172.67407 178.31618 183.71887 186.54308 192.14198 197.54468 202.22559 206.90649 210.74139 213.1993 218.7982 222.33611 227.791 231.6259 236.30679 239.131 243.20889 245.66679 251.3557 254.1799 261.14679 267.87161 273.4075 276.23172 281.68661 285.52151 288.34573 293.35065 300.07547 305.61136 309.68927 312.51349 316.34839 321.7511 324.91101 330.31372 334.14862 339.50452 345.19342 349.87433 355.23022 360.82913 363.71274 369.31165 374.63153 377.45575 380.99365 386.68256 392.13745 396.81836 402.17426 405.05786 409.73877 415.09467 417.55255 422.90845 427.58936 431.12726 436.58215 440.41705 443.24127 448.40277 453.80637 456.26425 461.95316 467.30905 471.98996 474.81418 479.49509 484.94998 488.78488 492.61978 498.02249 502.7034 508.30231 513.7572 519.44611 525.04498 527.8692 531.4071 536.862 539.74561 543.28351 548.97241 554.32831">OS software to ensure that the descriptors (in GDT or LDT) referenced by those selector values correspond to the </tspan><tspan y="-277.97934" x="45.118835 48.281437 50.678139 55.89994 61.24234 66.843941 69.668137 74.829636 80.233238 82.69384 88.385437 93.744034 98.427635 101.25183 103.71243 109.17004 114.57364 120.17524 125.57793 131.15793 133.98213 136.44273 142.13434 145.67494 151.13254 153.95674 157.49734 163.18895 168.54755 171.43115 177.03275 182.43544 187.11903 191.80263 195.64023 198.03693 203.67632 207.21692 212.67451 216.51212 219.33632 224.01991 229.42351 234.1071 239.79871 245.1573 249.8409 253.92149 256.80508 260.34567 266.03726 271.39587 274.22006 280.37067 285.90027 292.05087 297.73346 304.46005 309.99866 315.68124 321.93085 324.81442 327.21112 332.9126 337.59619 341.13678 344.97437 350.66595 355.34955 358.89014 361.35074 366.80835 372.49994 375.32413 380.92572 386.38333 391.78604 396.46603 399.29022 404.98181 410.43942 413.98001 416.8042 422.20691 427.849 432.53259 438.22418 442.06177 447.42038 450.30396 453.84454 459.53613 461.99673 466.68033 469.50452 474.18811 479.64572 483.48331 487.32089 492.6795 497.3631 502.96469 508.3656 514.06708 519.6687 525.02728 530.71887 535.40247 540.76105">fixed values loaded into the descriptor caches; the SYSENTER instruction does not ensure this correspondence.</tspan><tspan y="-261.95935" x="45.118835 50.652035 56.338234 61.691433 64.575035 70.720238 76.244438 82.389641 88.066841 94.78804 100.32124 105.99844 112.24265 115.12625 117.58145 123.26765 127.94585 131.48105 135.31325 140.95535 145.63356 149.16876 151.62396 157.07616 162.76236 165.58656 170.26477 175.66296 181.34917 184.23277 189.82898 195.18217 198.06578 200.52098 206.10278 211.32458 216.78488 222.00668 227.40938 233.00558 235.82979 238.98698 242.81918 248.27138 257.01758 259.84177 265.23996 267.69516 270.15036 272.97455 278.42676 284.02295 289.42566 293.08777 298.48596 302.02115 304.47635 310.16254 315.75873 318.58292 327.3291 332.78131 338.3775 343.78021 348.4584 351.28259 356.6358 361.953 366.6312 371.98441 377.5806 381.11578 383.99936 387.83157 393.18478 398.58298 401.03818 404.99728 410.40088 415.99707 421.59326 425.42548 430.77869 435.45688 440.13507 443.01865 451.76483 457.21704 462.81323 468.16644 471.43164">The SYSENTER instruction can be invoked from all operating modes except real-address mode. </tspan><tspan y="-245.99965" x="45.118835 50.658337 56.350838 61.710339 64.474243 70.62574 76.156242 82.307739 87.991241 94.718742 100.25824 105.94174 112.19225 114.95615 120.36065 126.05315 131.65564 134.41954 140.57104 146.10155 152.25305 157.93655 164.09706 167.88156 173.42107 176.18497 178.64647 184.28857 189.02887 192.56857 196.40707 202.04918 206.73367 210.27518 212.73668 218.19518 223.88768 228.57217 231.33607 236.74057 240.57907 245.93857 248.70247 253.38696 258.84546 267.59796 273.20047 278.60498 284.29749 286.75897 292.21747 297.90997 300.67389 303.07059 308.77209 313.4566 316.99811 320.83661 326.52911 331.21362 334.75513 337.21661 342.67511 348.36761 353.05212 356.32364 359.08755 364.69006 370.33215 373.87366 376.63757 380.17908 385.87158 391.23108 396.55457 399.31848 404.92099 410.3219 413.08582 418.77832 424.23682 427.77832 430.54224 435.22675 440.68524 446.37775 451.06226 454.60376 457.06525 460.60675 466.29926 469.84076 475.20026 477.96417 483.36868 486.1326 490.81711 496.22162 498.68311 501.14459 505.2261 509.06461 514.42413 517.96564 523.65814 527.49664 533.13788 535.90179 541.50427 546.90875 549.37024 551.89203 555.16351">The SYSENTER and SYSEXIT instructions are companion instructions, but they do not constitute a call/return pair. </tspan><tspan y="-234.95935" x="45.118835 54.009033 59.695232 65.048431 70.734634 73.198837 78.55204 83.773842 89.127045 93.805244 99.491447 103.02665 105.48185 111.16805 116.80745 119.21135 124.60955 127.07375 133.25764 138.77554 144.92075 150.59795 157.31915 162.85236 168.52956 174.77376 177.23796 179.63466 185.33617 190.01437 193.54958 197.38177 203.06798 207.74619 211.28139 213.73659 219.18878 224.87498 228.14018 230.60439 234.13959 239.82579 245.17899 247.58289 253.22229 257.06439 262.5166 267.19479 272.548 277.2262 281.90439 287.3566 291.18881 293.65302 299.24921 304.70142 310.05463 314.73282 317.15912 322.84262 328.29211 331.82462 334.22852 338.90402 344.29953 349.61404 354.96454 357.36844 362.04395 365.64395 371.03946 374.57196 379.92245 382.32635 384.77887 390.46237 393.61688 399.06638 402.89587 411.63937 417.03488 420.56738 423.0199 428.46939 434.15289 436.6171 439.77161 445.2211 449.0506 451.5148 455.0473 460.7308 466.0813 468.5455 474.229 478.9693 484.31979 488.14929 490.55319 495.2287 500.67819 506.3176 511.66 514.12421 518.19672 523.54724 526.80975 532.44916 535.15094 538.39276 540.85693 544.3894 550.07288 555.4234">When executing a SYSENTER instruction, the processor does not save state information for the user code (e.g., the </tspan><tspan y="-223.97935" x="45.118835 47.581234 53.223335 57.908737 61.451138 65.290535 70.983932 75.669334 79.211731 81.674133 87.13353 92.826927 95.651123 101.25452 106.71393 109.11063 114.81213 118.35453 123.71493 127.55433 131.63673 134.90913 137.73334 143.13873 148.83214 154.43553 157.25974 162.95314 168.31354 170.77594 174.31834 180.01175 185.37215 189.21155 192.03575 195.57816 201.27156 206.63196 209.51556 215.66797 221.19937 227.35178 233.03618 239.76457 245.30498 250.98938 257.24078 260.06497 265.75836 271.21777 275.05716 277.88135 281.42374 287.11713 292.47754 295.36111 301.51352 307.01883 313.14243 318.83942 324.95853 328.73944 334.29065 337.11484 339.58804 345.29224 349.98843 353.54163 357.39182 363.03391 367.7301 371.28329 373.67911 379.13943 384.84363 387.66782 392.36401 398.0061 403.6203 409.20029 414.6705 418.52069 422.07388 426.77008 429.59427 435.20847 440.62466 445.32086 450.01706 452.49026 458.13235 463.77176 466.59595 472.21014 477.62634 481.28842 486.69202 495.45621 500.79858 504.35178 509.69415 513.54437 518.2406 521.12415 526.59436 532.23651 535.12006 538.67328 544.3775 549.71991">instruction pointer), and neither the SYSENTER nor the SYSEXIT instruction supports passing parameters on the </tspan><tspan y="-212.99936" x="45.118835 49.806934 53.352036 58.760136 63.448235 68.775337">stack.</tspan><tspan y="-196.97935" x="45.118835 49.677338 55.137638 57.781837 63.472538 68.155235 73.512939 76.157135 79.696838 85.387535 90.745239 93.389435 99.539139 105.06784 111.21754 116.89925 123.62495 129.16264 134.84435 141.14165 143.72554 149.12823 154.81894 160.41965 163.00354 169.15324 174.68195 180.83165 186.51335 192.67206 196.45476 201.99246 204.63666 207.09636 212.73846 217.42116 220.96086 224.79756 230.48827 235.17096 238.71066 241.17036 246.62706 252.31776 257.00046 259.64468 265.04739 269.7301 272.37433 277.05704 282.45795 291.20865 296.80936 302.21207 307.85416 310.31384 315.77853 321.46564 324.10986 326.50656 332.20807 336.88718 340.42328 344.25638 349.94348 354.62259 358.15869 360.61478 366.06787 371.75497 376.43408 379.07831 382.23642 387.68951 391.52261 394.16684 397.70294 401.36505 406.76416 412.45126 417.13037 419.58646 423.12256 425.57864 431.03174 436.71884 441.39795 444.04218 449.63928 454.99338 458.52948 465.88159 471.2843 476.62671 482.31381 484.95804 490.55515 494.38824 496.84433 502.16241 504.6185 507.07458 512.42871 518.02582 523.42853 526.07269 528.46942 533.87213 539.09393 544.43634 546.89246 549.53662 555.25073">To use the SYSENTER and SYSEXIT instructions as companion instructions for transitions between privilege level 3 </tspan><tspan y="-185.99936" x="45.118835 49.797935 55.251038 60.848137 66.20224 69.084938 74.484039 80.171143 85.768242 88.591545 94.188644 98.021744 100.47784 105.79594 108.25204 110.70815 116.06225 121.65935 127.06115 129.88446 132.34056 137.69466 142.91556 148.31735 150.71315 153.59586 159.30995 162.19266 167.64575 173.24286 178.59695 182.25815 187.65724 191.19334 193.64944 199.33655 204.93365 207.81636 212.49545 217.81355 222.49265 226.02875 231.38284 240.12994 242.95325 248.55035 252.38345 257.83655 262.51566 267.91745 273.49655 279.18365 283.01675 288.37085 293.04996 296.31607 299.13937 302.67548 308.36258 313.71667 316.59937 319.75748 325.21057 327.66666 330.12274 335.57584 342.92795 345.38403 351.07114 356.66824 359.55093 364.23004 369.63004 375.31714 380.53806 385.89215 391.57925 395.11536 397.57144 403.02454 408.71164 413.39075 416.21405 424.96115 430.64825 435.32736 438.86346 441.68677 447.28387 452.63797 455.46127 458.61938 464.07248 466.52856 468.98465 474.38464 481.73676 487.09085 492.68796">code and privilege level 0 operating system procedures, the following conventions must be followed:</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-171" x="45.119999">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-171" x="62.099998 67.634102 73.321205 78.723907 81.067505 85.746605 91.100708 96.697807 105.44491 110.79901 116.48611 120.02222 122.36581 127.96291 133.31702 137.99612 142.67523 146.50833 148.96443 154.56154 158.09764 163.55074 167.38383 172.06293 174.40652 177.56462 183.01772 186.85081 189.19441 192.73051 198.41762 203.82031 206.16391 211.76102 215.59412 218.05022 223.36832 225.82442 228.28052 233.63461 239.23172 244.58582 246.92941 249.38551 254.73961 259.9614 265.36411 267.7608 270.1044 275.86713 278.21072 282.88983 288.34293 293.94003 299.29413 301.63773 307.03683 312.66 318.25439 320.65829 325.33469 328.86807 334.26447 338.94086 344.25626 346.59985 351.27625 356.67896 362.27335 371.01776 376.36917 382.05356 385.58694 390.26334 392.60693 398.00333 403.68771 409.2821 411.6257 414.7811 420.23151 424.06192 426.40552 429.9389 435.62329 440.9747 443.3183 448.91269 452.7431 455.1965 460.5119 462.9653 465.36111 470.76382 476.34381 481.69522 484.03882 486.49222 491.84363 497.15903 502.51044 504.96384 507.30743 513.01886 515.36243 520.03882 525.4892 531.08362 536.48627 538.82983 544.22626 549.91064 555.50507">The segment descriptors for the privilege level 0 code and stack segments and for the privilege level 3 code and </tspan><tspan y="-159.9597" x="62.100006 66.783607 70.324211 75.727814 80.411415 85.734016 88.437614 93.121216 98.479813 104.08141 112.83302 118.19161 123.88321 127.42381 132.10741 134.811 143.56261 149.20471 153.94501 157.48471 160.12891 165.7305 171.0891 173.73329 178.47359 183.87448 189.56609 193.10669 195.56729 201.16888 206.86049 212.31808 218.00969 222.69328 225.39688 227.79358 233.49509 236.19868 241.60228 244.30588 249.90747 255.26607 259.94968 264.63327 268.47086 270.93146 276.53305 280.07364 285.53125 289.36884 292.07242 295.61301 301.0166 306.61819 309.0788 314.43741 317.70801 320.3522 325.89081 331.5824 333.9791 338.65909 341.36267 346.04626 351.50388 357.08566 362.36777 367.72638 373.41797 376.95856 379.35526 384.81287 390.50446 393.20804 398.61163 401.07224 403.46893 408.92923 416.28583 420.96942 423.673 427.21359 432.85568 438.25839 440.90259 446.50418 450.34177 455.79938 460.48297 465.84158 470.52518 475.20877 480.66638 484.50397 487.20755 490.74814 496.20575 498.84995 503.53354 508.99115 517.74274 523.34436 529.03595 532.57654 537.93512 540.63873 544.17932 549.87091 555.22949">stack segments must be contiguous in a descriptor table. This convention allows the processor to compute the </tspan><tspan y="-148.97971" x="62.100006 66.778206 72.180908 77.777107 86.523308 91.876511 97.562714 101.09792 103.92212 108.60032 113.95352 116.40872 121.81142 126.48962 130.02483 135.42572 139.26782 144.00813 146.83234 149.98953 153.82173 159.27393 168.02013 170.90373 174.43893 180.12514 185.47833 188.30254 193.46404 198.86763 201.32283 207.00903 212.36223 215.18643 220.58913 226.19971 229.73581 235.0899 238.923 244.2771 249.87421 252.7578 255.2139 260.85599 263.73959 267.2757 272.9628 278.31689 281.14111 287.2872 292.81229 298.95837 304.67972 311.39371 316.91971 322.58972 328.82672 334.53271 340.79672 346.93472 352.69742 360.26642 366.45032 372.68732 375.51151 383.08051 389.2644 395.5014">segment selectors from the value entered in the SYSENTER_CS_MSR MSR.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-133.98" x="45.119999">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-133.98" x="62.099998 67.634102 73.321205 78.723907 81.3078 84.465897 89.864998 94.544098 98.0802 100.66409 105.34319 110.66129 115.34039 118.8765 124.2306 132.97769 135.62189 140.30099 145.70009 148.09679 150.55289 153.19708 157.31818 161.99728 165.53339 171.22049 176.8176 180.93869 183.58289 187.41599 192.86908 198.55618 202.09229 204.54839 210.23549 215.58958 220.26868 222.91287 228.26697 233.48877 238.84286 243.52197 249.20908 252.74518 258.09927 263.73868 266.3226 271.91971 277.23779 279.82172 285.50882 290.18793 295.54202 299.37512 302.01935 306.69846 312.12 317.7189 323.0748 325.71902 329.79694 333.27634 338.59625 344.19516 346.65305 351.33395 356.73486 359.19275 361.58945 366.93097 369.5752 371.97189 377.6734 380.31763 384.99854 390.64062 396.04153 399.87643 405.27914 410.85916 413.44308 415.90097 418.35886 423.95776 427.68018 433.08377 436.91867 439.31537 444.71808 449.3981 451.98203 457.43692 461.27182 463.85574 470.78665 475.79156 480.79648 485.47739 489.5553 492.13922 500.88812 506.57703 511.25793 514.79584 517.37976 522.06067 527.40393 532.72382 538.07971 540.66364 544.20154 549.89044 555.24634">The fast system call “stub” routines executed by user code (typically in shared libraries or DLLs) must save the </tspan><tspan y="-122.99999" x="62.099991 65.940292 71.30159 76.905891 82.600189 84.996895 88.838997 94.200294 99.804596 102.32819 106.1685 111.52979 115.07309 120.76739 124.60769 130.30199 132.82559 136.61189 142.03619 144.5598 149.96609 155.6604 161.26469 163.7883 169.39259 173.23289 178.69319 183.37949 188.74078 193.42708 198.11337 203.57367 207.41397 209.93758 214.62387 218.16718 223.57347 227.11678 232.47807 235.06198 237.45868 243.16019 246.32549 251.78578 255.62608 264.38037 269.78668 273.32999 275.72668 281.18698 286.88129 289.40491 291.86819 295.03351 297.55713 302.96344 305.48706 309.32736 314.70029 318.24628 323.88837 327.73135 333.42834 336.01224 339.55823 344.95914 347.54303 351.08902 356.78601 362.15002 364.67361 369.36261 374.77161 377.23761 379.70361 382.10031 387.7973 393.4043 395.92789 401.53488 405.37787 410.84088 415.52988 420.89389 426.50089 432.14297 435.98508 441.34909 443.87268 446.33868 451.02768 453.55127 457.39426 462.75827 468.36526 474.00735 476.47336 480.31635 485.68036 491.28735 494.56335 497.08694 502.09995 504.56595 509.78775 515.13013 522.49213 524.88794 529.57697 534.94098 538.21698 540.7406 544.28662 549.98364 555.34766">required return IP and processor state information if a return to the calling procedure is required. Likewise, the </tspan><tspan y="-111.95969" x="62.099991 67.556694 73.157394 78.560089 82.222191 87.624893 91.164597 93.624298 99.314995 104.9157 107.4996 112.1823 117.504 122.1867 125.7264 131.08411 139.83481 142.479 147.9357 151.7724 154.35629 159.71399 164.93579 170.33849 175.01848 180.66058 184.20029 186.65999 191.98169 197.33939 199.92328 205.52399 209.36069 214.81738 219.50008 224.85777 230.45847 236.14917 239.98587 245.34357 250.02626 252.67046 257.35315 262.75586 265.21555 267.61224 273.01495 278.59497 281.17889 288.53461 290.99429 294.534 300.2247 302.80862 308.95831 314.487 320.63669 326.31839 333.0441 338.58179 344.26349 350.51218 353.0961 355.55579 361.24649 365.9292 369.4689 373.3056 378.99631 383.67902 387.21872 389.67841 395.1351 400.77719 405.45721 408.10144 416.85214 422.54285 427.22556 430.76526 433.34918 439.03989 444.38321 449.60498 454.94739 457.59161 462.99432 467.67703 472.35974 477.71744 482.40015 487.08286 489.72708 493.26678 498.72348 501.3074 506.71011 512.40082 518.00153 520.58539 526.27606 530.95874 536.31647 538.96063 542.50031 548.19098 550.58771 555.2677">operating system or executive procedures called with SYSENTER instructions must have access to and use this </tspan><tspan y="-100.97969" x="62.099991 66.782692 72.125992 77.347794 82.750488 88.351189 91.175385 95.012085 100.36978 103.90948 109.60018 113.38198 119.08348 121.96708 127.36978 133.06049 138.66119 141.4854 146.16809 149.70779 155.11049 158.71049 164.06819 166.8924 169.3521 175.0428 178.2045 183.60539 187.44209 196.19279 201.59549 205.13519 207.59489 213.05159 218.74229 221.5665 228.9222 234.6129 239.9706 245.6613 248.4855 252.3222 257.6799 261.2196 266.91031 270.74701 276.43771 278.8974 284.5881 290.18881 293.01303 296.55273 302.00943 304.89304 308.43274 314.12344 319.48114 322.30536 327.99606 332.67877 338.03647 341.87317 344.75677 349.43948 354.89618 360.49689 365.85458">saved return and state information when returning to the user code.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-700.97998" x="48.779991 54.738892 59.779793 63.799191 68.778893 73.879196 147.3786 149.7645 154.91339 159.11278 162.71367 165.97256 171.12146 175.26056 178.86145 181.09435 186.11725 259.25574 265.19482 270.23572 273.65662">OpcodeInstructionOp/ </tspan><tspan y="-691.01965" x="259.26028 264.23907">En</tspan><tspan y="-700.97998" x="283.98059 289.50479 295.08298 297.85318 303.5304 305.76959 309.34979">64-Bit </tspan><tspan y="-691.01965" x="283.98059 290.92499 295.9794 301.01938">Mode</tspan><tspan y="-700.97998" x="332.04059 336.97168 342.00177 349.46188 354.50998 359.29709 362.87817">Compat/</tspan><tspan y="-691.01965" x="332.04059 336.4209 341.45999 346.50089 348.78061 355.69351 360.7164 365.75729">Leg Mode</tspan><tspan y="-700.97998" x="378.78027 384.59879 389.62527 393.90479 397.9953 401.25781 403.49432 408.41461 412.01553 414.25204 419.27853">Description</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-676.02026" x="48.779999 54.017097 58.758301 60.977699 66.214798 147.39481 152.01721 156.9987 161.7498 166.491 172.0719 177.05069 181.79189 259.31158 264.23007 284.02829 289.36978 293.80948 295.70758 297.68939 332.06848 337.34967 341.79477 343.77567 345.70078 378.81989 383.517 388.01608 391.9176 395.27731 397.4967 401.37482 405.83972 407.76392 409.68811 411.9075 415.14749 419.8887 422.10809 426.76828 430.03348 431.98468 436.62689 438.57809 440.50229 445.21649 449.87668 454.59088 456.81027 458.73447 463.29477 467.79388 472.47479 474.39899 476.61838 481.88159 484.10098 488.0025 492.6825 496.58401 500.00403 504.71823 511.66443">0F 34SYSENTERZOValidValidFast call to privilege level 0 system </tspan><tspan y="-664.97998" x="378.77942 383.39911 386.52121 391.20212 395.10184 399.83945 404.45914 409.25974 412.32153 417.05914 421.09476">procedures.</tspan><tspan y="-611.99969" x="55.61911 61.317013 65.996117 69.141617 73.880119 125.96223 131.66013 136.33563 141.01654 144.13864 148.57834 153.37083 157.99054 160.20993 242.10994 247.80785 252.48335 257.16425 260.28635 264.72604 269.51855 274.13828 276.3577 359.5177 365.21558 369.89108 374.62057 377.68237 382.12207 386.91458 391.5343 393.75372 477.69403 483.39191 488.06741 492.74829 495.81009 500.3092 505.0513 509.73041 511.94983">Op/EnOperand 1Operand 2Operand 3Operand 4</tspan><tspan y="-595.97968" x="61.799408 66.717903 139.9761 145.7973 256.1373 261.9585 373.55847 379.37967 491.75906 497.58026">ZONANANANA</tspan></text><path transform="matrix(1,0,0,-1,0,792)" d="m 45.54,659.22 h 0.48001 v 50.52 H 45.54 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 144.12,658.74 h 0.47999 v 51.48 H 144.12 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 256.02,658.74 h 0.48 v 51.48 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 280.74,658.74 h 0.48 v 51.48 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 328.8,658.74 h 0.47998 v 51.48 H 328.8 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 375.54,658.74 h 0.48 v 51.48 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 556.92,659.22 h 0.48 v 50.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.48,709.74 H 557.4 v 0.48 H 45.48 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.48,684.78 H 557.4 v 0.4801 H 45.48 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.48,658.74 H 557.4 v 0.48 H 45.48 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 44.88,591.24 h 0.47998 v 31.5 H 44.88 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 88.92,590.76 h 0.48 v 32.46006 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 202.02,590.76 h 0.48 v 32.46006 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 321.24,590.76 h 0.48 v 32.46006 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 436.86,590.76 h 0.47998 v 32.46006 H 436.86 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 557.58,591.24 h 0.48 v 31.5 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 44.82,622.74 h 513.24 v 0.48 H 44.82 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 44.82,606.78 h 513.24 v 0.48 H 44.82 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 44.82,590.76 h 513.24 v 0.48 H 44.82 Z" inkscape:connector-curvature="0" /></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="509.62515pt" height="639.70978pt" viewBox="0 0 509.62515 639.70978" sodipodi:docname="1405.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.64001" inkscape:cy="417.18921" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg188" /><g transform="translate(-46.019989,-69.182129)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-715.97998" x="46.02 51.549599 57.232201 62.581802 65.465408 71.60701 77.127609 83.311508 88.948204 95.665802 101.244 106.9176 113.1582 116.04181 121.43641 127.11901 132.71161 135.5952 141.7368 147.2574 153.4413 159.078 165.2574 169.0383 174.5679 177.45149 179.90309 185.58569 190.2603 193.7919 197.6205 203.3031 207.97771 211.50931 213.96091 219.4095 225.0921 229.76671 232.5909 239.96729 245.30968 249.13828 254.48787 257.37149 259.82309 265.50568 269.03726 272.86588 278.31448 283.90707 289.58966 294.26425 299.66696 305.24695 308.07117 310.52277 316.19998 319.74057 325.19818 328.0224 331.56299 337.25458 342.61319 345.4968 349.2804 355.224 359.3046 365.02319 370.74179 373.6254 379.02899 382.86658 387.55017 393.24176 395.63846 399.17816 404.53677 409.22037 412.76096 418.45255 422.29013 427.64874 430.47296 432.93356 438.62515 441.44937 444.98996 450.68155 456.04016 458.92377 464.14377 469.48618 475.17776 478.71835 481.11505 486.81653 495.56812 498.45172 502.23532 506.01892 508.84314 514.44476 518.28235 523.73993 528.42352 533.7821 538.4657 543.14929 548.60687 551.12866 554.43079">The SYSENTER and SYSEXIT instructions were introduced into the IA-32 architecture in the Pentium II processor. </tspan><tspan y="-705" x="46.019989 51.553188 57.239388 62.592587 64.936188 70.334389 75.495888 80.894089 83.349289 85.745987 91.14959 96.788986 99.185684 101.64088 104.09608 107.63129 112.94849 115.29209 120.74429 123.9015 126.2451 129.7803 135.46651 140.8197 145.49791 150.8511 153.255 155.6517 161.35321 166.03142 169.56662 173.39882 179.08502 183.76323 187.29843 189.75363 195.20583 200.89203 205.57024 207.91383 213.36603 219.05223 221.39583 226.79402 229.13762 234.73383 238.56602 244.01822 248.69643 254.04962 258.72781 263.46811 268.86902 272.70123 275.10513 277.50183 282.18182 284.58029 286.97699 292.67847 298.28006 300.74066 305.42426 310.82785 314.36844 319.72705 325.32864 327.67224 335.02884 337.42554 340.96613 346.65771 349.00131 352.5419 358.23349 363.5921 365.9357 372.0863 377.61591 383.76651 389.4491 396.17569 401.71429 407.39688 413.69418 417.77478 423.90027 429.42178 435.60568 441.28018 447.43167 451.20718 456.73767 459.08127 464.72067 468.56277 473.91327 478.58878 483.93927 489.62277 493.15527 495.49887 499.57138 505.75528 511.42978 516.88916 520.96167 523.30524 526.45972 531.81024 537.20575 540.73822 546.42169 550.25122 555.60175">The availability of these instructions on a processor is indicated with the SYSENTER/SYSEXIT present (SEP) feature </tspan><tspan y="-694.02002" x="46.019989 49.185287 51.581985 56.988285 62.592587 65.416786 69.257088 74.618385 78.161682 83.85598 87.696281 93.390579 98.751877 104.35618 107.18037 110.72367 116.18398 119.00817 122.55147 128.24577 133.60707 136.43127 142.11658 148.96107 155.12338 157.94759 161.78789 167.14919 172.75348 175.21678 179.90308 183.44638 188.80768 192.64798 195.53159 201.13588 206.46118 209.34479 212.88809 218.5824 223.9437 226.7679 233.0472 238.4715 245.05679 248.84309 255.77939 258.66299 261.12628 266.7684 271.45471 274.99802 278.83832 284.53262 289.21893 292.76224 295.22552 300.60028 306.28647 309.55167 312.43527 318.58047 324.26666 327.09088 332.54309 338.13928 343.49249 347.1546 352.5528 356.08798 358.54318 364.22937 369.82556 372.70917 377.38736 382.70456 387.38275 390.91794 396.32065 405.02362 407.90723 411.44241 417.1286 422.52679 426.06198 428.87997 434.48248 440.12457 445.52908 447.99057 450.45206 453.61557 456.01227 461.41498 466.09949 468.92371 472.46521 478.15771 483.51721 486.40082 492.55231 498.23581 503.65829 506.5419 509.70541 512.16693 517.57141 523.17389 525.99811 534.75061 540.44312 545.12762 548.66913">flag returned to the EDX register by the CPUID instruction. An operating system that qualifies the SEP flag must </tspan><tspan y="-682.97974" x="46.019958 51.421761 53.880562 58.562363 64.018166 66.842361 72.442162 78.131958 83.53376 85.992561 88.451363 91.61216 96.932961 99.816559 103.35536 109.04517 114.40196 117.22616 122.82596 126.66176 132.11755 136.79935 142.15614 146.83794 151.51973 156.97552 160.81133 163.63553 166.79633 172.19812 180.94792 183.40672 185.80342 191.14493 193.96913 199.37093 205.06073 210.66052 213.48473 222.23453 227.69032 233.29013 238.64693 241.10573 243.98933 247.52814 252.92903 255.81265 261.16946 266.85925 271.54105 277.23083 281.06662 286.42343 289.26025 292.80176 298.44385 303.84836 307.38986 310.27347 313.81497 319.50748 324.86697 327.75058 333.90207 339.43256 345.58405 351.22073 357.94824 363.48773 369.12442 375.36142 379.44293 385.59442 391.12491 397.2764 402.9599 409.12039 412.90491 418.4444 421.26862 423.7301 429.42261 434.10712 437.64862 441.48712 447.17963 451.86414 455.40564 457.86713 463.32562 468.96771 473.64774 476.53134 481.93585 485.77435 491.13385 494.01746 499.42197 504.10648 507.64798 513.34045 518.74493 521.14075 523.60223 528.92572">also qualify the processor family and model to ensure that the SYSENTER/SYSEXIT instructions are actually </tspan><tspan y="-671.99976" x="46.019958 51.59996 55.442059 60.784458 65.464455 70.854553 76.496651 80.068748 83.310547 86.134743 91.117149 96.577446 100.44655 103.27074 108.66084 113.94295 119.37804 128.16115 133.74115 136.19725 141.53966">present. For example:</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-652.01978" x="46.019958 48.114258 52.795158 55.014557 59.736858 64.855156 70.540459 72.634758 78.167061 80.386459 85.162758 89.885056 95.003357 97.222755 101.88206 103.83236 107.20466 109.42406 111.37436 115.38566 117.60506 121.61636 126.32966">IF CPUID SEP bit is set</tspan><tspan y="-640.02008" x="59.519958 64.717461 70.538666 75.277168 81.098373 83.31778 85.428276 90.166779 92.386185 94.965584 99.646484 104.13299 111.03329 112.99979 114.93929 119.63278">THEN IF (Family </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-640.02002" x="121.86">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-640.02002" x="127.92"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-640.02002" x="130.38 135.61711 138.18121 140.40062 144.89972 149.64182 154.32091 156.54031 159.10442 165.70502 170.40211 175.08121 179.7693 181.6674 183.88681 188.9259 191.14531 196.42561 199.00502 201.22443 205.66953 210.47192 215.10602 217.32542 219.96423 224.70633 228.05344 232.79373 237.42783 242.10692 244.08871 248.83081 253.5099 255.72931 260.73242 262.95181 268.23212 270.81149">6) and (Model &lt; 3) and (Stepping &lt; 3) </tspan><tspan y="-628.02032" x="77.520309 82.729507 88.550705 93.300903">THEN</tspan><tspan y="-616.02063" x="95.520309 100.31011 105.41132 110.20112 114.93692 120.75813 125.91692 130.65273 136.05273 139.19554 143.98534 149.08653 153.88893 158.56982 164.27042 166.37822 171.53702 176.10182 181.92302 186.65881 190.04462 194.60942 199.35152 204.14131 208.76102 213.43382 218.11472 221.39252 224.77832 229.50513 234.12483 236.00763 238.22702 242.96281 245.07062">SYSENTER/SYSEXIT_Not_Supported; FI;</tspan><tspan y="-604.02094" x="77.520309 82.25341 86.72551 91.512611 96.245712">ELSE </tspan><tspan y="-592.02124" x="95.520309 100.31191 105.41312 110.20472 114.94232 120.76353 125.92233 130.65993 136.05994 139.20454 143.99614 149.09734 153.89973 158.58063 164.28122 166.39082 171.54962 176.11623 180.85832 185.64992 190.26962 194.94423 199.68182 202.92363 206.28334 211.01195 215.63165 217.51625 219.73564 224.47324 226.58284">SYSENTER/SYSEXIT_Supported; FI;</tspan><tspan y="-580.02155" x="46.020309 50.70121 52.801807">FI;</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-564.00153" x="46.020309 54.909611 60.59491 65.947212 71.632515 74.456718 77.99102 83.676323 89.028625 91.912231 98.182533 103.59783 110.17413 113.95143 120.87873 123.70293 126.15723 131.84253 136.51984 140.05414 143.88544 149.57074 154.24805 157.78235 160.23665 165.68794 171.37325 174.25684 176.71114 181.38844 184.21263 189.56493 194.78673 200.18942 204.86943 210.55473 214.08904 219.49173 225.06 227.88419 233.34088 239.03159 241.91518 245.45488 251.14558 256.5033 259.32751 264.54752 269.88992 275.58063 279.12033 281.58002 287.27072 295.97372 298.85733 304.27805 308.11475 313.57144 316.45505 322.05576 325.89246 331.34915 336.03186 341.38956 346.07227 350.75497 356.21167 360.04837 362.93198 367.01169 375.71469 381.17139 386.77209 392.12979">When the CPUID instruction is executed on the Pentium Pro processor (model</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.0539" class="cDBDE3506 cC7C7E1F8"><tspan y="-564" x="394.56"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-564" x="396.78 402.49591 406.57382 409.87595 412.70016 416.23807 421.92697 427.28287 430.16647 435.76538 439.60028 445.05518 449.73608 455.09198 459.77289 464.4538 469.90869 473.74359 476.6272 480.4621 485.81799 489.3559 495.0448 498.8797 504.5686 509.24951 512.07373 517.47461 520.35822 523.89612 529.58502 534.94092 537.76514 543.94904 549.58569 555.0451">1), the processor returns a the SEP </tspan><tspan y="-553.02002" x="46.020294 49.174793 51.627293 57.022793 62.662193 65.486397 70.881897 75.557396 78.441002 83.116501 88.467003 91.999504 95.262001 98.145607 103.73911 109.42261 112.95511 115.83871 121.43221 126.88171 132.23221 136.90771 139.79131 145.47481 150.9243 154.4568 157.34039 162.0159 167.6994 173.29291 178.88641 184.33591 188.16541 191.69791 194.52029 198.0618 203.7543 209.1138 211.938 218.08951 223.62001 229.77151 235.45502 242.18251 247.72202 253.40552 259.65601 263.73752 269.88901 275.41949 281.57098 287.25449 293.37357 297.15808 302.69757 305.52179 307.98328 313.67578 318.36029 321.90179 325.7403 331.4328 336.11731 339.65881 342.05551 347.51581 353.20831 357.89282">flag as set, but does not support the SYSENTER/SYSEXIT instructions.</tspan><tspan y="-537" x="46.020294 54.914093 60.603893 65.960693 71.650497 74.174095 78.855896 84.5457 89.947502 95.547302 101.00311 108.3579 110.8815 115.5633 119.1021 124.50391 129.1857 134.5065 139.18829 141.71188 147.11368 150.94948 156.30627 158.89017 164.24696 169.93677 175.33856 180.93835 183.39716 188.75395 194.35376 196.93765 202.33945 205.87825 208.40184 214.00165 217.83745 220.29625 225.61705 228.01375 230.46985 235.82664 241.42645 246.78325 249.30684 251.76564 257.12244 262.44324 267.80005 270.25885 272.78244 280.13724 285.77933 291.13614 294.97192 300.32874 302.85233 309.00113 314.4606 320.60489 326.28119 333.0015 338.53378 344.21008 350.45337 352.97699 355.4313 361.11661 365.79391 369.32822 373.15952 378.84482 383.52213 387.05643 389.45316 394.91345 400.59875 403.12238 405.57669 410.254 412.77762 415.23193 420.91724 426.13904 431.59933 436.82114 442.16354 447.75885 451.02316 453.54678 457.08109 462.76639 468.11868 470.70261 476.7659 482.8895 488.30481 490.88873 493.28546 497.96545 500.54938 505.22668 510.51059 515.8269 521.1792 526.77448 529.3584 532.8927 538.34399 540.86761 544.40192 550.08722 555.43951">When shadow stacks are enabled at privilege level where SYSENTER instruction is invoked, the SSP is saved to the </tspan><tspan y="-525.95972" x="46.020294 49.794895 55.936493 61.699192 67.408791 73.118393 78.530991 83.574585 89.284187 94.99379 101.05709 107.24099 112.64098 115.46519 123.08729 129.21088 135.45148 138.75357 141.57776 145.35236 148.50595 151.38954 156.06415 161.74675 167.14136 172.78076 178.22935 185.57695 188.46054 193.13515 196.66675 202.06134 206.73595 212.04955 216.72415 219.54834 224.94293 228.77153 234.12112 237.00471 242.35431 248.03691 253.43152 259.02411 261.47571 266.82532 272.46472 275.28891 280.6835 284.21509 287.03928 292.67868 296.52078 298.97238 304.28598 306.73758 309.18918 314.4606 320.05051 325.45319 328.2774 330.72632 336.07321 341.29501 346.69769 349.09442 351.97803 357.68494 360.98706 363.81128 367.34018 373.02008 378.36697 381.25058 387.25446 393.43835 398.84827 401.73187 404.1286 408.8689 411.69312 414.14203 419.58792 424.97983 430.56973 435.91663 441.55603 444.38025 451.72516 454.12189 457.65079 463.33069 466.21429 471.9212 475.18011 478.06372 484.06134 489.46402 492.61493 498.01761 501.84351 504.66772 508.19662 513.64252 516.52612 522.79102 528.47089 533.86279 539.4527 542.98163 548.38434 552.21027">IA32_PL3_SSP MSR. If shadow stacks are enabled at privilege level 0, the SSP is loaded with 0. Refer to Chapter </tspan><tspan y="-514.97974" x="46.020294 51.737995 55.007694 57.651894 61.776592 67.197296 71.033997 76.4907 81.173401 86.531097 92.131798 97.773895 101.6106 107.01329 109.65749 115.93319 121.33589 123.73259 126.18869 130.87138 134.14108 136.78528 140.56798 146.25868 149.79839 155.15608 158.99278 162.82948 168.52019 174.12088 177.66058 182.34328 185.61298 188.25717 193.65987 199.35057 204.95126 207.65486 213.33656 218.65826 223.34096 228.69865 234.29935 237.83905 240.29875 245.75545 251.44615 256.12885 260.25354 262.89777 268.30048 273.99118 279.59189 282.2955 288.5712 294.2619 299.66461 305.16 308.69699 314.0997 317.93372 320.57791 326.29291 332.0079 335.31 337.95419 342.0762 348.34921 353.80322 359.49121 363.0282 366.86221 372.31622 374.77322 378.85022 384.01624 386.47324 391.92725 399.28024 401.98383 407.66281 413.3508 416.5098 421.96381 425.79782 430.47781 435.83282 444.58081 449.93582 455.62381 459.1608 461.80499 466.42288 471.76529 476.44528 482.13327 487.82126 493.27527 495.67197 501.13226 506.77167 512.05377 514.75739 518.83441 525.10742 530.78644 536.32141 540.39844 544.52045 547.16467 549.62164 555.30963">6, “Procedure Calls, Interrupts, and Exceptions” and Chapter 18, “Control-Flow Enforcement Technology (CET)” in </tspan><tspan y="-503.99973" x="46.020294 49.554596 55.239895 60.592194">the </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-503.99973" x="63.419994 67.195496 72.878998 76.411499 81.814201 84.266701 93.253204 96.13681 101.84731 107.55782 110.44142 115.83692 121.52042 127.11392 129.93811 133.77931 139.90291 143.9754 149.6859 155.39639 158.27998 164.41348 168.24298 172.91849 178.60199 181.05449 184.58699 189.93748 194.61299 198.14549 203.82899 207.65849 213.00899 217.68449 220.56808 226.71059 232.16008 235.31458 238.84708 246.19557 251.59106 255.42056 260.77106 263.59528 270.47577 275.82626 281.13177 286.48227 288.93478 294.38428 299.97778 305.38046 309.20996 311.61746 316.29297 319.17657 326.75006 332.14557 337.82907 343.51257 348.90808 351.4245 354.68701 357.57062 363.70413 369.15363 371.60614 377.28964 386.03314 391.43582 394.26004">Intel® 64 and IA-32 Architectures Software Developer’s Manual, Volume 1</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-503.99973" x="399.95969 402.84326 406.01575 411.41666 415.26416 418.14774 423.56125 429.17276 434.78427 437.18097 440.73148 443.20197 448.66946 454.37097 459.78448 462.25497 465.07916 471.36566 477.00238 482.55087 485.37506 490.98657 496.35507 499.90558 505.31909 507.71579 510.17188 514.86536"> for additional CET details.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c1AE6E0A5"><tspan y="-487.97974" x="46.019409 48.480911 54.002411 58.981213 61.980915 65.492714 71.002518 75.981316 78.98101 81.493813 86.955017 92.464813 94.686012 100.19582 103.70762 109.21742 114.19622 117.70802 120.22083 125.68202 131.20352 133.66502">Instruction ordering. </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-487.97974" x="135.89972 139.68152 145.37132 150.05312 153.59192 157.42772 163.11752 167.79932 171.33812 173.79692 179.19781 184.88762 189.56941 192.45302 195.61382 201.06961 203.52841 205.98721 211.44301 218.79781 221.25661 226.94641 232.5462 235.42981 240.8316 243.65581 249.80461 255.33241 261.4812 267.16199 273.88678 279.42358 285.10437 291.35217 294.17636 302.92615 308.26944 313.59024 316.41443 322.01422 327.41693 330.24112 333.40192 338.75873 342.29752 346.92001 352.61252 357.97202 363.57452 366.39874 369.56226 373.40076 378.85925 387.61176 390.43597 399.18848 404.54797 413.30048 418.75897 422.59747 427.92096 430.80457 436.40707 441.76657 444.93008 450.38858 454.22708 459.58658 462.47018 467.82968 473.23419 477.07269 479.53418 481.99567 487.35516 491.19366 494.01788 496.47937 502.17188 506.85638 510.39789 514.23639 519.92889 524.6134 528.15491 530.55157 536.01184 541.70435 546.38885">Instructions following a SYSENTER may be fetched from memory before earlier instructions </tspan><tspan y="-476.99973" x="46.020325 50.700325 56.154327 64.902328 70.500328 72.957329 78.312332 81.849335 87.204338 89.608246 94.963249 100.18505 105.54005 110.22005 115.90806 119.44506 121.90206 127.35606 133.04407 136.31107 138.65466 144.25267 149.94067 153.47768 155.88158 159.41858 165.10658 170.46158 175.78058 178.12418 185.47717 187.87387 190.33087 192.78787 195.13147 200.81947 206.27347 209.81047 212.15407 217.55676 222.77856 228.13356 232.81357 238.50157 242.03857 247.39357 249.79747 253.87447 259.22946 264.45126 269.79367 275.48166 277.88556 282.56555 288.16354 293.51855 298.19855 303.88654 306.34354 311.74353 315.28052 317.73752 322.95932 328.31433 330.77133 336.09033 340.16733 342.51093 348.19891 353.8869 357.42389 359.88089 362.27759 364.68149 370.08148 372.47729 374.9343 377.3382 379.73489 385.43637 390.11636 393.65335 397.48737 403.17535 407.85535 411.39233 413.84933 419.30334 424.99133 429.67133 432.01492 437.61292 441.44693 443.90393 449.35794 453.19196 455.53555 459.07254 464.52655 466.93045 470.46744 476.15543 481.51044 483.85403 490.00104 495.52704 501.67404 507.35303 514.07605 519.61102 525.29004 531.53601 533.93988 539.62787 544.97119 550.29016 555.64514">complete execution, but they will not execute (even speculatively) until all instructions prior to the SYSENTER have </tspan><tspan y="-465.95941" x="46.020325 50.700325 56.154327 64.902328 70.500328 72.957329 78.312332 81.849335 87.204338 92.802338 95.685936 101.04094 106.26274 111.61774 116.29774 121.98575 125.52275 127.97975 133.43375 139.12175 141.94595 146.02295 149.55995 155.24796 160.60295 163.48656 165.94356 171.34355 174.88055 180.23555 184.06955 186.89375 189.35075 195.03876 199.71875 203.25575 207.08975 212.77776 217.45776 220.99477 223.39146 228.85176 234.53976 239.21976 242.10336 250.85136 256.19467 261.51367 264.33786 269.74057 274.96237 280.31738 284.99738 290.68536 294.22235 299.57736 302.46094 308.05893 313.41394 316.57294 322.02695 325.86096 331.21597 334.04016 339.63815 345.03815 348.57513 353.97513 356.79932 361.47931 365.0163 370.47031 374.30432 379.70703 385.28702 388.11121 393.7092 399.0282 401.85239 405.45236 411.09445 416.49716 419.32135 424.67636 430.07635 433.91037 436.36737 438.82437 444.17938 448.0134 450.89697 453.29279 458.99426 463.67426 467.21124 471.04526 476.73325 481.41324 484.95023 487.40723 492.86124 498.54922 503.28952 506.11371 511.8017 517.14502 522.36676 527.70917">completed execution (the later instructions may execute before data stored by the earlier instructions have </tspan><tspan y="-454.9794" x="46.020325 51.611126 56.958927 61.631729 67.078529 75.819328 81.16713 84.050728 89.641525 92.091324 97.538124 103.12892 108.52172 110.97152 113.42132 118.73312 121.61671 126.92851 129.37831 134.05112 136.50092 142.09172 144.54152 149.88931 153.95911">become globally visible).</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-429.29999" x="46.02 52.630455 58.270802 63.845413 67.26767 72.573364 76.594215 79.08123 84.720589">Operation</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-412.98001" x="46.02 48.123299 52.804199 55.023602 59.754902 65.188202 70.459503 72.175804 77.303101 81.984001">IF CR0.PE </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-412.98001" x="84.18">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-412.98001" x="90.239998"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-412.98001" x="92.699997 97.972198 100.1916 105.8895 111.2895 113.5089 115.6131 121.22729 126.4473 131.7276 136.2888 141.0309 146.16811 150.9102 155.6424 161.4996 166.6908 171.423 176.85721 181.41841 186.1506 190.8927 193.6629 198.9351 204.20731 205.96951 211.18951">0 OR IA32_SYSENTER_CS[15:2]</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-412.98001" x="213.89999"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-412.98001" x="216.42">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-412.98001" x="222.42 224.6394 229.9026 232.12201 237.30421 243.15242 247.87563 253.72383 255.94324 261.71045 266.98264 272.10184 274.69205 279.91205 282.49146 284.36166 286.58105 291.30426 293.39948"> 0 THEN #GP(0); FI;</tspan><tspan y="-393" x="46.019989 51.419991 56.16119 60.59819 66.178192 71.458496 76.260895 77.943893 83.645393 90.197395 92.416794 94.144791 99.30629 101.52569 106.76369 221.6037 224.1687 228.1647 230.38411 235.08211 239.88451 243.9066 248.6487 251.95081 256.63171 260.65381 262.87323 267.50824 270.81033 275.50833 278.92831 283.61731 287.49631 290.8443 295.58459 300.2196 302.43903 309.39963 314.14084 318.77585 323.51614 325.73557 330.42456 335.22244 339.91144 343.79044 348.59286 351.95255 353.93433 358.61523 363.41766 365.63708 369.63309">RFLAGS.VM := 0;(* Ensures protected mode execution *)</tspan><tspan y="-381.00031" x="46.019989 51.438889 56.155788 60.611687 66.210587 71.476486 76.247383 77.94928 80.038177 84.755081 86.97448 88.721382 93.834282 96.05368 101.31058 221.55058 224.13448 228.14938 230.36879 236.9397 241.4046 245.41051 249.7296 251.94901 253.89391 258.66479 262.03171 266.73959 270.04172 273.28354 278.05444 282.70834 286.07526 290.08115 292.30054 296.31543">RFLAGS.IF := 0;(* Mask interrupts *)</tspan><tspan y="-369.00061" x="46.019989 48.11969 52.800591 55.019989 56.975689 61.757389 63.976788 66.076485 71.686188 74.523888 79.743889 85.011589 89.730286 91.949684 98.849983 103.59118 108.21088">IF in IA-32e mode</tspan><tspan y="-357.00092" x="59.519989 64.729187 70.550385 75.300583">THEN</tspan><tspan y="-345.00122" x="77.519989 82.979393 87.721489 92.882988 95.102386 96.829483 101.92258 104.14198 106.24258 111.82259 117.10288 122.32288 126.88409 131.68649 136.78859 141.59099 146.28809 152.16869 157.32478 162.06598 167.46507 172.02628 176.72337 181.52577 186.61887">RSP := IA32_SYSENTER_ESP;</tspan><tspan y="-333.00153" x="77.519989 82.947891 85.045792 90.167694 92.387093 94.14299 99.264893 101.48429 103.58219 109.19009 114.4101 119.69039 124.24529 128.9874 134.1183 138.86041 143.58632 149.43723 154.62213 159.34804 164.77594 169.33084 174.05675 176.15465 181.27655">RIP := IA32_SYSENTER_EIP;</tspan><tspan y="-321.00183" x="46.019989 50.704491 55.20359 59.942093">ELSE</tspan><tspan y="-309.00214" x="77.519989 82.244987 87.023987 92.144989 94.364388 96.119385 101.24039 103.45979 105.55679 111.16379 116.42879 121.69379 126.24779 130.9899 136.09111 140.87012 145.59512 151.44513 156.62914 161.35414 166.78114 171.33514 176.06015 180.80226 185.96376 188.66286 193.92786 199.19286 200.94786 206.21286 208.97586">ESP := IA32_SYSENTER_ESP[31:0];</tspan><tspan y="-297.00244" x="77.519989 82.25489 84.361794 89.492691 91.712097 93.476997 98.607895 100.8273 102.9342 108.5511 113.7711 119.05141 123.61531 128.35741 133.49731 138.23941 142.9743 148.8342 154.02809 158.70898 164.14589 168.64679 173.38168 175.48859 180.61949 183.3924 188.6673 193.8873 195.65219 200.87219 203.6451">EIP := IA32_SYSENTER_EIP[31:0];</tspan><tspan y="-285.00275" x="46.019989 50.70089 52.801487">FI;</tspan><tspan y="-264.96243" x="46.019989 50.70089 55.503292 57.217793 62.001293 66.682198 68.663101 73.344002 77.243698 80.623199 85.352699 88.624199 90.843597 92.603096 97.7286 99.947998 102.0495 107.661 112.9305 118.15051 122.70901 127.45111 132.58562 137.32771 142.05722 147.91173 153.10023 157.78114 163.21265 167.71355 172.44305 177.22655 179.99405 185.21405 190.48355 192.24306 197.51256 200.28006 202.49945 208.11095 213.96545 219.50496 221.72435 226.40526 231.14647 235.82738 240.56859 246.4231">CS.Selector := IA32_SYSENTER_CS[15:0] AND FFFCH;</tspan><tspan y="-252.96274" x="221.58029 224.1516 228.1539 230.37331 236.0856 240.76469 245.45999 248.7063 253.2054 256.56509 258.54691 263.289 267.96811 270.1875 274.18079 278.84009 282.83337 286.18768 290.92801 297.88861 300.108 304.7493 308.05139 312.75568 317.37897 319.36078 324.03989 328.7352 332.72849 334.94788 339.68906 344.43115 346.28244 348.50183 353.96124 359.06244 363.50574 365.72513 369.08392 373.7648 377.06689 380.96661 385.66193 390.34103 392.56042 395.91473 400.65591 402.87531 408.1196 410.33899 414.34128">(* Operating system provides CS; RPL forced to 0 *)</tspan><tspan y="-240.96304" x="46.019989 48.60569 52.622391 54.841793 59.614494 64.324196 67.692894 69.912292 73.172989 77.88269 81.890388 85.259087 87.478485 92.197189 95.529892 97.74929 102.46799 107.24068 109.46008 112.88008 117.56098 119.78038 124.24708 126.46648 129.79918 131.74588 136.48349 141.22379 145.87949 148.09889 152.73659 157.20329 159.12299 163.89569 168.60539 170.8248 174.84149">(* Set rest of CS to a fixed value *)</tspan><tspan y="-228.96335" x="46.019989 50.726089 55.528492 57.219593 62.561092 67.01519 71.037292 75.777588 77.996986 79.733086 84.83519 87.054588 92.334892 221.63519 224.2083 228.2124 230.43181 235.13791 237.04501 241.54411 244.90381 247.12321 251.14531 255.8262 260.50531 267.40561 272.14594 276.94833 280.30444 282.52383 286.52792">CS.Base := 0;(* Flat segment *)</tspan><tspan y="-216.96365" x="46.019989 50.70089 55.503292 57.183594 61.682693 63.604195 70.564796 72.486298 75.906303 78.125702 79.887901 84.989098 87.208496 91.940697 96.621597 101.3538 106.086 110.7669 116.6241 221.5641 224.1633 228.1935 230.41289 237.67319 239.655 243.0372 247.7793 249.99869 255.27089 258.1131 263.37631 268.6575 273.3447 276.7269 281.4501 283.66949 288.28918 291.59128 296.03098 300.83337 305.57547 307.49698 311.97717 315.21896 317.17917 320.56137 325.24857 327.04767 329.26706 331.22726 338.12756 342.79675 344.72995 346.69016 351.37106 355.39227 357.61166 362.05136 364.27075 369.54294 372.38513 377.66632 382.94751 387.6347 391.01691 395.74011 397.9595 399.8927 401.85291 408.7532 410.73502 414.11722 416.33661 420.36682">CS.Limit := FFFFFH;(* With 4-KByte granularity, implies a 4-GByte limit *)</tspan><tspan y="-204.96396" x="46.019989 50.70089 55.503292 57.183594 62.401794 67.088997 71.708694 76.431892 78.651291 80.41349 85.541687 87.761086 93.033287 98.253288 221.6136 224.19299 228.22319 230.44258 235.12347 239.92137 244.60228 248.50197 253.28816 256.67035 261.39355 264.53275 267.77454 272.51483 276.95453 281.63361 283.853 287.7662 292.44711 297.1163 301.79721 303.63141 305.8508 310.2905 314.1893 318.10251 322.82571 326.84692 330.80875 335.53195 340.20114 342.42053 346.38235">CS.Type := 11;(* Execute/read code, accessed *)</tspan><tspan y="-192.96426" x="46.019989 50.721588 55.523987 57.210587 62.012985 64.232384 65.963982 71.061584 73.280983 78.561279">CS.S := 1;</tspan><tspan y="-180.96457" x="46.019989 50.718887 55.521286 57.205185 62.783386 67.878288 72.316185 74.535583 76.264481 81.42598 83.645378 88.884277">CS.DPL := 0;</tspan><tspan y="-168.96487" x="46.019989 50.721588 55.523987 57.210587 62.372086 64.591484 66.323082 71.420685 73.640083 78.92038">CS.P := 1;</tspan><tspan y="-156.96518" x="46.019989 48.11969 52.800591 55.019989 56.975689 61.757389 63.976788 66.076485 71.686188 74.523888 79.743889 85.011589 89.730286 91.949684 98.849983 103.59118 108.21088">IF in IA-32e mode</tspan><tspan y="-144.96548" x="59.519989 64.729187 70.550385 75.300583">THEN</tspan><tspan y="-132.96579" x="77.519989 82.236893 87.00779 88.709686 93.165588 95.384987 97.18679 102.28799 104.50739 109.76428 221.60458 224.18848 228.20337 230.42278 235.13968 239.91058 243.27748 246.53638 251.20828 253.42769 255.37259 259.37848 261.59787 264.96478 269.68167 271.90106 277.15796 282.41486 285.24176 289.89566 291.84055 295.20746 297.42685 304.36676 309.08365 313.73755 318.44543 320.66483 324.67972">CS.L := 1;(* Entry is to 64-bit mode *)</tspan><tspan y="-120.96609" x="77.519989 82.235992 87.005997 88.706993 94.232994 96.452393 98.198395 103.31039 105.52979 110.7858 221.54611 224.12912 228.14313 230.36253 235.78053 240.48753 245.14053 249.91054 251.85454 255.11969 259.82849 264.48328 266.70267 268.64847 271.98026 274.19965 278.91745 283.68924 285.39203 289.84882 292.06821 297.18201 299.4014 304.65921 306.8786 310.89441">CS.D := 0;(* Required if CS.L = 1 *)</tspan><tspan y="-108.96638" x="59.519989 64.25489 68.72879 73.517693">ELSE</tspan><tspan y="-96.966682" x="77.519989 82.25489 87.043793 88.724098 93.162895 95.382301 97.147202 102.2781 104.49751 109.71751">CS.L := 0;</tspan><tspan y="-84.96698" x="77.519989 82.261192 87.063591 88.752892 94.267189 96.486588 98.220886 103.38239 105.60178 110.84608 221.60638 224.17769 228.17999 230.3994 235.64369 240.92398 243.73828 248.40028 250.32179 253.68149 255.90088 259.81229 264.54269 269.21008 273.89099 276.11038 280.12979 284.8107 289.47809 296.43149 301.1124 305.91479 309.2952 313.32361">CS.D := 1;(* 32-bit code segment*)</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="453.90991pt" height="646.33398pt" viewBox="0 0 453.90991 646.33398" sodipodi:docname="1406.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.68766" inkscape:cy="426.41406" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg138" /><g transform="translate(-45.234257,-69.476563)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="45.119999 49.8009 51.901497">FI;</tspan><tspan y="-703.98029" x="45.119999 49.825199 54.627602 56.317802 61.598103 63.817505 65.552704 70.714203 72.933601 78.178802 220.73882 223.31102 227.31422 229.53363 234.77882 237.59402 242.87433 248.15552 252.81572 256.23572 260.93192 263.15131 267.83041 271.0722 275.52539 280.32779 285.13019 287.05167 291.50485 294.75204 296.73386 300.09354 304.75372 306.97311 310.97632">CS.G := 1;(* 4-KByte granularity *)</tspan><tspan y="-679.97998" x="45.119999 47.188198 51.884399 54.103798 58.906197 63.648296 68.1474 72.8265 77.522697 84.483292 89.23349 92.653488 97.097687 100.97488 105.23009 109.97128 114.72148 119.22058 123.89968 125.82118 130.50838 135.18747 137.75067 142.44687 147.60837 152.04716">IF ShadowStackEnabled(CPL)</tspan><tspan y="-667.98029" x="58.619999 63.829201 69.650398 74.400597">THEN</tspan><tspan y="-655.98059" x="76.680298 78.776398 83.500496 85.719894 87.815994 93.422096 98.686195 103.9062 108.4593 113.1834 117.90749 122.58839 128.0145 129.7236 134.18671 140.7648 146.3709 148.5903 153.7104 155.92981">IF IA32_EFER.LMA = 0</tspan><tspan y="-643.9809" x="94.680298 99.870598 105.7269 110.4582 116.3145 118.5339 120.6372 126.2505 131.5218 136.79311 141.29401 146.42131 150.89162 156.16292 160.66382 165.44911 170.19121 175.31851 177.5379 179.29921 184.42651 186.6459 191.4312 196.17329 201.3006">THEN IA32_PL3_SSP := SSP;</tspan><tspan y="-631.9812" x="94.680298 99.400795 103.8603 108.6348 113.35529 115.57469 118.16219 122.18069 124.40009 128.86859 133.52609 135.47459 140.2491 144.25861 147.6291 149.84851 153.85802 158.57852 160.79793 165.45543 167.40393 170.82393 174.78574 177.00514 182.26564 187.52614 189.27664 195.12215 197.34155 201.99905 206.71056 210.08105 212.30046 215.72046 220.46257 225.17407 227.39348 232.03297 236.50148 238.42297 243.19748 247.90898 250.12839 254.84889 258.18338 260.40277 265.06027 267.00876 270.37927 272.59866 278.44415 282.39966 287.66016 289.44031 291.65973 298.61761 303.35971 308.0856 311.36249 316.08838 318.3078 324.16769 326.38712 328.35001 332.3118 334.53122 337.91611 342.6582 347.38409 349.60352 354.28442 359.44592 365.08713 366.70892 370.73282 372.95224 379.85254 384.35165 389.08926 391.07104 398.02893 402.77103 409.72891 411.94833 413.88425 415.84714 420.63605 425.31693 429.79984 433.07672 435.92163 440.40454 445.02426 449.70337 452.98026 457.70615 461.73004 465.69183 467.91125 474.86914 476.83203 481.45175 484.81143 489.60034 491.81976 495.85266">ELSE (* adjust so bits 63:N get the value of bit N–1, where N is the CPU’s maximum linear-address width *)</tspan><tspan y="-619.98151" x="112.68031 114.77371 120.37711 125.59711 130.87743 135.42783 140.54523 145.00563 150.26703 154.81743 159.59283 164.36824 169.48564 171.70505 173.45645 178.57385 180.78061 185.259 190.839 195.40741 199.84711 204.52351 206.44502 211.23842 215.26682 218.65622 221.26262 226.05602 230.79811 235.93352 238.53992">IA32_PL3_SSP := LA_adjust(SSP);</tspan><tspan y="-607.98181" x="76.680313 81.415215 83.522118">FI;</tspan><tspan y="-595.98212" x="45.12001 49.800911 51.901508">FI;</tspan><tspan y="-571.98181" x="45.12001 49.812611 54.97411 59.405708 61.625111 63.34771 68.43631 70.716011 75.948608">CPL := 0;</tspan><tspan y="-547.98151" x="45.12001 47.18821 51.884411 54.103809 58.906212 63.648312 68.147415 72.826515 77.522713 84.483307 89.233505 92.653503 97.097702 100.9749 105.2301 109.9713 114.7215 119.2206 123.8997 125.8212 130.50839 135.18748 137.75069 142.44688 147.60838 152.04718">IF ShadowStackEnabled(CPL)</tspan><tspan y="-535.98181" x="58.62001 63.40081 68.18161 73.304413 75.523811 77.280609 82.403412 84.62281 89.88961">SSP := 0;</tspan><tspan y="-523.98212" x="45.12001 49.800911 51.901508">FI;</tspan><tspan y="-511.98242" x="45.12001 47.224209 51.905109 54.124512 58.856712 63.642914 68.262611 72.941711 76.18351 80.68261 85.424713 89.324417 94.110619 98.791519 103.57772 108.01743 112.68662 114.61982 119.30072 123.97982 126.57902 131.31122 136.43942 140.87823">IF EndbranchEnabled(CPL)</tspan><tspan y="-499.98273" x="58.62001 60.722412 66.334808 71.55481 76.835114 81.394516 86.13662 90.696022 95.426422 100.10732 105.32552 107.00582 112.16462 117.59702 123.20943 127.93983 133.15984 137.89023 143.32263 145.54202 150.66843 152.88782 160.20122 165.81361 167.91602 173.10542 177.60632 182.34753 188.04544 193.50484 198.00574 202.74695 208.60236 214.14276 219.42397 224.82397 230.43637 236.29178 241.02219">IA32_S_CET.TRACKER = WAIT_FOR_ENDBRANCH</tspan><tspan y="-487.98303" x="58.62001 60.71431 66.318611 71.538612 76.818909 81.370209 86.146507 90.697807 95.420105 100.10101 105.31921 107.0265 111.8028 117.44401 122.60551 127.72381 133.1481 137.87041 142.64671 147.42302 149.64243 154.76073 156.98013">IA32_S_CET.SUPPRESS = 0</tspan><tspan y="-475.98334" x="45.12001 49.800911 51.901508">FI;</tspan><tspan y="-456.00333" x="45.12001 49.87471 54.677109 56.362808 61.165207 65.856911 67.758614 72.498917 76.398613 79.749313 84.490509 87.733208 89.952606 91.683304 96.844803 99.064201 103.7649 108.5673 110.253 115.0554 119.7471 121.6488 126.38911 130.28882 133.63953 138.38072 141.62343">SS.Selector := CS.Selector </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-456.00333" x="143.82031">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-456.00333" x="148.74062 150.96002 156.21872 220.65874 223.24443 227.26112 229.48053 234.25323 239.02594 241.24535 243.19205 247.96475 251.97246 255.34116 257.56055 262.02725 266.68295 271.40164 276.03934 280.74902 282.96841 287.6871 292.45981 294.6792 298.69589"> 8;(* SS just above CS *)</tspan><tspan y="-444.00363" x="45.120918 47.706619 51.72332 53.942722 58.715424 63.425125 66.793823 69.013222 72.273918 76.98362 80.991318 84.360016 86.579414 91.298111 94.630814 96.850212 101.62291 106.39561 108.61501 111.9837 116.70241 118.92181 123.3885 125.6079 128.9406 130.8873 135.62491 140.3652 145.0209 147.24031 151.87801 156.34471 158.2644 163.03711 167.74681 169.96622 173.98291">(* Set rest of SS to a fixed value *)</tspan><tspan y="-432.00394" x="45.120918 49.896317 54.671715 56.378117 61.693516 66.162918 70.173317 74.885719 77.105118 78.856522 83.973923 86.193321 91.45472 220.69473 223.28313 227.30252 229.52193 234.24333 236.16573 240.63513 244.00653 246.22594 250.23634 254.94875 259.60715 266.55154 271.26395 276.03934 279.41074 281.63013 285.64954">SS.Base := 0;(* Flat segment *)</tspan><tspan y="-420.00424" x="45.120918 49.863022 54.665424 56.345726 60.844826 62.766327 69.726929 71.64843 75.068436 77.287834 79.051834 84.15303 86.372429 91.10643 95.787331 100.52133 105.25533 109.93623 115.79523 220.67493 223.27592 227.30792 229.52731 236.78761 238.76942 242.15343 246.94142 249.16081 254.38081 257.20142 262.46643 267.74762 272.43661 275.82062 280.54562 282.76501 287.436 290.6778 295.11749 299.91989 304.66199 306.5835 311.06549 314.30728 316.26929 319.65329 324.34229 326.14139 328.36078 330.32278 337.22308 341.89407 343.82907 345.79108 350.47198 354.495 356.71439 361.15408 363.37347 368.64746 371.49146 376.77444 382.05563 386.74463 390.12863 394.80954 397.02893 398.96393 400.92593 407.82623 409.80804 413.19205 415.41144 419.44345">SS.Limit := FFFFFH;(* With 4-KByte granularity, implies a 4-GByte limit *)</tspan><tspan y="-408.00455" x="45.120918 49.89452 54.668121 56.372723 61.590923 66.265526 70.922127 75.632729 77.852127 79.60173 84.717331 86.936729 92.196327 220.71634 223.30293 227.32053 229.53993 234.96153 239.67213 244.13974 248.79634 251.92294 258.86554 262.16763 264.08914 267.45874 272.16934 274.38873 279.04532 283.51291 286.88251 291.3501 293.17169 295.39108 299.85867 303.75928 307.65988 312.37048 316.37909 320.3877 325.0983 329.75488 331.97427 335.99188">SS.Type := 3;(* Read/write data, accessed *)</tspan><tspan y="-396.00485" x="45.120918 49.878319 54.680717 56.369118 61.171516 63.390919 65.124321 70.223724 72.443123 77.723427">SS.S := 1;</tspan><tspan y="-384.00516" x="45.120918 49.872017 54.674416 56.356514 61.934711 67.027809 71.463913 73.683311 75.410408 80.50351 82.783211 88.020309">SS.DPL := 0;</tspan><tspan y="-372.00546" x="45.120918 49.878319 54.680717 56.369118 61.530617 63.750019 65.483421 70.582825 72.802223 78.082527">SS.P := 1;</tspan><tspan y="-360.00577" x="45.120918 49.89452 54.668121 56.372723 61.686325 63.905727 65.655327 70.770927 72.990326 78.249924 220.69022 223.27681 227.2944 229.51381 234.77341 240.033 242.86261 247.51921 249.46681 252.83641 255.05582 259.06442 262.43402 266.90161 270.80222 275.08081 277.3002 281.30881 286.01941 290.67599 297.61859 302.32919 307.10278 310.47238 314.48999">SS.B := 1;(* 32-bit stack segment*)</tspan><tspan y="-348.00607" x="45.120918 49.88102 54.683422 56.374523 61.654823 63.874226 65.610329 70.771835 72.991234 78.237335 220.73705 223.31015 227.31425 229.53366 234.77975 237.59586 242.87616 248.15735 252.81845 256.23846 260.93558 263.15497 267.83408 271.0759 275.53 280.3324 285.1348 287.0563 291.51041 294.75851 296.74033 300.10004 304.76114 306.98053 310.98462">SS.G := 1;(* 4-KByte granularity *)</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-322.32001" x="45.119999 50.661743 53.175648 58.488312 64.128654 68.88356 71.403435 77.462105 81.360443 85.079506 90.718857 95.264603 99.24263 104.82421">Flags Affected</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-306" x="45.119999 51.243599 58.8657 62.107502 64.991104 68.772003 73.934402 76.758606 80.83741 85.51741 90.892212 96.234612 99.058815 106.15262 111.73261 117.10741 120.76951 126.18931 129.74611 132.20221 137.66251 143.3703 146.1945 151.6143 157.19431 162.5952 167.8773 173.21971">VM, IF (see Operation above)</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-280.32001" x="45.119999 51.181656 54.603912 60.003227 63.964321 69.569809 74.139458 78.100555 83.680145 89.305557 91.825439 99.52253 105.12802 110.75343 116.35892 118.8788 124.39764 129.68042 134.11958 139.69917 145.15926 149.12035 151.63823 157.24371 162.98865">Protected Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-265.98001" x="45.119999 52.465797 59.424599 64.883995 68.962799 74.670601 137.2494 141.0222 144.174 146.99818 150.77098 156.95488 162.66267 168.37047 174.13316 180.27296 185.79176 191.97566 197.61237 204.32817 209.90637 215.57817 221.81697 227.57967 233.81757 240.00146 244.08026 249.78806 255.49585 259.56564 265.32834 269.40714 272.23132 279.57712 282.40131 288.1091">#GP(0)If IA32_SYSENTER_CS[15:2] = 0.</tspan><tspan y="-252.00031" x="45.119999 52.469398 59.0448 66.009003 137.23322 141.00961 144.16501 146.9892 150.5226 156.207 161.5584 164.44199 169.36499 176.4444 182.71379 188.93819 191.76237 197.40178 201.24388 206.59528 209.75067 212.20407 217.51947 220.40306 222.79976 227.47977 230.36336 236.04776 240.72417 246.07556 251.66997">#UD If the LOCK prefix is used.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-226.32001" x="45.119999 51.298187 56.877781 62.179489 64.682434 67.753105 74.140457 79.7808 85.421143 88.843399 94.48275 99.222717 104.02245 106.48256 114.14479 119.78414 125.37469 131.01404 133.47417 139.05276 144.33556 148.71497 154.35432 159.75464 163.7755 166.25853 171.89789 177.60796">Real-Address Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-211.98" x="45.119999 52.437 59.393101 137.21249 142.73039 148.4229 153.78239 156.66599 162.81749 168.34799 174.4995 180.183 186.91049 192.45 198.1335 204.384 207.20819 209.66969 215.3622 220.04669 223.5882 227.4267 233.1192 237.8037 241.3452 243.7419 249.20219 254.8947 257.77829 260.17499 264.85501 267.73862 273.43112 278.8797 282.41849 285.24271 289.07849 294.4353 299.1171 304.57291 310.1727 315.81479 318.27359 322.94998 328.30679 333.90659 336.79019 339.24899 344.89108 347.77469 351.61047 356.96729 362.36908 364.82788 368.78699 374.19058 379.79037 385.39017 389.22595 394.58276 399.26456 403.94635 406.82996 415.57974 421.03555 426.63535 431.99216">#GPThe SYSENTER instruction is not recognized in real-address mode.</tspan><tspan y="-198.00029" x="45.119995 52.469395 59.044796 66.009003 137.23322 141.00961 144.16501 146.9892 150.5226 156.207 161.5584 164.44199 169.36499 176.4444 182.71379 188.93819 191.76237 197.40178 201.24388 206.59528 209.75067 212.20407 217.51947 220.40306 222.79976 227.47977 230.36336 236.04776 240.72417 246.07556 251.66997">#UD If the LOCK prefix is used.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-172.32001" x="45.119999 51.591011 54.078022 57.700474 61.721329 67.435379 72.741074 75.248009 78.322662 84.445076 90.622269 96.744682 102.92188 105.382 113.04821 118.68757 124.2821 129.92146 132.38159 137.91637 143.19916 147.57857 153.21793 158.61824 162.6391 165.12611 170.76547 176.47952">Virtual-8086 Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-157.98" x="45.119999 51.267899 56.6688 65.417702 70.773605 73.657204 79.013107 84.234909 88.91581 94.318512 99.917412 103.45531 105.91322 111.36812 117.05702 121.73792 124.62152 130.02242 134.70331 137.52751 139.98541 145.67432 148.49852 154.09743 157.93233 163.38722 166.92513 172.28102 176.96191 180.49982 185.85571 191.45462 194.27882 203.02773 208.48262 214.08153 219.43742">Same exceptions as in protected mode.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-132.3" x="45.119999 50.603973 56.19751 64.480247 70.093704 75.41832 79.408295 81.868416 87.508766 90.014702 92.540558 95.000679 99.02153 104.55531 107.07519 114.76032 120.35386 125.96732 131.56085 134.08073 139.63443 144.91721 149.35637 154.93596 160.39603 164.35712 166.86305 172.45659 178.18956">Compatibility Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-117.96" x="45.119999 51.267899 56.6688 65.417702 70.773605 73.657204 79.013107 84.234909 88.91581 94.318512 99.917412 103.45531 105.91322 111.36812 117.05702 121.73792 124.62152 130.02242 134.70331 137.52751 139.98541 145.67432 148.49852 154.09743 157.93233 163.38722 166.92513 172.28102 176.96191 180.49982 185.85571 191.45462 194.27882 203.02773 208.48262 214.08153 219.43742">Same exceptions as in protected mode.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-92.279999" x="45.119999 51.264324 57.408649 60.505215 66.818863 69.327789 73.320755 75.780876 83.469002 89.065529 94.681976 100.2785 102.73862 108.29531 113.57809 117.9575 123.59686 128.99718 133.01804 135.52696 141.12349 146.85945">64-Bit Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-78" x="45.119999 51.267899 56.6688 65.417702 70.773605 73.657204 79.013107 84.234909 88.91581 94.318512 99.917412 103.45531 105.91322 111.36812 117.05702 121.73792 124.62152 130.02242 134.70331 137.52751 139.98541 145.67432 148.49852 154.09743 157.93233 163.38722 166.92513 172.28102 176.96191 180.49982 185.85571 191.45462 194.27882 203.02773 208.48262 214.08153 219.43742">Same exceptions as in protected mode.</tspan></text></g></svg>     <hr />     <p class="not_instruction_page">         This <b>UNOFFICIAL</b> reference was generated from the official <a href="https://www.intel.com/content/www/us/en/developer/articles/technical/intel-sdm.html">Intel® 64 and IA-32 Architectures Software Developer’s Manual</a> by a dumb script.         There is no guarantee that some parts aren't mangled or broken and is distributed <b>WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE</b>.     </p> </body>  </html>
