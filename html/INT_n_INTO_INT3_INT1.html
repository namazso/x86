<!DOCTYPE html> <html lang="en">  <head>     <meta charset="utf-8">     <title>INT n/INTO/INT3/INT1</title>     <link rel="stylesheet" href="styles.css">     <link rel="stylesheet" href="../intel.css"> </head>  <body>     <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="512.70032pt" height="645.06775pt" viewBox="0 0 512.70032 645.06775" sodipodi:docname="610.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.84041" inkscape:cy="423.93406" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg292" /><g transform="translate(-45.11969,-68.882812)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="12" class="cA49CCA52 cD0BE81C2 c209E837B"><tspan y="-714" x="45.119999 48.321598 56.302799 63.176399">INT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="12" font-style="italic" class="cAFCCD1DD cA49CCA52 c87595EFD c209E837B"><tspan y="-714" x="66.18">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="12" class="cA49CCA52 cD0BE81C2 c209E837B"><tspan y="-714" x="73.139999 77.725197 80.930397 88.911591 95.389191 103.35839 107.94359 111.14879 119.12999 126.00719 133.38838 137.97359 141.17879 149.15999 155.99759 163.37878 173.14798 179.73718 186.13438 189.15958 192.18478 195.18478 199.86598 206.58479 209.58479 212.78999 219.5076 224.24879 230.96761 235.33681 239.70601 246.59521 253.07521 257.8764 260.8764 268.1976 272.28 279.00119 284.34 291.06119 297.8064 304.69559 308.83798">/INTO/INT3/INT1—Call to Interrupt Procedure</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-581.34003" x="235.2 237.83939 243.59726 248.27646 252.23755 255.89984 261.59796 266.17657 270.18747 272.64758 278.28693 283.98505 286.50494 293.15524 298.73483 304.34927 307.8313 313.1091 318.867 324.50137 326.96152 332.53613 338.29004 342.66946 348.28391 353.86349 356.39035 362.08847">Instruction Operand Encoding</tspan><tspan y="-509.34018" x="45.120377 51.602345 57.207832 61.986641 66.486572 70.1399 72.657791 78.117867 82.078964 84.596855 90.202347">Description</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-493.98001" x="45.119999 50.6469 56.326801 61.673702 64.557297 68.329201 75.044098 80.570999">The INT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-493.98001" x="83.460007">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-493.98001" x="89.100304 91.983902 94.447205 100.0893 104.7756 108.3189 112.1592 117.8535 122.5398 126.0831 128.5464 134.0067 139.701 142.52521 148.1295 153.4908 159.1851 164.5464 168.2085 173.61209 177.1554 182.51669 187.20299 190.02719 195.43349 198.25769 202.99799 208.40158 210.79828 213.25438 216.13799 219.68129 225.08218 227.96579 231.50909 237.2034 242.5647 245.3889 247.8522 253.54651 257.08981 262.45111 266.29141 270.13171 275.82602 281.43033 284.97363 287.85724 293.31754 297.15784 299.98206 305.34335 310.50031 315.1785 320.53171 326.1279 329.66309 332.11829 337.5705 343.25668 346.0809 351.76709 357.16528 362.85147 368.44766 370.90286 376.25607 380.08829 382.97189 387.65009 393.24628 398.59949 403.27768 405.73288 408.89008 411.34528 416.69849 422.29468 425.17828 432.52948 434.98468 438.51987 444.20605 447.03027 450.56546 456.25165 461.60486 464.48846 470.08466 475.43787 480.17816 483.71783 486.11453 491.81601 497.2142 500.74939 503.20459 508.6568 514.34302 517.16724 522.61945 528.21564 533.61835 537.28046 542.67865 548.36487 553.96106"> instruction generates a call to the interrupt or exception handler specified with the destination operand </tspan><tspan y="-483" x="45.119995 49.198795 53.880596 59.237396 64.594193 67.358093 70.896896 76.5867 81.943497 84.647095 89.387398 94.729805 99.411606 102.95041 105.40921 110.86501 116.50711 119.27101 122.80981 125.26862 128.80742 131.20412 136.56091 142.16071 144.8643 148.9881 152.7699 158.4597 161.9985 167.3553 171.1911 175.0269 180.71671 186.3165 189.8553 194.5956 197.29919 202.70099 208.37999 213.96989 216.7338 222.40469 227.6265 232.2984 237.7011 243.291 246.8199 249.2688 254.71471 260.39459 265.0665 269.18039 271.94431 274.39322 280.07312 282.83704 289.10193 294.78183 300.17374 305.81314 309.34204 314.68893 318.51483 321.21844 326.98114 329.68475 335.13065 338.28156 340.98517 344.51407 350.19397 355.54086">(see the section titled “Interrupts and Exceptions” in Chapter 6 of the </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-483" x="358.32001 362.10181 367.7916 371.33038 376.68719 379.146 388.13879 390.84238 396.60507 402.30746 405.01105 410.41284 416.10263 421.70242 424.46631 428.24811 434.38791 438.46671 444.2294 449.9462 452.64978 458.78958 462.62537 467.30716 472.94925 475.40805 478.94684 484.34955 489.02954 492.56833 498.25812 502.0939 507.45071 512.13251 514.83612 520.98492 526.44073 529.60156 533.14038 540.49518 545.89697 549.73279 555.0896">Intel® 64 and IA-32 Architectures Software </tspan><tspan y="-471.95969" x="45.120026 52.005028 57.360027 62.670029 68.072731 70.529732 75.983734 81.581734 86.936737 90.770737 93.23494 97.91494 100.73914 108.31715 113.71715 119.40515 125.09315 130.49315 132.95015 136.21715 139.04135 145.17935 150.63335 153.09035 158.77835 167.52635 172.88135 175.76495">Developer’s Manual, Volume 1</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-471.95969" x="181.44032 185.51192 188.77351 191.6571 197.18671 202.86931 208.2189 211.10249 216.6951 222.04469 226.7193 230.2509 232.7025 238.3851 243.77969 247.31129 249.76289 255.21149 260.89407 263.77768 269.22629 274.81888 280.16849 283.8909 289.28549 294.96808 300.56067 303.38489 308.05948 313.65207 319.00168 323.67627 326.12787 329.28146 331.73306 337.13577 341.81036 344.63458 350.02917 352.91278 358.13458 363.47699 368.15158 371.70032 377.17502 381.02972 383.9133 387.0372 390.8793 396.354 405.12271 407.9469 413.68259 416.50677 420.06448 425.53918 428.36337 434.09906 439.80145 445.50385 448.80594 451.63013 457.00583 462.64795 467.32797 472.78827 478.40698 483.74939 489.32941 492.21298 497.63367 502.31369 505.13788 510.55859 516.26727 519.15082 524.85321 528.93201 534.51202 536.96814 540.52582">). The destination operand specifies a vector from 0 to 255, encoded as an 8-bit </tspan><tspan y="-460.97968" x="45.119995 50.835896 56.477997 61.185898 63.5826 69.208496 74.850594 80.23349 85.813492 88.33709 90.79319 96.49469 100.05959 105.40199 109.26389 118.03979 123.3822 129.02161 131.4183 136.8219 140.3868 145.7697 148.2933 153.4548 158.8584 161.2551 166.95659 172.33949 175.5813 178.16521 183.8019 189.20549 193.8855 199.58699 202.1106 207.39268 212.73509 217.4151 220.95479 226.43669 230.29858 232.82219 238.44809 242.30998 247.71089 252.99298 255.44908 261.02908 266.41199 271.09198 273.61557 279.04346 284.75937 287.28296 289.73904 295.44055 301.02057 306.23969 311.56229 314.08588 317.62646 323.08408 325.66797 331.07156 333.59515 339.19675 344.60034 348.14093 353.49954 356.02313 361.62473 366.98334 371.66693 376.35052 380.18811 382.64871 388.25031 391.79089 397.2485 401.08609 403.60968 406.07028 411.76187 414.28546 417.82605 423.51764 428.87625 431.46014 435.24374 441.96854 446.22644 449.46823 452.05212 457.59073 463.28232 468.64093 471.16452 474.32712 476.78772 480.62531 485.3089 488.84949 491.37308 497.09167 502.81027 505.33386 510.55566 515.95837 520.64197 524.18256 529.64014 533.47772 538.16132 540.68494 546.08856 549.92615 555.28473">unsigned intermediate value. Each vector provides an index to a gate descriptor in the IDT. The first 32 vectors are </tspan><tspan y="-449.99966" x="45.119995 48.947697 54.296398 58.9701 64.318802 68.1465 73.459198 78.807899 84.399597 87.283203 92.874901 98.187599 101.07121 104.8449 110.5266 114.0573 119.40601 121.8567 124.68091 127.83361 133.28131 137.10901 139.9332 144.6069 149.9196 154.59331 158.12401 163.4727 172.2144 175.09799 180.77969 185.52 190.8687 194.12939 197.01299 203.15369 208.60138 217.34308 222.69177 225.57536 231.02307 234.17577 237.05936 240.59006 246.27176 251.62045 256.29416 261.64285 264.52646 269.74826 275.04028 279.71759 283.25189 288.70319 292.53448 297.21179 300.0954 305.49271 309.32401 314.6763 317.50052 323.18582 327.86313 333.26584 338.84586 341.67007 344.82639 350.27768 354.10898 356.9332 359.38751 365.07281 368.60712 373.95941 377.79071 383.47601 388.87332 391.32764 393.78195 399.09827 401.98187 407.57718 412.92947 418.61478 423.96707 427.68948 433.09308 436.62738 441.97968 447.57498 450.45859 455.81088 461.03268 465.70999 471.1127 476.70801 480.24231 482.69662 488.14792 493.83322 498.51053">reserved by Intel for system use. Some of these vectors are used for internally generated exceptions.</tspan><tspan y="-433.97968" x="45.119995 50.649597 56.332199 61.681801 64.326004 68.100601 74.818199 80.3964">The INT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-433.97968" x="83.039696">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-433.97968" x="88.739395 91.383598 93.837898 99.523201 104.2005 107.7348 111.5661 117.2514 121.9287 125.46301 127.9173 133.36861 139.05391 141.6981 144.1524 148.82971 151.47391 155.00821 160.69351 166.04581 168.69 174.28531 179.688 185.37331 190.776 194.4381 199.84169 202.29599 204.94019 213.68549 219.37079 224.77348 233.47649 238.92778 244.61308 247.06738 251.74469 254.38889 257.5452 262.99649 266.82779 269.47202 274.82431 280.04611 285.39841 290.07571 295.76102 299.29532 301.74963 307.43494 313.03024 315.67447 321.07178 323.69971 328.38062 333.83551 336.99542 340.53333 347.79004 353.19363 357.02853 362.38443 366.46234 372.10175 377.45764 383.14655 388.50244 392.16455 397.56546 401.10336 406.50607 412.08609 414.73032 419.41122 424.81213 427.27002 429.72791 432.37213 435.91003 441.36493 444 449.41531 455.11862 457.76282 460.23511 465.87723 469.42953 474.79984 478.64914 482.49844 488.14056 493.75388 497.30618 499.95038 505.65369 511.069 516.77228 522.38556 524.85785 530.22815 532.81024 536.052 538.69623 544.24652 549.88861 555.25891"> instruction is the general mnemonic for executing a software-generated call to an interrupt handler. The </tspan><tspan y="-422.99966" x="45.119995 48.901794 55.626595 60.964497 68.0439 70.868095 73.326897 79.016693 83.698494 87.237297 91.073097 96.762894 101.44469 104.9835 107.4423 112.8981 118.58791 121.4121 123.8709 128.5527 131.43631 136.8381 139.66231 144.3441 149.94391 155.3466 160.0266 162.4854 167.88719 170.28389 173.1675 181.9173 187.6071 193.0098 201.7128 207.16859 212.8584 215.3172 219.99899 222.8232 225.98399 231.43979 235.27559 238.09979 242.84009 248.24368 250.64038 253.09918 255.55798 261.24777 266.84756 269.67175 275.07266 280.35477 285.71158 289.54736 292.70816 295.02029 300.4671 307.8129 310.63708 315.98489 321.29669 325.96948 331.31729 336.90808 340.43787 342.88766 348.33447 354.01526 356.83945 360.90924 368.25504 375.32184 380.48065 384.55045 387.81024 390.69382 396.04163 401.26343 405.93622 411.33893 416.92972 420.4595 422.9093 428.35611 434.0369 436.92047 442.62827 445.93036 448.75455 454.28235 459.96313 465.36584 468.19003 473.63684 478.85864 484.20645 488.03326 491.18506 493.63486 499.08167 506.42746 509.31104 511.76083 517.44165 520.97144 526.37408 530.20087 534.02765 539.70844 545.34784 548.88751">INTO instruction is a special mnemonic for calling overflow exception (#OF), exception 4. The overflow interrupt </tspan><tspan y="-411.95935" x="45.119995 49.799995 55.487995 60.842995 65.522995 70.841995 75.521996 78.346199 81.883202 87.571205 92.926208 95.809807 102.8838 108.0498 110.874 114.033 116.49001 121.89001 127.48801 130.3716 132.7683 138.4698 141.35339 144.8904 150.5325 155.9352 158.75938 164.43839 169.60439 174.60838 180.75539 187.72139 193.86839 196.75198 200.58598 205.94098 211.53899 213.99599 218.67599 222.213 227.61569 231.39749 234.28108 239.68108 245.36908 250.96709 253.85068 258.53067 263.93066 266.32736 268.78348 273.46347 276.34708 279.88406 285.52615 290.92886 293.75308 299.15399 304.37579 309.7785 313.5603 316.72021 319.1781 324.633 331.98691 334.81113 337.26901 342.95792 346.49582 351.85172 355.68661 359.52151 365.21042 370.80933 374.34723 377.17145 382.86035 388.26126 393.95016 399.54907 402.00696 407.36285 411.19775 414.08136 416.53925 419.69916 422.58276 426.12067 431.80957 437.16547 439.98969 447.06458 452.23148 455.11508 458.27499 460.67169 466.0726 471.67151 474.49573 476.95361 481.63452 484.45874 489.13965 494.54236 498.08026 500.90448 504.44238 509.89728 512.78088 518.49677 521.76465 524.64825 528.72614 534.26202 539.95093 545.30682">checks the OF flag in the EFLAGS register and calls the overflow interrupt handler if the OF flag is set to 1. (The </tspan><tspan y="-400.97934" x="45.119995 48.899094 55.621193 60.959091 68.03849 70.862694 73.318794 79.005898 83.684998 87.2211 91.054199 96.696304 101.3754 104.91151 107.36761 112.82071 118.50781 121.33201 126.01111 131.4102 137.09731 142.78441 148.2375 151.77361 154.6572 160.2543 165.6084 168.49199 174.13409 178.8141 184.2168 189.7968 192.68039 195.07709 200.77859 203.66219 209.37628 215.09038 219.16647 224.76358 227.21968 230.75578 233.63937 242.38647 247.83957 253.43668 258.79077 262.05688">INTO instruction cannot be used in 64-bit mode.)</tspan><tspan y="-384.95935" x="45.119995 50.653194 56.339394 61.692593 64.575294 68.353493 75.074692 80.607895 86.321098 89.203804 91.659004 97.345207 102.02341 105.55861 109.39081 115.07701 119.75521 123.29041 125.74561 131.19781 136.88402 139.70731 145.39351 150.07172 155.42491 160.10312 162.98581 168.384 171.20729 176.65948 182.34569 187.69888 191.77408 197.37029 202.68748 206.22269 211.57588 214.45857 219.91077 225.50697 230.18518 235.63737 241.23358 246.63628 249.45956 253.53476 259.80597 266.07718 270.15237 273.03506 278.43326 284.11945 289.71564 292.53894 294.99414 299.64001 302.52271 304.9194 310.62088 314.15607 319.50928 325.19547 330.79166 336.14487 341.74106 344.62375 347.78094 353.23315 357.06537 359.94806 364.62625 370.02444 372.47964 374.87546 377.33066 383.01685 388.61304 391.49573 395.03091 400.7171 406.11981 408.94312 414.53931 419.89252 425.48871 431.1749 436.77109 439.65378 445.00699 450.22879 454.90698 460.26019 465.85638 469.39157 471.84677 477.29898 482.98517 485.86786 491.55405 496.95224 502.63843 508.23462 510.68982 516.04303 519.87524 522.69861 530.0498 532.44653 536.04657 541.68866 544.57141 549.9696">The INT3 instruction uses a one-byte opcode (CC) and is intended for calling the debug exception handler with a </tspan><tspan y="-373.97934" x="45.12001 50.714409 54.544807 59.89621 65.29261 70.608009 76.202408 81.652809 84.106209 89.790611 93.324013 95.847618 101.19902 106.42082 111.09722 116.49992 122.09432 125.62772 128.08113 133.53152 139.21593 141.73952 145.81291 153.16231 159.32372 164.73811 168.81151 172.07491 174.5985 178.67189 184.25009 189.93449 192.38789 197.0643 199.58789 205.03828 210.72269 216.07408 220.14748 225.74188 231.05728 234.59068 239.94208 242.46567 245.62106 251.07146 254.90186 263.64624 266.16983 268.62323 273.29962 275.82321 281.5076 286.18399 291.5354 294.6908 300.37518 302.82858 305.33972 310.93863 316.34134 321.02225 326.42316 332.11206 336.79297 342.14886 344.67249 347.06918 350.60889 353.13251 357.81342 363.21432 368.90323 371.42685 375.26175 380.61765 386.21655 388.61325 394.01416 398.69507 404.09778 406.6214 410.1593 415.80139 421.2041 423.72772 426.88763 429.34552 433.18042 437.86133 441.39923 443.92285 449.52176 454.84167 458.37958 463.73547 466.25909 471.71399 474.8739 477.39752 482.79843 488.44052 493.76044 496.28406 498.74194 504.43085 509.11176 512.64966 516.48456 522.17346 526.85437 530.39227 532.78894 538.24921 543.93811 546.46173 551.86261 555.40051">breakpoint exception (#BP). (This one-byte form is useful because it can replace the first byte of any instruction at </tspan><tspan y="-362.99933" x="45.120026 52.473927 58.162827 60.620728 65.301628 70.990532 73.814728 79.21563 82.099228 87.698128 91.533028 96.888931 102.28983 107.60973 113.20863 118.66354 121.12144 126.81034 130.34824 133.17244 135.63034 140.31125 143.19485 148.79376 154.14966 158.83057 161.28847 165.12337 170.47926 176.07817 179.34607 182.17027 184.62817 190.31708 194.99799 197.45589 203.14479 208.7437 211.2016 216.8905 222.48941 225.31361 230.76851 234.30641 239.99532 245.35121 249.18611 252.06972 257.52463 263.21353 268.56943 272.64734 278.24625 283.56616 287.10406 292.37973 295.20392 297.66452 303.35611 308.0397 311.58029 315.41788 321.10947 325.79306 329.33365 331.79425 337.19516 342.88675 347.57034 350.84094 353.66513 361.02173 363.48233 367.02292 372.71451 378.17212 383.86371 387.4043 390.28787 395.68878 400.91058 406.2692 410.10678 417.46338 421.30096 423.69766 427.23737 429.69797 435.38956 440.99115 443.87473 449.33234 452.87292 458.56451 463.96722 467.80481 470.629 473.0896 478.78119 483.46478 487.00537 490.84296 496.53455 501.21814 504.75873 507.15543 512.61572 518.30731 522.99091 526.26154">which a breakpoint is desired, including other one-byte instructions, without overwriting other instructions.)</tspan><tspan y="-346.97934" x="45.120026 50.656826 56.346626 61.703426 64.167625 67.949425 74.674225 80.211029 85.927826 88.392021 90.850822 96.540619 101.22242 104.76122 108.59702 114.23912 118.97942 122.51913 124.91582 130.37613 136.06593 138.53014 143.93193 146.32863 151.01042 156.46622 158.93042 164.62022 169.30202 174.65881 179.34061 181.80481 187.2066 189.6105 195.0663 200.7561 206.1129 210.1917 215.7915 221.1123 224.65111 230.0079 232.47211 237.9279 243.52771 248.2095 253.6653 259.26511 264.66782 267.07172 271.15051 276.3183 282.08099 286.15979 288.56369 293.96548 299.65527 305.25507 307.65897 313.25876 318.66147 324.35126 329.70807 333.37015 338.77374 342.31253 347.66934 352.35114 354.81534 360.21713 362.68134 368.28113 373.63794 379.23773 384.87982 390.47961 392.88351 398.28622 403.50803 408.18982 413.54663 419.14642 422.68521 425.14401 430.59982 436.28961 438.69351 442.77231 450.12711 457.0589 463.22571 467.3045 469.76871 477.1235 479.58231 483.12109 488.81088 494.26669 499.95648 503.49527 505.89917 510.58096 515.98364 519.52246 523.06128 525.45709 531.14691 536.7467 539.15063 544.55243 550.19452 555.51532">The INT1 instruction also uses a one-byte opcode (F1) and generates a debug exception (#DB) without setting any </tspan><tspan y="-335.99933" x="45.120026 50.714424 53.167824 56.701225 61.377625 64.201828 66.655228 72.33963 75.163834 82.128036 88.365036 94.076439">bits in DR6.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="7.2" class="cB46BCADE cECB6486A"><tspan y="-339.60001" x="97.379997">1</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-336" x="101.94 104.7642 111.5187 116.9232 120.7617 126.3642 133.62091 139.02451 142.86301 148.2225 151.04669 156.26849 161.67119 167.31329 172.95268 178.41118 182.24968 186.93417 189.75836 198.51086 203.85416 209.17766 212.06125 217.75375 222.43825 227.79774 230.68134 234.22284 239.86494 245.22444 248.04863 251.83313 258.56064 264.10013 269.81964 272.64386 275.10535 280.79785 285.48236 289.02386 292.86237 298.55487 303.23938 306.78088 309.17758 314.63788 320.33038 323.21399 326.3775 331.836 335.6745 338.55811 344.25061 349.65512 353.49362 359.09613 366.35284 371.75647 375.59497 380.95447 383.83807 389.44058 394.80008 400.40259 406.04468 411.64719 414.9187 417.80231 422.72531 428.18561 432.02411 434.90771 438.44922 444.09131 449.49582 453.03732 455.92093 459.75943 465.11893 470.52344 475.20795 480.66644 486.35895 489.63046 492.51407 496.29858 501.99109 505.53259 510.89209 513.35358 516.1778 520.0163 525.37579 530.0603 535.5188 544.2218"> Hardware vendors may use the INT1 instruction for hardware debug. For that reason, Intel recom-</tspan><tspan y="-324.95969" x="45.1203 53.869202 59.225101 64.914001 70.512901 75.193802 78.0774 82.758301 88.159203 91.319099 94.857002 102.1137 107.5173 111.3522 116.75491 119.5791 124.8009 130.2036 135.8457 141.48511 146.94 150.7749 155.45581 158.28001 160.73792 166.42682 171.10773 174.64563 180.00153 185.40242 191.00133 193.88493 199.57384 204.25473 209.61063 212.43483 215.97273 221.66164 227.06433 229.88853 233.66943 240.39334 245.92924 251.69194 254.51614 256.97403 262.66293 267.34384 270.88174 274.71664 280.40555 285.08646 288.62436 291.02106 296.48135 302.17026 305.05386 308.21378 313.66867 317.50357 320.38718 325.06808 330.52298 333.68289 337.22079 344.47751 349.8811 353.716 359.11871 361.94293 367.54184 371.37674 376.77945 382.18304 387.50293 393.10184 398.55673 400.95251 406.64142 410.17932 414.86023">mends software vendors instead use the INT3 instruction for software breakpoints.</tspan><tspan y="-309" x="45.1203 51.271801 56.964302 59.667904 62.064602 67.766106 71.30761 76.667107 80.505608 84.344109 89.986206 95.588707 99.130211 101.77441 107.37691 112.7364 118.4289 123.7884 127.4505 132.8541 136.3956 141.7551 147.35759 150.00179 155.60428 160.92778 163.63138 167.17288 172.86539 178.22488 180.86908 184.71028 191.42967 196.70818 203.66698 206.93848 209.64207 213.42657 220.15407 225.69357 231.41307 234.68457 237.38817 242.84666 246.68517 249.32936 253.11386 259.84137 265.38086 271.08063 273.72482 276.17822 281.86261 286.539 290.07239 293.9028 299.58719 304.26358 307.79697 310.25037 315.70078 321.38516 324.08875 329.68314 332.13654 335.29193 338.44733 343.79874 347.62915 352.30554 354.94974 358.10513 361.93555 367.38596 376.13037 378.77457 384.22498 389.90936 395.26077 397.96436 403.55875 408.96146 414.64584 420.04855 423.71066 429.11426 432.64764 437.99905 443.63846 446.28265 451.87704 457.19244 459.83664 463.67783 470.39722 475.92862">An interrupt generated by the INTO, INT3, or INT1 instruction differs from one generated by INT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-309" x="478.62061">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-309" x="484.32031 487.02393 489.47284 495.15274 497.85635 501.38525 507.06516 512.41205 515.1156 518.26648 523.7124 526.16132 528.61023 534.05615 541.40106 543.84998 549.52985 555.11975"> in the following </tspan><tspan y="-297.95969" x="45.120331 52.396832 57.720329 63.00243 67.682426 71.76123">ways: </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-282.95999" x="45.119999">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-282.95999" x="62.099998 67.643997 73.340996 78.704994 81.108894 86.805893 92.26889 96.111893 104.8689 110.27789 112.6746 115.1388 118.9278 126.0108 131.43781 136.45081 138.85471 143.595 149.23711 154.6011 159.2901 164.5722 169.2522 171.7164 177.32339 182.78639 185.2506 190.9476 196.4106 199.9566 202.3605 207.8235 212.5125 217.20149 222.8985 226.7415 229.2057 231.67171 237.31381 239.77802 245.10602 247.57202 251.35382 254.89352 260.59052 265.99951 268.46552 272.55151 278.27551 283.99951 289.72351 295.44751 297.91171 306.6687 312.13171 317.73871 323.10272 326.37872 328.78262 334.32663 339.96872 345.33273 347.73663 350.20264 355.89963 359.44562 364.80963 368.65262 372.49561 378.1926 383.79959 387.34558 389.80978 392.27579 396.96478 399.36868 402.91467 408.32367 413.60577 418.94818 424.64517 427.04907 431.13507 438.49707 440.96307 444.50906 450.20605 455.60696 461.30396 464.84995 467.31415 470.48215 475.89114 481.58813 483.98483 487.53082 491.61682 494.08102 501.39801 503.85413 507.40012 513.09711 515.56134 520.97034 526.55219 531.88019 534.28412 538.07312 545.15613 550.58313 555.59613">The normal IOPL checks do not occur in virtual-8086 mode. The interrupt is taken (without fault) with any IOPL </tspan><tspan y="-271.97998" x="62.099998 67.261497 72.6651 75.121201 80.763306 86.166008">value.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-256.98001" x="45.119999">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-256.98001" x="62.099998 67.643997 73.340996 78.704994 81.52919 83.995193 89.692192 93.23819 98.602188 102.44519 106.28819 111.98519 117.59219 121.13819 123.96239 127.80539 133.16939 138.77638 141.24239 145.08539 150.44939 155.13838 158.68439 161.15039 166.61339 172.31039 175.1346 180.4986 186.1956 191.6046 197.21159 199.6776 205.0416 210.64859 213.47279 219.07979 224.40779 227.23199 230.778 236.47501 241.839 244.66321 249.99121 252.38791 256.2309 259.77689 265.47388 270.88287 273.34888 277.43488 283.15887 288.88287 294.60687 300.33087 303.21445 311.91745 317.37778 322.98477 328.14001 330.9642 336.32642 341.65262 345.19681 350.55902 356.20111 360.8811 363.34531 368.80652 374.50171 379.1889 382.01309 386.09729 392.2515 399.8367 405.52289 409.60709 412.43127 418.03647 423.49768 428.85989 433.54709 436.37128 442.06647 447.52768 451.07187 453.95544 459.35635 464.03635 468.77664 474.41873 477.00082 480.30292 483.12711 488.66931 494.3645 499.72672 502.61029 505.07449 510.71658 514.2608 519.62299 523.46417 527.30536 532.94745 538.55267 542.09686 544.92108 547.38525 552.07245">The interrupt redirection enabled by the virtual-8086 mode extensions (VME) does not occur. The interrupt is </tspan><tspan y="-246.00002" x="62.100006 67.502708 69.96241 77.219109 82.562408 87.884109 92.566811 95.391006 101.0817 106.48441 112.1751 117.7758 120.2355 125.5932 131.19391 134.07751 139.67822 144.99992 147.82413 153.22682 156.05103 161.65173 165.48843 170.94513 174.48483 179.84253 184.52522 188.06493 193.42262 199.02332 203.10301 211.80602 217.26631 222.867 228.2247 231.0489 236.73961 242.1423 247.83301 253.43372 255.89342 261.25113 263.83322">always handled by a protected-mode handler.</tspan><tspan y="-229.98001" x="45.119705 49.194904 54.728104 60.414303 65.767502 70.445702 75.848404 78.612305 81.769508 87.122711 92.520912 96.056114 101.74232 105.57452 110.92772 115.60592 118.43012 124.02632 129.47852 132.24242 137.92862 143.38081 146.91602 149.74022 155.33643 160.68962 164.52182 168.05702 173.45522 175.91042 181.59662 184.36052 187.89572 193.34792 196.17212 202.44331 209.40752 215.12071 220.83391 224.136 226.8999 230.4351 236.12131 241.4745 244.29871 248.4189 254.1051 259.55731 263.38953 272.13574 277.53394 279.98914 284.10934 286.87323 292.58643 296.66162 302.25781 307.55969 311.103 316.46429 319.28851 324.74881 330.35312 335.03943 340.49973 346.10403 351.46533 354.22925 357.39456 362.85486 366.69516 369.45908 373.24536 379.97467 385.51596 388.27988 394.00119 397.27448 400.03839 403.82468 409.51898 413.06229 418.42358 420.82028 423.6445 429.05081 434.74512 440.34943 443.11334 450.69763 453.09341 457.83371 461.61551 467.07581 471.76212 477.22241 480.38773 483.93103 486.75525 492.16156 496.84787 501.53418 506.89548 515.64978 521.25409 523.71741 529.07874 532.91901 537.60529 540.42944 547.78876 550.25208 552.71539 555.11212">(These features do not pertain to CD03, the “normal” 2-byte opcode for INT 3. Intel and Microsoft assemblers will </tspan><tspan y="-219.00002" x="45.11969 50.813992 56.274292 59.817593 62.641796 68.246094 73.607391 79.249489 84.652184 88.314285 93.717888 97.261185 102.62248 105.50608 109.04938 114.74368 120.10497 122.92917 129.20847 136.14476 141.86606 147.58736 150.41156 155.87186 161.47615 166.16245 171.62274 177.22704 182.58833 185.47194 188.63724 192.47754 197.93784 206.69214 209.57574 214.98204 220.56384 225.88914 228.71335 237.46765 243.16196 248.52325 257.27756 262.73785 268.37997 270.84326 275.52957 278.80286 281.62708 287.23138 292.92569 296.46899 299.3526 302.8959 308.59021 310.98691 315.53998 318.42358 323.87219 329.46478 334.13937 339.58798 345.18057 350.58328 353.4075 358.08209 363.47668 369.15927 371.98349 377.62289 382.9653 385.84891 390.5235 394.35211 399.70172 405.09631 408.6279 413.97751 419.5701 422.4537 428.0463 433.35989 436.18411 441.7767 444.2283 448.05692 453.40652 458.08112 461.6127 464.49631 470.17889 475.86148 484.6041 490.00681 493.84891 496.30051 500.9751 503.8587 508.53329 513.98187 519.57446 524.92407 527.80768 533.40027 538.74988 541.9035 544.3551 550.03772 552.48932">not generate the CD03 opcode from any mnemonic, but this opcode can be created by direct numeric code defini-</tspan><tspan y="-207.95972" x="45.11969 48.662991 51.126289 56.58659 62.228691 65.112289 70.572586 74.412888 77.237083 82.841385 88.166687 90.990883 95.677185 101.03848 103.43519 106.43938 110.52268 119.22569 124.68599 130.29028 132.68698 135.81088 141.13618 143.59949 149.24159 154.88098 157.70518 162.39148 167.85178 173.45607 178.81737 182.09067">tion or by self-modifying code.)</tspan><tspan y="-192.00002" x="45.11969 50.649292 56.331894 61.681496 64.565102 69.959702 74.6343 78.165901 80.6175 86.018402 91.719902 94.603508 100.05211 103.20571 106.08932 109.62092 115.30352 120.65312 123.47733 127.25192 134.03163 139.56123">The action of the INT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-192.00002" x="142.37999">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-192.00002" x="148.0797 150.96329 153.35999 159.06149 163.74329 167.28209 171.11789 176.80769 181.48949 185.02829 187.48709 192.94289 198.58499 201.46858 205.54738 208.00618 213.69598 218.37778 220.77448 226.47598 232.07578 234.53458 240.22438 245.82419 248.70778 252.24658 257.93637 263.29318 266.1174 269.8992 276.62399 281.96188 288.92068 292.18948 295.07309 298.85489 305.57968 311.11649 316.83328 320.10208 322.9263 328.32809 334.01788 339.61768 342.44189 346.22369 352.94849 358.48529 364.24799 367.0722 369.53101 375.22079 379.90259 383.44138 387.27716 392.96695 397.64874 401.18753 403.58423 409.04453 414.73431 419.41611 423.4949 426.37851 428.77432 433.45432 436.33792 441.01971 443.47852 452.2283 454.6871 457.1459 462.5477 466.38348 469.2077 472.74649 478.2023 481.08591 484.62469 490.31448 495.71628 499.25507 502.07928 507.5351 510.69589 513.52008 518.92188 521.80548 524.96631 530.3681 534.20392 537.08752 541.76935 547.17114 549.62994 552.02667"> instruction (including the INTO, INT3, and INT1 instructions) is similar to that of a far call </tspan><tspan y="-180.95972" x="45.119698 53.8713 59.274899 64.876495 70.235092 73.11869 80.475288 82.93589 86.476494 92.168091 94.992287 98.53289 104.22449 109.58308 112.46668 118.74329 124.89389 129.90149 134.90909 137.73329 140.19389 145.8855 150.56909 154.1097 157.9473 163.6389 168.32249 171.8631 174.2598 179.72009 185.4117 188.6823 191.5065 197.0451 202.73671 208.09531 210.91951 216.52112 220.32001 222.78061 231.53221 236.93581 240.77341 246.09601 248.9796 254.58121 257.04181 260.20441 263.367 268.72562 272.5632 277.92181 283.6134 288.297 293.65561 296.53922 298.93591 303.61591 306.49951 310.0401 315.73169 321.13528 324.67587 327.50009 334.85669 337.25339 340.79398 346.48557 349.36917 352.90976 358.60135 363.95996 366.78418 370.56778 377.29437 382.83298">made with the CALL instruction. The primary difference is that with the INT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-180.95972" x="385.6203">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-180.95972" x="391.32001 394.14423 396.60123 402.28922 406.96921 410.5062 414.34021 420.0282 424.70819 428.24518 430.70218 436.15619 441.79828 445.10037 447.92459 451.46158 457.14957 462.50458 465.38818 471.06717 476.23315 481.23715 487.38416 494.35016 500.49716 503.38077 507.21478 512.56976 518.16779 520.62476 525.30475 528.84174 534.19672 538.0307 540.91431 543.31097 547.99097"> instruction, the EFLAGS register is </tspan><tspan y="-169.97972" x="45.11969 50.714989 56.400288 61.077587 66.762886 72.115189 77.710487 80.594093 86.045395 91.730698 95.264999 100.7163 103.5405 107.07481 112.76011 118.11241 120.99602 125.67332 129.20761 134.6049 139.28221 144.59851 147.4821 153.07741 158.4297 161.586 167.03729 170.86859 176.22089 179.09999 182.63969 188.3304 193.6881 196.51228 200.34898 205.70668 209.24638 214.93709 218.71889 224.42039 227.30399 232.70668 238.30737 243.90808 247.74478 253.10248 257.78519 262.4679 265.73761 268.62122 272.70093 278.23862 283.92932 289.28702 292.17062 296.00732 301.36502 304.90472 310.59543 314.43213 320.07422 322.95782 328.36053 333.96124 339.56195 343.39865 348.75635 353.43906 358.12177 360.94598 363.40567 368.03967 370.92328 376.32599 379.15021 382.31192 387.71463 391.55133 394.37555 399.77826 405.37897 410.97968 414.81638 420.17407 424.85678 429.53949 432.4231 437.1058 442.5625 448.2532 452.93591 455.33261 460.01263 463.55234 466.01202 471.70273 477.30344 480.18704 485.64374 488.80545 491.68906 495.22876 500.91946 506.27716 509.10138 513.78406 519.47473 523.3114 527.14807 532.5058 538.19647 541.73615">pushed onto the stack before the return address. (The return address is a far address consisting of the current </tspan><tspan y="-158.99973" x="45.119659 50.281162 55.684761 58.081463 63.782963 69.142464 73.826965 76.230865 81.689369 84.852867 87.256767 90.798271 96.440369 101.79987 104.14346 110.42096 116.57246 118.91605 124.32056 130.01306 135.61555 138.01945 143.65616 147.43706 152.85956 155.20316 159.04166 164.40115 170.00365 172.46515 177.14964 180.69115 186.05064 189.88914 194.57364 197.84514 201.92664 204.27023 210.32724 215.66963 219.21114 224.90364 228.74214 234.43465 239.11914 241.46274 244.62624 248.46474 253.92323 262.62622 264.96985 267.43134 273.12384 276.66534 282.02484 285.86334 289.70184 295.39435 300.99686 304.43936 306.84326 312.44037 316.27347 321.72656 326.40567 331.75977 337.35687 343.04398 346.87708 352.27979 356.95978 359.30338 364.70248 368.53558 373.88968 376.23328 381.92038 387.31949 393.00659 398.6037 401.05978 406.41388 412.01099 414.35458 421.7067 424.16278 427.69888 433.38599 435.72958 439.26569 444.95279 450.30688 452.71078 456.4899 462.73499 468.41309 473.94717 476.29077 478.74686 484.43396 489.17426 492.71396 496.49576 502.19727 506.87637 510.41248 512.86859 518.32172 524.00879 527.2749 529.67877 537.03088 542.71796 545.17407 549.85315 555.54022">values of the CS and EIP registers.) Returns from interrupt procedures are handled with the IRET instruction, which </tspan><tspan y="-147.95943" x="45.119659 50.72036 56.177059 61.77776 66.460457 69.344055 72.883759 78.574455 83.932159 86.756355 92.438057 97.606758 102.61346 108.76315 115.73186 121.88156 124.70576 127.16546 132.85616 136.01785 141.47455 145.31125 154.06195 159.46465 163.00435 165.46405 170.92075 176.61145 179.43565 184.83835 190.52905 196.12976 199.01337 202.85007 208.20776 211.74747 217.43817 221.27487 226.96558 229.78978 235.19247 240.79318 246.39389 250.23059 255.58829 260.271 264.9537 267.83731 270.99902 274.83572 280.29242 289.04312 291.86734 295.40704 301.09775 306.45544 309.33905 314.02176 317.56146 322.96417 327.64688 332.96857">pops the EFLAGS information and return address from the stack.</tspan><tspan y="-131.99973" x="45.119659 50.806759 56.214859 60.902958 66.545059 68.948959 74.411057 77.534958 79.878555 83.423653 89.119751 94.482849 96.826447 100.61455 107.34565 112.88875">Each of the INT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-131.99973" x="115.19996">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-131.99973" x="120.89966 124.17116 126.51476 130.29926 137.02675 142.36465 149.26407 152.53557 154.87917 160.28366 165.97617 171.57866 173.92226 177.70676 184.48645 190.02596 195.74545 198.08905 200.55055 206.24306 210.92755 214.46906 218.30756 224.00006 228.68456 232.22606 234.68756 240.08846 245.78096 250.46545 252.80905 258.41156 263.77106 269.46356 274.82306 278.48517 283.88879 287.4888 292.83121 297.51572 299.85934 305.26385 307.60748 313.20999 318.56949 324.26199 329.62149 333.2836 338.68723 341.14871 345.23022 350.83273 354.67123 360.12973 363.67123 369.07394 373.75397 377.29547 379.69217 385.15067 390.84317 393.1868 398.58951 403.81128 408.49579 413.85529 419.45779 422.9993 425.46078 430.91928 436.61179 438.95541 443.03693 450.39444 457.36493 462.78741 466.86893 469.21255 471.67404 474.83755 477.18118 480.72269 486.41519 491.77469 494.11832 500.39581 505.8183 510.82681 513.17041 515.6319 520.31641 522.66003 528.26251 532.10101 537.46051 542.86499 546.40649 551.8092 555.64771">, INTO, and INT3 instructions generates a general-protection exception (#GP) if the CPL is greater </tspan><tspan y="-120.95943" x="45.119659 48.658459 54.348259 59.750061 65.439865 68.264061 71.802864 77.492661 82.849457 85.733055 92.664856 98.084656 103.09045 105.91465 111.07615 116.47975 118.93855 124.62836 129.98515 132.80936 135.26816 140.95796 143.78217 147.32097 153.01077 158.36757 161.25117 165.93297 171.28976 173.74857 179.10536 183.78716 187.32596 192.72865 198.30865 201.13286 206.73267 212.13446 215.67326 221.03006 223.85426 229.45407 234.81087 239.49266 244.17445 248.01025 250.46906 256.06885 259.60764 265.06345 268.89923 271.78281 274.1795 279.88098 282.76456 286.30334 291.94543 297.34814 300.17233 303.95413 310.67892 314.93683 318.23892 321.06311 324.84491 330.5347 333.35889 338.04068 343.49649 349.18628 352.72507 356.44745 361.85104 366.53284 370.07162 373.34042 376.224 379.76279 385.40488 390.80759 393.63177 397.41357 404.13837 409.67517 415.39197 418.21616 420.67496 426.36475 431.04654 434.58533 438.42111 444.1109 448.79269 452.33148 454.72818 460.18848 465.87827 468.76184 473.44363 478.84543 484.53522 487.35941 492.9592 498.36191 500.75861 503.21472 508.43652 513.83923 517.67505 520.49927 525.90106 528.78467 536.13947 543.07129 549.2381">than the DPL value in the selected gate descriptor in the IDT. In contrast, the INT1 instruction can deliver a #DB </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-700.97974" x="48.359661 54.323963 59.370262 63.329361 68.368462 73.414764 147.33447 149.72577 154.88007 159.07947 162.68037 165.94467 171.09897 175.19127 178.77057 181.05026 186.02997 259.58786 265.52695 270.57324 274.05444">OpcodeInstructionOp/ </tspan><tspan y="-691.01941" x="259.61935 264.59814">En</tspan><tspan y="-700.97974" x="284.39905 289.92685 295.45465 298.22845 303.90924 306.15204 309.73584">64-Bit </tspan><tspan y="-691.01941" x="284.39905 291.31195 296.33484 301.37573">Mode</tspan><tspan y="-700.97974" x="332.39874 337.32175 342.34375 349.84344 354.88345 359.66245 363.23544">Compat/</tspan><tspan y="-691.01941" x="332.39874 336.77905 341.81818 346.91846 349.13876 356.03815 361.07727 366.11725">Leg Mode</tspan><tspan y="-700.97974" x="379.13843 384.95602 389.98163 394.26022 398.39932 401.66092 403.89651 408.75653 412.35742 414.59302 419.61862">Description</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-676.02002" x="48.358734 53.090034 147.35065 149.45395 155.31024 160.50055 259.68054 264.59906 284.45755 290.09875 294.59787 296.53018 298.45166 332.47076 338.17227 342.61197 344.53348 346.49277 379.19247 384.47278 389.15366 393.93896 398.61984 401.89313 406.33282 409.71411 414.4364 416.65582 421.27551 424.57761 429.25848 433.7576 438.04791 442.6676 447.3989 449.35818 454.10028 457.45996 459.67938 463.06067 466.33395 470.77365 475.45276">CCINT3ZOValidValidGenerate breakpoint trap.</tspan><tspan y="-661.01971" x="48.358734 53.082832 58.616932">CD </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-661.01971" x="60.839035 62.939636">ib</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-661.01971" x="147.35873 149.43683 155.26793 160.43303">INT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-661.01971" x="162.65874 164.73773 171.76674 178.79575">imm8</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-661.01971" x="259.61844 284.39905 290.04025 294.53934 296.46082 298.39221 332.41132 338.11282 342.55252 344.45691 346.43872 379.13843 384.41873 389.11313 393.91556 398.60995 401.91205 406.36343 409.71683 414.45712 416.67651 420.66891 425.37231 428.68973 432.04312 438.96951 443.4209 446.66629 451.40659 453.62598 455.55737 460.35977 463.71317 468.45346 471.69885 474.94424 479.74667 484.38708 487.80707 490.02646 496.95285 498.93466 502.28806 507.04547 509.26486 513.94397 518.62488 522.50928 525.86267 530.5661 533.81152">IValidValidGenerate software interrupt with vector </tspan><tspan y="-649.97943" x="379.13843 383.16144 387.78113 392.50613 396.42114 398.34265 401.70145 403.62296 408.36325 412.98294 415.20233 419.87332 424.56232 426.78171 428.70322 435.66022 442.61722 447.29813 451.96912 453.89062 458.37262 461.75662 466.43753 468.65692 473.32791 478.01691 481.40091 486.12592">specified by immediate byte.</tspan><tspan y="-634.97913" x="48.358734 53.080135 147.34073 149.43413 155.28053 160.46094 259.63916 264.55765 284.41614 286.50955 291.28494 295.92535 300.39474 302.31714 304.26654 332.46622 338.16772 342.63712 344.55951 346.50891 379.20859 384.47897 389.19138 393.96677 398.57843 401.83643 406.30042 409.66641 414.37341 416.5928 421.30881 425.94382 430.65082 433.90881 437.2388 439.15579 443.8718 450.81079 453.03018 456.45016 459.69196 464.15594 468.80896 471.02835 472.97235 476.30234 478.52173 483.23773 487.87274 492.57974 495.83774 499.16772 501.14862 505.86462 512.80365 515.02301 518.35303 520.27002 524.73401 529.38702 531.60638 533.55035 537.55536 539.77472 545.0307">CEINTOZOInvalidValidGenerate overflow trap if overflow flag is 1.</tspan><tspan y="-619.97882" x="48.358734 53.099934 147.36053 149.46114 155.28233 160.43753 259.61755 264.77277 284.39096 290.04117 294.54028 296.43747 298.36166 332.38077 338.08228 342.52649 344.42368 346.40546 379.10516 384.38547 389.06638 393.86877 398.54968 401.85178 406.2915 409.6377 414.37799 416.59741 421.23062 425.97092 430.60413 435.40652 440.03973 442.25916 445.67914 448.92093 453.36514 458.04425">F1INT1ZOValidValidGenerate debug trap.</tspan><tspan y="-566.99854" x="56.038433 61.736336 66.415436 69.533943 74.275139 127.13754 132.83545 137.51456 142.19547 145.25726 149.75636 154.49847 159.17758 161.39699 243.47699 249.1749 253.854 258.5943 261.6561 266.09579 270.89819 275.51788 277.73727 360.29788 366.05609 370.67578 375.41608 378.47787 382.91757 387.71997 392.33966 394.55905 477.83966 483.59787 488.21756 492.95786 496.01965 500.45935 505.26175 509.94083 512.16022">Op/EnOperand 1Operand 2Operand 3Operand 4</tspan><tspan y="-550.97852" x="62.218735 67.13723 141.17574 146.99693 257.51694 263.33813 374.33783 380.21841 491.93811 497.8187">ZONANANANA</tspan><tspan y="-535.0188" x="66.478432 136.31934 138.30113 145.26173 152.16205 257.52237 263.34357 374.34326 380.22388 491.94357 497.82416">Iimm8NANANA</tspan></text><clipPath><path transform="matrix(1,0,0,-1,0,792)" d="m 45.12,97.26 h 512.7 V 85.86 H 45.12 Z" inkscape:connector-curvature="0" class="cC2A381AD" /></clipPath><g clip-path="url(#cp249)"><clipPath><path transform="matrix(1,0,0,-1,0,792)" d="M 0,792.03 H 612 V 0.0300293 H 0 Z" inkscape:connector-curvature="0" /></clipPath><g clip-path="url(#cp250)"><path transform="matrix(1,0,0,-1,45.12,697.02)" d="M 0,0 V 0.48" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.12,94.98 h 144.24 v 0.480018 H 45.12 Z" inkscape:connector-curvature="0" /></g></g><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-79.860001" x="45.119999 50.34 59.520901 64.679703 69.482109 74.16301 76.382416 83.343918 88.086021 92.815521 99.71582 104.45432 109.24683 111.16833 115.06803 117.28744 119.39793 124.13644 128.81734 134.15884 139.29335 141.51274 146.30524 150.74493 154.77243 156.99182 161.43152 163.35301 167.38051 172.119 174.33839 179.0139 183.69481 188.37572 193.17812 195.39751 200.19 204.15179 208.8813 213.50101 215.7204 218.89919 223.64038 226.88219 229.10158 232.49008 237.23218 241.96169 244.18108 246.10258 250.90498 254.80647 258.16617 261.40796 266.21036 270.12985 273.51834 275.48483 280.16574 284.95825 287.17767 294.07797 296.05975 299.44824 304.24075 306.46017 311.14108 315.82019 319.47958 324.16049 328.836 333.51688 335.7363 340.47479 345.7533">1.The mnemonic ICEBP has also been used for the instruction with opcode F1.</tspan></text><path transform="matrix(1,0,0,-1,0,792)" d="m 45.12,614.22 h 0.47998 v 95.52 H 45.12 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 144.12,613.74 h 0.47999 v 96.48 H 144.12 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 256.38,613.74 h 0.48003 v 96.48 H 256.38 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 281.16,613.74 h 0.47999 v 96.48 H 281.16 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 329.16,613.74 h 0.48 v 96.48 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 375.9,613.74 h 0.48 v 96.48 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 557.28,614.22 h 0.48 v 95.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.12,709.74 h 512.7 v 0.48 H 45.12 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.12,684.78 h 512.7 v 0.4801 H 45.12 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.12,669.78 h 512.7 v 0.4801 H 45.12 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.12,643.74 h 512.7 v 0.48 H 45.12 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.12,628.74 h 512.7 v 0.48 H 45.12 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.12,613.74 h 512.7 v 0.48 H 45.12 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.6,530.22 h 0.48001 v 47.52 H 45.6 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 88.98,529.74 h 0.48001 v 48.48 H 88.98 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 204.3,529.74 h 0.48 v 48.48 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 321.72,529.74 h 0.48 v 48.48 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 437.94,529.74 h 0.48 v 48.48 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 556.86,530.22 h 0.47999 v 47.52 H 556.86 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.6,577.74 h 511.73999 v 0.48 H 45.6 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.6,561.78 h 511.73999 v 0.48 H 45.6 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.6,545.76 h 511.73999 v 0.48 H 45.6 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.6,529.74 h 511.73999 v 0.48 H 45.6 Z" inkscape:connector-curvature="0" /></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="514.73999pt" height="619.01886pt" viewBox="0 0 514.73999 619.01886" sodipodi:docname="611.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="348.48" inkscape:cy="389.54269" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg314" /><g transform="translate(-44.64,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-715.97998" x="46.02 51.379501 56.601303 61.960804 67.602905 70.427101 72.888603 76.052101 78.876297 82.417801 88.110298 93.469795 96.293991 102.57149 107.99399 113.00249 115.82668 118.22339 122.90339 125.72758 131.33008 135.16858 140.52808 145.93257 149.47408 154.83357 158.67207 161.43597 164.97748 170.66998 176.07448 181.76698 184.53088 188.07239 193.76489 199.12439 201.88829 208.82278 214.24529 219.25378 221.99971 227.4528 230.6109 233.4351 239.03221 244.43491 249.11401 253.79312 257.62622 260.02292 265.66232 269.19843 274.65152 278.48462 281.24854 286.96265 289.78687 292.24295 297.93005 300.69397 304.23007 309.91718 315.27127 318.09549 321.8746 328.5994 332.85727 336.09909 338.92331 342.99942 348.53351 354.22061 356.6767 361.3558 364.11972 369.71683 375.11954 380.80664 386.09055 391.40863 393.83942 399.29431 403.12921 405.89313 410.57404 416.26294 421.86185 427.46075 432.91565 436.75055 440.28845 444.96936 447.73328 451.27118 456.96008 462.31598 465.1402 470.8291 475.51001 480.86591 483.69012 489.09103 492.27524 495.09946 498.88037 505.60428 511.14017 516.85608 519.6803 525.27917 530.59906 533.36298 539.05188 544.45276 548.28766 553.88654">even if the CPL is greater than the DPL of descriptor 1 in the IDT. (This behavior supports the use of INT1 by hard-</tspan><tspan y="-705" x="46.019104 53.275806 58.679405 62.516106 67.87381 70.757408 75.97921 81.321617 87.012314 92.613014 98.069717 101.90642 106.58912 109.47272 115.07342 120.43112 124.26782 127.42952 132.88622 136.72292 145.47362 147.87032 153.56102 159.16171 161.9859 167.67661 173.0793 176.916 182.51669 189.77339 195.17699 199.01369 204.37138 207.25497 212.85568 218.21338 223.81409 229.50479 235.1055 238.3752">ware vendors performing hardware debug.)</tspan><tspan y="-688.97998" x="46.019104 51.559505 57.252907 62.613308 65.077507 70.299309 75.641708 80.32711 83.869507 89.328903 93.168304 95.6325 100.3179 105.9213 111.2817 115.9671 118.36381 121.548 124.01041 129.3708 134.0562 136.5204 141.9258 147.6192 150.0231 152.4855 158.17891 161.72131 167.08171 170.92111 174.76051 180.45392 186.05731 189.59972 192.06392 197.66731 203.02771 207.7131 212.3985 216.2379 218.6346 224.27399 227.81639 233.27579 237.11519 239.51909 241.98149 247.6749 250.0788 253.6212 259.31461 264.67502 267.07892 269.54132 275.23471 278.7771 284.13751 287.9769 291.81628 297.50967 303.11307 306.65546 309.11966 314.72305 320.08347 324.76886 329.50916 333.29095 335.74707 341.35046 344.89285 350.29376 354.13583 356.60004 360.14243 365.54782 371.15121 373.61362 378.97403 381.43823 385.52063 389.30603 396.03082 401.54874 405.63113 409.71353 412.17773 415.72012 421.41351 426.81891 430.3613 432.8255 435.2222 439.90219 443.17459 445.63879 448.03461 451.57431 454.03851 459.64191 463.48129 468.8822 474.22369 476.6861 482.28949 487.6499 492.3353 494.7995 497.2619 502.90399 508.50739 513.8678 519.1922 521.59613 524.05853 529.75195 533.29437 538.75378 541.15771 544.70013 550.39355 555.75397">The vector specifies an interrupt descriptor in the interrupt descriptor table (IDT); that is, it provides index into the </tspan><tspan y="-678" x="46.019104 49.800903 56.525703 60.783604 64.025406 66.909004 72.445801 78.135605 83.492401 86.375999 91.0578 96.414597 98.873398 104.23019 108.91199 112.4508 117.8076 123.4074 126.2316 128.6904 134.3802 137.91901 143.2758 147.1116 150.9474 156.63721 162.237 165.7758 168.59999 174.1998 179.55659 184.23839 188.92018 192.75598 195.21478 200.81458 204.35338 209.80917 213.64497 216.52856 218.92526 224.62677 227.51036 231.04916 236.69127 240.52707 246.21687 249.10046 253.78226 259.23807 264.88016 268.41983 273.82162 276.28043 281.97021 286.65201 289.53561 294.93741 297.76163 303.36142 308.81723 311.27603 316.96582 320.50461 325.86142 329.6972 332.58081 336.1196 341.52051 344.40411 349.9877 355.8692 358.87341 361.50952 367.39102 371.11072 376.63312 380.65521 384.67731 390.55881 396.31879 400.03848 403.04269 408.68301 412.70511 415.70932 421.23172 426.69382 431.5538 437.0762 442.83618 446.55588 449.19199 454.83231 460.71381 463.71802 469.59952 475.18311 481.06461 486.82458 489.46069 494.98309 499.00519 502.0094 507.76938 511.79147 517.43176 522.29181 527.81421 533.63361 539.51514 543.53723 549.05963 552.48145">IDT. The selected interrupt descriptor in turn contains a pointer to an interrupt or exception handler procedure. </tspan><tspan y="-667.02002" x="46.019104 49.980003 55.861504 58.505707 64.325104 68.347206 73.987511 77.707214 83.229614 88.089615 91.809319 97.331718 103.15112 105.79531 114.73862 120.37892 126.13892 131.72163 135.14343 137.84703 141.56673 147.44823 152.97063 155.67422 159.63513 166.53993 172.23784 174.94144 179.80144 185.38234 191.26384 194.98354 200.56712 203.20323 209.08473 213.94473 216.64833 222.23192 228.11342 230.75761 236.3412 240.3633 244.2009 249.7242 255.2457 257.94928 263.5896 266.89349 269.59708 275.31567 279.39627 284.99786 290.32047 293.86105 299.21967 301.80356 307.40515 312.76376 317.44736 322.13095 325.96854 328.42914 334.03073 337.57132 343.02893 346.86652 351.55011 354.82071 357.3443 362.70291 368.10651 372.7901 378.48169 381.06558 386.52319 389.68579 392.26968 399.62628 405.31787 407.77847 412.46207 418.15366 420.67725 423.13785 427.82144 430.34503 435.74863 441.44022 443.96381 446.42441 452.116 455.65659 461.0152 464.85278 468.69037 474.38196 479.98355 483.52414 486.04773 491.64932 497.05292 500.59351 505.95212 509.22272 511.74631 515.28693 518.94904 524.35266 529.95428 532.53821 538.13983 543.54346 547.08405 552.44263 555.71326">In protected mode, the IDT contains an array of 8-byte descriptors, each of which is an interrupt gate, trap gate, </tspan><tspan y="-655.97974" x="46.019104 51.479404 55.321507 57.605705 61.145405 66.549004 71.229004 76.570503 78.854706 84.434708 89.83831 93.378014 98.720413 102.02251 104.30672 108.08762 113.78912 116.07332 119.91542 125.25783 130.66142 133.11752 137.13693 142.54053 148.31943 154.09833 158.11322 163.64912 168.56943 173.43033 175.83423 184.76312 190.39803 196.17693 201.71283 205.19493 207.59883 211.31673 217.18562 222.72153 225.12543 229.08633 235.99113 241.74933 244.15323 246.79112 251.65202 254.05592 259.63681 265.50571 267.90961 273.49051 277.5054 281.3475 286.87082 292.37073 294.77463 300.40952 303.65939 306.06329 311.95648 316.21167 321.98788 327.48508 331.20029 336.73349 339.19769 342.53488 348.11307 352.12527 354.58948 360.36569 365.99789 368.63309 374.4993 378.21451 383.74771 387.75992 392.61813 395.02203 399.27722 405.17041 409.4256 415.20181 420.69901 424.41422 429.94742 432.41162 437.26984 442.90204 448.67825 454.21146 456.67566 461.53387 467.06708 472.84329 481.7695 487.3027 493.16891 496.88412 499.28802 504.14624 509.72894 512.30475 517.88745 522.74567 526.46088 532.09308 536.10529 538.50922 544.0874 549.95361 555.7298">or task gate. In real-address mode, the IDT is an array of 4-byte far pointers (2-byte code segment selector and </tspan><tspan y="-644.99976" x="46.019104 51.421803 54.246002 60.008701 64.087502 69.688202 75.009903 78.549606 83.952301 86.776497 89.236198 94.926895 99.609596 103.1493 106.986 112.6281 117.3108 120.8505 123.3102 128.76691 134.45761 137.28181 142.88251 148.3392 150.7359 156.43741 159.97711 165.37981 169.21651 173.2962 176.5659 179.39011 184.7928 190.1964 194.87909 200.56979 203.394 208.85069 212.01239 214.83659 222.19229 227.883 230.27969 234.95969 240.65039 243.534 249.1347 254.5914 257.05109 262.69318 266.23288 269.11649 274.71719 277.17688 281.01358 286.37128 291.05399 294.59369 297.05338 302.33911 305.16333 308.70483 314.16333 317.04694 322.45145 325.27567 330.87817 334.71667 340.17517 344.85968 350.21918 355.82169 361.51419 365.35269 370.71219 373.53641 375.99789 381.6904 384.51462 388.05612 393.74863 399.10812 401.93234 406.61685 411.97635 414.43784 419.79733 424.48184 428.02335 433.38284 438.98535 441.86896 446.55347 451.91296 457.51547 466.26797 471.62747 477.31998 480.86148 484.133 486.95721 491.03873 497.76624 503.22473 506.76624 512.12573 515.00934 518.55084 524.24335 529.64783 533.18933 536.01355 538.47504 544.16754">a 2-byte instruction pointer), each of which point directly to a procedure in the selected segment. (Note that in </tspan><tspan y="-634.01978" x="46.019104 49.849503 55.200905 60.597305 63.050705 67.009804 72.413406 78.052803 83.632805 87.463203 92.814606 97.491005 102.1674 105.05101 113.79541 119.24581 124.88521 130.2276 133.52969 136.35388 139.88728 145.57169 150.92308 153.80667 157.58307 164.30788 169.83928 172.66347 175.11687 179.79327 182.67686 187.35327 192.74966 195.14636 197.60246 202.95386 208.59326 211.41745 214.95085 220.63525 225.98665">real-address mode, the IDT is called the </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c89C0ADDA"><tspan y="-634.01978" x="228.83879 231.90779 238.30679 242.40179 248.36879 252.86789 257.30759 263.70657 269.98859 274.08359 276.8457 282.68671 288.65372 293.93671 298.03171 304.20572 308.7048 311.46692 315.56192 321.56491 327.84692 330.91592">interrupt vector table</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-634.01978" x="336.89908 340.16968 343.05325 348.45685 354.09894 359.70053 362.52472 364.98532 368.52591 373.2095 376.03369 381.63528 387.0929 389.48959 395.19107 398.73166 404.13437 407.91617 412.65646 415.48065 420.88425 424.72183 430.08044 432.96402 437.64761 443.05121 445.51181 447.90851 453.31122 458.8912 461.71539 464.17599 469.86758 473.40817 478.76678 482.60437 486.44196 492.13354 497.73514 501.27573 504.1593 509.3811 514.72351 519.4071 522.94769 528.40527 532.24286 536.92645 540.19708 544.27771">, and its pointers are called interrupt vectors.) </tspan><tspan y="-617.99976" x="46.019073 51.560375 57.254677 62.615978 65.31958 68.484879 73.945175 76.341881 78.797981 84.258286 91.617584 94.01429 99.71579 105.32009 107.96429 113.56859 118.92989 123.61619 126.07949 130.76579 133.2291 138.68939 144.3315 147.0351 150.5784 155.9847 161.58899 163.98569 169.34698 172.05058 174.44728 180.14879 185.75308 188.21638 192.90268 198.30898 201.85228 207.21358 211.89987 214.60347 221.96277 227.65707 230.12038 234.80667 240.44878 243.15237 248.55867 253.24496 256.78827 259.25156 264.71185 270.40616 273.10977 275.57306 281.21518 283.91879 287.4621 293.1564 298.5177 301.22131 303.6846 309.1449 316.50421 321.86551 325.70581 328.40942 334.01373 339.47403 343.31433 346.85764 349.32092 354.78122 360.42334 363.12695 368.58725 371.75256 374.45618 377.99948 383.69379 389.05508 391.7587 395.302 400.70831 406.31262 408.77591 414.13721 416.84082 419.30411 423.99042 426.69403 430.23734 435.64365 440.86545 446.20786 451.90216 454.60577 460.21008 462.67337 467.89517 473.29788 478.99219 481.63641 485.17972 490.87402 496.23532 498.87955 503.61984 509.02075 514.71503 520.31934 522.71515 526.25482 528.71814 534.17847 539.87274 544.55902 547.26263 549.72595 555.36804">The following decision table indicates which action in the lower portion of the table is taken given the conditions in </tspan><tspan y="-607.01978" x="46.019073 49.556973 55.245872 60.601772 63.425976 69.114876 74.713776 80.312675 85.668579 89.503479 92.387077 97.985977 103.44088 107.27578 110.81368 113.27158 118.67249 124.36139 127.24499 132.69989 135.85979 138.74338 142.28128 147.97018 153.32608 156.15027 159.68817 165.08907 170.68797 173.14587 178.50177 181.76967 184.65326 190.33316 195.73405 200.47435 206.11646 209.00005 214.52695 217.35114 219.80904 225.49794 228.32213 231.86003 237.54893 242.90483 245.72902 248.18692 253.64182 260.99573 266.35162 270.18652 273.07013 277.75104 283.10693 287.78784 291.32574 293.78363 299.15936 304.84555 307.66974 313.12195 316.27914 319.10333 322.63852 328.32471 333.67792 336.56149 342.15768 347.51089 352.25119 354.64789 359.32608 361.78128 367.23349 372.91968 375.74387 379.27905 384.67725 390.31665 392.71335 398.11606 400.94025 404.77246 410.12567 415.76508 419.60718 424.96039 429.63858 434.99179 440.67798 444.21317 448.89136 451.77493 457.17313 459.99731 465.59351 469.42572 474.87793 479.55612 484.95883 490.53882 496.22501 500.05722 505.41043 508.23462 513.87402 519.21643 522.37366 524.82886 530.51508 535.91779 541.51398 544.3382 546.7934 552.47961">the upper portion of the table. Each Y in the lower section of the decision table represents a procedure defined in </tspan><tspan y="-595.97949" x="46.019073 49.559673 55.251274 60.609875 63.434074 67.559677 74.637276 80.238876 85.641571 89.303673 94.707275 98.247879 100.70848 106.16608 111.80818 115.93378 118.81738 123.50098 128.85959 133.54318 137.08379 139.54439 145.00198 150.69359 153.51779 156.68039 162.13799 165.97559 168.79979 172.34039 178.032 180.4926 185.17619 188.0004 190.461 196.1526 200.8362 204.3768 208.2144 213.90601 218.5896 222.1302 224.5269 229.9872 235.6788 238.56241 242.64301 248.0016 253.2234 257.90341 263.26202 268.86362 272.40421 275.22839 282.58499 289.5546 294.9762 299.05679">the “Operation” section for this instruction (except #GP).</tspan><tspan y="-201.9595" x="46.019073 54.904774 60.586475 65.935173 71.616875 74.441078 77.971779 83.653481 89.002182 91.885788 97.477486 101.30518 106.75288 111.42658 116.77528 121.44898 126.18928 131.59018 135.41788 138.30147 140.75217 145.42587 148.25006 153.59875 158.82056 164.22325 168.90326 174.58496 178.11566 180.56636 186.24806 191.83977 194.72336 197.17406 202.85576 205.73935 211.05205 213.50275 217.33044 220.86115 226.54285 231.93655 234.38725 238.45795 244.16664 249.87534 255.63803 261.34674 264.17096 272.91266 278.36035 283.95206 289.35474 292.61545 295.49905 299.02975 304.71146 310.11414 312.93835 316.71207 323.75906 329.17886 334.18466 337.00888 342.60867 347.96548 351.50427 356.86108 360.69687 369.44666 371.90546 377.59525 382.95206 387.63385 390.45807 393.99686 399.68665 405.04346 407.92706 413.32886 418.01065 421.54944 424.00824 429.46405 435.10614 437.98975 443.44556 446.60635 449.43057 452.96936 458.65915 464.01596 466.89957 470.68137 477.40616 482.94296 485.76718 491.45697 494.34058 496.73639 502.43787 507.11966 510.65845 514.49426 520.18408 524.86591 528.40472 530.86353 536.31934 542.00916 545.27795 548.16156 551.94336 555.10419">When the processor is executing in virtual-8086 mode, the IOPL determines the action of the INT n instruction. If </tspan><tspan y="-190.97951" x="46.019073 49.557873 55.247673 60.604473 63.008373 66.790176 73.865974 79.285774 84.291573 86.63517 89.093971 93.775772 96.179672 98.638474 103.99527 108.67707 113.35887 115.76277 119.30157 124.99138 130.39317 136.08298 138.48688 144.20367 147.47247 149.81607 153.35487 159.04468 164.44737 166.79097 172.39078 176.22658 181.68237 186.36417 191.72096 196.40276 201.08455 206.54034 210.37614 212.78004 218.37985 223.78255 229.42465 234.82735 238.48944 243.89304 247.43184 252.78864 257.47043 259.87433 265.27612 267.68002 275.03482 282.00262 287.42242 291.50122 296.18301 301.53983 303.99863 309.35544 314.03723 317.51938 322.96799 326.7966 330.86819 333.27209 338.6748 343.89661 348.5712 353.92081 359.5134 363.04498 365.49658 370.94519 376.62778 380.69937 383.10327 385.55487 388.70847 391.11237 394.64395 400.32654 405.67615 408.08005 411.85464 418.92325 424.33585 429.37946 431.78336 434.23495 438.90955 441.31345 447.02304 450.28464 452.68854 456.22012 461.90271 467.25232 469.65622 475.29562 479.13773 484.58633 489.32663 494.67624 499.35083 504.02542 509.47403 513.30261 515.70654 521.05615 526.27795 531.62756 536.30219 541.9848 545.51642 550.86603 555.54065">the IOPL is less than 3, the processor generates a #GP(selector) exception; if the IOPL is 3, the processor executes </tspan><tspan y="-179.99951" x="46.019073 51.413673 54.057873 59.650475 63.479076 68.927673 72.459274 77.808876 82.483475 86.015076 91.417778 97.010376 99.654579 108.39718 113.84578 119.43838 124.78798 127.43218 129.88379 135.56639 139.09799 144.44759 148.27618 152.10478 157.78738 163.37999 166.91159 169.55579 173.08739 178.53598 181.18018 186.81958 190.66168 193.11328 198.42688 200.87848 203.33008 208.67967 214.27228 219.67497 222.31917 224.77077 230.17346 235.39526 240.73766 243.18925 245.83345 251.54305 254.84514 257.48935 263.01895 268.70154 274.05115 276.69534 279.14694 284.82953 288.36111 293.71072 297.53934 301.36795 307.05054 312.64313 316.19907 318.84329 324.444 329.84671 333.38641 338.74411 341.15881 345.84152 348.48575 355.41846 360.83917 365.84589 368.49011 377.19312 382.89462 387.57733 391.11703 393.76126 399.36197 404.71967 407.36389 412.0466 417.4043 420.944 423.64761 427.18732 432.58823 435.29184 441.00955 443.65378 449.05649 454.74719 460.3479 462.99213 466.53183 472.22253 477.58023 480.22446 483.76416 489.16687 493.00357 498.60428 503.96198 507.50168 510.1459 516.42163 521.84235 526.84906 529.49323 534.94995 538.11163 540.7558 544.29547 549.98615 555.34387">a protected mode interrupt to privilege level 0. The interrupt gate's DPL must be set to 3 and the target CPL of the </tspan><tspan y="-168.95921" x="46.019073 48.482372 54.124474 57.667774 63.029076 66.869377 70.709679 76.351776 81.956078 85.499374 88.32357 94.017868 99.424171 105.11847 110.72277 113.18607 118.54737 122.38767 125.27127 130.87556 134.71587 140.17616 144.86246 150.22375 155.82805 161.52235 165.36266 170.72395 173.54816 182.30246 187.99677 192.68306 196.22636 199.05057 204.65486 210.01616 212.84036 218.56166 221.44527 224.98857 230.44887 233.27307 238.63437 243.79587 249.15717 253.84346 259.53775 263.08105 268.44235 271.26657 274.80988 280.50418 285.86548 288.74908 294.35339 298.1937 303.65399 307.1973 312.55859 317.2449 320.78821 326.14951 331.75381 334.63742 343.34042 348.80072 354.40503 359.76633 362.59055 365.05383 370.74814 374.29144 379.65274 383.49304 387.33334 393.02765 398.63196 402.17526 405.05887 408.60217 414.06247 416.88669 422.491 426.3313 428.79459 434.11987 436.58316 438.97986 444.34116 449.94547 455.30676 458.19037 460.58707 465.98978 471.21158 476.55399 479.01727 481.84149 487.56281">interrupt handler procedure must be 0 to execute the protected mode interrupt to privilege level 0.</tspan><tspan y="-152.99951" x="46.019073 51.551376 57.236675 62.588974 65.172874 67.627174 73.312477 76.846779 82.199081 86.03038 89.861679 95.546982 101.14228 104.67658 107.32079 112.91608 118.26839 122.94569 127.62299 131.45428 133.90858 139.50389 143.1039 148.50479 152.33609 154.98029 158.51459 163.91188 169.50719 171.96149 177.31378 179.89767 183.72897 189.13167 194.72697 197.18127 201.85858 205.39288 210.74518 214.57648 217.16037 221.23466 225.01196 231.73677 237.31497 243.55827 247.63257 250.21646 254.89377 260.48907 265.89178 270.57178 273.02609 276.1824 278.63672 283.98901 288.66632 291.31055 294.84485 300.48694 305.88965 308.39877 313.99768 319.39859 324.0795 329.48221 332.06613 334.52402 336.9819 342.67081 348.07352 353.47711 357.31201 359.89594 365.29684 370.89575 376.49466 380.32956 385.68546 390.36636 395.04727 397.6312 403.0321 408.72101 414.31992 416.96414 419.42203 421.81781 430.56671 433.0246 436.5625 439.14642 444.60132 447.76123 450.34515 453.88306 459.57196 464.92786 467.57208 471.353 478.07782 482.33569 485.57751 488.16144 493.69733 499.38623 504.78894 507.37286 509.83075 515.51965 517.91547 521.45514 523.91302 529.3139 531.77179 534.35571 539.95459 545.35547 550.03638 555.39227">The interrupt descriptor table register (IDTR) specifies the base linear address and limit of the IDT. The initial base </tspan><tspan y="-141.95921" x="46.019073 51.422672 57.024273 62.625874 66.46347 71.822067 76.505669 81.18927 84.013466 89.174965 94.578568 97.039169 102.73077 108.08936 110.91356 116.37116 119.53376 122.35796 125.89856 131.59016 136.94876 139.83237 143.61597 150.34076 155.87936 162.12897 165.01257 170.41617 173.57877 177.17877 182.52116 186.35876 189.18297 192.72357 198.41518 203.77377 206.65738 212.25897 216.09657 221.55417 226.23776 231.59636 236.27995 240.96355 246.42114 250.25874 253.14235 255.60295 260.28656 263.11075 268.71234 274.16995 281.52655 286.88516 290.72275 296.08136 301.68295 304.50714 310.19873 315.80032 318.6839 324.14151 327.9791 330.80328 334.64087 339.99948 344.68307 350.04169 353.58228 356.40646 358.86707 363.55066 366.37485 372.09344">address value of the IDTR after the processor is powered up or reset is 0.</tspan><tspan y="-125.99951" x="46.019073 52.016674 57.419376 60.583778 65.944176 69.783577 72.607773 76.150169 81.609573 84.433769 90.712166 96.405563 101.81097 107.41437 110.95676 116.31716 120.15656 123.04016 128.76056 132.03296 134.85716 138.98456 144.40796 148.24736 153.70676 158.39215 163.75255 169.35594 175.04935 178.88875 184.24915 187.07335 193.35175 198.75714 201.21954 203.57938 208.27557 211.55878 214.38298 218.17918 223.88338 227.43658 232.80779 236.58958 240.43169 246.13588 251.75008 255.30328 259.99948 263.24127 266.12485 271.54105 277.18314 282.79733 285.62152 291.31671 296.53851 301.23471 306.57709 312.19128 315.74448 318.21768 323.61859 329.32278 334.01898 338.1572 341.04077 346.45697 352.09906 357.71326 360.53745 366.82666 372.47968 377.87787 383.47406 387.00925 392.36246 396.19467 399.07828 404.79147 410.50467 413.80676 416.63098 420.75119 427.0224 432.47461 438.1608 441.69598 445.5282 450.98041 453.43561 457.5108 462.67502 465.13022 470.58243 477.93362 480.81723 486.49445 492.18063 495.33783 500.79004 504.62225 509.30045 514.65363 523.39984 528.75305 534.43927 537.97449">Refer to Chapter 6, “Procedure Calls, Interrupts, and Exceptions” and Chapter 18, “Control-Flow Enforcement </tspan><tspan y="-114.95921" x="46.019958 50.578457 55.920856 60.601757 66.290657 71.979561 77.434464 79.892365 85.347267 90.946167 96.266068 99.090263 103.16817 109.44207 115.12197 120.65788 124.73578 128.85867 131.74226 134.20016 139.84227 142.72586 146.26376 151.95267 157.30856">Technology (CET)” in the </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-114.95921" x="160.13995 163.91545 169.59895 173.13145 178.53415 180.98665 189.97314 192.85674 198.56723 204.27773 207.16132 212.55682 218.24033 223.83383 226.65802 230.49922 236.62282 240.69531 246.40581 252.1163 254.99989 261.13339 264.96289 269.6384 275.3219 277.77441 281.30692 286.65741 291.33292 294.86542 300.54892 304.37842 309.72891 314.46921 317.29343 323.43591 328.88541 332.03992 335.57242 342.92093 348.31644 352.14594 357.49643 360.32065 367.20114 372.55164 377.85715 383.20764 385.66016 391.10965 396.70316 402.10583 405.93533 408.34283 413.01834 415.90195 423.47543 428.87094 434.55444 440.23795 445.70184 448.15796 451.42047 454.30408 460.43759 465.88708 468.3396 474.0231 482.7666 488.16928 490.9935">Intel® 64 and IA-32 Architectures Software Developer’s Manual, Volume 1</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-114.95921" x="496.67966 499.56326 502.72766 508.12857 511.96796 514.85156 521.08942 526.78638 532.32678"> for CET </tspan><tspan y="-103.97921" x="46.019958 51.614357 56.965759 60.499161 65.895561 68.348961 70.802361 75.47876">details.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-572.34003" x="240.72 245.81754 251.15509 256.79544 259.31631 264.8999 267.41977 273.55115 276.63477 282.76614 288.89752 291.35565 293.81577 296.33563 302.79568 308.37927 312.927 315.42297 320.17987 322.67584 328.25943 333.98245 336.44257 341.59985 346.93744 352.54092 355.05682">Table 3-52.  Decision Table</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-556.97998" x="48.84 54.3615">PE</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-556.97998" x="161.7603 191.40089 235.98149 276.18179 333.48209 390.18207 447.42206 505.38205">01111111</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-541.02026" x="48.840004 54.720604">VM</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-541.02026" x="161.7603 191.40089 235.98149 276.18179 333.48209 390.18298 447.42297 505.38297">–––––011</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-525.00024" x="48.840004 51.233105 57.199203 62.679302">IOPL</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-525.00024" x="161.7603 191.40089 235.98149 276.18179 333.48209 390.18298 447.42389 452.40271 505.383 510.48416">––––––&lt;3=3</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-508.98026" x="48.840004 54.654903 60.176403 64.677307 68.098206 73.022102 78.543602 83.044502">DPL/CPL </tspan><tspan y="-499.98026" x="48.840004 54.357903 59.396107 63.896107 69.115204 74.212807 76.612206 82.61161 88.791916 93.831017 100.01132 102.41072">RELATIONSHIP</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-508.98026" x="161.7603 191.40089 196.91878 202.01999 206.45879">–DPL&lt;</tspan><tspan y="-499.98026" x="191.39999 196.09259 201.18118">CPL</tspan><tspan y="-508.98026" x="235.97969 276.17999 281.69788 286.79907 291.29816">–DPL&gt;</tspan><tspan y="-499.98026" x="276.17999 280.9032 286.0224">CPL</tspan><tspan y="-508.98026" x="333.48029 338.9964 344.09851 348.5976">DPL=</tspan><tspan y="-499.98026" x="333.48029 338.19537 343.30649 347.76059 349.97998 354.69507 357.95218 360.17157">CPL or C</tspan><tspan y="-508.98026" x="390.1803 395.75848 400.85971 405.29852">DPL&lt;</tspan><tspan y="-499.98026" x="390.1803 394.9035 400.02271 404.48489 406.70428 412.65149 414.87088 420.71909">CPL &amp; NC</tspan><tspan y="-508.98026" x="447.42029 505.3812">––</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-483.96027" x="48.839966 51.240265 57.240566 62.158169 67.196373 72.926674 78.656975 84.684273 90.025772 95.180069 97.400368 102.55466 108.03297 113.52026">INTERRUPT TYPE</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-483.96027" x="161.76025 191.40085 196.14294 199.26144 235.98145 276.18173 333.48203 390.18292 447.42383 505.38474">–S/W––––––</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-468.00058" x="48.839958 54.410957 59.569759 64.547661 69.526459 71.746758 76.930756 82.438759 87.899956">GATE TYPE</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-468.00058" x="161.76025 191.40085 235.98145 240.53995 244.97964 249.00175 276.18088 281.03906 284.10086 288.54056 293.21964 295.43903 300.11993 303.42203">––TaskTrap or </tspan><tspan y="-459.00058" x="276.17996 278.26257 282.88495 286.24554 290.98584 294.23843 297.49103 302.29343 306.73315">Interrupt</tspan><tspan y="-468.00058" x="333.48026 338.33847 341.40027 345.83997 350.51907 352.73846 357.47968 360.72147">Trap or </tspan><tspan y="-459.00058" x="333.48026 335.57095 340.19336 343.56207 348.27176 351.53247 354.79318 359.56589 364.00558">Interrupt</tspan><tspan y="-468.00058" x="390.18027 395.03848 398.10028 402.59937 407.21909 409.43848 414.17969 417.42148">Trap or </tspan><tspan y="-459.00058" x="390.18027 392.27097 396.89337 400.26208 404.97177 408.23248 411.49319 416.2659 420.7056">Interrupt</tspan><tspan y="-468.00058" x="447.42026 452.21906 455.28085 459.77994 464.39963 466.61902 471.36023 474.60202">Trap or </tspan><tspan y="-459.00058" x="447.42026 449.46594 454.19363 457.51733 462.18204 465.48413 468.72592 473.52832 477.96802">Interrupt</tspan><tspan y="-468.00058" x="505.38025 510.23846 513.30029 517.73999 522.41907 524.63849 529.3797 532.62152">Trap or </tspan><tspan y="-459.00058" x="505.38025 507.46286 512.08527 515.44586 520.18616 523.43878 526.69141 531.49377 535.93347">Interrupt</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-442.98059" x="48.839966 54.357864 59.396065 64.975166 69.295166 72.114868 77.87397 83.687973 89.501976 95.019882 100.00588 105.00089 109.99589 112.81559 119.72759 125.68559 131.49959">REAL-ADDRESS-MODE</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-442.98059" x="161.76025">Y</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-426.9606" x="48.839958 54.352459 59.93066 65.630363 70.547958 75.526764 80.508263 85.425858 90.404663 96.259163 99.018562 105.91796 111.91736 117.77186">PROTECTED-MODE</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-426.9606" x="191.39996 235.98146 276.18265 333.48386 390.18567 447.42749 505.38931">YYYYYYY</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-411.00092" x="48.839966 53.975365 59.733562 65.48996 70.958359 73.717758 79.717155 85.428558 88.24826 90.629662 96.570564 101.54846 106.52726 112.23866 117.99686 124.00526 129.34676 133.84496">TRAP-OR-INTERRUPT-</tspan><tspan y="-402.00092" x="48.839966 54.418167 59.576965 64.554863">GATE</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-411.00092" x="276.17996 333.48117 390.18298 447.4248 505.38663">YYYYY</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-385.98093" x="48.839966 51.236668 57.236969 62.154568 67.192764 72.919464 75.694168 81.177872 86.904572 89.30127 95.144974 97.541672 101.86167 106.85938 112.39708 117.39478 120.16948 124.54978 129.52858 135.10948 140.08827 144.40828">INTER-PRIVILEGE-LEVEL-</tspan><tspan y="-376.98093" x="48.839966 51.230366 57.230663 62.148266 67.186462 72.90686 78.627258 84.644661 89.98616">INTERRUPT</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-385.98093" x="390.18027">Y</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-360.96094" x="48.839966 51.240265 57.240566 62.394867 68.125168 73.900467 76.678764 82.166061 87.896362 90.296661 96.143959 98.544258 102.86426 107.86555 113.40685 118.40816 121.18645 125.50645 130.54465 136.06525 141.04404 145.36404">INTRA-PRIVILEGE-LEVEL-</tspan><tspan y="-351.96094" x="48.839966 51.230366 57.230663 62.148266 67.186462 72.90686 78.627258 84.644661 89.98616">INTERRUPT</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-360.96094" x="333.48026">Y</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-336.00125" x="48.839966 51.229465 57.229763 62.147366 67.185562 72.90506 78.624557 84.64106 89.982559 94.480759 97.240158 102.23066 107.80886 113.77136 120.68787">INTERRUPT-FROM-</tspan><tspan y="-327.00125" x="48.839966 54.72057 57.119968 62.518169 67.676064 73.556664 79.196068 83.516068 86.275467 91.796967 97.318466 102.83997 108.41817 111.18567 118.10217 124.06467 129.88318">VIRTUAL-8086-MODE</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-336.00125" x="505.38025">Y</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-310.98126" x="48.839966 53.457867 59.216965 64.195763 69.656059 72.415459 77.99366 83.152458 88.130356">TASK-GATE</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-310.98126" x="235.97968">Y</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-294.96127" x="48.839966 54.881668 60.419369">#GP</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-294.96127" x="191.39996 276.18176 447.42297">YYY</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2 c209E837B"><tspan y="-279.00159" x="48.839966 55.078766 60.778465 65.69606 70.674858 75.71666">NOTES:</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-265.98129" x="60.119667">−</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-265.98129" x="80.579369 86.099068 90.808769 95.572472 97.251869 100.61157 102.83098 107.54068 111.99838 115.06018 119.80048">Don't Care.</tspan><tspan y="-252.961" x="59.939667 80.641472 85.082977 89.793579 93.802177 95.623779 97.843178 102.31078 106.21137 109.58097 111.52857 116.24817 121.02177 123.24117 126.61076 131.07837 135.09776 139.83806 144.61166">YYes, action taken.</tspan><tspan y="-240.00099" x="48.839966 54.162567 56.092167 60.568768 65.351364 78.490463 80.709862 86.229568 90.129265 93.549263 95.470757 100.19936 104.98196 107.20135 111.98396 116.48486 119.86346 122.08286 125.46146 129.93805 133.95744 138.63835 143.42096">Blank Action not taken.</tspan><tspan y="-226.9807" x="48.839966 53.628868 56.770767 77.410469 79.629875 85.209869 89.888969 94.508667 96.430168 98.393066 103.07397 107.09787 109.31728 112.55728 117.29848 119.51789 121.62479 127.2057">S/W Applies to INT</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-226.9807" x="134.27966">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-226.9807" x="139.13966 140.96486 143.18427 145.27946 150.86037 156.04257 161.30577 163.13097 165.35037 169.82158 174.59879 179.25899 181.47839 183.57359 189.1545 194.0127 199.7106 201.5358 203.7552 208.37491 213.17732 216.55052 218.76993 223.54713 228.04803 231.42123 233.64064 236.88065 241.62186 243.84126 245.93646 251.51736 256.69955 261.96277">, INT3, and INTO, but not to INT1.</tspan></text><path transform="matrix(1,0,0,-1,0,792)" d="m 44.64,290.22 h 0.48001 v 277.5 H 44.64 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 157.5,289.74 h 0.48 v 278.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 187.14,289.74 h 0.48 v 278.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 231.72,289.74 h 0.48 v 278.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 271.92,289.74 h 0.48 v 278.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 329.22,289.74 h 0.48 v 278.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 385.98,289.74 h 0.48 v 278.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 443.16,289.74 h 0.47999 V 568.26 H 443.16 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 501.12,289.74 h 0.48 v 278.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 558.84,290.22 h 0.48 v 277.5 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 44.64,567.78 h 514.74 v 0.48 H 44.64 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 44.64,551.76 h 514.74 v 0.48 H 44.64 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 44.64,535.74 h 514.74 v 0.48 H 44.64 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 44.64,519.72 h 514.74 v 0.48 H 44.64 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 44.64,494.76 h 514.74 v 0.48 H 44.64 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 44.64,478.74 h 514.74 v 0.48 H 44.64 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 44.64,453.72 h 514.74 v 0.48 H 44.64 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 44.64,437.76 h 514.74 v 0.48 H 44.64 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 44.64,421.74 h 514.74 v 0.48 H 44.64 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 44.64,396.72 h 514.74 v 0.48 H 44.64 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 44.64,371.76 h 514.74 v 0.48 H 44.64 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 44.64,346.74 h 514.74 v 0.48 H 44.64 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 44.64,321.72 h 514.74 v 0.48 H 44.64 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 44.64,305.76 h 514.74 v 0.48 H 44.64 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 44.64,289.74 h 514.74 v 0.48 H 44.64 Z" inkscape:connector-curvature="0" /></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="512.0918pt" height="643.48663pt" viewBox="0 0 512.0918 643.48663" sodipodi:docname="612.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.84001" inkscape:cy="422.16638" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg260" /><g transform="translate(-45.119995,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c1AE6E0A5"><tspan y="-715.97998" x="45.119999 47.582397 53.104797 58.084499 61.085102 64.597801 70.108498 75.088196 78.088791 80.602493 86.06459 91.575287 93.797386 99.308083 102.82079 108.33148 113.31118 116.82388 119.33759 124.79968 130.32208">Instruction ordering.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-715.97998" x="132.78 135.60419 139.38599 145.07579 149.75758 153.29639 157.13219 162.82199 167.50378 171.04259 173.50139 178.90228 184.59209 189.27388 192.15747 195.31827 200.71916 203.17796 205.63676 211.09256 218.44736 220.90616 226.59596 232.19577 235.07936 240.48116 246.17096 248.99515 252.77695 259.50174 265.03854"> Instructions following an INT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-715.97998" x="267.89972">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-715.97998" x="273.59943 276.42365 285.17343 290.51672 295.83752 298.72113 304.32092 309.67773 312.56134 315.72214 321.07895 324.61774 329.29953 334.98932 340.34613 345.94592 348.82953 351.99033 355.82611 361.22702 369.9903 372.8739 381.57687 386.97958 395.68256 401.14285 404.97864 410.29944 413.18304 418.78284 424.13965 427.30045 432.75626 436.59204 441.94885 444.77307 450.12988 455.53168 459.36746 461.76416 464.22296 469.57977 473.41556 476.29916 478.75797 484.40005 489.14035 492.68002 496.51581 502.1579 506.83969 510.37848 512.83728 518.29309 523.98291 528.66473"> may be fetched from memory before earlier instructions </tspan><tspan y="-705" x="45.119125 49.800026 55.254929 64.00383 69.60273 72.060631 77.416534 80.954437 86.310341 89.193939 94.549843 99.771645 105.12755 109.80845 115.49735 119.03526 121.49316 126.94806 132.63696 135.90486 138.72906 144.32797 150.01688 153.55478 156.37898 159.91689 165.60579 170.96169 176.28159 179.10579 186.45969 188.91759 191.31429 193.77039 196.65399 202.3429 207.79779 211.33569 214.2193 219.5752 224.797 230.15289 234.8338 240.52271 244.06061 249.4165 252.30011 256.37802 261.73392 266.95572 272.35843 278.04733 280.87155 285.55246 291.15137 296.55408 301.2341 306.923 309.3197 314.72061 318.25851 320.7164 325.9382 331.34091 333.73761 339.0575 343.13541 346.01901 351.70792 357.39682 360.93472 363.39261 365.85049 368.67471 374.07562 376.53351 378.99139 381.81561 384.2735 389.9624 394.64331 398.18121 402.01611 407.70502 412.38593 415.92383 418.32053 423.78082 429.46973 434.15063 437.03424 442.63315 446.46805 448.92593 454.38083 458.21573 461.03995 464.57785 470.03275 472.85696 476.39487 482.08377 487.48648 490.3107 494.09161 500.81552 506.35141 509.23502 514.92389 517.74811 523.43701 528.78027 534.00208 539.34448">complete execution, but they will not execute (even speculatively) until all instructions prior to the INT n have </tspan><tspan y="-694.02002" x="45.119125 49.800926 55.256725 64.006523 69.606323 72.065125 77.421921 80.960724 86.31752 91.91732 94.14122 99.498016 104.71982 110.07661 114.75842 120.44821 123.98701 126.44582 131.90161 137.59142 139.81531 143.8941 147.43291 153.12271 158.47951 160.7034 163.1622 168.564 172.1028 177.45959 181.29539 183.51929 185.97809 191.66789 196.34969 199.88849 203.72429 209.41409 214.09589 217.63469 220.09349 225.49438 231.18419 235.86598 238.15018 246.89998 252.24327 257.56406 259.78796 265.14478 270.36658 275.72339 280.40518 286.09497 289.63376 295.03647 297.26038 302.86017 308.21698 311.37778 316.73914 320.57135 325.92456 328.20877 333.80496 339.20316 342.73834 348.13654 350.36044 355.03864 358.57382 364.02603 367.85825 373.21146 378.80765 381.03156 386.62775 391.94495 394.16885 397.70404 403.39023 408.74344 410.96735 416.32056 421.71875 425.55096 428.00616 430.46136 435.81458 439.64679 441.8707 444.3259 450.01208 454.69028 458.22546 462.05768 467.74387 472.42206 475.95724 478.41245 483.81335 489.49954 494.17773 496.46194 502.10403 507.44733 512.76453 518.11774 520.34167 525.93787 531.34058 536.0188 541.47101 550.21722 555.61993">completed execution (the later instructions may execute before data stored by the earlier instructions have become </tspan><tspan y="-682.97974" x="45.119141 50.71714 53.174141 58.628143 64.226143 69.626144 72.083145 74.540146 79.859146 82.742744 88.061745 90.518745 95.198746 97.655746 103.25375 105.71075 111.06575 115.14275 118.40975 121.23396 126.76896 132.45695 134.91396 139.59396 142.47755 147.87755 153.47556 159.07356 161.53056 163.98756 169.34256 174.02255 176.90614 182.30614 184.70284 189.38284 194.83684 197.72043 201.25743 206.71143 209.53561 213.07262 218.76062 224.11562 226.99921 230.77921 237.50221 242.84012 249.73952 253.00652 255.83072 259.61072 266.33371 271.86871 277.58371 280.85071 283.73431 289.13431 294.8223 300.42029 303.24451 307.08569 313.80508 319.34009 325.05508 327.93869 330.33539 336.03687 340.71686 344.25385 348.08786 353.77585 358.45584 361.99283 364.44983 369.90384 375.59183 380.27182 383.53882 386.42242 392.02042 397.7084 401.24539 404.06961 409.7576 415.21161 418.7486 421.57281 425.1098 430.56381 433.44742 438.80243 444.02423 449.37924 454.05923 459.74722 463.28421 465.74121 471.19522 476.88321 481.5632 484.38742 489.84143 493.00043 495.82465 499.60464 506.32764 511.66553 518.74487 521.56909 528.92212 534.61011 539.96509 545.65308">globally visible). This applies also to the INTO, INT3, and INT1 instructions, but not to executions of INTO when </tspan><tspan y="-671.99976" x="45.119141 50.79454 55.95694 60.95734 67.100739 74.063141 80.126442 83.389839 90.460243 95.622643 98.506248 105.82325 108.70686 114.41826">EFLAGS.OF = 0.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-648.29999" x="45.119999 51.730453 57.3708 62.945412 66.367668 71.673363 75.694214 78.181229 83.820587">Operation</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-633" x="45.119999 50.653198 56.339397 61.692596 64.576202 67.733406 73.185608 75.640808 78.096008 83.54821 90.899414 93.354614 99.040817 104.63702 107.52062 112.97282 118.56902 123.92223 127.58433 132.98253 136.51773 138.97293 144.42513 150.11133 155.50952 157.96472 160.78891 166.38512 171.73831 176.41652 181.09473 184.92693 187.38213 192.97833 196.51353 198.96873 204.42093 210.10713 212.99072 218.38892 223.98512 229.58133 231.97803 234.43323 239.78642 244.46463 247.34822 253.03442 258.48663 262.02182 264.84604 270.29825 275.98444 278.43964 283.75684 286.64044 290.17563 295.62784 298.45206 301.98724 307.67343 313.02664 315.91025 319.68845 326.40964 331.94284">The following operational description applies not only to the INT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-633" x="334.80029 340.44238">n,</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-633" x="343.73999 346.56421 350.34332 357.06543 362.40332 369.36212 372.62823 375.51184 379.29095 386.01306 391.54715 397.26126 400.52737 403.35159 408.80469 412.63779 415.52139 419.30051 426.02261 431.5567 437.27081 440.15442 442.6105 448.25259 452.9317 456.4678 460.3009 465.98801 470.66711 474.20322 476.6593 482.1124 487.7995 492.47861 495.74472 498.62833 504.22543 509.91254 513.44861 516.27283 521.67194 524.12805 528.80713 534.26025 537.14386 540.67993 546.13306"> INTO, INT3, or INT1 instructions, but also to </tspan><tspan y="-622.02002" x="45.119995 50.473194 55.790394 59.325596 64.678795 68.510994 74.197197 79.595398 82.050598 84.694801 87.091499 92.792999 96.328201 101.6814 105.5136 109.3458 115.03201 120.6282 124.16341 128.90372 132.14551 134.7897 140.47591 145.9281 151.6143 160.31731 165.7155 170.39371 175.71091 181.1091 186.70531 189.16051 194.5137 197.1579 199.6131 205.2993 208.8345 214.1877 218.0199 221.8521 227.5383 233.13451 236.66971 241.34792 243.99211 248.06731 254.78851 262.36472 266.2059 270.88409 274.95929 278.22449 280.86868 286.26688 291.95306 297.54926 300.19345 305.54666 310.86386 315.54205 320.88 326.4816 330.02219 332.48279 337.9404 343.63199 348.31558 351.58618 354.23038 360.38098 365.78189 374.53348 379.89209 382.47598 387.93359 391.09619 393.74039 397.28098 402.97256 408.33118 413.01477 418.37338 421.01758 426.37619 431.59799 436.9566 442.64819 446.18878 450.87238 453.51657 459.11816 464.80975 469.49335 475.18494 477.82913 483.28674 488.97833 492.51892 497.91983 500.56403 504.10461 509.7962 515.15479 517.79901 522.4826 526.02319 531.42682 536.16711 541.48969 544.13391 549.53754 555.22913">external interrupts, nonmaskable interrupts (NMIs), and exceptions. Some of these events push onto the stack an </tspan><tspan y="-610.97974" x="45.119995 50.481297 54.321598 58.1619 63.6222 67.462502 70.286697 74.973 80.433304 86.037605 91.398903">error code.</tspan><tspan y="-595.02002" x="45.119995 50.654995 56.342995 61.697994 64.581596 70.035599 75.633598 80.988602 84.650703 90.050705 93.650711 96.047409 101.50771 107.19572 112.59572 115.05272 117.87691 123.47491 128.82991 133.50992 138.18991 142.02391 144.48091 150.07892 153.61592 156.07292 161.52692 167.16902 170.05261 174.7326 180.33061 185.73331 190.4133 192.81 195.9942 198.4512 203.8062 208.48621 211.3698 217.0119 222.71341 231.46141 236.81641 240.65041 246.1044 251.7924 256.47241 259.29663 264.03693 269.67902 275.08173 279.76172 285.08072 289.76071 292.64432 299.99731 305.6853 311.13931 315.81931 321.17432 324.05792 327.21692 332.61691 335.01361 337.46973 343.15771 346.99173 352.34674 355.23035 363.97833 369.32162 374.64062 377.46484 381.29886 386.70157 391.38156 397.06955 399.46536 403.00504 405.88864 408.28534 413.98682 416.87042 422.46841 427.82343 430.28043 432.73743 437.95923 443.31424 447.14825 452.46725 455.35086 460.75177 463.93597 466.81958 472.21957 475.04379 480.73178 486.08679 490.76678 494.30377 499.70648 505.28647 508.11069 513.51343 518.73517 523.41516 528.77014 534.36816 537.90515 540.36212 545.8161 551.50409 554.77112">The operational description specifies numerous checks whose failure may result in delivery of a nested exception. </tspan><tspan y="-583.97974" x="45.119995 48.900894 54.589794 57.413994 60.951893 66.640793 71.996696 76.677597 82.080299 84.904495 89.585396 94.986298 99.667198 105.0231 109.7634 113.0052 115.8888 119.4267 125.11561 130.51831 133.34251 138.79741 142.63231 145.09021 150.68912 153.14702 158.83592 164.23682 166.63351 169.51712 174.87302 180.09482 185.49751 191.19902 194.73692 197.56113 200.01903 204.69992 207.52412 213.21303 218.66792 222.20583 225.03003 230.62894 235.98483 238.44273 240.90063 246.12244 251.47833 255.31323 260.66913 266.26804">In these cases, the original event is not delivered.</tspan><tspan y="-568.02002" x="45.119995 50.653194 56.339394 61.692593 64.576195 70.028397 75.624596 80.977798 84.6399 90.038101 93.6381 96.034798 101.4951 107.1813 112.57951 115.03471 117.85891 123.45511 128.8083 133.48651 138.16472 141.99692 144.45212 150.04832 153.58353 156.03873 161.49092 167.13303 170.01662 174.69482 180.29103 185.69373 190.37373 192.77043 195.95462 198.40982 203.76302 208.44122 211.32481 214.86002 220.50212 225.90482 228.729 234.0822 237.9144 241.7466 247.19879 251.03099 253.91458 258.59277 264.04498 269.64117 274.99438 277.87799 283.47418 288.82739 291.28259 293.73779 298.95959 304.31281 308.09998 313.50269 319.0827 321.90692 327.50763 332.82932 335.71292 341.11563 346.69745 352.01913 354.84335 360.53406 365.89175 370.57446 374.11417 379.51688 385.09689 387.92111 393.32382 398.54559 403.2283 408.586 414.18671 417.72641 420.1861 425.64279 431.3335 434.60321 437.48682 441.26953 446.96024 449.78445 454.46716 459.92386 468.67456 474.03226 476.91586 481.59857 487.00128 491.68399 497.04169 501.7244 504.99411 507.81833 511.35803 517.04871 522.40643 525.28998 530.64771 534.48438 538.32104 543.77777 547.61444">The operational description specifies the error code delivered by any nested exception. In some cases, the error </tspan><tspan y="-556.97974" x="45.119995 49.798195 55.250397 60.846596 66.199799 68.783699 71.238899 75.917099 78.500999 83.179199 88.775398 94.128601 98.806801 101.262 104.4192 106.8744 112.22761 117.82381 120.40771 127.75891 130.21411 133.74931 139.43552 142.01941 147.4176 150.0015 155.5977 160.27591 165.6291 171.31531 176.95471 182.35561 185.5128 191.19901 196.88521 201.56342 205.09862 207.55382 213.00601 218.69221 221.27611 226.6293 230.4615 234.2937 239.7459 243.57809 249.34079 254.019 259.47119 265.06738 270.42059 274.49579 280.18198 285.86816 294.61438 297.87958 300.29968 305.89227 309.42386 312.72595 318.06836 323.38196 326.91354 330.98514 334.24673 336.83063 344.17822 349.86081 355.26352 359.10562 364.45523 367.03912 369.43582 375.07523 378.60681 381.1304 386.52499 392.20758 397.84698 400.37057 405.77328 411.05539 414.58698 417.17087 422.56546 426.39407 431.74368 434.32758 439.96698 442.36368 445.89526 448.47916 453.64066 459.04425 461.49585 467.17844 472.58115 477.26114 480.52274 483.10663 488.63623 494.31882 499.66843 502.25232 507.84491 512.58521 517.93481 523.61743 529.21002 534.65863 537.81226 543.49487 549.17749 553.79724">code is specified with a pseudofunction error_code(num,idt,ext), where idt and ext are bit values. The pseudofunc-</tspan><tspan y="-545.99976" x="45.11998 48.658779 51.11758 56.57338 62.26318 65.146782 70.746582 74.582382 80.038185 85.637985 91.327789 96.00959 101.36639 106.1067 108.93089 114.3327 120.02249 122.84669 128.24939 132.09149 135.87329 141.33359 145.16939 148.05299 152.73479 158.19058 163.79037 169.14717 172.03078 177.43257 182.11436 184.93857 188.09937 193.55516 196.01396 198.47276 203.87366 211.22845 215.91025 219.98904 222.87265 226.95145 232.66824 239.92764 242.32434 245.48514 248.30934 250.76814 256.36795 259.90674 262.73093 265.18973 269.87152 272.69571 278.4584 281.7002 284.52438 288.12436 293.69998 299.06128 301.8855 307.2468 311.0871 314.9274 320.3877 324.228 327.1116 331.79791 337.25821 342.86252 348.22382 351.10742 353.50412 358.18414 361.06775 365.15106 370.84537 376.53967 388.42236 394.96268 397.7869 403.00961 409.2475 416.00378 423.20291 427.28622 430.16983 435.53113 440.85641 444.39972 448.48303 451.30725 455.39056 461.11188 468.37128 470.82736 473.99268 476.81689 479.28018 484.88449 488.4278 491.3114 493.7081 498.38812 501.27173 506.99304 510.26636 513.09058 516.63385 522.32812 527.68945 530.57306 535.93439 539.77466 543.61493 549.07526 552.91553">tion produces an error code as follows: (1)if idt is 0, the error code is (num&amp; FCH)| ext; (2)if idt is 1, the error </tspan><tspan y="-535.01978" x="45.11998 49.79998 55.260281 60.840282 66.182686 69.066284 71.522385 76.202385 79.026581 83.105385 88.820389 94.535385 106.41808 112.24108 115.06528 120.80727 128.00636 132.08516 134.96877 143.85088 147.92967 150.75388 156.13588 161.41797 164.98196">code is (num« 3)| 2| ext.</tspan><tspan y="-518.99976" x="45.11998 48.899979 54.587978 57.232178 65.980179 71.38018 76.961983 82.303482 85.00708 89.68708 95.087082 99.767082 105.12209 109.80209 113.06908 115.71329 119.25029 124.93829 130.29329 132.99689 138.59489 143.2749 148.6776 154.3791 159.97711 165.43111 168.5901 174.27811 179.96611 184.64612 188.18312 190.64012 196.09412 201.78212 204.42632 209.82901 213.66301 217.49701 222.8979 226.7319 232.4946 237.17459 242.62859 248.22659 253.58159 256.28519 258.74219 263.42218 266.06638 268.52338 274.10516 279.42416 284.87817 290.09998 295.44238 301.04037 303.66028 311.01147 313.40729 316.94247 322.62866 325.33224 330.73044 333.37463 339.01404 343.69403 349.04724 354.73343 360.32962 365.78183 370.94333 376.34692 380.17914 382.57584 387.97403 393.61343 396.06863 401.42184 404.06604 409.74323 415.89743 420.15533 423.39713 426.10071 431.63391 437.3201 442.67331 445.37689 450.53839 455.94199 458.33868 464.04016 469.39337 472.09695 477.54916 480.70636 483.35056 489.02777 495.18198 500.71518 503.35938 508.99878 514.34119 519.93738 525.34009 531.02631 536.66571 541.34393 543.98816 549.44037 555.12659">In many cases, the pseudofunction error_code is invoked with a pseudovariable EXT. The value of EXT depends on </tspan><tspan y="-507.95944" x="45.119995 48.656094 54.343193 59.697292 62.040894 67.727997 73.127098 76.6632 82.350304 86.183403 91.537506 93.881104 99.334206 102.49231 104.83591 108.37201 114.05911 119.41322 121.81712 127.17123 132.39302 137.79572 143.43782 146.97392 149.37782 156.72992 162.41702 167.87012 172.54922 177.90332 180.30722 185.90433 191.25842 193.71452 196.17062 201.39243 206.74652 210.57962 215.89772 218.24132 223.64401 229.28612 233.96521 239.4183 245.10541 250.79251 254.32861 259.68271 263.51581 268.8699 274.50931 276.85291 282.25201 284.59561 290.28271 295.63681 300.37711 303.91681 309.2709 314.82028 317.16388 322.56659 327.78839 332.46838 337.81079 343.4502 346.9899 349.3866 354.84689 360.54837 364.62717 366.97076 369.42688 372.61108 374.95468 378.49438 384.19586 389.59946 393.13916 395.48276 400.82516 406.10727 411.44968 417.15115 420.69086 423.03445 425.49057 430.17056 432.51416 437.91776 440.32166 445.00165 450.46194 453.58585 457.12555 464.38223 469.78583 473.6279 479.03061 481.37421 483.83032 489.47241 493.01212 498.41483 502.2569 506.09897 511.74106 517.38049 520.92023 523.26385 527.34265 531.12354 537.84296">the nature of the event whose delivery encountered a nested exception: if that event is a software interrupt (INT</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-507.95944" x="546.48029">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-507.95944" x="552.17999 555.48212">, </tspan><tspan y="-496.97943" x="45.119995 48.897297 55.617599 61.149902 66.912605 70.176903 73.001106 78.452408 82.283707 85.167313 88.944611 95.664909 101.00282 108.08221 112.15652 115.42081 118.24502 123.92132 130.07462 135.60692 138.49051 140.88721 145.56721 148.45081 154.1631 158.2374 161.06158 166.51288 170.04718 175.73248 181.13518 184.91698 192.2997 194.7585 199.44029 204.79709 207.68069 211.75949 214.15619 219.84599 224.52779 226.98659 232.67639 238.27618 240.73499 246.42479 252.0246 254.8488 258.63062 265.41031 270.94711 276.66391 280.74271 284.01151 286.83569 292.51648 298.67429 304.21109 307.03528 309.49408 314.17587 317.00006 322.76276">INT3, or INTO), EXT is 0; otherwise (including INT1), EXT is 1.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-476.99942" x="45.119995 47.234097 51.914997 54.134399 59.272499 63.953403">IF PE </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-477" x="66.18 72.239861">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-477" x="75">0</tspan><tspan y="-465.00031" x="58.619999 63.829201 69.650398 74.400597 80.221794">THEN </tspan><tspan y="-453.00061" x="76.680298 81.9795 87.737701 92.8965 98.594398 100.8138 106.266 110.9469 116.5791 121.0179 123.8385 129.4185 134.9787 140.4966 145.89659 150.63779 155.37988 160.18228 163.00288 169.54318 175.30138 180.81927 185.56947">GOTO REAL-ADDRESS-MODE;</tspan><tspan y="-441.00092" x="58.619995 63.345894 67.810791 72.590691 77.316589 79.535988 82.128891 86.152794 88.372192 93.494095 98.219994">ELSE (* PE </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-441" x="100.44">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-441" x="106.44 108.6594 113.9298 116.1492 120.1776"> 1 *)</tspan><tspan y="-429.00031" x="76.679703 78.774902 83.4981 85.717499 88.307701 93.030899 97.7118 102.2109 107.8161 113.0883 117.8655 119.5737 125.2509 131.82809">IF (EFLAGS.VM </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-429" x="133.98">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-429" x="139.97946"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-429" x="142.74001 147.96001 150.17941 155.78461 161.63281 167.16602 169.38542 174.10863 179.53383 184.79703 186.47734 192.15454 198.69484 203.41805 205.63745 210.75665 212.97606 218.23926 220.45866 226.06386 231.91206 237.44527 239.66467 241.75987 247.49107 252.61028 257.07248">1 AND CR4.VME = 0 AND IOPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-429" x="259.26031">&lt;</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-429" x="264.24002 266.45944 271.69925 273.91867 279.55804 285.37924 290.88904 293.10846 295.20908 301.03027 306.24847"> 3 AND INT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-429" x="308.45972">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-429" x="313.3197 315.89911">) </tspan><tspan y="-417.00031" x="94.679993 99.889191 105.71039 110.46059 116.28178">THEN </tspan><tspan y="-405.00061" x="112.67999 114.89939 120.7188 125.9397 131.0544 133.64009 138.89879 141.48448 143.40419 145.6236 148.20929 152.22598 154.44539 159.75809 161.70479 165.07349 167.29289 172.55159 174.771 179.4897 182.8224 185.04181 189.75151 193.01221 196.2729 200.99969 204.2406 206.46001 210.3399 215.0811 219.717 224.45729 226.6767 228.60359 232.62569 234.84509 240.1254 242.3448 246.9807 251.72099 255.60089 260.04779 264.85019 268.87231 273.56223 275.78162 277.8822 283.70343"> #GP(0); (* Bit 0 of error code is 0 because INT</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-405.00061" x="291.06 295.91998 298.38058">n *</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-405.00061" x="302.39999">)</tspan><tspan y="-393.00092" x="94.679993 99.414894 103.88879 108.6777">ELSE</tspan><tspan y="-381.00122" x="112.67999 114.78059 119.52179 121.74119 124.30169 129.04289 133.73639 138.23549 143.81099 149.09129 153.83879 155.57939 161.2269 167.8275 170.04689 175.13638 177.35577 182.63608 184.85547 190.43097 196.24947 201.82767 204.04706 208.74055 214.19997 219.43347 221.17407 226.82158 233.42218 238.11568 240.33507 245.49657 247.71596 252.94946 255.16885 260.74435 266.62497 272.12848 274.34787 276.44846 282.26965 287.48785">IF (EFLAGS.VM = 1 AND CR4.VME = 1 AND INT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-381.00122" x="289.62">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-381.00122" x="294.47998">)</tspan><tspan y="-369.00153" x="130.67998 135.85858 141.70319 146.42279">THEN</tspan><tspan y="-357.00183" x="148.67998 153.39508 158.11018 162.87929 166.88339 171.6525 173.5686 176.9337 179.15311 183.80521 185.74831 189.1134">Consult bit </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-357.00183" x="191.33997">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-357.00183" x="196.19997 198.41937 203.12547 206.44557 208.66498 212.08498 216.82707 221.56737 223.78677 227.78188 232.48798 235.80807 239.16417 246.09326 250.54736 253.79546 258.53577 260.75516 262.68927 267.49167 270.84778 275.5881 278.83621 282.08432 286.88672 291.52982 294.94983 297.16922 300.41733 305.11444 309.75754 311.73935 314.98746 319.68457 323.57166 326.99167 328.92578 333.6319 338.392 340.61139 345.25449 347.1886 350.60861 352.828 359.75711 364.25623 368.89932 371.11871 373.10052 377.84262 380.06201 383.41812 388.22052 392.96085 395.18024 400.34534 405.10544 409.90784"> of the software interrupt redirection bit map in the TSS;</tspan><tspan y="-345.00214" x="148.67996 150.74097 155.48216 157.70155 162.38066 164.30217 167.64117">IF bit </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-345.00214" x="169.85966">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-345.00214" x="174.71967 176.93906 178.89566 182.91325 185.13264 189.04225 190.97185 195.65276 200.15186"> is clear</tspan><tspan y="-333.00244" x="166.67996 171.85316 177.69237 182.40657 188.24577 190.46518 193.04639 197.05859 199.278 202.58009 207.26099 211.91219 213.85439 217.15648 221.83737 225.73257 229.09677 231.31618 233.29797 238.04008 241.46008 246.14098 249.39717 252.69926 257.46747 262.11868 265.48288 267.70227 271.06647 275.78067 278.00006 283.25427 288.50848 293.7627 299.01691 301.2363 305.88751 309.14371 313.85791 318.50912 321.76532 326.22751 333.1647 335.38409 337.36591 342.108 345.4722 350.21249 353.46869 356.77078 361.53897 366.19019 369.55438 371.77377 376.54196 381.04105 385.80923 390.46045 392.37564 397.11594 400.37213 402.59152 406.60373">THEN (* redirect interrupt to 8086 program interrupt handler *)</tspan><tspan y="-321.00275" x="184.67996 189.78836 194.55476 198.55617 203.32257 205.54198 210.25438 214.96678 219.41818 225.05759 230.31898 235.08539 237.83578 243.08818 248.34058 250.08298 255.33537 258.08578 274.64578 277.22519 281.2356 283.45499 285.39539 288.72177 290.94116 293.02557 298.74597 303.85437 308.35345 310.57285 315.59125 317.81964 323.08194 324.90625 327.12567 331.13696 335.60727 340.24857 344.96185 347.18127 352.85757 354.95187 359.67416 361.89359 363.84387 368.62018 370.8396 372.8808 377.62198 379.8414 384.5007 389.22299 393.23428 395.18457 398.55688 400.50717 405.22946 410.00577 412.22519 416.6955 421.49963 426.13824 428.35764 432.37973 436.81943 441.49854 446.17944 448.39883 450.49945 456.19736 461.35886 465.79767 468.01706 472.69617 477.35992 481.37302 483.3251 486.69922 488.65131 493.3754 498.1535 500.37292 504.84503 508.85812 511.07755 516.29755 518.51697 522.53906">Push EFLAGS[15:0];(* if IOPL &lt; 3, save VIF in IF position and save IOPL position as 3 *)</tspan><tspan y="-309.00305" x="184.67993 189.79373 194.56554 198.57234 203.34415 205.56355 210.28136 215.05316">Push CS;</tspan><tspan y="-297.00336" x="184.67993 189.79463 194.56734 198.57504 203.34775 205.56805 207.65875 212.77345">Push IP;</tspan><tspan y="-285.00366" x="184.67993 186.73914 191.48033 193.69972 195.80032 201.49823 206.65973 211.09853 213.31792 218.40112 220.62051">IF IOPL = 3</tspan><tspan y="-273.00397" x="202.67993 207.85223 213.69054 218.40384 224.24214 226.46155 228.54684 233.26015 235.47955 237.22285 242.33215 244.55156 249.80486 251.66516 253.88457 256.46487 260.47617 262.69556 267.40884 269.32315 274.02747 278.52658 281.78189 284.00128 285.98309 290.72519 294.0885 298.82883 302.08414 305.38626 310.15356 314.80386 318.16718 320.38657 323.71387 325.69476 330.15607 334.80637 337.02576 341.03705">THEN IF := 0; (* Clear interrupt flag *)</tspan><tspan y="-261.00427" x="202.67993 207.39323 211.84554 216.64703 221.38733 223.60583 229.27313 231.35843 236.07173 238.29024 240.03354 245.14284 247.36134 252.61464 254.47495 256.69345 259.27374 263.28503 265.50354 270.21683 272.13113 276.83545 281.33365 284.58896 286.80746 291.43976 293.42068 296.67599 300.03931 304.84082 309.27963 311.19394 313.41245 315.39337 320.19489 323.5582 328.26251 331.56372 334.80463 339.60614 344.22495 347.58826 349.80676 353.13406 355.04837 359.50967 364.15997 366.37848 370.38977">ELSE VIF := 0; (* Clear virtual interrupt flag *)</tspan><tspan y="-249.00458" x="184.67993 189.36084 191.46144">FI;</tspan><tspan y="-237.00488" x="184.67993 189.85854 194.57814 196.79755 198.59935 203.70055 205.91995 211.17955 213.04614 215.26555 217.85214 221.86974 224.08914 228.80875 230.72934 235.43994 239.90755 243.16914 245.38855 248.75815 252.01974 256.48734 261.14392 263.36331 266.6969 268.61749 273.08508 277.74167 279.96106 283.97867">TF := 0; (* Clear trap flag *)</tspan><tspan y="-225.00519" x="184.67993 186.61133 191.29224 195.77063 200.39034 202.60973 207.34012 212.08221 214.30161 218.78 223.52209 228.1895 230.40889 235.13928 237.24168 242.36809 244.58748 247.18488 249.11627 253.84668 260.74698 265.46838 268.74078 270.96017 276.23056 281.45053 283.66992 288.33731 290.29572 293.67612 297.69553 299.91492 304.59583 309.39822 311.32962 316.01501 318.61243 320.83182 324.1312 327.43329 332.1142 339.0748 341.29419 346.01559 350.75769 354.13809 357.41049 362.09589">load CS and EIP (lower 16 bits only) from entry </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-225.00519" x="364.31992">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-225.00519" x="369.1799 371.39932 373.3208 378.1232 380.34262 382.2641 387.0665 390.42618 395.10709 398.39117 401.63297 406.42908 411.0488 414.40848 416.6279 421.289 425.96991 429.89301 433.25269 437.99478 441.23657 443.45599 446.84808 451.28778 455.96689 457.91 462.59091 464.81033 468.09442 472.77533 476.13144 480.81235 484.05414 488.79443 493.53656 497.49567 502.17657 506.85568 509.0751 512.37451 515.67664 520.35754 527.31812 529.53754 534.69635 539.49872 544.24078"> in interrupt vector table referenced from TSS;</tspan><tspan y="-213.00549" x="166.6799 171.3698 175.79869 180.60109">ELSE</tspan><tspan y="-201.0058" x="184.6799 186.73911 191.4803 193.69969 195.80029 201.4982 206.6597 211.0985 213.31789 218.40109 220.62048">IF IOPL = 3</tspan><tspan y="-189.0061" x="202.6799 207.86571 213.71751 218.44432 224.29613 226.51553 231.79134 237.48924 242.67505 248.37296 250.59235 255.71515 261.14395 266.84186 272.00064 276.72745 281.45425 286.64005 291.36685 296.90366 299.74045 306.28076 312.01556 317.55237 322.27917">THEN GOTO PROTECTED-MODE;</tspan><tspan y="-177.00641" x="202.6799 207.3797 211.8185 216.6209 221.36209 223.5815 229.3253 234.5741 239.7356 242.315 247.55481 250.19362 252.04042 254.25983 256.82663 260.82443 263.04385 268.33765 270.31943 273.66922 275.88864 281.16895 283.38837 288.08817 291.44699 293.66641 298.35721 301.6196 304.87219 309.58279 312.83539 315.05478 318.94638 323.65698 328.3046 333.04489 335.26428 337.20288 341.20248 343.42188 348.67249 350.89188 355.53949 360.27979 364.17139 368.62997 373.43237 377.45447 382.15607 384.37546 386.45807 392.33868">ELSE #GP(0); (* Bit 0 of error code is 0 because INT</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-177.00641" x="399.7196 404.57959 407.04019">n *</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-177.00641" x="411.0596">)</tspan><tspan y="-165.00671" x="184.6799 189.36081 191.46141">FI;</tspan><tspan y="-153.00702" x="148.6799 153.36081 155.46141">FI;</tspan><tspan y="-141.00732" x="130.6799 135.36079 139.79961 144.5849 149.31619 151.53558 154.13388 158.16318 160.38257 165.50987 168.78317 173.51447 176.89577 181.61807 185.53036 188.91167 193.59258 198.26088 200.48027 207.43457 212.11546 216.78377 221.46468 223.29797 225.51736 227.62067 233.23396 236.07526 241.34656 246.56656 251.30687 253.52626 260.48056 265.16144 269.82974 274.51062 276.34393 278.56335 283.24423 286.54633 288.76575 293.41605 295.33752 298.61081 301.9921 306.7774 311.2171 313.14941 315.99072 321.26202 326.53333 331.75333 337.02463 339.24405 346.14438 350.88556 355.55386 360.23474 362.45416 364.41345 369.15555 372.53683 377.25912 380.53241 383.80569 388.54779 393.2269 396.60818 398.82761 402.8569">ELSE (* Protected mode, IA-32e mode, or virtual-8086 mode interrupt *)</tspan><tspan y="-129.00763" x="148.6799 150.7211 155.46231 157.6817 160.2782 162.3797 167.9912 173.2607 178.5302 183.0311 187.7606 192.49011 197.17102 202.60252 204.31702 208.78552 215.32582 220.93732">IF (IA32_EFER.LMA </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-129" x="223.14">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-129" x="229.2 231.41939 236.65289"> 0)</tspan><tspan y="-117.0003" x="166.67969 171.86189 177.7101 182.4333 188.28151 190.50092 193.09111 197.1123 199.33171 204.45091 207.71611 212.43932 215.81252 220.49342 224.39313 227.76633 232.48053 237.10023 239.31964 246.26584 250.98904 255.60875 260.34903 262.17422 264.39362 269.11682 272.38202 274.60141 279.24362 281.1597 284.4357 287.8197 292.5618 297.06088 298.99588 301.83987 307.05988 312.33386 317.60785 322.82785 325.04724 332.00424 336.73825 341.35794 346.09824 348.31763 350.23914 355.04153 358.42554 363.10645 366.38245 369.65845 374.44644 379.06613 382.45013 384.66953 388.70154">THEN (* Protected mode, or virtual-8086 mode interrupt *)</tspan><tspan y="-105.0006" x="184.67969 189.93298 195.69118 200.85448 206.56677 208.78618 213.94768 219.34767 225.05997 230.27817 234.98247 239.68677 244.85007 249.55437 255.06866 257.88297 264.48355 270.18146 275.69577 280.40009">GOTO PROTECTED-MODE;</tspan><tspan y="-93.000893" x="166.67969 171.39839 175.85609 180.6288 185.3475 187.56691 190.1526 194.1693 196.3887 198.4794 204.08011 206.90881 212.16751 217.42621 222.13591 224.35532 231.29701 236.01572 240.67142 245.38112 247.60052 249.54723 254.31993 257.73993 262.42081 265.68152 268.94223 273.71494 278.37064 281.73935 283.95874 287.97543">ELSE (* IA-32e mode interrupt *)</tspan><tspan y="-81.00119" x="166.67969 171.93929 177.65788 182.82748 188.54608 190.76549 192.84808 198.48749 201.30809 206.55869 211.80928 216.51088 219.33148 225.89609 231.61469 237.13528 241.84589">GOTO IA-32e-MODE;</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="342.36206pt" height="644.33789pt" viewBox="0 0 342.36206 644.33789" sodipodi:docname="613.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="345.8373" inkscape:cy="423.75257" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg162" /><g transform="translate(-46.622025,-69.476563)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="149.52 154.2549 156.3618">FI;</tspan><tspan y="-703.98029" x="113.52 118.25491 120.36181">FI;</tspan><tspan y="-691.98059" x="77.520004 82.254906 84.361809">FI;</tspan><tspan y="-679.9809" x="46.020004 50.700905 52.801502">FI;</tspan><tspan y="-667.9812" x="46.020004 51.437103 56.152203 61.749302 66.2034 69.084305 74.664307 80.189407 85.714508 91.131607 95.84671 100.61581 105.38492 108.21002 114.77912 120.50222 126.02732 130.74242">REAL-ADDRESS-MODE:</tspan><tspan y="-655.98151" x="59.520004 61.618805 66.345604 68.565002 71.158806 73.752609 78.398407 83.079308 86.979004 90.355804 95.082603 98.351402 102.9072 107.688 112.43011 119.37991 123.99961 128.71741 131.98621 134.2056 139.61639 141.83578 147.10258 149.69638 151.91577 157.09258 159.31198 164.57878 167.16 169.37941 171.32341 175.32841 177.54782 182.31783 187.03383 190.45383 192.67323 199.61223 201.55623 204.92223 209.69223 211.63623 216.40623 218.62564 220.71364 226.29184 231.46684 233.68625 235.60326 237.54726 244.48625 246.43025 249.79625">IF ((vector_number « 2) + 3) is not within IDT limit </tspan><tspan y="-643.98181" x="77.520004 82.701302 88.548599 93.270897 99.118195 101.33759 107.1039 112.3752 117.4935 119.3628 121.5822 126.3045 128.3988">THEN #GP; FI;</tspan><tspan y="-631.98212" x="59.520004 61.608006 66.324005 68.543404 72.548401 75.914398 80.378395 84.275398 88.594498 90.813896 95.583893 100.2999 103.66589 105.88529 107.80229 112.30139 115.55939 120.21239 124.9194 127.13879 131.87909 136.6212 141.3372 146.10721 150.76021 155.53021 157.74962 161.07962 165.79562 169.05362 171.3 175.76401 177.98341 183.23941 186.06541 190.71841 195.38942 198.75542 203.46242 205.68182 208.98392 213.66483 217.03082 221.80083 225.05882 229.82883 232.04823 233.99223 238.76224 242.09224 246.80824 250.11034 257.01065 261.47464 264.84064 266.78464 271.50064 276.27063">IF stack not large enough for a 6-byte return information </tspan><tspan y="-619.98242" x="77.520004 82.705803 88.557602 93.284401 99.1362 101.3556 107.1264 111.9072 116.6493 118.50961 120.729 125.4558 127.5546">THEN #SS; FI;</tspan><tspan y="-607.98273" x="59.520004 64.657204 69.399307 73.429504 78.224701 80.444099 83.023499 87.704399 92.445602 96.884407 102.50761 107.72851 112.52371 115.30291 120.58411 125.80411 127.54561 132.82591 135.60512 138.18452">Push (EFLAGS[15:0]);</tspan><tspan y="-595.98303" x="59.520004 61.612503 66.333 68.552399 70.302902 75.419403 77.638802 82.8993 84.7668 86.986198 89.5737 93.592201 95.8116 100.5321 102.4536 107.1651 111.6336 114.8961 117.11549 119.064 123.83849 127.25849 131.93939 135.20189 138.46439 143.23889 147.89639 151.26689 153.4863 156.8208 158.74229 163.2108 167.8683 170.08771 174.1062">IF := 0; (* Clear interrupt flag *)</tspan><tspan y="-583.98334" x="59.520004 64.697708 69.416412 71.635811 73.437614 78.538818 80.758217 86.016914 87.936615 90.156013 92.741714 96.758415 98.977814 103.69652 105.61622 110.32592 114.79262 118.05331 120.27271 123.64141 126.90211 131.3688 136.02451 138.24391 141.57661 143.49631 147.96301 152.61871 154.83812 158.85481">TF := 0; (* Clear trap flag *)</tspan><tspan y="-571.98364" x="59.520004 65.119804 69.837601 72.056099 73.857903 78.959099 81.177597 86.435394 88.355095 90.573593 93.158394 97.174194 99.392693 104.11049 106.02929 110.73809 115.20389 118.46368 120.68218 126.28198 130.99979 133.21829 136.55009 138.46889 142.93469 147.58949 149.808 153.82379">AC := 0; (* Clear AC flag *)</tspan><tspan y="-559.98395" x="59.520004 64.668007 69.410103 73.451103 78.257103 80.83651 85.51741 90.32341 92.902817">Push(CS);</tspan><tspan y="-547.98425" x="59.520004 64.668907 69.411011 73.452911 78.259811 80.839218 82.939819 88.041023 90.62043">Push(IP);</tspan><tspan y="-535.98456" x="59.520004 62.130905 66.092705 68.312103 74.181 78.924896 81.144295 85.825195 89.066994 92.35289 97.033783 100.31968 102.53908 106.46397 111.14487 115.82577 120.56067 124.52247 126.74187 131.23376 134.47557 139.21046 141.42986 146.04955 150.85194 154.88484 159.62694 164.36183 168.98152 171.20091 173.17281 177.9149 180.13429 183.4202 188.10109 192.59299 194.53789 197.35849 201.79819 206.47908 211.09877 214.38467 219.06557 223.09846 227.13136 229.35075 236.31766 240.99855 245.67944 250.36034 254.40224">(* No error codes are pushed in real-address mode*)</tspan><tspan y="-523.98486" x="59.520004 64.229706 69.032104 71.251511 72.991211 78.096909 80.316315 82.398018 87.917717 93.086418 95.663116 101.24132 105.92222 109.92092 113.81162 117.06332 119.04512 123.69182 127.11182 131.82152 135.12361 137.34302 139.91972 144.54843 149.28873 153.1803 156.53999 161.24969 164.55269 169.11479 173.87849 178.6422 185.57489 190.22159 194.92229 198.22528 200.44469 205.83839 208.0578 213.3075 215.9472 217.75891 219.97832 223.97702 228.67772 230.58842 235.28912 239.17982 242.53952 247.24922 250.50092 253.07762 255.65433">CS := IDT(Descriptor (vector_number « 2), selector));</tspan><tspan y="-511.98517" x="59.519997 64.233299 66.318596 71.427895 73.647293 75.390594 80.552094 82.7715 84.856796 90.380096 95.552399 98.132698 103.656 108.3963 112.39861 116.3577 119.61301 121.55431 126.20461 129.5679 134.2812 137.5365 139.75591 142.33621 147.0153 151.7196 155.61391 158.9772 163.69051 166.9458 171.4881 176.2905 181.03259 187.96889 192.61919 197.35948 200.60127 202.82068 208.21797 210.43738 215.69067 218.27098 220.12947 222.35968 227.04059 230.3994 233.69881 237.7209 242.43961 245.81731 248.412 251.0067 252.88139 255.10078 257.6955 261.72119 263.94061 269.20831 274.47601 276.69543 281.31512 283.29691 286.67459 288.89401 293.57489 296.9166 300.2583 304.22009 308.93878 312.31647 314.53589 320.1456 325.99829 331.53598 333.7554 339.0231 344.2431 349.5108 354.7308 359.4585 364.18619 368.86707 373.59476 379.44745 381.66687 385.69257">EIP := IDT(Descriptor (vector_number « 2), offset)); (* 16 bit offset AND 0000FFFFH *)</tspan><tspan y="-499.98547" x="46.019989 50.71439 56.59499 62.099388">END;</tspan><tspan y="-487.98578" x="46.019989 51.12299 56.53199 62.24699 67.412994 72.119995 76.826996 82.045197 86.726097 92.243095 95.124001 101.685 107.4 112.9782 117.6591">PROTECTED-MODE:</tspan><tspan y="-475.98608" x="59.519989 61.61879 66.345589 68.564987 71.158791 73.752594 78.398392 83.079292 86.978989 90.355789 95.082588 98.351387 102.90719 107.68799 112.43009 119.37989 123.9996 128.71739 131.98619 134.2056 139.61639 141.83578 147.10258 149.69638 151.91577 157.09258 159.31198 164.57878 167.15999 169.37939 171.32339 175.3284 177.54781 182.31781 187.03381 190.45381 192.67322 199.61221 201.55621 204.92221 209.69221 211.63622 216.40622 218.62563 220.71362 226.29182 231.46683 233.68623 235.60324 237.54724 244.48624 246.43024 249.79623">IF ((vector_number « 3) + 7) is not within IDT limits</tspan><tspan y="-463.98639" x="59.519989 64.244087 67.510185 69.729584 73.742683 78.457787 80.382889 85.097992 89.00309 92.37719 97.092293 101.7534 103.97279 106.01399 111.59219 116.77529 118.99469 123.6144 128.35471 132.36781 136.27292 139.53902 141.49112 146.11082 149.47052 154.19463 157.46072 159.68013 161.63223 165.64534 167.86475 172.64285 177.36696 180.74106 182.96046 187.43257 192.17999 194.3994 196.3398 201.1062 204.4686 209.172 212.42639 215.72849 220.49489 225.14429 228.50668 231.32909 233.14349 235.3629 238.7829 242.02469 246.48509 251.13449 253.95689 255.8154 258.03479 262.74719 266.04929 268.26868 271.63107 276.09146 280.09286 284.36426 287.24515 291.86487 296.32526 299.68765 304.39105 306.61044 309.97284 314.64023 319.28964">or selected IDT descriptor is not an interrupt-, trap-, or task-gate type</tspan><tspan y="-451.98669" x="77.519997 82.738197 88.559402 93.276306 99.11821 101.33761 107.09851 112.36441 117.47731 120.06121 124.80151 128.06041 131.31931 136.03621 139.3383 143.8392 147.73711 152.45401 157.10791 161.81581 164.3997 169.0356 173.77589 177.6756 181.0425 185.7594 189.0183 193.56419 198.36659 203.1087 210.0486 214.7025 219.44279 222.68459 224.54308 229.76308 231.62157 236.30247 241.95537 247.17357 249.75746 252.34135 254.20526 256.42465 261.14154 263.23044">THEN #GP(error_code(vector_number,1,EXT)); FI;</tspan><tspan y="-439.987" x="77.519997 80.126396 84.163795 86.383202 88.304703 92.983803 96.373199 98.592598 103.2735 107.9526 112.683 115.9248 120.3645 125.16691 129.78661 132.006 135.3954 140.07629 142.29568 147.02609 150.2679 153.5493 158.23019 161.5116 166.0125 169.93289 174.67229 179.34869 184.0296 186.24899 190.27739 194.9583 198.3477 200.56709 205.1868 209.92711 213.8475 218.2872 223.0806 227.04239 231.7728 233.99219 238.61099 243.3513 247.2717 250.6611 255.4005 258.64227 260.86166 262.78317 266.8053 269.02469 273.81808 277.8465 282.5274 287.20648 289.42587 293.46329">(* idt operand to error_code set because vector is used *)</tspan><tspan y="-427.9873" x="59.519997 61.607998 66.323997 68.543396 72.548393 77.264397 80.594398 83.960396 90.899399 95.363396 98.665497 103.3464 105.5658 107.5098 112.2798 115.6458 120.3528 123.6108 126.9129 131.68291 136.33591 139.7019 141.92131 144.5043 148.51831 150.73772 156.00272 160.70972 165.47972 170.18672 173.48882 177.92851 181.29451 186.00151 190.65451 192.87392 197.52692 202.19792 204.41733 206.50533 212.34633 217.52133">IF software interrupt (* Generated by INT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-427.9873" x="219.7803">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-427.9873" x="224.6403 226.4691 228.68851 230.78731 236.63911 241.82492 247.09172 248.92052 251.13992 255.86673 259.13553 261.35492 263.4537 269.30551 274.4913 280.2261 282.09991 284.31931 288.939 293.68021 298.39801 302.41382 304.63321 309.414 314.09491 317.47171 319.6911 324.16589 328.82968 333.44937 335.37088 340.05267 342.27206 345.64886 350.37567 352.59506 354.69385 360.54565 365.73145 370.99823 373.21762 377.24243">, INT3, or INTO; does not apply to INT1 *)</tspan><tspan y="-415.98761" x="77.520004 82.729202 88.5504 93.300598">THEN</tspan><tspan y="-403.98792" x="95.520004 97.605301 102.3186 104.53801 109.18831 113.64961 117.01291 121.75321 123.97261 129.49591 134.60521 139.05751 141.27692 146.29622 148.51562 153.22893 158.33823 162.79053 165.00993 167.59024 171.60155 173.82095 178.98245 183.66336 185.88277 190.99207 193.21147 198.46477 200.28006 202.49947 208.07767 213.17886 217.63116 219.85057 224.86987 227.08928 231.80258 236.91188 241.36418 243.17947 245.39888 249.40118 254.11449 257.44177 260.80508 267.74139 272.24051 275.49582 280.23615 282.45554 284.39685 289.19925 292.56256 297.26688 300.569 303.81082 308.61322 313.23291 316.59622 318.81561 322.8269">IF gate DPL &lt; CPL (* PE = 1, DPL &lt; CPL, software interrupt *)</tspan><tspan y="-391.98822" x="113.52 118.7256 124.5468 129.2934 135.11459 137.33398 143.12459 148.42018 153.52138 156.10078 160.83838 164.08018 167.36879 172.04968 175.33829 179.83919 183.76678 188.51338 193.19698 197.87787 200.45728 205.13638 209.81728 213.71698 217.07669 221.81789 225.05969 229.6209 234.42149 239.16359 246.13319 250.75288 255.49048 258.73227 260.58087 265.80087 267.64948 272.86948 275.44885 278.08765 279.94794 282.16733 286.84824 288.94882">THEN #GP(error_code(vector_number,1,0)); FI;</tspan><tspan y="-379.98853" x="113.52 116.1264 120.1638 122.3832 124.3047 128.98381 132.37321 134.59261 139.2735 143.95261 148.68301 151.92482 156.36452 161.16692 165.78662 168.00601 171.39542 176.07631 178.2957 183.02611 186.26791 189.54932 194.23021 197.51161 202.01251 205.93291 210.6723 215.34871 220.02962 222.24901 226.2774 230.95831 234.34772 236.56711 241.18681 245.92712 249.84752 254.28722 259.08063 263.04245 267.77286 269.99225 274.61102 279.35132 283.27173 286.66113 291.40054 294.64233 296.86172 298.78323 302.80536 305.02475 309.81815 313.84656 318.52747 323.20654 325.42593 329.46335">(* idt operand to error_code set because vector is used *)</tspan><tspan y="-367.98883" x="113.52 116.1228 120.1566 122.37601 127.05691 131.85481 135.24062 137.46001 142.1958 146.81551 151.54231 154.82011 159.25981 164.06221 168.73502 170.95441 174.34021 179.0211 181.24049 185.9673 189.2451 192.5229 197.2038 200.4816 204.9825 208.89929 213.63509 218.30789 222.9888 225.20819 227.172 231.19679 233.41618 238.63618 240.85558 245.52838 250.20929 254.12608 258.60989 263.35199 267.37411 272.10092 274.32031 276.36151 282.24213">(* ext operand to error_code is 0 because INT</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-367.98883" x="289.6203">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-367.98883" x="294.48029 296.32257 298.54199 300.58319 306.46378 311.62259 316.90289 318.70197 320.92139 325.66168 328.90347 331.12289 333.2352 339.0564 344.25571 349.95358 353.99188">, INT3, or INTO*)</tspan><tspan y="-355.98914" x="59.519974 64.254875 66.361778">FI;</tspan><tspan y="-343.98944" x="59.519974 61.610672 66.329376 68.548775 73.204475 77.671173 81.039871 85.749573 87.968971 92.741669 97.460373 100.82907 103.04847 107.70417 110.96487 115.67457 119.68227 124.39197 129.16467 132.53337">IF gate not present </tspan><tspan y="-331.98975" x="77.519974 82.738174 88.55938 93.269081 99.103783 101.32319 107.07689 112.91159 118.07309 120.65249 125.35319 128.65529 131.90698 136.61668 139.86838 144.40707 148.29778 153.00748 157.65417 162.39447 164.97118 169.59988 174.34018 178.25967 181.61487 186.32007 189.62216 194.18335 198.94255 203.74495 210.67316 215.31535 220.01155 223.31366 225.12086 230.36606 232.17326 236.87846 242.51967 247.68387 250.25607 252.89488 254.74709 256.96649 261.67169 263.7489">THEN #NP(error_code(vector_number,1,EXT)); FI;</tspan><tspan y="-319.99005" x="77.519974 80.126373 84.163773 86.383171 88.304672 92.983772 96.373169 98.592567 103.27347 107.95257 112.68297 115.92477 120.36447 125.16688 129.78658 132.00597 135.39537 140.07626 142.29565 147.02606 150.26787 153.54927 158.23016 161.51157 166.01247 169.93286 174.67226 179.34866 184.02957 186.24896 190.27736 194.95827 198.34767 200.56706 205.18677 209.92708 213.84747 218.28717 223.08057 227.04236 231.77277 233.99216 238.61096 243.35127 247.27167 250.66107 255.40047 258.64224 260.86163 262.78314 266.80527 269.02466 273.81805 277.84647 282.52737 287.20645 289.42584 293.46326">(* idt operand to error_code set because vector is used *)</tspan><tspan y="-307.99036" x="59.519974 61.610672 66.329376 68.548775 71.917473 76.384171 80.391869 84.710968 86.930367 91.586067 96.052765 99.421463 104.13116 106.35056 108.98936 112.95116 115.17056 119.94326 124.59896 129.30865 133.20836 135.15506 138.48776 140.43446 145.14417 149.79987 152.01927 153.96597 158.73868 160.95808 164.32678 169.09949 173.80919 176.02859 180.0363 184.73967 186.65936 191.36906 195.26877 198.63747 203.34717 208.00287 210.22137 212.16808 216.94078 220.30948 225.01918 228.27988 231.58107 236.35378 241.00948 244.37817 246.59668 249.96538 254.43208 259.08777 261.00748 265.71716 267.93567 272.59137 277.30106 281.30875 285.20844 288.46915 290.41583 295.07153 298.44025 303.15894 306.41965 308.63815 312.65485">IF task gate (* Specified in the selected interrupt table descriptor *)</tspan><tspan y="-295.99066" x="77.519974 82.721077 88.542282 93.284386 99.105591 101.32499 106.61609 112.31399 117.51509 123.21299 125.43239 130.59119 136.23059 140.97269 146.25299 149.07359 154.3539 159.9339 165.0927 169.83479">THEN GOTO TASK-GATE;</tspan><tspan y="-283.99097" x="77.519974 82.226074 86.671173 91.473572 96.214775 98.434174 103.68927 109.44747 114.61257 120.32668 122.54607 127.76427 133.17238 138.76048 143.92198 146.73808 152.45218 157.91158 160.73218 162.81027 168.64137 173.80647 178.51257 183.92067 189.38007 195.04916 200.15126 205.36946 208.19006 213.44516 219.03326 224.19836 228.90446 230.75757 232.97697 235.55008 239.58028 241.79968 246.91618 251.63669 253.85609 258.9726 261.19199 266.45248 268.27499 270.49438 273.9144 277.15622 281.62473 286.28223 289.40973 291.35822 296.13272 299.50323 304.21472 307.47723 310.73975 315.51425 320.17175 323.54227 325.76166 330.41916 334.88766 338.25818 342.96967 345.18906 349.20755">ELSE GOTO TRAP-OR-INTERRUPT-GATE; (* PE = 1, trap/interrupt gate *)</tspan><tspan y="-271.99127" x="59.519974 64.254875 66.361778">FI;</tspan><tspan y="-259.99158" x="46.019974 50.714375 56.594975 62.099373">END;</tspan><tspan y="-247.99188" x="46.019974 48.112473 53.714973 56.545475 61.805977 67.066475 71.777977 74.608475 81.182976 86.911476 92.441978 97.162476">IA-32e-MODE:</tspan><tspan y="-235.99219" x="59.519974 61.619675 66.347374 68.566772 70.666473 76.519173 81.705872 87.441574 89.660973 94.136673 98.918373 103.53808 105.75748 110.48518 115.26688 116.97958 121.44627 123.66567 128.78937 131.00876 136.22876 138.44815 141.04285 146.31055 151.57825 154.41595 159.03566 161.01746 164.39516 166.61455 173.56525 178.24615 182.91086 187.62956">IF INTO and CS.L = 1 (64-bit mode)</tspan><tspan y="-223.99249" x="77.519974 82.718376 88.539581 93.278984 99.100189 101.31959 107.10299 112.80539 118.32329">THEN #UD;</tspan><tspan y="-211.9928" x="59.519974 64.254875 66.361778">FI;</tspan><tspan y="-199.9931" x="59.519974 61.609776 66.327576 68.546974 71.131775 73.716576 78.395676 83.104477 87.003281 90.371078 95.088882 98.348679 102.89548 107.66727 112.43907 119.37988 124.03468 128.74347 132.00327 134.22267 139.62447 141.84387 147.10167 149.68646 151.90587 157.07367 159.30028 164.55447 169.80867 172.44748 174.66689 176.60909 180.61229 182.8317 187.5999 192.3141 195.6783 197.89771 199.8399 204.60811 206.82751 208.91371 214.43791 219.65611 221.87552 223.79073 225.73293 232.67012 234.61232 237.97652">IF ((vector_number « 4) + 15) is not in IDT limits</tspan><tspan y="-187.99341" x="59.519974 64.241371 67.504768 69.724167 73.734566 78.446968 80.36937 85.081772 88.984169 92.355568 97.06797 101.72637 103.94577 105.98697 111.56517 116.74557 118.96497 123.58467 128.32497 132.33537 136.23778 139.50117 141.45058 146.07028 149.42998 154.15138 157.41478 159.63419 161.58359 165.59399 167.8134 172.58881 177.35968 180.72838 182.94778 187.41449 192.18719 194.4066 196.3533 201.12601 204.49471 209.20441 212.4651 215.7672 220.5399 225.1956 228.5643 231.39301 233.2137 235.43311 240.15181 243.41251 245.63191 249.05191 252.2937 256.76041 261.41611 264.24481 268.90051 273.36722 276.73593 281.44562 283.66501 287.03372 291.70743 296.36313">or selected IDT descriptor is not an interrupt-, or trap-gate type</tspan><tspan y="-175.99371" x="77.519981 82.738182 88.559387 93.27449 99.114594 101.33399 107.09309 112.35719 117.46829 120.05039 124.7907 128.04779 131.30489 136.01999 139.32208 143.82298 147.71909 152.43419 157.08629 161.79239 164.3745 169.00859 173.74889 177.64859 181.01369 185.72879 188.98589 193.52998 198.33238 203.07449 210.01259 214.66469 219.40498 222.64677 224.50526 229.72527 231.58376 236.26466 241.91577 247.13397 249.71608 252.29819">THEN #GP(error_code(vector_number,1,EXT));</tspan><tspan y="-163.99402" x="77.519981 80.126381 84.16378 86.383186 88.304688 92.983788 96.373184 98.592583 103.27348 107.95258 112.68298 115.92479 120.36449 125.16689 129.78659 132.00598 135.39539 140.07628 142.29567 147.02608 150.26788 153.54929 158.23018 161.51158 166.01248 169.93288 174.67227 179.34868 184.02959 186.24898 190.27737 194.95828 198.34769 200.56708 205.18678 209.92709 213.84749 218.28719 223.08058 227.04237 231.77278 233.99217 238.61098 243.35129 247.27168 250.66109 255.40048 258.64227 260.86166 262.78317 266.8053 269.02469 273.81808 277.8465 282.5274 287.20648 289.42587 293.46329">(* idt operand to error_code set because vector is used *)</tspan><tspan y="-151.99432" x="59.519981 64.254883 66.361786">FI;</tspan><tspan y="-139.99463" x="59.519981 61.607983 66.323982 68.543381 72.548378 77.264381 80.594383 83.960381 90.899384 95.36338 98.665482 103.34638 105.56578 107.50978 112.27979 115.64578 120.35278 123.61079 126.91289 131.68289 136.33589 139.70189 141.9213 144.5043 148.51831 150.73772 156.00272 160.70972 165.47972 170.18672 173.48882 177.92851 181.29451 186.00151 190.65451 192.87392 197.52692 202.19792 204.41733 206.50533 212.34633 217.52133">IF software interrupt (* Generated by INT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-139.99463" x="219.78027">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-139.99463" x="224.64027 226.46907 228.68848 230.78728 236.63908 241.82489 247.09169 248.92049 251.13989 255.8667 259.1355 261.35489 263.45367 269.30548 274.49127 280.22607 282.09988 284.31927 288.93896 293.68018 298.39798 302.41379 304.63318 309.41397 314.09488 317.47168 319.69107 324.16586 328.82965 333.44934 335.37085 340.05264 342.27203 345.64883 350.37564 352.59503 354.69382 360.54562 365.73141 370.99823 373.21762 377.24243">, INT3, or INTO; does not apply to INT1 *)</tspan><tspan y="-127.99493" x="77.519974 82.729172 88.550369 93.300568">THEN</tspan><tspan y="-115.99522" x="95.519974 97.60527 102.31857 104.53798 109.18828 113.64958 117.01288 121.75318 123.97258 129.49588 134.60518 139.05748 141.27689 146.29619 148.51559 153.2289 158.3382 162.7905 165.0099 167.59021 171.60152 173.82092 178.98242 183.66333 185.88274 190.99203 193.21144 198.46474 200.28003 202.49944 208.07764 213.17883 217.63113 219.85054 224.86984 227.08925 231.80255 236.91185 241.36415 243.17944 245.39885 249.40115 254.11446 257.44174 260.80505 267.74136 272.24048 275.49579 280.23611 282.45551 284.39682 289.19922 292.56253 297.26685 300.56897 303.81079 308.61319 313.23288 316.59619 318.81558 322.82687">IF gate DPL &lt; CPL (* PE = 1, DPL &lt; CPL, software interrupt *)</tspan><tspan y="-103.99552" x="113.51997 118.72557 124.54677 129.29337 135.11456 137.33395 143.12456 148.42015 153.52135 156.10075 160.83835 164.08015 167.36876 172.04965 175.33826 179.83916 183.76675 188.51335 193.19695 197.87784 200.45724 205.13635 209.81725 213.71695 217.07666 221.81786 225.05966 229.62086 234.42146 239.16356 246.13316 250.75285 255.49045 258.73224 260.58084 265.80084 267.64944 272.86945 275.44882 278.08762">THEN #GP(error_code(vector_number,1,0));</tspan><tspan y="-91.995819" x="113.51997 116.12637 120.16377 122.38317 124.30467 128.98378 132.37318 134.59258 139.27347 143.95258 148.68298 151.92479 156.36449 161.16689 165.78659 168.00598 171.39539 176.07628 178.29567 183.02608 186.26788 189.54929 194.23018 197.51158 202.01248 205.93288 210.67227 215.34868 220.02959 222.24898 226.27737 230.95828 234.34769 236.56708 241.18678 245.92709 249.84749 254.28719 259.0806 263.04242 267.77283 269.99222 274.61099 279.35129 283.2717 286.6611 291.40051 294.6423 296.86169 298.7832 302.80533 305.02472 309.81812 313.84653 318.52744 323.20651 325.4259 329.46332">(* idt operand to error_code set because vector is used *)</tspan><tspan y="-79.996117" x="113.51997 116.12277 120.15657 122.37598 127.05688 131.85478 135.24059 137.45998 142.19577 146.81548 151.54228 154.82008 159.25978 164.06218 168.73499 170.95438 174.34018 179.02107 181.24046 185.96727 189.24507 192.52287 197.20377 200.48157 204.98247 208.89926 213.63506 218.30786 222.98877 225.20816 227.17197 231.19676 233.41615 238.63615 240.85555 245.52835 250.20926 254.12605 258.60986 263.35196 267.37408 272.10089 274.32028 276.36148 282.2421">(* ext operand to error_code is 0 because INT</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-79.996117" x="289.62027">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-79.996117" x="294.48026 296.32254 298.54196 300.58316 306.46375 311.62256 316.90286 318.70193 320.92136 325.66165 328.90344 331.12286 333.23517 339.05637 344.25568 349.95355 353.99185">, INT3, or INTO*)</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="355.35016pt" height="644.40204pt" viewBox="0 0 355.35016 644.40204" sodipodi:docname="614.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.84036" inkscape:cy="423.83811" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg166" /><g transform="translate(-45.119728,-69.476563)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="94.68 99.414902 101.5218">FI;</tspan><tspan y="-703.98029" x="58.619701 63.354603 65.461502">FI;</tspan><tspan y="-691.98059" x="58.619701 60.7113 65.430901 67.650299 72.3069 76.774498 80.144096 84.854698 87.074097 91.847694 96.567291 99.93689 102.15629 106.81289 110.07449 114.78509 118.79369 123.50429 128.27789 131.69789">IF gate not present </tspan><tspan y="-679.9809" x="76.68 81.898201 87.719406 92.430008 98.26561 100.48502 106.23962 112.12022 117.22681 119.80441 124.50601 127.80811 131.06071 135.77132 139.02391 143.56351 147.45511 152.16571 156.81331 161.5536 164.13121 168.77969 173.51999 177.41969 180.77309 185.47649 188.77859 193.33978 198.09718 202.89958 209.82599 214.46638 219.16078 222.46289 224.2683 229.51169 231.31709 236.02049 241.6599 246.8223 249.46111 252.04051">THEN #NP(error_code(vector_number,1,EXT));</tspan><tspan y="-667.9812" x="76.679993 79.318794 83.340897 85.560295 87.507896 92.164497 95.534096 97.753494 102.4731 107.1297 111.8403 115.1019 119.5695 124.34309 128.99969 131.2191 134.5887 139.3083 141.52771 146.23831 149.49991 152.802 157.48291 160.785 165.2859 169.18651 173.90611 178.56271 183.27332 185.4603 189.4707 194.18311 197.6031 199.82251 204.48091 209.19331 213.09572 217.56512 222.34053 226.35094 231.06334 233.28275 237.92314 242.63554 246.53795 249.90935 254.63075 257.89417 260.11356 262.06296 266.02475 268.24414 273.01953 277.02994 281.74234 286.40073 288.62012 292.63953">(* idt operand to error_code set because vector is used *)</tspan><tspan y="-655.98151" x="58.620598 63.355499 65.462402">FI;</tspan><tspan y="-643.98181" x="58.620598 63.879299 69.637497 74.806198 80.523895 82.743301 87.961502 93.373199 98.964897 104.1264 106.9461 112.6638 118.07549 120.9564 123.0381 128.8728 134.0415 138.75121 144.1629 149.5746 155.2473 160.353 165.5712 168.3909 173.6496 179.2413 184.41 189.11971 190.97641 193.19582 195.77252 199.78023 201.99963 207.16833 210.47043 214.92813 219.57483 222.69153 224.62923 229.43163 232.79132 237.53162 240.78331 244.035 248.8374 253.4841 256.84381 259.0632 263.7099 268.20901 271.56873 276.26944 278.48883 282.49652">GOTO TRAP-OR-INTERRUPT-GATE; (* Trap/interrupt gate *)</tspan><tspan y="-631.98212" x="45.120598 49.814999 55.695599 61.199997">END;</tspan><tspan y="-619.98242" x="45.120598 50.293797 55.889996 60.692394 65.912392 68.793297 74.014198 79.653595 84.812401 89.526604 91.270805 93.490204 96.071404 100.0836 102.303 107.4132">TASK-GATE: (* PE</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-619.97998" x="112.14"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-619.97998" x="114.84 119.9547 122.1741 127.43279 129.25349 131.4729 134.8929 139.33261 143.34032 147.61801 149.83742 154.49312 158.95982 162.32852 167.03822 169.25763 173.27432">= 1, task gate *)</tspan><tspan y="-607.98029" x="58.619698 64.044899 68.759102 73.230301 77.890503 80.109901 85.292099 90.069298 94.846497 97.065895 101.02769 105.768 107.6922 112.4064 116.3106 119.6838 124.407 127.6722 129.8916 131.8428 136.62001 138.83942 142.21262 146.68382 150.69603 154.98001 157.19942 161.83981 166.33891 169.69231 174.3867 176.60611 179.17651 181.27711 186.79051 192.00871 194.22812 198.86852 203.60881 207.63091 211.53061 214.77602 216.70741 221.38651 224.7462 229.4874 232.7292 235.29961">Read TSS selector in task gate (IDT descriptor);</tspan><tspan y="-595.98059" x="76.680016 78.773415 83.494812 85.714211 87.636612 92.358009 96.260406 100.7298 102.65221 105.78061 110.43901 112.36141 117.08281 121.74121 126.21061 128.13301 130.35242 135.01082 136.96022 140.33162 142.55103 144.50043 148.51083 150.73024 154.74065 159.45305 162.82445 165.04385 168.41525 173.13666 175.35606 177.27846 181.98001 185.88242 190.35182 192.27422 194.49362 199.21503 202.47842 204.69783 206.64723 211.42264 216.08104 220.79344 225.57784 227.79724 232.57265 237.29405 240.66545 242.88031 249.82201 251.76871 255.13741 259.9101 261.85678 266.62949 268.84888 274.11658 279.64526 284.82297 287.04236 288.96207 290.90875 297.85046 299.79715 303.16586">IF local/global bit is set to local or index not within GDT limits</tspan><tspan y="-583.9809" x="94.680008 99.880211 105.70142 110.44262 116.26382 118.48322 124.26842 129.55862 134.65984 137.23924 141.97144 145.21324 148.49644 153.17734 156.46054 160.96144 164.88364 169.62483 174.30304 178.98395 181.56335 186.78156 191.52365 196.32605 198.54544 202.50723 207.24754 209.18974 213.87064 217.79283 221.18404 225.86493 229.16704 230.96614 236.24644 238.04555 242.78674 248.42795 253.58675 256.16614 258.80496 260.66528 262.88467 267.56558 269.66617">THEN #GP(error_code(TSS selector,0,EXT)); FI;</tspan><tspan y="-571.9812" x="94.680008 97.283707 101.31841 103.53781 105.45931 110.13841 113.52512 115.74452 120.42542 125.10452 129.83223 133.07404 137.51373 142.31613 146.98984 149.20923 152.59593 157.27682 159.49622 164.22392 167.46573 170.74443 175.42532 178.70403 183.20493 187.12262 191.85931 196.53302 201.21393 203.43332 205.39803 209.35982 211.57921 216.85591 219.0753 223.74901 228.42992 232.34761 236.83231 241.5744 245.5965 250.3242 252.54359 256.5054 261.2457 263.18341 267.86429 271.78198 275.16867 279.84958 283.15167 285.37109 287.29257 291.31467 293.53409 298.27618 302.29828 307.02597 311.64569 313.86511 317.89981">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-559.98151" x="76.680008 82.281609 86.182205 90.082802 94.793404 98.802002 102.8106 105.03 110.2086 114.9822 119.7558 121.9752 126.6318 131.34239 135.351 139.2516 142.5132 144.4608 149.1174 152.487 157.16791 160.47 162.68941 164.63701 169.41061 171.63002 176.89862 182.42822 187.60683">Access TSS descriptor in GDT;</tspan><tspan y="-547.98181" x="76.680008 78.775208 83.498405 85.717804 90.900002 95.6772 100.4544 102.6738 107.334 112.0482 116.0604 119.9646 123.2298 125.181 129.8412 133.2144 137.93761 141.2028 143.42221 147.43442 152.05412 156.76833 160.67253 162.62373 165.96094 167.91214 172.62634 176.63855 178.85971 182.22751 186.99931 191.46512 194.83292 197.05232 200.42012 205.19193 209.90073 212.12013 217.33833 222.08044 226.85225 229.07166 231.01746 235.02426 237.24367 241.89847 246.67027 250.67708 255.34988 257.56927 260.15408 262.07288 266.79068 273.73148 276.55927 281.27972 284.55301 289.1727 293.89499 297.16827 299.3877 304.659 306.87842 311.49811 313.47989 316.86118 320.88147 323.10089 327.06268 331.80298 335.18427 337.40369 340.78497 345.51627 347.73569 353.00699 358.22699 363.49829 368.76959 373.98959">IF TSS descriptor specifies that the TSS is busy (low-order 5 bits set to 00001)</tspan><tspan y="-535.98212" x="94.680023 99.880226 105.70143 110.44263 116.26384 118.48324 124.26844 129.55864 134.65985 137.17896 141.91116 145.15297 148.43617 153.11707 156.40027 160.90117 164.82336 169.56456 174.24277 178.92368 181.50308 186.72128 191.46338 196.26578 198.48517 202.44696 207.18727 209.12947 213.81036 217.73256 221.12376 225.80466 229.10677 230.90587 236.18617 237.98528 242.72647 248.36768 253.52647 256.10587 258.74466 260.60498 262.82437 267.50528 269.60587">THEN #GP(error_code(TSS selector,0,EXT)); FI;</tspan><tspan y="-523.98242" x="94.680023 97.283722 101.31842 103.53783 105.45933 110.13843 113.52513 115.74454 120.42544 125.10454 129.83224 133.07405 137.51375 142.31615 146.98985 149.20924 152.59595 157.27684 159.49623 164.22394 167.46574 170.74445 175.42534 178.70404 183.20494 187.12263 191.85933 196.53304 201.21394 203.43333 205.39804 209.35983 211.57922 216.85593 219.07532 223.74902 228.42993 232.34763 236.83232 241.57442 245.59651 250.32422 252.54361 256.5054 261.2457 263.18341 267.86429 271.78198 275.16867 279.84958 283.15167 285.37109 287.29257 291.31467 293.53409 298.27618 302.29828 307.02597 311.64569 313.86511 317.89981">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-511.98273" x="76.680023 78.76622 83.480423 85.699821 90.873024 95.64122 100.40942 102.62882 107.39702 112.11122 115.47542 117.69482 122.34602 125.64812 130.35332 134.35652 139.06172 143.82993 147.19412">IF TSS not present </tspan><tspan y="-499.98303" x="94.680023 99.865822 105.71762 110.44442 116.29622 118.51562 124.28642 130.13821 135.26102 137.78011 142.46101 145.76311 149.03191 153.75871 157.02751 161.58331 165.49112 170.21793 174.83763 179.57794 182.17174 187.35754 192.13834 196.88043 199.09982 203.11562 207.83342 209.76122 214.44212 218.34993 221.72673 226.45354 229.72234 231.55113 236.77113 238.59993 243.28084 248.94363 254.12944 256.72324 259.31705 261.19086 263.41025 268.13705 270.23584">THEN #NP(error_code(TSS selector,0,EXT)); FI;</tspan><tspan y="-487.98334" x="94.680023 97.283722 101.31842 103.53783 105.45933 110.13843 113.52513 115.74454 120.42544 125.10454 129.83224 133.07405 137.51375 142.31615 146.98985 149.20924 152.59595 157.27684 159.49623 164.22394 167.46574 170.74445 175.42534 178.70404 183.20494 187.12263 191.85933 196.53304 201.21394 203.43333 205.39804 209.35983 211.57922 216.85593 219.07532 223.74902 228.42993 232.34763 236.83232 241.57442 245.59651 250.32422 252.54361 256.5054 261.2457 263.18341 267.86429 271.78198 275.16867 279.84958 283.15167 285.37109 287.29257 291.31467 293.53409 298.27618 302.29828 307.02597 311.64569 313.86511 317.89981">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-475.98364" x="58.619724 63.407722 70.724724 72.830727 77.989525 82.670425 88.551025 91.395027 96.553825 102.16982 106.91193 112.17693 116.91903 119.13843 121.73943 128.69643 130.61794 134.03793 138.78003 140.99942 145.78741 150.46832 154.49132 157.87532 159.83733 164.57942 169.25043 171.85143 174.07082 177.45482 182.18881 184.4082 189.567 194.3694 199.1115">SWITCH-TASKS (with nesting) to TSS;</tspan><tspan y="-463.98395" x="58.619724 60.703224 65.414726 67.634132 69.615929 74.358032 77.719536 82.459839 85.713341 88.966843 93.769249 98.417747 101.77925 103.99866 107.89116 112.35066 117.15307 121.17517 125.87767 130.52617 132.74557 137.39407 142.06058 144.27998 147.60548 152.06499 156.86739 158.78889 162.15039 164.3698 171.30429 173.24379 176.60529 181.40768 183.62709 188.32959 191.63168 194.88518 199.59668 202.85017 205.06958 208.96208 213.67358 218.32208">IF interrupt caused by fault with error code</tspan><tspan y="-451.98425" x="76.680023 81.889221 87.710419 92.460617">THEN</tspan><tspan y="-439.98456" x="94.680023 96.771622 101.49123 103.71062 107.71922 111.08882 115.55642 119.45702 123.73562 125.95502 127.87562 129.82321 136.76581 138.71341 142.13341 144.35281 149.00941 153.72902 158.43962 162.44823 164.66763 169.44124 174.16084 177.58084 179.80025 184.26785 186.18845 188.10904 192.82864 199.77124 201.99065 206.64725 211.42085 215.38266 220.18506 222.40446 227.12407 230.45767 232.67708 237.38768 240.64928 243.91087 248.63048 251.89207 254.11148 258.01208 262.73169 267.38828">IF stack limit does not allow push of error code</tspan><tspan y="-427.98486" x="112.68002 117.86402 123.71402 128.43903 134.28903 136.50844 142.27744 147.05644 151.79855 154.37794 159.10295 164.76395 169.94795 172.53995 174.41194 176.63135 181.31226 183.41286">THEN #SS(EXT); FI;</tspan><tspan y="-415.98517" x="94.680023 99.841522 104.58362 108.59312 113.36761 115.95512 120.66662 123.96871 127.21051 131.93102 135.19351 137.41292 141.31442 146.03493 150.69243 155.40393 157.99142">Push(error code);</tspan><tspan y="-403.98547" x="58.619724 63.354626 65.461525">FI;</tspan><tspan y="-391.98578" x="58.619724 60.712223 65.432724 67.652122 72.37262 74.465118 79.581619 81.801018 86.575516 91.296013 94.666512 96.88591 103.82941 105.77791 109.14841 113.9229 115.87141 120.6459 122.87973 126.77583 131.49094 136.14304 140.84914 143.06854 147.07265 151.77875 156.43085 163.36894 168.07504 172.84415 176.26414 178.48355 180.39966 182.34276 189.28085 191.22395 194.58905">IF EIP not within code segment limit </tspan><tspan y="-379.98608" x="76.680031 81.860428 87.706825 92.428223 98.27462 100.49402 106.25942 111.52982 116.64722 119.23563 123.95702 129.61443 134.79483 137.38322 139.25162 141.47102 146.15193 148.25253">THEN #GP(EXT); FI;</tspan><tspan y="-367.98639" x="45.119728 49.814129 55.694729 61.199127">END;</tspan><tspan y="-355.98669" x="45.119728 50.27853 55.678532 61.308033 66.409233 69.229828 74.988029 80.388031 83.208626 85.328125 91.149323 96.35582 101.03672 106.48622 111.88622 117.59673 122.69793 127.85673 130.67734 135.97383 141.55383 146.76033 151.44122">TRAP-OR-INTERRUPT-GATE:</tspan><tspan y="-343.987" x="58.619728 64.060226 68.741127 73.227631 77.847328 80.066734 84.859238 89.540138 96.50164 98.721046 102.64055 107.37905 111.99875 116.73905 119.55965 123.58176 128.26266 132.94177 139.84207 144.58238 149.32448 152.74448 154.96387 158.92566 163.66597 165.60547 170.33942 174.22742 177.58441 182.29141 185.59351 187.81291 191.13391 195.84091 199.0899 201.30931 204.66631 207.9684 212.4234 217.0674 219.2868 223.9938 227.2428 229.4622 231.3972 236.1996 239.55659 244.29689 247.54588 250.79488 255.59727 260.24127 263.59827 265.81766 270.46167 274.96075 278.31775 283.01575 285.23514 287.87393 289.91513 295.49332 300.6521 302.87149 307.5155 312.2558 316.2518 320.1398 323.38879 325.37061 330.01462 333.37161 338.07861 341.32761 343.9664">Read new code-segment selector for trap or interrupt gate (IDT descriptor);</tspan><tspan y="-331.9873" x="58.61972 60.712219 65.432716 67.652115 72.426613 77.138115 84.081612 86.30101 90.202507 94.923004 99.580505 104.29201 107.1729 111.1347 115.84621 120.50371 127.4472 132.15871 136.93321 140.30371 142.52312 146.53262 151.24413 153.16562 157.87712 161.77863 165.14912 169.86963 173.13213 175.35153 177.30003 181.30954 183.52895 189.37445 195.05795 199.51746">IF new code-segment selector is NULL</tspan><tspan y="-319.98761" x="76.680023 81.898224 87.719429 92.431831 98.269234 100.48864 106.24504 111.50644 116.61484 119.19424 123.90664 129.55504 134.72644 137.36525 139.22466 141.44406 146.15646 148.24086 150.10027 152.25937 154.89818 158.92029 161.13969 165.8521 169.15419 172.40858 177.12099 180.37538 182.59479 186.48819 191.20059 195.84999 200.59029 202.80969 206.70309 211.4155 216.2179 219.57759 224.07669 225.99818 230.80058 234.76239 236.9818 242.8624 248.5036 253.0027 257.4415 259.66089 263.66229 268.36569 270.27908 275.01938 278.91278 282.27518 286.98758 290.24197 292.46136 296.47177">THEN #GP(EXT); FI; (* Error code contains NULL selector *)</tspan><tspan y="-307.98792" x="58.61972 60.71312 65.434517 67.653915 72.429314 77.141716 84.086113 86.305511 90.207909 94.929306 99.587708 104.30011 107.18101 111.14281 115.85521 120.51361 127.45801 132.17041 136.94582 140.31721 142.53662 146.54703 151.25943 153.18182 157.89423 161.79663 165.16803 169.88943 173.15283 175.37224 177.32164 181.33205 183.55145 188.32686 193.04826 196.41966 198.59943 205.54292 207.49142 210.86192 215.63643 217.58493 222.35944 224.57884 226.52734 229.89784 233.90735 236.12675 240.78426 245.49576 249.50526 253.40677 256.70889 258.63037 263.28787 266.65839 271.37888 274.64139 276.86078 280.23129 284.6998 289.3573 291.27881 295.9903 298.20969 300.1312 302.07968 309.02319 310.97168 314.34219 318.35168">IF new code-segment selector is not within its descriptor table limits </tspan><tspan y="-295.98822" x="76.679131 81.880234 87.701439 92.443542 98.264748 100.48415 106.27025 111.56135 116.66254 119.24194 123.97504 127.21685 130.50095 135.18184 138.46594 142.96684 146.88994 151.63203 156.31113 160.99202 163.57143 168.37383 173.05472 180.01532 182.23471 186.15781 190.8999 195.51961 200.2599 203.08051 207.05942 211.75381 216.39421 223.32062 228.06091 232.81831 236.23831 238.45772 242.45012 247.19041 249.09482 253.78922 257.67361 261.0936 265.797 269.09909 270.90448 276.14789 277.95328 282.65668 288.29608 293.4585 296.0289 298.66769 300.5181 302.73749 307.44089 309.5163">THEN #GP(error_code(new code-segment selector,0,EXT)); FI;</tspan><tspan y="-283.98853" x="76.679123 79.317924 83.340027 85.559425 87.509727 92.169029 95.541328 97.760727 102.48302 107.14233 111.85563 115.11993 119.59023 124.36652 129.02582 131.24522 134.61752 139.33983 141.55923 146.27254 149.53683 152.83893 157.51984 160.82193 165.32283 169.22614 173.94844 178.60774 183.32104 185.54045 187.49075 191.39943 193.61884 198.87753 201.09694 205.75264 210.46234 214.36205 218.82875 223.60146 227.60916 232.31886 234.53827 238.54597 243.25568 245.17537 249.88507 253.78477 257.20477 261.92346 265.18417 267.40356 269.35025 273.35794 275.57733 280.35004 284.35773 289.06741 293.72311 295.9425 299.9592">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-271.98883" x="58.619736 64.056633 68.737534 73.220436 77.840134 80.05954 84.731438 89.412338 93.436241 97.352142 100.62904 102.55054 107.22244 110.60735 115.34225 118.61915 120.83855 124.11546 128.84135 132.14076 136.88107 140.15797 144.88388 149.62598 153.52567 158.25157 162.87128 165.09067 169.76257 174.45247 176.67186 181.41396 186.15427 193.11217 195.33156 199.24745 203.92834 208.60025 213.28116 216.12605 220.14995 224.87585 229.49556 236.45346 241.13437 245.92326 249.30817 251.52756 255.55145 260.23233 262.16824 266.84912 270.76501 274.1499 278.8848 282.16168">Read descriptor referenced by new code-segment selector;</tspan><tspan y="-259.98914" x="58.619736 60.720337 65.461533 67.680931 72.360031 77.040932 81.063034 84.96273 88.203629 90.185432 94.821335 98.241333 102.94023 106.24233 108.46173 113.09763 117.83883 122.52873 126.55083 128.77025 133.57265 138.25354 141.60245 143.82185 145.80365 150.60605 155.24194 157.22374 161.10364 165.55054 168.89944 173.63974 175.85915 180.30605 182.52545 186.40535 191.14655 195.78244 200.52274 202.74214 206.76424 211.44513 216.12422 223.02452 227.76482 232.56721 235.91612 238.13553 242.83443 246.13654 248.35594 253.10884 257.84915 264.77106 266.99045 270.87036 275.61157 280.29068 284.97159 287.78049 291.80261 296.54294 301.16263 308.12323 312.80414 317.60654 320.96625 323.18564 328.69455 333.78946 338.28854 340.50793 345.51285 347.73224 352.47345 357.57465">IF descriptor does not indicate a code segment or new code-segment DPL &gt; CPL</tspan><tspan y="-247.98944" x="76.680038 81.881142 87.702347 92.44445 98.265656 100.48505 106.27116 111.56226 116.66345 119.24285 123.97595 127.21776 130.50186 135.18275 138.46686 142.96776 146.89085 151.63295 156.31204 160.99294 163.57234 168.37474 173.05563 180.01624 182.23563 186.15872 190.90082 195.52052 200.26082 203.08142 207.06033 211.75473 216.39513 223.32153 228.06183 232.81923 236.23923 238.45863 242.45103 247.19133 249.09573 253.79013 257.67453 261.09451 265.79791 269.10001 270.9054 276.1488 277.95419 282.65759 288.297 293.45941 296.02982 298.66861 300.51901 302.7384 307.4418 309.51721">THEN #GP(error_code(new code-segment selector,0,EXT)); FI;</tspan><tspan y="-235.98975" x="76.680038 79.31884 83.340942 85.560341 87.510643 92.169945 95.542244 97.761642 102.48394 107.14324 111.85654 115.12084 119.59114 124.36744 129.02673 131.24614 134.61844 139.34074 141.56015 146.27345 149.53775 152.83984 157.52075 160.82285 165.32375 169.22705 173.94936 178.60866 183.32196 185.54137 187.49167 191.40034 193.61975 198.87845 201.09785 205.75356 210.46326 214.36296 218.82967 223.60237 227.61008 232.31978 234.53918 238.54689 243.25659 245.17628 249.88599 253.78569 257.20569 261.92438 265.18509 267.40448 269.35117 273.35886 275.57825 280.35095 284.35864 289.06833 293.72403 295.94342 299.96011">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-223.99005" x="58.620651 60.730251 65.46785 67.687256 72.478859 77.15976 84.120361 86.339767 90.258369 94.93927 99.613869 104.29477 107.14237 111.10418 115.83278 120.50738 127.40768 132.14798 136.89008 140.24979 142.46918 147.14378 151.82469 155.85129 159.76988 163.04948 164.97099 169.6456 173.0332 177.7708 181.0504 183.26979 185.1913 189.21339 191.43279 196.22438 200.90527 204.29288 206.51227 211.13197 214.43408 219.11499 223.13708 227.81799 232.62039 236.008 237.8476">IF new code-segment descriptor is not present, </tspan><tspan y="-211.99036" x="76.680954 81.899155 87.72036 92.430061 98.264763 100.48417 106.23787 112.11847 117.22417 119.80087 124.50156 127.80367 131.05536 135.76506 139.01675 143.55545 147.44615 152.15585 156.80255 161.54285 164.11955 168.88326 173.62355 180.58414 182.80354 186.69424 191.40395 196.05064 200.75134 203.57104 207.60124 212.33344 216.95314 223.91734 228.59824 233.39343 236.75314 238.97253 243.00273 247.68362 249.62582 254.30673 258.22894 261.58865 266.32986 269.57166 271.41486 276.63486 278.47806 283.15897 288.83618 293.99496 296.60315 299.21136 301.09958 303.31897 308.06018 310.17337">THEN #NP(error_code(new code-segment selector,0,EXT)); FI;</tspan><tspan y="-199.99066" x="76.680954 79.319756 83.341858 85.561256 87.511559 92.17086 95.543159 97.762558 102.48486 107.14416 111.85746 115.12176 119.59206 124.36835 129.02765 131.24706 134.61935 139.34166 141.56107 146.27437 149.53867 152.84076 157.52167 160.82376 165.32466 169.22797 173.95027 178.60957 183.32288 185.54228 187.49258 191.40126 193.62067 198.87936 201.09877 205.75447 210.46417 214.36388 218.83058 223.60329 227.61099 232.32069 234.5401 238.54781 243.25751 245.1772 249.8869 253.78661 257.2066 261.92529 265.186 267.4054 269.35208 273.35977 275.57916 280.35187 284.35956 289.06924 293.72495 295.94434 299.96103">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-187.99097" x="58.621567 60.728466 65.463364 67.68277 72.471672 77.152573 84.110474 86.32988 90.245781 94.926682 99.598579 104.27948 106.49889 110.52279 115.24869 119.86839 126.82899 131.50989 136.31229 139.69719 141.91658 143.87949 147.84128 150.06067 154.84956 159.58446 164.32655 167.14714 171.06303 175.79793 180.58682 183.88623 188.62112 191.86293 198.82083 200.74234 205.53123 210.15094 212.37033 219.32823 221.29114 224.67604 229.41814 231.63753 237.18243 242.31334 246.75215 248.97154 254.01244 256.23184 260.91275 266.07425">IF new code segment is non-conforming with DPL &lt; CPL</tspan><tspan y="-175.99127" x="76.68187 81.891068 87.712265 92.462463 98.283661">THEN </tspan><tspan y="-163.99158" x="94.68187 96.791473 101.52908 103.74848 109.44008">IF VM</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-163.98" x="115.92"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-163.98" x="118.62 123.7815 126.0009">= 0</tspan><tspan y="-151.9803" x="112.68 117.8892 123.7104 128.4606 134.2818">THEN </tspan><tspan y="-139.98061" x="130.67999 135.93599 141.69418 146.86018 152.57518 154.79459 156.87358 162.75418 167.92018 172.62718 178.03618 180.85318 185.95618 191.41557 193.49457 199.15556 201.23456 205.68056 210.38756 215.64355 220.35056 223.23146 227.67746 232.38446 238.08595 242.82715 247.27315 250.09015 252.16914 258.00116 263.21936 267.90027 273.35968 278.75967 284.42969 289.53268 294.69867 296.55267">GOTO INTER-PRIVILEGE-LEVEL-INTERRUPT; </tspan><tspan y="-127.9809" x="130.67999 133.2549 137.2608 139.48111 144.58501 149.29291 151.51321 156.67471 158.89502 164.14291 166.00142 168.22173 173.88362 182.70363 187.80753 190.02783 195.27573 197.08563 199.30594 201.24184 206.00374 209.36163 214.06053 217.31042 220.61252 225.37442 230.01932 233.37721 235.59752 240.30542 243.60751 245.82782 249.18571 252.42029 256.9068 261.52652 263.74594 268.42145 272.86115 276.24963 280.93051 282.77103 284.99045 289.73254 294.47372 299.21582 303.11551 307.854 312.5961 315.94861 320.6871 323.96759 330.92908 332.85056 337.65295 342.27267 344.4921 348.41159 353.15009 357.82559 362.50647 364.72589 368.75339 373.43427 378.10977 385.07126 389.75214 394.55453 397.94302">(* PE = 1, VM= 0, interrupt or trap gate, nonconforming code segment,</tspan><tspan y="-115.9812" x="130.67999 136.20419 141.31439 145.76759 147.987 153.0072 155.22661 159.94081 165.05101 169.50421 171.72362 175.73582">DPL &lt; CPL *)</tspan><tspan y="-103.9815" x="112.67999 117.40409 121.86719 126.64529 131.36938 133.58879 136.17989 140.20198 142.42139 148.09949 154.67758 156.89699">ELSE (* VM =</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-103.98" x="161.94"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-103.98" x="164.64 169.9122 172.13159 176.16179">1 *)</tspan><tspan y="-91.980301" x="130.6803 132.7386 137.4798 139.69919 144.50159 149.1825 156.1431 158.36249 162.26218 166.94307 171.62218 176.30309 179.18398 183.14577 187.88608 192.56519 199.47449 204.2148 208.95509 212.2914 214.51079 220.08899 225.1902 229.61549">IF new code-segment DPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-91.980003" x="231.84">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-91.980003" x="237.89986"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-91.980003" x="240.60001 245.82001">0 </tspan><tspan y="-79.980301" x="148.6803 153.8391 159.66029 164.39699 170.21819 172.43758 178.21828 183.50398 188.60519 191.18459 195.91229 199.1541 202.4328 207.11369 210.3924 214.8933 218.81099 223.54768 228.22139 232.9023 235.48169 240.28409 244.965 251.9256 254.14499 258.06268 262.79938 267.4191 272.15939 274.98001 279.00211 283.68298 288.36209 295.26239 300.00269 304.74478 308.16476 310.38419 314.34598 319.08627 321.02399 325.75168 329.66937 333.02905 337.70996 341.01205 342.81116 348.09146 349.89056 354.63174 360.27295 365.43176 368.01117 370.64996">THEN #GP(error_code(new code-segment selector,0,EXT));</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="376.84644pt" height="644.646pt" viewBox="0 0 376.84644 644.646" sodipodi:docname="615.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="345.83726" inkscape:cy="423.77086" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg202" /><g transform="translate(-46.622055,-69.182129)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="149.52 152.1588 156.18089 158.4003 160.3506 165.0099 168.3822 170.60161 175.32391 179.98322 184.69652 187.96082 192.43112 197.20743 201.86673 204.08614 207.45844 212.18074 214.40015 219.11345 222.37775 225.67984 230.36075 233.66284 238.16374 242.06705 246.78935 251.44865 256.16196 258.38138 260.33167 264.2403 266.45969 271.71838 273.93777 278.59348 283.30316 287.20285 291.66956 296.44226 300.44995 305.15964 307.37903 311.38672 316.09641 318.01611 322.7258 326.62549 330.0455 334.76419 338.0249 340.24429 342.19098 346.19867 348.41806 353.19077 357.19846 361.90814 366.56384 368.78323 372.79993">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-703.98029" x="131.51999 136.77779 142.53598 147.70378 153.42058 155.63998 157.72078 163.60138 168.76918 173.47798 178.88878 184.29958 189.97137 195.07617 200.24397 203.12488 207.80579 213.26518 218.96307 225.52588 228.40678 234.06958 236.15038 241.56117 246.77937 252.45117 258.09058 262.53839 265.35718 270.60599 275.8548 281.10361 286.35242 289.1712 295.73401 301.49222 307.01102 311.71982 313.57562 315.79501 320.50381 322.58463">GOTO INTERRUPT-FROM-VIRTUAL-8086-MODE; FI;</tspan><tspan y="-691.98059" x="131.51999 134.15878 138.18088 140.40028 145.50148">(* PE</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-691.97998" x="150.17999"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-691.97998" x="152.94 158.043 160.26241 165.5094 167.31841 169.53781 171.47281 176.27521 179.6322 184.3725 187.62149 190.87048 195.67288 200.31688 203.67387 205.89328 210.60028 213.90237 216.12178 219.47878 222.72777 227.22687 231.84656 234.06596 238.70996 243.16496 246.58496 251.26585 253.07486 255.29427 260.87247 265.97366 270.41968 272.63907 277.65207 279.87146 284.57846 289.73996 294.18597 295.99496 298.21436 303.91586">= 1, interrupt or trap gate, DPL &lt; CPL, VM</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-691.97998" x="310.44"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-691.97998" x="313.20001 318.29941 320.5188 325.76221 327.9816 331.983">= 1 *)</tspan><tspan y="-679.98029" x="95.519699 100.2546 102.3615">FI;</tspan><tspan y="-667.98059" x="77.519699 82.241997 86.7033 91.479599 96.201897 98.421295 101.0106 105.0309 107.2503 112.3686">ELSE (* PE</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-667.97998" x="117.12"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-667.97998" x="119.82 124.9248 127.1442 132.39301 134.20381 136.42322 138.40501 143.14711 146.50591 151.2462 154.49699 157.74779 162.55019 167.19598 170.55478 172.77419 177.48299 180.78508 183.00449 186.36328 189.61407 194.11317 198.73288 200.95229 205.59808 210.05489 213.47488 218.15578 220.01428 222.23369 227.75249 232.85728 237.30508">= 1, interrupt or trap gate, DPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-667.97998" x="239.52">≥</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-667.97998" x="244.44031 246.6597 251.39369 256.52368 260.99667 263.21606 267.24808"> CPL *)</tspan><tspan y="-655.98029" x="95.52002 97.616119 102.34022 104.55962 110.23772 116.81582 119.03522 124.15532 126.37472 131.63882">IF VM = 1 </tspan><tspan y="-643.98059" x="113.52002 118.72112 124.54233 129.28442 135.10562 137.32501 143.11111 148.40222 153.50343 156.08284 160.81593 164.05774 167.34184 172.02274 175.30684 179.80774 183.73083 188.47293 193.15204 197.83293 200.41234 205.21474 209.89563 216.85623 219.07562 222.99872 227.74081 232.36052 237.06032 239.87372 243.86612 248.56052 253.20091 260.12732 264.86761 269.625 273.04498 275.26437 279.25677 283.99707 285.90146 290.59586 294.48026 297.90024 302.60364 305.90573 307.71112 312.95453 314.75992 319.46332 325.10272 330.26514 332.83554 335.47433">THEN #GP(error_code(new code-segment selector,0,EXT));</tspan><tspan y="-631.9809" x="113.52002 116.13092 120.17282 122.39222 124.31372 128.99281 132.38672 134.60611 139.287 143.96609 148.70099 151.94279 156.38249 161.18489 165.80458 168.02397 171.41788 176.09877 178.31816 183.05305 186.29486 189.58076 194.26166 197.54756 202.04846 205.97336 210.71725 215.39815 220.07904 222.29843 224.27032 228.24033 230.45973 235.72023 237.93964 242.59714 247.30864 251.21014 255.67865 260.45316 264.46265 269.17413 271.39352 275.40302 280.1145 282.03601 286.7475 290.64899 294.0195 298.73999 302.0025 304.22189 306.17038 310.17987 312.39926 317.17377 321.18326 325.89474 330.55225 332.77164 336.79013">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-619.9812" x="95.52002 97.624222 102.35642 104.57582 109.36202 114.04292 120.99812 123.21752 127.13072 131.81161 136.48082 141.16173 143.38112 147.40231 152.12552 156.74522 163.70583 168.38673 173.18913 176.57133 178.79073 180.75093 184.71272 186.93211 190.84531 195.57751 200.36371 203.66312 208.39532 211.63713 218.59233 220.51384 225.30003 229.96924 232.18863 236.86954 240.17163 242.39102 247.13312 251.87343 258.77371 260.9931 264.90631 269.63852 274.25821 278.9985 281.8407 285.86191 290.54282 295.22189 302.17709 306.858 311.6442 315.0264 317.24579 322.78799 327.9162">IF new code segment is conforming or new code-segment DPL</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-619.97998" x="332.39999"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-619.97998" x="335.10001 340.21021 342.4296 347.1438 352.254">= CPL</tspan><tspan y="-607.98029" x="113.52 118.7292 124.5504 129.3006 135.1218">THEN </tspan><tspan y="-595.98059" x="131.52 136.7805 142.5387 147.7092 153.4287 155.6481 157.7316 163.6122 168.7827 174.1962 179.8356 182.6562 187.7637 193.1772 195.2607 200.96219 203.04568 207.49619 212.20769 217.46819 222.17969 225.00119 229.45169 234.16319 239.86469 244.54559 249.04469 251.8653 253.94879 259.78528 264.95578 269.66727 275.08078 280.54019 286.21469 291.37619 296.54669 298.40518">GOTO INTRA-PRIVILEGE-LEVEL-INTERRUPT; </tspan><tspan y="-583.9809" x="113.52 118.2423 122.70361 127.4799 132.20221 134.42162 137.01091 141.0312 143.25061 148.36891">ELSE (* PE</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-583.97998" x="153.12"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-583.97998" x="155.82001 160.92931 163.14871 168.40201 170.21732 172.43672 174.37802 179.14532 182.50862 187.21292 190.46822 193.77031 198.53761 203.18791 206.55121 208.77061 213.48392 216.78601 219.00542 222.36871 225.62401 230.08531 234.73561 236.95502 241.60532 246.06662 249.48662 254.16751 256.02603 258.24542 263.01273 267.72601 272.49332 276.3876 281.10089 285.8403 289.1658 293.87729 297.1308 304.06531 306.00482 310.80722 315.45572 317.67511 321.5676 326.27908 330.92758 335.6301 337.84949 341.84998 346.55249 351.20099 358.1355 362.83801 367.64041 371.00192 372.81543 375.03482 380.55634 385.71783 390.16833 392.38773 397.40521 399.6246 404.33609 409.49759 413.94809 416.16748 420.17697">= 1, interrupt or trap gate, nonconforming code segment, DPL &gt; CPL *)</tspan><tspan y="-571.98029" x="131.52 137.28 142.545 147.657 150.29579 155.00279 158.26079 161.51878 166.23479 169.49278 174.03778 177.93478 182.65079 187.30379 192.01079 194.64958 199.39169 204.09869 211.03769 213.2571 217.1541 221.8701 226.5231 231.2301 234.05611 238.08 242.787 247.44 254.379 259.086 263.88928 267.24988 269.46927 273.47427 278.18127 280.09827 284.83948 288.73648 292.10248 296.81848 300.07648 301.89447 307.15048 308.96848 313.68448 319.33649 324.55557 327.13858 329.72159">#GP(error_code(new code-segment selector,0,EXT));</tspan><tspan y="-559.98059" x="131.52 134.1588 138.18089 140.4003 142.3506 147.0099 150.3822 152.60161 157.32391 161.98322 166.69652 169.96082 174.43112 179.20743 183.86673 186.08614 189.45844 194.18074 196.40015 201.11345 204.37775 207.67984 212.36075 215.66284 220.16374 224.06705 228.78935 233.44865 238.16196 240.38136 242.33167 246.24031 248.45972 253.71841 255.93782 260.59351 265.30319 269.20288 273.66959 278.44229 282.44998 287.15967 289.37906 293.38675 298.09644 300.01614 304.72583 308.62552 312.04553 316.76422 320.02493 322.24432 324.19101 328.1987 330.41809 335.1908 339.19849 343.90817 348.56387 350.78326 354.79996">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-547.9809" x="95.520004 100.25491 102.36181">FI;</tspan><tspan y="-535.9812" x="59.520004 64.254906 66.361809">FI;</tspan><tspan y="-523.98151" x="46.020004 50.714405 56.595005 62.099403">END;</tspan><tspan y="-511.98181" x="46.020004 48.102604 53.938202 59.107803 63.818405 69.231003 72.051605 77.213104 82.613098 84.695702 90.360306 92.442909 96.942009 101.65261 106.91221 111.62281 114.44341 118.89301 123.60361 129.26822 133.97882 138.42842 141.30933 143.39192 149.27252 154.44212 159.15273 164.56532 169.97792 175.65152 180.75812 185.97632">INTER-PRIVILEGE-LEVEL-INTERRUPT:</tspan><tspan y="-499.98212" x="59.520004 62.126404 66.088203 68.30761 73.443008 78.123909 80.343315 85.478714 87.698112 92.918114 94.776611 96.99601 98.917511 103.71992 107.10931 111.79021 115.07162 118.31342 123.10683 127.72652 131.11592 133.33531 138.07471 141.31651 143.5359 146.92531 150.16711 154.60681 159.28592 161.50531 166.18172 170.62141 174.01082 178.74123 180.54033 182.75972 187.55312 192.23401 197.0274 199.8768 203.7972 208.53659 213.27869 216.63748 221.31837 224.62048 231.58289 233.50439 238.29779 242.9175 245.13689 249.05728 253.79668 258.41638 263.15668 265.37607 269.40448 274.08539 278.76178 285.66208 290.39249 295.13458 298.52399 300.32309 302.54248 308.09189 313.22729 317.70569 319.92508 324.90479 327.12418 331.86359 336.99899 341.47739 343.69678 347.73419">(* PE = 1, interrupt or trap gate, non-conforming code segment, DPL &lt; CPL *)</tspan><tspan y="-487.98242" x="59.520004 61.618805 66.345604 68.565002 71.158806 73.257607 78.866409 84.133209 89.400009 93.900909 98.627708 103.35451 108.03541 113.46421 115.17601 119.64181 126.22261 131.83141 134.05081 139.17361 141.39301 146.65981 149.2536 151.47299 154.06679 158.09158 160.31097 166.16278 170.84369 174.22049 176.43988 178.53868 184.14748 186.98428 192.25108 197.47108 202.2114 204.43079 211.33109 216.0723 220.7361 225.41701 227.63641 231.66121">IF (IA32_EFER.LMA = 0) (* Not IA-32e mode *)</tspan><tspan y="-475.98273" x="77.520004 82.729202 88.5504 93.300598">THEN</tspan><tspan y="-463.98303" x="77.520004 80.158806 84.180908 86.400307 88.474808 93.153908 97.847412 102.64981 106.00231 107.98412 111.30061 115.95811 118.17751 122.16901 125.52151 130.02061 133.92032 138.18182 140.99432 144.98582 149.67932 154.35841 161.31902 166.01251 170.81491 174.1674 176.38681 180.37831 185.07181 186.97531 191.71561 195.59911 198.9516 203.69279 206.9346 209.15401 212.5128 217.1937 220.4958 222.71521 227.47171 232.21201 239.13751 241.35692 246.03601 249.27782 251.25961 255.87842 257.80893 259.78983 264.48334 269.16245 273.85596 276.07535 277.97885 282.71918 287.34067 292.03418 294.01508 296.23447 298.16498 302.96738 305.18677 309.07028 313.82678 317.07129 320.37338 325.06689 329.86929 333.2218 335.44119 340.60269 345.40509 350.16159 352.38098 356.38147">(* Identify stack-segment selector for new privilege level in current TSS *)</tspan><tspan y="-451.98334" x="95.520004 97.605301 102.3186 104.53801 108.43231 113.23472 116.49002 119.74532 124.48563 129.25293 132.61623 134.83563 140.05383 144.79593 149.59833 151.81773 153.75903 157.76134 159.98074 165.23404 170.48734 173.36824 177.98795 179.96974">IF current TSS is 32-bit</tspan><tspan y="-439.98364" x="113.52 118.7292 124.5504 129.3006 135.1218">THEN </tspan><tspan y="-427.98395" x="131.52 136.70041 141.47581 146.25122 150.26163 153.63303 158.10243 162.00484 166.28523 171.88863 176.54703 181.20543 184.46883 189.18123 193.19164 197.20204 199.42145 201.17285 206.29025 208.50966 211.09805 215.87346 220.58586 227.53026 229.74966 233.65207 238.32031 242.98141 247.69652 250.53062 254.54373 259.22461 263.90372 270.80402 275.54431 280.28641 283.64612 285.86554 291.39963 296.51971 300.98282 303.20224 308.61035 310.82977 316.09387 318.68497 320.90439 326.07849 328.29791 333.56201">TSSstackAddress := (new code-segment DPL « 3) + 4;</tspan><tspan y="-415.98425" x="131.52002 133.61432 138.33662 140.55603 143.14532 148.32663 153.10294 157.87924 161.89055 165.26285 169.73315 173.63646 177.91776 183.52205 188.14175 192.82086 196.08516 200.79846 204.76027 208.78238 211.00179 216.17409 218.39972 223.67282 226.27292 228.49231 233.5314 235.75079 239.66489 244.40698 247.68208 250.95718 255.68129 260.42337 263.80646 266.02588 271.21799 275.96008 280.74719 282.96661 284.90073 286.8222 293.77829 295.69977">IF (TSSstackAddress + 5) &gt; current TSS limit</tspan><tspan y="-403.98456" x="149.52002 154.73822 160.55942 165.27182 171.10922 173.32863 179.08502 184.25642 189.05882 191.63823 196.37852 199.63292 202.88731 207.59972 210.85411 215.39551 219.28891 224.00131 228.65071 233.39101 235.97041 239.86382 244.66621 247.92061 251.175 255.9153 260.6817 264.10168 266.32108 271.49246 276.25885 281.06125 283.28064 287.28204 291.98544 293.89883 298.63913 302.53253 305.89493 310.60733 313.86172 315.67612 320.92853 322.74292 327.45532 333.10373 338.32193 340.90134 343.48074 345.34015 347.55954 352.27194 354.35635">THEN #TS(error_code(current TSS selector,0,EXT)); FI;</tspan><tspan y="-391.98486" x="149.52002 152.15881 156.18091 158.40031 160.35062 165.00992 168.38222 170.60162 175.32393 179.98323 184.69653 187.96083 192.43114 197.20744 201.86674 204.08615 207.45845 212.18076 214.40016 219.11346 222.37776 225.67986 230.36076 233.66286 238.16376 242.06706 246.78937 251.44867 256.16196 258.38138 260.33167 264.24033 266.45972 271.71841 273.93781 278.59351 283.30319 287.20288 291.66959 296.44229 300.44998 305.15967 307.37906 311.38675 316.09644 318.01614 322.72583 326.62552 330.04553 334.76422 338.02493 340.24432 342.19101 346.1987 348.41809 353.1908 357.19849 361.90817 366.56387 368.78326 372.79996">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-379.98517" x="131.52002 137.36732 142.08063 149.02592 153.80223 158.57854 160.79794 162.55025 167.66855 169.88795 175.15025 177.36966 182.02896 186.70627 190.07857 194.79187 198.80318 201.02258 202.94588 207.66818 212.13849 216.79779 221.51109 226.17039 228.3898 231.7261 234.9904 239.71271 246.658 248.87741 251.46671 256.62003 261.37833 266.18073 268.40012 273.04141 277.54053 281.53381 286.27414 288.49353 293.64783 295.86722 301.03052 305.83292 310.59122 314.5845 317.93881 322.43793 326.32324 330.58655 336.22595 340.84564 345.52475 348.76657 353.5069 357.46869 361.46198 363.68137 368.83566 371.05505 376.33536 378.91473">NewSS := 2 bytes loaded from (TSS base + TSSstackAddress + 4);</tspan><tspan y="-367.98547" x="131.52002 137.36372 142.07343 149.01512 153.73383 158.50653 163.62123 165.84064 167.64244 172.74364 174.96304 180.22174 182.44115 187.09685 191.77055 195.13925 199.84895 203.81076 206.03017 207.94986 212.66856 217.13527 221.79097 226.50067 231.15637 233.37578 236.70848 239.96918 244.68788 251.62958 253.85971 256.44812 261.62851 266.4039 271.17929 273.39868 278.05707 282.52646 286.53687 291.24927 293.46866 298.64005 300.85944 306.03983 310.81522 315.59061 319.60101 322.97241 327.4418 331.34421 335.6246 341.228 345.84769 350.50607 353.76947 358.48187 362.49228 366.50269 369.09109">NewESP := 4 bytes loaded from (TSS base + TSSstackAddress);</tspan><tspan y="-355.98578" x="113.52002 118.22882 122.67662 127.47902 149.50021 152.13902 156.16113 158.38054 162.27034 167.03314 170.28394 173.58603 178.28583 183.08823 186.44702 188.66643 193.83423 198.63663 203.39943 205.61884 207.60063 211.62274 213.84215 219.09094 224.33974 227.15854 231.80434 233.74113 237.09993 239.31934 243.32614">ELSE(* current TSS is 16-bit *)</tspan><tspan y="-343.98608" x="131.52002 136.70042 141.47583 146.25124 150.26164 153.63304 158.10245 162.00485 166.28525 171.88864 176.54704 181.20544 184.46884 189.18124 193.19165 197.20206 199.42146 201.17287 206.29027 208.50967 211.09807 215.87347 220.58588 227.53027 229.74968 233.65208 238.32031 242.97871 247.69112 250.52252 254.53293 259.21384 263.89291 270.79321 275.53351 280.2756 283.63531 285.85471 291.38611 296.50351 300.9639 303.18329 308.58868 310.80807 316.06949 318.6579 320.87729 326.04868 328.26807">TSSstackAddress := (new code-segment DPL « 2) + 2</tspan><tspan y="-331.98639" x="131.52002 133.61342 138.33482 140.55333 143.14172 148.32213 153.09753 157.87294 161.88335 165.25475 169.72415 173.62656 177.90695 183.51035 188.12915 192.80736 196.07076 200.78316 204.74406 208.76527 210.98378 216.15518 218.39972 223.67282 226.27292 228.49231 233.5314 235.75079 239.66489 244.40698 247.68208 250.95718 255.68129 260.42337 263.80646 266.02588 271.21799 275.96008 280.74719 282.96661 284.90073 286.8222 293.77829 295.69977">IF (TSSstackAddress + 3) &gt; current TSS limit</tspan><tspan y="-319.98669" x="149.52002 154.73822 160.55942 165.27182 171.10922 173.32863 179.08502 184.25642 189.05882 191.63823 196.37852 199.63292 202.88731 207.59972 210.85411 215.39551 219.28891 224.00131 228.65071 233.39101 235.97041 239.86382 244.66621 247.92061 251.175 255.9153 260.6817 264.10168 266.32108 271.49246 276.25885 281.06125 283.28064 287.28204 291.98544 293.89883 298.63913 302.53253 305.89493 310.60733 313.86172 315.67612 320.92853 322.74292 327.45532 333.10373 338.32193 340.90134 343.48074 345.34015 347.55954 352.27194 354.35635">THEN #TS(error_code(current TSS selector,0,EXT)); FI;</tspan><tspan y="-307.987" x="149.52002 152.15881 156.18091 158.40031 160.35062 165.00992 168.38222 170.60162 175.32393 179.98323 184.69653 187.96083 192.43114 197.20744 201.86674 204.08615 207.45845 212.18076 214.40016 219.11346 222.37776 225.67986 230.36076 233.66286 238.16376 242.06706 246.78937 251.44867 256.16196 258.38138 260.33167 264.24033 266.45972 271.71841 273.93781 278.59351 283.30319 287.20288 291.66959 296.44229 300.44998 305.15967 307.37906 311.38675 316.09644 318.01614 322.72583 326.62552 330.04553 334.76422 338.02493 340.24432 342.19101 346.1987 348.41809 353.1908 357.19849 361.90817 366.56387 368.78326 372.79996">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-295.9873" x="131.52002 137.36732 142.08063 149.02592 153.80223 158.57854 160.79794 162.55025 167.66855 169.88795 175.15025 177.36966 182.02896 186.70627 190.07857 194.79187 198.80318 201.02258 202.94588 207.66818 212.13849 216.79779 221.51109 226.17039 228.3898 231.7261 234.9904 239.71271 246.658 248.87741 251.46671 256.62003 261.37833 266.18073 268.40012 273.04141 277.54053 281.53381 286.27414 288.49353 293.64783 295.86722 301.03052 305.83292 310.59122 314.5845 317.93881 322.43793 326.32324 330.58655 336.22595 340.84564 345.52475 348.76657 353.5069 357.46869 361.46198 363.68137 368.83566 371.05505 376.33536 378.91473">NewSS := 2 bytes loaded from (TSS base + TSSstackAddress + 2);</tspan><tspan y="-283.98761" x="131.52002 137.36372 142.07343 149.01512 153.73383 158.50653 163.62123 165.84064 167.64244 172.74364 174.96304 180.22174 182.44115 187.09685 191.77055 195.13925 199.84895 203.81076 206.03017 207.94986 212.66856 217.13527 221.79097 226.50067 231.15637 233.37578 236.70848 239.96918 244.68788 251.62958 253.85971 256.44812 261.62851 266.4039 271.17929 273.39868 278.05707 282.52646 286.53687 291.24927 293.46866 298.64005 300.85944 306.03983 310.81522 315.59061 319.60101 322.97241 327.4418 331.34421 335.6246 341.228 345.84769 350.50607 353.76947 358.48187 362.49228 366.50269 369.09109">NewESP := 2 bytes loaded from (TSS base + TSSstackAddress);</tspan><tspan y="-271.98792" x="95.52002 100.25492 102.36182">FI;</tspan><tspan y="-259.98822" x="95.52002 97.602623 102.31322 104.53263 110.36823 115.10853 122.04213 126.84454 131.64693 133.86633 135.80493 139.80453 142.02394 147.85954 153.53314 157.98274">IF NewSS is NULL</tspan><tspan y="-247.98853" x="113.52002 118.70402 124.55402 129.27902 135.12903 137.34843 143.11743 148.30144 153.08044 155.67244 160.39745 166.05844 171.24245 173.83444 175.70644 177.92584 182.60675 184.70735 186.57935">THEN #TS(EXT); FI; </tspan><tspan y="-235.98883" x="95.52002 97.59362 102.33482 104.55421 110.38081 115.12111 122.04571 126.84811 131.6505 133.8699 135.7995 140.6019 145.24049 149.98079 154.74539 156.9648 158.94659 162.96869 165.1881 169.9437 174.68489 178.03648 180.25589 187.1805 189.11009 192.46169 197.26408 199.19368 203.99608 206.21548 208.14508 211.56508 215.55568 217.77509 222.45418 227.19447 231.18507 235.06767 238.36978 240.29128 244.97037 248.33006 253.07126 256.31305 259.12466 262.47626 266.97534 271.59506 273.49765 278.23795 280.45734 282.35992 284.34171 291.2663 293.24808 296.59967">IF NewSS index is not within its descriptor-table limits</tspan><tspan y="-223.98914" x="95.52002 100.25132 103.52462 105.74402 111.60032 116.28122 123.23552 127.97762 132.76291 134.9823 140.4156 145.54291 150.01321">or NewSS RPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-223.98" x="152.22">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-223.98" x="158.21947"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-223.98" x="160.98 165.7383 170.47859 177.4059 179.62531 183.5106 188.2518 192.93089 197.61179 200.42609 204.41939 209.15968 213.77937 220.73997 225.42087 230.22327 233.58296 235.80237 241.31667 246.41696 250.91606">new code-segment DPL </tspan><tspan y="-211.9803" x="113.52029 118.73849 124.5597 129.27029 135.1059 137.3253 143.0799 148.2495 153.0519 155.6313 160.3716 163.62419 166.87679 171.58739 174.83998 179.37958 183.27118 187.98178 192.62938 197.36967 199.94728 205.78288 210.52318 217.48376 222.24837 227.05077 228.86337 234.11397 235.92657 240.63718 246.28378 251.45338 254.03099 256.60858 258.52829 260.74768 265.45828 267.54089">THEN #TS(error_code(NewSS,0,EXT)); FI;</tspan><tspan y="-199.98061" x="113.52029 116.1312 120.1731 122.39249 124.314 128.99309 132.38699 134.60638 139.28728 143.96637 148.70126 151.94307 156.38277 161.18517 165.80486 168.02425 171.41815 176.09904 178.31844 183.05333 186.29514 189.58104 194.26193 197.54784 202.04874 205.97363 210.71753 215.39842 220.07932 222.29871 224.2706 228.2406 230.46001 235.7205 237.93991 242.59741 247.30891 251.21042 255.67892 260.45343 264.46292 269.17441 271.3938 275.40329 280.11478 282.03629 286.74777 290.64926 294.01978 298.74026 302.00278 304.22217 306.17065 310.18015 312.39954 317.17404 321.18353 325.89502 330.55252 332.77191 336.79041">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-187.98091" x="95.520294 100.9518 105.67229 110.1498 114.7695 116.9889 121.7724 126.4929 133.4454 135.66479 139.68329 143.06279 147.54028 151.45079 155.73929 158.57878 162.59727 167.31778 171.98428 178.88458 183.60509 188.28059 191.70059 193.92 198.56129 203.30159 207.29489 211.18019 214.4265 216.3588 221.00009 224.35439 229.05869 232.30499 234.5244 237.8427 242.547 245.84911 248.06851 253.89781 258.63812 265.56543 270.36783 275.12613 277.34552 279.32733 284.06943 286.28882 291.54211 297.05643 302.27463 304.49402 309.1983 312.5004 314.71979 319.16309 324.6774 329.8407">Read new stack-segment descriptor for NewSS in GDT or LDT;</tspan><tspan y="-175.98122" x="95.520294 97.620895 102.36209 104.58149 109.38389 114.06479 121.02539 123.24479 127.22639 130.64638 135.08698 138.98666 143.23827 146.11916 150.10075 154.84105 159.47064 166.43124 171.17154 175.91364 179.25624 181.47563 186.97823 192.13974 196.57133">IF new stack-segment DPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-175.98" x="198.78">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-175.98" x="204.83986"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-175.98" x="207.53999 212.29829 217.03859 223.9659 226.1853 230.0706 234.8118 239.49089 244.17178 246.98608 250.97939 255.71968 260.33939 267.29999 271.9809 276.78329 280.14301 282.3624 287.87671 292.97702">new code-segment DPL</tspan><tspan y="-163.9803" x="95.519691 100.24739 103.51709 105.73649 110.51819 115.19909 122.14979 124.36919 128.38588 131.76358 136.23927 140.14798 144.43468 147.27238 151.28908 155.96999 160.63469 167.58539 172.2663 177.06871 180.44641 182.6658 187.85251 192.5352 197.19991 201.88081 204.1002 208.76491 213.44582 218.16452 222.18121 224.4006 229.14272 233.88393 237.26163 239.48102 241.40253 246.20494 250.86964 252.79115 256.69986 261.17557 264.55325 269.23413 271.45355 278.40427 281.67398 283.62967 287.00735 291.44705 296.12616 298.05487 302.77356 304.99298 309.61267 314.11179 317.48947 321.92917 324.14859 328.16528 332.84616 337.51086 344.46158 349.14246 353.94485">or new stack-segment Type does not indicate writable data segment</tspan><tspan y="-151.98061" x="113.51969 118.73789 124.5591 129.2697 135.1053 137.32471 143.0793 148.2489 153.0513 155.63071 160.371 163.6236 166.87619 171.58679 174.83939 179.37898 183.27058 187.98119 192.62878 197.36908 199.94669 205.78229 210.52258 217.48317 222.24777 227.05017 228.86278 234.11337 235.92598 240.63658 246.28319 251.45279 254.0304 256.608 258.52771 260.7471 265.4577 267.54031">THEN #TS(error_code(NewSS,0,EXT)); FI;</tspan><tspan y="-139.98091" x="113.51969 116.13059 120.17249 122.39189 124.31339 128.99249 132.3864 134.60579 139.28668 143.96577 148.70067 151.94247 156.38217 161.18457 165.80426 168.02365 171.41756 176.09845 178.31784 183.05273 186.29454 189.58044 194.26134 197.54724 202.04814 205.97304 210.71693 215.39783 220.07872 222.29811 224.27 228.23999 230.4594 235.71989 237.9393 242.5968 247.3083 251.20981 255.67831 260.45282 264.46231 269.1738 271.39319 275.40268 280.11417 282.03568 286.74716 290.64865 294.01917 298.73965 302.00217 304.22156 306.17004 310.17953 312.39893 317.17343 321.18292 325.89441 330.55191 332.7713 336.78979">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-127.98121" x="95.519684 97.625687 102.35969 104.57909 110.40028 115.14058 122.04088 126.82888 131.61688 133.83627 135.75778 139.77988 141.99927 146.74136 151.48256 154.86656 157.08595 161.75696 164.99876 169.72377 173.68556 178.41057 183.19856 186.58257">IF NewSS is not present </tspan><tspan y="-115.98151" x="113.51968 118.72618 124.54738 129.29488 135.11607 137.33548 143.12698 147.92848 152.67058 155.24998 159.98848 163.23029 166.51979 171.20068 174.49019 178.99109 182.91959 187.66708 192.35158 197.03247 199.61188 205.49248 210.17337 217.13397 221.87607 226.67847 228.47757 233.75787 235.55698 240.29817 245.93938 251.09818 253.71268 256.29208 258.15237 260.3718 265.11929 267.16049">THEN #SS(error_code(NewSS,0,EXT)); FI;</tspan><tspan y="-103.9818" x="113.51968 116.13058 120.17249 122.39188 124.31339 128.99248 132.38638 134.60577 139.28667 143.96576 148.70065 151.94246 156.38216 161.18456 165.80424 168.02364 171.41754 176.09843 178.31783 183.05272 186.29453 189.58043 194.26132 197.54723 202.04813 205.97302 210.71692 215.39781 220.0787 222.2981 224.26999 228.23999 230.4594 235.71989 237.9393 242.5968 247.3083 251.20981 255.67831 260.45282 264.46231 269.1738 271.39319 275.40268 280.11417 282.03568 286.74716 290.64865 294.01917 298.73965 302.00217 304.22156 306.17004 310.17953 312.39893 317.17343 321.18292 325.89441 330.55191 332.7713 336.78979">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-91.982101" x="113.51968 119.36968 124.08569 131.03369 135.8127 140.59171 145.71271 147.93211 149.68712 154.80812 157.02753 159.12453 164.73152 169.99652 175.21652 179.77052 184.89153 189.35553 191.30853 195.86253 200.57938 205.36737 210.49738 212.71677 215.31776 219.34976 221.56915 228.52615 233.26825 237.99326 241.23506 245.96007 248.17946 250.10097 252.32036 257.45035 259.66974 264.41183 269.15213 276.05243 278.27182 282.18683 286.92084 291.54053 296.28082 299.12482 303.14783 307.82874 312.50781 319.46481 324.14572 328.93372 332.31772 334.53711 340.08112 345.21112 349.68411 351.9035 355.86533">NewSSP := IA32_PLi_SSP (* where i = new code-segment DPL *)</tspan><tspan y="-79.982399" x="77.519676 82.240173 86.699677 91.474174 96.194672 98.41407 101.00157 105.02007 107.23947 109.33197 114.93447 117.76497 123.02547 128.28596 132.99747 135.21687 142.16037 146.88087 151.53838 156.24988 158.46928 162.48778">ELSE (* IA-32e mode *)</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="364.67578pt" height="642.77783pt" viewBox="0 0 364.67578 642.77783" sodipodi:docname="616.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="329.03768" inkscape:cy="421.49674" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg130" /><g transform="translate(-59.221741,-69.344727)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="94.68 96.770699 101.4894 103.70879 105.79949 111.32819 116.5059 119.33459 123.95429 128.45338 131.82208 136.53178 138.75119 140.84189 145.61459 150.7923 153.0117 158.1264 160.34581">IF IDT-gate IST = 0</tspan><tspan y="-703.98029" x="112.68 117.8739 123.69511 128.43001 134.25121 136.4706 141.62939 146.41829 151.20718 155.16898 158.55388 162.99358 166.90947 171.16917 176.78607 181.40578 186.07768 189.31949 194.04539 198.00719 202.03108 204.25047 206.01537 211.14627 213.36566 215.96756 220.70966 225.43556 232.39346 234.61285 238.52875 243.20964 247.88155 252.56245 255.40735 259.43124 264.15714 268.77686 275.73474 280.41562 285.20453 288.58942 290.80884 296.35373 301.48462 305.92343 308.14285 313.56177 315.78119 321.05609 323.65799 325.87741 331.06232 333.28174 338.50174">THEN TSSstackAddress := (new code-segment DPL « 3) + 4;</tspan><tspan y="-691.98059" x="112.68 117.4086 121.8474 126.63 131.3586 133.57799 138.7368 143.47891 148.26151 152.2791 155.6577 160.0974 164.007 168.2946 173.8746 178.55371 183.17342 186.47551 191.15642 195.17401 199.1916 201.411 203.1696 208.2942 210.5136 213.10919 215.2197 220.7448 225.963 228.1824 232.8345 237.29761 240.6627 245.3688 247.58821 249.67531 254.44441 259.6185 261.83789 267.237 269.45639 274.71149 277.29358 279.51297 284.67807 286.89746 292.15256 297.40765">ELSE TSSstackAddress := (IDT gate IST « 3) + 28;</tspan><tspan y="-679.9809" x="94.679993 99.414894 101.5218">FI;</tspan><tspan y="-667.9812" x="94.679993 96.788696 101.5254 103.7448 106.3485 111.5073 116.298 121.08871 125.05051 128.43721 132.87691 136.7946 141.05431 146.673 151.29271 155.96642 159.20822 163.93593 167.89772 171.92342 174.14281 179.32951 181.5489 186.82561 189.42931 191.6487 196.69139 198.91078 202.82848 207.57057 210.84927 214.09108 218.81879 223.56088 226.94759 229.16698 234.36267 239.10477 243.89546 246.11485 248.05255 249.97406 256.93375 258.89844">IF (TSSstackAddress + 7) &gt; current TSS limit</tspan><tspan y="-655.98151" x="112.67999 117.89819 123.7194 128.42999 134.26559 136.485 142.23959 147.40919 152.21159 154.791 159.5313 162.78389 166.03648 170.74709 173.99968 178.53928 182.43088 187.14148 191.78908 196.52937 199.10698 202.99858 207.80098 211.05357 214.30617 219.04646 223.81107 227.23106 229.45047 234.62007 239.38467 244.18707 246.40648 250.40608 255.10768 257.01929 261.75958 265.65118 269.01178 273.72238 276.97498 278.78757 284.03818 285.85077 290.56137 296.20798 301.42618 304.00378 305.86139 308.08078 312.79138 314.87399">THEN #TS(error_code(current TSS selector,0,EXT); FI;</tspan><tspan y="-643.98181" x="112.67999 115.28459 119.32019 121.5396 123.4611 128.1402 131.5278 133.74719 138.48479 143.10449 147.8331 151.07491 155.5146 160.317 164.99161 167.211 170.5986 175.2795 177.49889 182.22749 185.4693 188.7489 193.42979 196.7094 201.2103 205.12889 209.86649 214.54109 219.222 221.44139 223.407 227.36879 229.58818 234.86578 237.08517 241.75978 246.44069 250.35928 254.84488 259.58698 263.6091 268.33771 270.5571 274.51892 279.25922 281.19781 285.87872 289.79733 293.18494 297.86584 301.16794 303.38733 305.30884 309.33096 311.55035 316.29245 320.31458 325.04318 329.66287 331.88226 335.91788">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-631.98212" x="94.679993 100.52549 105.23699 112.18049 117.60299 122.37749 127.49399 129.71339 131.4639 136.5804 138.7998 144.0603 146.27971 150.93721 155.61272 158.98322 163.69472 167.70422 169.92363 171.84512 176.56563 181.03413 185.69164 190.40314 195.06064 197.28004 200.61455 203.87704 208.59755 215.54105 217.76045 220.34795 224.24945 229.02396 232.2603 235.521 240.2307 245.0034 248.3721 250.59151 255.76921 260.5419 265.31461 267.534 272.1897 276.6564 280.66409 285.37378 287.59317 292.76187 294.98126 300.15897 304.93167 309.70438 313.71207 317.08078 321.54749 325.44717 329.72488 335.32559 339.98129 344.60098 347.90311 352.61279 356.62048 360.62817 363.21387">NewRSP := 8 bytes loaded from (current TSS base + TSSstackAddress);</tspan><tspan y="-619.98242" x="94.679993 100.52909 105.20999 112.15709 116.93519 121.67728 123.89668 125.65078 130.77087 132.99028 137.73239 142.4727 149.373 151.59241 155.49751 160.22162 164.84132 169.58163 172.41574 176.42885 181.10976 185.78886 192.73596 197.41687 202.19498 205.56908 207.78848 213.32259 218.44269 222.90579 224.77689 226.99629 229.58739 233.60948 235.82889 241.67799 247.3651 251.8282 256.29129 258.51071 262.5238 267.23889 269.164 273.84488 277.74997 281.12408 285.84818 289.11429 291.33371 298.28082 300.23291 303.60703 308.34912 310.56854 315.99463 321.11472 325.57782 327.79724 332.91733 335.13675 339.91486 344.59573 351.54285 353.76227 358.48636 363.60645 368.06955 370.28897 374.31107">NewSS := new code-segment DPL; (* NULL selector with RPL = new CPL *)</tspan><tspan y="-607.98273" x="94.679993 96.770691 101.4894 103.70879 105.79949 111.32819 116.5059 119.33459 123.95429 128.45338 131.82208 136.53178 138.75119 140.84189 145.61459 150.7923 153.0117 158.1264 160.34581">IF IDT-gate IST = 0</tspan><tspan y="-595.98303" x="112.67999 117.88919 123.71039 128.46059">THEN</tspan><tspan y="-583.98334" x="130.67999 136.50119 141.1821 148.14 152.92889 157.67099 162.7722 164.99159 166.75648 171.88739 174.10678 176.21368 181.79369 187.06859 192.28859 196.85249 201.9834 206.45731 208.37881 212.94272 217.68481 222.47371 227.60461 229.82401 232.4259 236.4588 238.67819 245.63609 250.37819 255.1041 258.34589 263.07178 265.2912 267.21268 269.4321 274.56299 276.78241 281.52451 286.2648 293.1651 295.38452 299.30042 304.03531 308.70721 313.38809 316.233 320.2569 324.98279 329.60251 336.56039 341.24127 346.03018 349.41507 351.63449 357.17938 362.31027 366.78418 369.0036 373.0365">NewSSP := IA32_PLi_SSP (* where i = new code-segment DPL *)</tspan><tspan y="-571.98364" x="112.67999 117.41489 121.88879 126.6777">ELSE</tspan><tspan y="-559.98395" x="130.67999 136.50839 141.20279 148.1292 152.93159 157.689 162.78839 168.4278 173.04749 177.72658 180.96838 185.70868 189.73077 193.72318 195.94258 201.10408 203.32349 205.39888 211.03828 216.28168 221.52509 226.05748 228.13287 233.96127 239.12367 243.82707 249.23247 254.69186 260.33307 265.49457 270.65338 275.18579 279.94318 284.74557 289.86029 294.39899 299.56769 305.15939 310.4631 314.9118 319.62149 324.16019 329.75189 335.27161 340.79132 346.25073 348.47012 353.62982 355.84921 358.4259 360.5076 366.02731 371.19601 374.01572 378.66241 383.12012 386.54013 391.24084 393.46024 395.54193 400.30563 405.52383 407.74323 413.13693 415.35632 420.60602">NewSSPAddress = IA32_INTERRUPT_SSP_TABLE_ADDR + (IDT-gate IST « 3)</tspan><tspan y="-547.98425" x="130.67998 133.28188 137.31477 139.53416 144.21506 149.01746 153.69836 157.59805 161.89195 164.11134 166.03285 169.39166 171.61105 175.57285 180.37524 184.81494 189.49405 194.22894 201.12924 203.34863 207.37253 210.75743 215.24033 219.15622 223.41592 227.43802 229.65741 234.09711 237.39922 242.08012 244.29951 249.02542 253.76752 258.25043 262.87015 264.80606 269.53195 274.15167 276.37109 280.854 284.23889 286.45831 291.19321 296.2944 300.73322 302.95264 308.22754 310.44696 314.47986">(* Check if shadow stacks are enabled at CPL 0 *)</tspan><tspan y="-535.98456" x="130.67998 132.72118 137.46237 139.68176 144.47336 149.21545 153.70105 158.32076 163.05835 169.95865 174.75024 178.13785 182.62344 186.54204 190.80174 195.54294 200.28503 204.78413 209.40384 211.32533 216.05394 220.67365 223.27824 228.01584 233.14944 237.62604 239.84543 245.06543">IF ShadowStackEnabled(CPL 0)</tspan><tspan y="-523.98486" x="148.67998 153.85768 159.70139 164.42009 170.26379 172.4832 178.3269 183.03661 189.9783 194.75101 199.52371 204.63841 206.85782 208.60652 213.72122 215.94063 221.19933 223.41873 228.07443 232.74814 236.11684 240.82654 244.83424 247.05365 248.97334 253.69205 258.15875 262.79999 267.49078 272.16989 274.38931 277.70312 281.00522 285.70502 292.66562 294.88504 300.70984 305.45013 312.41074 317.15286 321.95529 327.05649 332.63828 337.31738 341.95419 345.25629 349.94708 353.93588 357.92468 359.77148 361.99091 366.73212 368.83273">THEN NewSSP := 8 bytes loaded from NewSSPAddress; FI;</tspan><tspan y="-511.98517" x="94.679993 99.414894 101.5218">FI;</tspan><tspan y="-499.98547" x="58.619694 63.354595 65.461494">FI;</tspan><tspan y="-487.98578" x="58.619694 60.715794 65.439896 67.659294 69.755394 75.289497 80.472595 82.691994 87.353096 91.825195 95.199295 99.914398 102.1338 104.0859 108.0477 110.2671 115.5312 120.7953 123.62939 128.2491 130.2309 133.605">IF IDT gate is 32-bit </tspan><tspan y="-475.98608" x="94.679993 99.889191 105.71039 110.46059">THEN</tspan><tspan y="-463.98639" x="112.67999 114.78329 119.5146 121.73399 126.51929 131.2002 138.1545 140.37389 144.39418 147.77548 152.21518 156.11487 160.40517 162.62456 167.29286 172.02417 176.70508 180.72717 182.94656 187.73186 192.41277 195.79407 198.01346 202.79875 207.23845 211.88875 216.56966 218.78905 222.06235 226.74324 231.47455 238.37485 240.59424 243.93954 248.67084 251.94414 254.16353 259.43481 264.65482 266.87424 271.54254 276.22885 279.61014 284.29102 288.31131 290.53073 293.12903 297.85132 301.1246 304.39789 309.07877 312.38086 314.60028 318.51257 323.19345 327.86176 332.54263 334.76205 339.43036 344.21567 348.17746 352.97986 357.66074 362.33984 364.93814">IF new stack does not have room for 24 bytes (error code pushed) </tspan><tspan y="-451.98669" x="112.67999 117.3987 120.70079 122.92019 128.17889 133.43759 135.657 140.3127 144.9864 148.3551 153.0954 157.1031 159.32251 161.9082 166.68091 171.39961 173.61902 178.35931 181.62001 184.88071 189.59941 192.86011 195.07951 198.97922 203.69792 208.35362 213.06332 215.28273 219.93843 224.71114 228.71884 233.52124 238.23094 242.88664">or 20 bytes (no error code pushed)</tspan><tspan y="-439.987" x="130.67999 135.83879 141.65999 146.40298 152.22418 154.44357 160.23058 165.02757 169.76967 172.34908 177.08307 180.32487 183.60988 188.29077 191.57578 196.07668 200.00067 204.74367 209.42366 214.08029 216.66689 222.51149 227.22209 234.16469 238.93829 243.7119 245.53349 250.79309 252.61469 257.33429 262.9899 268.2081 270.79471 273.38132 275.24792 277.46732 282.18692 284.27853">THEN #SS(error_code(NewSS,0,EXT)); FI;</tspan><tspan y="-427.9873" x="130.67999 133.28189 137.31479 139.53418 141.45569 146.1348 149.5197 151.73909 156.47398 161.09369 165.8196 169.0614 173.5011 178.3035 182.9754 185.19479 188.5797 193.26059 195.47998 200.20589 203.44769 206.72459 211.40549 214.68239 219.18329 223.09918 227.83408 232.50598 237.18689 239.40628 241.36919 245.39308 247.61247 252.83247 255.05186 259.72375 264.40463 268.32053 272.80344 277.54553 281.56763 286.29352 288.51294 292.47473 297.21503 299.15094 303.83182 307.74771 311.1326 315.81351 319.1156 321.33502 323.2565 327.27859 329.49802 334.24011 338.26221 342.9881 347.60782 349.82724 353.86014">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-415.98761" x="94.679993 99.421196">FI</tspan><tspan y="-403.98792" x="76.679993 81.413094 85.885193 90.672295 95.405396">ELSE </tspan><tspan y="-391.98822" x="94.679993 96.776093 101.50019 103.71959 105.81569 111.34979 116.53289 118.75229 123.41339 127.88549 131.2596 135.9747 138.19411 140.14621 144.10802 146.32742 151.59152 156.85562 159.68973 164.30943 166.29123 169.66533">IF IDT gate is 16-bit </tspan><tspan y="-379.98853" x="112.67999 117.88919 123.71039 128.46059">THEN</tspan><tspan y="-367.98883" x="130.67999 132.72119 137.46239 139.68178 144.46707 149.14798 156.10228 158.32167 162.34196 165.72327 170.16296 174.06265 178.35295 180.57234 185.24065 189.97195 194.65286 198.67496 200.89435 205.67964 210.36055 213.74185 215.96124 220.74654 225.18623 229.83653 234.51744 236.73683 240.01013 244.69102 249.42233 256.32266 258.54208 261.88739 266.61868 269.89197 272.11139 277.38269 282.60269 284.82211 289.49042 294.17673 297.55801 302.23889 306.25919 308.47861 311.0769 315.79919 319.07248 322.34576 327.02664 330.32874 332.54816 336.46045 341.14133 345.80963 350.49051 352.70993 357.37823 362.16354 366.12534 370.92773 375.60861 380.28772 382.88602">IF new stack does not have room for 12 bytes (error code pushed) </tspan><tspan y="-355.98914" x="130.67999 135.3951 138.69719 140.9166 146.17169 151.42679 153.64619 158.29829 162.9684 166.3335 171.07379 175.0779 177.2973 179.87941 184.64851 189.36362 191.58302 196.32332 199.58041 202.83751 207.55261 210.80971 213.02911 216.92522 221.64032 226.29242 230.99852 233.21793 237.87003 242.63913 246.64323 251.44563 256.15173 260.80383 263.38593">or 10 bytes (no error code pushed);</tspan><tspan y="-343.98944" x="148.67999 153.83879 159.65999 164.40298 170.22418 172.44357 178.23058 183.02757 187.76967 190.34908 195.08307 198.32487 201.60988 206.29077 209.57578 214.07668 218.00067 222.74367 227.42366 232.08029 234.66689 240.51149 245.22209 252.16469 256.93829 261.71188 263.53348 268.79309 270.61469 275.33429 280.9899 286.2081 288.79471 291.38132 293.24792 295.46732 300.18692 302.27853">THEN #SS(error_code(NewSS,0,EXT)); FI;</tspan><tspan y="-331.98975" x="148.67999 151.28189 155.31479 157.53418 159.45569 164.1348 167.5197 169.73909 174.47398 179.09369 183.8196 187.0614 191.5011 196.3035 200.9754 203.19479 206.5797 211.26059 213.47998 218.20589 221.44769 224.72459 229.40549 232.68239 237.18329 241.09918 245.83408 250.50598 255.18689 257.40631 259.3692 263.3931 265.61252 270.83252 273.05194 277.72385 282.40472 286.32062 290.80353 295.54562 299.56772 304.29361 306.51303 310.47482 315.21512 317.15103 321.83191 325.7478 329.13269 333.8136 337.11569 339.33511 341.25659 345.27869 347.49811 352.2402 356.2623 360.98819 365.60791 367.82733 371.86023">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-319.99005" x="94.679993 99.40139 103.86179 108.63719 113.35859 115.57799 118.16639 122.18579 124.40519 129.6666 134.92799 137.7594 142.4178 144.3672 147.7386 149.95801 152.05141 157.58281 162.76321 164.98262 169.64102 174.11043 177.48183 182.19423 186.21362">ELSE (* 64-bit IDT gate*)</tspan><tspan y="-307.99036" x="112.67999 114.7878 119.5236 121.743 126.53281 129.91861 134.35831 138.258 142.5528 148.1328 152.7525 157.43161 160.67342 165.41373 169.43852 173.46332 175.68271 177.60422 181.62631 183.8457 188.5878 193.32899 198.11879 200.96458 204.88138 209.32108 214.11087 218.79176 223.58156 225.50307 229.41986 233.90366">IF StackAddress is non-canonical</tspan><tspan y="-295.99066" x="130.67999 135.84959 141.6852 146.3958 152.2314 154.45081 160.2054 165.0078 169.7724 172.35001 177.06061 182.70721 187.92542 190.50482 192.36243 194.58183 199.29243 201.37503 203.29474 205.51414 208.09175 212.10036 214.31976 219.03036 222.33246 225.58505 230.29565 233.54825 235.76765 239.65926 244.36986 249.01746 253.75775 255.97716 259.86874 264.57935 269.38174 272.74146 277.24054 279.16205 283.96445 287.92624 290.14563 296.02625 301.72775 306.17737 310.62695 312.84634 316.84595 321.54755 323.45914 328.19943 332.09103 335.45163 340.16223 343.41483 345.63422 349.64282">THEN #SS(EXT); FI; (* Error code contains NULL selector *)</tspan><tspan y="-283.99097" x="76.679993 81.414894 83.521797">FI;</tspan><tspan y="-271.99127" x="58.61969 63.354591 65.461494">FI;</tspan><tspan y="-259.99158" x="58.61969 60.713089 65.434486 67.653885 70.242287 72.335686 77.939087 83.200485 88.461884 92.962784 97.684181 102.40558 107.12698 112.55038 114.25677 118.71718 125.29258 130.89598 133.11539 138.23279 140.45219 145.71359 148.30199 150.52139 153.10979 157.12918 159.34859 165.19499 169.9164 173.3364 175.5558 177.597 183.23639 186.06779 191.32919 196.59059 201.30299 203.5224 210.4668 215.1882 219.8466 224.55901 226.77841 230.79781">IF (IA32_EFER.LMA = 0) (* Not IA-32e mode *)</tspan><tspan y="-247.99188" x="76.679993 81.889191 87.710388 92.460587">THEN</tspan><tspan y="-235.99219" x="94.679993 96.789597 101.5272 103.7466 105.7122 110.45431 114.48091 117.86852 121.11031 125.91272 129.83131 133.21892 135.18452 139.86542 144.65701 146.8764 151.49611 156.2373 158.20291 162.94501 166.33261 171.06122 174.30302 176.52242 179.87401 183.11581 187.85341 194.75371 196.9731 199.0827 204.60062 209.79721 212.0166 216.63631 221.13541 224.52301 229.20392 231.42331 233.38892 237.3597 239.57909 244.32118 249.06238 252.44278 254.66217 261.61557 263.57397 266.95438 271.73877 273.69717 278.48157 280.70096 285.48535 290.16626 297.11966 299.33905 303.25046 307.93137 312.59875 317.27966 320.12006 324.08188 328.80328 333.47067 340.37097 345.11127 349.85336 353.21307 355.43246 357.36386 359.32227 366.27567 368.23407 371.61447 375.63388">IF instruction pointer from IDT gate is not within new code-segment limits </tspan><tspan y="-223.99249" x="112.67999 117.89819 123.7194 128.43179 134.2692 136.4886 142.245 147.50639 152.61479 155.1942 159.9066 165.55501 170.72641 173.36522 175.22462 177.44403 182.15643 184.24083 186.10023 188.31964 190.95845 194.98056 197.19997 201.91237 205.21446 208.46886 213.18126 216.43565 218.65506 222.54846 227.26086 231.91026 236.65056 238.86996 242.76337 247.47577 252.27817 255.63786 260.13696 262.05847 266.86087 270.82266 273.04205 278.92267 284.56387 289.06296 293.50174 295.72113 299.72253 304.42593 306.33932 311.07962 314.97302 318.33542 323.04782 326.30222 328.52161 332.53201">THEN #GP(EXT); FI; (* Error code contains NULL selector *)</tspan><tspan y="-211.9928" x="94.679993 99.409492 104.19299 109.3185 111.5379 113.29739 118.4229 120.6423 126.4968 131.1777 138.1302 142.81111 147.5946 152.72011">ESP := NewESP;</tspan><tspan y="-199.9931" x="94.679993 99.470695 104.2614 106.4808 108.24751 113.3802 115.59961 121.42081 126.16112 133.12082 137.86292 142.65361 144.53731 146.7567 149.3604 153.3951 155.61449 160.35658 165.09689 169.7166 176.6772 181.40491 186.147 189.53371 191.7531 196.4268 201.10771 205.13341 209.0511 212.3298 214.25131 218.92502 222.31172 227.04842 230.29022 232.50961 234.43112 239.23352 242.58423 247.26512 250.54382 257.44412 261.92883 265.31552 267.237 271.97818 276.76889 278.98831 283.42801 285.34952 289.37521 294.05612 296.27554 298.21326 302.89417 307.37888 311.9986 316.72629 321.34601 323.56543 327.60013">SS := NewSS; (* Segment descriptor information also loaded *)</tspan><tspan y="-187.99341" x="76.679993 81.40049 85.859993 90.634491 95.354988 97.574387 100.16189 104.18039 106.39979 108.49229 114.09479 116.92529 122.18578 127.44628 132.15778 134.37718 141.32068 146.04118 150.69868 155.41019 157.62959 161.64809">ELSE (* IA-32e mode *)</tspan><tspan y="-175.99371" x="94.679993 96.758095 101.4993 103.7187 105.70049 110.4426 114.4377 117.7938 121.0419 125.8443 129.7314 133.08749 135.06929 139.75018 144.55258 146.77199 151.41508 156.15628 158.13808 162.88017 166.23627 170.97656 174.22466 176.44406 179.80286 183.04465 187.78584 194.68614 196.90555 198.98364 204.49974 209.71794 211.93735 216.58044 221.07954 224.43564 229.13274 231.35214 235.23924 239.98044 244.78284 248.14253 252.59663 254.57843 259.33853 263.33362 265.55301 270.05212 272.27151 277.03162 281.77283 286.53293 289.34903 293.23615 297.73526 302.49536 307.23657 312.03897 313.96048 317.8476 322.34671 324.25381 326.47321 330.92731 335.60641 340.24951 343.55161 348.24872 352.2438">IF instruction pointer from IDT gate contains a non-canonical address</tspan><tspan y="-163.99402" x="112.67999 117.89819 123.7194 128.43179 134.2692 136.4886 142.245 147.50639 152.61479 155.1942 159.9066 165.55501 170.72641 173.36522 175.22462 177.44403 182.15643 184.24083 186.10023 188.31964 190.95845 194.98056 197.19997 201.91237 205.21446 208.46886 213.18126 216.43565 218.65506 222.54846 227.26086 231.91026 236.65056 238.86996 242.76337 247.47577 252.27817 255.63786 260.13696 262.05847 266.86087 270.82266 273.04205 278.92267 284.56387 289.06296 293.50174 295.72113 299.72253 304.42593 306.33932 311.07962 314.97302 318.33542 323.04782 326.30222 328.52161 332.53201">THEN #GP(EXT); FI; (* Error code contains NULL selector *)</tspan><tspan y="-151.99432" x="94.679993 100.11599 104.85809 109.98809 112.20749 113.97149 119.10149 121.32088 127.17989 131.90489 138.86189 144.2979 149.03999 154.20149 156.42088 162.37888 164.59827 169.27916 174.01315 178.74715 183.42804 188.16203 192.89603 197.57692 202.31091 206.99181 211.7258 216.45979 221.14069 225.87468 230.60867 235.28957 240.56357 246.42256">RSP := NewRSP &amp; FFFFFFFFFFFFFFF0H;</tspan><tspan y="-139.99463" x="94.679993 99.469795 104.2596 106.479 108.2448 113.3766 115.59601 121.41721 126.15751 133.1163 137.8584 142.64819">SS := NewSS;</tspan><tspan y="-127.99493" x="58.619694 63.354595 65.461494">FI;</tspan><tspan y="-115.99522" x="58.619694 60.717594 65.443497 67.662895 69.760796 75.296692 80.48159 82.700989 87.363892 91.837791 95.213692 99.930595 102.14999 104.1039 108.0657 110.2851 115.55099 120.81689 123.65279 128.27249 130.25429">IF IDT gate is 32-bit</tspan><tspan y="-103.99552" x="76.679993 81.889191 87.710388 92.460587 98.281784">THEN </tspan><tspan y="-91.995819" x="94.679993 99.421188 104.22359 105.95609 110.69728 112.77178 117.93329 120.15269 121.88519 126.98369 129.20309 134.45459 138.90509 142.32509 147.00598 149.57549 154.31668 159.07318 160.87498 165.57748 167.65198 172.75047 175.31998 177.23969 179.45909 182.02859 186.0291 188.2485 193.005 197.7453 202.3848 209.3454 214.03889 218.84129 222.19379 224.41319 229.09229 233.77318 237.76468 241.64818 244.89268 246.87448 251.55357 254.91327 259.61578 262.91788 265.13727 267.06778 271.87018 275.18668 279.92789 283.17239 290.133 294.63211 297.99182 299.92233 304.66354 309.42004 311.63943 316.13855 318.06006 322.05154 326.75406 328.97345 330.87695 335.61816 340.06866 344.74777 349.4881 354.10779 356.32718 360.32767">CS:EIP := Gate(CS:EIP); (* Segment descriptor information also loaded *)</tspan><tspan y="-79.996117" x="76.679993 81.413094 85.885193 90.672295 95.405396">ELSE </tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="457.9035pt" height="644.64783pt" viewBox="0 0 457.9035 644.64783" sodipodi:docname="617.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="327.96621" inkscape:cy="423.77326" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg138" /><g transform="translate(-60.025345,-69.182129)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="95.519997 97.618797 102.3456 104.56499 106.6638 112.20059 117.38639 119.60579 124.26959 128.74438 132.12119 136.83899 139.05838 144.32518 149.54518 152.38199 157.04579 159.0006">IF IDT gate 16-bit</tspan><tspan y="-703.98029" x="113.52 118.72919 124.55039 129.3006 135.1218">THEN </tspan><tspan y="-691.98059" x="131.51999 136.24049 141.015 142.7655 144.858 149.9745 152.19391 153.94441 159.06091 161.28032 166.54982 171.01833 174.38882 179.10033 181.68782 186.40833 191.18283 192.93333 195.02583 200.14233 202.72983 204.59732">CS:IP := Gate(CS:IP); </tspan><tspan y="-679.9809" x="131.51999 134.1588 138.18089 140.4003 145.1523 149.89259 154.52759 161.48819 166.17719 170.97958 174.32759 176.547 181.22609 185.90698 189.92908 193.82878 197.06879 199.05058 203.68558 207.10559 211.80359 215.1057 217.3251 219.2511 224.0535 227.36549 232.10669 235.34669 242.3073 246.7533 250.17331 252.0993 256.84052 261.59253 263.81195 268.31107 270.23254 274.25464 278.93555 281.15497 283.05396 287.79517 292.24118 296.92029 301.60928 306.28839 308.50781 312.50381">(* Segment descriptor information also loaded *)</tspan><tspan y="-667.9812" x="113.51999 118.24139 122.70179 127.47719 132.19859 134.418 137.00639 141.02579 143.24519 148.50659 153.76799 156.5994 161.2578 163.2072 166.5786 168.798 170.8914 176.42281 181.60321 183.82262 188.48102 192.95042 196.32182 201.03423 203.25363 207.27303">ELSE (* 64-bit IDT gate *)</tspan><tspan y="-655.98151" x="131.51999 136.2486 141.03119 142.78979 148.2204 150.321 155.4456 157.66499 159.4236 164.5482 166.76759 172.0452 176.48489 179.86349 184.5831 187.1787 191.8596 196.64221 198.40082 203.83142 205.87262 210.99722 213.59282 215.46841">CS:RIP := Gate(CS:RIP); </tspan><tspan y="-643.98181" x="131.51999 134.1588 138.18089 140.4003 145.1523 149.89259 154.52759 161.48819 166.17719 170.97958 174.32759 176.547 181.22609 185.90698 189.92908 193.82878 197.06879 199.05058 203.68558 207.10559 211.80359 215.1057 217.3251 219.2511 224.0535 227.36549 232.10669 235.34669 242.3073 246.7533 250.17331 252.0993 256.84052 261.59253 263.81195 268.31107 270.23254 274.25464 278.93555 281.15497 283.05396 287.79517 292.24118 296.92029 301.60928 306.28839 308.50781 312.50381">(* Segment descriptor information also loaded *)</tspan><tspan y="-631.98212" x="95.519989 100.25489 102.36179">FI;</tspan><tspan y="-619.98242" x="59.519989 64.25489 66.361794">FI;</tspan><tspan y="-607.98273" x="59.519989 61.613388 66.334785 68.554184 70.647583 76.178986 81.359383 83.578781 88.237183 92.706581 96.07798 100.79038 103.00978 104.95918 108.96958 111.18898 116.45038 121.71178 124.54317 129.16287 131.14467">IF IDT gate is 32-bit</tspan><tspan y="-595.98303" x="95.519989 100.72919 106.55038 111.30058">THEN</tspan><tspan y="-583.98334" x="113.51999 118.67069 123.4128 127.4565 132.2652 134.8446 138.144 142.6467 145.8885 148.10791 152.79961 157.4805 159.4632 164.20529 167.60999 172.29088 175.53268 177.75209 181.15678 185.83768 188.05708 192.81178 194.73329 199.42499 201.64439 205.6062 209.0262 213.4659 217.3656 221.62531 224.20471 226.10641">Push(far pointer to old stack); </tspan><tspan y="-571.98364" x="113.51999 116.15879 120.18089 122.40029 128.10809 130.0089 134.68799 136.90739 141.66119 146.46359 148.683 153.1308 157.9332 162.56999 164.7894 169.53059 174.27269 179.43419 181.23329 183.4527 188.733 190.95241 197.87521 202.61641 205.85822 210.53731 214.5594 216.77881 221.4156 225.9147 230.5515 235.23059 239.97089 244.59058 246.80998 250.15979 254.90099 257.12039 262.4007 264.62012 268.61792">(* Old SS and ESP, 3 words padded to 4 *)</tspan><tspan y="-559.98395" x="113.51999 118.66709 123.40919 127.44929 132.25439 134.8338 139.51469 144.26579 148.70459 154.33769 159.55859 164.36369 166.9431">Push(EFLAGS);</tspan><tspan y="-547.98425" x="113.51999 118.68149 123.42359 127.42319 132.22559 134.80319 138.12779 142.62689 145.86868 148.08809 152.73569 157.44629 159.42809 164.17018 167.59018 172.27107 175.52367 177.74307 181.16307 185.84398 188.06339 191.36548 196.04637 199.40697 204.20937 207.46196 212.26436 214.48376 216.42236 221.22476 225.22437 228.58496 231.83755 236.63995 240.53156 243.89215 245.83075 250.54135 255.34375 257.92316 259.78076">Push(far pointer to return instruction); </tspan><tspan y="-535.98456" x="113.51999 116.12189 120.15479 122.37419 128.0721 129.99359 134.6655 136.88489 141.56578 146.36818 148.58757 153.02727 157.82967 162.44937 164.66876 169.40366 171.51056 176.64146 178.47836 180.69775 185.91776 188.13715 195.09505 199.77594 203.05284 207.67255 211.69644 213.91583 218.58774 223.02744 227.69934 232.31905 237.04495 241.71686 243.93625 247.32115 252.00204 254.22144 259.49634 261.71576 265.74866">(* Old CS and EIP, 3 words padded to 4 *)</tspan><tspan y="-523.98486" x="113.51999 118.64909 123.39119 127.41329 132.20039 134.80049 139.48138 142.75648 146.03159 150.76468 154.03978 158.77287 163.45377 168.12387 172.80478 175.40488 177.28497 179.50436 182.10446 186.13556 188.35495 190.46005 193.75946 195.97885 200.76595 205.44685 210.17096 214.79066 219.51477 224.18488 226.01997 228.23936 233.51247 235.73186 240.35156 245.03156 248.41466 253.13876 257.16086 259.38028 263.41138">Push(ErrorCode); (* If needed, 4 bytes *)</tspan><tspan y="-511.98517" x="95.519989 100.25489 104.72879 109.51769">ELSE</tspan><tspan y="-499.98547" x="113.51999 115.61879 120.34559 122.56499 124.66379 130.20059 135.3864 137.6058 142.26961 146.74442 150.12122 154.83902 157.05841 162.32521 167.54521 170.38202 175.04582 177.00063">IF IDT gate 16-bit</tspan><tspan y="-487.98578" x="131.51999 136.72919 142.55038 147.30058">THEN</tspan><tspan y="-475.98608" x="149.51999 154.67068 159.41278 163.45648 168.26518 170.84459 174.14398 178.64668 181.88849 184.10789 188.79959 193.48048 195.46318 200.20528 203.60997 208.29086 211.53267 213.75208 217.15677 221.83766 224.05707 228.81177 230.73328 235.42497 237.64438 241.60619 245.02618 249.46588 253.36559 257.62531 260.20471 262.10641">Push(far pointer to old stack); </tspan><tspan y="-463.98639" x="149.51999 152.13449 156.15659 158.37599 164.07388 165.99539 170.67989 172.89929 177.64139 182.44379 184.66319 189.10289 193.90529 198.52498 200.74438 205.54588 210.64708 212.44618 214.66559 219.95309 222.1725 229.14301 233.8239 237.1134 241.73309 245.76959 247.989 252.01109">(* Old SS and SP, 2 words *)</tspan><tspan y="-451.98669" x="149.51999 154.66438 159.40648 163.44388 168.24628 170.82568 175.50658 180.25497 184.69377 190.32417 195.54506 200.34746 202.92686 208.21527 213.43527 215.21367 220.43367 223.22008 225.79948">Push(EFLAGS(15:0]);</tspan><tspan y="-439.987" x="149.51999 154.68149 159.42358 163.42319 168.22559 170.80319 174.12779 178.62689 181.86868 184.08809 188.73569 193.44629 195.42809 200.17018 203.59018 208.27107 211.52367 213.74307 217.16307 221.84398 224.06339 227.36548 232.04637 235.40697 240.20937 243.46196 248.26436 250.48376 252.42236 257.22476 261.22437 264.58496 267.83755 272.63995 276.53156 279.89215 281.83075 286.54135 291.34375 293.92316 295.78076">Push(far pointer to return instruction); </tspan><tspan y="-427.9873" x="149.51999 152.13359 156.15569 158.37508 164.07297 165.99448 170.67807 172.89746 177.57835 182.38075 184.60014 189.03984 193.84224 198.46193 200.68132 202.79993 207.94252 209.74162 211.96101 217.24762 219.46701 226.36731 231.10851 234.35031 239.0294 243.065 245.28439 249.30649">(* Old CS and IP, 2 words *)</tspan><tspan y="-415.98761" x="149.51999 154.68149 159.4236 163.43401 168.20941 170.79781 175.51921 178.8213 182.0631 186.7845 190.0479 194.7693 199.49071 204.14911 208.86151 211.44991 213.3183 215.5377 218.1261 222.14549 224.3649 226.4583 229.7937 232.01311 236.78851 241.50092 246.21332 250.87172 255.58412 260.24252 262.06592 264.28531 269.54672 271.76611 276.4245 281.10089 284.47229 289.18469 293.1951 295.41449 299.4339">Push(ErrorCode); (* If needed, 2 bytes *)</tspan><tspan y="-403.98792" x="131.51999 136.24139 140.7018 145.4772 150.19861 152.41801 155.00641 159.0258 161.24521 166.50661 171.76801 174.59941 179.25781 181.20721 184.57861 186.79802 188.89142 194.42282 199.60323 201.82263 206.48103 210.95044 214.32184 219.03424 221.25365 225.27304">ELSE (* 64-bit IDT gate *)</tspan><tspan y="-391.98822" x="149.51999 154.67068 159.41278 163.45648 168.26518 170.84459 174.14398 178.64668 181.88849 184.10789 188.79959 193.48048 195.46318 200.20528 203.60997 208.29086 211.53267 213.75208 217.15677 221.83766 224.05707 228.81177 230.73328 235.42497 237.64438 241.60619 245.02618 249.46588 253.36559 257.62531 260.20471 262.10641">Push(far pointer to old stack); </tspan><tspan y="-379.98853" x="149.51999 152.15878 156.18088 158.40028 164.12608 166.04488 170.69968 172.91908 177.69089 182.46269 184.6821 189.1479 193.91971 198.57451 200.79391 205.56572 210.67952 212.49931 214.71872 219.42752 223.89333 227.79213 232.56393 234.78334 239.24915 244.02095 246.24036 251.49815 254.32596 258.98074 263.65353 267.02133 271.73013 273.94952 278.60431 283.3761 287.3829 292.15469 294.37408 298.38989">(* Old SS and SP, each an 8-byte push *)</tspan><tspan y="-367.98883" x="149.51999 154.68149 159.4236 163.4313 168.20401 170.7897 176.2104 180.92911 185.38681 190.98752 196.25522 201.02792 203.61362 205.47932 207.69963 210.28532 214.30202 216.52232 221.78102 224.60973 229.26543 233.93913 237.35913 242.04004 244.26035 248.91605 253.68875 257.69644 262.46915 264.68945 268.70615">Push(RFLAGS); (* 8-byte push *)</tspan><tspan y="-355.98914" x="149.51999 154.68149 159.42358 163.42319 168.22559 170.80319 174.12779 178.62689 181.86868 184.08809 188.73569 193.44629 195.42809 200.17018 203.59018 208.27107 211.52367 213.74307 217.16307 221.84398 224.06339 227.36548 232.04637 235.40697 240.20937 243.46196 248.26436 250.48376 252.42236 257.22476 261.22437 264.58496 267.83755 272.63995 276.53156 279.89215 281.83075 286.54135 291.34375 293.92316 295.78076">Push(far pointer to return instruction); </tspan><tspan y="-343.98944" x="149.51999 152.15878 156.18088 158.40028 164.12788 166.04848 170.70508 172.92448 177.64409 182.41769 184.6371 189.10471 193.87831 198.53491 200.75432 206.17592 208.26752 213.38312 215.20471 217.42412 222.13472 226.56 230.4471 235.2495 237.4689 241.923 246.7254 248.94481 254.1909 257.07178 261.71487 266.37598 269.73209 274.47241 276.6918 281.3349 286.1373 290.15939 294.90149 297.12088 301.12497">(* Old CS and RIP, each an 8-byte push *)</tspan><tspan y="-331.98975" x="149.51999 154.68149 159.4236 163.43311 168.20761 170.7951 175.51561 178.8177 182.05949 186.78 190.0425 194.763 199.48351 204.14101 208.85251 211.44 213.3075 215.5269 218.1144 222.13289 224.33969 226.43399 229.77029 231.9897 236.76601 241.47931 246.19261 250.85191 255.56522 260.22452 262.04883 264.26825 269.53055 272.36285 276.98254 281.66254 285.03485 289.74814 293.75943 295.97885 299.99915">Push(ErrorCode); (* If needed, 8-bytes *)</tspan><tspan y="-319.99005" x="95.519989 100.25489 102.36179">FI;</tspan><tspan y="-307.99036" x="59.519989 64.25489 66.361794">FI;</tspan><tspan y="-295.99066" x="59.519989 61.626888 66.361786 68.581192 73.323296 78.125694 82.565399 87.244499 91.979401 98.8797 103.6686 107.0535 111.53641 115.45231 119.71201 124.39291 129.18181 133.62151 138.29341 140.22931 144.95522 149.57492 152.17682 156.91171 162.04262 166.51653 169.11842 171.33781 176.91782 182.73901 188.28392 190.50331 195.2382 200.36911 204.84302 207.06241 212.19331 214.4127">IF ShadowStackEnabled(CPL) AND CPL = 3</tspan><tspan y="-283.99097" x="77.519989 82.729187 88.550385 93.300583">THEN</tspan><tspan y="-271.99127" x="95.519989 97.616089 102.34019 104.55959 106.65569 112.26179 117.52589 122.74589 127.29899 132.02309 136.74719 141.4281 146.8542 148.56331 153.02641 159.60451 165.2106 167.43001 172.55011 174.76952">IF IA32_EFER.LMA = 0</tspan><tspan y="-259.99158" x="113.51999 118.71029 124.56659 129.29788 135.15417 137.37357 139.47687 145.09016 150.36147 155.63277 160.13367 165.26097 169.73128 175.00258 179.50348 184.28877 189.03087 194.15817 196.37756 198.13887 203.26617 205.48557 210.27086 215.01295 220.14026">THEN IA32_PL3_SSP := SSP;</tspan><tspan y="-247.99188" x="113.51999 118.24049 122.69999 127.47449 132.19499 134.4144 137.00189 141.02039 143.23979 147.7083 152.3658 154.3143 159.08881 163.09831 166.46881 168.68822 172.69772 177.41823 179.63763 184.29514 186.24364 189.61414 193.62364 195.84305 201.10355 206.36404 208.11455 213.96005 216.17946 220.83696 225.54846 228.91896 231.13837 234.55836 239.30048 244.01198 246.23138 250.87088 255.33939 257.26089 262.0354 266.74689 268.96628 273.68677 277.02127 279.24066 283.89816 285.84665 289.21716 291.43655 297.28204 301.23755 306.49805 308.27997 310.49936 317.46356 322.20566 326.93787 330.17966 334.91187 337.13126 342.95245 345.17184 347.14105 351.10287 353.32227 356.71347 361.45557 366.18777 368.40717 373.08807 378.24957 383.89078 385.51257 389.54279 391.76218 398.66248 403.16156 407.89917 409.88098 416.78128 421.58368 428.54788 430.76727 432.70947 434.63098 439.42618 444.10709 448.59628 451.83807 454.68927 459.17847 463.79816 468.47723 471.71902 476.45932 480.48953 484.45135 486.67075 493.63495 495.60416 500.22385 503.58356 508.37875 510.59814 514.63733">ELSE (* adjust so bits 63:N get the value of bit N–1, where N is the CPU’s maximum linear-address width *)</tspan><tspan y="-235.99219" x="131.51997 133.61337 139.21677 144.43677 149.71707 154.26747 159.38487 163.84528 169.10667 173.65707 178.43248 183.20789 188.32529 190.54469 192.2961 197.4135 199.62027 204.09866 209.67867 214.24707 218.68677 223.36317 225.28468 230.07808 234.10648 237.49588 240.10228 244.89568 249.63777 254.77318 257.37958">IA32_PL3_SSP := LA_adjust(SSP);</tspan><tspan y="-223.99249" x="95.519974 100.25488 102.36178">FI;</tspan><tspan y="-211.9928" x="59.519974 64.254875 66.361778">FI;</tspan><tspan y="-199.9931" x="59.519974 64.254875 69.385773 73.859673 76.079971 77.844872 82.975769 85.196068 89.98497 94.666771 101.62467 103.84497 107.76087 112.44267 117.11457 121.79637 124.64127 128.60397 133.32988 138.00179 144.90298 149.6442 154.38719 157.74779 159.96808 165.51299 170.64389 175.1178">CPL := new code-segment DPL;</tspan><tspan y="-187.99341" x="59.519974 64.234177 69.00238 71.58358 76.999779 82.109978 86.609077 89.190277 91.409676 93.153877 98.264076 100.48347 105.19768 110.30788 114.76108">CS(RPL) := CPL;</tspan><tspan y="-175.99371" x="59.519974 61.627773 66.363571 68.582977 73.325081 78.127487 82.567192 87.246292 91.982094 98.882393 103.6722 107.058 111.5418 115.4586 119.7183 124.3992 129.189 133.62869 138.3015 140.2383 144.9651 149.58481 152.18761 156.9234 162.05521 166.53">IF ShadowStackEnabled(CPL)</tspan><tspan y="-163.99402" x="77.519974 82.255775 84.192574 88.865372 93.607475 98.397278 103.52908 105.74848 107.51428 112.64608 114.92579 119.71559 124.50539">oldSSP := SSP</tspan><tspan y="-151.99432" x="77.519974 82.316071 87.058167 92.196266 94.415665 96.187767 101.32587 103.54527 109.41237 114.09327 121.05837 125.80047 130.59657">SSP := NewSSP</tspan><tspan y="-139.99463" x="77.519974 79.611572 84.331177 86.550575 91.324173 96.097771 101.21337 103.43277 109.37637 111.59577 116.85537 121.63797 126.89757 132.15717 134.37657 136.11717 141.23277 143.45218">IF SSP &amp; 0x07 != 0</tspan><tspan y="-127.99493" x="95.519974 100.70037 106.54677 111.26817 117.11456 119.33396 125.09937 130.36977 135.48717 138.07556 143.33696 145.92535 147.79375 150.01315 154.73456 156.82796">THEN #GP(0); FI;</tspan><tspan y="-115.99522" x="77.519974 80.158775 84.180878 86.400276 91.578873 96.298477 100.61758 105.29848 110.07207 112.29147 116.75907 121.53267 126.18927 128.40868 133.12828 137.90189 139.65149 144.11009 146.20169 151.31729 153.06689 157.7865 159.70709 164.36369 169.1373 173.9109 179.0265 181.24591 185.90251 190.62027 194.63338 199.41148 204.12659 208.78769 211.0071 215.688 220.49042 222.70982 226.72293 231.50104 235.97314 240.59285 245.31696 252.21725 254.43666 258.44977 261.82388 266.29599 270.20108 274.48419 276.70361 283.65073 288.42883 292.44193 295.81604 298.01996 302.69275 307.37366 309.59305 313.50986 318.24567 323.03546 326.42126 330.86096 332.84277 337.58487 342.32516 346.94485 349.16425 351.12805 355.87015 358.08954 362.57333 364.79272 369.53482 374.03391 377.41971 382.2095 385.4873 389.927 391.8638 393.8006 398.42029 400.63968 405.12347 407.06027 408.98178 413.66086 418.45065 423.13156 427.80435 430.02374 435.24374 440.52402 443.36981 448.0426 452.7334 456.1192 460.80011 463.0195 466.2973 470.97821 475.651 477.57251 482.30832 487.05042 489.26981 493.30362">(* Token and CS:LIP:oldSSP pushed on shadow stack must be contained in a naturally aligned 32-byte region *)</tspan><tspan y="-103.99552" x="77.519958 79.607956 84.323959 86.543358 89.126358 93.896362 98.666367 103.77837 105.99776 111.93777 114.15717 119.27817 124.53416 129.31317 134.56917 139.28517 141.92397 144.14337 145.88037 150.99237 153.21178 155.79477 158.37778 163.14778 167.91779 173.02979">IF (SSP &amp; ~0x1F) != ((SSP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-103.98" x="175.25999">–</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-103.98" x="180.12 182.33939 187.61069 192.83069 195.42899 197.64838 203.60368 205.82307 210.95938 216.17938 220.97368 226.24498 230.92589"> 24) &amp; ~0x1F)</tspan><tspan y="-91.980301" x="95.519997 101.271 106.52699 111.62999 114.26878 119.51579 122.08978 124.00948 126.22887 130.93588 133.01488">#GP(0); FI;</tspan><tspan y="-79.980598" x="77.519997 79.618797 84.345596 86.564995 89.158798 91.752602 93.851402 99.460205 104.72701 109.9938 114.54961 119.23051 123.9717 128.6526 134.112 135.82381 140.28961 146.82991 152.40991 154.6293 159.1041 163.84619 168.50999 170.7294 175.45621 180.1983 181.91011 186.37592 188.96971 191.18912 196.31192 198.53131 203.79811 206.01752 211.62631 217.47812 223.01492 225.23431 229.97641 234.77881 239.90161 242.66641 247.93321 253.15321 254.91002 260.17682 265.4436 268.2084 270.4278 272.1756 277.2984 279.51779 284.78461">IF ((IA32_EFER.LMA and CS.L) = 0 AND SSP[63:32] != 0)</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="447.03653pt" height="644.64691pt" viewBox="0 0 447.03653 644.64691" sodipodi:docname="618.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.03772" inkscape:cy="423.77208" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg152" /><g transform="translate(-45.72171,-69.182129)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="94.68 99.860397 105.70679 110.42819 116.27459 118.49399 124.25939 129.52979 134.64719 137.23558 142.49698 145.08537 146.95377 149.17317 153.89458 155.98798">THEN #GP(0); FI;</tspan><tspan y="-703.98029" x="76.68 81.420303 86.218208 90.855911 95.596214 99.477913 102.82861 107.52032 112.19942 116.76062 120.12032 124.86152 129.12122 133.81291 138.61531 143.1765 147.7953 152.2944 154.21591 158.97061 163.71091 165.93031 171.02701 173.24641 178.00111 182.80351 187.90021 238.71962 241.28732 245.28603 247.50543 252.14313 256.94553 260.96762 265.64761 267.867 272.5047 274.48651 277.83722 280.05661 282.86731 285.0867 289.76581 291.68732 295.03802 297.25742 301.93652 306.61743 310.63953 312.62134 315.97205 317.90076 322.64197 327.44437 329.66376 334.90445 337.12384 339.93454 342.15393 349.11453 353.91693 357.90662 361.32663 363.54602 368.18372 372.92404 375.14343 379.02515 380.92685 385.61856 390.11768 393.36038 395.57977 399.57846">expected_token_value = SSP (* busy bit - bit position 0 - must be clear *)</tspan><tspan y="-691.98059" x="76.68 81.467102 86.1912 93.091499 97.652702 101.0358 105.76891 110.0286 114.7689 119.511 124.0722 128.69101 133.19011 135.12421 139.8663 144.59041 146.8098 151.9389 154.15829 158.94539 163.68748 168.81659 171.03598 172.99709 175.21648 180.49768 186.19919 190.98628 196.08749 200.6496 205.9308 208.0359 213.1803 215.3997 217.61911 238.67822 241.26212 245.27701 247.49641 252.26732 256.97522 260.34213 262.56152 265.92844 270.69934 275.40723 277.62662 282.28052 287.05142 291.05731 295.72922 297.94861 302.60251 304.54739 307.91431 310.1337 314.14859">new_token_value = SSP | BUSY_BIT   (* Set the busy bit *)</tspan><tspan y="-679.9809" x="76.679993 78.781494 83.510994 85.730392 89.748894 94.490997 98.968498 103.5882 108.3177 115.2702 119.7711 123.7932 127.1727 131.65019 135.5607 139.8492 144.4077 146.3382 151.0677 154.97821 159.26671 163.82521 167.73572 174.63602 179.30252 184.0797 187.9659 192.7251 197.40419 202.68448 207.32668 209.89888 214.70128 219.44337 224.60487 226.40398 228.62338 233.42578 238.10667 245.06728 249.62846 252.98366 257.68884 262.00793 266.68884 271.49124 275.99216 280.67126 285.11096 287.01715 291.81955 296.51575 298.37424 300.59363 305.28983 310.05801 314.70023 319.44052 323.32672 326.68192 331.42221 336.04193 340.57614 343.93134 348.67255 352.93225 357.67255 362.41464 366.94885 371.57306 376.07214 377.99362 382.75281 387.4931 390.06531 392.2847 394.01089 399.11209 401.33148 406.07178 410.80936 415.48846 420.22876 424.11496 427.47015 432.16635 436.84546 441.37967 444.73486 449.44006 453.75916 458.45535 463.25775 467.79196 472.41617 476.86935 478.77554 483.57794">IF shadow_stack_lock_cmpxchg8b(SSP, new_token_value, expected_token_value) != expected_token_value</tspan><tspan y="-667.9812" x="94.679993 99.86039 105.70679 110.42818 116.27458 118.49398 124.25938 129.52979 134.64719 137.23558 142.49698 145.08537 146.95377 149.17317 153.89458 155.98798">THEN #GP(0); FI;</tspan><tspan y="-643.9809" x="94.679993 96.778793 101.50559 103.72499 108.45179 110.37959 114.9993 119.8017 124.5825 126.2943 131.8311 136.9539 141.41971 143.6391 145.3869 150.5097 152.7291">IF oldSS.DPL != 3</tspan><tspan y="-631.9812" x="112.67999 115.26749 119.286 121.50539 126.68489 131.4594 136.1709 140.1804 144.89191 147.11131 151.12082 154.49132 158.95982 162.86133 167.14082 169.36023 174.01773 178.79224 182.80174 187.57625 192.28775 196.29726 198.51666 202.52617 207.30067 212.02118 216.79568 218.71718 223.37468 225.59409 230.36859 235.0891 238.45959 240.679 244.58051 249.04901 253.82352 257.83301 262.54449 264.77997 268.11267 272.57938 277.35208 279.27179 282.6405 286.64819 288.50671 290.7261 296.3988 302.9715 305.19089 309.90057 314.68228 316.62897 319.99768 324.00537 325.86389 328.08328 332.73898 337.20569 340.5744 345.04111 347.2605 351.9162 355.17691 359.8866 364.3533 368.67242 373.29211 378.0108 379.95749 384.73019 388.09891 392.1066 394.32599 398.34268">(* These stack pushes should not cause faults, VM exits, data breakpoints *)</tspan><tspan y="-619.98151" x="112.67998 115.28008 119.31117 121.53057 126.27267 131.07507 134.98917 139.73126 141.95065 146.67476 151.29356 156.01767 160.75977 164.14287 168.16496 170.38435 177.34045 179.26196 181.19606 183.13016 185.34955 189.83064 194.45035 199.12045 201.05455 205.74265 207.96204 211.34514 216.07823 218.29762 221.68073 226.42282 231.14693 233.36632 238.04723 242.54633 245.78813 247.70963 249.67073 254.35164 257.62674 259.84616 264.28586 268.19995 272.11404 276.83813 280.79993 284.82202 289.54611 293.56821 295.78763 299.17072 303.83997 306.05936 309.44876 314.19086 318.92126 321.14066 324.53006 329.21097 333.50937 338.19028 342.98367 344.78278 347.00217 353.96457 358.70667 360.67407 364.59448 369.33658 371.55597 373.52338 377.55179 379.77118 381.69269 386.49509 388.73969 392.1102 396.8847 401.59619 403.81558 407.82507 412.29358 419.23709 423.94858 426.16797 431.42847 436.68896 439.51947 444.17697 448.85248 452.22299 456.93448 459.15387 462.41638 467.12787 471.78537 473.73386 478.45435 483.22885 485.44824 489.46674">(* Such events will apply to the earlier accesses to the token, which is in the same 32-byte region *)</tspan><tspan y="-607.98181" x="112.67999 117.46889 122.2578 126.6975 131.3694 136.05029 143.00819 147.75029 151.13519 155.57489 159.49078 163.78468 168.91559 173.65768 177.68158 182.47047 187.69048 193.03198 195.63388 200.31477 202.25067 206.87038 211.60527 216.34737 218.94926 220.83116 223.05055 225.65245 229.68535 231.90474 237.03564 241.47534 246.14725 250.81915 255.50006 260.17197 262.39139 269.29169 271.27347 274.65836 279.44727 281.66669 286.88669 292.16699 294.38641 299.12851 301.11029 305.73001 310.53241 313.37732 318.11221 321.3891 326.061 330.74188 334.04398 336.2634 340.88312 342.8649 346.24979 350.27368 352.4931 357.17401 360.53281 362.75223 368.02713 370.24655 374.27945">ShadowStackPush8B(oldCS); (* Padded with 48 high-order bits of 0 *)</tspan><tspan y="-595.98212" x="112.67999 117.47609 122.27219 126.71188 131.39099 136.07188 143.03699 147.77908 151.17119 155.61089 159.53398 163.79369 168.93179 173.67389 177.70499 182.50108 187.72108 193.06259 195.67169 200.35258 202.29568 206.91539 211.65749 216.39958 221.73569 227.31569 232.11179 236.79268 239.01207 244.20416 246.42355 251.16565 253.10875 257.78784 263.15997 265.25067 270.36536 272.95105 274.87073 277.09012 279.67581 283.6925 285.9119 291.02661 295.49332 300.14902 304.80472 309.5144 314.1701 316.3895 323.33121 325.27789 328.64661 333.41931 335.6387 340.8974 346.1561 348.37549 353.14819 355.09488 359.75058 364.52328 367.35199 372.07068 375.33139 379.97998 384.6861 387.94321 390.1626 394.8147 396.75781 400.12292 404.12701 406.34641 411.06149 414.39059 416.60999 421.86508 424.08447 427.41357 432.12866 435.38577 437.60516 442.86026 448.11536 450.33475 454.98685 456.92993 460.34995 462.56934 467.02344 469.11053 474.22165 478.23474">ShadowStackPush8B(oldCSBASE + oldRIP); (* Padded with 32 high-order bits of 0 for 32 bit LIP*)</tspan><tspan y="-583.98242" x="112.67996 117.47966 122.27936 126.71906 131.40175 136.08264 143.05135 147.79344 151.18915 155.62885 159.55554 163.81525 168.95694 173.69904 177.73373 182.53343 187.75343 193.09494 195.70764 200.38853 202.33524 206.95493 211.75462 216.49672 221.63841 224.25111">ShadowStackPush8B(oldSSP);</tspan><tspan y="-571.98273" x="94.679962 99.414864 101.52177">FI;</tspan><tspan y="-559.98303" x="58.619663 63.354565 65.461464">FI;</tspan><tspan y="-547.98334" x="58.619663 60.694164 65.435364 67.654762 72.395958 77.138062 81.817162 86.436867 89.738968 94.178665 98.981064 102.88076 107.63726 112.37846 117.13496 121.63406 126.31316 128.23466 132.92816 137.60725 139.82666 142.39616 147.09866 152.26016 156.69896">IF EndbranchEnabled (CPL)</tspan><tspan y="-535.98364" x="76.679962 78.771561 84.373161 89.593163 94.873459 99.422058 104.19566 108.74426 113.46385 118.14476 123.36296 125.06756 130.24615 135.66776 141.26935 145.98895 151.23955 155.95915 161.38075 163.60016 168.71576 170.93967 178.24586 183.85106 185.94626 191.12846 195.62936 200.37057 206.06848 211.52788 216.08008 220.76099 226.60919 232.1424 237.4236 242.883 248.48819 254.3364 259.0596 264.90781">IA32_S_CET.TRACKER = WAIT_FOR_ENDBRANCH;</tspan><tspan y="-523.98395" x="76.67997 78.774269 84.378571 89.598572 94.878868 99.430168 104.20647 108.75777 113.48006 118.16096 123.37917 125.08646 129.86276 135.50397 140.66547 145.78377 151.20807 155.93037 160.70668 165.48299 167.70239 172.82069 175.0401">IA32_S_CET.SUPPRESS = 0</tspan><tspan y="-511.98425" x="58.619667 63.354568 65.461472">FI;</tspan><tspan y="-499.98456" x="58.619667 60.713966 65.436264 67.655663 69.749962 75.282265 80.463562 82.682961 87.342262 91.812561 95.18486 99.898163 102.11756 104.06786 108.02966 110.24906 112.19936 116.97566 120.34796 125.06126 128.32556 131.58986 136.36617 141.02547 144.39777 146.61717 151.27647 155.74678 159.11908">IF IDT gate is interrupt gate</tspan><tspan y="-487.98486" x="76.67997 81.862167 87.710365 92.433563 98.281761 100.50116 102.59636 107.31956 109.53896 111.29215 116.41135 118.63075 123.89395 126.11335 128.70355 132.72475 134.94415 137.03935 141.81656 145.18976 149.90396 153.16916 156.43436 161.21156 165.87177 169.24496 171.46437 174.80157 176.72577 181.19698 185.85718 188.07658 192.08879 196.73996 200.11136 202.33076 205.70216 210.42357 212.64297 217.90437 219.72777 221.94717 223.89658 228.67198 232.04338 236.75578 240.01918 243.28258 248.05798 252.71638 256.0878 260.09821 262.3176 266.97598 268.92538 272.93579 277.40518 282.06357 283.98596 288.69836 293.35675 295.57614 299.59555 302.18396 304.05237 306.27176 310.99316 313.08658">THEN IF := 0 (* Interrupt flag set to 0, interrupts disabled *); FI;</tspan><tspan y="-475.98517" x="58.619659 63.829758 68.510658 70.730057 72.511154 77.612358 79.831757 85.051758">TF := 0;</tspan><tspan y="-463.98547" x="58.619659 64.310356 70.850655 73.070061 74.836761 79.96946 82.188866 87.465569">VM := 0;</tspan><tspan y="-451.98578" x="58.619659 64.071861 68.752762 70.97216 72.752357 77.853561 80.07296 85.292961">RF := 0;</tspan><tspan y="-439.98608" x="58.619659 64.483162 69.641968 71.861374 73.629875 78.764374 80.98378 86.203781">NT := 0;</tspan><tspan y="-427.98639" x="45.119659 49.81406 55.69466 61.199059">END;</tspan><tspan y="-415.98669" x="45.119659 47.201359 53.03606 58.204762 62.914463 68.326164 73.785561 79.45826 84.619759 89.78846 92.608162 97.317863 102.72956 108.44726 115.04786 117.86756 123.56907 125.65077 131.06247 136.23117 141.90387 147.49557 151.94427 154.82518 160.04518 165.29488 170.54457 175.79427 178.61397 185.21457 190.93227 196.45197 201.16167">INTERRUPT-FROM-VIRTUAL-8086-MODE:</tspan><tspan y="-403.987" x="58.619659 61.258461 65.280556 67.499954 69.575356 74.254456 78.994751 83.736855 87.090256 89.072052 92.38945 97.047852 99.26725 103.25965 106.61305 111.11215 115.01185 119.27425 122.08765 126.08005 130.77444 135.45354 142.41414 147.10854 151.91093 155.26433 157.48373 161.47614 166.17053 168.07494 172.81523 176.69963 180.05302 184.79422 188.03603 190.25543 193.61423 198.29512 201.59723 203.81664 208.45703 211.75914 213.69054 218.31294 220.29474 222.21625 226.91064 231.58974 236.28413 238.50354 240.48445 245.16534 249.78775 254.52805 256.43243 258.65182 263.93213 266.15152 268.08292 272.88535 275.10474 278.98914 283.74652 286.99191 290.29401 294.9884 299.7908 303.1442 305.36359 310.526 315.3284 320.08582 322.30521 326.30661">(* Identify stack-segment selector for privilege level 0 in current TSS *)</tspan><tspan y="-391.9873" x="58.619659 60.701359 65.411057 67.630463 71.521164 76.323563 79.575264 82.826965 87.567261 92.330963 95.750969 97.970375 103.13908 107.90278 112.70518 114.92458 116.86228 120.86098 123.08039 128.33009 133.57979 136.46069 141.0804 143.06219">IF current TSS is 32-bit</tspan><tspan y="-379.98761" x="76.679962 81.88916 87.710358 92.460556 98.281754">THEN </tspan><tspan y="-367.98792" x="94.679962 96.772461 101.49296 103.71236 108.89185 113.66635 118.44085 120.66025 122.58175 124.53025 131.47375 133.42226 136.79276 139.01216 144.03867 146.25807">IF TSS limit &lt; 9</tspan><tspan y="-355.98822" x="112.67996 117.89816 123.71937 128.43176 134.26917 136.48857 142.24496 147.41637 152.21877 154.79817 159.53847 162.79286 166.04726 170.75966 174.01405 178.55545 182.44885 187.16125 191.81065 196.55095 199.13036 203.02376 207.82616 211.08055 214.33495 219.07524 223.84164 227.26164 229.48105 234.65245 239.41885 244.22125 246.44066 250.44206 255.14546 257.05887 261.79916 265.69257 269.05496 273.76736 277.02176 278.83615 284.08856 285.90295 290.61536 296.26376 301.48196 304.06137 306.64078 308.50018 310.71957 315.43198 317.51639">THEN #TS(error_code(current TSS selector,0,EXT)); FI;</tspan><tspan y="-343.98853" x="112.67996 115.28456 119.32016 121.53957 123.46107 128.14017 131.52777 133.74716 138.48476 143.10446 147.83307 151.07487 155.51457 160.31697 164.99158 167.21097 170.59857 175.27946 177.49886 182.22746 185.46927 188.74887 193.42976 196.70937 201.21027 205.12886 209.86646 214.54106 219.22197 221.44136 223.40697 227.36876 229.58815 234.86575 237.08514 241.75975 246.44066 250.35925 254.84485 259.58694 263.60907 268.33768 270.55707 274.51889 279.25919 281.19778 285.87869 289.7973 293.18491 297.86581 301.16791 303.3873 305.30881 309.33093 311.55032 316.29242 320.31454 325.04315 329.66284 331.88223 335.91785">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-331.98883" x="94.679962 100.54256 105.22346 112.18407 116.97567 121.71777 123.93718 125.70478 130.83838 133.05777 138.27777 140.49716 145.17177 149.86436 153.22408 157.90498 161.93158 164.15097 166.08957 170.82716 175.26686 179.94597 184.62688 189.30598 191.52538 194.87697 198.11877 202.85637 209.76025 211.97964 214.57884 218.49203 223.27823 226.52003 229.79424 234.47514 239.26134 242.64354 244.86293 250.02174 254.82414 259.56625 261.78564 266.45483 270.89453 274.91574 279.63895 281.85834 287.04053 289.25992 294.47992 297.05933">NewSS := 2 bytes loaded from (current TSS base + 8);</tspan><tspan y="-319.98914" x="94.679955 100.52635 105.23875 112.18315 116.90455 121.67995 126.79735 129.01675 130.81856 135.91975 138.13916 143.40056 145.61996 150.27837 154.95477 158.32617 163.03857 167.00038 169.21979 171.14218 175.86359 180.33299 184.99139 189.7038 194.3622 196.5816 199.91701 203.15965 207.88736 214.83806 217.05745 219.65215 223.56085 228.30296 231.60506 234.84686 239.52777 244.30948 247.68718 249.90657 255.06538 259.84708 264.62878 266.84821 271.4679 275.96701 279.9288 284.6691 286.88852 292.06622 294.28564 299.55334 302.14804">NewESP := 4 bytes loaded from (current TSS base + 4);</tspan><tspan y="-307.98944" x="76.679955 81.412155 85.850952 90.637154 95.369354 97.588753 100.18795 104.21815 106.43755 110.35075 115.09285 118.36705 121.60885 126.28975 131.09215 134.47435 136.69374 141.85255 146.63875 151.42494 153.64433 155.56584 159.58794 161.80733 167.07953 172.29953 175.14172 179.81093 181.73244 185.15244 187.37183 191.40202">ELSE (* current TSS is 16-bit *)</tspan><tspan y="-295.98975" x="94.679955 96.772453 101.49295 103.71235 108.89185 113.66634 118.44084 120.66024 122.58174 124.53024 131.47374 133.42224 136.79274 139.01215 144.03865 146.25806">IF TSS limit &lt; 5</tspan><tspan y="-283.99005" x="112.67995 117.89816 123.71936 128.43176 134.26917 136.48857 142.24496 147.41637 152.21877 154.79817 159.53847 162.79286 166.04726 170.75966 174.01405 178.55545 182.44885 187.16125 191.81065 196.55095 199.13036 203.02376 207.82616 211.08055 214.33495 219.07524 223.84164 227.26164 229.48105 234.65245 239.41885 244.22125 246.44066 250.44206 255.14546 257.05887 261.79916 265.69257 269.05496 273.76736 277.02176 278.83615 284.08856 285.90295 290.61536 296.26376 301.48196 304.06137 306.64078 308.50018 310.71957 315.43198 317.51639">THEN #TS(error_code(current TSS selector,0,EXT)); FI;</tspan><tspan y="-271.99036" x="112.67995 115.28455 119.32015 121.53956 123.46106 128.14017 131.52777 133.74716 138.48476 143.10446 147.83307 151.07487 155.51457 160.31697 164.99158 167.21097 170.59857 175.27946 177.49886 182.22746 185.46927 188.74887 193.42976 196.70937 201.21027 205.12886 209.86646 214.54106 219.22197 221.44136 223.40697 227.36876 229.58815 234.86575 237.08514 241.75975 246.44066 250.35925 254.84485 259.58694 263.60907 268.33768 270.55707 274.51889 279.25919 281.19778 285.87869 289.7973 293.18491 297.86581 301.16791 303.3873 305.30881 309.33093 311.55032 316.29242 320.31454 325.04315 329.66284 331.88223 335.91785">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-259.99066" x="94.679955 100.54256 105.22346 112.18406 116.97566 121.71777 123.93717 125.70477 130.83838 133.05777 138.27777 140.49716 145.17177 149.86436 153.22408 157.90498 161.93158 164.15097 166.08957 170.82716 175.26686 179.94597 184.62688 189.30598 191.52538 194.87697 198.11877 202.85637 209.76025 211.97964 214.57884 218.49203 223.27823 226.52003 229.79424 234.47514 239.26134 242.64354 244.86293 250.02174 254.82414 259.56625 261.78564 266.45483 270.89453 274.91574 279.63895 281.85834 287.04053 289.25992 294.47992 297.05933">NewSS := 2 bytes loaded from (current TSS base + 4);</tspan><tspan y="-247.99097" x="94.679955 100.52635 105.23875 112.18315 116.90455 121.67995 126.79735 129.01675 130.81856 135.91975 138.13916 143.40056 145.61996 150.27837 154.95477 158.32617 163.03857 167.00038 169.21979 171.14218 175.86359 180.33299 184.99139 189.7038 194.3622 196.5816 199.91701 203.15965 207.88736 214.83806 217.05745 219.65215 223.56085 228.30296 231.60506 234.84686 239.52777 244.30948 247.68718 249.90657 255.06538 259.84708 264.62878 266.84821 271.4679 275.96701 279.9288 284.6691 286.88852 292.06622 294.28564 299.55334 302.14804">NewESP := 2 bytes loaded from (current TSS base + 2);</tspan><tspan y="-235.99127" x="58.619659 63.354561 65.461464">FI;</tspan><tspan y="-223.99158" x="58.619659 60.70496 65.418259 67.637665 73.475967 78.21627 85.152573 89.919876 94.722282 96.941681 98.88298 102.88528 105.10469 110.94299 116.61929 121.07159">IF NewSS is NULL</tspan><tspan y="-211.99188" x="76.679962 81.86216 87.710358 92.433556 98.281754 100.50115 106.26836 111.45055 116.22775 118.81796 123.54115 129.20035 134.38255 136.97275 138.84294 141.06235 145.74326 147.84386 149.71405 151.93346 154.52365 158.51965 160.73904 165.47664 168.71844 171.99805 176.67894 179.95854 182.17793 186.09653 190.77742 195.45203 200.18063 202.40002 206.31862 210.99951 215.79111 219.15082 223.59052 225.57233 230.31442 234.33652 236.55591 242.4185 248.05971 252.5363 256.9751 259.19449 263.2211 267.90201 269.84061 274.56921 278.48782 281.84753 286.58514 289.82693 292.04633 296.08194">THEN #TS(EXT); FI; (* Error code contains NULL selector *)</tspan><tspan y="-199.99219" x="58.619652 60.716652 65.44165 67.661049 73.511047 78.227051 85.175049 89.917145 94.696144 96.915543 98.868546 103.64754 108.26725 113.00755 117.74516 119.96455 121.91756 125.93156 128.15096 132.89307 137.63428 141.00928 143.22868 150.17668 152.12968 155.50468 160.28369 162.23669 167.03995 169.25934 171.24113 174.60085 178.57974 180.79913 185.47824 190.21855 194.19745 198.09714 201.39925 203.32074 207.99985 211.35956 216.10075 219.34256 221.56195 224.90186 229.40096 234.02786 235.94936 240.68965 242.90904 244.83054 246.75203 253.71263 255.69443 259.03433">IF NewSS index is not within its descriptor table limits</tspan><tspan y="-187.99249" x="58.619652 63.355453 66.633255 68.852661 74.713463 79.394363 86.353165 91.142967 95.885071 98.104477 103.54227 108.67407">or NewSS RPL</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-187.98" x="113.1"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-187.98" x="115.79998">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-187.98" x="121.86 124.0794"> 0</tspan><tspan y="-175.9803" x="76.68 81.898201 87.719406 92.429108 98.263809 100.48322 106.23692 111.40562 116.20802 118.78741 123.52771 126.77941 130.03111 134.74081 137.99251 142.5312 146.42191 151.13161 155.77831 160.5186 163.09531 168.93001 173.6703 180.63089 185.39459 190.19699 192.0087 197.25839 199.0701 203.7798 209.42551 214.59421 217.17091 219.80972 221.66643 223.88583 228.59554 230.67723">THEN #TS(error_code(NewSS,0,EXT)); FI;</tspan><tspan y="-163.98061" x="76.68 79.318802 83.340904 85.560303 87.510605 92.169907 95.542206 97.761604 102.4839 107.1432 111.85651 115.1208 119.5911 124.3674 129.0267 131.24611 134.61841 139.34071 141.56012 146.27342 149.53772 152.83981 157.52072 160.82281 165.32372 169.22702 173.94933 178.60863 183.32193 185.54134 187.49164 191.4003 193.61971 198.8784 201.09781 205.75351 210.46321 214.36292 218.82962 223.60233 227.61003 232.31973 234.53914 238.54684 243.25655 245.17624 249.88594 253.78564 257.20566 261.92435 265.18506 267.40445 269.35114 273.35883 275.57822 280.35092 284.35861 289.0683 293.724 295.94339 299.96008">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-151.98091" x="58.620605 64.052109 68.772606 73.250107 77.869812 80.089211 84.872711 89.593208 96.545708 98.765106 102.78361 106.16311 110.64061 114.55111 118.83961 121.67911 125.69761 130.41811 135.08461 141.98491 146.70541 151.44031 154.7946 157.01401 161.6553 166.3956 170.3889 174.2742 177.52051 179.4528 184.0941 187.44839 192.15269 195.399 197.61841 200.93671 205.64101 208.94312 211.16252 216.99182 221.73212 228.65942 233.46182 238.22012 240.43953 242.42133 247.16342 249.38283 254.63612 260.15042 265.36862 267.58801 272.2923 275.59439 277.81378 282.25708 287.77139 292.93469">Read new stack-segment descriptor for NewSS in GDT or LDT;</tspan><tspan y="-139.98122" x="58.620605 60.721203 65.462402 67.681801 72.4842 77.1651 84.125702 86.3451 90.327599 93.747597 98.189095 102.08879 106.34129 109.22219 113.20469 117.94499 122.62409 129.52438 134.26468 139.00677 142.35028 144.56967 150.07317 155.23466 159.66716">IF new stack-segment DPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-139.98" x="161.88">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-139.98" x="167.93987"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-139.98" x="170.64 175.86 178.07939 182.8107 186.084 188.30339 192.32368 195.70499 200.18428 204.09659 208.38689 210.60628 214.62657 219.30748 223.97578 230.93008 235.61099 240.41339 243.79469 246.01408 250.68239 255.3633 260.0856 264.04739 266.26682 271.05212 275.78342 279.1647 281.38412 283.3056 288.108 292.72769 294.70947 298.62177 303.06146 306.44275 311.12363 313.34305 320.29736 323.57065 325.52994 328.91122 333.35092 338.03003 339.96234 344.64322 346.86264 351.53094 355.97064 359.35193 363.79163 366.01105 370.03134 374.71222 379.38052 386.33484 391.01572 395.81812">0 or stack segment does not indicate writable data segment</tspan><tspan y="-127.98029" x="76.68 81.898201 87.719406 92.429108 98.263809 100.48322 106.23692 111.40562 116.20802 118.78741 123.52771 126.77941 130.03111 134.74081 137.99251 142.5312 146.42191 151.13161 155.77831 160.5186 163.09531 168.93001 173.6703 180.63089 185.39459 190.19699 192.0087 197.25839 199.0701 203.7798 209.42551 214.59421 217.17091 219.80972 221.66643 223.88583 228.59554 230.67723">THEN #TS(error_code(NewSS,0,EXT)); FI;</tspan><tspan y="-115.98059" x="76.68 79.318802 83.340904 85.560303 87.510605 92.169907 95.542206 97.761604 102.4839 107.1432 111.85651 115.1208 119.5911 124.3674 129.0267 131.24611 134.61841 139.34071 141.56012 146.27342 149.53772 152.83981 157.52072 160.82281 165.32372 169.22702 173.94933 178.60863 183.32193 185.54134 187.49164 191.4003 193.61971 198.8784 201.09781 205.75351 210.46321 214.36292 218.82962 223.60233 227.61003 232.31973 234.53914 238.54684 243.25655 245.17624 249.88594 253.78564 257.20566 261.92435 265.18506 267.40445 269.35114 273.35883 275.57822 280.35092 284.35861 289.0683 293.724 295.94339 299.96008">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-103.98089" x="58.620605 60.695107 65.436302 67.655701 72.458099 77.138992 84.099594 86.318993 90.310493 93.730492 98.180992 102.06449 106.32599 108.54539 112.53689 117.27719 121.91669 128.87729 133.57079 138.37318 141.72568 143.94508 148.74748 153.42838 156.84837 159.06778 163.70728 167.00938 171.70288 175.69438 180.38788 185.19028 188.54277">IF new stack segment not present </tspan><tspan y="-91.981186" x="76.680908 81.884705 87.705902 92.450699 98.271896 100.49129 106.2801 111.0789 115.82099 118.40039 123.13619 126.37799 129.66479 134.34569 137.63249 142.13339 146.05919 150.80399 155.48578 160.14061 162.7236 168.56461 173.27161 180.2106 184.98061 189.75061 191.5686 196.8246 198.64259 203.3586 209.01059 214.22879 216.8118 219.39481 221.25781 223.47722 228.19322 230.28122">THEN #SS(error_code(NewSS,0,EXT)); FI;</tspan><tspan y="-79.981483" x="76.680908 79.31971 83.341812 85.561211 87.511513 92.170815 95.543114 97.762512 102.48481 107.14411 111.85741 115.12171 119.59201 124.36831 129.0276 131.24701 134.61931 139.34161 141.56102 146.27432 149.53862 152.84071 157.52162 160.82372 165.32462 169.22792 173.95023 178.60953 183.32283 185.54224 187.49254 191.40121 193.62062 198.87932 201.09872 205.75443 210.46413 214.36383 218.83054 223.60324 227.61095 232.32065 234.54005 238.54776 243.25746 245.17715 249.88686 253.78656 257.20657 261.92526 265.18597 267.40536 269.35205 273.35974 275.57913 280.35184 284.35953 289.06921 293.72491 295.94431 299.961">(* idt operand to error_code is 0 because selector is used *)</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="320.78958pt" height="642.95801pt" viewBox="0 0 320.78958 642.95801" sodipodi:docname="619.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="328.63999" inkscape:cy="421.52018" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg130" /><g transform="translate(-59.520004,-69.182129)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="59.52 65.377197 70.058098 77.013298 81.755402 86.541603 91.6698 93.889198 95.651398 100.77959 102.99899 105.1032 110.68319 115.95539 121.17539 125.7366 130.86479 135.3036 137.28542 141.84662 146.58871 151.37491 156.50311 158.7225 161.3217 165.3519 167.57129 174.52649 179.26859 183.99179 187.2336 191.9568 194.17619 196.0977 198.31709 203.4453 205.66469 210.45088 215.17409 222.07439 224.29378 228.20697 232.93918 237.55888 242.29919 245.14139 249.16258 253.84349 258.52258 265.47778 270.15869 274.94489 278.32709 280.54648 286.08868 291.21689 295.68808 297.90747 301.86929">NewSSP := IA32_PLi_SSP (* where i = new code-segment DPL *)</tspan><tspan y="-703.98029" x="59.52 61.6134 66.334801 68.554199 70.647598 76.179001 81.359398 83.578796 88.237198 92.706596 96.077995 100.7904 103.0098 104.9592 108.9696 111.189 116.45039 121.71179 124.54319 129.16289 131.14468">IF IDT gate is 32-bit</tspan><tspan y="-691.98059" x="77.520004 82.729202 88.5504 93.300598">THEN</tspan><tspan y="-679.9809" x="95.520004 97.622406 102.35281 104.5722 109.35661 114.03751 120.99091 123.2103 127.1721 130.5921 135.0318 138.9315 143.2209 145.44029 150.1077 154.8381 159.51901 163.54111 165.7605 170.50259 175.2438 178.62421 180.8436 185.62799 190.06769 194.71709 199.39799 201.61739 204.88979 209.62018 214.35059 221.25089 223.47028 226.81468 231.54507 234.81747 237.03687 242.30727 247.52727 249.74666 254.41406 259.09946 262.47986 267.16077 271.18018 273.39957 275.99698 280.71838 283.99078 287.26318 291.94409 295.24619 297.46558 301.37698 306.05789 310.72528 315.40619 317.62558 322.29297 327.03506 331.05447 335.83887 340.51978 345.19885 347.79626">IF new stack does not have room for 40 bytes (error code pushed) </tspan><tspan y="-667.9812" x="95.520004 100.2495 103.521 105.7404 111.0099 116.2794 118.4988 123.1185 127.7985 131.17799 135.8985 139.91699 142.13638 144.73288 149.47498 154.20448 156.42387 161.10478 164.40688 167.67838 172.40788 175.67938 177.89877 181.80928 186.53879 191.20529 195.8862 198.10559 202.77209 207.51419 211.53268 216.27478 220.99529 225.66179">or 36 bytes (no error code pushed)</tspan><tspan y="-655.98151" x="113.52 118.7265 124.5477 129.2952 135.11639 137.3358 143.1273 147.9288 152.6709 155.25031 159.9888 163.23061 166.52011 171.201 174.49051 178.99141 182.91991 187.6674 192.3519 197.03279 199.6122 205.4928 210.17369 217.13429 221.87639 226.67879 228.47789 233.75819 235.5573 240.29849 245.9397 251.0985 253.713 256.29239 258.15268 260.3721 265.1196 267.1608">THEN #SS(error_code(NewSS,0,EXT)); FI;</tspan><tspan y="-643.98181" x="113.52 116.13091 120.17281 122.3922 124.31371 128.9928 132.3867 134.60609 139.28699 143.96608 148.70097 151.94278 156.38248 161.18488 165.80457 168.02396 171.41786 176.09875 178.31815 183.05304 186.29485 189.58075 194.26164 197.54755 202.04845 205.97334 210.71724 215.39813 220.07903 222.29842 224.27031 228.24031 230.45972 235.72021 237.93962 242.59712 247.30862 251.21013 255.67863 260.45312 264.46262 269.1741 271.39349 275.40298 280.11447 282.03598 286.74747 290.64896 294.01947 298.73996 302.00247 304.22186 306.17035 310.17984 312.39923 317.17374 321.18323 325.89471 330.55222 332.77161 336.7901">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-631.98212" x="77.520004 82.240501 86.700005 91.474503 96.195 98.414398 101.0019 105.0204 107.2398 109.3323 114.8628 120.0423 122.2617 126.9192 131.3877 134.75819 139.4697 141.6891 143.6376 147.64711 149.86652 155.12701 160.38751 163.21802 167.87552 169.82402 173.19452 175.78201">ELSE (* IDT gate is 16-bit) </tspan><tspan y="-619.98242" x="95.520004 97.622406 102.35281 104.5722 109.35661 114.03751 120.99091 123.2103 127.1721 130.5921 135.0318 138.9315 143.2209 145.44029 150.1077 154.8381 159.51901 163.54111 165.7605 170.50259 175.2438 178.62421 180.8436 185.62799 190.06769 194.71709 199.39799 201.61739 204.88979 209.62018 214.35059 221.25089 223.47028 226.81468 231.54507 234.81747 237.03687 242.30727 247.52727 249.74666 254.41406 259.09946 262.47986 267.16077 271.18018 273.39957 275.99698 280.71838 283.99078 287.26318 291.94409 295.24619 297.46558 301.37698 306.05789 310.72528 315.40619 317.62558 322.29297 327.03506 331.05447 335.83887 340.51978 345.19885 347.79626">IF new stack does not have room for 20 bytes (error code pushed) </tspan><tspan y="-607.98273" x="95.520004 100.2495 103.521 105.7404 111.0099 116.2794 118.4988 123.1185 127.7985 131.17799 135.8985 139.91699 142.13638 144.73288 149.47498 154.20448 156.42387 161.10478 164.40688 167.67838 172.40788 175.67938 177.89877 181.80928 186.53879 191.20529 195.8862 198.10559 202.77209 207.51419 211.53268 216.27478 220.99529 225.66179">or 18 bytes (no error code pushed)</tspan><tspan y="-595.98303" x="113.52 118.7265 124.5477 129.2952 135.11639 137.3358 143.1273 147.9288 152.6709 155.25031 159.9888 163.23061 166.52011 171.201 174.49051 178.99141 182.91991 187.6674 192.3519 197.03279 199.6122 205.4928 210.17369 217.13429 221.87639 226.67879 228.47789 233.75819 235.5573 240.29849 245.9397 251.0985 253.713 256.29239 258.15268 260.3721 265.1196 267.1608">THEN #SS(error_code(NewSS,0,EXT)); FI;</tspan><tspan y="-583.98334" x="113.52 116.13091 120.17281 122.3922 124.31371 128.9928 132.3867 134.60609 139.28699 143.96608 148.70097 151.94278 156.38248 161.18488 165.80457 168.02396 171.41786 176.09875 178.31815 183.05304 186.29485 189.58075 194.26164 197.54755 202.04845 205.97334 210.71724 215.39813 220.07903 222.29842 224.27031 228.24031 230.45972 235.72021 237.93962 242.59712 247.30862 251.21013 255.67863 260.45312 264.46262 269.1741 271.39349 275.40298 280.11447 282.03598 286.74747 290.64896 294.01947 298.73996 302.00247 304.22186 306.17035 310.17984 312.39923 317.17374 321.18323 325.89471 330.55222 332.77161 336.7901">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-571.98364" x="59.520004 64.254906 66.361809">FI;</tspan><tspan y="-559.98395" x="59.520004 61.627804 66.363602 68.583008 70.504509 75.306915 79.331718 82.717522 85.95932 90.761726 94.678528 98.064331 100.02813 104.70903 109.49883 111.71824 116.33794 121.07914 123.04294 127.78504 131.17084 135.89764 139.13945 141.35884 144.70865 147.95045 152.68625 159.58655 161.80594 163.91374 169.43166 174.62645 176.84584 181.46555 185.96465 189.35045 194.03136 196.25075 198.21455 202.19971 204.4191 209.16119 213.90239 217.28369 219.50308 226.45738 228.41669 231.79799 236.58328 238.54259 243.32788 245.54727 250.28937 255.02968 261.98398 264.2034 268.11569 272.79657 277.46487 282.14575 284.98706 288.94885 293.67114 298.29083 305.24512 309.96741 314.7095 318.06918 320.2886 322.22092 324.18021 331.08054 333.06232 336.4436 340.4639">IF instruction pointer from IDT gate is not within new code-segment limits </tspan><tspan y="-547.98425" x="77.520004 82.704002 88.554001 93.278999 99.128998 101.3484 107.11739 112.3914 117.5124 120.1044 124.8294 130.4904 135.67441 138.2664 140.1384 142.3578 147.03871 149.13931 151.01131 153.23071 155.82271 159.7845 162.00391 166.72891 169.99591 173.26291 177.98792 181.25491 183.47432 187.38033 192.11971 196.73941 201.47972 203.69911 207.6132 212.2941 217.08119 220.46429 224.90399 226.8858 231.6729 235.63469 237.85408 243.71217 249.35338 253.82549 258.26428 260.4837 264.5058 269.18668 271.12079 275.84488 279.75897 283.14206 287.87515 291.11694 293.33636 297.36746">THEN #GP(EXT); FI; (* Error code contains NULL selector *)</tspan><tspan y="-535.98456" x="59.520004 62.903103 67.584007 74.540108 79.159805 83.892906 88.626007 93.098106 98.713203 103.9953 108.7824 111.0018 112.7649 117.894 120.1134 124.8465 129.52739 133.9995 139.61459 144.8967 149.63879">tempEFLAGS := EFLAGS;</tspan><tspan y="-523.98486" x="59.520004 65.209808 71.750107 73.969513 75.735313 80.867111 83.086517 88.306519">VM := 0;</tspan><tspan y="-511.98517" x="59.520004 64.730103 69.411003 71.630402 73.411499 78.512703 80.732101 85.952103">TF := 0;</tspan><tspan y="-499.98547" x="59.520004 64.972206 69.653107 71.872505 73.652702 78.753906 80.973305 86.193306">RF := 0;</tspan><tspan y="-487.98578" x="59.520004 65.377205 70.536003 72.755402 74.517601 79.618797 81.838196 87.110397">NT := 0;</tspan><tspan y="-475.98608" x="59.520004 61.596306 66.337509 68.556908 72.550209 77.245506 80.547607 85.166405 87.098701 90.984001 95.724297 97.943695 101.298 106.1004 109.34669 114.0879 118.8462 123.5253 128.2836 130.50301 132.4848 137.2269 140.6469 145.32779 148.5741 151.87621 156.63451 161.3136 164.66789 166.8873 171.56639 176.00609 179.36038 184.10068">IF service through interrupt gate </tspan><tspan y="-463.98639" x="77.520004 82.693207 88.53241 93.246613 99.085815 101.30521 103.39141 108.10561 110.32501 115.43521 117.65461 122.90881 124.82851 127.04791 131.76212 133.84831">THEN IF = 0; FI;</tspan><tspan y="-451.98669" x="59.520004 64.726501 69.407402 76.377899 80.997604 85.799103 90.541199 92.760597 94.538094 99.639297 101.8587 106.60079 111.40319">TempSS := SS;</tspan><tspan y="-439.987" x="59.520004 64.715706 69.396606 76.356308 80.976006 85.712708 90.50341 95.636108 97.855515 99.622215 104.75491 106.97432 111.71102 116.45312 121.58582">TempESP := ESP;</tspan><tspan y="-427.9873" x="59.520004 64.314301 69.056396 71.275795 73.046097 78.182396 80.401794 86.223 90.963303 97.863602 102.6579 107.45219">SS := NewSS;</tspan><tspan y="-415.98761" x="59.520004 64.249504 69.033005 74.158508 76.377907 78.137405 83.262909 85.482307 91.336807 96.017708 102.97021 107.65111 112.43461 117.56011">ESP := NewESP;</tspan><tspan y="-403.98792" x="59.520004 62.125504 66.087303 68.306709 73.045212 77.783714 79.723213 81.662712 86.401215 93.301514 95.28331 100.02541 104.70451 106.92392 111.54362 116.34602 120.37352 125.11562 129.84512 133.87262 136.09201 140.53171 143.77351 148.50302 150.72241 156.00092 161.22092 163.44031 168.11581 170.04001 173.3979 177.39481 179.61421 182.93611 187.64401 190.94611 193.16551 198.41341 203.6613 206.4792 211.1241 213.06 216.48 218.6994 220.7793 226.3575 231.5244 233.7438 238.3887 242.8878 246.2457 250.98599 254.98289 257.20227 261.70139 266.44348 271.08838 273.30777 278.55566 283.80356 286.02295 290.66785 292.60376 296.02377 299.98557 302.20496 305.52686 310.23474 313.48465 315.70404 320.95193 326.19983 329.01773 333.66263 335.59854 339.01855 341.23795 343.31784 348.83575 354.00266 356.22205 360.86694 365.32285 368.68076 373.42108 377.41797 379.33765">(* Following pushes are 16 bits for 16-bit IDT gates and 32 bits for 32-bit IDT gates; </tspan><tspan y="-391.98822" x="59.520012 64.304413 68.985313 73.65271 80.60611 85.28701 90.089409 93.46981 95.689209 99.708611 104.38951 106.32091 111.0423 114.9537 118.33411 123.06451 126.33691 128.5563 133.22371 137.96581 141.9852 146.72729 151.4487 155.46809 157.68748 159.60899 164.41139 166.63078 171.85078 177.13109 179.97148 184.63889 186.56039 189.92009 192.13948 199.09288 203.82327 208.44298 213.18329 215.40268 219.84238 223.14447 227.82538 230.04477 234.71217 239.15187 243.81927 248.43898 253.16039 257.82779 260.04718 263.42758 268.10849 270.32788 273.70828 280.66168 285.39209 287.61148 294.51178 299.25299 302.52539 307.19278 311.21219 313.43158 317.45999">Segment selector pushes in 32-bit mode are padded to two words *)</tspan><tspan y="-379.98853" x="59.520012 64.668015 69.41011 73.451111 78.257111 80.836517 86.057419 90.863419 93.442825">Push(GS);</tspan><tspan y="-367.98883" x="59.520012 64.668015 69.41011 73.451111 78.257111 80.836517 85.517418 90.323418 92.902824">Push(FS);</tspan><tspan y="-355.98914" x="59.520012 64.668915 69.411018 73.452919 78.259819 80.839226 86.357124 91.099228 93.678635">Push(DS);</tspan><tspan y="-343.98944" x="59.520012 64.668015 69.41011 73.451111 78.257111 80.836517 85.517418 90.323418 92.902824">Push(ES);</tspan><tspan y="-331.98975" x="59.520012 64.665314 69.40741 73.445709 78.249008 80.828407 85.987206 90.668106 97.6287 102.315 107.0571 111.8604 114.4398">Push(TempSS);</tspan><tspan y="-319.99005" x="59.520012 64.681511 69.423607 73.431305 78.204002 80.789703 85.967407 90.677109 97.618805 102.27451 106.99321 111.76591 116.88061 119.46631">Push(TempESP);</tspan><tspan y="-307.99036" x="59.520012 64.641014 69.420013 73.434013 78.213013 80.805016 85.989014 90.705017 97.653015 102.31502 106.99592 111.72092 113.64692 118.11992 122.78192 126.79592 129.38792">Push(TempEFlags);</tspan><tspan y="-295.99066" x="59.520012 64.668015 69.41011 73.451111 78.257111 80.836517 85.517418 90.323418 92.902824">Push(CS);</tspan><tspan y="-283.99097" x="59.520012 64.668015 69.41011 73.451111 78.257111 80.836517 85.517418 87.641418 92.742622 95.361626">Push(EIP);</tspan><tspan y="-271.99127" x="59.520012 64.800316 69.602715 71.822113 73.553711 78.651314 80.870712 86.151009 88.011314 90.230713 92.799316 96.79892 99.018318 103.82072 108.50162 113.18072 120.08102 124.82132 129.56342 132.98341 135.20282 138.44643 143.13902 147.81812 149.79991 153.79051 157.14211 161.8824 165.12421 169.1463 171.36571 178.32631 182.76601 187.4451 192.12599 194.3454 200.226 205.86719 210.36629 214.80508 216.60869 218.82809 220.80989 225.55199 230.23109 234.67079 236.57339 238.55519 243.19379 245.41319 248.77199 253.51318 256.75677 258.97617 263.73175 267.75385 272.49414 274.71353 276.64313 281.44556 283.66495 288.30356 291.60565 296.30725 299.72723 304.41983 308.30243 311.65402 316.39432 321.03293 323.25232 330.21292 334.95413 339.59274 344.33304 346.55243 350.55203">GS := 0; (* Segment registers made NULL, invalid for use in protected mode *)</tspan><tspan y="-259.99158" x="59.520012 64.248611 69.031212 71.25061 73.009209 78.133812 80.35321 85.621811">FS := 0;</tspan><tspan y="-247.99188" x="59.520012 65.098213 69.840309 72.059708 73.801208 78.962708 81.182106 86.4021">DS := 0;</tspan><tspan y="-235.99219" x="59.520012 64.248611 69.031212 71.25061 73.009209 78.133812 80.35321 85.621811">ES := 0;</tspan><tspan y="-223.99249" x="59.520012 64.261215 69.063614 71.283012 73.016411 78.115814 80.335213 85.587616 90.039017 93.392418 98.132721 100.70312 105.44432 110.20172 112.77212 114.69182 116.91122 119.48161 123.48302 125.70242 130.45981 135.2001 139.8405 146.8011 151.4955 156.2979 159.65129 161.8707 166.54979 171.23068 175.22308 179.10748 182.35289 184.33469 189.01378 192.37347 197.07687 200.37898 202.59839 204.52979 209.33218 212.64958 217.39078 220.63618 227.59679 232.04819 235.46819 237.39958 242.14078 246.89818 249.11758 253.61668 255.53819 259.53058 264.23398 266.45337 268.35776 273.09897 277.55035 282.22946 286.92386 291.60297 293.82236 297.82376">CS := Gate(CS); (* Segment descriptor information also loaded *)</tspan><tspan y="-211.9928" x="59.520012 64.239609 69.013206 71.599808 77.021408 82.137009 86.636108 89.22271 91.442108 93.191711 98.307312 100.52671 105.78631">CS(RPL) := 0;</tspan><tspan y="-199.9931" x="59.520012 64.251312 69.378616 73.848915 76.068314 77.829613 82.956909 85.176308 90.447609">CPL := 0;</tspan><tspan y="-187.99341" x="59.520012 61.613411 66.334808 68.554207 70.647606 76.179008 81.359406 83.578804 88.237206 92.706604 96.078003 100.79041 103.0098 104.95921 108.9696 111.189 116.4504 121.7118 124.5432 129.1629 131.1447">IF IDT gate is 32-bit</tspan><tspan y="-175.99371" x="77.520012 82.72921 88.550407 93.300606">THEN</tspan><tspan y="-163.99402" x="95.520012 100.23871 102.32941 107.44411 109.66351 111.41221 116.57371 118.79311 124.06081 128.52751 131.89621 136.60591 139.1916 141.13831 145.91101 149.91872 153.28741 156.54811 161.32082 165.22052 168.58922 170.53592 175.25462 180.02733 182.24673 186.90244 191.62114 193.56784 198.34055 201.70924 206.41895 209.72104 212.30043">EIP := Gate(instruction pointer);</tspan><tspan y="-151.99432" x="77.520012 82.241409 86.701813 91.477211 96.198608 98.418007 101.00641 105.02581 107.24521 109.33861 114.87001 120.05041 122.26981 126.92821 131.39761 134.76901 139.48141 141.70082 143.65022 147.66063 149.88004 155.14143 160.40283 163.23424 167.89264 169.84204 173.21344 175.43285 179.45224">ELSE (* IDT gate is 16-bit *)</tspan><tspan y="-139.99463" x="95.520012 100.24591 102.34381 107.46571 109.68511 111.44101 116.56291 118.78231 124.00321 128.50232 131.87822 136.59512 139.18802 141.10953 145.88943 149.90433 153.28023 156.54813 161.32803 165.23494 168.61084 170.53235 175.25826 180.03816 182.25757 186.87727 191.61848 193.53999 198.34241 201.71831 206.39922 209.66711 212.26001 214.47942 220.08731 225.93822 231.47412 233.69353 238.91353 244.17943 249.44533 254.66533 259.39124 264.11713 268.798 273.5239 279.37479">EIP := Gate(instruction pointer) AND 0000FFFFH;</tspan><tspan y="-127.99493" x="59.520012 64.254913 66.361816">FI;</tspan><tspan y="-115.99522" x="59.520012 61.627811 66.363609 68.583015 73.325119 78.127525 82.56723 87.24633 91.982132 98.882431 103.67223 107.05804 111.54184 115.45864 119.71834 124.39924 129.18904 133.62874 138.30154 140.23834 144.96515 149.58485 152.18765 156.92345 162.05525 166.53006">IF ShadowStackEnabled(CPL)</tspan><tspan y="-103.99552" x="77.520012 82.255814 84.192612 88.86541 93.607513 98.397316 103.52911 105.74852 107.51432 112.64612 114.92583 119.71563 124.50543">oldSSP := SSP</tspan><tspan y="-91.995819" x="77.520012 82.316109 87.058205 92.196304 94.415703 96.187805 101.3259 103.5453 109.41241 114.09331 121.05841 125.80051 130.5966">SSP := NewSSP</tspan><tspan y="-79.996117" x="77.520012 79.61161 84.331207 86.550606 91.324203 96.097801 101.2134 103.4328 109.3764 111.5958 116.8554 121.638 126.8976 132.1572 134.3766 136.1172 141.2328 143.45221">IF SSP &amp; 0x07 != 0</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="450.11432pt" height="644.68219pt" viewBox="0 0 450.11432 644.68219" sodipodi:docname="620.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.03848" inkscape:cy="423.81905" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg152" /><g transform="translate(-45.721138,-69.182129)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="94.68 99.860397 105.70679 110.42819 116.27459 118.49399 124.25939 129.52979 134.64719 137.23558 142.49698 145.08537 146.95377 149.17317 153.89458 155.98798">THEN #GP(0); FI;</tspan><tspan y="-703.98029" x="76.68 79.318794 83.340889 85.560287 90.723587 95.427887 99.746986 104.42789 109.23029 111.44968 115.90199 120.70438 125.34568 127.56508 132.30627 137.10867 138.84297 143.28627 145.36256 150.46286 152.19716 156.93835 158.84366 163.52275 168.28105 173.08345 178.18375 180.40315 185.08224 189.82434 193.81764 198.62004 203.31534 207.99443 210.21384 214.91814 219.72054 221.93994 225.93324 230.69154 235.19064 239.81033 244.55153 251.51213 253.73154 257.72482 261.07913 265.57825 269.47797 273.74127 275.96066 282.92126 287.66336 291.65665 295.01096 297.23035 301.90945 306.64978 308.86917 312.75449 317.4588 322.2612 325.62091 330.07321 332.05502 336.81332 341.55365 346.19495 348.41434 350.39615 355.19855 357.41794 361.87024 364.08963 368.89203 373.33173 376.68604 381.48843 384.73474 389.18704 391.16794 393.08945 397.74875 399.96814 404.42044 406.32574 408.30756 412.92725 417.72964 422.41055 427.08966 429.30905 434.55334 439.83365 442.64795 447.32706 451.98636 455.34067 460.03598 462.25537 465.55746 470.23837 474.91748 476.83899 481.58017 486.32227 488.54166 492.54395">(* Token and CS:LIP:oldSSP pushed on shadow stack must be contained in a naturally aligned 32-byte region *)</tspan><tspan y="-691.98059" x="76.68 78.767097 83.482201 85.701599 88.283699 93.052795 97.821899 102.933 105.1524 111.0915 113.3109 118.431 123.6861 128.4642 133.7193 138.4344 141.07321 143.29262 145.02872 150.13982 152.35922 154.94133 157.52344 162.29254 167.06165 172.22314">IF (SSP &amp; ~0x1F) != ((SSP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-691.97998" x="174.42">–</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-691.97998" x="179.22 181.43939 186.70799 191.92799 194.52359 196.74298 202.69559 204.91498 210.04858 215.31718 220.05478 225.33508 230.01599"> 24) &amp; ~0x1F)</tspan><tspan y="-679.98029" x="94.680298 100.4322 105.68909 110.85059 113.42999 118.67789 121.25279 123.17249 125.39188 130.09978 132.17967">#GP(0); FI;</tspan><tspan y="-667.98059" x="58.619999 60.722401 65.452805 67.672203 70.2696 72.866997 74.969398 80.581802 85.801804 91.072205 95.631607 100.31251 105.05371 109.73461 115.19402 116.90942 121.37881 127.91911 133.49911 135.71851 140.1969 144.939 149.6064 151.82579 156.55618 161.29828 163.01367 167.48308 170.08047 172.29987 177.42627 179.64566 184.91606 187.13545 192.74785 198.60324 204.14365 206.36304 211.10513 215.90753 221.03394 223.80234 229.07274 234.29274 236.05315 241.27315 246.54355 249.31195 251.53134 253.28275 258.40915 260.62854 265.89893">IF ((IA32_EFER.LMA and CS.L) = 0 AND SSP[63:32] != 0)</tspan><tspan y="-655.9809" x="76.680298 81.860695 87.707092 92.42849 98.274887 100.49429 106.25969 111.53009 116.64749 119.23589 124.49729 127.08569 128.95409 131.17349 135.8949 137.9883">THEN #GP(0); FI;</tspan><tspan y="-643.9812" x="58.619995 63.360294 68.158195 72.798599 77.538895 81.423294 84.776695 89.4711 94.1502 98.711403 102.07111 106.81231 111.07201 115.7664 120.5688 125.13 129.74881 134.20021 136.18112 140.93852 145.67882 147.89822 152.99762 155.21703 159.97443 164.77682 169.87622 172.09563 174.66603 178.66743 180.88684 185.56593 190.30803 194.33012 199.01013 201.22954 205.90863 207.83012 211.18352 213.40292 216.28383 218.50323 223.14363 225.12543 228.47882 230.69823 235.33862 240.07982 244.10191 246.02341 249.44341 251.3649 256.10611 260.84824 263.06763 268.34793 270.56732 273.38074 275.60013 282.56073 287.30283 291.32492 294.6846 296.90399 301.5831 306.26401 308.4834 312.3678 314.27219 319.01248 323.45218 326.75427 328.97366 332.97507">expected_token_value = SSP (* busy bit - bit position 0 - must be clear *)</tspan><tspan y="-631.98151" x="58.619995 63.422398 68.103302 75.063904 79.625107 82.979408 87.720612 91.98391 96.724205 101.48251 106.01581 110.63911 115.13821 117.0435 121.8018 126.5421 128.76151 133.8618 136.08121 140.83951 145.64191 150.7422 152.96161 154.94341 157.16281 162.46111 168.1626 172.965 178.06619 182.59949 187.85999 189.95068 195.12839 197.34779 199.98659 204.00868 206.22809 211.00079 215.71049 219.07919 221.2986 224.6673 229.44 234.1497 236.36911 241.02481 245.79752 249.80522 254.47893 256.6983 261.354 263.30069 266.6694 268.88879 272.90549">new_token_value = SSP | BUSY_BIT (* Set the busy bit *)</tspan><tspan y="-619.98181" x="58.619995 60.721497 65.450996 67.670395 71.688896 76.431 80.908501 85.528198 90.257698 97.210197 101.7111 105.7332 109.1127 113.5902 117.5007 121.7892 126.3477 128.2782 133.00771 136.91821 141.20671 145.76521 149.67572 156.57602 161.24252 166.0197 169.9068 174.6669 179.34599 184.62628 189.26938 191.84248 196.64488 201.38698 206.54848 208.34758 210.56699 215.36938 220.05028 227.01086 231.51176 234.93176 239.61266 243.93176 248.61266 253.41505 257.91595 262.59503 267.03473 268.94183 273.74423 278.44135 280.29987 282.51926 287.21637 291.98547 296.62857 301.3689 305.25598 308.61209 313.35242 317.97211 322.5072 325.86331 330.60449 334.8642 339.60452 344.34662 348.88171 353.50681 358.00592 359.92743 364.68753 369.42786 372.00095 374.22034 375.94745 381.04956 383.26895 388.00928 392.74689 397.42599 402.16632 406.05341 409.40952 414.10663 418.78574 423.32083 426.67694 431.38306 435.70215 440.39926 445.20166 449.73676 454.36185 458.81595 460.72305 465.52545">IF shadow_stack_lock_cmpxchg8b(SSP, new_token_value, expected_token_value) != expected_token_value</tspan><tspan y="-607.98212" x="76.679405 81.859802 87.7062 92.427597 98.273994 100.49339 106.2588 111.5292 116.6466 119.235 124.4964 127.0848 128.9532 131.17261 135.89401 137.98741">THEN #GP(0); FI;</tspan><tspan y="-595.98242" x="76.679405 78.778206 83.505005 85.724403 90.451202 92.379005 96.998711 101.80111 106.58191 108.29371 113.83051 118.95331 123.41911 125.6385 127.38631 132.50911 134.72852">IF oldSS.DPL != 3</tspan><tspan y="-583.98273" x="94.679405 97.266907 101.28541 103.50481 108.6843 113.4588 118.1703 122.1798 126.8913 129.1107 133.12021 136.49071 140.95921 144.86072 149.14021 151.35962 156.01712 160.79163 164.80113 169.57564 174.28714 178.29665 180.51605 184.52556 189.30006 194.02057 198.79507 200.71657 205.37407 207.59348 212.36798 217.08849 220.45898 222.67839 226.5799 231.0484 235.82291 239.83241 244.54391 246.76332 250.06273 254.57971 259.3497 261.26669 264.63269 268.6377 270.49619 272.71558 278.38559 284.9556 287.17499 291.88199 296.66098 298.60498 301.97098 305.97598 307.83447 310.05386 314.76987 318.07196 320.29135 324.94437 329.40836 332.77435 337.23834 339.45773 344.11075 347.36874 352.07574 356.53973 360.85883 365.47855 370.19455 372.13855 376.90854 380.27454 384.27954 386.49893 390.51294">(* These stack pushes should not cause faults, VM exits, or data breakpoints *)</tspan><tspan y="-571.98303" x="94.679413 97.318214 101.34032 103.55972 108.33241 113.10511 117.00481 121.7775 123.9969 128.7066 133.3443 138.054 142.82671 146.1954 150.20311 152.42252 159.36421 161.31091 163.23061 165.1503 167.36971 171.83641 176.49211 181.14781 183.0675 187.74121 189.96062 193.32932 198.04802 200.26743 203.63612 208.40883 213.11853 215.33794 220.04764 224.51971 227.76152 229.68301 231.65042 236.33133 239.61273 241.83212 246.27182 250.19221 254.11261 258.84302 262.80484 266.82697 271.55737 275.58578 277.80518 281.19458 285.87549 288.09488 291.48428 296.22638 300.95679 303.17618 306.56558 311.24649 315.54489 320.2258 325.0192 326.8183 329.03769 336.00009 340.74219 342.70959 346.63 351.3721 353.57971 355.53 359.54129 361.76071 363.711 368.4873 370.70673 374.07904 378.85535 383.56863 385.78806 389.79935 394.26965 401.21497 405.92825 408.14767 413.40997 418.67227 421.50458 426.16388 430.84119 434.2135 438.92679 441.14621 444.41052 449.12381 453.78311 455.7334 460.45569 465.23199 467.45142 471.47171">(* Such events will apply to the earlier accesses to the token, which is in the same 32-byte region *)</tspan><tspan y="-559.98334" x="94.679413 99.468315 104.25722 108.69692 113.36882 118.04972 125.00762 129.74973 133.13463 137.57433 141.49022 145.78412 150.91502 155.65712 159.68102 164.42311 169.69801 175.02692 177.62881 182.30971 184.24561 188.86531 193.6002 198.3423 200.9442 202.8261 205.04549 207.64738 211.68028 213.89967 219.03058 223.47028 228.14218 232.81409 237.495 242.1669 244.38629 251.28659 253.2684 256.65329 261.4422 263.66162 268.88162 274.16193 276.38135 281.12344 283.10522 287.72495 292.52734 295.37225 300.10715 303.38403 308.05594 312.73682 316.03891 318.25833 322.87805 324.85983 328.24472 332.26862 334.48804 339.16895 342.52774 344.74716 350.02206 352.24149 356.27438">ShadowStackPush8B(oldCS); (* Padded with 48 high-order bits of 0 *)</tspan><tspan y="-547.98364" x="94.679413 99.474609 104.26981 108.7095 113.3877 118.0686 125.03281 129.7749 133.16611 137.6058 141.528 145.7877 150.92491 155.66701 159.6972 164.4393 169.7205 175.05571 177.66391 182.3448 184.287 188.90671 193.6479 198.39 203.7252 209.30521 214.1004 218.7813 221.00069 226.19189 228.41129 233.15248 235.09468 239.77289 245.15941 247.25011 252.36481 254.9505 256.87018 259.08957 261.67526 265.69196 267.91135 273.02606 277.49277 282.14847 286.80417 291.51385 296.16956 298.38895 305.33066 307.27734 310.64606 315.41876 317.63815 322.89685 328.15555 330.37494 335.14764 337.09433 341.75003 346.52274 349.35144 354.07013 357.33084 361.9794 366.68549 369.9426 372.16199 376.81409 378.7572 382.12231 386.1264 388.34579 393.06088 396.38998 398.60938 403.86447 406.08386 409.41296 414.12805 417.38516 419.60455 424.85965 430.11475 432.33414 436.98624 438.92932 442.34933 444.56873 449.02283 451.10992 456.22104 460.23413">ShadowStackPush8B(oldCSBASE + oldRIP); (* Padded with 32 high-order bits of 0 for 32 bit LIP*)</tspan><tspan y="-535.98395" x="94.679382 99.47818 104.27698 108.71667 113.39848 118.07938 125.04718 129.78928 133.18408 137.62378 141.54958 145.80928 150.95007 155.69217 159.72597 164.46806 169.75287 175.09167 177.70348 182.38437 184.33017 188.94986 193.74866 198.49075 203.63155 206.24335">ShadowStackPush8B(oldSSP);</tspan><tspan y="-523.98425" x="76.679382 81.414284 83.521187">FI;</tspan><tspan y="-511.98456" x="58.61908 63.353981 65.460884">FI;</tspan><tspan y="-499.98486" x="58.61908 60.693581 65.434776 67.654175 72.39537 77.137474 81.816574 86.436279 89.73838 94.178078 98.980476 102.88017 107.63667 112.37787 117.13437 121.63347 126.31257 128.23407 132.92757 137.60666 139.82607 142.39557 147.09807 152.25957 156.69836">IF EndbranchEnabled (CPL)</tspan><tspan y="-487.98517" x="76.679382 78.770981 84.372581 89.592583 94.872879 99.421478 104.19508 108.74368 113.46327 118.14418 123.36238 125.06698 130.24557 135.66718 141.26877 145.98837 151.23897 155.95857 161.38017 163.59958 168.71518 170.93909 178.24529 183.85048 185.94568 191.12788 195.62878 200.37 206.0679 211.5273 216.0795 220.76041 226.60861 232.14182 237.42302 242.88242 248.48761 254.33582 259.05902 264.90723">IA32_S_CET.TRACKER = WAIT_FOR_ENDBRANCH;</tspan><tspan y="-475.98547" x="76.67939 78.773689 84.377991 89.597992 94.878288 99.429588 104.20589 108.75719 113.47948 118.16039 123.37859 125.08588 129.86218 135.50339 140.66489 145.78319 151.20749 155.92979 160.7061 165.48241 167.70181 172.82011 175.03952">IA32_S_CET.SUPPRESS = 0</tspan><tspan y="-463.98578" x="58.619087 63.353989 65.460892">FI;</tspan><tspan y="-451.98608" x="45.119087 47.724586 51.761086 53.980484 58.722584 62.142586 66.582291 69.824097 73.212601 75.432007 80.112907 84.910805 89.591705 93.491409 98.283913 101.67242 103.63892 108.31982 113.11232 115.33173 120.01263 123.37143 125.59084 130.38333 135.06424 142.02574 144.24513 147.48694 152.22813 156.97023 160.32994 162.29645 167.03854 171.76805 173.98744 175.90895 180.71135 182.93074 188.06525 191.34575 196.02664 199.38635 204.11586 208.03535 211.42386 216.15337 220.77307 222.99246 229.58496 234.26585 238.94136 243.62227 245.84166 249.87816">(* Start execution of new routine in Protected Mode *)</tspan><tspan y="-439.98639" x="45.119087 49.813488 55.694088 61.198486">END;</tspan><tspan y="-415.98608" x="45.119087 47.200787 53.035488 58.204189 63.663589 69.255287 72.074989 77.180687 82.640083 84.721786 90.38549 92.467194 96.915894 101.6256 106.88429 111.59399 114.4749 118.9236 123.6333 129.297 134.0067 138.4554 141.2751 143.3568 149.2374 154.4061 159.1158 164.5752 169.97519 175.64789 180.75359 185.92229">INTRA-PRIVILEGE-LEVEL-INTERRUPT:</tspan><tspan y="-403.98639" x="58.619087 64.492485 69.173386 76.144783 80.886879 85.689278 90.790482 93.00988 98.154282 100.37368 105.11578 109.91817 115.01938">NewSSP = SSP;</tspan><tspan y="-391.98669" x="58.619087 63.341389 69.18869 73.910988 78.633286 83.853287 88.404587 93.180885 97.922981 102.48418 107.66548 113.39578 118.61578 123.35698 129.20428 131.42369 136.54199 138.7614">CHECK_SS_TOKEN = 0</tspan><tspan y="-379.987" x="58.619087 61.257885 65.279984 67.499382 72.593384 77.291382 79.51078 84.672279 86.891678 92.129677 93.988182 96.207581 101.71558 106.80959 111.24658 113.46598 118.62748 120.84688 125.54488 130.63887 135.13797 137.35738 142.05537 145.35748 147.57689 151.45589 156.15388 160.95628 164.31508 169.01308 172.31519 179.23619 181.21799 185.96999 190.64908 192.86848 196.89058 201.57147 206.25056 213.15086 217.89116 222.63326 226.05327 228.27267 232.26868">(* PE = 1, DPL = CPL or conforming segment *)</tspan><tspan y="-367.9873" x="58.619087 60.717888 65.444687 67.664085 69.762886 75.371689 80.638489 85.85849 90.414291 95.14109 99.867889 104.54879 109.97759 111.68939 116.15519 122.73599 128.34479 130.56418 135.68698 137.90637 143.17317 145.39258 147.98637 152.01117 154.23056 156.32936 161.93816 164.77496 169.99496 175.26176 179.97957 182.19897 189.14877 193.87558 198.49529 203.2356 205.45499 209.47978">IF IA32_EFER.LMA = 1 (* IA-32e mode *)</tspan><tspan y="-355.98761" x="76.67939 78.77639 83.501389 85.720787 87.817787 93.352783 98.536781 101.37178 105.99149 110.73179 114.69359 118.59328 121.86028 123.81329 128.47528 131.85028 136.57529 139.84229 142.06169 144.15869 148.9377 154.1217">IF IDT-descriptor IST </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-355.98761" x="156.29968">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-355.98761" x="161.21999 163.43939"> 0</tspan><tspan y="-343.98792" x="94.680283 99.889481 105.71068 110.46088">THEN</tspan><tspan y="-331.98822" x="112.68028 117.86608 122.64688 127.42768 131.44348 134.82028 139.29507 143.20288 147.48868 153.09747 157.76128 162.38098 165.62279 170.34059 174.35638 178.37218 180.59158 182.34839 187.47119 189.69058 192.28438 194.38318 199.91998 205.10579 207.9426 212.51999 217.26028 221.28239 225.1776 228.43379 230.37599 235.02719 238.39139 243.10559 246.36179 248.58119 250.66739 255.46979 260.64297 262.86237 268.26056 270.47995 275.73416 278.31537 280.53476 285.69897 287.91837 293.17258 298.42679">TSSstackAddress := (IDT-descriptor IST « 3) + 28;</tspan><tspan y="-319.98853" x="112.68029 114.77909 119.50589 121.72529 124.31909 129.5049 134.28571 139.0665 143.02829 146.40509 150.87988 154.78769 159.07349 164.68228 169.30199 173.96579 177.23459 181.95239 185.91418 189.92998 192.14938 197.32619 199.54559 204.81239 207.40619 209.62558 214.65839 216.87778 222.06358 226.84439 231.62518 233.84457 235.77237 237.72717 244.67697 246.63177">IF (TSSstackAddress + 7) &gt; TSS limit</tspan><tspan y="-307.98883" x="130.6803 135.8508 141.6873 146.3988 152.23531 154.45471 160.21021 165.38071 170.18311 172.76251 177.50281 180.7563 184.0098 188.7213 191.97479 196.51529 200.40779 205.11929 209.76779 214.50809 217.08659 220.9791 225.78149 229.03499 232.28848 237.02878 241.79428 245.21428 247.43369 252.60419 257.36969 262.17209 264.39148 268.39197 273.09448 275.00699 279.74731 283.6398 287.00131 291.7128 294.96631 296.77982 302.03131 303.84482 308.5563 314.2038 319.422 322.00049 324.57898 326.43747 328.65686 333.36835 335.45184">THEN #TS(error_code(current TSS selector,0,EXT)); FI;</tspan><tspan y="-295.98914" x="130.6803 133.2822 137.31509 139.53448 141.45599 146.1351 149.52 151.7394 156.47429 161.09399 165.8199 169.06171 173.5014 178.3038 182.97571 185.1951 188.58 193.26089 195.48029 200.20619 203.448 206.7249 211.40579 214.68269 219.18359 223.09949 227.83438 232.50629 237.18719 239.40659 241.36949 245.39339 247.61278 252.83278 255.05217 259.72406 264.40494 268.32083 272.80374 277.54584 281.56793 286.29382 288.51324 292.47504 297.21533 299.15125 303.83212 307.74802 311.1329 315.81381 319.11591 321.33533 323.25681 327.2789 329.49832 334.24042 338.26251 342.9884 347.60812 349.82755 353.86044">(* idt operand to error_code is 0 because selector is used *)</tspan><tspan y="-283.98944" x="112.6803 118.52579 123.2373 130.1808 135.6033 140.37781 145.49431 147.71371 149.46422 154.58072 156.80013 162.06062 164.28003 168.93753 173.61304 176.98354 181.69504 185.70454 187.92395 189.84544 194.56595 199.03445 203.69196 208.40346 213.06096 215.28036 218.61487 221.87737 226.59787 233.54137 235.76077 238.34827 242.24977 247.02428 250.2606 253.5213 258.23099 263.00369 266.37241 268.5918 273.7695 278.54221 283.31491 285.5343 290.19 294.65671 298.6644 303.37408 305.59348 310.76218 312.98157 318.15927 322.93198 327.70468 331.71237 335.08109 339.54779 343.44748 347.72519 353.3259 357.9816 362.60129 365.90341 370.6131 374.62079 378.62848 381.21417">NewRSP := 8 bytes loaded from (current TSS base + TSSstackAddress);</tspan><tspan y="-271.98975" x="94.680313 99.410713 103.84951 108.63391 113.36431 115.58371 121.40491 126.08581 133.03922 138.43922 143.22362 148.35002 150.56941 152.32982 157.45622 159.67561 165.07562 169.87802 175.00443 176.88182">ELSE NewRSP := RSP; </tspan><tspan y="-259.99005" x="76.680313 81.415215 83.522118">FI;</tspan><tspan y="-247.99036" x="76.680313 78.777313 83.502312 85.72171 87.81871 93.353714 98.537712 101.37271 105.99242 110.73272 114.69452 118.59422 121.86121 123.81422 128.47621 131.85121 136.57622 139.84322 142.06262 144.15962 148.93863 154.12263">IF IDT-descriptor IST </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-247.99036" x="156.30061">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-247.99036" x="161.22092 163.44032"> 0</tspan><tspan y="-235.99066" x="94.681213 96.790817 101.52842 103.74783 108.53943 113.28153 117.76714 122.38683 127.12444 134.02473 138.81633 142.20393 146.68953 150.60812 154.86783 159.60902 164.35112 168.85022 173.46992 175.39142 180.12003 184.73973 187.34433 192.08192 197.21553 201.69212">IF ShadowStackEnabled(CPL)</tspan><tspan y="-223.99097" x="112.68121 117.89041 123.71161 128.46181">THEN</tspan><tspan y="-211.99127" x="130.68121 136.50961 141.20401 148.13042 152.93282 157.69022 162.78961 168.42902 173.04871 177.7278 180.9696 185.7099 189.73199 193.7244 195.9438 201.1053 203.32471 205.4001 211.03951 216.2829 221.52631 226.0587 228.13409 233.96249 239.12489 243.82829 249.23369 254.69308 260.33429 265.49579 270.6546 275.18701 279.9444 284.7468 289.86151 294.40381 299.57611 305.17142 310.47873 314.93103 319.64432 324.18661 329.78192 335.30524 340.82855 346.28796 348.50735 353.67065 355.89005 358.47034 360.55563 366.07892 371.25122 373.47061 378.12091 382.58221 385.94553 390.64984 392.86923 394.95453 399.72183 404.94003 407.15942 412.55673 414.77612 420.02942">NewSSPAddress = IA32_INTERRUPT_SSP_TABLE_ADDR + (IDT gate IST « 3)</tspan><tspan y="-199.99158" x="130.6812 136.5114 141.2076 148.1358 152.9382 157.6974 162.7986 165.01801 166.81981 171.92101 174.14041 179.3856 181.60501 186.2841 190.96411 194.31931 199.0596 203.0538 205.27321 207.17941 211.88461 216.38371 220.9809 225.71489 230.33458 232.55397 235.91096 239.15277 243.89577 250.79607 253.01546 258.88345 263.56436 270.53036 275.27246 280.06946 285.20847 290.83347 295.45316 300.13315 303.37494 308.10895 312.07077">NewSSP := 8 bytes loaded from NewSSPAddress</tspan><tspan y="-187.99188" x="130.68118 135.37378 141.25438 145.94698 150.68817 155.91177 160.47298 165.27538 170.01747 174.57867 179.73747 185.49568 190.71568 195.45688 201.27808 203.49747 208.58606 210.80545">CHECK_SS_TOKEN = 1</tspan><tspan y="-175.99219" x="94.681183 99.416084 101.52299">FI;</tspan><tspan y="-163.99249" x="76.681183 81.416084 83.522987">FI;</tspan><tspan y="-151.9928" x="58.62088 63.355782 65.462685">FI;</tspan><tspan y="-139.9931" x="58.62088 60.724182 65.455482 67.674881 72.946182 78.166183 81.007484 85.675781 87.635078 91.01638 93.235779 97.855476 102.35458 105.73588 110.41678 112.63618 115.23447 119.26377 121.48317 123.40466 130.36526 134.98497 136.90646 138.86577 143.54668 147.56697 149.78636 151.88966 157.50296 162.77426 168.04556 172.54646 177.27777 182.00906 186.68996 192.12326 193.83955 198.30986 204.89516 210.50845 212.72784 217.85515 220.01424 225.28554 227.50493 231.53423">IF 32-bit gate (* implies IA32_EFER.LMA = 0 *)</tspan><tspan y="-127.9934" x="76.681183 81.890381 87.711578 92.461777">THEN</tspan><tspan y="-115.9937" x="94.681183 96.765579 101.47798 103.69739 107.59079 112.3932 115.6476 118.902 123.6423 128.40871 131.8287 134.04811 138.04951 141.46951 145.92992 149.82332 154.09471 156.31412 160.96352 165.67592 170.37932 174.38072 176.60013 181.36653 186.07893 189.44133 191.66074 196.46313 200.90283 205.53423 210.27452 212.49393 215.74832 220.46072 225.17313 232.08148 234.30087 237.64708 242.32797 245.60217 247.82156 253.04156 258.32184 260.54123 265.21042 269.89761 273.27982 277.96072 281.98193 284.20132 286.80054 291.52374 294.79794 298.07214 302.80435 306.07855 308.29794 312.21115 316.89206 321.56125 326.24216 328.46155 333.13074 337.87283 341.89404 346.68024 351.36115 356.04022 358.63943">IF current stack does not have room for 16 bytes (error code pushed) </tspan><tspan y="-103.994" x="94.681183 99.400787 102.66238 104.88178 110.14138 115.40098 117.62038 122.27698 126.95158 130.32118 135.06148 139.07008 141.28949 143.87608 148.64969 153.36929 155.5887 160.32899 163.59059 166.85219 171.57179 174.83339 177.0528 180.9534 185.673 190.32961 195.04021 197.25961 201.91621 206.68982 210.69843 215.50082 220.21143 224.86803">or 12 bytes (no error code pushed)</tspan><tspan y="-91.994293" x="112.68118 117.89938 123.72059 128.43208 134.26859 136.48799 142.24348 147.04588 151.81139 154.38989 159.10139 164.7489 169.9671 172.54651 174.40501 176.62442 181.33592 183.41942 185.33913 187.55853 190.13704 194.14655 196.36595 201.07745 204.37955 207.63304 212.34454 215.59804 217.81744 221.70995 226.42145 231.06995 235.81024 238.02965 241.92215 246.63365 251.43605 254.79575 259.29486 261.21637 266.01877 269.98056 272.19995 278.08054 283.78204 288.23254 292.68304 294.90244 298.90292 303.60544 305.51794 310.25827 314.15076 317.51227 322.22375 325.47726 327.69666 331.70615">THEN #SS(EXT); FI; (* Error code contains NULL selector *)</tspan><tspan y="-79.994591" x="76.681183 81.40168 85.861183 90.635681 95.356178 97.575577 99.616776 104.35797 106.57737 111.83787 117.09837 119.97926 124.59896 126.54746 129.91797 132.13737 136.79488 141.26338 144.63388 149.34538 151.56479 154.15228 158.17078 160.39018 162.33868 169.32088 173.95317 175.84947 177.83127 182.51216 186.53426 188.75365 190.85425 196.49365 201.72896 207.00926 211.57047 216.25136 220.99255 225.67345 231.13284 232.81314 237.31224 243.85254 249.42984 251.64923 256.81073 259.03012 264.26541 266.4848 270.47809 273.04037">ELSE IF 16-bit gate (* implies IA32_EFER.LMA = 0 *) </tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="450.57544pt" height="644.69208pt" viewBox="0 0 450.57544 644.69208" sodipodi:docname="621.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.64039" inkscape:cy="423.77366" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg136" /><g transform="translate(-46.019707,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="95.519997 97.599899 102.3078 104.5272 108.4161 113.2185 116.4684 119.7183 124.4586 129.22049 132.57838 134.79779 138.79469 142.15259 146.65169 150.55139 154.8183 157.0377 161.6826 166.3905 171.1308 175.15291 177.37231 182.13422 186.84212 190.20001 192.41942 197.22182 201.66151 206.28842 211.02872 213.24812 216.49802 221.20592 225.91382 232.84471 235.06412 238.38602 243.09392 246.39601 248.61542 253.86331 256.0827 260.7276 265.3905 268.74841 273.48874 277.48563 279.70502 282.34381 287.02472 290.27463 293.57672 298.28461 301.5867 303.80609 307.69498 312.40286 317.04776 321.78809 324.00748 328.65237 333.45477 337.45166 342.25406 346.99438 351.61407 354.18896">IF current stack does not have room for 8 bytes (error code pushed) </tspan><tspan y="-703.98029" x="95.519997 100.254 103.53 105.7494 111.0234 113.2428 117.9138 122.6028 125.9868 130.66771 134.6907 136.9101 139.51109 144.29909 148.97998 151.19937 155.92438 159.20038 162.47638 167.15727 170.43327 172.65266 176.56766 181.24855 185.91956 190.60046 192.81985 197.49086 202.27885 206.24065 211.04305 215.72395 220.40306">or 6 bytes (no error code pushed)</tspan><tspan y="-691.98059" x="113.52 118.7382 124.5594 129.2709 135.10741 137.32681 143.08231 147.8847 152.65021 155.22871 159.94022 165.58772 170.75822 173.39703 175.25554 177.47495 182.18645 184.26994 186.12845 188.34785 190.98666 195.00877 197.22818 201.93968 205.24178 208.49527 213.20677 216.46027 218.67967 222.57217 227.28368 231.93217 236.67247 238.89188 242.78438 247.49588 252.29828 255.65797 260.15707 262.07858 266.88098 270.84277 273.06216 278.94275 284.58395 289.08307 293.52188 295.74127 299.74176 304.44427 306.35678 311.09711 314.98959 318.3511 323.06259 326.3161 328.53549 332.54498">THEN #SS(EXT); FI; (* Error code contains NULL selector *)</tspan><tspan y="-679.9809" x="77.519997 82.244095 86.707199 91.485298 96.209396 98.428795 101.0199 105.042 107.2614 109.3575 114.9636 120.1836 125.4639 130.017 134.7411 139.42201 144.16322 149.58932 151.29843 155.76154 162.30183 167.90793 170.12733 175.24744 177.46684 182.73094 184.55704 186.77644 192.04054 197.26054 200.09465 204.75575 206.70786 210.08195 212.30136 216.92107 221.42017 224.79427 229.47517 233.49727">ELSE (* IA32_EFER.LMA = 1, 64-bit gate*)</tspan><tspan y="-667.9812" x="113.52 115.5936 120.33479 122.55419 128.3808 133.12109 140.0457 145.5051 150.2607 155.4222 157.6416 161.5242 166.2258 171.0282 174.38789 178.83749 180.81929 185.57489 189.56549 191.7849 196.284 198.5034 203.259 208.0002 212.7558 215.6367 219.5193 223.9689 228.7713 233.45219 238.25459 240.17609 244.05869 248.55779 250.46039 252.67979 257.12939 261.8085 266.44711 269.74921 274.4418 278.4324">IF NewRSP contains a non-canonical address</tspan><tspan y="-655.98151" x="131.51999 136.73819 142.55939 147.27449 153.11459 155.334 161.09309 165.89549 170.6646 173.2467 177.96181 183.61292 188.78702 191.42583 193.28793 195.50734 198.08945 202.10255 204.32196 209.03706 212.29416 215.55125 220.26636 223.52345 225.74286 229.63896 234.35406 239.00616 243.71227 245.93167 249.82777 254.54288 259.31198 262.67709 267.17621 269.09772 273.90012 277.92221 280.1416 285.98169 291.65979 296.11389 300.56799 302.78738 306.79147 311.53177 313.44788 318.15399 322.05008 325.41519 330.13028 333.38739 335.60678 339.61987">THEN #SS(EXT); (* Error code contains NULL selector *)</tspan><tspan y="-643.98181" x="77.519989 82.25489 84.361794">FI;</tspan><tspan y="-631.98212" x="59.519989 64.25489 66.361794">FI;</tspan><tspan y="-619.98242" x="59.519989 61.61879 66.345589 68.564987 71.158791 73.257591 78.866394 84.133194 89.399994 93.900894 98.627693 103.35449 108.03539 113.4642 115.17599 119.64179 126.2226 131.83139 134.05078 139.17358 141.39297 146.65977 149.25357 151.47296 154.06676 158.09155 160.31094 166.16275 170.84366 174.22046 176.43985 178.53865 184.14745 186.98425 192.25105 197.47105 202.21136 204.43076 211.33105 216.07227 220.73607 225.41698 227.63638 231.66118">IF (IA32_EFER.LMA = 0) (* Not IA-32e mode *)</tspan><tspan y="-607.98273" x="77.519989 82.729187 88.550385 93.300583">THEN</tspan><tspan y="-595.98303" x="95.519989 97.626892 102.36179 104.5812 106.5027 111.3051 115.329 118.71391 121.9557 126.7581 130.674 134.0589 136.0218 140.7027 145.49159 147.71098 152.33069 157.07188 159.03479 163.77689 167.16179 171.8877 175.1295 177.34889 180.6978 183.93961 188.6745 195.5748 197.79419 199.90109 205.41901 210.6129 212.83229 217.452 221.9511 225.336 230.01691 232.20029 234.15959 238.17989 240.39928 245.14137 249.88258 253.26389 255.48328 262.43756 264.39685 267.77814 272.56345 274.52274 279.30804 281.52747 286.31277 290.99365 297.94794 300.16736 304.07965 308.76053 313.42883 318.10971 320.95102 324.91281 329.6351 334.25479 341.20911 345.9314 350.67349 354.03317 356.25259 358.18491 360.1442 367.09851 369.0578 372.43909">IF instruction pointer from IDT gate is not within new code-segment limit </tspan><tspan y="-583.98334" x="113.51999 118.73819 124.55939 129.27089 135.10739 137.3268 143.08229 148.34279 153.45029 156.02879 160.7403 166.3878 171.5583 174.19711 176.05562 178.27502 182.98653 185.07002 186.92853 189.14793 191.78674 195.80885 198.02826 202.73976 206.04185 209.29535 214.00685 217.26035 219.47975 223.37225 228.08376 232.73225 237.47255 239.69196 243.58446 248.29596 253.09836 256.45807 260.91757 262.89938 267.70178 271.66357 273.88297 279.76355 285.40475 289.90387 294.34268 296.56207 300.56256 305.26508 307.17758 311.91791 315.81039 319.17191 323.88339 327.1369 329.35629 333.36578">THEN #GP(EXT); FI; (* Error code contains NULL selector *)</tspan><tspan y="-571.98364" x="77.519989 82.25489 86.72879 91.517693">ELSE</tspan><tspan y="-559.98395" x="95.519989 97.626892 102.36179 104.58209 106.50449 111.30779 115.3317 118.7166 121.9593 126.7626 130.6785 134.0634 136.02631 140.7081 145.49699 147.71729 152.33789 157.07999 159.04289 163.78589 167.17079 171.8967 175.1394 177.3597 180.7086 183.95131 188.6862 195.5874 197.80769 199.9146 205.4595 210.6534 212.87369 217.49429 221.99429 225.3792 230.061 232.2813 236.19719 240.93208 245.72098 249.10588 253.54648 255.52919 260.27219 264.2952 266.5155 270.95612 273.17642 277.96533 282.70023 287.44324 290.26474 294.18063 298.66354 303.40656 308.14865 312.93756 314.85995 318.77585 323.25876 325.19467 327.41498 331.85559 336.53558 341.15619 344.45917 349.14096 353.16397">IF instruction pointer from IDT gate contains a non-canonical address</tspan><tspan y="-547.98425" x="113.51999 118.73819 124.55939 129.27089 135.10739 137.3268 143.08229 148.34279 153.45029 156.02879 160.7403 166.3878 171.5583 174.19711 176.05562 178.27502 182.98653 185.07002 186.92853 189.14793 191.78674 195.80885 198.02826 202.73976 206.04185 209.29535 214.00685 217.26035 219.47975 223.37225 228.08376 232.73225 237.47255 239.69196 243.58446 248.29596 253.09836 256.45807 260.91757 262.89938 267.70178 271.66357 273.88297 279.76355 285.40475 289.90387 294.34268 296.56207 300.56256 305.26508 307.17758 311.91791 315.81039 319.17191 323.88339 327.1369 329.35629 333.36578">THEN #GP(EXT); FI; (* Error code contains NULL selector *)</tspan><tspan y="-535.98456" x="95.519989 100.95779 105.69989 110.83169 113.05109 114.81689 119.94869 122.1681 128.0289 132.75571 139.65601 145.11542 149.85751 155.01901 157.2384 163.1982 165.41759 170.09848 174.83427 179.57007 184.25096 188.98676 193.66765 198.40344 203.13924 207.82013 212.55592 217.29172 221.97261 226.7084 231.4442 236.12509 241.40089 247.26169">RSP := NewRSP &amp; FFFFFFFFFFFFFFF0H;</tspan><tspan y="-523.98486" x="59.519989 64.25489 66.361794">FI;</tspan><tspan y="-511.98517" x="59.519989 61.616989 66.341988 68.561386 70.658386 76.19339 81.377388 83.596786 88.258789 92.698486 96.073486 100.78949 103.00889 104.93039 108.95249 111.17189 116.43689 121.70189 124.53689 129.15659 131.13838 134.51338 136.73279 139.32478 143.34778 145.56718 147.52019 154.42049 159.08249 161.00848 162.92999 167.6703 171.6843 173.9037 176.0007 181.6077 186.8727 192.0927 196.6467 201.3717 206.05261 210.79382 216.22083 217.93083 222.39484 228.97383 234.58083 236.80023 241.92123 244.14064 249.40564 251.62505 255.64804">IF IDT gate is 32-bit (* implies IA32_EFER.LMA = 0 *)</tspan><tspan y="-499.98547" x="77.519989 82.729187 88.550385 93.300583">THEN</tspan><tspan y="-487.98578" x="95.519989 100.66439 105.40649 109.44389 114.24628 116.46568 119.04508 123.72598 128.47438 132.91318 138.54358 143.76447 148.56686 151.14627">Push (EFLAGS);</tspan><tspan y="-475.98608" x="95.519989 100.68149 105.42359 109.42229 114.22469 116.4441 119.0208 122.3445 126.8436 130.08539 132.30479 136.95149 141.66119 143.64299 148.38509 151.80508 156.48598 159.73767 161.95708 165.37708 170.05798 172.27739 175.57948 180.26038 183.62007 188.42247 191.67416 196.47656 198.69597 200.63367 205.43607 209.43477 212.79446 216.04616 220.79999 224.68259 228.03418 229.96378 234.70497 239.50737 242.08678 243.93538 246.15479 248.72339 252.72299 254.9424 260.22269 262.44208 269.36667 274.10788 277.35147 282.03058 286.05267 288.27206 292.91068 297.40976 302.04837 306.72748 311.42007 316.09918 318.31857 321.67017 326.41138 328.63077 333.87238 336.09177 340.09137">Push (far pointer to return instruction); (* 3 words padded to 4 *)</tspan><tspan y="-463.98639" x="95.519989 100.26119 105.06359 106.79789 111.50219 113.57849 118.73999 120.95939 122.69369 127.79399 130.0134 135.26669 139.71899 143.07329 147.81358 150.38489 155.12608 159.88438 161.61868 166.35988 168.46048 173.56078 176.13208 178.05179 180.27119 182.8425 186.8448 189.06421 193.82251 198.56281 203.2041 210.1647 214.86 219.6624 223.01669 225.2361 229.91519 234.59608 238.58939 242.47469 245.72099 247.70279 252.38188 255.74158 260.44586 263.74796 265.96735 267.89966 272.70206 276.02036 280.76157 284.00787 290.96848 295.42078 298.84079 300.7731 305.51431 310.27261 312.492 316.99112 318.91263 322.90591 327.61023 329.82962 331.73492 336.4761 340.92841 345.60751 350.34784 354.96753 357.18692 361.18921">CS:EIP := Gate(CS:EIP); (* Segment descriptor information also loaded *)</tspan><tspan y="-451.98669" x="95.519989 100.64819 105.39029 109.41149 114.19769 116.41709 119.01629 123.69719 126.97139 130.24559 134.97778 138.25198 142.98419 147.6651 152.3343 157.01521 159.61441 161.49361 163.713 166.31219 170.34239 172.56178 174.66599 177.96539 180.18478 184.66498 189.40707 194.09427 196.31366 200.34386">Push (ErrorCode); (* If any *)</tspan><tspan y="-439.987" x="77.519989 82.25489 86.72879 91.517693">ELSE</tspan><tspan y="-427.9873" x="95.519989 97.616989 102.34199 104.56139 106.65839 112.19339 117.37739 119.59679 124.25879 128.6985 132.0735 136.78951 139.00891 140.93042 144.95253 147.17194 152.43694 157.70193 160.53694 165.15665 167.13844 170.51344 172.73285 175.32484 179.34784 181.56725 183.52025 190.42055 195.08255 197.00854 198.93005 203.67036 207.68436 209.90376 212.00076 217.60776 222.87276 228.09276 232.64676 237.37177 242.05267 246.79388 252.22089 253.93089 258.3949 264.97391 270.5809 272.80029 277.9213 280.14069 285.4057 287.62509 291.6481 294.24011">IF IDT gate is 16-bit (* implies IA32_EFER.LMA = 0 *) </tspan><tspan y="-415.98761" x="113.51999 118.72919 124.55038 129.30058">THEN</tspan><tspan y="-403.98792" x="131.51999 136.68149 141.4236 145.4286 150.19861 152.41801 155.00101 159.71701 164.21611 169.79611 175.06111 179.83112 182.41412">Push (FLAGS);</tspan><tspan y="-391.98822" x="131.51999 136.67249 141.41458 145.46008 150.27058 152.48999 155.0694 158.36879 162.87329 166.11508 168.33449 173.02798 177.70888 179.69337 184.43547 187.84196 192.52286 195.76465 197.98405 201.39055 206.07144 208.29085 211.58936 216.27025 219.62994 224.43234 227.67413 232.4397 234.6591 236.5815 241.3029 245.20531 249.67471 253.04611 254.99551 259.71692 264.49231 267.08072 268.94913 271.16852 273.75693 277.77634 279.99573 285.25714 287.47653 294.42093 299.14233 302.40573 307.06412 311.07452 313.29391 317.31332">Push (far pointer to return location); (* 2 words *)</tspan><tspan y="-379.98853" x="131.51999 136.24049 141.015 142.7655 144.858 149.9745 152.19391 153.94441 159.06091 161.28032 166.54982 171.01833 174.38882 179.10033 181.68782 186.40833 191.18283 192.93333 195.02583 200.14233 202.72983 204.59732">CS:IP := Gate(CS:IP); </tspan><tspan y="-367.98883" x="131.51999 134.1588 138.18089 140.4003 145.1523 149.89259 154.52759 161.48819 166.17719 170.97958 174.32759 176.547 181.22609 185.90698 189.92908 193.82878 197.06879 199.05058 203.68558 207.10559 211.80359 215.1057 217.3251 219.2511 224.0535 227.36549 232.10669 235.34669 242.3073 246.7533 250.17331 252.0993 256.84052 261.59253 263.81195 268.31107 270.23254 274.25464 278.93555 281.15497 283.05396 287.79517 292.24118 296.92029 301.60928 306.28839 308.50781 312.50381">(* Segment descriptor information also loaded *)</tspan><tspan y="-355.98914" x="131.51999 136.68149 141.4236 145.43311 150.20761 152.42702 155.01451 159.73502 163.03711 166.2789 170.9994 174.2619 178.98241 183.70291 188.36041 193.07191 195.65941 197.5269 199.74631 202.3338 206.35229 208.5717 210.6642 213.9987 216.21811 220.68661 225.46112 230.13663 232.35603 236.37453">Push (ErrorCode); (* If any *)</tspan><tspan y="-343.98944" x="113.51999 118.24769 122.71439 127.49609 132.22379 134.44318 137.03787 141.06357 143.28296 145.38266 150.99236 156.26006 161.48006 166.03676 170.76447 175.44537 180.18658 185.61629 187.32899 191.7957 198.336 203.94569 206.16508 211.28879 213.50818 218.77588 220.60558 222.82497 228.09267 233.31267 236.15038 240.77008 242.72578 246.10349 248.32288 252.94258 257.44168 260.81937 265.50024 269.52594">ELSE (* IA32_EFER.LMA = 1, 64-bit gate*)</tspan><tspan y="-331.98975" x="131.51999 136.67068 141.41278 145.45648 150.26518 152.84459 156.14398 160.64668 163.88849 166.10789 170.79959 175.48048 177.46318 182.20528 185.60997 190.29086 193.53267 195.75208 199.15677 203.83766 206.05707 210.81177 212.73328 217.42497 219.64438 223.60619 227.02618 231.46588 235.36559 239.62529 242.2047 244.1064">Push(far pointer to old stack); </tspan><tspan y="-319.99005" x="131.51999 134.15878 138.18088 140.40028 146.12608 148.04488 152.69968 154.91908 159.69089 164.46269 166.6821 171.1479 175.91971 180.57451 182.79391 187.56572 192.67952 194.49931 196.71872 201.42752 205.89333 209.79213 214.56393 216.78334 221.24915 226.02095 228.24036 233.49815 236.32596 240.98076 245.65356 249.02136 253.73016 255.94957 260.60437 265.37616 269.38297 274.15475 276.37415 280.38995">(* Old SS and SP, each an 8-byte push *)</tspan><tspan y="-307.99036" x="131.51999 136.68149 141.4236 145.4313 150.20401 152.7897 158.2104 162.92911 167.38681 172.98752 178.25522 183.02792 185.61362 187.47932 189.69963 192.28532 196.30202 198.52232 203.78102 206.60973 211.26543 215.93913 219.35913 224.04004 226.26035 230.91605 235.68875 239.69646 244.46916 246.68947 250.70616">Push(RFLAGS); (* 8-byte push *)</tspan><tspan y="-295.99066" x="131.51999 136.68149 141.42358 145.42319 150.22559 152.80319 156.12779 160.62689 163.86868 166.08809 170.73569 175.44629 177.42809 182.17018 185.59018 190.27107 193.52367 195.74307 199.16307 203.84398 206.06339 209.36548 214.04637 217.40697 222.20937 225.46196 230.26436 232.48376 234.42236 239.22476 243.22437 246.58496 249.83755 254.63995 258.53156 261.89215 263.83075 268.54135 273.34375 275.92316 277.78076">Push(far pointer to return instruction); </tspan><tspan y="-283.99097" x="131.51999 134.15878 138.18088 140.40028 146.12788 148.04848 152.70508 154.92448 159.64409 164.41769 166.6371 171.10471 175.87831 180.53491 182.75432 188.17592 190.26752 195.38312 197.20471 199.42412 204.13472 208.56 212.4471 217.2495 219.4689 223.923 228.7254 230.94481 236.1909 239.07181 243.7149 248.37601 251.7321 256.47241 258.6918 263.3349 268.1373 272.15939 276.90149 279.12088 283.12497">(* Old CS and RIP, each an 8-byte push *)</tspan><tspan y="-271.99127" x="131.51999 136.68149 141.4236 145.43401 150.20941 152.79781 157.51921 160.8213 164.0631 168.7845 172.0479 176.7693 181.49071 186.14911 190.86151 193.44991 195.3183 197.5377 200.1261 204.14549 206.3649 208.4583 211.7937 214.01311 218.78851 223.50092 228.21332 232.87172 237.58412 242.24252 244.06592 246.28532 251.54672 253.76613 258.42453 263.10092 266.47232 271.18472 275.19513 277.41452 281.43393">Push(ErrorCode); (* If needed, 8 bytes *)</tspan><tspan y="-259.99158" x="131.51999 136.24319 141.0204 142.77361 148.19881 150.29401 155.41321 157.63261 159.38582 164.50502 166.72443 171.99663 177.60182 182.78403 187.50723 190.09743 194.82063 199.56274 201.30424 206.72945 208.82465 213.94385 216.53404 218.40424">CS:RIP := GATE(CS:RIP); </tspan><tspan y="-247.99188" x="131.51999 134.1588 138.18089 140.4003 145.1523 149.89259 154.52759 161.48819 166.17719 170.97958 174.32759 176.547 181.22609 185.90698 189.92908 193.82878 197.06879 199.05058 203.68558 207.10559 211.80359 215.1057 217.3251 219.2511 224.0535 227.36549 232.10669 235.34669 242.3073 246.7533 250.17331 252.0993 256.84052 261.59253 263.81195 268.31107 270.23254 274.25464 278.93555 281.15497 283.05396 287.79517 292.24118 296.92029 301.60928 306.28839 308.50781 312.50381">(* Segment descriptor information also loaded *)</tspan><tspan y="-235.99219" x="95.519989 100.25489 102.36179">FI;</tspan><tspan y="-223.99249" x="59.519989 64.25489 66.361794">FI;</tspan><tspan y="-211.9928" x="59.519989 64.234192 69.002396 71.583595 76.999794 82.109993 86.609093 89.190292 91.409691 93.153893 98.264091 100.48349 105.19769 110.30789 114.76109">CS(RPL) := CPL;</tspan><tspan y="-199.9931" x="59.519989 61.627789 66.363586 68.582993 73.325096 78.127502 82.567207 87.246307 91.982109 98.882408 103.67221 107.05801 111.54182 115.45862 119.71832 124.39922 129.18901 133.62871 138.30151 140.23831 144.96512 149.58482 152.18762 156.92342 162.05522 166.53003">IF ShadowStackEnabled(CPL)</tspan><tspan y="-187.99341" x="77.519989 79.616989 84.341988 86.561386 91.286385 97.136383 101.86138 106.54228 111.79828 116.35228 121.09438 125.89677 130.39767 135.61588 141.31378 146.59409 151.27499 157.15559 159.375 164.496 169.617 171.83641">IF CHECK_SS_TOKEN == 1</tspan><tspan y="-175.99371" x="95.519989 100.72919 106.55038 111.30058">THEN</tspan><tspan y="-163.99402" x="113.51999 115.61339 120.33479 122.55418 128.40059 133.11299 140.05739 144.83279 149.6082 154.7256 156.94501 162.89041 165.10982 170.37122 175.15561 180.41701 185.67841 187.89781 189.64021 194.75761 196.97702">IF NewSSP &amp; 0x07 != 0</tspan><tspan y="-151.99432" x="131.51999 136.70039 142.5468 147.2682 153.11461 155.33401 161.09941 166.36981 171.48721 174.07561 179.33701 181.9254 183.79379 186.0132 190.7346 192.828">THEN #GP(0); FI;</tspan><tspan y="-139.99463" x="77.519989 80.158791 84.180893 86.400291 91.578888 96.298492 100.61759 105.29849 110.07209 112.29149 116.75909 121.53268 126.18929 128.40869 133.1283 137.9019 139.6515 144.11011 146.20171 151.31731 153.06691 157.78651 159.70711 164.36371 169.13731 173.91092 179.02652 181.24593 185.90253 190.62029 194.63339 199.4115 204.1266 208.7877 211.00711 215.68802 220.49043 222.70984 226.72295 231.50105 235.97316 240.59286 245.31697 252.21727 254.43668 258.44977 261.82388 266.29599 270.20108 274.48419 276.70361 283.65073 288.42883 292.44193 295.81604 298.01999 302.69278 307.37369 309.59308 313.50989 318.2457 323.03549 326.4213 330.86099 332.8428 337.5849 342.3252 346.94489 349.16428 351.12808 355.87018 358.08957 362.57336 364.79276 369.53485 374.03394 377.41974 382.20953 385.48734 389.92703 391.86383 393.80063 398.42032 400.63971 405.1235 407.0603 408.98181 413.66089 418.45068 423.13159 427.80438 430.02377 435.24377 440.52405 443.36984 448.04263 452.73343 456.11923 460.80014 463.01953 466.29733 470.97824 475.65103 477.57254 482.30835 487.05045 489.26984 493.30365">(* Token and CS:LIP:oldSSP pushed on shadow stack must be contained in a naturally aligned 32-byte region *)</tspan><tspan y="-127.99493" x="77.519989 79.608887 84.32579 86.545189 89.129089 94.970993 99.678894 106.6188 111.38969 116.16059 121.27349 123.49289 129.43379 131.6532 136.7751 142.032 146.8119 152.0688 156.78571 159.3696 161.589 163.3269 168.4398 170.65921 173.2431 175.8819 181.7238 186.4317 193.3716 198.1425 202.91341 208.02631">IF (NewSSP &amp; ~0x1F) != ((NewSSP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-127.98" x="210.24001">–</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-127.98" x="215.10001 217.3194 222.5907 227.8107 230.409 232.62839 238.58369 240.80309 245.93939 251.15939 255.95369 261.22498 265.90585"> 24) &amp; ~0x1F)</tspan><tspan y="-115.9803" x="95.519707 101.27071 106.5267 111.6297 114.26849 119.5155 122.08949 124.00919 126.22858 130.93558 133.01457">#GP(0); FI;</tspan><tspan y="-91.980003" x="113.51971 115.61941 120.34711 122.56651 125.16121 127.75591 129.85561 135.4653 140.733 146.0007 150.5574 155.23831 159.97952 164.66043 170.11983 171.83253 176.29924 182.83954 188.41954 190.63893 195.11462 199.85674 204.52144 206.74083 211.46854 216.21065 217.92336 222.39006 224.98476 227.20415 232.32785 234.54724 239.81494 242.03433 247.64403 253.49673 259.03442 261.25385 267.10654 271.82523 278.72552 283.52792 288.27002 293.43152 296.1972 301.41721 306.68491 308.4426 313.7103 318.9303 321.69598 323.91541 325.66409 330.78778 333.0072 338.2272">IF ((IA32_EFER.LMA and CS.L) = 0 AND NewSSP[63:32] != 0)</tspan><tspan y="-79.980301" x="46.019707 48.239105 50.458504 52.677902 131.517 136.6974 142.54381 147.26521 153.11162 155.33102 161.09642 166.36682 171.48422 174.07262 179.33401 181.92241 183.7908 186.01021 190.73161 192.82501">    THEN #GP(0); FI;</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="511.60522pt" height="647.69556pt" viewBox="0 0 511.60522 647.69556" sodipodi:docname="622.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.84" inkscape:cy="427.83691" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg152" /><g transform="translate(-45.119999,-69.182129)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="112.68 117.4203 122.21821 126.85411 131.59441 135.4743 138.82321 143.51311 148.1922 152.75339 156.1131 160.85429 165.114 169.80389 174.60629 179.16748 183.78629 188.28539 190.20689 194.95979 199.70009 201.91949 207.01439 209.2338 215.05769 219.79799 226.71989 231.52229 236.27519 241.43669 243.6561 246.222 250.2189 252.43831 257.07422 261.87662 265.89874 270.57874 272.79813 277.43402 279.41583 282.76474 284.98413 287.79303 290.01242 294.69153 296.61304 299.96194 302.18134 306.86044 311.60165 315.58957 317.57138 320.92029 322.9021 327.60101 332.40341 334.6228 339.86169 342.08109 344.96198 347.18137 354.10327 358.90567 362.9278 366.28751 368.5069 373.14279 377.88312 380.10251 383.98242 385.88232 390.57224 395.07132 398.31223 400.53162 404.5285">expected_token_value = NewSSP (* busy bit - bit position 0 - must be clear *)</tspan><tspan y="-703.98029" x="112.68 117.4671 122.1912 129.09149 133.65269 137.0358 141.76889 146.02859 150.76891 155.511 160.0722 164.69101 169.19011 171.12421 175.8663 180.59041 182.8098 187.9389 190.15829 195.97949 200.7198 207.6201 212.4072 217.19429 222.32339 224.54279 226.46429 228.68369 234.01079 239.70689 244.44899 249.5502 254.1123 259.43939 261.54449 266.70331 268.92273 271.52283 275.55392 277.77335 282.56046 287.24133 290.62442 292.84384 296.22693 301.01404 305.69492 307.91434 312.58444 317.37155 321.33334 326.01337 328.23279 332.90289 334.82437 338.20746 340.42688 344.45798">new_token_value = NewSSP | BUSY_BIT (* Set the busy bit *)</tspan><tspan y="-691.98059" x="112.68 114.7743 119.4966 121.716 125.72729 130.5036 134.97391 139.63321 144.35551 151.30081 155.85211 159.81392 163.18622 167.65652 171.55983 175.84113 180.39243 182.31572 187.03802 190.94133 195.22263 199.77393 203.67723 210.62253 215.28183 220.06712 223.97043 228.74673 233.40604 238.66833 243.32764 245.91693 251.76424 256.47754 263.42285 268.13971 272.94211 278.0433 279.90179 282.12119 286.8786 291.6189 298.54529 303.0777 306.43109 311.1723 315.43469 320.17499 324.93237 329.46478 334.08719 338.58627 340.49066 345.24805 349.98834 351.78745 354.00684 358.74713 363.48471 368.16382 372.90411 376.78851 380.14191 384.8363 389.51541 394.04782 397.40121 402.10461 406.44 411.1398 415.9422 420.48001 425.10782 429.56461 431.4744 436.27679 440.9577 443.5965 445.81589 447.54568 452.65048 454.86987 459.56967 464.34146 469.02057 473.69971 477.6156 481.00049 485.72638 490.3461 494.91 498.29489 503.02979 507.28949 512.01538 516.75745 521.32135 525.94012 530.42303 532.35895 537.10101">IF shadow_stack_lock_cmpxchg8b(NewSSP, new_token_value, expected_token_value) != expected_token_value</tspan><tspan y="-679.9809" x="130.67999 135.8568 141.6996 146.4174 152.26021 154.47961 160.24141 165.50821 170.62201 173.2068 178.4646 181.04939 182.9142 185.13361 189.85141 191.94121">THEN #GP(0); FI;</tspan><tspan y="-667.9812" x="76.679993 81.414894 83.521797">FI;</tspan><tspan y="-655.98151" x="76.679993 79.284592 83.32019 85.539597 91.119598 93.0411 94.962601 99.641701 104.4333 106.65271 110.04031 114.72121 116.94062 121.73222 126.41312 131.21373 134.60133 136.82072 142.09833 144.31772 148.99232 153.61201 156.99962 161.68053 163.89992 168.57452 173.25542 178.04701 182.78911 187.46371 191.90341 195.18301 199.87561 202.095 206.1306">(* Align to next 8 byte boundary *)</tspan><tspan y="-643.98181" x="76.679993 80.099998 84.780899 91.715401 96.363899 101.1294 105.89491 111.0564 113.27581 118.38331 120.60271 125.36822 130.13371 135.24121">tempSSP = SSP;</tspan><tspan y="-631.98212" x="76.679993 81.464394 86.248795 90.688499 95.355896 100.0368 106.9902 111.5496 115.5114 118.9314 123.3711 127.2708 131.5602 136.1196 140.13899 143.51939 148.24979 151.52219 156.24359 158.46298 163.68298 165.90237 170.56978 175.25517 178.63557 183.35698 187.31877 189.53816 194.26855 197.61296 199.83235 205.05235 207.27174 210.65215 215.38254 217.60193 220.19933 226.02052 230.74193 237.69533 242.43742 247.23982 252.36623">Shadow_stack_store 4 bytes of 0 to (NewSSP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="12" class="cA49CCA52 c8037F88D"><tspan y="-631.97998" x="254.52">−</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="7.98" class="c0D1DDB3D c9DBAE658"><tspan y="-631.97998" x="261.12"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-631.97998" x="263.10001 268.38031">4)</tspan><tspan y="-619.98029" x="76.680298 81.466499 86.252701 91.380898 93.600296 98.728493 100.94789 105.73409 110.41499 117.37019 122.1123 126.8985 132.0267 134.24609 140.2023 142.42169 147.69389 152.43149 157.1637 161.8959 166.57681 171.30902 176.04123 180.72214 185.45435 190.13525 194.86746 199.59967 204.28058 209.01279 213.745 218.4259 223.15811 228.43031 234.28751">SSP = newSSP &amp; 0xFFFFFFFFFFFFFFF8H;</tspan><tspan y="-607.98059" x="76.680298 79.267799 83.286301 85.505699 90.685196 95.459694 100.1712 104.18069 108.8922 111.1116 115.12109 118.49159 122.96009 126.86159 131.14108 133.36049 138.01799 142.7925 146.802 151.57651 156.28801 160.29752 162.51692 166.52643 171.30093 176.02144 180.79594 182.71744 187.37494 189.59435 194.36885 199.08936 202.45985 204.67926 208.58076 213.04927 217.82378 221.83328 226.54478 228.76419 232.0636 236.5627 241.3372 243.2587 246.6292 250.6387 252.4612 254.6806 260.32181 266.92239 269.14178 273.85327 278.64032 280.5618 283.92148 287.94177 289.77509 291.99451 296.67538 299.97748 302.1969 306.81659 311.3157 314.69699 319.13669 321.35611 326.02441 329.2977 334.01999 338.45969 342.75 347.36969 352.10098 354.02246 358.80777 362.18906 366.20935 368.04266 370.26208 372.22137 375.52078 377.7402 382.4715 388.32779 393.05908 397.79037 403.01038 407.57068 412.31277 417.09808 421.65839 426.84869 432.58798 437.80798 442.54916 448.40546 450.62488 452.58417 456.54596 458.76538 464.03668 466.2561 470.2854">(* These stack pushes should not cause faults, VM exits, or data breakpoints, if CHECK_SS_TOKEN is 1 *)</tspan><tspan y="-595.9809" x="76.680313 79.319115 83.341217 85.560616 90.333313 95.10601 99.005707 103.7784 105.9978 110.7075 115.34521 120.05491 124.82761 128.1963 132.20401 134.42342 141.36511 143.31181 145.23151 147.1512 149.37061 153.83731 158.49301 163.14871 165.06841 169.74211 171.96152 175.33022 180.04892 182.26833 185.63702 190.40973 195.11943 197.33884 202.04854 206.52061 209.76242 211.68391 213.65132 218.33223 221.61363 223.83302 228.27272 232.19312 236.11351 240.84392 244.80571 248.8278 253.55821 257.58661 259.806 263.1954 267.87631 270.0957 273.48511 278.2272 282.95761 285.177 288.56641 293.24731 297.54572 302.22662 307.02002 308.81912 311.03851 318.00092 322.74301 324.71042 328.63083 333.37292 335.58063 337.53091 341.54221 343.76163 345.71191 350.48822 352.70764 356.07996 360.85626 365.56955 367.78897 371.80026 376.27057 383.21588 387.92917 390.14859 395.41089 400.67319 403.50549 408.16479 412.8421 416.21442 420.9277 423.14713 426.41144 431.12473 435.78403 437.73431 442.4566 447.23291 449.45233 453.47263">(* Such events will apply to the earlier accesses to the token, which is in the same 32-byte region *)</tspan><tspan y="-583.9812" x="76.680328 79.273232 83.297134 85.516533 90.136238 94.938637 98.953537 103.73344 105.95284 109.85973 113.87463 115.63053 117.55743 119.51134 124.13104 125.88694 129.90184 133.91675 138.57965 140.79906 145.47997 150.28238 152.50179 156.51669 161.2966 165.77051 170.39021 175.11612 182.06502 184.28442 188.24622 191.66621 196.14011 200.04701 204.33191 206.55132 210.57521">(* push cs:lip:ssp on shadow stack *)</tspan><tspan y="-571.98151" x="76.680328 81.46743 86.254532 90.694237 95.364334 100.04523 107.00134 111.74344 115.12654 119.56625 123.48035 127.77245 132.90155 137.64365 141.66574 146.40784 151.68094 157.00804 159.60814 164.28903 166.22313 170.89323 175.62633 180.36842 182.96852 184.84862 187.06801 189.66811 193.6992 195.91859 201.0477 205.4874 210.1575 214.82761 219.50851 224.17862 226.39801 233.29831 235.28012 238.66322 243.40532 245.62471 250.89781 256.1709 258.39032 263.13242 265.1142 269.73389 274.53629 277.37939 282.11249 285.38757 290.05768 294.73856 298.04065 300.26007 304.87976 306.86154 310.24463 314.26672 316.48615 321.16705 324.52585 326.74527 332.01837 334.23779 338.19958">ShadowStackPush8B(oldCS); (* Padded with 48 high-order bits of 0 *)</tspan><tspan y="-559.98181" x="76.680328 81.46743 86.254532 90.694237 95.364334 100.04523 107.00134 111.74344 115.12654 119.56625 123.48035 127.77245 132.90155 137.64365 141.66574 146.40784 151.68094 157.00804 159.60814 164.28903 166.22313 170.89323 175.62633 180.36842 185.69553 191.31062 196.09772 200.77861 202.998 208.18111 210.4005 215.13359 217.06769 221.73779 227.1729 229.278 234.4071 237.0072 238.8873 241.10669 243.70679 247.73788 249.95728 255.08638 259.52606 264.19617 268.81586 273.53995 278.21005 280.38004 287.30014 289.28195 292.62906 297.38016 299.59955 304.87985 310.16016 312.37955 317.13065 319.11246 323.74655 328.54895 331.35605 336.09726 339.33636 344.01547 348.70358 352.00568 354.22507 358.85916 360.84097 364.18808 368.21021 370.38004 375.09244 378.41882 380.63821 385.89062 388.11002 391.4364 396.1488 399.4032 401.62259 406.875 412.12741 414.3468 418.99622 420.93661 424.3566 426.57599 431.02737 433.11179 438.22018 442.23059">ShadowStackPush8B(oldCSBASE + oldRIP); (* Padded with 32 high-order bits of 0 for 32 bit LIP*)</tspan><tspan y="-547.98212" x="76.680328 81.472832 86.265335 90.70504 95.380539 100.06144 107.02294 111.76505 115.15355 119.59325 123.51276 127.77245 132.90695 137.64905 141.67654 146.41864 151.69714 157.02965 159.63515 163.02365 167.70456 174.66516 179.34067 184.08276 188.87526 194.00977 196.61526">ShadowStackPush8B(tempSSP);</tspan><tspan y="-535.98242" x="58.620026 63.354927 65.46183">FI;</tspan><tspan y="-523.98273" x="58.620026 60.694527 65.435722 67.655121 72.396317 77.13842 81.81752 86.437225 89.739326 94.179024 98.981422 102.88112 107.63762 112.37881 117.13531 121.63441 126.31351 128.23502 132.92851 137.6076 139.82701 142.39651 147.09901 152.26051 156.69931">IF EndbranchEnabled (CPL)</tspan><tspan y="-511.98303" x="76.680328 78.768326 83.484329 85.703728 90.419731 95.531731 99.986732 102.20613 107.31813 109.53753">IF CPL = 3</tspan><tspan y="-499.98334" x="94.680328 99.889526 105.71072 110.46092">THEN</tspan><tspan y="-487.98364" x="112.68033 114.76383 120.40323 125.65473 130.90623 135.44673 141.12123 145.66173 150.37323 155.08473 160.25523 161.95174 167.16994 172.58344 178.17694 182.88844 188.13095 192.84245 198.25595 200.47536 205.63686 207.85626 215.15076 220.74426 222.82776 228.04596 232.58646 237.29796 243.05615 248.45615 252.99664 257.70813 263.58871 269.10663 274.41214 279.87155 285.46506 291.30154 296.01303">IA32_U_CET.TRACKER = WAIT_FOR_ENDBRANCH</tspan><tspan y="-475.98395" x="112.68033 114.78093 120.39153 125.61153 130.89183 135.44943 141.09064 145.64824 150.37685 155.10545 160.29306 161.97336 166.77576 172.41696 177.57846 182.70306 188.13367 192.86227 197.60437 202.38696 204.60635 209.73096 211.95035">IA32_U_CET.SUPPRESS = 0</tspan><tspan y="-463.98425" x="94.680328 99.41523 103.88913 108.67803">ELSE</tspan><tspan y="-451.98456" x="112.68033 114.77373 120.37713 125.59713 130.87744 135.42784 140.20325 144.75365 149.47505 154.15596 159.37416 161.08057 166.26097 171.68437 177.28777 182.00917 187.26157 191.98297 197.40637 199.62033 204.72513 206.94453 214.23633 219.82713 221.90793 227.12613 231.66393 236.37273 242.08952 247.54892 252.08672 256.7955 262.67612 268.19403 273.49683 278.95624 284.54703 290.38083 295.08963">IA32_S_CET.TRACKER = WAIT_FOR_ENDBRANCH</tspan><tspan y="-439.98486" x="112.68033 114.77463 120.37893 125.59893 130.87924 135.43054 140.20685 144.75815 149.48045 154.16136 159.37956 161.08687 165.86317 171.50438 176.66588 181.78418 187.20848 191.93079 196.70709 201.4834 203.7028 208.82111 211.04051">IA32_S_CET.SUPPRESS = 0</tspan><tspan y="-427.98517" x="76.680328 81.41523 83.522133">FI;</tspan><tspan y="-415.98547" x="58.620026 63.354927 65.46183">FI;</tspan><tspan y="-403.98578" x="58.620026 60.715225 65.438423 67.657822 69.753021 75.286224 80.468422 82.68782 87.348022 91.819221 95.192421 99.906624 102.12602 104.07722 108.03902 110.25842 112.20963 116.98682 120.36002 125.07423 128.33943 131.60463 136.38184 141.04204 144.41524 146.63464 151.29485 155.76605 159.13925 163.85345">IF IDT gate is interrupt gate </tspan><tspan y="-391.98608" x="76.680328 81.857132 87.699936 92.41774 98.260544 100.47994 102.56974 107.28754 109.50694 111.25474 116.36854 118.58794 123.84573 125.71053 127.92993 132.64774 134.68893 136.60864 138.82805 141.41284 145.42863 147.64804 149.73784 154.50964 157.87744 162.58624 165.84604 169.10583 173.87764 178.53244 181.90024 184.11964 187.45145 189.43234 193.89815 198.60062 200.82002 204.82413 209.53023 212.89532 215.11473 218.47983 223.19493 225.41434 230.66943 232.58914 234.80855 236.75165 241.52075 244.88585 249.59195 252.89404 256.13586 260.90497 265.55707 268.92218 272.92627 275.14566 279.79776 281.74084 285.74493 290.20804 294.86014 296.77625 301.48236 306.13446 308.35385 312.36694">THEN IF := 0; FI; (* Interrupt flag set to 0; interrupts disabled *)</tspan><tspan y="-379.98639" x="58.620911 63.831009 68.511909 70.731308 72.512405 77.613609 79.833008 85.053009">TF := 0;</tspan><tspan y="-367.98669" x="58.620911 64.484413 69.643219 71.862625 73.631126 78.765625 80.985031 86.205032">NT := 0;</tspan><tspan y="-355.987" x="58.620911 64.311607 70.851906 73.071312 74.838013 79.970711 82.190117 87.46682">VM := 0;</tspan><tspan y="-343.9873" x="58.620911 64.073112 68.754013 70.973412 72.753609 77.854813 80.074211 85.294212">RF := 0;</tspan><tspan y="-331.98761" x="45.120911 49.815311 55.695911 61.20031">END;</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-308.34" x="45.119999 50.661743 53.175648 58.488312 64.128654 68.88356 71.403435 77.462105 81.360443 85.079506 90.718857 95.264603 99.24263 104.82421">Flags Affected</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-292.98001" x="45.119999 50.648701 56.330402 61.679104 64.562706 70.235405 75.395103 80.438705 86.562309 93.522011 99.70591 102.53011 106.35781 111.76051 117.35221 119.80291 124.47661 128.00731 133.356 137.1837 140.00789 142.45859 147.13229 150.01588 155.60759 161.28929 165.963 171.6447 176.99339 182.5851 185.46869 190.91638 196.59808 200.12878 205.57648 208.46007 211.99077 217.67247 223.02116 225.84535 230.58566 234.12537 239.51907 244.19278 249.50548 252.80757 255.63176 261.20996 266.85205 272.25473 275.07895 278.85266 282.69565 285.99777 288.82199 294.40018 298.20001 301.4418 304.32538 311.06458 315.32248 318.60568 321.42987 327.55347 333.85168 337.13489 339.95908 346.22128 350.06427 353.34747 356.17166 361.58786 367.29205 372.87204 375.75562 381.87921 389.50131 392.3255 395.5007 397.97391 403.39011 408.96921 413.66541 416.48959 425.25378 430.59708 435.93228 438.75647 444.37067 449.71304 452.53723 457.23343 459.70663 465.04901 470.45261 474.3028 479.67398 485.25397 488.49576 491.37933 496.95844 502.30081 507.91501 513.25739 518.96161 524.54163 527.01483 532.71906 538.29907 541.18262 546.65283 552.29407">The EFLAGS register is pushed onto the stack. The IF, TF, NT, AC, RF, and VM flags may be cleared, depending on </tspan><tspan y="-282" x="45.12001 48.657909 54.346809 59.702709 62.526909 71.27581 76.730713 82.329613 87.732315 90.556511 96.011414 99.17131 101.99551 107.45041 113.08981 118.44571 122.10781 127.50871 131.04662 133.50452 138.95941 144.64832 147.47252 152.92741 156.08731 158.91151 162.44942 168.13832 173.49422 176.37782 181.97673 185.81163 191.26653 195.94742 201.30331 205.98422 210.66513 216.12003 219.95493 222.83853 230.19243 235.88133 241.23723 246.92613 249.80974 253.34764 259.03653 264.43924 267.26346 271.04437 277.76828 283.34647 286.17068 288.62857 294.31747 298.99838 302.53629 306.37119 311.94031 316.61942 320.21942 322.61612 328.07642 333.76352 336.58774 339.04382 343.72293 346.60654 351.96063 357.18243 362.53653 367.21564 372.90274 376.43884 381.79294 387.43234 390.25656 394.33267 399.01178 404.36588 409.76859 412.5928 416.12891 421.81601 427.1701 430.05371 434.1748 441.24789 446.8873 452.22971 455.89182 461.29541 464.83151 467.2876 472.74069 478.4278 482.54889 485.37311 490.05222 495.40631 500.08542 503.62152 506.07761 511.5307 517.21777 521.29388 524.56 527.44354 531.22266 534.38074 537.2049 540.74097 546.42804 551.78217">the mode of operation of the processor when the INT instruction is executed (see the “Operation” section). If the </tspan><tspan y="-270.95969" x="45.119995 47.580597 53.222698 56.763298 62.121899 65.959496 69.797096 75.439194 81.040794 84.581398 87.345299 93.036896 97.720497 103.07909 107.7627 110.5266 115.9302 118.6941 122.2347 127.63831 132.3219 137.6445 140.4084 146.01001 151.4136 154.95421 160.31281 163.5834 166.34731 171.7509 177.39301 182.71561 185.47951 188.64211 191.10271 196.5063 202.10791 206.7915 209.5554 218.30701 223.6503 228.9729 231.7368 237.33841 242.69701 245.46091 250.1445 255.5031 259.0437 261.80759 267.2652 271.10278 273.86667 278.55026 281.01086 286.36948 291.77307 295.61066 300.89999 306.49979 309.76859 312.53247 317.21426 322.67007 328.35986 331.89865 335.73444 341.19025 343.64905 346.04575 351.44846 357.02844 359.79233 365.39212 370.71292 373.47681 377.01559 382.70538 388.06219 390.82608 396.50687 401.67465 406.68045 412.82925 419.79706 425.94586 428.70975 431.16855 439.91833 445.32013 450.91992 456.27673 459.04062 461.49942 467.18921 469.95309 473.49188 479.18167 484.53848 487.30237 492.99216 498.34897 505.70377 508.46765 512.00647 517.40826 522.09009 527.41089 529.51514 534.19519 536.95911 542.49591 548.49982 554.56311">interrupt uses a task gate, any flags may be set or cleared, controlled by the EFLAGS image in the new task’s TSS.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-247.32001" x="45.119999 51.181656 54.603912 60.003227 63.964321 69.569809 74.139458 78.100555 83.680145 89.305557 91.825439 99.52253 105.12802 110.75343 116.35892 118.8788 124.39764 129.68042 134.11958 139.69917 145.15926 149.12035 151.63823 157.24371 162.98865">Protected Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-232.98" x="45.119999 52.476601 59.446201 64.867798 68.948395 74.306992 78.144592 81.982193 87.439796 91.277397 96.995995 101.6796 107.1372 112.7388 118.14149 137.28088 141.06178 144.22438 147.04858 150.58919 156.28079 161.63939 164.52299 166.9836 172.6752 177.3588 180.8994 184.737 190.4286 195.1122 198.6528 201.1134 206.571 212.2626 215.08681 220.68842 226.08931 228.54991 234.24152 237.78212 243.14072 246.97832 249.86192 252.32253 258.01413 260.89771 264.43829 270.12988 275.48849 278.31268 282.09628 288.82108 294.35968 297.18387 302.64148 306.47906 309.30325 311.76385 317.3403 320.16452 323.70963 329.40573 334.76883 337.59305 340.05814 345.75424 349.29935 354.66245 358.50455 362.34665 368.04276 373.64886 377.19397 380.46906 383.35266 386.89777 390.55988 395.96799 401.36801 404.6431 407.46732 412.92941 416.77151 419.65512 423.20023 428.60834 433.29645 438.62354 441.50714 447.11325 452.52136 456.06647 461.42957 464.25378 466.71887 471.40698 474.2312 479.83731 485.20041 490.42221 495.88251 501.57861 507.18472 510.06833 513.6134 519.30951 524.67261 527.49683 532.18494 537.64703 543.25311 548.61621">#GP(error_code)If the instruction pointer in the IDT or in the interrupt, trap, or task gate is beyond the code </tspan><tspan y="-222" x="136.92001 141.60092 146.95682 152.55573 161.30463 166.66052 172.34943 175.88733 178.77092 181.16762 183.62372 192.37262 194.83052 198.36842 203.04932">segment limits.</tspan><tspan y="-207.96001" x="137.21971 141.00421 144.16771 146.99191 150.53342 156.22592 161.58542 164.46902 169.15352 174.51302 180.11551 188.86801 194.22751 199.92001 203.46152 206.34512 211.02962 216.38911 218.85062 224.21011 228.89461 232.43611 237.89461 241.73311 244.61671 247.01341 252.71492 255.59853 259.14001 264.7821 270.1416 272.96582 275.42731 281.11981 284.66132 290.02081 293.85931 297.69781 303.39032 308.99283 312.53433 315.80585 318.63007 322.17157 325.83368 331.23819 336.7579 340.02942 342.85364 348.31213 352.15063 355.03424 358.57574 363.98026 368.66476 373.98825 376.81247 382.41498 387.81949 391.36099 396.72049 399.54471 402.0062 406.6907 409.51492 416.24243 422.82593 427.83444 432.84296">If the segment selector in the interrupt, trap, or task gate is NULL.</tspan><tspan y="-193.9803" x="137.21971 141.00601 144.17131 146.93521 152.34151 158.03581 160.86002 163.25671 168.95822 172.50153 177.86282 181.70312 185.54343 191.23773 196.84203 200.38533 203.65863 206.42253 209.96584 213.68823 219.09453 224.55392 227.82722 230.65143 236.11172 239.95203 242.71593 246.25923 251.66553 256.35184 261.67712 264.44104 270.04535 275.45166 278.99496 284.35626 287.62958 290.4538 295.14011 300.6004 306.20471 311.56601 314.39023 319.07654 324.43784 330.04214 338.74515 344.10645 349.61972 353.15311 356.4165 359.18039 364.6308 368.46121 371.2854 376.7439 382.80719 388.95059 391.77478 396.45117 401.80258 407.39697 416.14136 421.49277 427.17715 430.71054 433.53473 438.21112 443.56253 446.01593 451.36734 456.04373 459.57712 465.02753 468.85794 471.62183 474.07523 479.75961 485.354 490.75671 496.07211 498.8963 501.29211 506.03241 508.7963 514.2467 519.93109 523.46448 528.14087 530.5943 536.18872 541.5401 544.36432 546.76105 550.30072 554.97711">If an interrupt, trap, or task gate, code segment, or TSS segment selector index is outside its </tspan><tspan y="-183.00031" x="136.92001 142.51712 147.87122 152.55032 157.22943 161.06253 163.51863 169.11574 172.65184 178.10493 181.93803 184.82162 188.35773 193.75682 199.35393 201.81003 207.16412 210.04771 212.44441 214.90051 223.64761 226.04431 229.64432 234.32433">descriptor table limits.</tspan><tspan y="-168.96031" x="137.21971 141.00151 144.16231 146.9865 150.5253 156.2151 161.5719 164.45549 169.67729 175.01968 179.70148 183.24028 188.69608 192.53188 195.41547 200.09726 205.45406 207.91286 213.26965 217.95145 221.49025 226.17204 229.05563 234.45743 237.28162 242.88141 248.2382 252.92 257.60181 261.43759 263.89639 269.49619 273.03497 278.49078 282.32657 285.15079 290.6066 296.29639 299.83517 304.51697 306.97577 312.57556 317.93237 320.81598 324.35477 330.04456 335.40137 338.28497 342.06677 348.73126 354.26807 357.09229 359.55109 362.00989 370.75967 373.21848 376.75726 381.43906">If the vector selects a descriptor outside the IDT limits.</tspan><tspan y="-154.98061" x="137.21971 141.00601 144.17131 146.99551 152.40181 158.09612 160.97972 164.76602 171.49081 177.03212 179.85632 185.46062 190.82191 195.50821 200.1945 204.03481 206.49811 212.1024 215.64571 221.106 224.9463 227.77051 230.23381 234.9201 237.80371 243.44582 248.90611 252.44942 255.33302 260.73932 266.43362 269.25784 271.72113 277.41544 280.95874 286.32004 290.16034 294.00064 299.69495 305.29926 308.84256 312.11584 314.94006 318.48337 322.14548 327.55179 333.0112 336.28448 339.1087 344.569 348.4093 351.29291 354.83621 360.24252 364.92883 370.25412 373.07834 378.68265 384.08896 387.63226 392.99356">If an IDT descriptor is not an interrupt, trap, or task gate.</tspan><tspan y="-141.0009" x="137.21971 140.99701 144.15331 146.4375 151.83479 157.5201 159.80429 162.25859 167.94389 171.4782 176.83049 180.66179 184.49309 190.17839 195.7737 199.308 201.6516 204.1059 208.7832 211.1268 216.72211 222.0744 227.7597 233.1624 236.82449 242.22809 245.76239 251.11469 256.70999 259.05359 264.6489 269.96521 272.24942 275.78372 281.46902 286.82132 289.10553 292.88284 299.66254 305.19482">If an interrupt is generated by the INT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-141.0009" x="307.43939">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-141.0009" x="313.1391 316.4007 318.74429 322.51889 329.23648 334.76608 340.52878 343.79037 346.07458 351.52319 355.35181 357.6954 361.47 368.18759 373.46609 380.5455 382.8891 385.3407 391.02328 395.69788 399.22946 403.05807 408.74066 413.41525 416.94684 419.39844 424.84705 430.52963 432.81384 438.20844 443.89102 449.48361 451.82721 455.3588 461.04138 466.44409 468.7283 475.6925 481.0925 486.09109 488.43469 493.8833 497.0369 499.38049 504.77509 510.45767 512.74188 515.19348 520.8761 524.40771 529.75732 533.58594 537.41455 543.09717 548.68976 552.22137 555.48297">, INT3, or INTO instruction and the DPL of an interrupt, </tspan><tspan y="-129.9606" x="136.9191 140.4615 144.1236 149.52899 154.98839 158.26079 161.14438 166.60378 170.44318 173.26736 176.80977 182.21516 186.90056 192.22496 195.04915 200.65254 206.05794 209.60034 214.96074 217.84433 220.24103 224.92102 227.80461 230.26701 235.62741 240.31281 244.9982 247.82239 251.36479 257.0582 262.46359 268.15698 271.04059 274.58298 280.22507 285.58548 288.4097 294.68811 300.11151 305.12091">trap, or task gate is less than the CPL.</tspan><tspan y="-115.9809" x="137.2188 141.0033 144.16679 146.87039 150.4119 156.1044 161.4639 164.2278 168.91229 174.27179 179.87428 188.57729 193.93678 199.57889 203.12039 205.88429 210.56879 215.92828 218.38979 223.74928 228.43378 231.97528 237.43378 241.27228 244.03618 246.49768 252.13979 254.90369 260.3082 266.0007 268.70432 271.1658 276.85831 280.39981 285.75931 289.59781 293.43631 299.12881 304.73132 308.27283 311.03674 316.49524 320.33374 323.03735 326.57886 330.30127 335.70578 341.30829 344.0119 349.61441 355.01892 358.56042 363.91992 366.68384 372.28635 377.74484 383.10434 387.78885 390.55276 396.24527 401.64618 405.18768 407.9516 413.55411 419.0126 421.47409 427.1666 430.7081 433.41171 436.95322 442.41171 445.17563 450.58014 453.28375 457.96826 463.32776 468.93027 477.68277 483.04227 488.73477 492.27628 494.97989 500.5824 505.94189 510.6264 515.31091 519.14941 521.6109 527.21338 530.75488 536.21338 540.05188 542.8158 545.97931 551.43781 555.27631">If the segment selector in an interrupt or trap gate does not point to a segment descriptor for </tspan><tspan y="-105.0009" x="136.9191 142.31639 145.14058 149.81789 155.26918 160.86449 166.26718 169.09137 173.76868 179.12097 184.71628 193.46158 198.86427 204.56578 208.10008">a code segment.</tspan><tspan y="-90.960899" x="137.2188 141.0033 144.16679 146.99098 150.53249 156.22499 161.58449 164.46808 169.15257 174.51207 180.11456 188.86707 194.22656 199.91907 203.46057 206.34416 211.02866 216.38815 218.84966 224.20915 228.89365 232.43515 237.89365 241.73215 244.61574 247.77924 253.23773 257.07623 259.95984 265.36435 268.18857 273.64706 279.71036 285.86185 288.68607 294.37857 299.78308 304.46759 307.3512 309.74789 313.2876 317.97211 320.85571 323.3172 328.71811 333.4584 338.86203 341.25873 345.33755 350.94006 353.33676 358.79526 364.39777 369.80228 372.19897 375.08258 380.68509 383.14658 386.68808 389.5123 394.19681 399.59952 403.14102 405.96524 409.12875 414.58725 418.42575 421.24997 423.71146 429.16995 433.85446 439.25897 441.72046">If the segment selector for a TSS has its local/global bit set for local.</tspan><tspan y="-76.981201" x="137.2188 140.99699 144.15419 146.97838 152.37657 155.26016 160.71866 166.78197 172.92717 175.81076 180.48897 185.84216 191.43837 200.18457 205.58727 211.22937 214.76457 217.64816 223.24437 228.59756 233.27577 237.95398 241.78618 244.24138 249.83759 253.37279 258.77368 262.6059 265.4895 270.16769 275.76389 281.1666 285.84659 288.24329 291.42749 293.88269 299.2359 303.91409 306.7977 310.33289 315.97498 321.37317 324.90836 327.79196 331.32715 337.01334 342.36655 345.19077 350.72397 356.78726 362.93246 365.81607 368.21277 372.89276 375.77637 381.37256 387.05875 391.73694 397.05414 399.87836 405.33057 409.16278 412.04639 417.68848 423.14877 426.68396 429.56757 434.91086 440.01297 445.41116 447.86636 450.32156 455.71976 461.31595 463.77115 469.12436">If a TSS segment descriptor specifies that the TSS is busy or not available.</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="509.55228pt" height="633.75946pt" viewBox="0 0 509.55228 633.75946" sodipodi:docname="623.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.47141" inkscape:cy="409.19689" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg140" /><g transform="translate(-46.146446,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-715.97998" x="138.12 141.90179 145.06259 147.8868 153.9501 160.0737 165.4935 168.3177 170.7765 176.46631 179.29051 183.07231 189.22112 194.93791 200.65471 206.4174 211.8372 216.843 219.3018 225.0186 231.08191 237.26581 242.68561 245.50981 249.58861 256.94342 262.63321 267.99002 271.82581 277.18262 280.06619 282.52499 285.34918 287.80798 292.48978 295.25998 298.79608 304.48318 309.83728 312.72089 318.40799 323.76208 331.1142 333.9978 340.2699 345.68701 350.69012 354.76624 357.64984 360.04654 364.72653 367.61014 373.29724 378.75034 382.28644 385.11066 390.82477 393.70837 399.30548 404.6236 408.1597 413.51379 416.33801 421.73712 424.19321 426.64929 432.2464 437.9335 443.2876 448.8847">If SSP in IA32_PLi_SSP (where i is the new CPL) is not 8 byte aligned.</tspan><tspan y="-702.00031" x="138.12 141.9063 145.07159 147.35579 150.89909 156.5934 161.9547 164.29829 167.8416 173.3019 178.5237 183.86609 189.56039 191.90399 197.31029 203.00459 208.60889 210.95248 214.49579 220.13789 225.49919 227.78339 232.46968 236.01299 241.41928 246.10558 251.43088 253.77448 256.93979 260.6622 266.06851 274.77151 280.13281 282.41705 285.96036 291.42065 293.76428 299.36859 304.72989 307.07352 312.67783 318.37213 323.05844 328.75275 334.11404 339.71835 342.00259 347.46289 353.03998 355.32419 360.0051 365.694 371.09491 376.69382 382.14871 389.50262 391.84622 396.52713 400.06503 405.46594 410.14685 415.46674 417.81033 423.21124 427.04614 432.40204 434.74564 440.43454 445.88943 449.42734 451.71155 456.39246 461.84735 467.53625 471.07416 476.47507 478.93295 484.62186 489.97775 495.57666 497.92026 500.37814 506.02023 508.36383 513.76471 516.10834 521.75043 527.15399 530.69189 536.3808 540.04291 545.50677 547.90259 550.3587 555.67859">If the token and the stack frame to be pushed on shadow stack are not contained in a naturally </tspan><tspan y="-691.02032" x="137.82028 143.21938 145.61607 148.07217 153.66928 159.35638 164.71048 170.30759 173.13179 178.84589 184.55998 188.63608 194.23318 199.55128 203.15129 208.50539 211.32959 215.16269 220.51678 226.11389 228.56999 233.97089 239.67239 242.556 248.00909 251.16719 254.0508 257.58688 263.27399 268.62808 271.4523 276.13141 281.81851 287.21762 292.81473 298.26782 305.61993 308.50354 313.18265 316.71875 322.11786 326.79697 332.11505">aligned 32-byte region of the shadow stack.</tspan><tspan y="-676.98035" x="138.11998 141.90628 145.07158 147.89578 152.02408 156.71037 162.40468 168.00897 173.37027 177.21057 182.53587 184.99918 189.68547 195.14577 198.98607 201.81027 207.96358 213.60568 219.01198 224.61627 230.07657 237.43587 240.31947 246.47278 250.01608 255.42238 260.10867 265.43396 269.56226 272.38647 275.92978 281.39008 286.61188 292.01459 297.65671 300.54031 306.00061 311.69492 314.51913 320.21344 325.57474 332.93405 335.75827 340.44458 346.13889 351.5452 357.14951 362.6098 369.96912 372.79333 377.47964 381.02295 386.42926 391.11557 396.44086 399.32446 401.72116 406.40118 409.28479 418.03909 423.4454 427.28571 432.50751 437.8688 443.47311 446.35672 451.96103 457.65533 462.34164 466.84344">If “supervisor Shadow Stack” token on new shadow stack is marked busy.</tspan><tspan y="-663.00067" x="138.11998 141.89998 145.05898 147.88318 153.48119 158.83618 163.51617 167.05318 169.51018 175.19818 180.59818 184.13518 186.59218 192.04617 197.73418 200.55838 209.30638 214.76038 220.35838 225.76108 228.58528 231.04228 235.72229 238.54649 244.30919 250.01158 254.08858 259.68658 262.14359 265.68057 268.50476 273.95877 277.79279 280.67636 285.35635 290.81036 299.55835 305.15634 310.55634 314.09332 316.55032 322.14832 324.60532 327.00201 329.45901 332.93842 338.25742 341.14099 349.88898 355.34299 360.94098 366.29599 369.56299 372.44656 378.04456 383.73254 387.26953 390.15311 396.15701 402.34091 407.75891 410.64249 416.04248 421.64047 427.23846 431.07248 436.42749 441.16779 445.84778 448.67197 451.12897 456.81696 459.64114 463.76315 468.44315 474.13113 479.72913 485.08414 488.91815 494.23715 496.69415 501.37415 506.82816 510.66217 513.48639 518.16638 523.85437 529.25439 534.85242 540.3064 547.65942">If destination mode is 32-bit or compatibility mode, but SSP address in “supervisor shadow </tspan><tspan y="-652.02069" x="137.82028 142.48318 146.00308 151.38599 156.04889 161.35078 165.49078 168.37439 171.89429 177.33119 182.63309 187.97099 193.67249 196.49669 198.93658 203.59949 206.42369 212.0631 217.4055 222.6273 228.08762 233.78911 239.36911 242.25272 247.95062 254.89952 261.04742">stack” token is beyond 4GB.</tspan><tspan y="-637.98071" x="138.11998 141.90358 145.06618 147.89037 153.95367 160.07729 165.49889 168.32307 173.72667 179.32828 184.92987 188.76747 194.12607 198.80966 203.49326 206.37685 208.77354 214.47505 217.35864 221.48424 226.22453 231.86664 237.50603 242.86462 246.70222 252.02483 254.42152 259.10513 264.56274 268.40033 271.28394 275.96753 281.65912 287.06271 292.66431 298.12192 305.47852 308.36212 313.04572 316.5863 321.9899 326.67349 331.99609 336.1217 339.00531 342.5459 348.00351 353.22531 358.56772 364.25931 367.14291 372.74451 378.20212 383.56073 388.24432 391.12793 396.77002 402.23032 405.7709 408.65451 417.4061 422.80969 426.35028 431.03387 436.67596 439.55957 445.62286 451.74646 457.16806 459.99228 465.39587 470.99747 476.59906 480.43665 485.79526 490.47885 495.16245 497.98666 500.44727 506.13885">If SSP address in “supervisor shadow stack” token does not match SSP address in </tspan><tspan y="-627.00073" x="137.82028 141.59848 147.74368 153.45688 159.21957 164.93277 170.34897 175.39256 177.78926 183.55196 189.55586 195.73976 201.13976 204.02336 208.09856 215.44975 221.13596 226.48915 230.32135 235.72404 238.54825 241.00345 243.82765 246.28285 250.96106 253.78526 257.32047 263.00665 268.40936 271.23355 276.91974 282.27295 289.62415 292.44833 298.71954 304.13574 309.13794 313.21313">IA32_PLi_SSP (where i is the new CPL).</tspan><tspan y="-613.02106" x="46.020287 53.380486 59.443787 65.597984 69.682182 75.04438 78.885582 82.726784 88.187988 92.02919 97.751389 102.43859 107.8998 113.505 118.8672 138.1866 141.9675 145.1337 147.9579 153.5631 159.2052 163.8924 169.5876 172.0518 177.74701 183.3522 186.23581 189.78001 195.42212 200.78432 203.60852 207.44972 212.81192 216.35612 222.05133 225.89253 231.58774 234.41194 239.81914 245.42433 251.02953 254.87073 260.23294 264.92014 269.60733 272.88153 275.70572 278.87192 281.33612 286.74332 292.34851 297.03571 300.30991 303.13409 308.59531 312.35999 315.24356 320.59857 324.43259 328.2666 333.72061 337.55463 340.37881 345.05881 350.51282 356.11081 361.51352 364.33771 369.79172 375.47971 379.01669 384.4707 387.29489 390.83188 396.51987 401.87488 404.75845 409.43845 412.97543 418.37543 423.05542 428.37442 431.19861 436.55362 441.87262 446.55261 451.90762 457.26263 462.90204 467.58203 470.40622 473.94321 479.6312 484.98621 487.86978 493.46777 498.92178 504.60977 510.29776 515.89575 520.57574 523.39996 528.85394 532.01294 534.83716 538.37415 544.06213 549.46484">#SS(error_code)If pushing the return address, flags, or error code onto the stack exceeds the bounds of the </tspan><tspan y="-601.98077" x="137.8203 142.4958 146.02831 151.4238 156.0993 161.4138 164.29739 168.9729 174.32339 179.9169 188.6604 194.01089 199.6944 203.2269 206.11049 211.50598 217.18948 222.78299 225.60718 231.29068 236.74017 239.62376 244.29927 247.83177 253.22726 257.90277 263.21729 266.10089 270.7764 278.12491 280.57742 284.10992 288.78543 294.46893 297.35254 302.75342 307.43341 312.17371 317.8158 321.64529 326.3208">stack segment and no stack switch occurs.</tspan><tspan y="-588.0011" x="138.12 141.9054 145.06979 147.89398 151.43639 157.12979 162.49019 165.37378 171.43709 177.5607 180.38489 184.22429 189.58469 195.18808 197.65048 202.33588 205.87828 211.23868 215.07808 217.96167 220.35837 225.03836 227.92195 233.52534 238.88574 241.34814 247.04155 252.64494 255.52853 257.92523 263.38553 268.79092 274.39432 279.75473 285.35812 288.24173 293.64713 299.34052 304.94391 307.76813 311.31052 317.00391 322.36432 325.18854 329.87393 335.23434 340.83774 349.54071 354.90112 360.59451 364.1369 366.96112 372.56451 378.02393 380.48633 386.17972 389.72211 395.08252 400.68591 403.56952 407.11191 412.57132 415.39554 417.85794 422.54333 425.42694 434.12991 439.53351 443.37289 448.5947 453.95511 459.5585 462.44211 468.0842 473.54449 477.08688 479.97049 485.57388 489.41327 494.77368 499.45908 504.81949 510.46158 514.00397">If the SS register is being loaded and the segment pointed to is marked not present.</tspan><tspan y="-574.02142" x="138.12 141.9054 145.06979 147.5934 153.19679 158.8902 163.57559 169.269 171.7314 177.3735 182.9769 185.5005 189.04291 194.73631 200.09671 202.62032 206.45972 211.82011 215.36252 221.05592 224.89532 230.58873 233.11234 238.51773 244.12112 249.72452 253.56392 258.92432 263.60971 268.2951 271.5675 274.09109 277.25549 279.7179 285.12329 290.72668 295.41208 298.68448 301.20807 306.56848 310.40787 314.24725 319.70667 323.54605 326.06964 330.75504 336.12 341.7594 347.10181 350.36432 352.88794 358.33743 362.16693 364.69055 369.43085 372.97055 378.36606 383.04156 388.35608 390.8797 395.55521 400.95789 406.55139 415.29489 420.64539 426.32889 429.86139 432.38501 437.97852 443.42801 445.88052 451.56403 455.09653 460.44702 464.27652 466.80014 472.15063 477.46515 482.14066 487.49115 492.84164 498.48105 503.15656 505.68018 509.21268 514.89618 520.2467 522.77026 528.36377 533.81329 539.49677 545.18024 550.77374 555.44922">If pushing the return address, flags, error code, or stack segment pointer exceeds the bounds </tspan><tspan y="-562.98114" x="137.8203 143.22119 146.4054 149.28899 152.83049 158.4726 163.87529 166.69948 172.39198 177.75148 185.10898 187.93317 192.61766 196.15916 201.56366 206.24815 211.57166 214.45525 219.13974 224.49924 230.10173 238.85423 244.21373 249.90623 253.44774 256.33133 263.68884 269.38135 274.74084 280.43335 283.25757 288.66208 291.54568 296.23019 299.7717 305.17621 309.86072 315.1842 318.00842 322.69293 330.05045 332.51193 336.05344 340.73795 346.38004 349.26364 354.72214 359.40665 364.09116 369.78366 373.62216 378.30667">of the new stack segment when a stack switch occurs.</tspan><tspan y="-549.00146" x="46.020302 53.372402 60.094501 65.511604 69.587708 74.941811 78.77491 82.608009 88.061111 91.894211 97.608315 102.28741 107.74052 113.33762 118.74032 138.11913 141.90002 145.05812 147.88232 152.56143 158.01453 163.61163 169.01433 171.83853 176.51764 181.92033 187.51744 196.26454 201.61864 207.30574 210.84184 214.10794 216.95999 219.35669 225.0582 228.5988 233.9574 237.795 241.6326 247.2747 252.87631 256.4169 259.24112 264.84271 270.24631 273.7869 279.14551 282.41611 285.29971 288.8403 292.50238 297.90598 303.50757 306.39117 311.99277 317.39636 320.93695 326.29556 329.56616 332.44977 335.99036 341.45425 346.13785 351.46045 354.34406 359.94565 365.34924 368.88983 374.24844 377.51904 380.34326 385.80087 389.63846 392.52206 397.98056 404.04385 410.19446 413.07806 415.53867 420.22226 423.04648 428.73807 434.19568 437.73627 440.56049 446.16208 449.99966 455.35828 460.04187 465.40048 471.09207 474.63266">#NP(error_code)If code segment, interrupt gate, trap gate, task gate, or TSS is not present.</tspan><tspan y="-535.02179" x="46.020294 53.372395 58.906494 65.052597 69.1287 74.482803 78.315903 82.149002 87.602104 91.435204 97.197906 101.87701 107.27791 112.87501 118.22911 138.14792 141.92882 145.08691 147.43051 150.96661 156.65372 162.00781 164.35141 170.64871 176.04871 181.0518 183.4557 188.9088 192.06689 194.47079 198.0069 203.694 209.0481 211.39169 216.0708 219.6069 225.006 229.68509 235.00319 237.34679 242.02588 247.42857 253.02568 261.77277 267.12686 272.81396 276.35007 278.69366 283.37277 288.72687 291.18295 296.53705 301.21616 304.81616 310.21707 314.05917 316.46307 318.85977 324.48029 326.88422 330.43112 336.07324 341.43814 343.78177 349.24026 355.30356 361.46045 363.80408 366.27097 370.96088 373.3045 379.00241 384.46631 388.01321 390.35684 395.72174 401.32965 407.02756 412.43747 414.83417 417.2381 420.785 426.2489 428.59253 432.13943 437.83734 443.20224 445.54587 452.48578 457.91367 462.92755 465.27118 470.73508 473.90399 476.24762 479.79453 485.49243 490.85733 493.26126 497.95117 503.35208 508.95999 514.32489 516.66846 521.35834 526.72327 532.33118 541.08905 546.45398 552.15186 555.69873">#TS(error_code)If the RPL of the stack segment selector in the TSS is not equal to the DPL of the code segment </tspan><tspan y="-523.98151" x="137.82028 143.41289 148.76248 151.21408 156.89668 162.48929 165.31348 170.70807 175.44838 180.12299 185.47258 190.14719 194.82179 200.17139 205.81079 208.63498 214.22758 219.54118 222.36537 225.89697 231.57957 236.92917 239.81276 242.26436 247.94696 251.47856 256.88126 260.70987 264.53848 270.22107 275.86047 279.40015 282.22433 287.67294 291.50156 294.32574 297.92572 301.58783 306.98242 312.57501 315.45859 321.05118 326.44577 329.97736 335.32697">being accessed by the interrupt or trap gate.</tspan><tspan y="-510.0018" x="138.11998 141.90718 145.07338 147.89758 154.83478 160.25998 165.27118 168.09538 173.55658 176.72278 179.54698 183.09119 188.78639 194.14859 196.97279 201.65999 205.20419 210.61139 215.29858 220.62479 223.44899 228.13618 233.49838 239.10358 247.85878 253.22098 258.86307 262.40726 265.29083 270.89603 276.25824 280.94543 285.63263 289.47382 291.93802 297.54321 301.0874 306.54861 310.3898 313.21399 318.81918 324.2804 326.67709 332.37857 335.92276 341.28497 346.89017 349.71436 353.25854 358.62 361.44418 367.04398 372.36478 375.18896 378.72775 384.41754 389.77435 392.65793 397.33972 400.87851 406.2803 410.9621 416.2829 419.10709 423.78888 429.14569 434.74548 443.49527 448.85208 454.54187 458.08066 460.96423 465.64603 471.00284 473.46164 478.81845 483.50024 487.03903 492.49484 496.33063 499.15482 501.61362 507.30341 510.12759 513.66638 519.3562 524.71301 527.53723 533.07404 539.07794 545.22675 548.05096 550.50977 555.19159">If DPL of the stack segment descriptor pointed to by the stack segment selector in the TSS is </tspan><tspan y="-498.96149" x="137.8203 143.4624 148.9227 152.4624 155.34599 160.70369 166.30438 171.99509 177.39778 179.85748 182.68167 186.22137 191.67807 194.56166 198.10136 203.79207 209.14977 211.97395 218.90665 224.32735 229.33405 232.15823 237.61493 240.77663 243.60081 247.14052 252.83122 258.18893 261.07254 265.75525 271.21194 276.81265 282.17035 285.05396 289.73666 295.09436 300.69507 309.44577 314.80347 320.49417 324.03387 326.91748 332.51819 337.87589 342.55859 347.2413 351.078 353.53769 359.1384 362.6781 368.1348 371.9715 374.8551 378.01682 383.41772 387.25443 390.13803 393.67773 399.36844 404.72614 407.55035 410.01004 415.70074 419.24045 424.59814 428.43484 432.27155 437.96225 443.56296 447.10266 449.98627 455.44296 459.27966 462.10388 465.64359 469.366 474.76871 480.36942 483.19363 488.79434 494.19705 497.73676 503.09445">not equal to the DPL of the code segment descriptor for the interrupt or trap gate.</tspan><tspan y="-484.98178" x="138.12 141.89819 145.05539 147.87959 151.41479 157.101 162.45419 165.3378 170.01601 173.55121 178.9494 183.62761 188.94481 191.76901 196.44722 201.80042 207.39662 216.14282 221.54552 227.24702 230.78223 233.60643 238.28464 243.63783 246.09303 251.44623 256.12442 259.65961 265.11182 268.94403 271.82761 274.28281 279.9249 282.80847 286.34366 292.02985 297.38306 300.20724 305.74045 311.80374 317.94894 320.77313 323.22833 327.90652 330.7901 337.51129 344.0885 349.0907 354.0929">If the stack segment selector in the TSS is NULL.</tspan><tspan y="-471.00208" x="138.12 141.90269 145.06439 147.8886 151.4283 157.119 162.4767 165.36031 170.043 173.5827 178.9854 183.66809 188.98979 191.814 196.49669 201.85439 207.45508 216.15808 221.51578 227.20648 230.74619 233.57039 236.73209 242.18878 246.02548 248.84969 252.38939 258.08008 263.43777 266.32138 271.77988 277.84317 283.99286 286.87646 289.27316 294.01346 296.83768 302.52838 307.98508 311.52478 314.349 319.75171 322.63531 329.99103 333.82773 336.28741 339.82712 345.22983 350.83054 353.29022 358.64792 361.53152 367.13223 372.53494 376.07465 381.47736 384.36096 389.04367 394.40137 400.00208 408.75278 414.11047 419.80118 423.34088">If the stack segment for the TSS is not a writable data segment.</tspan><tspan y="-456.96207" x="138.12 141.89909 145.05719 147.88139 152.56049 157.96318 163.56029 172.30739 177.66148 183.34859 186.70828 190.78708 195.46619 200.82028 203.27638 208.63048 213.30957 216.84567 222.29877 226.13187 228.95607 231.41217 237.09927 242.69638 248.09908 253.41718 256.30078 259.45889 264.91199 268.74509 271.62869 276.3078 279.8439 285.24301 289.92212 295.24023 298.06445 302.74356 308.09766 313.69476 322.44186 327.79596 333.48306 337.01917 339.84338 342.29947 346.97858 349.8028 355.25589 360.94299 364.4791 369.1582 371.61429 377.2114 382.56549 385.4491 391.0462 396.44891 401.12802 405.80713 409.64023 412.03693 417.67633 421.21243 426.66553 430.49863 433.32285 436.85895 442.25806 447.85516 450.31125 455.66534 458.54895 461.00504 463.40173 472.14883 474.60492 478.14102 482.82013 486.08624">If segment-selector index for stack segment is outside descriptor table limits. </tspan><tspan y="-442.98236" x="46.020294 53.370594 58.829998 63.993298 68.067596 71.2239 76.621201 82.306503 84.760803 88.120506 92.19931 96.87661 102.32791 107.92321 113.32591 138.16501 141.94591 145.1022 147.92639 153.32368 156.20728 161.80258 167.19987 172.79518 178.19788 181.02206 184.17836 189.57565 195.26096 197.71526 201.24956 204.13315 209.58444 214.26175 218.93906 224.62436 228.45566 233.13297">#PF(fault-code)If a page fault occurs.</tspan><tspan y="-429.00266" x="46.020294 53.368793 59.943295 66.868797 138.1524 141.9279 145.0824 147.90659 151.43909 157.12259 162.47308 165.35667 170.27966 177.35907 183.62756 189.85106 192.67525 198.31465 202.15675 207.50725 210.66174 213.05844 218.39993 221.28352 223.68022 228.36023 231.24382 236.92732 241.60283 246.95332 252.54683">#UD If the LOCK prefix is used.</tspan><tspan y="-414.96265" x="46.020294 53.374195 59.522095 65.795998 69.873901 75.553802 81.710701 87.246605 138.12541 141.90631 145.06621 147.89041 153.29131 155.74921 158.20711 163.80602 169.49492 178.24382 183.59972 189.28862 192.82652 195.65073 200.33163 206.02054 211.37643 216.05734 221.37724 223.83514 229.52405 235.12296 237.94716 240.40506 245.1003 247.9839 253.3371 259.02328 264.42148 270.01767 272.47287 277.82608 283.42227 286.68747 289.51166 293.04684 298.73303 304.13574 306.95993 312.55612 317.95432 321.4895 326.89221 329.7164 336.64459 342.06079 347.06299 349.94656 352.40176 357.07996 359.90414 365.61734 368.88254 371.70673 377.10492 382.79111 388.3873 391.27087 396.66907 399.49326 404.17145 407.70663 413.10483 417.84512 423.16232 426.0459 431.64209 437.32828 442.00647 447.69266 450.51685 452.97205 457.65024 460.47443 466.16061 471.8468 477.245 479.7002 482.1554 487.75159 493.43777 498.79099 504.38718">#AC(EXT)If alignment checking is enabled, the gate DPL is 3, and a stack push is unaligned.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-391.32001" x="46.02 52.198189 57.777782 63.078495 65.580444 68.650116 75.036469 80.676819 86.256416 89.738434 95.377785 100.12074 104.86369 107.38357 115.0448 120.68415 126.2737 131.91306 134.37317 139.95175 145.17378 149.61296 155.2523 160.65262 164.67346 167.15549 172.79483 178.50391">Real-Address Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-376.98001" x="46.02 53.337002 60.293102 138.11252 141.89342 145.05602 147.88022 153.28381 156.16742 164.87042 170.27312 178.97612 184.43642 188.27402 193.59662 196.42082 201.87842 207.48001 212.83861 216.5007 221.9043 227.5959 233.19751 236.08112 241.43971 244.60231 247.76491 253.1235 257.8071 261.34769 263.80829 269.03009 274.3887 277.27228 282.67587 288.27747 293.87906 297.71664 303.07526 307.75885 312.44244 315.26663 317.72723 322.41083 325.23502 330.69263 336.35999 339.90057 344.58417 347.04477 352.64636 358.00497 360.83008 364.37067 370.06226 375.42087 378.30536 384.58197 390.64618 393.91678 396.74188 403.67548 409.73969 413.01028 415.89478 421.57736 427.64157 430.91217 433.73727 438.90686 444.97107 448.24167 451.06677 456.52438 460.36197 463.24646 470.21606 476.36667 479.25116 483.93475 489.29337 494.89496 503.64655 509.00516 514.69678 518.23737 521.12189 523.51947 525.97644 534.72803 537.1886 540.72919">#GPIf a memory operand effective address is outside the CS, DS, ES, FS, or GS segment limit.</tspan><tspan y="-363.00031" x="138.11969 141.90599 145.07129 147.89549 151.4388 157.1331 162.4944 165.37801 167.84131 173.48341 177.02672 182.38802 186.22832 190.06862 195.71072 201.31502 204.85832 207.68253 212.90433 218.30702 222.99332 226.53662 231.99692 235.83722 238.66142 244.35573 250.05003 258.80432 264.40863 269.76993 273.61023 276.49384 278.89053 283.57056 286.45416 291.91446 297.60876 301.15207 305.83838 308.23508 313.87448 319.23578 322.06 325.6033 331.29761 336.65891 339.48312 343.26941 349.99423 355.53552 358.41913 360.81583 363.27191 372.02621 374.4895 378.03281 382.71912">If the interrupt vector number is outside the IDT limits.</tspan><tspan y="-348.9603" x="46.019989 53.379288 59.443489 138.16829 141.95009 145.11539 147.94049 152.62679 156.17009 161.57639 166.26268 171.58798 174.41309 176.87639 179.33969 188.09399 190.49159 194.0322 196.9167 202.242 204.6396 210.0999 212.5632 217.9695 221.5128 223.9761 229.4364 235.13071 237.95581 243.41611 249.11041 251.93552 257.53983 263.23413 267.92044 273.61475">#SSIf stack limit violation on push.</tspan><tspan y="-334.98059" x="138.11969 141.90689 145.07309 147.89729 153.50249 159.14459 163.83179 169.52699 171.9912 177.6864 183.2916 186.1752 189.71941 195.36151 200.76421 203.58841 207.42961 212.79181 216.33601 222.03122 225.87242 231.56763 234.39183 239.79903 245.40422 251.00941 254.85062 260.21283 264.90002 269.58722 272.86142 275.68561 278.85181 281.31601 286.72321 292.3284 297.01559 300.28979 303.11398 308.5752 312.41638 315.29996 320.66217 324.50336 328.34454 333.71939 337.55341 340.37759 345.05759 350.5116 356.10959 361.5123 364.33649 369.7905 375.47849 379.01547 384.46948 387.29367 390.83066 396.51865 401.87366 404.75723 409.43723 412.97421 418.37421 423.0542 428.3732 431.19739 436.5524 441.8714 446.55139 451.9064 457.26141 462.90082 467.58081 470.405 473.94199 479.62997 484.98499 487.86856 493.46655 498.92056 504.60855 510.29654 515.89453 520.57452 523.39874 528.85272 532.01172 534.83594 538.37292 544.06091 549.46362">If pushing the return address, flags, or error code onto the stack exceeds the bounds of the </tspan><tspan y="-324.00058" x="137.81909 142.4937 146.0253 151.41989 156.0945 161.4081 164.29169 168.96629 174.31589 179.90849 188.65109 194.00069 199.68329 203.21489">stack segment.</tspan><tspan y="-309.96057" x="46.019096 53.366695 59.940296 66.864899 138.1485 141.9231 145.07669 147.90088 151.43248 157.11508 162.46468 165.34827 170.27036 177.34886 183.61646 189.83905 192.66324 198.30174 202.14294 207.49254 210.64613 213.04193 218.38252 221.26611 223.66191 228.34102 231.22461 236.90721 241.58182 246.93141 252.52402">#UD If the LOCK prefix is used.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-286.32001" x="46.02 52.492008 54.980015 58.603462 62.624317 68.339363 73.646049 76.153976 79.229622 85.353027 91.53022 97.653625 103.77703 106.29691 113.96412 119.60347 125.199 130.83836 133.29849 138.83426 144.05629 148.49545 154.13481 159.53513 163.55597 166.04398 171.68333 177.39838">Virtual-8086 Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-271.98001" x="46.02 53.373901 60.340801 65.759705 69.837608 75.193512 79.028412 82.863312 88.318214 92.153114 97.869019 102.54992 108.00482 113.60372 118.95963 138.09903 142.17783 147.10083 152.56113 156.39603 159.22023 163.00113 169.72504 175.26094">#GP(error_code)(For INT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-271.98001" x="178.02031 183.7326 187.02391">n, </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-271.98001" x="189.78061 193.56331 200.289 205.62691 212.52631 215.79601 218.55991 224.0166 227.8533 230.6172 236.7849 243.8616 250.4433 257.16901 264.10172 266.86563 269.32532 275.01602 279.69873 283.23843 287.07513 292.76584 297.44855 300.98825 303.44794 308.90463 314.54672 318.62555 321.44977 325.23248 328.3942 331.21841 334.75812 340.44882 345.80652 348.57043 352.35315 359.42984 364.85056 369.85727 372.62119 375.08087 379.74091 382.50391 384.96359 390.32129 395.004 399.68671 402.51001 406.04971 411.69092 417.09363 422.78433 425.60764 431.32535 434.08835 439.54504 443.38174 446.14474 449.68445 455.37515 460.73285 463.55615 470.48886 475.90958 480.91629 483.67929 489.13599 492.2977 495.0607 498.6004 504.29111 509.6488 512.4118 514.87152 520.56219 524.10187 529.45959 533.29626 537.13293 542.82361 548.42432 551.96399 555.2337">INTO, or BOUND instruction) If the IOPL is less than 3 or the DPL of the interrupt, </tspan><tspan y="-261" x="137.82091 141.36061 145.02271 150.4254 155.8848 159.1545 162.03809 167.49478 171.33148 174.15567 177.69537 183.09807 187.78076 193.10246 195.92665 201.52734 206.93004 210.46974 215.82744 218.71103 221.10773 225.78772 228.67131 234.36201 239.81871 243.35841 246.1826 251.5403 257.14099 262.78308 268.18668 270.64636 273.52997 277.06967 282.52637 285.35059 291.0683">trap, or task gate is not equal to 3.</tspan><tspan y="-246.96001" x="138.12061 141.90601 145.0704 147.89459 151.437 157.1304 162.4908 165.37439 167.83679 173.4789 178.16429 181.7067 185.5461 191.2395 195.9249 199.4673 201.9297 207.3891 213.0825 215.90669 221.51009 226.91098 229.37338 235.06679 238.60919 243.96959 247.80899 250.69258 253.08928 258.79077 261.67438 265.21677 270.91016 276.27057 279.09479 282.88019 289.60498 295.14539 297.9696 303.42902 307.2684 310.09262 312.55502 318.24841 321.07263 324.61502 330.30841 335.66882 338.55243 341.01483 346.70822 350.25061 355.61102 359.45041 363.28979 368.98318 374.58658 378.12897 381.40137 384.28497 387.82736 391.48944 396.89484 402.35422 405.62662 408.45084 413.91025 417.74963 420.63324 424.17563 429.58102 434.26642 439.59082 442.47443 448.07782 453.48322 457.0256 462.38602 465.26962 467.73203 472.41742 475.24164 480.84503 486.20544 491.42725 496.88754 502.58093 508.18433 511.06793 514.61035 520.25159 525.612 528.43622 533.12164 538.58105 544.18445 549.54486">If the instruction pointer in the IDT or in the interrupt, trap, or task gate is beyond the code </tspan><tspan y="-235.98001" x="137.82091 142.50092 147.85591 153.45392 162.20192 167.55692 173.24492 176.78192 179.60612 182.06313 184.52013 193.26813 195.66483 199.20453 203.94482">segment limits.</tspan><tspan y="-222.00031" x="138.12061 141.90691 145.0722 147.89641 151.43971 157.13402 162.49532 165.37892 170.06522 175.42651 181.03081 189.78511 195.14641 200.84071 204.38402 207.26762 211.95392 217.31522 219.77852 225.13982 229.82611 233.36942 238.82971 242.67001 245.49422 247.95752 253.65182 256.53543 260.07874 265.72086 271.08215 273.90637 276.36966 282.06396 285.60727 290.96857 294.80887 298.64917 304.34348 309.94778 313.49109 316.7644 319.58862 323.13193 326.79404 332.20035 337.65976 340.93304 343.75726 349.21756 353.05786 355.94147 359.48477 364.89108 369.57739 374.90268 377.7269 383.33121 388.73752 392.28082 397.64212 400.46634 402.92963 407.61594 410.44016 417.16946 423.75476 428.76508 433.77539">If the segment selector in the interrupt, trap, or task gate is NULL.</tspan><tspan y="-207.96031" x="138.12061 141.90871 145.07581 147.90001 153.30811 156.19171 158.58841 164.28992 167.83502 173.19812 176.97992 180.82202 186.51813 192.12422 195.66933 198.49353 204.09962 209.50772 213.05283 218.41592 221.69102 224.57463 228.11974 231.78185 237.18994 242.79604 245.67964 251.28574 256.69385 260.23895 265.60205 268.87714 271.70135 275.24646 280.65457 285.39487 290.67694 293.56055 299.16666 304.57477 308.11987 313.48297 316.75806 319.58228 324.27039 329.73248 335.33859 340.5603 343.38449 348.06628 353.46899 359.06879 367.81857 373.17538 378.86517 382.40396 385.67276 388.55634 394.01215 397.84793 400.67212 406.20892 412.21283 418.36163 421.18582 425.86761 431.27032 436.87012 445.6199 450.97672 456.6665 460.20529 463.02948 467.71127 473.11398 475.51068 480.91339 485.59518 489.13397 494.58978 498.42557 501.24976 503.70856 509.39835 514.99817 520.35498 525.67578 528.5 530.9588 535.64062">If a interrupt gate, trap gate, task gate, code segment, or TSS segment selector index is </tspan><tspan y="-196.98032" x="137.82001 143.2209 148.92241 152.45941 157.1394 159.59641 165.19441 170.59711 173.42131 175.87831 179.41531 184.09531 186.91951 192.51752 197.87251 202.55252 207.23251 211.06651 213.52351 219.12152 222.65852 228.11252 231.94652 234.77072 238.30772 243.77162 249.36963 251.82663 257.18164 260.00583 262.46283 264.91983 273.66782 276.06451 279.60419 284.28418">outside its descriptor table limits.</tspan><tspan y="-183.00061" x="138.11971 141.8997 145.0587 147.8829 151.41991 157.10791 162.46291 165.34651 170.56831 175.91071 180.5907 184.1277 189.5817 193.4157 196.2993 200.97931 206.3343 208.79131 214.1463 218.82629 222.3633 227.0433 229.92691 235.3269 238.15111 243.74911 249.15181 253.83182 258.51181 262.34583 264.80283 270.40082 273.93781 279.39182 283.22583 286.05002 291.50403 297.19202 300.729 305.409 307.866 313.46399 318.819 321.70258 325.23956 330.92755 336.28256 339.10675 342.94794 349.61243 355.14743 357.97162 360.42862 362.88562 371.63361 374.09061 377.62759 382.30759">If the vector selects a descriptor outside the IDT limits.</tspan><tspan y="-168.96062" x="138.11971 141.90781 145.07491 147.89911 153.30721 159.00331 161.82751 165.66872 172.33321 177.87631 180.70052 186.30661 191.66971 196.3578 201.0459 204.888 207.3531 212.9592 216.5043 221.9664 225.8085 228.63271 231.09781 235.7859 238.66951 244.31161 249.77191 253.31702 256.20062 261.60873 267.30484 270.12906 272.59415 278.29025 281.83536 287.19846 291.04056 294.88266 300.57877 306.18488 309.72998 313.00507 315.82928 319.37439 323.0365 328.44461 333.90402 337.17911 340.00333 345.46542 349.30753 352.19113 355.73624 361.14435 365.83246 371.15955 374.04315 379.64926 385.05737 388.60248 393.96558">If an IDT descriptor is not an interrupt, trap, or task gate.</tspan><tspan y="-154.98091" x="138.11971 141.8916 145.0425 147.8064 153.1983 158.8782 161.64211 164.091 169.7709 173.2998 178.6467 182.4726 186.29849 191.97839 197.5683 201.0972 203.9214 206.3703 211.11061 213.87451 219.46442 224.86711 230.54701 235.94971 239.6118 245.01541 248.54431 253.8912 259.53061 262.29453 267.88443 273.19534 275.95926 279.73117 286.44608 291.97296">If an interrupt is generated by INT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-154.98091" x="294.83942">n</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-154.98091" x="300.53912 303.80072 306.62491 310.39951 317.1171 322.6467 328.35629 331.65839 334.42227 339.87088 343.69949 346.46338 350.30457 357.02396 362.30246 369.38187 372.20605 377.60065 383.28323 388.92264 391.68652 395.21811 400.9007 406.25031 409.07449 415.99908 421.41168 426.45529 429.21918 434.66779 437.85199 440.61588 446.01047 451.69305 454.51724 456.96884 462.65143 466.18301 471.53262 475.36124 479.18985 484.87244 490.51184 494.05151 497.31311 500.077 503.60858 507.33099 512.72559 518.185 521.44659 524.27081 529.71942 533.54803 536.31195 539.84357 545.23816 549.91278 555.25427">, INT3, or INTO and the DPL of an interrupt, trap, or task </tspan><tspan y="-144.00092" x="137.81912 143.41983 148.82253 152.36223 157.71992 160.60352 163.00021 167.68021 170.5638 173.0235 178.3812 183.06389 187.74658 190.57077 194.11047 199.80118 205.20387 210.89458 213.77817 217.31787 222.95998 228.31767 231.14186 237.41756 242.83826 247.84496">gate is less than the CPL.</tspan><tspan y="-129.96092" x="138.11882 141.90422 145.06862 147.77222 151.31462 156.95673 162.31712 165.02072 169.70612 175.06651 180.66991 189.42331 194.78371 200.47711 204.01952 206.72311 211.40851 216.76891 219.23131 224.59171 229.2771 232.8195 238.2789 242.1183 244.8219 247.2843 252.97771 255.62192 261.02731 266.7207 269.42432 271.88672 277.58011 281.1225 286.48291 290.3223 294.16168 299.85507 305.45847 309.00085 311.70447 317.16388 321.00327 323.70688 327.24927 330.91135 336.31674 341.92014 344.62375 350.22714 355.63254 359.17493 364.53534 367.23895 372.84235 378.30176 383.66217 388.34756 391.05118 396.74457 402.20398 405.74637 408.44998 414.05338 419.51279 421.97519 427.61728 431.15967 433.86328 437.40567 442.86508 445.5687 450.97409 453.6777 458.3631 463.72351 469.3269 478.02988 483.39029 489.03238 492.57477 495.27838 500.88177 506.24219 510.92758 515.61298 519.45239 521.91479 527.51819 531.06061 536.52002 540.35944 543.06305 546.22748 551.62842 555.46783">If the segment selector in an interrupt or trap gate does not point to a segment descriptor for </tspan><tspan y="-118.98092" x="137.81912 143.21642 146.0406 150.71791 156.1692 161.76451 167.16721 169.99139 174.6687 180.021 185.6163 194.3616 199.7643 205.46581 209.00011">a code segment.</tspan><tspan y="-105.00122" x="138.11882 141.90422 145.06862 147.89282 151.43523 157.12863 162.48903 165.37263 170.05803 175.41843 181.02182 189.77522 195.13562 200.82903 204.37143 207.25504 211.94043 217.30083 219.76323 225.12363 229.80902 233.35143 238.81082 242.65022 245.47443 248.63882 254.09822 257.93762 260.8212 266.22659 269.05078 274.50928 280.57257 286.72498 289.54916 295.24255 300.64795 305.33334 308.15753 310.61993 314.16232 318.84772 321.73129 324.1937 329.5946 334.28 339.7439 342.14059 346.21939 351.82278 354.21948 359.67889 365.28229 370.68768 373.0835 375.96707 381.57047 384.03287 387.57526 390.39944 395.08484 400.48755 404.02994 406.85413 410.01852 415.47794 419.31732 422.14151 424.60391 430.06332 434.74872 440.15411 442.61652">If the segment selector for a TSS has its local/global bit set for local.</tspan><tspan y="-90.96122" x="46.019119 53.365818 59.429119 65.613014 69.691818 75.04052 78.868217 82.695915 88.143616 91.971313 97.680016 102.35371 107.80141 113.39311 118.79581 138.11522 141.89612 145.04881 147.873 151.4037 157.0854 162.4341 165.31769 171.381 177.50459 180.32878 184.15648 189.55917 195.15088 197.60158 202.27528 205.80598 211.15468 214.98238 217.86597 220.31667 224.99037 227.87396 233.46567 238.81436 241.26506 246.94676 252.53847 255.42206 257.87277 263.32047 268.71417 274.35358 279.70227 285.29398 288.11911 293.52631 299.2215 304.82669 307.65088 311.19507 316.89026 322.25247 325.07666 329.76385 335.12607 340.73126 349.43427 354.79648 360.49167 364.03586 366.86005 372.46524 377.92645 380.39066 386.08585 389.63004 394.99225 400.59744 403.48102 407.02521 412.48642 415.31061 417.77481 422.46201 425.34558 434.04858 439.45218 443.29337 448.51517 453.87738 459.48257 462.36615 468.00824 473.46857 477.01276 479.89633 485.50153 489.34271 494.70493 499.39212 504.75433 510.39642 513.94061">#SS(error_code)If the SS register is being loaded and the segment pointed to is marked not present.</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="509.87729pt" height="631.71692pt" viewBox="0 0 509.87729 631.71692" sodipodi:docname="624.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.0943" inkscape:cy="406.47343" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg122" /><g transform="translate(-45.679276,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-715.97998" x="137.22 141.009 144.177 147.00121 152.6082 158.25031 162.9393 168.63631 171.10231 176.79932 182.40631 185.28992 188.83592 194.47803 199.84203 202.66623 206.50923 211.87323 215.41924 221.11624 224.95924 230.65625 233.48045 238.94435 244.55135 250.15834 254.00134 259.36536 264.05435 268.74335 272.01935 274.84354 278.01154 280.47754 285.88654 291.49353 296.18253 299.45853 302.28271 307.64673 311.48972 315.3327 320.73361 324.5766 327.46017 332.14917 337.49969 343.09229 348.44189 351.74399 354.56821 359.2428 362.77438 368.23828 372.91827 378.23187 381.11548 385.79007 391.13968 396.73227 405.47488 410.82449 416.50708 420.03867 422.92227 428.51486 433.96347 436.41507 442.09766 445.69763 451.04004 453.56186 456.86395 459.68817 465.13678 468.96539 471.849 477.44159 482.83618 486.36777 491.76236 494.64597 499.32056 504.67017 510.26276 519.00537 524.35498 530.0376 533.56921 538.24384">If pushing the return address, flags, error code, stack segment pointer, or data segments </tspan><tspan y="-705" x="136.9194 142.269 147.4899 152.16451 157.5141 162.91589 168.495 173.1696 175.99289 179.52449 185.20709 190.60889 193.43217 199.02478 204.47337 210.15598 215.83858 221.43118 226.10579 228.98848 234.43707 237.59067 240.47336 244.00496 249.68756 255.03716 257.86047 262.53506 266.06665 271.52963 276.20871 281.52231 284.405 289.07959 294.4292 300.02179 308.7644 314.11401 319.7966 323.32819">exceeds the bounds of the stack segment.</tspan><tspan y="-691.02032" x="45.119408 52.478706 59.208008 64.632309 68.715607 74.076904 77.917206 81.757507 87.217804 91.058105 96.779404 101.46571 106.92601 112.53031 117.89161 137.2704 141.0513 144.2166 147.0408 151.7271 157.18739 162.79169 168.15298 170.97719 175.66348 181.02478 186.62907 195.38338 200.74467 206.43898 209.98228 213.25558 216.13919 218.60249 224.2446 227.7879 233.1492 236.9895 240.8298 246.47191 252.0762 255.61951 258.44373 264.04803 269.45435 272.99765 278.35895 281.63226 284.45911 287.99701 291.65912 297.06003 302.65894 305.54254 311.14145 316.54236 320.08026 325.43616 328.70407 331.58768 335.12558 340.52649 345.2074 350.52728 353.41089 359.0098 364.41071 367.94861 373.3045 376.57242 379.39664 384.85153 388.68643 391.57004 397.02853 403.09183 409.23972 412.12332 414.58121 419.26212 422.08633 427.77524 433.23013 436.76804 439.59225 445.19116 449.02606 454.38196 459.06287 464.41876 470.10767 473.64557">#NP(error_code)If code segment, interrupt gate, trap gate, task gate, or TSS is not present.</tspan><tspan y="-676.98035" x="45.119415 52.474216 58.011017 64.159821 68.238617 73.641312 77.423111 81.258911 86.714714 90.550514 96.31321 100.99501 106.45081 112.05061 117.40741 137.3262 141.1071 144.2679 146.6718 150.2106 155.90041 161.2572 163.6611 169.90891 175.3287 180.3345 182.7384 188.1393 191.3235 193.7274 197.2662 202.95601 208.31281 210.71671 215.3985 218.9373 224.3391 229.02089 234.34169 236.74559 241.42738 246.78418 252.38397 261.13376 266.53647 272.17856 275.71735 278.12125 282.80304 288.20575 290.60245 296.00516 300.68695 304.22574 309.68155 313.51733 315.92123 318.31793 323.87912 326.28302 329.82361 335.5152 340.87381 343.27771 348.73621 354.7995 360.9501 363.354 365.7507 370.43069 372.83459 378.52618 383.9838 387.52438 389.92828 395.2869 400.88849 406.53058 411.93417 414.39478 416.79868 420.33926 425.79688 428.20078 431.74136 437.43295 442.79156 445.19547 452.12906 457.55066 462.55826 464.96216 470.41977 473.58237 475.98627 479.52686 485.21844 490.57706 492.98096 497.66455 503.12216 508.72375 514.08234 516.48621 521.1698 526.52838 532.13 540.88159 546.24017 551.93176 555.47235">#TS(error_code)If the RPL of the stack segment selector in the TSS is not equal to the DPL of the code segment </tspan><tspan y="-666.00037" x="136.91942 142.51292 147.86342 150.31592 155.99942 161.59293 164.47652 169.87201 174.54752 179.22302 184.57352 189.24902 193.92453 199.27502 204.91443 207.73862 213.33212 218.64662 221.47081 225.00331 230.68681 236.03731 238.9209 241.3734 247.0569 250.5894 255.9921 259.82159 263.65109 269.33459 274.974 278.5137 281.33792 286.78741 290.61691 293.50052 297.03302 300.69513 306.09064 311.68414 314.56775 320.16125 325.55676 329.08926 334.43976">being accessed by the interrupt or trap gate.</tspan><tspan y="-652.02069" x="137.21912 141.00362 144.16711 146.99132 153.92581 159.34831 164.35681 167.24042 172.69891 175.86241 178.68661 182.22812 187.92062 193.28012 196.16373 200.84822 204.38972 209.79422 214.47871 219.80222 222.68582 227.37032 232.72981 238.33231 247.03531 252.39481 258.0369 261.5784 264.46201 270.06451 275.42401 280.16431 284.84433 288.68283 291.07953 296.68204 300.22354 305.68204 309.52054 312.34476 315.50827 320.96677 324.80527 327.62949 331.17099 336.86349 342.22299 345.1066 350.56509 356.62839 362.77988 364.88409 369.62439 372.44861 377.13312 380.67462 386.07913 390.76364 396.08713 398.91135 403.59586 408.95535 414.55786 423.31036 428.66986 434.36237 437.90387 440.72809 443.18958 447.87408 450.6983 456.39081 461.8493 465.39081 468.27441 473.63391 479.23642 484.92892 490.33344 492.79492 495.61914 499.16064 504.61914 507.50275 511.04425 516.73676 522.09625 524.92047 531.85498 537.27747 542.28595 545.11017 550.56866 553.73218">If DPL of the stack segment descriptor for the TSS’s stack segment is not equal to the DPL of </tspan><tspan y="-640.98041" x="136.91942 140.46362 146.10573 151.46793 154.29213 158.97932 164.44052 170.04572 175.40791 178.23212 182.91931 188.28151 193.8867 202.64191 208.0041 213.69931 217.24352 220.06772 225.67291 231.03511 235.72231 240.4095 244.2507 246.7149 252.3201 255.8643 261.3255 265.16669 267.99088 271.15707 276.61829 280.45947 283.28366 286.82785 292.52304 297.88525 300.76883 303.23303 308.87512 312.41931 317.78152 321.62271 325.4639 331.10599 336.71118 340.25537 343.07956 348.54077 352.38196 355.26553 358.80972 362.4718 367.879 373.48419 376.36777 381.97296 387.38016 390.92435 396.28656">the code segment descriptor for the interrupt or trap gate.</tspan><tspan y="-627.00073" x="137.21912 140.99731 144.15451 146.9787 150.5139 156.2001 161.5533 164.43689 169.1151 172.6503 178.04849 182.7267 188.0439 190.86809 195.5463 200.89949 206.4957 215.2419 220.64459 226.3461 229.8813 232.70549 237.3837 242.73689 245.19209 250.54529 255.2235 258.7587 264.21091 268.04312 270.92673 273.38193 279.02402 281.90762 285.44281 291.129 296.48221 299.30643 304.83963 310.90292 317.04813 319.93173 322.32755 327.00754 329.89114 336.61234 343.18954 348.19174 353.19394">If the stack segment selector in the TSS is NULL.</tspan><tspan y="-613.02106" x="137.21912 141.00182 144.16351 146.98772 150.52742 156.21812 161.57582 164.45943 169.14212 172.68182 178.08452 182.76721 188.08891 190.91312 195.59581 200.95351 206.5542 215.2572 220.6149 226.3056 229.84531 232.66951 235.83121 241.2879 245.1246 247.94881 251.48851 257.1792 262.5369 265.4205 270.879 276.94229 283.09198 285.97559 288.43527 293.11798 295.9422 301.6329 307.0896 310.6293 313.45352 318.85623 321.73984 329.09555 332.93225 335.39194 338.93164 344.33435 349.93506 352.39474 357.75244 360.63605 366.23676 371.63947 375.17917 380.58188 383.46548 388.14819 393.50589 399.1066 407.8573 413.215 418.9057 422.4454">If the stack segment for the TSS is not a writable data segment.</tspan><tspan y="-598.98108" x="137.21912 141.00092 144.16171 146.98592 151.66771 157.0704 162.6702 171.42 176.77679 182.4666 185.82631 189.90511 194.5869 199.9437 202.4025 207.75929 212.44109 215.97989 221.43568 225.27148 228.15509 230.55179 236.2533 241.85309 247.25578 252.57658 255.46019 258.621 264.02191 267.8577 270.74127 275.42307 278.96185 284.36365 289.04544 294.36624 297.19043 301.87222 307.22903 312.82883 321.57861 326.93542 332.62521 336.164 338.98819 341.44699 346.12878 348.95297 354.40878 360.09857 363.63736 368.31915 370.77795 376.37775 381.78046 384.60464 390.20444 395.60715 400.28894 404.97073 408.80652 411.20322 416.84262 420.38141 425.83722 429.673 432.49719 436.03598 441.43777 447.03757 449.49637 454.85318 457.73676 460.19556 462.59225 471.34204 473.80084 477.33963 482.02142 485.29022">If segment-selector index for stack segment is outside descriptor table limits. </tspan><tspan y="-585.0014" x="45.119415 52.469715 57.929119 63.092419 67.166718 70.323021 75.720322 81.405624 83.859924 87.219627 91.298431 95.975731 101.42703 107.02233 112.42503 137.26413 141.04503 144.20132 147.02551 152.42281 155.3064 160.9017 166.299 171.8943 177.297 180.12119 183.27748 188.67477 194.36008 196.81438 200.34868 203.23227 208.68356 213.36087 218.03818 223.72348 227.55478 232.23209">#PF(fault-code)If a page fault occurs.</tspan><tspan y="-571.02173" x="45.119415 52.469715 59.541016 137.24252 141.02252 144.17882 147.00212 150.53642 156.22173 161.57402 164.45673 168.23402 174.95433 180.29134 187.30954 190.19225 192.64655 198.33185 203.00916 206.54346 210.37476 216.06006 220.73737 224.27167 226.72597 232.17726 237.86256 240.68587 243.14017 247.81747 250.70018 256.05249 261.27341 266.6257 271.30301 276.98831 280.52261 285.87491 291.51343 294.33673 299.73404 305.41934 311.01465 313.89734 317.43164 323.11694 328.51874 331.34204 338.41333 343.57663 346.45932 349.61563 352.06995 357.46725 363.10577 365.92908 368.38339 373.0607 375.884 380.56131 385.9631 389.49741">#OFIf the INTO instruction is executed and the OF flag is set.</tspan><tspan y="-556.98175" x="45.119415 52.469715 59.046017 66.011124 137.23624 141.01353 144.16983 146.99492 150.52922 156.21452 161.56682 164.45131 169.37521 176.45552 182.72581 188.95111 191.7762 197.4165 201.25951 206.6118 209.7681 212.2224 217.5387 220.42319 222.82079 227.50169 230.38618 236.07149 240.74879 246.10109 251.6964">#UD If the LOCK prefix is used.</tspan><tspan y="-543.00208" x="45.119415 52.473316 58.621216 64.895119 68.973022 74.652924 80.809822 86.345726 137.22453 141.00543 144.16533 146.98953 152.39043 154.84833 157.30623 162.90514 168.59404 177.34294 182.69884 188.38774 191.92564 194.74985 199.43076 205.11966 210.47556 215.15646 220.47636 222.93427 228.62317 234.22208 237.04628 239.50418 244.19942 247.08302 252.43802 258.12601 263.526 269.12399 271.58099 276.936 282.534 285.80099 288.62518 292.16217 297.85016 303.25287 306.07706 311.67505 317.07504 320.61203 326.01474 328.83893 335.76892 341.18692 346.19092 349.07449 351.53149 356.21149 359.03568 364.75067 368.01767 370.84186 376.24185 381.92984 387.52783 390.35202 395.75201 398.5762 403.3165 406.85617 412.25616 416.93616 422.25516 425.13873 430.73672 436.42471 441.10471 446.79269 449.61688 452.07388 456.75388 459.57806 465.26605 470.95404 476.35403 478.81104 481.26804 486.86603 492.55402 497.90903 503.50702">#AC(EXT)If alignment checking is enabled, the gate DPL is 3, and a stack push is unaligned.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-519.29999" x="45.119999 50.603973 56.19751 64.480247 70.093704 75.41832 79.408295 81.868416 87.508766 90.014702 92.540558 95.000679 99.02153 104.55531 107.07519 114.76032 120.35386 125.96732 131.56085 134.08073 139.63443 144.91721 149.35637 154.93596 160.39603 164.35712 166.86305 172.45659 178.18956">Compatibility Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-504.95999" x="45.119999 51.267899 56.6688 65.417702 70.773605 73.657204 79.013107 84.234909 88.91581 94.318512 99.917412 103.45531 105.91322 111.36812 117.05702 121.73792 124.62152 130.02242 134.70331 137.52751 139.98541 145.67432 148.49852 154.09743 157.93233 163.38722 166.92513 172.28102 176.96191 180.49982 185.85571 191.45462 194.27882 203.02773 208.48262 214.08153 219.43742">Same exceptions as in protected mode.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-481.32001" x="45.119999 51.264324 57.408649 60.505215 66.818863 69.327789 73.320755 75.780876 83.469002 89.065529 94.681976 100.2785 102.73862 108.29531 113.57809 117.9575 123.59686 128.99718 133.01804 135.52696 141.12349 146.85945">64-Bit Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-466.98001" x="45.119999 52.478401 59.449802 64.873199 68.955597 74.315994 78.155396 81.994797 87.454193 91.293594 97.013992 101.69939 107.1588 112.7622 118.1226 137.26199 141.04289 144.20729 147.03148 150.57388 156.26729 161.62769 164.51128 166.97368 172.61578 177.30118 180.84358 184.68298 190.37639 195.06178 198.60419 201.06659 206.52599 212.21939 215.04358 220.64697 226.04787 228.51027 234.20367 237.74608 243.10648 246.94588 249.82947 252.29187 257.93396 260.81757 264.35995 270.05334 275.41376 278.23798 283.95837 289.67877 293.76117 299.28 301.74149 305.28299 308.10721 310.5687 316.2612 319.8027 325.1622 329.0007 332.8392 338.53171 344.13422 347.67572 350.55933 356.16183 361.56635 365.10785 370.46735 373.29156 378.75006 382.58856 385.41278 388.95428 392.6767 398.08121 403.68372 406.50793 412.11044 417.51495 421.05646 426.41595 429.29956 431.69626 436.37628 439.25989 444.95239 450.41089 456.05298 460.13181 464.81631 470.22083 475.91333 481.37183 487.06433 489.52582 494.21033 499.61484 502.07632">#GP(error_code)If the instruction pointer in the 64-bit interrupt gate or trap gate is non-canonical.</tspan><tspan y="-453.00031" x="137.2197 140.99879 144.15689 146.98108 150.51718 156.20428 161.55838 164.44197 169.12106 174.47516 180.07227 188.81937 194.17346 199.86057 203.39667 206.28026 210.95935 216.31345 218.76955 224.12364 228.80273 232.33884 237.79193 241.62503 244.50862 246.90532 252.60683 255.49042 259.02652 264.66861 270.07132 272.89554 278.60965 284.37238 288.44849 294.04559 296.50168 300 302.82422 305.28751 310.98181 314.52512 319.88641 323.72672 327.56702 333.26132 338.86563 342.40894 345.29254 350.75284 354.59314 357.41736 360.96066 364.62277 370.02908 375.63339 378.45761 384.06192 389.46823 393.01154 398.37283 401.19705 403.66034 408.34665 411.17087 417.90018 424.48547 429.49579 434.5061">If the segment selector in the 64-bit interrupt or trap gate is NULL.</tspan><tspan y="-438.9603" x="137.2197 141.0015 144.16229 146.98648 150.52528 156.21509 161.57188 164.45547 169.67728 175.01967 179.70146 183.24026 188.69606 192.53186 195.41545 200.09724 205.45404 207.91284 213.26964 217.95143 221.49023 226.17203 229.05562 234.45741 237.2816 242.88141 248.2382 252.92 257.60181 261.43759 263.89639 269.49619 273.03497 278.49078 282.32657 285.15079 290.6066 296.29639 299.83517 304.51697 306.97577 312.57556 317.93237 320.81598 324.35477 330.04456 335.40137 338.28497 342.06677 348.73126 354.26807 357.09229 359.55109 362.00989 370.75967 373.21848 376.75726 381.43906">If the vector selects a descriptor outside the IDT limits.</tspan><tspan y="-424.98059" x="137.2197 141.0033 144.16589 146.99008 150.53069 156.22229 161.58089 164.46448 169.68628 175.02867 179.71227 183.25287 188.71046 192.54807 195.43166 201.03326 206.49086 208.95146 214.64307 218.18367 222.86726 225.69145 229.23206 234.68965 237.57324 242.97684 245.80103 251.40262 256.80621 260.3468 265.70541 268.52963 275.88623 281.57782 283.97452 288.65451 294.3461 297.22971 299.6264 304.3064 307.19 309.6506 315.29269 318.1763 323.86789 329.3255 334.96759 339.04639 343.72998 349.13358 354.82516 360.28278 365.97437 368.43497 373.11856 378.52216 380.98276 383.80698 388.49057 394.09216 399.49576 404.23605 409.59467">If the vector points to a gate which is in non-canonical space.</tspan><tspan y="-411.00089" x="137.2197 141.006 144.1713 146.9955 150.5388 156.23311 161.59441 164.47801 169.69981 175.04221 179.7285 183.2718 188.7321 192.5724 195.45601 201.0603 206.5206 208.9839 214.67821 218.22151 222.90781 225.73201 229.27531 234.73561 237.61922 243.02551 245.84972 251.45401 256.81531 261.50162 266.18793 270.02823 272.42493 278.06433 281.60764 287.06793 290.90823 293.73245 301.09177 306.73389 309.19717 313.88348 319.57779 322.4614 324.85809 329.53812 332.42172 338.11603 343.49969 347.043 349.8681 355.27441 358.15891 363.88022 369.60153 373.68484 379.28915 381.75244 385.29575 388.18024 390.57782 396.28021 399.82352 405.18481 409.02512 412.86542 418.55972 424.16403 427.70734 430.53244 436.13675 441.54306 445.08636 450.44766 453.27277 458.73306 462.57336 465.45786 470.86417 473.68927 479.41058 485.1319 489.21521 494.81952 497.28281 500.82611 503.65121 507.19452 510.85751 516.26379 521.8681 524.69318 530.29749 535.7038 539.24707 544.6084">If the vector points to a descriptor which is not a 64-bit interrupt gate or a 64-bit trap gate.</tspan><tspan y="-396.96088" x="137.2197 141.0042 144.16769 146.991 150.5325 156.22501 161.5845 164.46721 170.0697 175.4292 180.11369 184.85399 188.63579 191.09189 196.69438 200.23589 205.63678 209.47888 212.36159 217.96408 223.42258 225.88408 231.57658 235.11809 240.47758 246.08008 248.96278 252.50429 257.9628 260.7861 266.38861 271.7121 274.5354 278.0769 283.76941 289.12891 292.0116 297.61411 303.01862 306.56012 311.91962 314.74292 319.42743 324.78693 327.24841 332.60791 337.29242 340.83392 346.29242 350.13092 353.01361 355.4751 360.15961 362.98291 368.44141 374.13391 377.67542 382.35992 384.82141 390.42392 395.78342 398.66611 402.20761 407.8497 413.2092 416.0325 421.63501 426.99451 431.67902 436.36353 440.20203 442.66351 448.26602 451.80753 457.26602 461.10452 463.92783 467.46933 472.87384 478.47635 480.87305 486.23254 489.05585 491.51733 493.97882 502.68182 505.14331 508.68481">If the descriptor pointed to by the gate selector is outside the descriptor table limit.</tspan><tspan y="-382.98117" x="137.2197 141.0006 144.16049 146.9847 150.5226 156.2115 161.5674 164.451 170.04991 175.40581 180.0867 184.82701 188.60881 191.06491 196.66382 200.20172 205.60262 209.44472 212.32832 217.92723 223.38213 225.84003 231.52893 235.06683 240.42273 246.02164 248.90524 252.44315 257.89804 260.72226 266.32117 271.64105 274.46527 278.00317 283.69208 289.04797 291.93158 297.53049 302.9314 306.4693 311.87201 314.69623 319.37714 324.73303 327.19092 332.54681 337.22772 340.76562 346.22052 350.05542 352.93903 355.39691 360.07782 362.90204 365.35992 371.04883 373.87305 379.56195 385.01685 390.70575 394.78366 399.46457 404.86548 410.55438 415.95529 421.6442 424.10208 428.78299 434.1839 436.64178 439.466 444.14691 449.74582 455.14673 459.82764 465.18353">If the descriptor pointed to by the gate selector is in non-canonical space.</tspan><tspan y="-369.00146" x="137.2197 140.99429 144.14789 146.97208 150.50368 156.18628 161.53587 164.41946 170.01207 175.36166 180.03627 184.77658 188.60518 191.05678 196.69618 200.23589 205.68448 209.51308 212.39667 217.98927 223.43787 225.88947 231.57207 235.10367 240.45326 246.04587 248.92946 252.46106 257.90967 260.73389 266.32648 271.64008 274.46429 277.99588 283.67847 289.02808 291.90002 297.49713 302.89624 306.43234 311.83505 314.65927 319.33838 324.69247 327.14856 332.50266 337.18176 340.71786 346.17096 350.00406 352.88766 355.34375 360.02286 362.84708 368.53418 373.98727 377.52338 380.3476 385.7467 388.63031 393.30942 398.76251 404.35962 409.71371 412.59732 417.27643 422.63052 428.22763 436.97473 442.32883 448.01593 451.55203">If the descriptor pointed to by the gate selector is not a code segment.</tspan><tspan y="-354.96146" x="137.21971 140.99521 144.1497 146.97389 150.50639 156.1899 161.54039 164.42398 170.01749 175.36798 180.04349 184.7838 188.6133 191.0658 196.7052 200.2449 205.6944 209.5239 212.40749 218.00099 223.45049 225.90298 231.58649 235.11899 240.46948 246.06299 248.94658 252.47908 257.92859 260.75281 266.34631 271.66083 274.48505 278.01755 283.70105 289.05154 291.93515 297.52866 302.92416 306.45667 311.85934 314.68356 319.35907 324.70956 327.16208 332.51257 337.18808 340.72058 346.17007 349.97971 352.86331 358.4613 363.91531 369.27032 373.95032 379.63831 382.2222 385.75919 388.64279 394.33078 399.67407 404.89587 410.23828 413.12189 416.65887 422.34686 427.70187 430.52609 434.8497 438.9285 444.52649 446.98349 450.52048 453.40408 458.08408 463.43909 466.97607 470.24307 473.12668 478.58069 482.4147 485.23892 490.92691 496.3269 501.0069 503.8905 509.48849 514.9425 518.47949 524.16748 526.9917 530.52869 536.21667 541.57166 544.45526 548.71857">If the descriptor pointed to by the gate selector doesn’t have the L-bit set, or has both the L-</tspan><tspan y="-343.98145" x="136.92001 142.51981 144.97861 148.51741 151.3416 156.74339 162.4332 168.03299 170.91658 177.84837 181.92717 187.52698 189.92368 193.46248 196.34607 201.02786 206.38466 209.92346">bit and D-bit set.</tspan><tspan y="-330.00174" x="137.21971 140.99431 144.1479 146.97209 150.50369 156.18629 161.53589 164.41948 170.01208 175.36168 180.03629 184.7766 188.60519 191.05679 196.6962 200.2359 205.68449 209.51309 212.39668 217.98929 223.43788 225.88948 231.57208 235.10368 240.45328 246.04588 248.92947 252.46107 257.90967 260.73389 266.32648 271.64008 274.44 277.97159 283.65417 289.00378 291.88739 297.47998 302.87457 306.40616 311.80795 314.63217 319.30676 324.65637 327.10797 332.45758 337.13217 340.66376 346.11237 349.94098 352.82458 358.50717 363.90176 368.57635 371.40057 378.32516 383.73776 388.73636 391.61996 398.96756 401.85117 408.11877 413.53137 418.52997">If the descriptor pointed to by the gate selector has DPL &gt; CPL.</tspan><tspan y="-315.96173" x="137.2197 140.99699 144.15329 146.97748 153.04079 159.22469 164.63998 167.46417 169.91847 175.60378 178.42796 182.20526 188.34956 194.06186 199.77415 205.53685 210.95215 215.95345 218.40775 224.12004 230.18335 236.36725 241.78255 244.60674 248.68103 256.03134 261.71664 267.06894 270.90024 276.25253 279.13614 281.59045 284.41467 286.86899 291.5463 294.35968 297.89578 303.58289 308.93698 311.82059 317.50769 322.86179 330.2139 333.0975 339.3696 344.78671 349.78983 353.86594 356.74954 359.14624 363.88654 366.71075 372.39786 377.85095 381.38705 384.21127 389.92538 392.80899 398.4061 403.72418 407.26028 412.61438 415.4386 420.83771 423.29379 425.74988 431.34698 437.03409 442.38818 447.98529">If SSP in IA32_PLi_SSP (where i is the new CPL) is not 8 byte aligned.</tspan><tspan y="-301.98203" x="137.2197 141.0006 144.16049 146.50409 150.04199 155.7309 161.08679 163.43039 166.96829 172.42319 177.64499 183.04768 188.73659 191.08018 196.48108 202.16998 207.76889 210.11249 213.65039 219.33929 224.69519 227.09909 231.78 235.3179 240.7188 245.39969 250.71959 253.12349 256.28339 260.0058 265.40671 274.10971 279.46561 281.8092 285.34711 290.802 293.1456 298.74451 304.1004 306.444 312.04291 317.73181 322.41272 328.10162 333.45752 339.05643 341.46033 346.91522 352.49969 354.90359 359.5827 365.26981 370.66891 376.26602 381.71912 389.07123 391.47513 396.15424 399.69034 405.08945 409.76855 415.08667 417.49057 422.88968 426.72278 432.07687 434.42047 440.10757 445.56067 449.09677 451.44037 456.11948 461.57257 467.25967 470.79578 476.19489 478.65097 484.33807 489.69217 495.28928 497.63287 500.08896 505.77606 508.11966 513.51874 515.8623 521.54938 526.94849 530.48456 536.17163 539.83374 545.23737 547.69348 550.1496 555.46771">If the token and the stack frame to be pushed on shadow stack are not contained in a naturally </tspan><tspan y="-291.00201" x="136.91998 142.31908 144.71487 147.17097 152.76808 158.45518 163.80928 169.40639 172.22969 177.94379 183.65788 187.73398 193.33109 198.64919 202.18529 207.53938 210.36269 214.19579 219.54988 225.14699 227.60309 233.05618 238.69739 241.58009 247.03319 250.19128 253.07399 256.61008 262.29718 267.65128 270.47458 275.21399 280.85519 286.2543 291.85141 297.3045 304.65662 307.53931 312.21841 315.75452 321.15363 325.83273 331.15082">aligned 32-byte region of the shadow stack.</tspan><tspan y="-276.96201" x="137.21968 141.00238 144.16408 146.98828 151.11298 155.79567 161.48637 167.08707 172.44476 176.28146 181.60316 184.06287 188.74556 194.20226 198.03896 200.86316 205.54585 211.23656 216.63925 222.23996 227.69666 235.05235 237.87656 242.55925 246.09895 251.50165 256.24194 261.56363 265.68832 268.51254 272.05225 277.50894 282.83063 288.18832 293.87903 296.70325 302.15994 307.79938 310.6236 316.3143 321.672 329.02771 331.85193 336.53464 342.22534 347.62805 353.22876 358.68546 366.04117 368.92477 373.60748 377.14719 382.5499 387.2326 392.55429 395.4379 397.89758 402.58029 405.40451 414.15521 419.55792 423.39462 428.61639 433.97409 439.5748 442.39902 447.99973 453.69043 458.37314 462.87494">If “supervisor shadow stack” token on new shadow stack is marked busy.</tspan><tspan y="-262.9823" x="137.21967 140.99966 144.15866 146.98286 152.58087 157.93587 162.61588 166.15288 168.60988 174.29788 179.76178 183.30148 185.69818 191.15848 196.84648 199.67068 208.41869 213.87268 219.47069 224.87338 227.69759 230.15459 234.83459 237.6588 243.42149 249.12389 253.20088 258.79889 261.25589 264.79288 267.67645 273.07736 276.91946 279.80304 284.48303 289.93704 298.68503 304.28302 309.68301 313.22 315.677 321.27499 323.73199 326.189 328.58569 332.12268 337.37967 340.26416 349.01215 354.46616 360.06415 365.41916 368.68616 371.57065 377.16864 382.85663 386.39362 389.27811 395.2829 401.46771 406.88571 409.7702 415.1702 420.76819 426.36618 430.2002 435.60382 440.28381 444.96381 447.78891 450.24591 455.9339 458.759 462.88101 467.561 473.24899 478.84698 484.202 488.03601 493.35501 495.81201 500.492 505.94601 509.78003 512.60516 517.28516 522.97314 528.37317 533.97119 539.42517 546.7782">If destination mode is 32-bit or compatibility mode, but SSP address in “supervisor shadow </tspan><tspan y="-252.0023" x="136.91997 141.59996 145.13966 150.54326 155.22325 160.50536 164.64536 167.52895 171.06865 176.52895 181.75075 187.09314 192.79465 195.61884 198.07494 202.75493 205.63852 211.21851 216.5609 221.7827 227.243 232.9445 238.58389 241.40808 247.11047 254.06657 260.19107">stack” token is beyond 4GB.</tspan><tspan y="-237.96231" x="137.21967 141.00327 144.16586 146.99005 153.05336 159.23726 164.65886 167.48305 172.88664 178.48825 184.08984 187.92744 193.28604 197.96964 202.65323 205.53682 207.99742 213.63953 216.52312 220.64871 225.33231 230.97441 236.61382 241.97241 245.81001 251.13261 253.52931 258.21292 263.67053 267.50812 270.39172 275.07532 280.76691 286.1705 291.77209 297.22971 304.5863 307.46991 312.1535 315.69409 321.09769 325.78128 331.10388 335.22949 338.1131 341.65369 347.1113 352.3331 357.67551 363.3671 366.2507 371.85229 377.30991 382.66852 387.35211 390.23572 395.87781 401.3381 404.87869 407.7623 416.51389 421.91748 425.45807 430.14166 435.83325 438.65747 444.72076 450.84436 456.26596 459.09018 464.49377 470.09537 475.69696 479.53455 484.89316 489.57675 494.26035 497.14395 499.54065 505.24213">If SSP address in “supervisor shadow stack” token does not match SSP address in </tspan><tspan y="-226.98232" x="136.91997 140.69637 146.83977 152.55116 158.31386 164.02525 169.43965 174.48325 176.87994 182.64264 188.64655 194.83044 200.23044 203.11403 207.18742 214.53682 220.22122 225.57262 229.40302 234.80571 237.6299 240.0833 242.90749 245.36089 250.03729 252.92088 256.45428 262.13867 267.54138 270.36557 276.04996 281.40137 288.75076 291.57495 297.84436 303.25876 308.30237 312.38116">IA32_PLi_SSP (where i is the new CPL).</tspan><tspan y="-213.00261" x="45.119972 52.473873 58.537174 64.685074 68.762978 74.118881 77.953781 81.788681 87.243584 91.078484 96.794388 101.47529 106.93019 112.52909 117.93179 137.25119 141.03209 144.19199 147.01617 152.41707 155.30066 160.89957 166.58847 171.26938 176.95828 179.78247 185.23737 188.39726 191.22145 194.75935 200.44826 205.80415 208.68774 214.14264 216.60054 222.19945 225.02364 230.70354 235.87044 240.87534 247.02324 253.99014 260.05344 263.32135 266.14557 272.41946 278.56735 281.45096 286.13187 291.48776 293.94565 299.30154 303.98245 307.52036 312.97525 315.55734 318.82526 321.70886 327.38876 331.16968 335.30969 338.55151 341.43512 346.89001 350.72491 353.54913 358.90503 362.73993 366.57483 372.02972 375.86462 378.74823 383.42914 388.88403 394.48294 399.83884 402.72244 405.11914 409.79916 412.68277 415.14066 420.78275 423.66635 429.35526 434.81015 440.45224 444.53104 449.27133 454.67493 460.31702 465.77731 471.46622 473.9241 478.60501 484.00592 486.46381 489.28802 493.96893 499.56784 504.96875 509.64966 515.00555 517.82977 525.18365 527.64154 531.17944 536.82153 539.70514 545.39404 550.84894">#SS(error_code)If a push of the old EFLAGS, CS selector, EIP, or error code is in non-canonical space with no </tspan><tspan y="-201.96231" x="136.91997 141.59277 145.12257 150.51538 155.18819 160.49998 163.38358 168.05638 175.40218 177.85197 181.38177 186.05458 191.73538">stack switch.</tspan><tspan y="-187.9826" x="137.21967 141.00327 144.16586 146.56976 151.97336 154.31696 159.91855 165.61015 170.29375 175.98535 178.32895 183.78654 186.94914 189.35304 192.89365 198.58525 203.94385 206.34775 211.80534 214.20204 219.80365 222.20755 228.21146 234.39536 236.79926 241.48285 246.84145 249.30205 254.66064 259.34424 262.88483 268.34244 270.92453 274.19513 276.59903 282.28162 288.43222 292.57224 295.81403 298.21793 303.90051 309.0701 314.0777 320.2283 327.19791 333.2612 336.5318 338.9357 345.21231 351.36292 353.76682 358.45041 363.80902 366.26962 371.62823 376.31183 379.9118 385.31271 387.89481 391.16541 393.509 399.19159 402.97519 407.1152 410.35699 412.76089 418.21851 422.05609 424.45999 429.8186 433.65619 437.49377 442.95139 446.78897 449.19287 453.87646 459.33408 464.93567 470.29428 472.69818 475.15878 479.84238 482.24628 484.70688 490.34897 492.75287 498.44446 503.90207 509.59366 513.67426 518.35785 523.76147 529.45306 534.91064 540.55273 543.00879 547.69238 553.09601 555.55658">If a push of the old SS selector, ESP, EFLAGS, CS selector, EIP, or error code is in non-canonical </tspan><tspan y="-177.00261" x="136.91997 141.59998 147.19798 152.59798 157.27798 162.63298 165.51657 170.97057 176.61267 179.49626 184.89626 187.72044 192.40045 195.93745 201.40135 206.08136 211.40036 214.28395 218.96396 226.31696 228.77396 232.31096 236.99097 242.67897 245.50316 249.58015 254.98285 257.37955 260.91922 266.60721 272.00992 275.79175 278.67535 284.94836 290.36636 295.37036 298.25397 302.93396 308.62195 314.02194 319.66403 325.26202 330.61703 333.44125 338.89526 342.72928 345.61288 351.30087 356.75488 360.83188 367.10489 372.52289 377.52689 380.3511 387.7041 390.1611 393.69809 399.34018 402.22379 406.00378 412.15079 417.68579 421.76279">space on a stack switch (either CPL change or no-CPL with IST).</tspan><tspan y="-162.96262" x="45.119972 52.469372 59.188774 64.64817 68.726974 74.078377 77.908775 81.739174 87.189575 91.019974 96.731377 101.40778 106.85818 112.45258 117.85528 137.23409 141.01498 144.17038 146.99457 150.52797 156.21237 161.56377 164.44736 170.15875 175.87015 179.94354 185.58295 187.97964 191.51305 194.39664 196.85004 202.53444 206.06784 211.47054 215.30093 219.13133 224.81573 230.41014 233.76984 237.84323 243.43764 248.83403 252.36743 257.77014 261.01193 263.89554 269.60693 275.31833 279.39172 284.98611 287.39996 290.94235 293.82593 297.36832 301.0304 306.43579 312.03918 316.12158 321.72498 327.13037 330.67276 336.03317 339.30557 342.18915 347.64856 351.48795 354.31213 358.99753 364.45694 370.06033 375.42075 378.24493 382.93033 388.29074 393.89413 402.64752 408.00793 413.70132 417.24371 420.0679 422.5303 427.2157 430.03989 435.73328 441.19269 444.73508 447.61865 453.22205 457.06143 462.42184 467.10724 472.46765 478.10974 481.65213">#NP(error_code)If the 64-bit interrupt-gate, 64-bit trap-gate, or code segment is not present.</tspan><tspan y="-148.98291" x="45.119965 52.474766 58.011566 64.16037 68.239166 73.641861 77.42366 81.25946 86.715263 90.551064 96.313759 100.99556 106.45136 112.05116 117.40796 137.32675 141.10765 144.26845 147.09265 152.49445 158.18425 161.06786 166.46965 170.00845 173.54726 178.90405 187.65385 193.25366 196.79247 199.61667 203.15547 208.61127 211.49487 213.95367 219.40947 224.81126 230.41107 233.23528 239.48308 245.63188 251.05168 253.93529 257.0961 260.93188 266.3877 275.13748 277.96167 281.56165 287.20374 292.60645 295.43063 300.88913 306.95242 313.10123 315.92542 320.60721 326.009 331.69879 336.38058 341.7374 346.41919 349.30276 354.70456 360.39435 363.21854 368.62033 373.30212 377.98392 383.38663 388.06842 392.75021 395.5744 399.11319 404.569 407.45258 413.09467 418.55496 424.24475 428.32355 433.00534 438.40714 444.09692 449.55273 455.24252 457.63922 462.37952 467.78311 470.17981 473.06339 477.74518 483.34497 488.74677 493.42856 498.78537">#TS(error_code)If an attempt to load RSP from the TSS causes an access to non-canonical space.</tspan><tspan y="-135.0032" x="137.21967 141.00056 144.16046 146.98465 150.52255 156.21146 161.56735 164.45094 170.69785 176.84575 182.26465 185.08884 188.24873 192.08363 197.53853 206.28743 209.11162 212.64952 218.33842 223.69432 226.57791 232.03642 238.09973 244.24763 247.13123 249.52792 254.20793 257.09152 262.54642 268.23532 271.77322 276.45413 278.85083 284.49023 289.84613 292.72974 298.32864 303.68454 308.36545 313.04636 316.88126 319.33914 324.93805 328.47595 333.93085 337.76575 340.64935 344.18726 349.58817 355.18707 357.64496 363.00085 365.82507 368.28296 370.74084 379.48975 381.88644 385.42615 390.16644 393.40826">If the RSP from the TSS is outside descriptor table limits. </tspan><tspan y="-120.9632" x="45.119965 52.470264 57.929668 63.092968 67.167267 70.32357 75.720871 81.406174 83.860474 87.220177 91.298981 95.97628 101.42758 107.02288 112.42558 137.26468 141.04558 144.20187 147.02606 152.42336 155.30695 160.90225 166.29955 171.89485 177.29755 180.12173 183.27803 188.67532 194.36063 196.81493 200.34923 203.23282 208.68411 213.36142 218.03873 223.72403 227.55533 232.23264">#PF(fault-code)If a page fault occurs.</tspan><tspan y="-106.98351" x="45.119965 52.470264 59.046566 66.011673 137.23679 141.01408 144.17038 146.99547 150.52977 156.21507 161.56737 164.45186 169.37576 176.45607 182.72636 188.95166 191.77675 197.41705 201.26006 206.61235 209.76865 212.22295 217.53925 220.42374 222.82133 227.50224 230.38673 236.07204 240.74934 246.10164 251.69695">#UD If the LOCK prefix is used.</tspan><tspan y="-93.003807" x="45.119965 52.473866 58.621765 64.895668 68.973572 74.653473 80.810371 86.346275 137.22508 141.00598 144.16588 146.99008 152.39098 154.84888 157.30678 162.90569 168.59459 177.34349 182.69939 188.38829 191.92619 194.7504 199.4313 205.12021 210.4761 215.15701 220.47691 222.93481 228.62372 234.22263 237.04683 239.50473 244.19997 247.08357 252.43857 258.12656 263.52655 269.12454 271.58154 276.93655 282.53455 285.80154 288.62573 292.16272 297.85071 303.25342 306.07761 311.6756 317.07559 320.61258 326.01529 328.83948 335.76947 341.18747 346.19147 349.07504 351.53204 356.21204 359.03622 364.75122 368.01822 370.84241 376.2424 381.93039 387.52838 390.35257 395.75256 398.57675 403.31705 406.85672 412.25671 416.93671 422.25571 425.13928 430.73727 436.42526 441.10526 446.79324 449.61743 452.07443 456.75443 459.57861 465.2666 470.95459 476.35458 478.81158 481.26859 486.86658 492.55457 497.90958 503.50757">#AC(EXT)If alignment checking is enabled, the gate DPL is 3, and a stack push is unaligned.</tspan></text></g></svg>     <hr />     <p class="not_instruction_page">         This <b>UNOFFICIAL</b> reference was generated from the official <a href="https://www.intel.com/content/www/us/en/developer/articles/technical/intel-sdm.html">Intel® 64 and IA-32 Architectures Software Developer’s Manual</a> by a dumb script.         There is no guarantee that some parts aren't mangled or broken and is distributed <b>WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE</b>.     </p> </body>  </html>
