<!DOCTYPE html> <html lang="en">  <head>     <meta charset="utf-8">     <title>SWAPGS</title>     <link rel="stylesheet" href="styles.css">     <link rel="stylesheet" href="../intel.css"> </head>  <body>     <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="511.86005pt" height="644.05902pt" viewBox="0 0 511.86005 644.05902" sodipodi:docname="1399.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.64006" inkscape:cy="422.90164" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg236" /><g transform="translate(-46.019958,-69.117187)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="12" class="cA49CCA52 cD0BE81C2 c209E837B"><tspan y="-714" x="46.02 52.5588 62.518799 70.218002 77.533203 84.920403 91.599602 101.3628 107.7816 117.3816 123.7392 130.47839 133.47839 140.916 147.5748 150.5748 158.15399 164.5452 170.2644 176.9796 179.9796 187.41721 194.136 200.8752 203.87039 209.4492 214.25041 220.96561">SWAPGS—Swap GS Base Register</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-615.29999" x="235.67999 238.36819 244.06631 248.74551 252.76637 256.3689 262.12677 266.69742 270.65851 273.1774 278.78387 284.52979 287.04968 293.6492 299.28955 304.89603 308.3183 313.65585 319.40176 324.98135 327.50125 333.0679 338.76599 343.20517 348.78476 354.41116 356.93005 362.62814">Instruction Operand Encoding</tspan><tspan y="-557.33978" x="46.019684 52.490696 58.085228 62.853081 67.411774 71.054146 73.561081 79.021156 82.982254 85.489189 91.083725">Description</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-541.02002" x="46.02 52.160702 60.862801 67.003502 72.462898 79.4226 85.563301 88.446907 93.795609 99.01741 103.69111 109.37281 114.76651 120.44821 126.03991 131.38861 136.06232 138.94591 142.47661 148.15831 153.507 156.33119 161.0049 166.6866 170.5143 174.342 179.74469 185.42639 188.95709 191.84068 198.80038 204.94109 207.82468 213.41638 218.81009 223.4838 228.83249 231.71608 235.54378 240.89247 246.53188 248.92857 253.60228 257.13297 262.53564 266.37775 269.20197 274.36346 279.76706 282.16379 287.82028 293.22299 296.04718 303.39478 305.79147 309.32306 315.00565 317.88922 321.42081 327.10339 332.5061 335.33029 340.49179 345.89539 348.34698 354.02957 359.43228 362.25647 366.93106 372.37967 378.06226 381.59384 386.98843 389.44003 395.12262 400.47223 406.06482 408.94839 411.34421 417.04568 419.92926 427.50186 433.64346 439.94077 442.76495 448.15955 453.75214 459.39154 463.23364 468.58325 473.25784 477.93243 480.75662 487.02423 492.73383 498.49652 504.20612 509.91571 515.62531 521.388 527.0976 533.84222">SWAPGS exchanges the current GS base register value with the value contained in MSR address C0000102H </tspan><tspan y="-529.97974" x="46.019989 50.094288 53.87159 60.015892 65.778595 71.490898 77.203201 83.428505 89.104805 95.348106 102.06841 107.74471 112.7883 118.4907 125.454 131.63789 137.35019 143.5125 149.57581 155.7597 161.436 165.5103 168.7746 171.65819 177.19049 182.87579 188.22809 191.05228 197.23618 205.87798 212.06187 217.46187 224.42517 230.60907 233.43326 235.88756 241.57286 246.25017 249.78447 253.61577 259.30106 263.97836 267.51266 269.90939 275.36969 281.05499 283.9386 286.33533 291.01532 293.89893 299.29623 302.12045 307.75986 311.60196 313.99869 319.32028 321.77908 324.23788 329.5947 335.19449 340.5513 346.15109 348.97531 351.43411 357.1239 361.80569 365.34448 369.18027 374.87006 379.55185 383.09064 385.48734 390.94763 396.63742 399.52103 401.91772 407.6192 411.15799 416.5607 422.20279 427.84219 433.19901 438.7988 441.6824 444.8432 450.29901 454.1348 457.0184 462.70819 467.38998 472.7468 475.57101 481.17081 486.49161 489.37521 494.05701 499.37781 504.0596 507.59839 513.0011 521.7041 524.58771 529.26953 534.72534 537.88617 541.24591">(IA32_KERNEL_GS_BASE). The SWAPGS instruction is a privileged instruction intended for use by system soft-</tspan><tspan y="-518.99976" x="46.019989 53.276688 58.680286 62.522388 67.864792 71.166893">ware. </tspan><tspan y="-502.97977" x="46.019989 54.911087 60.598186 65.952286 71.639389 74.463585 80.150688 84.829788 87.285889 92.972992 98.570091 101.4537 107.5998 113.1249 119.30881 125.54671 131.73061 136.7337 141.7368 144.62041 148.15651 153.6096 156.43381 158.88991 167.63701 173.23412 175.69022 181.04431 189.79141 195.14551 200.83261 204.36871 207.19292 211.93321 217.21532 221.89441 225.43051 230.83321 239.53621 242.41982 247.09891 252.498 254.9541 257.3508 262.02991 265.33203 268.15625 271.69235 277.37946 282.73355 286.56665 291.96936 294.79358 297.24966 301.92877 304.75299 310.44009 315.84 318.7236 323.94537 329.28778 333.12448 338.81519 344.17288 346.63257 349.45679 354.1395 357.6792 363.08191 367.76462 373.0863 375.96991 381.37262 384.91232 387.73654 391.27625 396.96695 402.32465 405.20825 412.28494 418.43463 421.25885 426.61655 432.30725 435.84695 439.68365 445.00534 447.88895 453.48965 458.94635 461.40604 467.09674 470.63644 473.90616 476.78976 483.51547 488.87317 491.33286 494.87256 500.51465 505.91736 509.75406 512.57825 515.03796 519.72064 522.5448 526.08447 531.77515 537.13287 540.96954 546.32727 549.15143 554.55414">When using SYSCALL to implement system calls, there is no kernel stack at the OS entry point. Neither is there a </tspan><tspan y="-491.99976" x="46.019989 50.70269 54.24239 57.904491 63.30809 65.767792 71.368492 77.059189 80.598892 83.76059 89.217293 93.053993 100.31069 105.71339 109.55009 115.15079 117.85439 126.5574 131.9601 135.4998 141.14191 146.5986 152.19931 154.84351 158.38321 163.8399 166.5435 172.0002 177.60089 181.14059 186.54329 189.00299 194.6937 197.33789 202.74059 205.44418 211.04489 216.50159 218.96129 224.65199 228.1917 233.54939 237.38609 240.03029 243.56999 249.02669 251.73029 256.95206 262.29446 266.13116 271.82187 277.17957 279.63925 282.34286 287.02557 290.56528 294.40198 300 304.67999 308.28 313.92209 317.76419 323.14078 327.82077 330.46497 333.64557 337.50116 342.97675 351.74634 354.39053 361.76514 367.40723 369.86334 374.54333 380.25293 382.95651 386.51511 392.1572 397.53378 400.17798 405.39978 410.80246 414.65805 420.30014 425.67673 428.13284 430.77704 435.45703 438.99673 444.41833 449.09833 454.43893 457.08313 462.70273 468.17831 470.57501 476.27652 479.83511 485.2117 488.9935 491.69708 496.37708 501.83737 507.54697 510.00308 515.58307 518.22729 523.84692 529.18933 531.89294 535.74854 541.09094 546.51251 552.09161 555.38019">straightforward method to obtain a pointer to kernel structures from which the kernel stack pointer could be read. </tspan><tspan y="-480.95944" x="46.020004 51.561306 57.255608 62.949909 67.636208 70.909508 73.793106 77.336403 83.030701 88.391998 91.216194 96.437996 101.84069 105.68099 111.37529 116.73659 119.19989 122.02409 126.71039 132.11668 137.81099 143.50529 148.96559 152.5089 155.3331 160.01939 165.36269 170.58449 175.98718 178.81139 184.41568 189.77698 195.47128 200.83258 204.49467 209.89827 212.36157 215.18578 220.79007 226.43217 230.27248 235.87677 241.33707 246.02336 251.38466 254.20886 258.04916 263.41046 269.01477 271.47806 276.16437 279.70767 285.06897 288.90927 293.59558 296.47919 301.8801 305.7222 308.6058 312.44611 317.8074 320.97272 326.33401 330.17432 335.53561 341.22992 345.91623 351.27753 354.10175 362.85605 368.21735 376.97165 382.43195 386.27225 390.71375 393.98706">Thus, the kernel cannot save general purpose registers or reference memory. </tspan><tspan y="-464.99976" x="46.020004 52.176903 57.487801 60.312004 65.901901 71.248802 75.9207 78.369598 83.959496 89.639397 92.941498 95.705399 101.8443 110.54639 116.6853 122.14469 129.10258 135.24149 138.06567 143.65558 149.10149 154.44838 159.12029 161.94447 167.62437 173.07028 176.59918 179.42337 183.24927 188.59616 194.18607 199.86597 202.31487 206.14076 211.48766 214.25154 219.64345 225.32335 230.63425 233.45844 239.04834 244.39523 250.07513 255.42203 259.14444 264.54803 266.99695 269.76086 275.35077 281.03067 284.85657 290.44647 295.89236 300.56427 305.96695 308.73087 312.55676 317.82001 323.42072 325.8804 330.56311 334.10281 339.50552 343.28732 348.02762 350.79153 356.24823 360.08493 362.84885 371.59955 376.95724 385.70795 391.16464 395.00134 400.32303 403.14725 408.60394 414.20465 419.56235 423.28476 428.68747 434.32956 439.93027 444.61298 447.88269 450.70691 457.43262 462.88931 465.65323 469.48993 474.84763 480.44833 482.84503 487.52774 491.06744 496.47015 500.31226 504.99496 507.75888 513.44958 518.80731 524.16504 529.76575 532.5296 536.06927 541.526 544.28986 549.89056 555.24829">By design, SWAPGS does not require any general purpose registers or memory operands. No registers need to be </tspan><tspan y="-453.95944" x="46.019989 50.70089 56.044193 61.265995 66.608398 72.207298 75.031494 80.630394 86.033096 89.192993 94.647896 98.482796 103.8855 106.70969 112.3986 117.0795 119.5374 125.1795 130.77841 133.60262 137.14052 142.82942 148.18532 151.06892 153.52682 159.16893 163.84982 167.38773 171.22263 176.91153 181.59244 185.13034 187.58824 193.04314 198.73204 201.99994 204.88354 211.03145 219.73355 225.88145 231.30035 238.26726 244.41516 247.29877 252.65466 257.87643 262.55734 268.24625 273.64716 279.33606 284.93497 290.29086 294.97177 297.77969 301.31308 306.99747 312.34888 315.17307 321.44247 326.85687 331.90048 334.72467 340.43607 343.31964 348.91403 354.31042 357.84381 363.2402 366.12378 371.71817 377.16858 379.62198 385.30637 388.83975 394.19116 398.02158 400.84576 404.00116 407.83157 413.28198 422.02637 424.85056 428.38394 434.06833 439.41974 442.30331 446.07971 452.22311 457.93451 463.6972 469.4086 475.633 481.30841 487.55081 494.2702 499.94562 504.98923 510.69162 517.65399 523.83789 529.54932 535.71069 541.77399 547.95789 553.6333">saved before using the instruction. SWAPGS exchanges the CPL 0 data pointer from the IA32_KERNEL_GS_BASE </tspan><tspan y="-442.97943" x="46.019989 53.594391 59.778294 66.020691 68.844894 76.194298 78.590996 82.124397 87.8088 90.692406 94.225807 99.91021 105.26161 108.08582 115.04822 121.23212 124.05632 129.69572 135.09932 139.77573 145.12712 147.95131 151.78171 157.1844 162.77881 165.23221 169.90862 173.44202 178.79341 181.3755 184.6389 187.52249 193.05389 198.7383 204.08969 206.97328 212.19508 217.53748 221.36787 227.05228 232.40367 234.85707 237.68126 242.35767 247.75406 253.43846 256.32205 259.85544 265.53983 270.94254 276.64401 279.4682 285.15259 289.82898 295.18039 298.01999 301.56778 307.20987 312.57568 315.39987 322.37668 328.53448 331.35867 336.96747 340.74927 346.11508 349.28488 351.75269 357.08249 359.90668 365.37149 371.07028 373.95386 379.59595 385.05627 388.90106 397.65985 403.07065 405.53845 408.36264 417.12143 422.48724 431.24603 436.71085 440.55563 445.88544 448.70963 452.55441 457.92023 461.09003 466.45584 470.30063 475.66644 481.30853 485.98853 491.35434 496.04514 498.86932 502.41711 507.88193 510.7655 516.17633 520.86713 525.55792 530.92371 535.6145 540.3053">MSR with the GS base register. The kernel can then use the GS prefix on normal memory references to access </tspan><tspan y="-431.99942" x="46.019989 51.241791 56.58419 60.421791 66.113388 71.471985 73.932587 76.756783 82.358383 87.761986 91.302589 96.706192 99.530388 104.21399 107.75459 111.59219 117.28379 121.96739 125.508 131.1501 134.9922 140.3508 145.03439 148.30499 151.1292 157.2798 159.7404 168.492 170.95261 173.3493 178.7529 182.5905 185.0511 189.5529 192.79471 195.61891 202.97551 208.61761 213.97621 219.61832 222.44252 225.98312 231.67473 237.03333 239.85753 246.93513 253.08574 255.90996 261.13174 266.47415 270.31174 276.00333 281.36194 283.82254 286.64673 289.10733 293.79092 296.4603 301.82611 307.5249 311.07269 316.43851 320.28329 325.64911 331.2579 334.08209 339.78088 344.47168 346.86838 352.56985 358.17865 360.94254 366.35333 372.05212 374.87631 377.27301 382.97449 386.52228 391.88809 395.73288 399.51468 405.21347 410.82227 414.37006 417.13394 422.59875 426.44354 429.23999 434.57248 439.79428 444.47427 449.87695 455.45245 458.99216 461.42667 466.88696 472.55246 475.37668 479.45547 486.83188 492.49738 497.90005 501.74216 507.08453 509.90875 513.44849 519.08972 524.49243 527.25629 532.5528 537.88531 541.72742 547.42896 552.76147 555.19598">kernel data structures. Similarly, when the OS kernel is entered using an interrupt or exception (where the kernel </tspan><tspan y="-420.95911" x="46.019958 50.699959 54.236958 59.636959 64.316956 69.635956 72.460152 74.917152 79.597153 82.421349 87.82135 90.278351 94.11235 99.467354 104.86736 110.46535 115.78436 118.66796 123.34796 128.70296 132.23996 135.12355 140.76566 146.40506 150.48206 153.74905 156.63264 162.77965 171.48175 177.62875 183.04675 190.01276 196.15976 199.04335 203.72336 209.12335 214.76546 217.64905 223.24706 228.60205 231.48564 237.17365 241.85364 247.20863 252.80664 255.69023 259.22723 264.68124 267.50546 273.10345 278.74554 281.20255 285.88254 291.20154 293.65854 298.97754 301.86115 307.45914 312.81415 316.35114 319.23474 324.63474 327.45895 333.05695 338.51096 340.90765 346.60913 350.14612 355.50113 359.33514 362.21875 365.75574 371.20975 374.03397 377.57095 383.25894 388.61395 391.49756 396.71936 402.06177 405.89578 411.58377 416.93878 419.39578 422.27939 427.87738 433.27737 436.81436 442.21436 445.03857 449.71857 453.25555 457.08957 462.77756 467.45755 470.99454 476.68253 480.51654 485.87155 490.55154">stack is already set up), SWAPGS can be used to quickly get a pointer to the kernel data structures.</tspan><tspan y="-404.99942" x="46.019958 51.54776 57.228561 62.576363 65.459969 69.232765 75.372566 81.080368 86.843071 92.550873 98.771675 104.44347 110.74078 117.45657 123.12837 128.17197 133.87436 140.83316 147.01706 152.72485 158.88266 164.94595 171.12985 176.80165 179.68524 187.25604 193.43994 199.67874 202.50293 204.95273 208.48253 213.15533 218.50313 220.95293 224.10472 226.92891 229.37871 234.05151 236.8757 242.32251 248.00331 250.45311 255.76491 258.58911 263.9819 268.65469 273.32748 278.67529 283.34808 288.08838 290.48508 296.12448 298.52118 303.95996 306.78415 312.47754 317.16293 319.62534 325.31873 330.92212 333.74631 339.99771 346.93311 354.51651 360.66891 366.92032 371.00272 379.90012 386.15152 393.73492 399.88733 406.13873 408.96292 411.42532 417.11871 421.80411 425.3465 429.18588 434.87927 439.56467 443.10706 445.56946 450.97037 456.66376 461.34915 464.62155 467.44574 472.98615 478.67953 484.13895 488.82434 494.22705 497.05124 499.51364 505.20703 509.89243 513.43481 517.27423 522.96765 527.65308 531.1955 533.59222 539.05255 544.74597 549.4314">The IA32_KERNEL_GS_BASE MSR itself is only accessible using RDMSR/WRMSR instructions. Those instructions </tspan><tspan y="-393.95911" x="46.019958 51.418159 55.250359 60.603558 63.487156 68.888054 74.589554 77.044754 82.361954 85.186157 90.584358 95.262558 99.940758 105.34346 110.02166 114.69986 117.09656 122.69276 125.08945 130.49216 133.31636 138.71455 142.24976 145.13336 150.72957 154.56177 157.01697 162.33417 164.78937 167.24457 172.59776 178.19397 183.59666 186.42087 188.87607 194.22926 199.54646 204.89966 207.35486 210.17906 215.89226 219.15746 221.98166 227.51486 233.20107 238.60376 241.42796 250.31816 256.56235 264.13855 270.28375 276.52795 279.36026 281.75696 287.45844 292.13843 295.67542 299.50943 305.19742 309.87741 313.4144 315.8714 321.32541 327.0134 329.83759 335.1926 340.88058 345.56058 351.24857 355.08258 360.43759 365.11758 368.00116 371.53815 377.22614 382.62613 386.16312 388.9873 392.52429 398.21228 403.56729 406.45087 410.23087 416.37787 422.14056 427.85556 433.57056 439.79855 445.47754 451.72354 458.44653 464.12552 469.16913 474.87152 481.83752 488.02142 493.73642 499.90143 505.96472 512.14862 517.82764 520.65186 528.22986 534.41376 540.65973">are only accessible at privilege level 0. The WRMSR instruction ensures that the IA32_KERNEL_GS_BASE MSR </tspan><tspan y="-382.9791" x="46.019958 50.706261 56.166561 61.860863 65.40416 70.810463 73.207169 78.901466 83.587769 86.471367 91.87767 94.701866 99.388168 104.79447 110.48877 115.94907 121.64336 124.10667 128.79297 134.19926 136.59596 139.47957 144.88586 150.49016 156.09445 159.87625 165.27895 169.96524 174.65154">contains a canonical address.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-357.29999" x="46.02 52.630455 58.270802 63.845413 67.26767 72.573364 76.594215 79.08123 84.720589">Operation</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-340.98001" x="46.02 48.1152 52.796101 55.015499 59.738701 64.5159 66.224098 70.686295">IF CS.L </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-340.98001" x="72.900002">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-340.98001" x="78.959862"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-340.98001" x="81.660004 86.925003 89.144402 91.736404 95.759407 97.978806 103.8288 108.5538 111.9288 114.1482 116.0697 120.8721 123.0915 128.35651 133.57651 136.41151 141.73051 143.65202 147.07202 149.29143 155.83173 160.57294 165.19264 169.93295 172.15236 176.17535">1 (* Not in 64-Bit Mode *)</tspan><tspan y="-328.98032" x="59.520004 64.729202 70.5504 75.300598">THEN</tspan><tspan y="-316.98062" x="77.520004 83.288101 88.975204 94.509308 96.380409 98.599808 103.32391 105.42001">#UD; FI;</tspan><tspan y="-297.00061" x="46.020004 48.126904 52.807804 55.027203 59.762104 64.893005 69.366905">IF CPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-297" x="71.580002">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-297" x="77.580002 79.7994"> 0</tspan><tspan y="-285.00031" x="59.519699 64.700096 70.546494 75.267891 81.114288 83.333687 89.099091 94.369492 99.486893 102.07529 107.33669 109.92509 111.7935 114.01289 118.73429 120.82769">THEN #GP(0); FI;</tspan><tspan y="-264.95999" x="46.019699 49.3857 56.324699 60.977699 63.197102 64.9431 70.104599 72.323997 77.588997 82.358994 84.05999 88.71299 93.176987 97.181984 101.88898">tmp := GS.base;</tspan><tspan y="-252.9603" x="46.019699 51.297298 56.079899 57.793499 62.4132 66.889801 70.851601 75.571198 77.790596 79.549194 84.673798 86.893196 88.993797 94.604401 99.824402 105.10471 109.66231 114.92191 119.65051 125.08111 130.93471 135.66331 140.13092 144.68852 149.96613 154.74872 159.24962 164.59113 170.20172 174.98431 179.66522">GS.base := IA32_KERNEL_GS_BASE;</tspan><tspan y="-240.9606" x="46.019699 48.116699 53.723701 58.988701 64.208702 68.762703 74.018707 78.699608 84.159012 90.00901 94.734009 99.198006 103.75201 108.97291 113.77531 118.32931 123.64831 129.25531 134.03432 138.75932 140.97873 142.73373 147.85474 150.07414 153.44914 160.39714 165.05914">IA32_KERNEL_GS_BASE := tmp;</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-215.34" x="46.02 51.561745 54.075649 59.388313 65.028656 69.783562 72.303436 78.362106 82.260445 85.979507 91.618858 96.164604 100.14263 105.72421">Flags Affected</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-198.96001" x="46.02 52.750202 58.211403 63.906605">None</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-173.28" x="46.02 52.081657 55.503914 60.903229 64.864326 70.469818 75.039467 79.000565 84.580154 90.205566 92.725449 100.42254 106.02803 111.65344 117.25893 119.77881 125.29765 130.58043 135.01959 140.59918 146.05927 150.02036 152.53824 158.14372 163.88866">Protected Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-159" x="46.02 53.352303 59.952904 138.13771 141.91861 145.10281 147.92702 155.48431 160.91762 166.55702 171.89943">#UDIf Mode </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-159" x="174.72">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.0539" class="cDBDE3506 cC7C7E1F8"><tspan y="-159" x="180.78"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-159" x="183 188.7627 194.46509 198.54388 204.7278 207.1839 210.7236">64-Bit.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-133.32001" x="46.02 52.198189 57.777782 63.078495 65.580444 68.650116 75.036469 80.676819 86.256416 89.738434 95.377785 100.12074 104.86369 107.38357 115.0448 120.68415 126.2737 131.91306 134.37317 139.95175 145.17378 149.61296 155.2523 160.65262 164.67346 167.15549 172.79483 178.50391">Real-Address Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-118.98" x="46.02 53.352303 59.952904 138.13771 141.91861 145.10281 147.92702 155.48431 160.91762 166.55702 171.89943">#UDIf Mode </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-118.98" x="174.72">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.0539" class="cDBDE3506 cC7C7E1F8"><tspan y="-118.98" x="180.78"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-118.98" x="183 188.7627 194.46509 198.54388 204.7278 207.1839 210.7236">64-Bit.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-93.300003" x="46.02 52.492008 54.980015 58.603462 62.624317 68.339363 73.646049 76.153976 79.229622 85.353027 91.53022 97.653625 103.77703 106.29691 113.96412 119.60347 125.199 130.83836 133.29849 138.83426 144.05629 148.49545 154.13481 159.53513 163.55597 166.04398 171.68333 177.39838">Virtual-8086 Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-78.959999" x="46.02 53.352303 59.952904 138.13771 141.91861 145.10281 147.92702 155.48431 160.91762 166.55702 171.89943">#UDIf Mode </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-78.959999" x="174.72">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.0539" class="cDBDE3506 cC7C7E1F8"><tspan y="-78.959999" x="180.78"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-78.959999" x="183 188.7627 194.46509 198.54388 204.7278 207.1839 210.7236">64-Bit.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-700.97968" x="49.619995 55.629295 60.669296 64.628395 69.667496 74.758797 147.17819 149.57759 154.73549 158.99518 162.53578 165.84508 171.00298 175.08267 178.68356 180.90385 185.94296 257.88086 263.81998 268.91129 272.3331">OpcodeInstructionOp/ </tspan><tspan y="-691.01935" x="257.88 262.8588">En</tspan><tspan y="-700.97968" x="282.6597 288.1875 293.7153 296.48911 302.16989 304.41269 307.99649">64-Bit </tspan><tspan y="-691.01935" x="282.6597 289.5726 294.59549 299.63638">Mode</tspan><tspan y="-700.97968" x="330.65939 335.5824 340.6044 348.1041 353.1441 357.9231 361.49609">Compat/</tspan><tspan y="-691.01935" x="330.65939 335.10001 340.1391 345.17908 347.39938 354.35907 359.33875 364.43903">Leg Mode</tspan><tspan y="-700.97968" x="377.39908 383.22388 388.25668 392.54248 396.68158 399.95038 402.19318 407.05319 410.65408 412.89688 417.92969">Description</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-676.01996" x="49.61911 54.89941 59.640614 61.860012 67.080017 72.360313 74.579712 79.320908 147.18091 151.86272 158.82242 164.46181 169.563 174.84331 257.88544 262.86423 282.66241 287.9436 292.3833 294.3642 296.28571 330.66479 332.76541 337.38782 341.88693 346.32663 348.24814 350.22995 377.40903 382.15024 386.70782 390.60754 395.40994 399.84964 404.65204 409.27173 414.01202 418.03412 420.25351 423.61322 428.35532 433.09561 435.315 439.21472 443.95682 447.25891 450.32071 455.061 459.68341 463.04312 465.26251 470.54279 475.28488 477.50427 482.18335 486.62305 490.64514 495.38544 497.60483 500.66663 505.34753 510.02661 512.00842 515.90991 519.26959 523.9505 527.25262 529.47205 533.91083 538.40997 540.33148 545.13385 549.81476">0F 01 F8SWAPGSZOValidInvalidExchanges the current GS base register value </tspan><tspan y="-664.97968" x="377.39908 384.34167 386.28928 389.65887 394.43246 396.65186 400.02145 404.79504 409.50565 411.72504 416.22415 420.66385 422.58444 427.35803 432.06863 434.28802 437.94742 442.68863 447.311 450.67072 455.13831 457.08591 461.8595 466.5701 471.22668 473.44608 475.39368 480.16727 482.38666 488.96027 493.73386 499.15546 501.37485 505.84244 510.49902 515.15564 518.21741 522.92798 526.93658 530.94519">with the value contained in MSR address </tspan><tspan y="-653.99969" x="377.39908 382.13489 387.35489 392.63068 397.90646 403.12646 408.40225 413.62225 418.89804 424.75885">C0000102H.</tspan><tspan y="-601.01941" x="56.758759 62.456661 67.135757 70.254265 74.995461 129.41757 135.17577 139.79547 144.53578 147.59758 152.03729 156.83971 161.51881 163.73822 246.65881 252.41701 257.03671 261.77701 264.83881 269.2785 274.0809 278.75998 280.97937 361.2594 367.01761 371.6373 376.37759 379.43939 383.87909 388.68149 393.30118 395.52057 477.78058 483.47849 488.15756 492.83847 495.90027 500.39935 505.14145 509.82053 512.03992">Op/EnOperand 1Operand 2Operand 3Operand 4</tspan><tspan y="-584.99939" x="62.878757 67.857559 143.45576 149.33636 260.75638 266.63699 375.29669 381.17731 491.81702 497.63824">ZONANANANA</tspan></text><path transform="matrix(1,0,0,-1,0,792)" d="m 46.38,648.24 h 0.47998 v 61.5 H 46.38 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 143.94,647.76 h 0.48002 v 62.46006 H 143.94 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 254.64,647.76 h 0.48 v 62.46006 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 279.42,647.76 h 0.48 v 62.46006 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 327.42,647.76 h 0.48 v 62.46006 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 374.16,647.76 h 0.48 v 62.46006 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 557.1,648.24 h 0.47998 v 61.5 H 557.1 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 46.38,709.74 h 511.2 v 0.48 H 46.38 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 46.38,684.78 h 511.2 v 0.4801 H 46.38 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 46.38,647.76 h 511.2 v 0.48 H 46.38 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 46.14,580.26 h 0.48001 v 31.5 H 46.14 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 89.88,579.72 h 0.48 v 32.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 208.02,579.72 h 0.48 v 32.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 324.36,579.72 h 0.47998 v 32.52 H 324.36 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 437.22,579.72 h 0.48 v 32.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 557.34,580.26 h 0.48 v 31.5 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 46.14,611.76 h 511.74 v 0.48 H 46.14 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 46.14,595.74 h 511.74 v 0.48 H 46.14 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 46.14,579.78 h 511.74 v 0.48 H 46.14 Z" inkscape:connector-curvature="0" /></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="208.18282pt" height="77.717659pt" viewBox="0 0 208.18282 77.717659" sodipodi:docname="1400.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.0943" inkscape:cy="-332.22599" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg62" /><g transform="translate(-45.679276,-69.112849)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-715.31989" x="45.119999 50.603973 56.19751 64.480247 70.093704 75.41832 79.408295 81.868416 87.508766 90.014702 92.540558 95.000679 99.02153 104.55531 107.07519 114.76032 120.35386 125.96732 131.56085 134.08073 139.63443 144.91721 149.35637 154.93596 160.39603 164.35712 166.86305 172.45659 178.18956">Compatibility Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-700.97998" x="45.119999 52.437 59.037598 137.22241 141.00331 144.18752 147.01172 154.63382 160.03471 165.6741 171.01651">#UDIf Mode </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-700.97998" x="173.88">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.0539" class="cDBDE3506 cC7C7E1F8"><tspan y="-700.97998" x="179.88"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-700.97998" x="182.16 187.875 193.59 197.66699 203.83199 206.28899 209.82599">64-Bit.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-675.29999" x="45.119999 51.264324 57.408649 60.505215 66.818863 69.327789 73.320755 75.780876 83.469002 89.065529 94.681976 100.2785 102.73862 108.29531 113.57809 117.9575 123.59686 128.99718 133.01804 135.52696 141.12349 146.85945">64-Bit Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-661.02002" x="45.119999 52.4613 59.4156 64.875 68.953796 74.657097 137.2359 141.0042 144.18839 147.01257 153.31078 158.71077 163.75436">#GP(0)If CPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-661.02002" x="166.56">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.0539" class="cDBDE3506 cC7C7E1F8"><tspan y="-661.02002" x="172.62"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-661.02002" x="174.84 180.5424">0.</tspan><tspan y="-646.98004" x="45.1203 52.4715 59.048702 137.23352 141.01442 144.17162 146.9958 150.53101 156.21721 161.5704 164.45399 169.377 176.45641 182.7276 188.9538 191.77798 197.41739 201.25949 206.61269 209.76988 212.22508 217.54228 220.42587 222.82257 227.50258 230.38617 236.07237 240.75058 246.10378 251.69998">#UDIf the LOCK prefix is used.</tspan></text></g></svg>     <hr />     <p class="not_instruction_page">         This <b>UNOFFICIAL</b> reference was generated from the official <a href="https://www.intel.com/content/www/us/en/developer/articles/technical/intel-sdm.html">Intel® 64 and IA-32 Architectures Software Developer’s Manual</a> by a dumb script.         There is no guarantee that some parts aren't mangled or broken and is distributed <b>WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE</b>.     </p> </body>  </html>
