<!DOCTYPE html> <html lang="en">  <head>     <meta charset="utf-8">     <title>RET</title>     <link rel="stylesheet" href="styles.css">     <link rel="stylesheet" href="../intel.css"> </head>  <body>     <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="511.44028pt" height="649.02722pt" viewBox="0 0 511.44028 649.02722" sodipodi:docname="1275.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.6404" inkscape:cy="429.13525" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg264" /><g transform="translate(-46.019699,-68.824219)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="12" class="cA49CCA52 cD0BE81C2 c209E837B"><tspan y="-714" x="46.02 53.397602 60.055202 66.928802 76.694405 84.132004 90.610802 95.3964 102.282 106.6476 113.5332 116.5332 121.21079 125.29319 132.01079 141.96838 144.96838 152.28598 156.36838 163.08598 168.42479 175.1424 181.884 188.76961 192.912">RET—Return from Procedure</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-570.29999" x="235.67999 238.36819 244.06631 248.74551 252.76637 256.3689 262.12677 266.69742 270.65851 273.1774 278.78387 284.52979 287.04968 293.6492 299.28955 304.89603 308.3183 313.65585 319.40176 324.98135 327.50125 333.0679 338.76599 343.20517 348.78476 354.41116 356.93005 362.62814">Instruction Operand Encoding</tspan><tspan y="-496.3201" x="46.019684 52.490696 58.085228 62.853081 67.411774 71.054146 73.561081 79.021156 82.982254 85.489189 91.083725">Description</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-480" x="46.02 50.637901 54.360302 59.763 65.405098 70.145401 73.269295 78.671997 82.514099 87.1968 89.840996 95.441696 99.278397 104.7351 110.3358 113.9979 119.46181 128.21251 130.8567 135.5394 140.99609 146.6868 150.2265 154.0632 159.5199 161.9796 164.62379 168.1635 173.62019 176.26439 181.66708 184.31128 188.14798 193.50568 197.04538 202.73608 206.57278 212.26349 214.90768 220.31038 225.91107 231.51178 235.34848 240.70618 245.38887 250.07156 252.71576 255.17546 260.63217 265.31488 270.71759 274.25729 279.61499 285.2157 287.85992 293.31662 299.00732 301.65155 305.19125 310.73969 316.1424 318.78659 322.32538 327.78119 333.38098 336.02518 341.48099 344.64178 347.28598 350.82477 356.51456 361.87137 364.51556 369.19736 372.73615 378.13794 382.81973 388.14053 391.44263 394.08682 399.62363 405.31342 410.67023 413.31442 418.71622 424.35562 429.95541 433.7912 439.14801 443.8298 448.5116 451.15579 453.61459 458.29639 460.94058 466.63037 471.31216 477.00195 482.40375 484.86255 487.25925 492.58005 495.22424 500.86365 503.26035 508.66214 513.34393 518.74664 524.32666 526.97089 532.4267 538.11652 540.76074 544.29956 549.98938 555.34619">Transfers program control to a return address located on the top of the stack. The address is usually placed on the </tspan><tspan y="-468.95969" x="46.019989 50.706291 54.249592 59.655891 64.342194 69.667496 72.491692 78.095993 83.421295 86.245491 91.651794 94.535393 100.81469 106.96799 111.97829 116.98859 119.81278 122.27608 127.97038 132.65668 136.19998 140.04028 145.68239 150.42268 153.96239 156.35909 161.81938 167.51369 170.78699 173.61119 179.01749 184.71179 190.31609 193.19969 196.743 202.3851 207.7464 210.5706 214.4109 219.7722 223.31551 229.00981 232.85011 238.54442 241.42802 243.82472 248.50471 251.38832 260.14261 265.54892 271.15323 276.51453 279.29999 282.84329 288.30359 291.12869 294.672 300.3663 305.7276 308.61209 311.00967 316.71207 321.39838 324.94168 328.78198 334.47629 339.1626 342.7059 345.16919 350.62949 356.32379 359.1489 362.6922 368.38651 373.79282 377.33612 380.16122 383.32654 388.78683 391.25012 393.64771 399.108 406.46732 411.15363 413.97873 417.52203 423.21634 428.61993 431.44504 437.72433 443.87762 448.88794 453.89825 456.72336 459.18665 464.88095 469.56726 473.11057 476.95087 482.64517 487.33148 490.87479 493.33807 498.79837 504.44138">stack by a CALL instruction, and the return is made to the instruction that follows the CALL instruction.</tspan><tspan y="-453" x="46.019989 51.554989 57.242989 62.597988 65.062187 70.51619 76.114189 79.651192 82.108192 87.562195 93.250198 98.6502 101.1072 103.5714 108.2514 113.70541 119.39341 123.22741 127.90741 133.26241 135.72661 141.1806 146.77861 152.13361 155.856 161.256 166.944 172.54201 175.00621 179.68622 185.28423 190.68692 195.36691 197.76361 200.94781 203.40482 208.75981 213.43982 215.90402 219.44102 225.12903 230.48402 232.94823 238.63623 244.32423 253.07224 258.67023 264.02524 267.85925 270.32346 275.77747 278.93646 281.40067 286.08066 289.61765 295.01764 299.69763 305.01663 307.48083 313.07883 318.35999 321.90057 327.25919 331.94278 334.40698 337.94757 343.40518 345.86938 351.47098 356.82959 359.29379 363.13138 368.48999 370.95059 376.3092 381.7128 386.39639 391.755 397.3566 399.8208 405.2244 408.38699 411.92758 417.28619 421.12378 423.58798 427.12857 432.77969 438.1311 440.59531 444.42572 449.77713 453.31052 458.9949 462.82532 468.5097 470.97391 476.3703 481.96469 487.55908 491.3895 496.79221 501.4686 506.14499 508.60919 511.06259 515.73901 518.20319 523.79761 529.24799 534.84241 540.48181 545.83319 551.42761 555.50104">The optional source operand specifies the number of stack bytes to be released after the return address is popped; </tspan><tspan y="-441.95969" x="46.019989 49.562389 55.255791 60.616192 63.319794 68.923195 74.283592 77.407494 82.871399 88.513496 90.969597 94.511993 97.215591 99.677994 104.3634 107.06699 112.76039 118.21979 123.91319 129.27359 132.54599 135.24959 140.78999 146.4834 148.9458 153.6312 156.33479 161.79419 167.39758 172.75798 176.42007 181.82547 187.51888 193.12227 195.82587 200.51126 205.91666 211.61006 214.37396 219.97736 225.33775 228.04135 233.73476 238.42015 243.78055 249.38394 252.08754 255.62994 261.08936 263.79297 267.63235 272.99277 275.38947 280.79218 286.19757 290.88297 296.24338 298.85968 304.46219 309.8667 313.52881 318.93243 327.68494 333.04443 336.58594 341.94543 345.78394 350.46844 353.17117 356.33469 360.17319 365.63168 374.38419 377.08691 380.62842 386.32092 391.68042 394.38315 399.06766 402.60916 408.07306 412.75308 418.07657 420.7793 424.3793 430.02139 435.4259 438.96741 441.73044 449.08795 454.44745 458.28595 463.64545 466.34818 471.95068 477.35519 482.0397 486.72421 492.08371 497.68622 500.38895 503.93045 509.38895 512.09161 515.63312 521.32562 526.68512 529.38782 534.07233 539.47681 541.93829 544.33496 549.69446 555.29694">the default is none. This operand can be used to release parameters from the stack that were passed to the called </tspan><tspan y="-430.97968" x="46.019989 51.61079 55.437592 60.884392 65.55719 70.904991 76.544388 82.225189 86.051987 91.454689 93.918892 99.311691 104.99249 110.63189 113.09609 118.48889 122.31569 127.66349 130.12769 135.80849 141.25528 143.71947 146.16927 151.61606 157.29686 162.88766 168.23546 172.06226 174.52644 180.20724 185.55504 190.95773 196.53773 201.88553 207.52493 210.78473 213.24892 217.02171 220.55151 223.0157 231.7565 237.4373 242.17761 245.71732 248.1212 253.7606 259.103 261.5672 267.24799 271.92078 277.26859 282.85938 285.32358 292.66937 298.35016 303.69797 309.35999 311.76389 315.36386 321.00595 326.40866 328.81256 335.09097 341.24338 346.25278 351.26218 353.72638 356.18878 361.88217 366.56757 370.10995 373.94934 379.64273 384.32812 387.87051 390.26633 395.72662 401.42001 403.88422 409.57761 414.263 419.62341 425.22681 427.63071 431.1731 436.63251 439.09671 443.7821 451.1405 453.60291 457.14529 461.83069 467.47278 469.93698 473.47937 478.93878 481.40298 486.80838 489.27258 494.96597 500.32639 507.68478 510.08868 515.69208 519.53149 524.99091 529.67633 535.03674 540.64014 546.33356 550.17297 555.53339">procedure and are no longer needed. It must be used when the CALL instruction used to switch to a new procedure </tspan><tspan y="-419.99966" x="46.019989 51.71339 56.398788 61.75919 66.444588 69.267883 74.673286 77.555984 82.241386 87.64679 90.109192 92.504997 95.387695 100.9911 106.3965 109.9389 115.34069 118.16399 125.52238 127.91819 131.46059 137.15399 140.0367 145.44209 148.2654 153.9588 159.4182 165.1116 169.00951 173.62471 179.0265 182.86591 188.3253 191.14861 198.507 203.907 207.7464 213.34979 216.1731 220.85849 226.31789 232.01129 237.7047 241.2471 244.0704 247.61281 253.0722 255.95491 261.36032 266.04572 270.73111 276.09152 280.77692 285.46231 288.29999 291.83609 297.52319 302.87729 305.70151 311.38861 316.74271 324.09482 326.91904 332.55844 336.40054 341.85364 346.53275 351.88684 357.48395 363.17105 367.00415 372.35825 375.66037 378.48459 385.2337 390.5878 394.4209 399.77499 403.07712 405.90134 409.43744 415.12454 420.47864 423.36224 428.04135 433.49445 439.18155 443.01465 447.69376 453.04785 455.87207 461.32516 466.96457 472.31866 475.98077 481.37988 487.06699 492.66409 495.5477 498.70581 504.15891 507.992 510.87561 514.41168 520.09875 525.45288 528.27704 534.57434 540.21106 545.74518">uses a call gate with a non-zero word count to access the new procedure. Here, the source operand for the RET </tspan><tspan y="-408.95935" x="46.019989 48.47789 54.119991 58.800892 62.338791 66.173691 71.862595 76.543495 80.081398 82.539299 87.994202 93.683105 96.507301 105.2562 110.94511 115.62601 119.16391 121.98811 126.66901 132.26791 137.62381 142.30472 144.76262 147.92252 153.24242 156.12602 159.66393 165.35283 170.70872 173.53293 178.21384 183.61473 192.36363 197.76633 200.59053 206.27943 211.96834 220.71724 226.31615 231.67204 235.50694 238.33115 243.78604 246.94594 249.82954 255.42845 260.74835 264.28625 269.68896 274.36987 277.19409 282.595 287.27591 290.15952 292.55621 297.1803 300.0639 304.7403 310.33469 315.6861 320.36249 322.81589 325.97128 328.42468 333.77609 339.37048 342.25409 344.65079 350.35226 353.23587 356.76926 362.45364 367.80505 370.62927 377.97867 383.42908 387.25949 392.85388 395.73749 400.41388 405.86429 411.54868 417.23306 420.76645 423.65005 426.80545 429.25885 434.61026 437.06366 442.65805 445.54166 450.99207 454.14746 456.97168 460.50507 466.18945 471.54086 474.42447 479.10086 484.49725 486.89395 489.35004 492.23364 497.82803 503.22443 506.75781 512.10919">instruction must specify the same number of bytes as is specified in the word count field of the call gate.</tspan><tspan y="-392.99966" x="46.019989 51.555889 57.244789 62.600689 65.484291 71.731194 77.411095 82.946999 85.771194 88.229095 93.917999 98.5989 102.1368 105.9717 111.66061 116.34151 119.87941 122.27611 127.73641 133.42531 136.3089 140.98981 146.3907 152.03281 154.9164 160.5153 165.8712 168.75479 174.4437 179.1246 184.4805 190.07941 192.963 196.5009 201.9558 204.77998 210.18268 215.28029 220.64069 225.32608 231.01949 234.56189 239.92229 242.74649 246.28889 251.9823 255.8217 261.1821 266.54251 269.3667 274.97009 277.4325 280.59689 283.76129 289.1217 292.96109 298.3215 304.01489 307.55728 310.38147 313.92386 319.24826 324.85165 330.21207 334.89746 337.78104 343.18195 346.36615 349.24973 353.08911 358.44952 361.99191 367.6853 371.52469 377.21808 381.90347">The RET instruction can be used to execute three different types of returns:</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-378" x="46.02">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c89C0ADDA"><tspan y="-378" x="63 70.648201 76.587296 82.624496 87.064194 89.286293 93.784492 99.723587 103.80779 110.22388 114.72208">Near return</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-378" x="121.0797 123.42329 132.36299 134.70659 140.85809 143.14229 146.98079 152.34029 155.88179 161.5239 165.3624 171.0549 173.3985 176.94 182.3985 184.68269 190.08719 192.37138 197.05588 202.46037 204.92188 207.38338 209.78008 215.47258 221.07507 223.35927 228.96176 232.80026 238.25876 242.94325 248.30275 253.90524 259.59775 263.43625 268.79575 271.07996 278.43747 280.83417 284.37567 290.06818 292.52966 298.22217 300.50638 304.04788 309.74039 315.09988 317.44348 322.12799 327.78 331.6149 335.4498 340.85251 346.54141 350.07932 352.36353 357.04443 362.49933 368.09824 373.45413 375.79773 380.47864 385.83453 391.43344 400.18234 405.53824 411.22714 414.76505 417.10864 421.18655 424.72446 430.36655 435.76926 438.05347 442.73438 448.09027 453.68918 462.43808 467.84079 473.5423 477.0802 479.36441 484.04532 489.73422 493.56912 497.40402 502.75992 508.44882 511.98672 514.38342 519.72491 522.00916 527.60803 533.06293 535.45874 541.16022 544.69812 550.10083 555.69971"> — A return to a calling procedure within the current code segment (the segment currently pointed </tspan><tspan y="-366.95969" x="63 66.537903 71.992805 74.876404 80.475304 85.795204 88.678802 92.216705 97.905609 103.26151 106.08571 112.35961 118.50751 121.39111 125.22601 130.58191 136.18082 138.63872 143.31961 146.85751 152.21341 156.04831 160.12621 163.3941 166.21829 170.8992 176.3541 185.103 190.45889 193.9968 196.4547 205.2036 210.55949 215.24039 218.12398 221.95888 227.31477 230.47467 235.83057 239.66547 243.50037 248.85626 254.45517 257.33878 260.87668 266.33157 269.15579 274.5567 279.23761 282.12122 287.52213 293.21103 296.03525 298.49313 304.18204 307.71994 311.38205 316.78296 321.46387 326.81976 332.41867 341.12167 346.52438 352.16647 355.70618 358.58978 362.42468 367.78058 371.31848 377.00739 380.84229 386.53119">to by the CS register), sometimes referred to as an intrasegment return.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-351.95999" x="46.02">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c89C0ADDA"><tspan y="-351.95999" x="63 68.823898 74.884499 79.331398 82.093498 86.592598 92.531693 96.609596 102.99149 107.43839">Far return</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-351.95999" x="113.8797 116.7633 125.703 128.58659 134.7372 137.62079 141.45839 146.81699 150.35759 156.04919 159.8868 165.5784 168.40259 171.94319 177.40079 180.22498 185.62857 188.51216 193.19576 198.59935 201.05995 203.45665 205.91725 211.60886 217.21045 220.09404 225.69565 229.53325 234.99084 239.67444 245.03304 250.63464 256.32623 260.10803 265.51074 268.33496 270.79556 276.25317 280.93677 286.34036 289.88095 295.23956 300.84116 303.66537 306.12598 311.81757 314.64178 320.04538 322.85968 328.47119 330.94168 334.11417 337.28665 342.65515 346.50266 351.87115 357.51328 361.06378 363.94736 368.64087 374.00937 379.62088 388.32388 393.69238 399.3345 402.88501 405.76859 409.31909 415.0206 420.43411 426.13562 428.95981 432.51031 438.21182 443.58032 446.4639 451.15741 456.79953 460.64703 464.49454 469.86304 475.50516 479.04486 481.92844 486.62195 492.08945 497.70096 503.06946 505.89365 510.58716 515.95569 521.5672 530.2702 535.63873 541.28082 544.8313 548.11182"> — A return to a calling procedure located in a different segment than the current code segment, </tspan><tspan y="-340.97998" x="62.999969 67.683571 73.141174 81.892776 87.251373 90.791977 93.252579 102.00418 107.36278 112.04638 114.87057 118.70818 124.06677 127.22937 132.58797 136.42557 140.26317 145.62177 151.22336 154.10695 157.64755 163.10515 165.92934 171.33293 176.01653 178.90012 184.30371 189.94582 192.82941 195.29001 200.93211 204.47272 209.83131 213.66891 218.35251 223.71111 229.31271 238.06432 243.42291 249.11452 252.65512 255.53871 259.37631 264.73492 268.27551 273.9671 277.80469 283.49628">sometimes referred to as an intersegment return.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-325.98001" x="46.02">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c89C0ADDA"><tspan y="-325.98001" x="63 67.942802 74.379601 78.463799 84.402901 88.904701 93.253502 99.491402 103.9905 107.05231 112.8735 115.9803 119.0421 124.9812 131.27939 137.28419 141.5448 144.6516 150.5907 156.4695 162.4086 165.4704 168.2325 172.0593 178.0596 182.4993 185.2614 189.7632 195.7023 199.7865 206.20259 210.64229">Inter-privilege-level far return</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-325.98001" x="217.0197 219.90331 228.843 231.72661 237.87631 240.75992 243.92162 249.38551 253.16731 256.0509 259.8876 265.2453 268.785 274.47571 278.31241 284.00311 286.82733 290.36703 295.82373 298.70734 304.11005 306.93427 312.53497 314.99466 318.15637 321.31808 326.67578 330.51248 335.87018 341.56088 345.10059 347.9248 353.52551 357.36221 359.8219 365.14359 367.60327 370.06296 375.42065 381.02136 386.37906 389.20328 391.66296 397.02066 402.24243 407.64514 410.04184 412.92545 416.46515 422.15585 427.55856 433.24927 436.07349 439.61319 445.30389 450.7066 454.24631 457.07053 462.52722 465.68893 468.51315 472.05286 477.74356 483.10126 485.92548 490.60818 496.29889 500.13559 503.97229 509.32999 515.02069 518.56036 521.02008 526.3418"> — A far return to a different privilege level than that of the currently </tspan><tspan y="-315" x="63 68.359497 73.581299 78.940796 83.625298 89.267395 92.807098 95.2686 100.9611 106.5636 109.4472 115.0497 118.8882 124.3467 129.9492 133.6716 139.0752 147.7782 150.66179 156.12029 159.95879 162.78297 168.38547 172.16727 177.62576 182.31026 187.66975 193.27225 198.96475 202.80325 208.16275">executing program or procedure.</tspan><tspan y="-298.98001" x="46.019699 51.551102 57.2355 62.586899 65.3508 67.804199 73.488602 77.022003 82.373405 86.095802 90.174606 95.769005 99.599403 101.9961 107.3376 109.791 112.2444 117.5958 123.1902 128.5416 132.61499 135.06839 140.41978 145.73518 151.08658 153.53998 156.30388 160.13428 165.48567 169.01907 174.70348 178.53387 184.21828 186.98218 190.51558 195.83098 201.42538 206.77678 209.54068 214.21709 219.59999 225.28439 227.98709 233.43748 239.12189 241.57529 246.89069 249.59338 255.18779 260.53918 263.30219 268.65359 273.87448 279.22589 283.90228 289.58667 293.12006 298.47147 304.06586 306.82886 309.22467 314.92526 317.68826 323.28265 327.11307 332.56348 336.09686 341.49869 346.17776 349.71115 355.06256 360.65695 363.41995 372.16437 377.61478 383.20917 388.56058 391.82397 394.58698 400.73038 406.08179 411.48361 414.24661 417.78 423.46439 428.86621 431.56891 436.30829 441.64981 446.3262 449.85959 452.31299 457.7634 463.44778 466.21078 469.74417 472.19757 475.73096 478.18436 483.53577 489.13016 491.89316 496.01157 502.28098 507.67737 510.13077 512.58417 515.0376 520.72198 526.31641 529.07941 534.49384 538.32422 543.7746 548.45099 553.80237">The inter-privilege-level return type can only be executed in protected mode. See the section titled “Calling Proce-</tspan><tspan y="-288" x="46.019699 51.616798 57.303898 61.136997 66.491096 71.170197 74.053795 80.631897 85.310997 87.767097 93.454201 99.0513 101.9349 108.207 113.6061 116.0622 118.5183 121.34251 126.74161 132.42871 138.02582 140.90942 147.15453 152.83263 158.36673 162.48782 165.31203 167.76813 173.45523 176.27943 182.55153 188.23863 193.63773 199.23483 202.77094 208.12503 211.95813 214.84174 220.55583 223.38004 228.83313 231.99123 234.81543 238.35153 244.03864 249.44133">dures Using Call and RET” in Chapter 6 of the </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-288" x="252.2394 256.02209 261.7128 265.2525 270.6102 273.06989 282.0636 284.88782 290.65054 296.35297 299.17719 304.64108 310.28317 315.88388 318.7081 322.49081 328.6315 332.71121 338.47394 344.19165 347.01587 353.19977 357.04187 361.72458 367.41528 369.87497 373.41467 378.77237 383.45508 386.99478 392.68549 396.52219 401.87988 406.56259 409.4462 415.59589 421.05258 424.21429 427.754 435.10971 440.51242 444.34912 449.75183 452.57605 459.46375 464.82144 470.13416 475.49185 477.95154 483.40823 489.00894 494.36664 498.20334 500.66754 505.35025 508.17447 515.75519 521.1579 526.84857 532.53925 537.94196 540.40167 543.67139">Intel® 64 and IA-32 Architectures Software Developer’s Manual, </tspan><tspan y="-276.95969" x="46.019699 52.1577 57.611702 60.068703 65.756706 74.504707 79.859711 82.683907">Volume 1</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-276.95969" x="88.4394 91.702797 94.586403 97.741806 103.19221 107.02261 109.90621 115.50061 120.85201 124.38541 129.78181 132.23521 134.68861 140.04001 145.63441 148.51801 150.97141 156.65581 159.8112 165.2616 169.092 177.8364 183.23279 186.76619 189.21959 194.66998 200.35439 203.23798 208.68837 214.37277 217.19696 222.88136 228.23276 233.62915 236.21124 239.47464 242.35823 245.51363 250.91002 253.43182 256.73392 259.55814 264.95453 270.63892 276.23331 279.11691 281.57031 287.2547 290.78809 296.1908 299.91321 303.992 309.5864 313.41681 315.81351 321.155 323.6084 326.0051 331.40781 336.98779 342.3392 346.4126 348.866 354.21741 359.53281 364.88422 367.33762 370.16183 373.99225 379.34366 382.87704 388.56143 392.39185 398.07623 402.75262">, for detailed information on near, far, and inter-privilege-level returns.</tspan><tspan y="-261" x="46.019699 54.916199 60.6087 65.968201 71.660698 74.484894 79.844391 85.066193 90.42569 95.110191 100.80269 104.34419 106.80569 112.49819 118.10069 120.92489 126.32939 129.15359 134.7957 140.19839 145.60289 149.44139 152.26559 156.1041 161.46359 165.0051 170.6976 174.5361 180.17821 183.44971 186.27391 189.81541 195.50792 200.86742 203.69162 209.29411 213.13261 218.59111 223.2756 228.6351 233.3196 238.00409 243.46259 247.30109 250.12529 255.72778 261.12869 266.7312 271.41571 274.23993 277.78143 283.47394 288.83344 291.65765 295.49615 300.85565 304.39716 310.08966 313.92816 319.62067 322.38458 324.84607 330.53857 335.22308 338.76459 342.60309 348.29559 352.9801 356.52161 358.98309 364.44159 370.08368 372.9079 378.51041 383.91132 386.3728 392.06531 395.60681 400.96631 404.80481 407.62903 411.71054 417.16904 420.33255 423.49606 428.18057 433.54007 437.08157 441.16309 443.9873 447.15082 450.98932 456.44781 465.20032 468.02454 471.56604 477.25854 482.61804 485.44226 488.98376 494.44226 500.04477 502.86899 508.32748 511.491 514.31519 517.85669 523.49878 528.85828 531.6825 536.367 539.90851 545.31299 549.9975 555.32098">When executing a near return, the processor pops the return instruction pointer (offset) from the top of the stack </tspan><tspan y="-249.9597" x="46.019699 48.472198 54.155701 57.688202 63.137703 66.021309 69.55381 75.237312 80.587814 83.412018 89.086517 92.862015 98.275513 101.15912 104.98862 110.33912 115.93262 118.38512 123.06062 126.59312 131.94362 135.77312 138.65671 144.05222 149.73572 155.32922 158.21281 163.80632 169.15681 174.75032 177.20282 182.88632 187.56183 190.44542 196.03893 199.86842 205.31792 210.91142 214.57352 219.97713 228.72063 231.60422 236.95471 242.17651 247.52701 252.20251 257.88602 261.41852 263.87103 269.32053 275.00403 277.88763 283.28314 286.81564 289.63986 293.17236 298.85587 304.20636 307.08002 312.77432 318.13562 325.49493 328.31915 330.78244 336.47675 341.16306 344.70636 348.54666 354.18878 358.87509 362.4184 364.88168 370.34198 376.03629 378.8605 384.46481 389.92511 392.32181 398.02332 401.56662 406.96933 409.49112 412.79321 415.61743 421.15872 426.85303 432.25574 435.07996 441.35925 447.51254 450.39615 454.17795 459.58066 465.18497 467.64825 472.33456 475.87787 481.23917 485.07947 487.96307 490.35977 495.03979 497.9234 503.61771 509.25983 514.00012 519.64221 525.04852 530.7428 536.34711 541.70844 547.31274 550.58606">into the EIP register and begins program execution at the new instruction pointer. The CS register is unchanged. </tspan><tspan y="-234" x="46.019714 54.918015 60.612316 65.973618 71.667915 73.953011 79.314308 84.53701 89.898308 94.58461 100.22761 103.7682 106.23151 111.9258 117.53011 119.8746 125.28091 127.56601 130.73131 136.1376 139.97791 142.263 146.1033 151.4646 155.0079 160.70221 164.54251 170.23682 173.51012 175.85461 179.39792 185.04092 190.40222 192.68732 198.29161 202.13191 207.59221 212.2785 217.6398 222.381 227.06729 232.52759 236.31029 238.65479 244.25908 249.71938 255.32367 260.00998 262.35449 265.8978 271.5408 276.9021 279.18723 283.02753 288.38882 291.93213 297.62643 301.46674 307.16104 309.44617 311.90945 317.60376 322.29007 325.83337 329.67368 335.36798 340.05429 343.5976 345.99518 351.45636 357.15067 359.43579 365.0401 370.5004 372.89798 378.60037 382.14368 387.50497 391.28769 393.6322 396.79752 400.63782 406.09811 414.85242 417.13754 420.68085 426.37515 431.73645 434.02158 437.56488 443.02518 448.62949 450.91461 456.37491 459.54022 461.82535 465.36865 471.06296 476.42426 478.76877 483.45508 486.99838 492.40469 497.091 502.41629 504.7608 507.15839 512.86078 516.40405 521.86438 524.20886 527.75214 533.39423 538.75555 541.04065 546.72595 550.51227 555.93658">When executing a far return, the processor pops the return instruction pointer from the top of the stack into the EIP </tspan><tspan y="-222.9597" x="46.019714 49.856415 55.214115 60.814816 63.274517 67.957214 71.496918 76.854614 79.436714 82.706413 85.530609 89.070312 94.761009 100.11871 105.80941 108.63361 114.23431 119.69101 125.29171 129.97441 132.858 136.39771 142.03981 147.39751 150.22169 154.90439 160.26208 165.86279 174.61349 179.97119 185.6619 189.2016 192.02579 196.70848 202.06618 204.52588 209.88358 214.56627 218.10597 223.56267 227.39937 230.28296 233.44466 237.28136 242.68225 251.44556 254.32915 257.86884 263.51093 268.86862 271.69284 275.23254 280.68924 286.28995 289.17355 294.63025 297.79196 300.61618 304.15588 309.84659 315.20428 318.08789 322.7706 326.3103 331.71301 336.39572 341.71741 344.60101 347.0607 352.70279 356.24249 361.69919 364.58279 368.1225 373.8132 379.1709 381.99512 388.27081 394.4205 397.30411 401.14081 406.4985 412.09921 414.5589 419.24161 422.78131 428.13901 430.7211 433.99081 436.81503 442.35272 448.04343 453.40112 456.28473 461.88544 465.72214 471.17883 475.86154 481.21924 485.95953 490.64224 496.04315 499.87985 502.76346 506.30316 511.99387 517.35156 523.04224 525.86646 531.46716 536.82489 542.4256 544.88531 550.57599 555.25867">register, then pops the segment selector from the top of the stack into the CS register. The processor then begins </tspan><tspan y="-211.97971" x="46.019714 51.611416 55.439117 60.886818 66.478516 70.200912 75.604515 84.346214 87.22982 92.578522 97.800323 103.14902 107.82272 113.50443 117.03513 119.48582 124.93353 130.61522 133.43941 135.89011 141.57181 144.396 147.9267 153.6084 158.95709 161.84068 167.52238 172.87108 180.21777 183.10136 187.77507 193.22278 198.81448 204.16318 207.04677 211.72047 217.08002 222.67892 231.42783 236.78372 242.47263 246.01053 248.89412 254.29501 257.83292 260.65714 264.19504 269.88394 275.23984 278.12344 283.81235 289.16824 296.52216 299.40576 301.86365 307.55255 312.23346 315.77136 319.60626 325.24835 329.92926 333.46716 335.92505 341.37994 347.06885 349.89307 355.49197 360.94687 363.34265 369.04416 372.58206 377.93796 380.52005">program execution in the new code segment at the new instruction pointer.</tspan><tspan y="-195.9597" x="46.019714 51.552017 57.237316 62.589615 65.473221 74.218521 79.621223 84.298523 89.983826 95.381126 101.06643 103.52073 108.19803 112.87533 115.75893 121.21024 124.36654 127.25014 132.64745 138.33275 141.15694 143.61124 149.29654 152.83084 158.18314 161.90553 165.98433 171.57964 175.41093 177.80763 183.14914 185.60344 188.05774 193.41003 199.00534 204.35764 208.43193 210.88623 216.28893 221.51073 226.86302 229.31732 232.14151 235.29781 240.6951 244.5264 247.35059 251.18188 256.58459 260.1189 265.8042 269.6355 275.3208 278.20441 283.60172 287.39972 292.76102 295.64462 300.33093 302.72763 311.48193 313.94522 316.40851 321.81482 325.65512 328.47934 332.02264 337.48294 340.30716 345.71347 351.40778 354.29138 356.68808 362.38959 365.93289 371.29419 375.13449 379.8208 385.1821 390.78641 399.54071 404.90201 410.59631 414.13962 417.02322 420.80502 426.20773 429.75104 435.44534 439.28564 444.92776 448.20105 451.02527 456.38657 461.60837 466.29468 471.65598 477.26028 480.80359 483.68719 487.2305 492.9248 498.33112 501.87442 504.69864 508.24194 513.93622 519.29755">The mechanics of an inter-privilege-level far return are similar to an intersegment return, except that the </tspan><tspan y="-184.97971" x="46.019714 51.615013 55.446312 60.897614 65.574913 70.927216 75.604515 80.281815 85.733116 89.564415 92.328316 97.680618 102.99692 108.39422 117.13952 119.59382 125.27912 130.63142 135.30873 138.07263 141.60693 147.29224 152.64453 155.34813 160.98753 164.82964 167.22633 172.56784 175.02214 177.41884 182.82153 188.40154 193.75383 196.51773 198.97203 204.32433 209.54613 214.88852 217.34282 222.02013 224.78403 230.18132 235.86662 241.50603 244.20963 249.60692 254.28423 258.96152 264.36423 269.04153 273.71884 276.42245 280.25375 282.70807 288.30338 293.98868 297.52298 302.20029 304.85971 310.3092 313.46371 316.16733 319.69983 325.38333 330.78601 333.48962 338.16513 343.61462 349.20813 354.61081 357.31442 362.70993 368.39343 373.98694 376.75085 381.42636 384.95886 390.35437 395.02988 400.34439 403.10831 407.78381 413.13431 418.72781 427.47131 432.82181 438.53943 442.07733 446.75824 449.52216 455.12106 460.47696 462.93484 468.62375 474.22266 476.98657 480.82147 486.17737 489.71527 495.40417 499.23907 504.88116 510.23706 515.83594 518.59985 522.13776 527.53864 530.30255 535.90143 541.25732 544.79523 550.15112 553.87354">processor examines the privilege levels and access rights of the code and stack segments being returned to deter-</tspan><tspan y="-173.99971" x="46.019714 54.771317 57.168018 62.859619 68.218216 70.561813 72.958511 76.142708 78.426903 81.967506 87.659103 93.061798 95.345993 100.02959 105.4872 111.17879 114.7194 118.557 124.0146 126.4113 128.7549 132.2955 135.9576 141.36119 147.0528 151.73639 154.89899 160.25758 164.09518 166.37938 168.83998 173.52357 175.80777 181.21136 183.67197 186.13257 191.59016 198.94676 204.30536 209.90695 212.19115 215.73175 221.18935 223.47354 229.07513 234.43373 236.71793 245.46953 250.87312 256.47473 261.87744 265.14804 267.43225 272.97086 278.66245 284.02106 286.30527 293.23886 299.30215 302.57275 304.85696 310.53955 316.60284 319.87344 322.15765 327.32724 333.39053 336.66113 339.00473 344.40833 350.09991 355.70151 357.98572 364.95532 371.10593 373.39014 378.07373 383.43234 389.03394 397.78552 403.14413 408.83572 412.37631 414.66052 418.49811 423.85672 429.45831 431.85501 436.5386 440.07919 445.4819 449.32397 454.00757 456.29178 461.69537 465.53296 470.89157 473.17578 477.91608 480.31189 485.7146 491.11819 494.95578 500.31439 505.91599 508.2002 513.80182 519.12439 521.40857 524.94916 530.64075 536.04346 538.32764 544.57721 550.25983 555.7984">mine if the control transfer is allowed to be made. The DS, ES, FS, and GS segment registers are cleared by the RET </tspan><tspan y="-162.95941" x="46.019714 48.475815 54.162914 58.842014 62.378113 66.211212 71.898315 76.577415 80.113518 82.569618 88.02272 93.709824 95.933716 101.53082 107.21792 111.05102 113.44772 119.13482 124.73192 127.01611 132.41521 138.10231 140.38651 142.84261 148.52971 152.06581 157.46851 161.1909 165.2697 170.86681 174.69991 177.15601 182.47411 184.93021 187.3269 192.7296 198.3096 203.6637 207.73979 210.19589 215.54999 220.86809 226.19972 228.66212 230.88602 234.72542 240.08582 243.62822 249.27032 253.10973 258.80313 261.08734 263.54974 266.71414 268.99835 272.54074 278.23413 283.59454 288.91895 291.20316 295.04254 300.40295 303.56735 308.92776 312.76715 315.05136 318.59375 323.99466 326.27887 330.96426 336.32468 341.92807 350.68146 356.04187 361.73526 365.27765 369.96304 372.18695 375.72934 381.42273 386.82812 390.29944 392.58365 397.98636 401.82306 407.18076 409.46497 415.15567 420.61237 424.15207 426.43628 431.83899 434.23569 436.69537 442.15207 449.50778 454.86548 460.46619 462.7504 466.2901 471.7468 474.03101 479.63171 484.98941 487.27362 492.67633 497.35904 502.04175 507.39944 512.08215 516.76483 522.12256 527.72327 530.00745 535.41016 538.94983 541.17371 544.71338 550.40405 555.76178">instruction during an inter-privilege-level return if they refer to segments that are not allowed to be accessed at the </tspan><tspan y="-151.97942" x="46.019745 51.706844 57.060944 64.41304 66.936638 72.533737 76.366837 78.822937 84.141037 86.597137 88.993835 94.396538 99.97654 105.33064 107.85424 110.31034 115.66444 120.88625 126.28895 128.68564 131.98773 134.51132 140.65742 143.11353 148.80063 153.47974 158.83383 161.35742 166.75652 169.2207 173.89981 177.43591 182.83501 187.5141 192.8322 195.35579 200.03488 207.38698 209.84308 213.37918 218.05829 223.74539 226.26898 231.66808 234.12418 238.80328 244.20418 246.72777 252.18086 256.85995 261.53906 267.22617 271.05927 275.73837 278.26199 283.71509 289.35718 291.8808 297.27991 302.94003 305.46362 307.91342 313.59421 317.12399 322.5267 326.24911 330.32791 335.9187 339.74551 342.19531 347.50711 349.95691 352.40671 357.80942 363.38852 368.73633 371.25992 373.70972 379.05753 384.27933 389.68204 392.13184 394.65543 398.48224 403.83005 407.35983 413.04062 416.86743 422.54822 425.80801 428.3316 431.86139 437.54218 442.88998 445.41357 451.08539 457.22519 462.63599 465.15958 470.55237 476.23315 481.82394 484.34753 490.41083 496.53442 499.05801 502.88483 508.23264 513.82343 516.27325 520.94604 524.47583 529.87848 533.72058 538.39337 540.8576 546.25043 550.07721 555.47986">new privilege level. Since a stack switch also occurs on an inter-privilege level return, the ESP and SS registers are </tspan><tspan y="-140.99942" x="46.019745 48.474945 53.927147 59.325348 64.964745 70.317947 75.914146 78.797752 81.954956 85.787155 91.239357 99.985558 102.86916 106.40437 112.09057 117.44377 120.26797 124.94617 128.48137 133.87956 138.55777 143.87497 147.17706">loaded from the stack. </tspan><tspan y="-124.97942" x="46.019745 49.803345 52.965946 55.790146 61.391747 66.795349 70.517754 75.921356 84.624359 90.027054 93.567657 98.926254 102.76385 107.44746 110.27165 115.67525 119.51286 124.87145 127.69566 133.29726 138.70085 143.38445 148.06804 153.42664 159.02823 161.91183 165.45244 170.91003 173.73424 177.27484 182.96645 188.32504 191.20865 195.89224 201.29584 203.69254 206.14864 211.50723 217.10883 219.93303 225.53464 229.37224 234.77313 239.51343 244.87202 250.47363 256.16522 260.00281 265.36142 268.245 273.84659 279.53818 283.37576 285.83636 291.47845 297.11786 299.94205 305.34564 310.97974 313.80392 316.25552 321.93811 325.4697 330.81931 334.6011 338.6799 344.27249 348.1011 350.5527 355.8663 358.3179 360.7695 366.11911 371.7117 377.06131 379.8855 382.3371 387.68671 393.00031 398.34991 400.80151 403.6257 408.30029 413.69489 416.14648 418.59808 421.85968 424.73975 428.27945 433.97015 439.32785 442.15207 447.60876 453.20947 456.80948 459.20618 464.66287 470.35358 475.75629 478.21597 481.04019 485.7229 491.1796 496.8703 500.707 505.38971 510.74741 513.63098 519.08771 524.68842 530.04614 533.76849 539.1712 544.81329 550.414">If parameters are passed to the called procedure during an inter-privilege level call, the optional source operand </tspan><tspan y="-113.99941" x="46.019714 54.770416 60.412518 65.095215 68.634918 71.338516 76.939217 82.296921 84.941116 90.631813 95.314514 100.67221 106.27291 108.91711 116.2728 118.73251 122.27221 127.96291 130.6071 134.1468 139.83751 145.19521 147.8394 154.0881 159.76981 165.30751 167.95171 170.41141 176.10211 180.78481 184.32451 188.16121 193.85191 198.53461 202.07431 204.53401 209.93491 215.62561 218.26981 221.80951 227.2662 229.9104 233.7471 239.1048 241.5015 246.90419 252.30688 256.98959 262.34729 264.99152 268.53122 274.22192 279.57962 282.22385 287.82455 293.22726 296.88937 302.27942 311.03192 316.39142 319.93292 325.29242 329.13092 333.81543 336.45966 341.91815 347.61066 350.25488 353.79639 359.48889 364.84839 367.49261 371.33112 376.69061 380.23212 385.92462 389.70642 395.40793 398.67944 401.32367 408.07816 413.43765 417.27615 422.63565 425.90717 428.61078 432.15228 437.79437 443.15387 445.7981 451.4006 456.80511 460.46722 465.87085 474.62335 479.98285 483.52435 488.88385 492.72235 497.40686 500.05109 505.4556 509.2941 514.65363 517.29785 521.13635 526.49585 528.95734 534.31683 539.72131 544.46161 549.82111 555.42358">must be used with the RET instruction to release the parameters on the return. Here, the parameters are released </tspan><tspan y="-102.95911" x="46.019714 51.618614 57.073517 60.611416 66.300316 69.124512 72.284409 76.119308 81.574211 90.323112 93.147308 96.685211 102.37411 107.73002 110.61362 115.29452 120.69542 123.15332 125.55002 130.95271 136.53271 139.35692 144.99632 148.83842 154.29332 158.97421 164.33011 169.92902 175.61792 179.45282 184.80872 186.91292 191.65321 194.47742 199.15833 202.69623 208.09712 212.77802 218.09792 220.92212 226.32301 232.01192 237.61082 240.49443 244.03233 249.72124 255.07713 257.90134 262.58224 268.04614 270.44284 272.90073 275.35861 281.04752 286.64642 289.47064 295.11005 298.95215 304.40704 309.08795 314.44385 320.04276 325.73166 329.56656 334.92245 337.02667 341.76697 344.59119 349.27209 352.81 358.21091 362.89182 368.21173 371.03595 375.11386 378.65176 384.34067 389.74158 393.27948 396.16309 398.55978 403.23981 406.54193 409.36615 412.90405 418.59296 423.94885 426.83246 431.51337 435.05127 440.45218 445.13309 450.453 453.27722 458.91663 464.25903 466.71692 472.40582 478.04523 480.86945 484.70435 490.06024 493.59814 499.28705 503.12195 508.81085 514.16675 519.80615 522.63037 526.16827 531.62317 535.70105">both from the called procedure’s stack and the calling procedure’s stack (that is, the stack being returned to).</tspan><tspan y="-86.999413" x="46.019714 49.805115 55.498516 58.32272 64.043121 69.763519 73.845917 79.449318 81.91172 85.454117 88.278313 97.031715 102.49112 108.09452 113.45492 116.72732 119.55151 123.09391 128.78731 134.14771 136.97191 142.5753 147.9357 151.1001 156.50549 162.1989 164.6613 168.2037 171.02791 176.4873 182.0907 187.4511 191.11319 196.51859 200.06099 202.52339 207.98279 213.67619 216.5004 221.18579 223.64819 228.3696 233.73 236.6136 242.0145 245.1987 248.08231 251.62471 257.26682 259.72922 264.41461 267.29819 269.69489 275.39636 280.08176 283.62415 287.46353 293.15692 297.84232 301.2597 303.71579 309.16888 314.85599 317.68021 320.13629 324.8154 327.63962 331.17572 336.86282 342.21692 345.10052 349.77963 353.31573 358.71484 363.39395 368.25574 372.27515 377.67426 383.27136 388.86847 392.70157 398.05566 402.73477 407.41388 410.2381 414.91721 417.37329 422.08838 427.44247 430.70859 433.53281 435.98889 439.255 444.65771 447.89954 450.78314 456.49725 462.21136 465.09497 470.69208 473.14816 476.68427 481.36337 484.62949 487.51309 493.04718 498.73428 501.19037 505.86948 508.6937 514.09277 519.68988 525.28699 527.7431 530.13892 535.54163 540.2207 543.04486 546.58093 552.03406">In 64-bit mode, the default operation size of this instruction is the stack-address size, i.e. 64 bits. This applies to </tspan><tspan y="-75.959114" x="46.019699 51.7131 57.073502 62.478901 66.318298 69.142494 72.981895 78.342293 81.884689 87.526787 91.366188 97.059586 101.74499 105.01739 107.84158 113.53498 118.99438 122.53678 125.36098 128.52538 133.93077 137.77017 140.65378 144.49318 149.85358 153.39598 159.08939 162.92879 168.57089 173.31119 177.38998 180.21419 183.75659 189.45 194.81039 197.694 203.29739 208.65779 211.82219 217.22758 222.92099 225.31769 228.91769 231.7419 237.20129 242.80469 248.16508 251.88748 257.29288 260.83527 263.29767 268.69858 274.39197 277.27554 281.96094 284.42334 289.03946 294.44217 297.26636 302.72577 305.89017 308.71436 311.87875 317.28415 321.12354 323.94772 327.78711 333.14752 336.68991 342.332 346.17139 351.86478 356.55017 359.43375 361.83044 366.51044 369.39401 375.11441 380.83481 383.71838 389.32178 391.78418 395.32657 400.01196">near returns, not far returns; the default operation size of far returns is 32 bits.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-700.97943" x="50.399998 56.367897 61.468197 65.427292 70.466393 75.516296 80.548195 147.9888 150.3882 155.5461 159.7455 163.3284 166.5963 171.7542 175.8501 179.433 181.6749 186.7068 258.64471 264.61261 269.66251">Opcode*InstructionOp/</tspan><tspan y="-691.0191" x="258.66 263.69821">En</tspan><tspan y="-700.97943" x="283.38031 288.90451 294.4827 297.2529 302.93011 305.16931 308.74951">64-Bit </tspan><tspan y="-691.0191" x="283.38031 290.32471 295.37912 300.4191">Mode</tspan><tspan y="-700.97943" x="331.44031 336.3714 341.40149 348.8616 353.9097 358.69681 362.27789">Compat/</tspan><tspan y="-691.0191" x="331.44031 335.82062 340.85971 345.9006 348.18033 355.09323 360.11612 365.15701">Leg Mode</tspan><tspan y="-700.97943" x="378.17999 383.9985 389.02499 393.3045 397.39502 400.65753 402.89404 407.81433 411.41525 413.65176 418.67825">Description</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-676.01971" x="50.400024 55.126823 147.94743 153.37624 158.10304 258.66187 263.64066 283.37857 288.72006 293.15976 295.08127 297.03607 301.65576 331.41516 336.69635 341.13605 343.06384 345.01865 378.13773 383.95892 388.63983 393.13892 396.40771 398.62711 401.74921 406.25012 409.62692 414.36002 417.6405 422.3826 424.60202 427.90231 432.58322 434.80264 438.72214 443.20865 445.14816 447.08768 449.00916 453.80167 458.42139 460.64081 465.31631 468.37811 473.11661 477.0361 481.76559 486.38531 491.17783 494.23962 498.96912">C3RETZOValid ValidNear return to calling procedure.</tspan><tspan y="-661.01941" x="50.400024 55.117825 147.93933 153.35913 158.07693 258.63574 263.61453 283.35245 288.69397 293.15976 295.07855 297.02435 301.67914 331.43854 336.71976 341.15945 343.07825 345.02405 378.14313 382.82404 387.28983 390.54962 392.76901 395.83081 400.33173 403.69952 408.47131 411.73111 416.5029 418.72229 421.96228 426.70349 428.92288 432.82169 437.28748 439.20627 441.18716 443.13297 447.90475 452.55954 454.77893 459.43372 462.49551 467.21332 471.11212 475.82092 480.47571 485.2475 488.3696 493.0784">CBRETZOValid ValidFar return to calling procedure.</tspan><tspan y="-646.0191" x="50.400024 55.141224 60.361225">C2 </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-646.0191" x="62.579723 64.680321">iw</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-646.0191" x="147.96002 153.37172 158.08142 163.25012">RET </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-646.0191" x="165.48032 167.54942 174.56853 181.58763 186.84273">imm16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-646.0191" x="258.66003 283.38123 288.72272 293.16241 295.08392 297.04773 301.66742 331.42682 336.70801 341.14771 343.0845 345.04831 378.16739 383.98859 388.66949 393.16858 396.44638 398.66577 401.78787 406.28879 409.67459 414.41669 417.69449 422.43658 424.65598 427.95627 432.63718 434.85657 438.77338 443.25717 445.19397 447.13077 449.05228 453.84207 458.46176 460.68115 465.35394 468.41574 473.15155 477.06836 481.79517 486.41486 491.20465 494.26645 498.99326 501.21265 505.65234 510.45474 515.07446 517.29388 521.96667 526.64758 531.32037">IValid ValidNear return to calling procedure and pop </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-634.97882" x="378.18002 380.24911 387.26822 394.28732 399.54242">imm16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-634.97882" x="404.75974 406.97916 411.65466 416.34818 419.73666 424.46616 428.42795 430.64737 433.99988 437.06168 441.80017 448.76166 450.98108 454.88257 458.24225 462.68195 466.58163 470.87912"> bytes from stack.</tspan><tspan y="-619.97852" x="50.400055 55.119656 60.721256">CA </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-619.97852" x="62.939754 65.040352">iw</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-619.97852" x="147.96005 153.37175 158.08145 163.25015">RET </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-619.97852" x="165.48035 167.54945 174.56856 181.58766 186.84276">imm16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-619.97852" x="258.66003 283.38123 288.72272 293.16241 295.08392 297.06573 331.44482 336.72601 341.16571 343.08722 345.06903 378.18811 382.86902 387.3681 390.60989 392.409 395.5311 400.03201 403.39172 408.13382 411.43591 416.17801 418.03741 421.2774 426.01862 427.79974 431.72104 436.20935 438.15067 440.09198 442.01346 446.80777 451.42749 453.2869 457.90662 461.02872 465.70963 469.60931 474.34061 479.01791 483.76004 486.82184 491.55313 493.35223 497.84055 502.58267 507.25998 509.05908 513.73639 518.47668">IValidValidFar return to calling procedure and pop</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-619.97852" x="523.08008 525.12036 527.18945 534.20856 541.22766 546.48279"> imm16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-619.97852" x="551.76038"> </tspan><tspan y="-608.99854" x="378.18008 382.81958 387.47708 390.82959 395.56992 399.59201 401.8114 405.1279 408.1897 412.93091 419.89151 422.1109 426.01239 429.3721 433.87122 437.77094 442.03244">bytes from stack.</tspan><tspan y="-556.01825" x="57.420074 63.178276 67.797981 70.916489 75.657684 127.98009 133.67799 138.3571 143.03801 146.09981 150.59891 155.34102 160.02013 162.23953 241.79953 247.49744 252.17654 256.85745 259.91925 264.41833 269.16043 273.83951 276.0589 358.01923 363.77744 368.39713 373.13742 376.19922 380.6983 385.4404 390.11948 392.33887 477.1792 482.93741 487.5571 492.29739 495.35919 499.79889 504.60129 509.28036 511.49976">Op/EnOperand 1Operand 2Operand 3Operand 4</tspan><tspan y="-539.99823" x="63.600372 68.518867 142.01736 147.83856 255.83856 261.65976 372.05914 377.88034 491.22003 497.10062">ZONANANANA</tspan><tspan y="-523.97821" x="67.860069 134.52127 136.50307 143.43576 150.36845 155.61815 255.81876 261.65344 372.05286 377.88754 491.22723 497.10782">Iimm16NANANA</tspan></text><path transform="matrix(1,0,0,-1,0,792)" d="m 47.16,603.24 h 0.47998 v 106.5 H 47.16 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 144.72,602.76 h 0.48 v 107.46006 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 255.42,602.76 h 0.48 v 107.46006 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 280.14,602.76 h 0.48004 V 710.22006 H 280.14 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 328.2,602.76 h 0.48 v 107.46006 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 374.94,602.76 h 0.48 v 107.46006 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 556.32,603.24 h 0.48 v 106.5 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 47.16,709.74 H 556.8 v 0.48 H 47.16 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 47.16,684.78 H 556.8 v 0.4801 H 47.16 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 47.16,669.78 H 556.8 v 0.4801 H 47.16 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 47.16,654.78 H 556.8 v 0.4801 H 47.16 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 47.16,628.74 H 556.8 v 0.48 H 47.16 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 47.16,602.76 H 556.8 v 0.48 H 47.16 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 46.5,519.24 h 0.47998 v 47.52 H 46.5 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 90.9,518.76 h 0.480008 v 48.48 H 90.9 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 204.06,518.76 h 0.48 v 48.48 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 318.54,518.76 h 0.48 v 48.48 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 436.44,518.76 h 0.48 v 48.48 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 556.98,519.24 h 0.47999 v 47.52 H 556.98 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 46.5,566.76 h 510.95999 v 0.48 H 46.5 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 46.5,550.74 h 510.95999 v 0.48 H 46.5 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 46.5,534.78 h 510.95999 v 0.48 H 46.5 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 46.5,518.76 h 510.95999 v 0.48 H 46.5 Z" inkscape:connector-curvature="0" /></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="511.57016pt" height="647.86151pt" viewBox="0 0 511.57016 647.86151" sodipodi:docname="1276.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.22481" inkscape:cy="427.9996" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg184" /><g transform="translate(-45.58139,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-715.97998" x="45.119999 51.117599 56.520302 59.682903 65.041504 68.879105 71.222702 74.763306 80.220909 82.624809 88.901413 94.54351 99.947113 105.54871 109.08932 114.44791 118.28551 120.68941 126.40801 129.67862 132.02222 136.14781 141.56941 145.40701 150.86461 155.5482 160.9068 166.50839 172.2 176.0376 181.39619 183.80009 190.07669 195.48029 197.94089 200.40149 205.08508 208.35568 210.71999 214.49458 220.17719 223.70879 229.05838 232.88698 236.71558 242.39818 247.99078 251.52238 256.19699 259.49908 261.90298 267.29758 272.98016 278.57275 280.97665 286.65027 291.87207 296.54666 301.94937 307.54196 311.07355 313.52515 318.97375 324.65634 329.33093 333.44754 335.85144 341.24603 346.92862 352.52121 354.92511 361.19272 366.87531 372.2699 377.9093 381.44089 386.82028 390.65518 393.05908 398.77499 404.49091 407.79303 410.19693 414.31982 420.59372 426.04861 431.73752 435.27542 439.11032 444.56522 446.96191 451.03983 456.20673 458.66461 464.11951 471.47342 473.81702 479.49692 485.18582 488.34573 493.80063 497.63553 502.37582 507.73172 516.48059 521.83649 527.52539 531.06329 533.40692 538.02478 543.36719 548.0481 553.737">Refer to Chapter 6, “Procedure Calls, Interrupts, and Exceptions” and Chapter 18, “Control-Flow Enforcement Tech-</tspan><tspan y="-705" x="45.119965 50.810665 56.267365 58.664066 64.124367 69.725067 75.046768 77.930367 82.010071 88.285774 93.967476 99.505173 103.58487 107.70957 110.53377 112.99347 118.68417 121.50836 125.04807 130.73877 136.14146">nology (CET)” in the </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-705" x="138.96027 142.74117 148.43007 151.96797 157.32387 159.78177 168.77367 171.65726 177.37315 183.08905 185.97264 191.37354 197.06244 202.66135 205.48553 209.26643 215.44943 219.52733 225.24323 230.95912 233.84271 239.98161 243.81651 248.49741 254.18631 256.6442 260.1821 265.53799 270.2189 273.75681 279.44571 283.28061 288.63651 293.31741 296.20102 302.34891 307.8038 310.96371 314.50162 321.85553 327.25644 331.09134 336.49405 339.31827 346.20416 351.56006 356.87097 362.22687 364.68475 370.13965 375.73856 381.09445 384.92935 387.39355 392.07446 394.89868 402.47757 407.87848 413.56738 419.25629 424.6572 427.11508 430.383 433.20721 439.39023 444.79114 447.24902 452.93793 461.68683 467.04272 469.92633">Intel® 64 and IA-32 Architectures Software Developer’s Manual, Volume 1</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-705" x="475.49997 478.38358 481.53268 486.97678 490.80087 493.68448 499.94757 505.64456 511.16968 514.05328 519.64136 524.98645 528.51355 533.90363 536.35071 538.79779 543.4679"> for CET details.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c1AE6E0A5"><tspan y="-688.97998" x="45.119965 47.581467 53.102966 58.081768 61.08147 64.593269 70.103073 75.081871 78.081566 80.594368 86.055573 91.565369 93.786568 99.296371 102.80817 108.31798 113.29678 116.80858 119.32138 124.78258 130.30408">Instruction ordering.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-688.97998" x="132.77997 135.60417 139.39227 145.08838 149.77647 153.32158 157.16368 162.85979 167.54788 171.09299 173.55809 178.95898 184.65509 189.34319 192.22679 195.39389 200.79478 203.25989 205.72499 211.18709 218.54819 221.01329 226.7094 232.31549 235.1991 240.60719 243.4314 246.5985 252.00659 255.84869 258.67291 262.51501 267.87811 271.42322 277.06534 280.90744 286.60355 289.48715 298.19016 303.53348 308.86057 311.68478 317.29089 322.65399 325.47821 328.64532 333.90027 337.50027 342.1803 347.82239 353.2251 358.82761 361.65182 364.81534 368.65384 374.11234 382.86484 385.68906 394.44156 399.80106 408.55356 414.01205 417.85056 423.17404 425.99826 431.60077 436.96027 440.12378 445.58228 449.42078 454.78027 457.60449 462.96399 468.3685 472.207 474.66849 477.12997 482.48947 486.32797 489.15219 491.61368 497.30618 501.99069 505.5322 509.3707 515.06317 519.74768 523.28918 525.75067 531.20917 536.85126 541.53125"> Instructions following a far return may be fetched from memory before earlier instructions </tspan><tspan y="-678" x="45.119965 49.804466 55.262966 64.015465 69.617966 72.079468 77.438965 80.980469 86.339966 89.043564 94.403061 99.624863 104.98436 109.66886 115.36136 118.90286 121.36436 126.82287 132.51537 135.78687 138.49046 144.09296 149.78546 153.32697 156.03056 159.57207 165.26457 170.62407 175.94757 178.59177 185.94926 188.41077 190.80746 193.26357 195.96716 201.65967 207.11816 210.65967 213.30386 218.66336 223.82486 229.18436 233.86885 239.56136 243.10286 248.46236 251.16595 255.24745 260.60696 265.82874 271.23145 276.87354 279.57715 284.26166 289.86417 295.22366 299.90817 305.60068 307.99738 313.40189 316.85968 319.32208 324.54388 329.9043 332.30099 337.6254 341.70779 344.41229 350.10568 355.79907 359.34146 361.73816 364.19427 366.89877 372.30417 374.76657 377.16327 379.86777 382.33017 388.02356 392.70895 396.25134 400.09073 405.73282 410.41821 413.9606 416.423 421.88242 427.57581 432.2612 434.9657 440.56909 444.40848 446.87088 452.33029 456.16968 458.81479 462.35718 467.81659 470.52109 474.06348 479.75687 485.11728 487.82178 490.98618 496.39157 500.23096 502.87607 506.71545 512.07587 515.6759 521.31805 525.15747 530.85089 533.55542 539.24884 544.53271 549.85712 555.21753">complete execution, but they will not execute (even speculatively) until all instructions prior to the far return have </tspan><tspan y="-667.02002" x="45.119965 49.801765 55.257565 64.007362 69.607162 72.065964 77.42276 80.961563 86.318359 91.918159 94.142059 99.498856 104.72066 110.07745 114.75925 120.44905 123.98785 126.44666 131.90245 137.59225 139.81615 143.89494 147.43375 153.12355 158.48035 160.70424 163.16304 168.56483 172.10364 177.46043 181.29623 183.52013 185.97893 191.66873 196.35052 199.88933 203.72513 209.41493 214.09673 217.63553 220.09433 225.49522 231.18503 235.86682 238.15102 246.90082 252.24411 257.56491 259.78882 265.14563 270.36743 275.72424 280.40604 286.09583 289.63461 295.03732 297.26123 302.86102 308.21783 311.37863 316.73996 320.57217 325.92538 328.20959 333.80579 339.20398 342.73917 348.13736 350.36127 355.03946 358.57465 364.02686 367.85907 373.21228 378.80847 381.03238 386.62857 391.94577 394.16968 397.70486 403.39105 408.74426 410.96817 416.32138 421.71957 425.55179 428.00699 430.46219 435.8154 439.64761 441.87152 444.32672 450.01291 454.6911 458.22629 462.0585 467.74469 472.42288 475.95807 478.41327 483.81418 489.50037 494.17856 496.46277 502.10486 507.44815 512.76538 518.11859 520.34253 525.93872 531.34143 536.01965 541.47186 550.21808 555.62079">completed execution (the later instructions may execute before data stored by the earlier instructions have become </tspan><tspan y="-655.97974" x="45.119965 50.709866 53.158768 58.604668 64.194565 69.586464 72.035362 74.484261 79.795158 82.678757 87.989655 90.438553 95.110451 97.559349 103.14925 105.59814 110.94505 115.01395">globally visible).</tspan><tspan y="-640.02002" x="45.119965 51.691765 57.372566 59.822365 62.272163 67.493965 72.841766 75.725372 81.406174 86.753975 92.146774 95.973572 98.797775 101.24757 106.92838 112.51917 114.96897 118.79577 124.14357 128.81638 132.34618 135.22977 141.49556 147.67946 152.67625 157.71985 160.54404 165.93684 171.61765 177.20845 180.09204 185.77284 191.17554 196.56834 200.39514 203.21933 205.66913 211.34993 216.94073 219.39053 223.21733 228.56512 233.23793 236.76773 239.65132 243.73012 251.30092 255.38063 258.68274 261.50693 265.03671 270.7175 276.12021 278.9444 284.53519 288.41968 293.87277 298.55188 303.95459 308.6337 313.31281 318.7659 322.599 325.42322 332.77533 335.17203 337.62811 340.0842 342.90842 348.59552 354.04861 357.58472 360.40894 365.08804 370.72745 376.08154 380.76065 386.44775 388.90384 394.30295 397.83905 400.23575 405.51782 410.87192 413.328 418.64612 421.47034 426.82443 432.0462 437.4003 442.07941 447.76651 451.30261 456.70532 459.52954 463.06564 468.75275 474.10684 476.99045 482.67755 488.08026 493.39838 496.93448 499.81808 504.49719 509.85129 515.49066 521.13275 526.53546 532.17755 535.71362 538.16974 543.56885 546.02496">Unlike near indirect CALL and near indirect JMP, the processor will not speculatively execute the next sequential </tspan><tspan y="-628.97974" x="45.11998 47.581482 53.223583 57.908085 61.449585 65.288086 70.980583 75.665085 79.206589 81.668091 87.126595 92.819092 95.643288 101.04779 104.21129 107.75279 113.11229 116.95079 119.83439 125.23889 128.0631 133.7556 139.1151 144.51959 148.35809 151.2417 157.4922 163.1757 168.71521 171.53941 177.23192 182.92442 185.38593 190.74542 195.42992 200.11441 202.93861 206.53862 212.18073 217.58522 221.12672 224.01033 226.47183 232.11394 236.79843 240.33994 244.17844 249.87094 254.55544 258.09692 260.55841 266.01691 271.70941 274.53363 276.99512 281.67963 284.56323 289.96774 292.36444 297.04895 302.50745 305.39105 308.93256 314.62506 319.98456 322.80878 326.35028 331.75479 335.59329 341.1958 346.5553 350.0968 352.92102 358.37952 361.54303 364.36725 369.77176 372.65536 375.74686 381.43936 390.19186 395.79437 398.67798 404.13647 407.97498 410.79919 413.26068 417.94519 420.76941 426.17392 429.05753 432.59903 438.00354 441.84204 447.44455 452.80405 456.34555 459.16977 461.63126 467.32376 470.14798 475.55249 478.37671 483.97922 487.64133 493.04584 498.73834 503.42285 509.11536 511.93958 517.54205 521.38055 526.74005 532.34253 534.80402 539.48853 543.03003 548.48853 551.07062">instruction after a near RET unless that instruction is also the target of a jump or is a target in a branch predictor.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-603.29999" x="45.119999 51.730453 57.3708 62.945412 66.367668 71.673363 75.694214 78.181229 83.820587">Operation</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-586.97998" x="45.119999 47.7057 51.722401 53.941803 59.785503 64.495201 68.961899 72.222595 74.441994 77.70269 82.412392 85.83239 90.574486 93.835182 98.60788 100.82728 104.84398">(* Near return *)</tspan><tspan y="-574.98029" x="45.119999 47.212498 51.893398 54.112801 56.061302 60.8358 64.845299 68.215797 71.478294 76.252792 80.154289 83.524788 85.473289 90.193787 94.968285 97.187683">IF instruction =</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-574.97998" x="102.3"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-574.97998" x="104.82 109.5747 114.315 118.7637 122.0064 124.2258 127.5279 132.2088 135.55951 140.36191 143.60461 148.40701">near return </tspan><tspan y="-562.98029" x="58.6203 63.829502 69.650703 74.400902 80.222099">THEN;</tspan><tspan y="-550.98059" x="76.680603 78.748802 83.489998 85.709396 91.413597 96.092697 100.833 104.0748 108.519 113.3214 117.9546 122.757 124.7388 128.8797 133.56689 135.726 140.8875 143.1069 148.34311">IF OperandSize = 32</tspan><tspan y="-538.9809" x="94.680603 99.889801 105.711 110.4612">THEN</tspan><tspan y="-526.9812" x="112.6806 114.7731 119.4936 121.713 125.0835 129.804 134.4615 136.68091 141.94141 144.16081 148.81831 153.49382 156.86432 161.57582 165.58533 167.80473 172.52524 175.85974 178.07915 182.08865 185.45915 189.92766 193.82916 198.10866 200.34061 205.11331 209.83202 213.20071 215.42012 222.36182 224.30852 227.67722 232.44992 234.39662 239.16933 241.38873 245.39644 248.76514 253.23184 257.13153 261.40924 263.62863 265.54834 267.49503 274.43674 276.38342 279.75214">IF top 4 bytes of stack not within stack limits</tspan><tspan y="-514.98151" x="130.6806 135.86011 141.70561 146.42612 152.27162 154.49103 160.25552 165.03003 169.77214 172.35153 177.61203 180.19952 182.06702 184.28642 189.00693 191.09943">THEN #SS(0); FI;</tspan><tspan y="-502.98181" x="112.6806 117.39571 119.4828 124.5939 126.753 128.49809 133.65959 135.879 140.9901 145.7052 150.3573 152.93941 155.52151">EIP := Pop();</tspan><tspan y="-490.98212" x="112.6806 114.79021 119.52781 121.74722 126.53882 131.28091 135.76651 140.38622 145.12381 152.02411 156.8157 160.20331 164.6889 168.6075 172.8672 177.6084 182.35049 186.84959 191.4693 193.39079 198.1194 202.73911 205.3437 210.0813 215.2149 219.6915">IF ShadowStackEnabled(CPL)</tspan><tspan y="-478.98242" x="130.6806 134.06551 138.74641 145.70432 150.32402 155.11292 159.13681 163.8177 165.9183 171.04921 173.2686 178.39951 180.6189 185.36099 190.16339 194.60309 199.2822 204.01709 210.91739 215.70628 219.09119 223.53088 227.43057 231.72447 236.85538 241.59027 246.20998 251.48488 256.76608 259.36798 261.96988">tempSsEIP = ShadowStackPop4B();</tspan><tspan y="-466.98273" x="130.6806 132.7218 137.46301 139.6824 144.41011 146.50981 151.63351 153.85291 155.60161 160.72531 162.9447 168.13141 172.85011 179.80081 184.42052 189.20221 193.164 197.89171 199.99141">IF EIP != TempSsEIP</tspan><tspan y="-454.98303" x="148.6806 153.86191 159.70921 164.43152 170.27882 172.49823 178.26453 182.98683 188.10513 190.69443 196.54173 201.22264 206.82693 212.25124 216.80254 222.22684 226.94914 232.13045 234.71974 236.58904 238.80844 243.53075 245.62505">THEN #CP(NEAR_RET); FI;</tspan><tspan y="-442.98334" x="112.6806 117.4155 119.52241">FI;</tspan><tspan y="-430.98364" x="94.680603 99.415504 103.8894 108.67831">ELSE</tspan><tspan y="-418.98395" x="112.6806 114.7506 119.4918 121.7112 127.4172 132.0963 136.83659 140.0784 144.5244 149.3268 154.00589 158.74799 160.72978 164.87068 169.55968 171.77908 176.94058 179.15999 184.39799">IF OperandSize = 64</tspan><tspan y="-406.98425" x="130.6806 135.85921 141.70381 146.42342">THEN</tspan><tspan y="-394.98456" x="148.6806 150.7722 155.49181 157.71211 161.08171 165.80132 170.45792 172.67822 177.93782 180.15813 184.81473 189.48933 192.85893 197.56953 201.57814 203.79845 208.51805 211.85165 214.07196 218.08057 221.45016 225.91777 229.81837 234.09697 236.31728 241.09088 245.81049 249.18008 251.40039 258.34299 260.29059 263.66019 268.43378 270.38138 275.15497 277.37524 281.38385 284.75345 289.22104 293.12164 297.40024 299.62051 301.54111 303.48871 310.4313 312.37891 315.7485">IF top 8 bytes of stack not within stack limits</tspan><tspan y="-382.98486" x="166.6806 171.86011 177.70561 182.42612 188.27162 190.49103 196.25552 201.03003 205.77214 208.35153 213.61203 216.19952 218.06702 220.28642 225.00693 227.09943">THEN #SS(0); FI;</tspan><tspan y="-370.98517" x="148.6806 154.0968 156.183 161.2932 163.5126 165.25681 170.367 172.58641 177.74791 182.42882 187.08002 189.66122 192.24243">RIP := Pop();</tspan><tspan y="-358.98547" x="148.6806 150.7218 155.463 157.68239 162.47488 167.21698 171.70348 176.32318 181.06168 187.96198 192.75447 196.14297 200.62947 204.54897 208.80867 213.54987 218.29196 222.79106 227.41077 229.33226 234.06177 238.68147 241.28697 246.02547 251.15997 255.63747">IF ShadowStackEnabled(CPL)</tspan><tspan y="-346.98578" x="166.6806 170.06551 174.74641 181.70432 186.32402 191.11292 195.13681 199.8177 201.9183 207.04921 209.2686 214.39951 216.6189 221.36099 226.16339 230.60309 235.2822 240.01709 246.91739 251.70628 255.09119 259.53088 263.43057 267.72449 272.85538 277.59027 282.20999 287.48489 292.76608 295.36798 297.96988">tempSsEIP = ShadowStackPop8B();</tspan><tspan y="-334.98608" x="166.6806 168.74161 173.4828 175.70219 181.0932 183.1938 188.35532 190.57471 192.31621 197.41742 199.63681 202.97581 207.65582 214.61642 219.29553 224.03853 228.06062 232.80182 234.90242">IF RIP != tempSsEIP</tspan><tspan y="-322.98639" x="184.6806 189.86191 195.70921 200.43152 206.27882 208.49823 214.26453 218.98683 224.10513 226.69443 232.54173 237.22264 242.82693 248.25124 252.80254 258.22684 262.94913 268.13043 270.71973 272.58902 274.80844 279.53073 281.62503">THEN #CP(NEAR_RET); FI;</tspan><tspan y="-310.98669" x="148.6806 153.36151 155.46211">FI;</tspan><tspan y="-298.987" x="130.6806 135.3777 139.8138 144.6162 149.35739 151.5768 154.1409 158.136 160.35541 166.0605 170.73959 175.42769 178.7298 183.1749 187.97729 192.61139 197.41379 199.33888 203.54008">ELSE (* OperandSize</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-298.98001" x="208.2"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-298.98001" x="210.66">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-298.98001" x="215.82001"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-298.98001" x="218.28 223.52609 228.80638 231.02579 235.02989">16 *)</tspan><tspan y="-286.98032" x="148.6803 150.771 155.4897 157.70911 161.0778 165.79651 170.45221 172.67162 177.93031 180.14972 184.80542 189.47913 192.84782 197.55753 201.56523 203.78464 208.50334 211.83604 214.05545 218.06316 221.43185 225.89856 229.79826 234.07596 236.29536 241.06807 245.78677 249.15547 251.37488 258.31659 260.26328 263.63199 268.40469 270.35138 275.12408 277.34348 281.35117 284.71988 289.18658 293.08627 297.36398 299.58337 301.50308 303.44977 310.39148 312.33817 315.70688">IF top 2 bytes of stack not within stack limits</tspan><tspan y="-274.98062" x="166.6803 171.8598 177.70531 182.42581 188.27132 190.49072 196.25522 201.02972 205.77184 208.35123 213.61172 216.19922 218.06671 220.28612 225.00662 227.09912">THEN #SS(0); FI;</tspan><tspan y="-262.98093" x="148.6803 152.04269 156.74609 163.68149 168.33089 173.04329 175.12769 180.23608 182.45549 184.19789 189.35939 191.5788 196.68719 201.3996 206.049 208.6284 211.20781">tempEIP := Pop();</tspan><tspan y="-250.98123" x="148.6803 152.0589 156.73981 163.69141 168.31111 173.03972 175.14032 180.26492 182.48431 184.24292 189.36752 191.58691 194.96552 199.64642 206.59802 211.26363 215.94453 218.04514 223.16974 225.38913 230.99973 236.85333 242.39194 244.61133 249.87993 255.09993 260.36853 265.63715 270.31805 275.04666 279.77527 284.45618 290.30978">tempEIP := tempEIP AND 0000FFFFH;</tspan><tspan y="-238.98154" x="148.6803 150.7674 155.4825 157.7019 161.067 165.7731 172.7112 177.3633 182.0784 184.1655 189.2766 191.496 196.26511 200.98021 204.34531 206.56471 213.50281 215.44591 218.811 223.58011 225.52321 230.34 232.5594 236.45551 241.17061 245.82271 250.52881 252.74821 256.75232 261.45844 266.11053 273.04865 277.75476 282.52386 285.94388 288.16327 290.07938 292.02246 298.96057 300.90369 304.2688">IF tempEIP not within code segment limits</tspan><tspan y="-226.98184" x="166.6803 171.8571 177.69991 182.41771 188.26051 190.47992 196.24171 201.50851 206.62231 209.20711 214.4649 217.0497 218.91451 221.13391 225.85172 227.94151">THEN #GP(0); FI;</tspan><tspan y="-214.98215" x="148.6803 153.3774 155.478 160.57109 162.7905 164.5923 169.6935 171.9129 175.26001 179.9481 186.90871 191.5878 196.2849 198.3855 203.47859">EIP := tempEIP;</tspan><tspan y="-202.98245" x="148.6803 150.7215 155.46269 157.68208 162.47458 167.21667 171.70317 176.32288 181.06137 187.96167 192.75417 196.14267 200.62917 204.54866 208.80836 213.54956 218.29166 222.79076 227.41046 229.33195 234.06146 238.68117 241.28667 246.02516 251.15967 255.63716">IF ShadowStackEnabled(CPL)</tspan><tspan y="-190.98276" x="166.6803 170.0634 174.74431 181.70041 186.32011 191.10721 195.1293 199.8102 201.79201 206.46211 208.6815 213.81061 216.03 220.77209 225.57449 230.01419 234.6933 239.42639 246.32669 251.11378 254.49689 258.93658 262.83627 267.12839 272.25748 276.99057 281.61026 286.88336 292.16455 294.76465 297.36475">tempSsEip = ShadowStackPop4B();</tspan><tspan y="-178.98306" x="166.6803 168.7215 173.46271 175.6821 180.40891 182.50771 187.63051 189.84991 191.59772 196.72052 198.93991 202.31671 207.03452 213.93481 218.61392 223.39471 227.35651 232.08331 234.18211">IF EIP != tempSsEIP</tspan><tspan y="-166.98337" x="184.6803 189.8616 195.70891 200.43121 206.27852 208.49792 214.26422 218.98653 224.10483 226.69412 232.54143 237.22234 242.82663 248.25093 252.80223 258.22653 262.94882 268.13013 270.71942 272.58871 274.80814 279.53043 281.62473">THEN #CP(NEAR_RET); FI;</tspan><tspan y="-154.98367" x="148.6803 153.36121 155.46181">FI;</tspan><tspan y="-142.98398" x="112.6803 117.4152 119.5221">FI;</tspan><tspan y="-130.98428" x="76.680298 81.415199 83.522102">FI;</tspan><tspan y="-111.00429" x="58.619995 60.731396 65.470795 67.690193 69.657593 74.399696 78.428093 81.81749 85.059296 89.861702 93.782104 97.171501 99.138901 103.8198 108.6132 110.8326 115.57471 120.07381 124.1022 126.3216 128.2431 135.2037 142.104 146.84431 151.52072 153.44223 157.88193 161.30193 165.98283 168.20222 172.94162 177.56133 182.29173 185.53354 190.02094 194.76303">IF instruction has immediate operand</tspan><tspan y="-99.004585" x="76.680298 81.870598 87.726898 92.458199 98.314499 100.5339 103.13219 107.16149 109.38089 114.81419 119.49509 121.42739 126.14969 130.58939 134.61148 139.29239 141.51178 146.18008 150.61978 153.89308 158.33278 165.28708 169.96799 173.34929 178.0302 181.3035 185.32379 187.54318 190.88849 194.16179 198.8931 205.7934 208.01279 212.03308 215.41438 219.89368 223.80597 228.09627 230.31566 234.34496">THEN (* Release parameters from stack *)</tspan><tspan y="-87.004883" x="94.680298 96.775497 101.4987 103.71809 108.49529 111.86849 116.33969 120.24389 124.52609 130.13129 134.75099 139.4301 142.6953 147.4095 151.42171 155.43391 160.21112 162.16232 166.32753">IF StackAddressSize</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-87" x="170.94"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-87" x="173.45988">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-87" x="178.92"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-87" x="181.1403 186.42061">32</tspan><tspan y="-75.000298" x="112.68001 117.88921 123.7104 128.4606 134.2818">THEN </tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="339.40338pt" height="644.51642pt" viewBox="0 0 339.40338 644.51642" sodipodi:docname="1277.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="345.83685" inkscape:cy="423.83244" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg206" /><g transform="translate(-46.62236,-69.35791)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="131.52 136.2522 141.03839 146.1666 148.38599 150.14819 155.2764 157.49579 162.228 166.97009 172.0983">ESP := ESP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-715.97998" x="174.29971">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="179.22002 181.43941 186.2328 191.63281 196.31371"> SRC;</tspan><tspan y="-703.98029" x="113.52001 118.25491 122.72881 127.51772">ELSE</tspan><tspan y="-691.98059" x="131.52002 133.62692 138.36182 140.58121 145.3701 148.755 153.1947 157.09439 161.3541 166.9935 171.6132 176.29231 179.53412 184.27443 188.29832 192.26012 197.04901 199.01192 203.15282 207.83372">IF StackAddressSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-691.97998" x="210.06">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-691.97998" x="215.58"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-691.97998" x="217.80031 223.08061">64</tspan><tspan y="-679.98029" x="149.52002 154.72922 160.55042 165.30061 171.12181">THEN </tspan><tspan y="-667.98059" x="167.58032 173.03612 177.77821 182.92801 185.08711 186.82861 191.92981 194.14922 199.54921 204.35161 209.4528">RSP := RSP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-667.98059" x="211.68033">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-667.98059" x="216.60063 218.82002 223.61432 229.01433 233.75462"> SRC;</tspan><tspan y="-655.9809" x="149.52094 154.24954 158.71715 163.49976 168.22836 170.44775 173.04335 177.06995 179.28934 184.03143 187.39113 191.86772 195.77733 200.06493 205.67552 210.34113 215.00673 218.27733 222.99693 226.95872 230.97632 235.75891 237.68042 241.88161 246.56252">ELSE (* StackAddressSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-655.97998" x="248.75999">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-655.97998" x="254.28"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-655.97998" x="256.50031 261.77069 266.99066 269.21005 273.23846">16 *)</tspan><tspan y="-643.98029" x="167.58031 172.3647 177.4911 179.65019 181.4106 186.537 188.75639 193.49849 198.59969">SP := SP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-643.98029" x="200.88031">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-643.98029" x="205.80061 208.02 212.7657 218.22511 222.91681"> SRC;</tspan><tspan y="-631.98059" x="131.52092 136.25581 138.36272">FI;</tspan><tspan y="-619.9809" x="95.52092 100.25582 102.36272">FI;</tspan><tspan y="-607.9812" x="59.52092 64.255821 66.362724">FI;</tspan><tspan y="-595.98151" x="46.02092 50.70182 52.802418">FI;</tspan><tspan y="-571.9812" x="46.02092 48.600319 52.610718 54.830116 60.244518 64.984825 69.445229 71.358627 74.18103 78.68013 83.329529 87.978928 91.23333 95.973633 99.975037 103.97644 106.19585 113.13125 117.84365 122.49305 127.23335 129.45276 134.16516 137.41956 139.63896 144.27036 146.25215 149.50655 152.86894 157.67134 162.11104 164.02444 166.90535 172.15775 177.41014 182.66254 187.91493 190.13434 197.06973 201.78214 206.43153 211.13493 213.35434 217.36475">(* Real-address mode or virtual-8086 mode *)</tspan><tspan y="-559.98151" x="46.02092 48.103519 52.814117 55.033516 57.611115 60.249912 65.356514 70.067116 72.346825 77.453423 79.672829 84.923431 87.50103 89.720436 94.431038 97.733139 99.952545 102.53014 107.63674 112.34734 114.56675 119.67335 121.89275 127.14336 129.36276 135.00217 140.76123 146.29353 148.51294 154.18924 160.76553 162.98494 168.14644 170.36584 175.62814 178.21744 180.80673 183.02614 187.49644 192.27275 196.93205 199.15146 201.10176 205.87807 209.88937 213.26167 216.52597 221.30228 225.20558 228.57788 230.52818 235.25049 240.02679 242.1859">IF ((PE = 0) or (PE = 1 AND VM = 1)) and instruction =</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-559.97998" x="247.25999"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-559.97998" x="249.72 253.0932 257.5329 260.83411 263.0535 266.29532 270.97623 274.38544 279.12753 282.42874">far return</tspan><tspan y="-547.98029" x="59.520294 64.729492 70.55069 75.300888">THEN</tspan><tspan y="-535.98059" x="77.520294 79.587593 84.328789 86.548187 92.251488 96.930588 101.61689 104.91898 109.36228 114.16468 118.79698 123.59938 125.52268 129.72389 134.41019 136.62958 141.79108 144.01047 149.24577">IF OperandSize = 32</tspan><tspan y="-523.9809" x="95.520294 100.72949 106.55069 111.30089">THEN</tspan><tspan y="-511.9812" x="113.52029 115.61189 120.3315 122.5509 125.92049 130.64009 135.29669 137.5161 142.7757 144.9951 149.6517 154.32631 157.69591 162.40651 166.41512 168.63452 173.35413 176.68773 178.90714 182.91574 186.28534 190.75294 194.65355 198.93214 201.15155 205.92516 210.64476 214.01436 216.23376 223.17636 225.12396 228.54396 233.28607 235.23367 240.00728 242.22668 246.23529 249.60489 254.07249 257.97308 262.25168 264.47107 266.39166 268.33926 275.28186 277.22946 280.59906">IF top 8 bytes of stack not within stack limits</tspan><tspan y="-499.98151" x="131.52029 136.7043 142.55431 147.27931 153.12932 155.34872 161.11772 165.89673 170.63884 173.21823 178.48323 181.07523 182.94722 185.16663 189.89163 191.98863">THEN #SS(0); FI;</tspan><tspan y="-487.98181" x="113.52029 118.2354 120.32249 125.43359 127.65299 129.39809 134.55959 136.77899 141.89009 146.60519 151.25729 153.8394 156.42151 158.34122">EIP := Pop(); </tspan><tspan y="-475.98212" x="113.52029 118.25069 123.0351 125.25449 127.01489 132.1413 134.36069 139.48709 144.2175 148.8849 151.4823 154.0797 155.95709 158.17648 160.77388 164.80228 167.02167 172.29207 177.51207 180.35246 184.97217 186.93057 190.31097 192.53036 197.15007 201.89127 206.55867 208.39107 210.61046 215.39485 217.31636 221.98376 226.72586 229.56625 234.29666 237.56906 242.23647 246.95787 250.23027 252.44966 257.72006 262.94003 265.15942 269.82681 271.74832 275.12872 279.14813 281.36752 286.03491 287.95642 291.97583 295.88724 300.36563 303.63803 308.30542 312.98633 317.65372 319.87311 323.90152">CS := Pop(); (* 32-bit pop, high-order 16 bits discarded *)</tspan><tspan y="-463.98242" x="95.520294 100.26149 104.70029 109.50269 114.24389 116.46329 119.02469 123.01709 125.23649 130.93889 135.61798 140.30338 143.60548 148.04788 152.85028 157.48167 162.28407 164.20647 168.40767 173.09306 175.31245 180.40285 182.62224 187.90254 193.18285 195.40224 199.39464">ELSE (* OperandSize = 16 *)</tspan><tspan y="-451.98273" x="113.52029 115.61189 120.3315 122.5509 125.92049 130.64009 135.29669 137.5161 142.7757 144.9951 149.6517 154.32631 157.69591 162.40651 166.41512 168.63452 173.35413 176.68773 178.90714 182.91574 186.28534 190.75294 194.65355 198.93214 201.15155 205.92516 210.64476 214.01436 216.23376 223.17636 225.12396 228.54396 233.28607 235.23367 240.00728 242.22668 246.23529 249.60489 254.07249 257.97308 262.25168 264.47107 266.39166 268.33926 275.28186 277.22946 280.59906">IF top 4 bytes of stack not within stack limits</tspan><tspan y="-439.98303" x="131.52029 136.7043 142.55431 147.27931 153.12932 155.34872 161.11772 165.89673 170.63884 173.21823 178.48323 181.07523 182.94722 185.16663 189.89163 191.98863">THEN #SS(0); FI;</tspan><tspan y="-427.98334" x="113.52029 116.94029 121.62119 128.5584 133.20959 137.9238 140.00999 145.12019 147.3396 149.0838 154.2453 156.46471 161.57491 166.28911 170.94031 173.52151 176.10272 177.96393">tempEIP := Pop(); </tspan><tspan y="-415.98364" x="113.52029 116.9025 121.5834 128.5386 133.15831 137.8905 139.99471 145.12291 147.3423 149.10451 154.23271 156.4521 159.8343 164.51521 171.47041 176.09012 180.82233 182.92653 188.05473 190.27412 195.88832 201.74551 207.28772 209.50711 214.77931 219.99931 225.27151 230.54372 235.22461 239.95682 244.68903 249.36993 255.22714">tempEIP := tempEIP AND 0000FFFFH;</tspan><tspan y="-403.98395" x="113.52029 115.60829 120.3243 122.54369 125.90969 130.6167 137.55569 142.20869 146.9247 149.0127 154.17419 156.3936 161.1636 165.87961 169.24561 171.46501 178.40401 180.34801 183.714 188.48401 190.42801 195.2403 197.4597 201.35851 206.07631 210.73111 215.43991 217.65932 221.66612 226.37492 231.02972 237.97052 242.67932 247.45113 250.81892 253.03833 254.95712 256.90292 263.84372 265.78952 269.15732">IF tempEIP not within code segment limits</tspan><tspan y="-391.98425" x="131.52029 136.7007 142.5471 147.26851 153.11491 155.33432 161.09972 166.37012 171.48752 174.07591 179.33731 181.9257 183.7941 186.0135 190.73491 192.82831">THEN #GP(0); FI;</tspan><tspan y="-379.98456" x="113.52029 118.2354 120.32249 125.43359 127.65299 129.39809 134.55959 136.77899 140.14409 144.85019 151.78828 156.44038 161.15549 163.24258 168.35368">EIP := tempEIP;</tspan><tspan y="-367.98486" x="113.52029 118.24349 123.02069 125.24009 126.99329 132.11249 134.33189 139.4511 144.1743 148.8345 151.4247 154.01489 155.88509 158.10449 160.69469 164.71588 166.93529 172.19849 177.46169 180.34259 184.9623 186.9135 190.2867 192.5061 197.16631 201.88951 206.54971 208.76912 212.79031">CS := Pop(); (* 16-bit pop *)</tspan><tspan y="-355.98517" x="77.520294 82.255196 84.362099">FI;</tspan><tspan y="-343.98547" x="59.520294 61.619095 66.345894 68.565292 70.520096 75.300896 79.316696 82.693497 85.962296 90.743095 94.650894 98.027695 99.982498 104.6634 109.4442 111.6636 116.4444 120.9192 124.935 127.1544 129.10919 136.05899 142.95929 147.6996 152.31931 154.3011 158.77591 162.15271 166.87051 169.0899 173.81671 178.43642 183.15422 186.42302 190.89783 195.67862 200.34242">IF instruction has immediate operand </tspan><tspan y="-331.98578" x="77.520294 82.706993 88.559692 93.287392 99.140091 101.36039 103.95509 107.9808 110.2011 115.6308 120.3495 122.27821 126.9969 131.4366 135.45869 140.1396 142.35989 147.0246 151.46429 154.73399 159.17369 166.12439 170.8053 174.183 178.9017 182.1714 186.1881 188.40839 191.75009 195.01979 199.7475 206.6478 208.86809 212.88478 216.26248 220.73817 224.64688 228.93358 231.15387 235.17957">THEN (* Release parameters from stack *)</tspan><tspan y="-319.98608" x="95.520294 100.30199 105.4257 107.6442 109.40189 114.5256 116.74409 121.4853 126.5856">SP := SP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-319.98608" x="128.8203">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-319.98608" x="133.8 136.01941 138.6123 143.35442 148.78232 153.46323 155.68263 161.29053 167.14143 172.67734 174.89674 179.62265 184.30356 189.02946 193.75537 199.60628 202.19917"> (SRC AND FFFFH);</tspan><tspan y="-307.98639" x="59.520309 64.255211 66.362114">FI;</tspan><tspan y="-295.98669" x="46.020309 50.70121 52.801807">FI;</tspan><tspan y="-271.98639" x="46.020309 48.61771 52.646111 54.865513 59.991913 63.264313 67.994713 71.375114 76.096512 80.007912 83.388313 88.069214 92.73661 94.956009 101.90941 106.59031 111.25771 115.93861 117.771 119.9904 124.73251 129.47371 132.85411 135.0735 139.7229 141.64441 144.91681 148.29721 153.03931 157.53841 159.4698 162.3102 167.5302 172.8006 178.071 183.291 185.51039 192.46379 197.19418 201.81389 206.5542 208.77359 212.80199">(* Protected mode, not virtual-8086 mode *)</tspan><tspan y="-259.98669" x="46.020309 48.121811 52.802711 55.022114 57.618614 62.744114 67.425018 69.644417 74.76992 76.989319 82.20932 84.428719 88.906219 93.68972 98.356216 100.57561 106.25912">IF (PE = 1 and VM</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-259.98001" x="112.86"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-259.98001" x="115.32 120.4275 122.6469 127.89841 130.11781 134.57732 139.34282 143.99132 146.21072 148.29422 153.93362 159.18512 164.43661 168.97711 173.68861 178.40012 183.11162 188.52512 190.22162 194.72072 201.28622 206.92563 209.14503 214.25253 216.47194 221.72343 224.36224 226.58165 231.04115 235.80666 240.45515 242.67456 244.65636 249.39845 253.39896 256.76047 260.06259 264.80469 268.69717 272.05869 274.0405 278.72137 283.48688 285.70627">= 0 and IA32_EFER.LMA = 0) and instruction =</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-259.98001" x="290.82001"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-259.98001" x="293.28 296.64871 301.08841 304.3851 306.60449 309.84628 314.58658 317.94626 322.68835 325.98505">far return</tspan><tspan y="-247.98032" x="59.520294 64.729492 70.55069 75.300888">THEN</tspan><tspan y="-235.98062" x="77.520294 79.587593 84.328789 86.548187 92.251488 96.930588 101.61689 104.91898 109.36228 114.16468 118.79698 123.59938 125.52268 129.72389 134.41019 136.62958 141.79108 144.01047 149.24577">IF OperandSize = 32</tspan><tspan y="-223.98093" x="95.520294 100.72949 106.55069 111.30089 117.12209">THEN </tspan><tspan y="-211.98123" x="113.52029 115.6254 120.3585 122.5779 126.6 131.3241 135.23819 139.97128 144.75838 149.42848 151.64787 156.31798 160.99887 165.78596 170.40567 172.38657 177.06747 184.02357 188.70447 191.97957 196.56059 198.78 203.4978 208.26961 210.48901 214.49582 217.86362 222.32942 226.22823 230.50502 232.72443 234.67023 238.67703 240.89644 245.66824 250.38605 253.75385 255.97325 262.91406 264.85986 268.22766 272.99945 274.94525 279.71704 281.93643 285.94324 289.31104 293.77682 297.67563 301.99472 304.21411 306.1329 308.0787 315.0195 316.9653 320.3331">IF second doubleword on stack is not within stack limits</tspan><tspan y="-199.98154" x="131.52029 136.7043 142.55431 147.27931 153.12932 155.34872 161.11772 165.89673 170.63884 173.21823 178.48323 181.07523 182.94722 185.16663 189.89163 191.98863">THEN #SS(0); FI;</tspan><tspan y="-187.98184" x="95.520294 100.26149 104.70029 109.50269 114.24389 116.46329 119.02469 123.01709 125.23649 130.93889 135.61798 140.30338 143.60548 148.04788 152.85028 157.48167 162.28407 164.20647 168.40767 173.09306 175.31245 180.40285 182.62224 187.90254 193.18285 195.40224 199.39464">ELSE (* OperandSize = 16 *)</tspan><tspan y="-175.98215" x="113.52029 115.61459 120.33689 122.55629 126.56759 131.28088 135.18419 139.90649 144.6828 149.3421 151.56151 158.50681 163.22911 166.49341 171.15271 173.37212 178.09442 182.87073 185.09013 189.05194 192.41164 196.88194 200.78525 205.06654 207.30029 209.24609 213.2529 215.47231 220.24411 224.96191 228.32971 230.54912 237.48991 239.43571 242.80351 247.57532 249.52112 254.29292 256.51233 260.51913 263.88693 268.35272 272.25153 276.57062 278.79001 280.7088 282.6546 289.5954 291.5412 294.909">IF second word on stack is not within stack limits</tspan><tspan y="-163.98245" x="131.52029 136.7043 142.55431 147.27931 153.12932 155.34872 161.11772 165.89673 170.63884 173.21823 178.48323 181.07523 182.94722 185.16663 189.89163 191.98863">THEN #SS(0); FI;</tspan><tspan y="-151.98276" x="77.520294 82.255196 84.362099">FI;</tspan><tspan y="-139.98306" x="59.520294 61.610096 66.327896 68.547295 71.807098 76.547401 79.915199 84.717598 87.977402 92.749199 94.968597 98.867401 103.58521 108.24001 112.94881 115.16821 119.175 123.8838 128.5386 135.48029 140.18279 144.98518 148.34668 150.56609 154.56659 159.26909 161.18159 165.92189 169.81439 173.17589 177.91708 181.15887 183.37828 185.31778 189.31828 191.53769 197.41829 203.05949 207.55859">IF return code segment selector is NULL</tspan><tspan y="-127.98336" x="77.520287 82.700684 88.547081 93.268478 99.114876 101.33427 107.09968 112.37008 117.48748 120.07588 125.33728 127.92568 129.79408 132.01349 136.73489 138.82829">THEN #GP(0); FI;</tspan><tspan y="-115.98366" x="59.520287 61.619087 66.345886 68.565285 71.834084 76.55188 79.92868 84.70948 87.978279 92.720383 94.939781 98.84758 103.57438 108.23818 112.91908 115.13847 119.15427 123.83517 128.49896 135.44876 140.12967 144.93207 148.30887 150.52826 154.54405 159.22496 161.15276 165.87056 169.77837 173.15517 177.88197 181.15077 183.37018 187.80988 192.47368 197.13748 200.40628 205.08719 209.10298 213.11877 217.83658 221.79837 224.04028 228.71039 233.43449 237.39629 241.29597 244.57108 246.49258 251.16269 254.54579 259.2789 262.55399 264.77341 269.44351 274.12439 278.8125 283.54559 288.28769 292.9668 295.18622 299.80591 304.5462 308.5683 312.48239 315.75748 317.71857 322.33826 325.69794 330.43103 333.70612 335.92554 339.30862 343.74832 348.41843 350.35254 355.03342 357.25284 359.18695 361.14804 368.04834 370.03012 373.41321">IF return code segment selector addresses descriptor beyond descriptor table limit </tspan><tspan y="-103.98396" x="77.520279 82.703377 88.552475 93.276573 99.125671 101.34507 107.11317 112.38627 117.50637 120.09747 124.11057 128.82567 130.75076 135.43167 139.33678 142.71088 147.43498 150.70108 153.29218 155.16327 157.38268 162.06358 164.16418">THEN #GP(selector); FI;</tspan><tspan y="-91.984253" x="59.520279 65.278481 69.898178 73.318184 77.757889 79.739685 84.481789 86.701187 91.345184 96.043182 100.03918 103.92719 107.17619 109.15798 113.80198 117.22198 121.92899 125.23109 127.45049 130.80748 135.51448 137.73389 144.66388 149.46628 151.40128 155.28928 160.09167 162.31108 165.56007 170.28058 173.64388 178.41118 181.71327 186.45537 188.67477 192.56908 197.28238 201.93268 206.63698 208.85638 212.85869 217.56299 222.21329 229.14958 233.85388 238.62119 241.98448 244.20389 248.20619 252.91049 254.8248 259.52911 263.4234 266.78671 271.5 274.80212 277.02151 281.67181 286.44089 288.40198 293.14407 296.52716 300.54926 302.76868 306.11578 309.39087 314.12396 321.02426 323.24368 327.91379 332.59467 336.61676 340.53085 343.80594 345.72742 350.39752 353.78061 358.46152 361.76361 363.98303 367.36612 371.80582 376.47592 378.41003 383.13412">Obtain descriptor to which return code segment selector points from descriptor table;</tspan><tspan y="-79.98455" x="59.521179 61.622681 66.35218 68.571579 71.843079 76.563576 79.943077 84.726578 87.998077 92.740181 94.959579 98.870079 103.59958 108.26608 112.94698 115.16638 119.18488 123.86578 128.53229 135.48479 140.1657 144.96809 148.3476 150.56699 155.23349 159.9144 163.93289 167.8434 171.1149 173.0724 177.69211 181.0518 185.78131 189.05281 191.2722 193.19371 197.21581 199.4352 204.17729 208.9185 212.298 214.5174 218.99489 221.21428 225.12479 229.80569 234.4722 239.15311 241.3725 245.39099 250.1115 254.7312 261.6918 266.37268 271.17508">IF return code segment descriptor is not a code segment</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="298.30264pt" height="643.67102pt" viewBox="0 0 298.30264 643.67102" sodipodi:docname="1278.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.66855" inkscape:cy="422.47083" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg228" /><g transform="translate(-45.998589,-69.182129)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="76.68 81.863098 87.712196 92.436295 98.285393 100.50479 106.27289 111.54599 116.66609 119.25719 123.27029 127.9854 129.91049 134.5914 138.49651 141.87061 146.59471 149.86081 152.4519 154.323 156.5424 161.22331 163.32391">THEN #GP(selector); FI;</tspan><tspan y="-703.98029" x="58.619698 60.703197 65.414696 67.634102 70.887604 75.627907 78.98941 83.791817 87.045319 91.847725 94.067131 97.959633 102.67113 107.31963 112.02213 114.24154 118.24204 122.98235 127.63084 134.56534 139.26784 144.07024 147.43173 149.65114 153.65164 158.35414 160.26665 165.00694 168.89944 172.26094 176.97244 180.22594 182.44534 187.85884 193.02034 197.47084">IF return code segment selector RPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-703.98029" x="199.67938">&lt;</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-703.98029" x="204.59969 206.81909 211.5414 216.6597"> CPL</tspan><tspan y="-691.98059" x="76.679985 81.863083 87.712181 92.436279 98.285378 100.50478 106.27287 111.54597 116.66608 119.25718 123.27028 127.98538 129.91048 134.59138 138.49649 141.87059 146.5947 149.86079 152.45189 154.32298 156.54239 161.2233 163.3239">THEN #GP(selector); FI;</tspan><tspan y="-679.9809" x="58.619682 60.698681 65.405685 67.625084 70.874084 75.61438 78.971382 83.773781 87.022781 91.82518 94.044579 97.932579 102.63958 107.28358 111.98158 114.20097 118.19698 122.93727 127.58127 134.51126 139.20926 144.01166 147.36865 149.58806 154.23206 158.93005 162.92606 166.81406 170.06305 172.04485 176.68884 180.10884 184.81584 188.11794 190.33734 192.27234 196.26834 198.48775 202.37575 207.08275 211.84375 215.16475 219.87175 223.17384 230.10385 232.08565 236.84665">IF return code segment descriptor is conforming</tspan><tspan y="-667.9812" x="58.619682 63.118782 67.860886 72.509384 74.72879 77.982292 82.722595 86.084099 90.886505 94.140007 98.942413 101.16182 105.05432 109.76582 114.41432 119.11682 121.33623 125.33673 130.07703 134.72552 141.66002 146.36252 151.16492 154.52641 156.74582 162.26732 167.37482 171.87392">and return code segment DPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-667.9812" x="174.05998">&gt;</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-667.9812" x="178.98029 181.19969 184.45499 189.19528 192.55858 197.36098 200.61627 205.38358 207.60298 211.49728 216.21059 220.86089 225.56519 227.78459 231.7869 236.4912 241.14149 248.07779 252.78209 257.58447 260.94778 263.16718 267.16946 271.87378 273.78809 278.52841 282.4227 285.78601 290.4993 293.75461 295.974 301.38931 306.55081"> return code segment selector RPL</tspan><tspan y="-655.98151" x="76.679985 81.863083 87.712181 92.436279 98.285378 100.50478 106.27287 111.54597 116.66608 119.25718 123.27028 127.98538 129.91048 134.59138 138.49649 141.87059 146.5947 149.86079 152.45189 154.32298 156.54239 161.2233 163.3239">THEN #GP(selector); FI;</tspan><tspan y="-643.98181" x="58.619682 60.700481 65.409279 67.628685 70.879486 75.619781 78.978584 83.780983 87.031784 91.834183 94.053589 97.94339 102.65219 107.29799 111.99779 114.21719 118.215 122.95529 127.60109 134.53288 139.23268 144.03508 147.39388 149.61328 154.25908 158.95888 162.95668 166.84648 170.09727 172.07907 176.72487 180.14487 184.85367 188.15576 190.3797 192.30121 196.3233 198.54269 203.28479 208.02599 212.81848 215.66698 219.58647 224.26736 229.05986 232.41235 237.09325 240.39536 247.29565 249.27747 254.01956 258.69867 260.91809 265.35779 270.16019 274.77991 276.99933 280.27982 284.96069 288.34918 293.09128 296.33307 301.13547 303.35489 307.27438 312.01288 316.6326 321.37289">IF return code segment descriptor is non-conforming and return code </tspan><tspan y="-633.00183" x="58.61969 62.630089 67.342491 71.962196 78.922791 83.635193 88.410591 91.78199 94.001389 99.532791 104.65019 109.1106">segment DPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-633" x="111.36">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-633" x="117.36"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-633" x="119.88 123.1254 127.81979 131.23979 135.98189 139.22729 144.02969 146.2491 150.1335 154.8369 159.47729 164.21759 166.437 170.4294 175.12379 179.76419 186.6906 191.43089 196.17299 199.59299 201.81239 205.80479 210.54509 212.44949 217.14389 221.02829 224.44829 229.15169 232.4538 234.6732 240.0786 245.17799">return code segment selector RPL</tspan><tspan y="-621.00031" x="76.679993 81.863091 87.712189 92.436287 98.285385 100.50478 106.27288 111.54598 116.66608 119.25719 123.27029 127.98539 129.91049 134.5914 138.49651 141.87061 146.59471 149.86081 152.4519 154.323 156.5424 161.22331 163.32391">THEN #GP(selector); FI;</tspan><tspan y="-609.00061" x="58.61969 60.701389 65.411087 67.630493 70.882195 75.62249 78.982193 83.784592 87.036293 91.838692 94.058098 97.948799 102.6585 107.3052 112.0059 114.2253 118.22401 122.9643 127.611 134.5437 139.2444 144.0468 147.40649 149.6259 154.2726 158.9733 162.972 166.8627 170.1144 172.09619 176.74289 180.16289 184.87259 188.17468 190.39409 192.33179 196.33049 198.5499 203.3136 208.0233 211.383 213.6024 218.2491 221.50079 226.24109 230.2632 234.9639 239.7663">IF return code segment descriptor is not present</tspan><tspan y="-597.00092" x="76.679993 81.863091 87.712189 92.436287 98.285385 100.50478 106.27288 112.12198 117.24208 119.83318 123.84628 128.52719 130.45229 135.16739 139.07249 142.44659 147.1707 150.4368 153.02789 154.89899 157.11839 161.8425 163.9386">THEN #NP(selector); FI:</tspan><tspan y="-585.00122" x="58.61969 60.70319 65.414688 67.634094 70.887596 75.627899 78.989403 83.791809 87.045311 91.847717 94.067123 97.959625 102.67113 107.31963 112.02213 114.24153 118.24203 122.98234 127.63084 134.56534 139.26784 144.07024 147.43173 149.65114 153.65164 158.35414 160.26665 165.00694 168.89944 172.26094 176.97244 180.22594 182.44534 187.85884 193.02034 197.47084">IF return code segment selector RPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-585.00122" x="199.67938">&gt;</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-585.00122" x="204.59969 206.81909 211.53239 216.64169 221.09399"> CPL </tspan><tspan y="-573.00153" x="76.679985 81.897285 87.71759 92.430893 98.269196 100.4877 105.75 111.4713 116.6886 122.3856 124.6041 130.01939 134.7327 139.905 145.5813 150.9966 156.8763 159.6996 164.8719 170.6292 173.4489 179.1702 184.8465 190.0188 194.7321 200.1474 202.9707 208.08 213.5385 215.62379 221.29109 223.37639 227.82869 232.54199 237.80429 242.51759 245.3409 249.7932 254.5065 260.1738 264.88708 269.33939">THEN GOTO RETURN-TO-OUTER-PRIVILEGE-LEVEL;</tspan><tspan y="-561.00183" x="76.679985 81.395088 85.84919 90.618286 95.333389 97.552788 102.81689 108.53999 113.71409 119.43719 121.65659 127.11598 131.79689 137.01509 142.6563 148.11569 153.93689 156.76199 161.98019 167.70329 170.5284 175.2975 180.89461 187.46371 192.17882 195.00392 200.16542 205.58252 207.66962 213.33871 215.42581 219.92491 224.60582 229.86992 234.58502 237.41013 241.86423 246.57933 252.24843 256.96353 261.41763">ELSE GOTO RETURN-TO-SAME-PRIVILEGE-LEVEL;</tspan><tspan y="-549.00214" x="58.619682 63.354584 65.461487">FI;</tspan><tspan y="-537.00244" x="45.119682 49.800583 51.90118 53.820881">FI; </tspan><tspan y="-513.00214" x="45.119682 50.529583 55.237484 60.404385 66.075287 71.485184 77.318085 80.19899 85.357788 91.073685 93.95459 98.716492 104.30639 110.90698 115.64819 118.46609 123.56998 128.97989 131.05978 136.76128 138.86188 143.30878 148.01668 153.27357 157.98148 160.79938 165.24628 169.95418 175.65567 180.36357 184.86267">RETURN-TO-SAME-PRIVILEGE-LEVEL:</tspan><tspan y="-501.00244" x="58.619682 60.696884 65.438087 67.657486 71.012688 75.815086 80.511284 82.730682 86.032784 90.713684 94.068886 98.871284 102.11848 106.92088 109.14028 111.07348 115.87588 119.87008 123.22528 126.47248 131.27487 135.16107 138.51627 140.44946 145.19066 149.99306 152.21246 156.85466 161.59586 163.52905 168.33145 171.68665 176.38284 179.68494 181.90434 183.83754 187.83174 190.05115 194.85355 199.49939 202.90408 205.12349 212.0238 214.0056 217.3653 222.10739 224.09009 228.83218 231.05159 234.45628 239.19838 243.94408 246.16348 249.40529 254.14558 257.50528 262.24738 265.54407 270.28616 272.50555 276.40524 281.14645 285.76617 290.50647 292.72586 296.76956 301.45047 306.14218 313.04248 317.78818 322.53027 325.93497 328.15436 330.07584 331.99734 338.97504 340.89655 344.30124">IF the return instruction pointer is not within the return code segment limit </tspan><tspan y="-489.00275" x="76.679092 81.859489 87.705887 92.427284 98.273682 100.49308 106.25848 111.52888 116.64629 119.23469 124.49609 127.08449 128.95288 131.17229 135.89369 137.98709">THEN #GP(0); FI;</tspan><tspan y="-477.00305" x="58.61879 60.68969 65.430885 67.650284 73.357185 78.036285 82.776588 86.018387 90.465286 95.267685 99.903587 104.70599 106.68779 110.82869 115.51859">IF OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-477" x="117.72 123.23984">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-477" x="125.76 131.0403">32</tspan><tspan y="-465.00031" x="76.680298 81.889496 87.710693 92.460892">THEN</tspan><tspan y="-453.00061" x="94.680298 99.395401 101.4825 106.5936 108.75269 110.4978 115.65929 117.87869 122.98979 127.7049 132.35699 134.9391 137.52121">EIP := Pop();</tspan><tspan y="-441.00092" x="94.680298 99.410698 104.1951 106.35419 108.11459 113.241 115.4604 120.58679 125.31719 129.98459 132.58199 135.17938 137.05678 139.27617 141.87357 145.90196 148.12135 153.39175 158.61176 161.45215 166.07185 168.03026 171.41066 173.63005 178.24976 182.99097 187.65837 189.49077 191.71016 196.49455 198.41606 203.08347 207.82556 210.66595 215.39636 218.66876 223.33617 228.05757 231.32997 233.54936 238.81976 244.03976 246.25916 250.92656 252.84807 256.22845 260.24786 262.46725 267.13464 269.05615 273.07556 276.98697 281.46536 284.73776 289.40515 294.08606 298.75345 300.97284 305.00125">CS := Pop(); (* 32-bit pop, high-order 16 bits discarded *)</tspan><tspan y="-429.00122" x="76.680298 81.421494 85.860291 90.662689 95.403885 97.623283 100.18739 104.18249 106.40189 112.10699 116.78609 121.47419 124.77629 129.22139 134.02379 138.65788 143.46028 145.38538 149.58658 154.27467">ELSE (* OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-429" x="156.42 161.93983">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-429" x="164.39995">1</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-429" x="170.28 175.52161 177.74101 181.74062">6 *)</tspan><tspan y="-417.00031" x="94.68 99.395103 101.4822 106.5933 108.7524 110.4975 115.659 117.8784 122.98949 127.7046 132.3567 134.93881 137.52092">EIP := Pop();</tspan><tspan y="-405.00061" x="94.68 99.4104 101.5128 106.63921 108.7983 110.5587 115.6851 117.9045 122.5854 124.686 129.81241 132.0318 137.6442 143.4996 149.04001 151.2594 156.5298 161.8002 167.0202 172.2906 176.9715 181.7019 186.43231 191.11322 196.96863">EIP := EIP AND 0000FFFFH;</tspan><tspan y="-393.00092" x="94.68 99.403198 104.1804 106.33949 108.09269 113.21189 115.43129 120.55049 125.27369 129.93388 132.52408 135.11427 136.98447 139.20387 141.79407 145.81526 148.03467 153.29787 158.56107 161.44197 166.06168 168.01288 171.38608 173.60548 178.26569 182.98889 187.64909 189.8685 193.88969">CS := Pop(); (* 16-bit pop *)</tspan><tspan y="-381.00122" x="58.619701 63.354603 65.461502">FI;</tspan><tspan y="-369.00153" x="58.619701 60.731102 65.470505 67.689903 69.657303 74.399406 78.427803 81.8172 85.059006 89.861412 93.781815 97.171211 99.138611 103.81951 108.61292 110.83231 115.57442 120.07352 124.10191 126.32131 128.24281 135.20341 142.10371 146.84402 151.52043 153.44194 157.88164 161.30164 165.98254 168.20193 172.94133 177.56104 182.29144 185.53325 190.02065 194.76274">IF instruction has immediate operand</tspan><tspan y="-357.00183" x="76.68 81.8703 87.726601 92.457901 98.314201 100.5336 103.1319 107.16119 109.38059 114.8139 119.4948 121.42709 126.14939 130.5891 134.61119 139.2921 141.51149 146.17979 150.61949 153.89279 158.33249 165.28679 169.9677 173.349 178.02991 181.30321 185.3235 187.54289 190.8882 194.1615 198.89279 205.79309 208.01248 212.03278 215.41408 219.89337 223.80566 228.09596 230.31535 234.34465">THEN (* Release parameters from stack *)</tspan><tspan y="-345.00214" x="94.68 96.7752 101.4984 103.7178 108.495 111.86819 116.33939 120.24359 124.52579 130.13098 134.75069 139.42979 142.69499 147.40919 151.4214 155.43361 160.21082 162.16202 166.32722">IF StackAddressSize</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-345" x="170.94"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-345" x="173.45988">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-345" x="178.92"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-345" x="181.1403 186.42061">32</tspan><tspan y="-333.00031" x="112.68001 117.88921 123.7104 128.4606 134.2818">THEN </tspan><tspan y="-321.00061" x="130.68001 135.39601 140.16602 145.27802 147.49742 149.24342 154.35542 156.57483 161.29083 166.06084 171.17284">ESP := ESP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-321.00061" x="173.4003">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-321.00061" x="178.3206 180.53999 185.33429 190.7343 195.47459"> SRC;</tspan><tspan y="-309.00092" x="112.6809 117.4194 121.85821 126.65071 131.38921 133.6086 136.2141 140.2506 142.46999 147.21208 150.57179 155.05829 158.97778 163.23749 168.87689 173.4966 178.1757 181.41751 186.15782 190.11961 194.14171 198.9342 200.85571 205.03621 209.71712">ELSE (* StackAddressSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-309" x="211.86">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-309" x="217.38"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-309" x="219.60031 224.87071 230.09071 232.3101 236.3385">16 *)</tspan><tspan y="-297.00031" x="130.68031 135.44041 140.54251 142.76192 144.49802 149.65952 151.87892 156.63902 161.74112">SP := SP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-297.00031" x="163.98032">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-297.00031" x="168.90062 171.12001 175.86571 181.32512 186.01682"> SRC;</tspan><tspan y="-285.00061" x="94.680313 99.415215 101.52212">FI;</tspan><tspan y="-273.00092" x="58.620014 63.354916 65.461815">FI;</tspan><tspan y="-261.00122" x="58.620014 60.729614 65.467216 67.686623 72.478226 77.220329 81.705933 86.32563 91.063232 97.963531 102.75513 106.14274 110.62834 114.54694 118.80664 123.54784 128.28995 132.78905 137.40875 139.33025 144.05885 148.67856 151.28316 156.02075 161.15436 165.63095">IF ShadowStackEnabled(CPL)</tspan><tspan y="-249.00153" x="76.680313 79.319115 83.341217 85.560616 90.332413 95.10421 100.21801 102.43741 109.37821 114.15001 118.15681 121.5246 123.744 128.3988 133.1076 135.32701 140.58481 142.80421 147.45901 152.13182 155.49962 160.20842 162.42783 166.89363 168.81242 170.75822 175.41302 180.18483 184.89363 189.54843 191.76784 195.78363">(* SSP must be 8 byte aligned *)</tspan><tspan y="-237.00183" x="76.680313 78.779114 83.505913 85.725311 90.506111 95.248215 100.37102 102.59042 108.19922 114.05102 119.58781 121.80721 127.07401 131.81161 137.07841 139.29782 141.04562 146.16843 148.38782">IF SSP AND 0x7 != 0</tspan><tspan y="-225.00214" x="94.680313 99.85981 105.70531 110.4258 116.2713 118.4907 124.2552 128.97571 134.09221 136.6797 141.40021 147.0027 152.4252 155.25571 160.67821 165.39871 170.57822 173.70572 175.79822 181.22072 185.94122 191.12073 193.70822 195.57571 197.79512 202.51562 204.60812">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-213.00244" x="76.680313 80.100311 84.781212 91.741814 96.361519 101.16392 105.18602 109.88582 114.68822 116.90762 122.00342 124.22282 128.24492 132.98701 137.48611 142.16521 146.86501 153.82561 158.3868 162.3486 165.76862 170.20831 174.08911 178.34792 182.9091 184.83061 189.57181 194.01151 198.6906 200.91 206.19031 208.40971 213.04651 217.70131 221.05112 225.79141 229.81351 232.03291 235.34671 238.58852 243.32971 250.29031 252.50972 257.26352 262.06595 267.16174 272.31155 277.59186 282.81186">tempSsCS = shadow_stack_load 8 bytes from SSP+16;</tspan><tspan y="-201.00275" x="76.680313 80.100311 84.781212 91.718414 96.369614 101.13782 105.14101 109.59422 111.68041 116.79061 119.01001 124.12021 126.33961 130.3428 135.11101 139.57321 144.22441 148.93861 155.87581 160.41901 164.42221 167.78641 172.24861 176.14381 180.46291 185.0061 186.96001 191.7012 196.2003 200.8344 203.0538 208.33411 210.55351 215.18761 219.83971 223.18681 227.92711 231.9492 234.16861 237.47971 240.78181 245.47891 252.43951 254.65892 259.46133 264.20343 269.29654 274.44363 279.72394">tempSsLIP = shadow_stack_load 8 bytes from SSP+8;</tspan><tspan y="-189.00305" x="76.680313 81.351311 84.627312 89.35231 94.00531 98.793312 103.53542 108.66541 110.88481 116.01481 118.23421 122.25721 126.99931 131.48131 136.10101 140.83501 147.73531 152.29831 156.3213 159.70531 164.1873 168.10229 172.39529 176.9583 178.8933 183.57419 188.07329 192.74429 194.96368 200.18369 202.40308 207.07408 211.76308 215.14708 219.82799 223.85098 226.07037 229.41838 232.69438 237.42838 244.32867 246.54807 251.33606 256.07816 261.20816">prevSSP = shadow_stack_load 8 bytes from SSP;</tspan><tspan y="-177.00336" x="76.680313 81.459312 86.238312 91.359314 93.578712 98.699715 100.91911 105.69811 110.44021 115.56121 117.78061 122.95561 125.17501 130.44002 135.70502">SSP = SSP + 24;</tspan><tspan y="-165.00366" x="76.680313 79.319115 83.341217 85.560616 90.198318 94.939514 97.158913 101.60761 103.82701 109.10731 114.3876 116.607 121.24471 123.22651 126.57721 129.38791 133.26961 138.0108 144.93451 149.6136 154.0623 157.36441 162.05611 164.27551 167.62622 172.36742 174.58682 178.46852 183.27092 187.96262 191.84431 196.10402 198.32343 200.30522 203.58032 205.79971 210.28801 215.03011 219.7254 221.94479 226.6221 228.54361 231.93391 235.89571 238.1151 242.7924 247.47331 252.16861 256.90891 261.70322 266.32294 268.54236 273.21967 275.14114 278.53143 280.75085 286.03116 291.31146 293.53088 297.97058 301.27267 305.95355 308.17297 312.20227 316.88315 320.27344 322.49286 326.45465">(* do a 64 bit-compare to check if any bits beyond bit 15 are set *)</tspan><tspan y="-153.00397" x="76.680321 80.100319 84.781219 91.724716 96.382217 101.10271 105.87721 108.09661 113.21311 115.43251 120.15301 124.92751 126.79501 129.0144 131.6019 135.62039 137.8398 142.0023 146.71381 149.9763 154.69681 156.91621 161.57372 166.04222 170.69972 172.91913 176.28963 181.01013 183.22954 188.49004 193.75053 195.96994 200.62744 202.57594 205.94644 208.16585 212.18434">tempCS = CS; (* zero pad to 64 bit *)</tspan><tspan y="-141.00427" x="76.680321 78.770119 83.487915 85.707314 89.075111 93.783913 100.72472 105.37952 110.09732 114.86912 117.08852 118.82732 123.94112 126.16051 129.58052 134.26143 141.20222 145.85703 150.62883 154.63564 159.35344">IF tempCS != tempSsCS</tspan><tspan y="-129.00458" x="94.680321 99.859818 105.70531 110.42581 116.27131 118.49071 124.25521 128.97571 134.09221 136.6797 141.40021 147.0027 152.4252 155.25571 160.67821 165.39871 170.57822 173.70572 175.79822 181.22072 185.94122 191.12073 193.70822 195.57571 197.79512 202.51562 204.60812">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-117.00488" x="76.680321 79.319122 83.341225 85.560623 90.196526 94.937721 97.15712 101.60402 103.82342 109.10371 114.38401 116.60341 121.23931 123.22112 126.57001 129.37892 133.25882 138.00002 144.92192 149.60101 154.04791 157.35002 162.03992 163.88582 166.10522 170.78432 175.22401 179.90311 182.12251 186.86371 191.6058 196.94731 202.50031 207.26851 211.98271 217.14691 222.60631 224.6925 229.8027 232.02211 238.9593 240.9015 244.2657 249.03391 251.25331 256.50751 258.7269 262.05508 266.76929 270.02548 272.24487 277.49908 282.7533 284.97269 289.6239 291.5661 294.9303 297.14969 301.64877 303.74939 308.85959 312.8718">(* do a 64 bit-compare; pad CSBASE+RIP with 0 for 32 bit LIP*)</tspan><tspan y="-105.00517" x="76.680313 78.783615 83.514915 85.734314 90.465614 95.207718 100.53302 106.11301 110.89832 115.57922 117.79861 122.97991 125.19931 130.63261 132.73592 137.86322 140.08261 141.83492 146.96222 149.18161 152.56291 157.28522 164.18552 168.86462 173.64992 177.61171 182.08202 184.18532">IF CSBASE + RIP != tempSsLIP</tspan><tspan y="-93.00547" x="94.680313 99.85981 105.70531 110.4258 116.2713 118.4907 124.2552 128.97571 134.09221 136.6797 141.40021 147.0027 152.4252 155.25571 160.67821 165.39871 170.57822 173.70572 175.79822 181.22072 185.94122 191.12073 193.70822 195.57571 197.79512 202.51562 204.60812">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-81.005768" x="76.680313 79.319115 83.341217 85.560616 90.200119 93.50222 98.195724 102.81722 107.61962 112.36172 117.52323 119.74263 126.66813 131.47052 135.49261 138.85231 141.07172 145.71121 150.45151 152.67091 157.95122 160.17062 164.81012 169.46762 172.82011 177.56041 179.77982 184.23032 186.13382 188.11562 192.73531 197.5377 202.2186 206.89769 209.1171 213.1176">(* prevSSP must be 4 byte aligned *)</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="369.29608pt" height="644.30536pt" viewBox="0 0 369.29608 644.30536" sodipodi:docname="1279.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="345.46813" inkscape:cy="423.52757" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg288" /><g transform="translate(-46.898903,-69.340332)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="77.519997 79.613396 84.334793 86.554192 91.212593 94.47599 99.188393 103.8288 108.60419 113.37959 118.49699 120.71639 126.31979 132.1662 137.6976 139.91701 145.13701 149.93491 155.1963 157.41571 159.15811 164.27551 166.49492">IF prevSSP AND 0x3 != 0</tspan><tspan y="-703.98029" x="95.519997 100.69949 106.54499 111.26549 117.11098 119.33038 125.09489 129.81538 134.93188 137.51938 142.23988 147.84238 153.26488 156.09538 161.51788 166.23839 171.41789 174.54539 176.63789 182.06039 186.7809 191.9604 194.5479 196.41539 198.6348 203.3553 205.4478">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-691.98059" x="77.519997 80.158798 84.180901 86.400299 88.441498 93.243896 95.463295 97.386597 102.0999 106.7592 111.2295 115.1328 119.75249 121.97189 128.91719 133.6395 138.2988 143.0121 145.23151 150.00781 154.78412 159.90242 162.12183 169.06712 173.84343 177.85474 181.22704 183.44644 188.10574 192.81905 195.03845 196.98875 201.76506 203.98447 205.96536 210.64627 217.59157 219.81097 225.07327 230.34457 235.66087 237.88028 241.90057">(* In legacy mode SSP must be in low 4GB *)</tspan><tspan y="-679.9809" x="77.519997 79.616997 84.341995 86.561394 91.223396 94.490395 99.171295 103.8504 108.59249 113.39489 118.51589 121.27889 126.54389 131.7639 133.51891 138.78391 144.0489 146.8119 149.03131 150.77731 155.89832 158.11772">IF prevSSP[63:32] != 0</tspan><tspan y="-667.9812" x="95.519997 100.70039 106.54679 111.26819 117.11459 119.33398 125.09939 130.36978 135.48718 138.07558 143.33698 145.92537 147.79376 150.01317 154.73457 156.82797">THEN #GP(0); FI;</tspan><tspan y="-655.98151" x="77.519997 82.315201 87.057297 92.194496 94.413895 96.185097 101.3223 103.54169 108.21989 111.4617 116.1939 120.81271 125.55481 130.35721">SSP := prevSSP</tspan><tspan y="-643.98181" x="59.519997 64.254898 66.361801">FI;</tspan><tspan y="-619.98151" x="46.019997 51.426296 56.130596 61.293896 66.961197 72.3675 78.1968 81.077698 86.236496 91.948799 94.7631 100.5213 106.2228 111.3861 116.0904 121.5498 124.37041 129.4707 134.9301 137.00639 142.70789 144.78418 149.22748 153.93178 159.18507 163.88937 166.70367 171.20277 175.88367 181.58516 186.32635 190.76965">RETURN-TO-OUTER-PRIVILEGE-LEVEL:</tspan><tspan y="-607.98181" x="59.519997 61.622398 66.352798 68.572197 71.952599 76.682999 81.302696 83.522095 86.119492 91.389893 96.660294">IF top (16 </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-607.98181" x="98.8797">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-607.98181" x="103.8 106.0194 110.7984 116.2254 120.9504 123.5424 125.7618 130.3815 135.06149 138.43649 143.1525 147.1665 149.38591 154.06682 157.42563 159.64503 163.65903 167.03403 171.50703 175.41304 179.69704 181.91644 186.38945 189.65645 194.37245 196.59186 201.37086 206.09587 209.47087 211.69028 218.63828 220.50031 223.89061 228.63271 230.60101 235.34311 237.5625 241.5918 244.9821 249.4704 253.39169 257.65137 259.87079 261.8121 263.73358 270.69687 272.66516 276.05545 280.08475 282.30417 284.91147 290.60934 295.28665 299.96753 303.24982 307.68951 312.48383 317.10355 321.89786 323.81934 328.00165 332.68253"> SRC) bytes of stack are not within stack limits (OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-607.97998" x="334.85999">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-607.97998" x="340.38"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-607.97998" x="342.60031 347.86713 353.0871 355.68091">32) </tspan><tspan y="-595.98029" x="59.520599 64.258202 67.537804 69.75721 73.144814 77.825714 82.500313 84.719719 87.324318 92.601921">or top (8 </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-595.98029" x="94.800598">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-595.98029" x="99.720901 101.9403 106.6869 112.14629 116.8389 119.3985 121.6179 126.297 130.97699 134.3196 139.05989 143.04149 145.26088 150.00208 153.36087 155.58026 159.56186 162.98186 167.42245 171.32214 175.57375 177.79314 182.29224 185.53404 190.27434 192.49373 197.24033 201.98152 205.32413 207.54352 214.50412 216.4212 219.7899 224.56261 226.50931 231.28201 233.50142 237.50912 240.87782 245.34453 249.24423 253.56332 255.78273 257.70242 259.64911 266.59082 268.53751 271.95752 275.91931 278.1387 280.7775 286.4754 291.1311 295.84079 299.1015 303.56821 308.34091 312.99661 317.76932 319.716 323.87671 328.5864"> SRC) bytes of stack are not within stack limits (OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-595.97998" x="330.78 336.24008">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-595.97998" x="338.76001 344.04031 349.26031">16)</tspan><tspan y="-583.98029" x="95.519714 100.70371 106.55371 111.27871 117.12871 119.34811 125.1171 129.8961 134.63821 137.21761 142.4826 145.0746 146.94659 149.166 153.89101 155.98801">THEN #SS(0); FI;</tspan><tspan y="-571.98059" x="59.519714 64.966515 69.647415 74.140213 78.759911 80.979309 84.266106 88.947006 92.306702 97.1091 100.3509 105.1533 107.3727 111.40649 116.08739 120.7692 127.6695 132.4053 137.1474 140.54221 142.7616 146.72339 151.46368 153.40948 158.09038 162.01617 165.41098 170.09187 173.39398">Read return segment selector;</tspan><tspan y="-559.9809" x="59.519714 61.614914 66.338112 68.55751 72.56971 75.942909 80.414108 84.318306 88.60051 90.819908 94.781708 99.522011 104.18221 111.08251 115.79671 120.57391 123.94711 126.16651 130.17871 134.89291 136.81711 141.53131 145.43552 148.80872 153.53192 156.79712 159.01653 160.96773 164.97993 167.19934 173.04755 178.73375 183.19595">IF stack segment selector is NULL</tspan><tspan y="-547.9812" x="77.519714 82.700111 88.546509 93.267906 99.114304 101.3337 107.09911 112.36951 117.48691 120.07531 125.33671 127.92511 129.7935 132.01291 136.73431 138.82771">THEN #GP(0); FI;</tspan><tspan y="-535.98151" x="59.519714 61.611313 66.330917 68.550316 71.811913 76.522514 79.892113 84.66571 87.927307 92.700905 94.920303 98.928902 102.2985 106.7661 110.66669 114.9453 117.1647 121.17329 125.8839 130.5405 137.48309 142.1937 146.9673 150.3369 152.5563 156.56491 161.27551 163.19611 167.94 171.855 175.239 179.97299 183.2148 185.43419 187.39619 192.13829 196.8093 201.4902 206.2872 208.50659 210.4281 214.4502 216.66959 221.45758 226.13847 229.52248 231.74187 238.69887 240.66087 244.04488 248.78697 250.74898 255.49107 257.71048 259.67249 263.05649 267.0795 269.29889 273.91858 278.65887 282.68188 286.59689 289.83868 291.8205 296.44019 299.7999 304.53391 307.7757 309.99509 313.37909 317.81879 322.48978 324.42477 329.10568 331.32507 333.26007 335.22208 342.12238 344.10419 347.48819">IF return stack segment selector index is not within its descriptor table limits</tspan><tspan y="-523.98181" x="77.519707 82.702805 88.551903 93.276001 99.125099 101.3445 107.11259 112.3857 117.5058 120.0969 124.11 128.8251 130.7502 135.43111 139.33621 142.71031 147.43442 150.70052 153.29161 155.1627 157.38211 162.06302 164.16362">THEN #GP(selector); FI;</tspan><tspan y="-511.98212" x="59.519707 64.979111 69.660011 74.159111 78.778809 80.998207 85.020302 89.760605 94.392006 101.3526 106.038 110.8404 114.1848 116.4042 121.0833 125.7642 129.7863 133.686 136.92241 138.90421 143.5356 146.95561 151.65001 154.95212 157.17151 161.8029 166.5441 168.46649 173.26889 176.6133 181.35359 185.98499 188.15939 191.52719 196.245 198.4644 203.1192 207.79201 210.01141 213.31351 217.99442 221.36221 226.13402 229.39381 234.16562 236.38503 240.39183 245.10063 249.75543 256.69623 261.40503 266.17682 269.54462 271.76401 275.77081 280.47961 282.39841 287.10721 291.00601 294.37381 299.09161 302.39371">Read segment descriptor pointed to by return segment selector;</tspan><tspan y="-499.98242" x="59.519699 61.614899 66.338097 68.557495 72.569695 75.942894 80.414093 84.318291 88.600494 90.819893 94.781693 99.521996 104.1822 111.0825 115.7967 120.5739 123.9471 126.1665 130.1787 134.8929 136.81709 141.5313 145.4355 148.8087 153.53191 156.7971 159.01651 164.44171 169.56091 174.02312">IF stack segment selector RPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-499.98001" x="176.22">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-499.98001" x="181.74001 183.95941 189.37831 194.49121 198.99031 201.20972 205.92662 209.25752 211.47693 214.84383 219.61473 224.32263 226.54204 229.80093 234.50883 237.87573 242.64664 245.90553 250.67644 252.9003 256.8045 261.48541 266.1456 270.8598 273.07919 277.0914 281.8056 286.42529 293.38589 298.1001 302.87729 306.25049 308.46988 312.48209 317.19629 319.12048 323.83469 327.73889 331.11209 335.8353"> RPL of the return code segment selector</tspan><tspan y="-487.98032" x="59.520004 64.245903 67.513802 69.7332 73.7481 77.124001 81.5979 85.504799 89.789696 92.009094 96.023994 100.7409 105.4038 112.3527 117.0696 121.8495 125.2254 127.4448 129.3987 133.4136 135.63301 140.41292 145.09383 148.46973 150.66031 155.10991 157.32932 164.28992 167.53172 169.51352 172.87321 177.32281 182.00191 183.90451 188.59711 190.81651 195.49561 199.9353 203.3553 207.795 210.0144 214.005 218.6976 223.37669 230.3373 235.02989 239.83229">or stack segment is not a writable data segment</tspan><tspan y="-475.98062" x="59.520004 64.240501 67.502998 69.722397 73.731895 77.102394 81.570892 85.472389 89.751892 91.971291 95.980789 100.69229 105.34979 112.29329 117.00479 121.77929 125.14979 127.36919 132.02669 136.73819 140.7477 144.6492 147.9117 149.8602 154.4799 157.8396 162.5601 165.8226 168.04201 173.57251 178.68901 183.14851">or stack segment descriptor DPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-475.98001" x="185.39999 190.91983">≠ </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-475.98001" x="193.38 198.8394 203.9406 208.3839 210.6033 215.3076 218.6259 220.84531 224.1996 229.002 233.74229 235.9617 239.20801 243.90331 247.3233 252.0654 255.31171 260.11411 262.3335 266.21881 270.9231 275.56439 280.30472 282.52411 286.5174 291.21271 295.854 302.78131 307.52164 312.26373 315.68375 317.90314 321.89642 326.63675 328.54205 333.23737 337.12268 340.54269 345.24701">RPL of the return code segment selector</tspan><tspan y="-463.98032" x="95.520309 100.70341 106.55251 111.2766 117.1257 119.3451 125.1132 130.38629 135.50639 138.09749 142.1106 146.8257 148.75079 153.4317 157.33681 160.71091 165.43501 168.70111 171.29221 173.1633 175.38271 180.06361 182.16422">THEN #GP(selector); FI;</tspan><tspan y="-451.98062" x="59.520309 61.60741 66.32251 68.541908 72.546005 75.911102 80.374199 84.270302 88.589401 90.8088 94.812897 99.518997 104.1711 111.1092 115.8153 120.5844 123.94949 126.16889 130.93799 135.65309 139.01819 141.23759 145.88969 149.19179 153.89789 157.90199 162.60809 167.3772">IF stack segment not present</tspan><tspan y="-439.98093" x="77.520309 82.71151 88.56871 93.300911 99.158112 101.37751 107.15371 111.93991 116.68201 119.26141 124.04762 127.42982 131.86952 135.76921 140.06041 144.80251 149.52571 154.14542 161.10062 165.82382 170.56592 173.92561 178.71181 183.39272 185.32591 190.04912 193.96231 197.34451 202.07672 205.35092 207.95012 209.82932 212.04871 216.78091 218.88512">THEN #SS(StackSegmentSelector); FI;</tspan><tspan y="-427.98123" x="59.520309 61.597511 66.338715 68.558113 71.913315 76.715714 81.411911 83.63131 86.933411 91.614311 94.969513 99.771912 103.01911 107.82151 110.04091 111.97411 116.7765 120.77071 124.12591 127.37311 132.17551 136.06171 139.4169 141.3501 146.09129 150.85049 153.0699 157.74899 162.49019 164.42339 169.22578 172.58098 177.27718 180.57928 182.79869 184.73189 188.72609 190.9455 195.74789 200.40001 203.7597 205.97911 212.95502 214.93591 218.29561 223.0377 225.0186 229.7607 231.9801 235.383 240.12509 244.86899 247.08839 250.3302 255.01109 258.414 263.1561 266.45099 271.19308 273.41248 277.31216 282.05338 286.6731 291.41339 293.63281 297.67471 302.35562 307.04553 313.94583 318.68973 323.43185 326.83475 329.05414 330.97562 332.89713 339.87302 341.79453">IF the return instruction pointer is not within the return code segment limit</tspan><tspan y="-415.98154" x="77.520309 82.700706 88.547104 93.268501 99.114899 101.3343 107.0997 112.3701 117.4875 120.0759 125.3373 127.9257 129.7941 132.0135 136.73491 138.82831">THEN #GP(0); FI;</tspan><tspan y="-403.98184" x="59.520309 61.589409 66.330605 68.550003 74.255104 78.934204 83.622307 86.924408 91.369507 96.171906 100.80601 105.60841 107.53351 111.73471 116.42281">IF OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-403.98001" x="118.62">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-403.98001" x="124.14"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-403.98001" x="126.3603 131.64059">32</tspan><tspan y="-391.98032" x="77.519997 82.729195 88.550392 93.300591">THEN</tspan><tspan y="-379.98062" x="95.519997 100.2351 102.3222 107.4333 109.65269 111.3978 116.5593 118.77869 123.88979 128.60489 133.25699 135.8391 138.4212">EIP := Pop();</tspan><tspan y="-367.98093" x="95.519997 100.24049 105.01499 107.23439 108.98489 114.10139 116.32079 121.43729 126.15779 130.81529 133.40279 135.99028 137.85777 140.07718 142.66467 146.68317 148.90257 154.16307 159.42357 162.30447 166.92418 168.87268 172.24318 174.46259 179.12009 183.84059 188.49809 190.32059 192.53999 197.32799 199.2495 203.9205 208.6626 211.50659 216.24059 219.51659 224.18759 228.9126 232.1886 234.40799 239.68199 244.90199 247.12138 251.79239 253.7139 257.0979 261.12091 263.3403 268.01129 269.9328 273.95581 277.87082 282.35281 285.62881 290.2998 294.98071 299.6517 301.53271 303.75211 307.77512 312.45602 317.12701 324.02731 328.75232 333.49442 336.87842 339.09781 343.7175 348.45779 352.41962 356.31934 359.59534 361.51685 366.18784 369.57184 374.30585 377.58185 379.80124 381.73624 386.47025 390.90994 395.58902 400.26993 404.94901 407.1684 411.20041">CS := Pop(); (* 32-bit pop, high-order 16 bits discarded; segment descriptor loaded *)</tspan><tspan y="-355.98123" x="95.519997 100.2315 105.03391 107.6124 113.0259 118.1334 122.6325 125.211 127.4304 129.17191 134.2794 136.49881 141.95821 146.6391 150.0006 154.80299 158.05649 162.85889 167.57039 172.28189 176.93039 181.63289 186.43529 191.11618 195.76468 202.69917 207.43947 212.18156 215.60156 220.34366 225.08395 227.00546 231.70796 235.60046 238.96196 243.67346 246.92696 249.50546 254.96486 260.06607 264.51657 267.09506">CS(RPL) := ReturnCodeSegmentSelector(RPL);</tspan><tspan y="-343.98154" x="95.519997 97.617897 102.3438 104.56319 106.5171 111.297 115.3119 118.6878 121.9557 126.7356 130.6425 134.0184 135.97231 140.65321 145.43312 147.65253 152.43243 156.90634 160.92123 163.14064 165.09454 172.04344 178.94374 183.68405 188.30376 190.28555 194.75946 198.13536 202.85226 205.07167 209.79758 214.41728 219.13419 222.40208 226.87598 231.65588">IF instruction has immediate operand</tspan><tspan y="-331.98184" x="113.52 118.7112 124.53239 129.26459 135.0858 137.30519 139.90439 143.93459 146.15398 151.58818 156.26909 158.20229 162.92549 167.36519 171.38728 176.06819 178.28758 182.95679 187.39648 190.67068 195.11038 202.06558 206.74649 210.12869 214.8519 218.1261 222.14729 224.36668 227.71289 230.98709 235.7193 242.6196 244.83899 248.7522 253.23239 255.16559 257.09879 261.77969 266.44888 268.66827 273.33746 276.61166 281.34387 285.25708 289.93799 294.61707 299.35916 302.66125 307.34216 308.96396 312.98517 315.20456 319.16638 322.5864 327.02609 330.92581 335.21701 337.4364 341.46661">THEN (* Release parameters from called procedure’s stack *)</tspan><tspan y="-319.98215" x="131.51999 133.62689 138.36179 140.58118 145.37007 148.75497 153.19467 157.09436 161.35406 166.99347 171.61317 176.29228 179.53409 184.2744 188.29829 192.26009 197.04898 199.01189 203.15279">IF StackAddressSize</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-319.98001" x="207.84"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-319.98001" x="210.35988">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-319.98001" x="215.82001"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-319.98001" x="218.04031 223.32062">32</tspan><tspan y="-307.98032" x="149.52061 154.72981 160.55101 165.30121 171.12241">THEN </tspan><tspan y="-295.98062" x="167.58092 172.30232 177.07773 182.19513 184.35423 186.10564 191.22304 193.44244 198.16385 202.93925 208.05666">ESP := ESP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-295.98062" x="210.30121">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-295.98062" x="215.22151 217.4409 222.2352 227.63521 232.3755"> SRC;</tspan><tspan y="-283.98093" x="149.52151 154.25012 158.71773 163.50034 168.22894 170.44833 173.04393 177.07053 179.28992 184.03201 187.39171 191.8683 195.77791 200.06551 205.6761 210.34171 215.00731 218.27791 222.99751 226.9593 230.9769 235.75949 237.681 241.88219 246.5631">ELSE (* StackAddressSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-283.98001" x="248.75999">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-283.98001" x="254.28"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-283.98001" x="256.50031 261.77069 266.99066 269.21005 273.23846">16 *)</tspan><tspan y="-271.98032" x="167.58031 172.3647 177.4911 179.65019 181.4106 186.537 188.75639 193.49849 198.59969">SP := SP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-271.98032" x="200.88031">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-271.98032" x="205.80061 208.02 212.7657 218.22511 222.91681"> SRC;</tspan><tspan y="-259.98062" x="131.52092 136.25581 138.36272">FI;</tspan><tspan y="-247.98093" x="95.52092 100.25582 102.36272">FI;</tspan><tspan y="-235.98123" x="95.52092 98.940918 103.62182 110.56352 115.21922 119.93793 124.71062 129.82532 132.04472 133.79343 138.90813 141.12753 146.24223 150.96094 155.61664 158.20233 160.78802">tempESP := Pop();</tspan><tspan y="-223.98154" x="95.52092 98.940918 103.62182 110.58242 115.20213 120.00452 124.74662 126.96602 128.76782 133.86902 136.08842 141.18422 145.92542 150.56221 153.12901 155.76782 157.62813 159.84753 162.41434 166.41214 168.63155 173.87135 179.15166 181.96146 186.64055 188.56834 191.98836 194.20776 198.84456 203.58575 208.22255 210.08105 212.30046 217.05426 219.03606 223.67285 228.47525 231.28505 236.02625 239.26805 243.94714 248.63794 251.94005 254.15945 259.39926 264.67957 266.89899 271.57809 273.4996 276.8494 280.87149 283.09091 287.77002 289.69153 293.71362 297.61331 302.06113 305.36322 310.00003 314.74033 319.37714 321.29684 323.51627 327.50507 332.24536 336.92447 338.6048 340.82422 345.50333 350.18423 354.20633 358.10513 361.34692 363.3287 367.96552 371.3855 376.0853 379.38739 381.60681 383.5076 388.2074 392.70651 397.32623 402.06653 406.68625 408.90567 412.90347">tempSS := Pop(); (* 32-bit pop, high-order 16 bits discarded; seg. descriptor loaded *)</tspan><tspan y="-211.98184" x="77.52092 82.262115 86.700912 91.503311 96.244507 98.463905 101.02801 105.02311 107.24251 112.94761 117.62671 122.31481 125.61691 130.06201 134.86441 139.4985 144.3009 146.226 150.4272 155.1153">ELSE (* OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-211.98" x="157.32001 162.78008">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-211.98" x="165.3 170.5704 175.79041 178.0098 182.03819">16 *)</tspan><tspan y="-199.9803" x="95.520302 100.2354 102.3225 107.4336 109.653 111.3981 116.5596 118.779 123.8901 128.60519 133.25729 135.8394 138.42151">EIP := Pop();</tspan><tspan y="-187.98061" x="95.520302 100.2507 102.3531 107.47951 109.69891 111.4593 116.58571 118.80511 123.48601 125.58661 130.71301 132.9324 138.5448 144.40021 149.94061 152.16 157.4304 162.70081 167.92081 173.19121 177.8721 182.60251 187.33292 192.01382 197.86923">EIP := EIP AND 0000FFFFH;</tspan><tspan y="-175.98091" x="95.520302 100.2426 105.0189 107.2383 108.99059 114.10889 116.32829 121.44659 126.16889 130.82819 133.41748 136.00677 137.87607 140.09547 142.68477 146.70506 148.92447 154.18677 159.44907 162.32997 166.94968 168.89998 172.27228 174.49168 179.15099 183.87329 188.53259 190.38031 192.5997 196.6254 201.3063 205.98001 212.88031 217.60802 222.35011 225.73682 227.95621 232.57591 237.31622 241.27802 245.1777 248.45641 250.37791 255.05162 258.43832 263.17502 266.4537 268.67313 270.61084 275.34753 279.78723 284.46634 289.14722 293.82632 296.04575 300.08044">CS := Pop(); (* 16-bit pop; segment descriptor loaded *)</tspan><tspan y="-163.98122" x="95.520309 100.23181 105.03422 107.61272 113.02621 118.13371 122.63281 125.21131 127.43072 129.17221 134.27971 136.49911 141.95851 146.6394 150.0009 154.8033 158.05679 162.85919 167.57069 172.2822 176.93069 181.63319 186.43559 191.11649 195.76498 202.69948 207.43977 212.18187 215.60187 220.34396 225.08426 227.00577 231.70827 235.60077 238.96227 243.67377 246.92726 249.50577 254.96516 260.06638 264.51688 267.09537">CS(RPL) := ReturnCodeSegmentSelector(RPL);</tspan><tspan y="-151.98152" x="95.520309 97.61821 102.34411 104.56351 106.51741 111.29731 115.31221 118.68811 121.95601 126.73591 130.64281 134.01871 135.97261 140.65352 145.43343 147.65283 152.43274 156.90665 160.92154 163.14095 165.09485 172.04375 178.94405 183.68436 188.30406 190.28586 194.75977 198.13567 202.85257 205.07198 209.79788 214.41759 219.13449 222.40239 226.87628 231.65619">IF instruction has immediate operand</tspan><tspan y="-139.98183" x="113.52031 118.71151 124.53271 129.26491 135.08611 137.3055 139.90469 143.93489 146.15428 151.58849 156.26939 158.20259 162.9258 167.36549 171.38759 176.0685 178.28789 182.95709 187.39679 190.67099 195.11069 202.06589 206.7468 210.129 214.8522 218.1264 222.1476 224.36699 227.7132 230.9874 235.7196 242.6199 244.83929 248.7525 253.2327 255.16589 257.09909 261.78 266.44919 268.66858 273.33777 276.61197 281.34418 285.25739 289.93829 294.61737 299.35947 302.66156 307.34247 308.96426 312.98547 315.20486 319.16669 322.5867 327.0264 330.92612 335.21732 337.43671 341.46692">THEN (* Release parameters from called procedure’s stack *)</tspan><tspan y="-127.98212" x="131.52031 133.62721 138.36211 140.5815 145.37039 148.75529 153.19499 157.09468 161.35439 166.99379 171.61349 176.2926 179.53441 184.27472 188.29861 192.26041 197.0493 199.01221 203.15311">IF StackAddressSize</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-127.98" x="207.84"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-127.98" x="210.35988">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-127.98" x="215.82001"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-127.98" x="218.04031 223.32062">32</tspan><tspan y="-115.9803" x="149.52061 154.72981 160.55101 165.30121 171.12241">THEN </tspan><tspan y="-103.9806" x="167.58092 172.30232 177.07773 182.19513 184.35423 186.10564 191.22304 193.44244 198.16385 202.93925 208.05666">ESP := ESP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-103.9806" x="210.30121">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-103.9806" x="215.22151 217.4409 222.2352 227.63521 232.3755"> SRC;</tspan><tspan y="-91.980896" x="149.52151 154.25012 158.71773 163.50034 168.22894 170.44833 173.04393 177.07053 179.28992 184.03201 187.39171 191.8683 195.77791 200.06551 205.6761 210.34171 215.00731 218.27791 222.99751 226.9593 230.9769 235.75949 237.681 241.88219 246.5631">ELSE (* StackAddressSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-91.980003" x="248.75999">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-91.980003" x="254.28"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-91.980003" x="256.50031 261.77069 266.99066 269.21005 273.23846">16 *)</tspan><tspan y="-79.980301" x="167.58031 172.3647 177.4911 179.65019 181.4106 186.537 188.75639 193.49849 198.59969">SP := SP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-79.980301" x="200.88031">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-79.980301" x="205.80061 208.02 212.7657 218.22511 222.91681"> SRC;</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="465.01129pt" height="644.388pt" viewBox="0 0 465.01129 644.388" sodipodi:docname="1280.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="329.03768" inkscape:cy="423.81942" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg126" /><g transform="translate(-59.221741,-69.476563)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="130.67999 135.3609 137.4615">FI;</tspan><tspan y="-703.98029" x="94.679993 99.414894 101.5218">FI;</tspan><tspan y="-691.98059" x="94.679993 98.099991 102.78089 109.7226 114.3783 119.097 123.8697 128.98441 131.14351 132.89221 138.00691 140.22632 145.38782 150.12903 154.78473 157.37042 159.95612">tempESP := Pop();</tspan><tspan y="-679.9809" x="94.679993 98.099998 102.7809 109.7136 114.3603 119.124 123.8877 126.10711 127.90891 133.01012 135.16922 140.27492 144.98462 149.63132 152.27013 154.84683 156.70354 158.92294 161.49965 165.50735 167.72676 172.97646 178.22615 181.04585 185.69255 187.63025 191.05025 193.26965 197.91635 202.67999 207.2997 209.21939 211.43878 215.40057 220.14088 224.80919 231.70949 236.43179 241.17389 244.55519 246.77458 251.44289 256.12378 260.14407 264.05637 267.32965 269.25113 273.91943 277.30072 282.03201 285.3053 287.52472 289.45703 294.18832 298.62802 303.30713 307.98801 312.66711 314.88654 318.91583">tempSS := Pop(); (* 16-bit pop; segment descriptor loaded *)</tspan><tspan y="-667.9812" x="76.679993 81.414894 83.521797">FI;</tspan><tspan y="-655.98151" x="58.61969 60.72929 65.466888 67.686295 72.477898 77.220001 81.705605 86.325302 91.062904 97.963203 102.75481 106.14241 110.62801 114.54662 118.80631 123.54752 128.28961 132.78871 137.40842 139.32991 144.05852 148.67822 151.28282 156.02042 161.15402 165.63062">IF ShadowStackEnabled(CPL)</tspan><tspan y="-643.98181" x="76.679993 79.318794 83.340897 85.560295 89.461792 94.23629 98.947792 102.84929 107.12879 109.34819 111.29669 114.6312 116.85059 122.11109 124.33049 128.98799 133.6635 137.034 141.7455 143.9649 148.43341 150.3549 152.30341 156.96091 161.73541 166.44691 171.10442 173.32382 177.34232">(* check if 8 byte aligned *)</tspan><tspan y="-631.98212" x="76.679993 78.778793 83.505592 85.724991 90.505791 95.247894 100.3707 102.5901 108.1989 114.0507 119.58749 121.80689 127.07369 131.81129 137.07809 139.29749 141.04529 146.16809 148.38748">IF SSP AND 0x7 != 0</tspan><tspan y="-619.98242" x="94.679993 99.859489 105.70499 110.42548 116.27098 118.49038 124.25488 128.97539 134.09189 136.67938 141.39989 147.00238 152.42488 155.25539 160.67789 165.39839 170.5779 173.7054 175.7979 181.2204 185.9409 191.12041 193.7079 195.57539 197.7948 202.5153 204.6078">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-607.98273" x="76.679993 78.782394 83.512794 85.732193 91.164597 95.885994 99.266396 104.0508 107.3232 112.0653 116.7957 121.5261 126.1458 130.8672 135.6093 140.3307 144.95041 151.90381 156.62521 161.36731 164.72701 169.5114 174.19231 176.1237 180.84511 184.75652 188.13692 192.86731 196.13971 198.73711 204.16951 209.29591 213.76532 216.36272 218.58211 220.33351 225.45992">IF ReturnCodeSegmentSelector(RPL) !=3</tspan><tspan y="-595.98303" x="94.679993 99.889191 105.71039 110.46059">THEN</tspan><tspan y="-583.98334" x="112.67999 116.09999 120.78089 127.74149 132.36118 137.16357 141.18567 145.88457 150.68697 152.90637 158.00127 160.22067 164.24277 169.04517 173.49207 178.17116 182.87006 189.83066 194.39185 198.35365 201.77367 206.21336 210.09326 214.35117 218.91235 220.83386 225.57506 230.01476 234.69385 236.91325 242.19356 244.41296 249.04886 253.70276 257.05167 261.79199 265.81412 268.03351 271.34641 274.58731 279.32852 286.28912 288.50851 293.26141 298.06381 303.15872 308.30762 313.58792 318.80792">tempSsCS = shadow_stack_load 8 bytes from SSP+16;</tspan><tspan y="-571.98364" x="112.67999 116.09999 120.78089 127.71809 132.36929 137.1375 141.1407 145.5939 147.6801 152.7903 155.0097 160.1199 162.33931 166.34251 171.11072 175.57292 180.22412 184.93832 191.87552 196.41872 200.42192 203.78612 208.24832 212.14352 216.46262 221.00581 222.95969 227.70088 232.19998 236.83408 239.05348 244.33379 246.55319 251.18729 255.83939 259.18649 263.92679 267.94891 270.1683 273.4794 276.78149 281.47861 288.43921 290.6586 295.461 300.20309 305.2962 310.4433 315.7236">tempSsLIP = shadow_stack_load 8 bytes from SSP+8;</tspan><tspan y="-559.98395" x="112.67999 116.0631 120.744 127.7001 132.31979 137.10689 141.84898 146.97809 149.19748 154.32658 156.54597 160.56807 165.31017 169.79126 174.41096 179.14406 186.10016 190.60106 194.62315 198.00626 202.48735 206.40144 210.69354 215.25565 217.18974 221.92284 226.36253 231.03264 233.25203 238.47203 240.69142 245.36153 250.04962 253.43272 258.11362 262.13571 264.35513 267.70224 270.97733 275.71042 282.6665 284.88593 289.62802 294.43042 299.55951">tempSSP = shadow_stack_load 8 bytes from SSP;</tspan><tspan y="-547.98425" x="112.67999 117.45899 122.23799 127.35899 129.5784 134.6994 136.91881 141.69781 146.43993 151.56093 153.78033 158.95534 161.17474 166.43974 171.70474">SSP = SSP + 24;</tspan><tspan y="-535.98456" x="112.67999 115.31879 119.3409 121.5603 127.0863 131.80229 134.0217 139.27769 144.53369 146.7531 151.4061 153.3501 156.71609 158.9355 162.8325 167.54851 174.4875 179.1405 183.60451 186.9066 191.6136 193.83301 197.19901 201.91501 204.13441 208.78741 213.49442 216.86041 221.56741 225.46442 228.8403 231.05969 235.6794 237.66121 241.04251 245.06281 247.2822 251.9505 256.63138 261.31769 266.04898 270.79108 275.47018 277.68961 282.90961 288.18991 290.40933 295.07764 299.75851 301.7178 306.4599 311.1282 313.34763 317.36792 322.0488 325.43008 327.64951 331.6788">(* Do 64 bit compare to detect bits beyond 15 being set *)</tspan><tspan y="-523.98486" x="112.68 116.1 120.7809 127.7235 132.3801 137.0997 141.87331 144.09271 149.20831 151.42772 156.14732 160.92093 162.78754 165.00694 167.59354 171.61113 173.83054 177.99214 182.70274 185.96434 190.68394 192.89969 197.6301 202.36769 205.7571 210.4875 215.2809 219.9006 224.63101 229.25072 231.47011 234.85951 239.59891 241.8183 247.0977 252.3177 254.53709 259.2135 261.13501 264.52441 266.7438 270.78122">tempCS = CS; (* zero extended to 64 bit *)</tspan><tspan y="-511.98517" x="112.67999 114.76979 119.48759 121.70699 125.07479 129.78358 136.72438 141.37918 146.09698 150.86879 153.0882 154.827 159.9408 162.1602 165.5802 170.26111 177.2019 181.8567 186.62851 190.63531 195.35312">IF tempCS != tempSsCS</tspan><tspan y="-499.98547" x="130.67999 135.85229 141.6906 146.4039 152.2422 154.46161 160.2189 164.93221 170.0415 172.62181 177.33511 182.93042 188.34572 191.22662 196.64192 201.35522 206.52753 209.64783 211.73312 217.14842 221.86172 227.03403 229.61433 231.53404 233.75345 238.46675 240.55205">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-487.98578" x="112.67999 115.27739 119.30579 121.52518 127.06558 131.74649 133.96588 139.23628 144.50668 146.72607 151.34578 153.32759 156.70799 158.92738 162.83879 167.56918 174.46948 179.14859 183.58829 186.89038 191.57129 193.43158 195.65097 200.31837 204.75807 209.42548 211.64487 216.37527 221.11737 226.44177 232.05417 236.79626 241.56 246.70979 252.16919 254.24098 259.4025 261.62192 268.54471 270.52649 273.87628 278.67871 280.89813 286.13794 288.35736 291.71619 296.39709 299.69919 301.91861 307.15842 312.43872 314.65814 319.33725 321.25876 324.60855 326.82797 331.32709 336.90707 339.1265 343.1243">(* Do 64 bit compare; pad CSBASE+RIP with 0 for 32 bit LA *)</tspan><tspan y="-475.98608" x="112.67999 114.78329 119.5146 121.73399 126.46529 131.2074 136.5327 142.1127 146.89799 151.5789 153.79829 158.9796 161.19899 166.63229 168.7356 173.8629 176.08229 177.83459 182.9619 185.18129 188.56259 193.2849 200.1852 204.8643 209.6496 213.61139 218.0817 220.185">IF CSBASE + RIP != tempSsLIP</tspan><tspan y="-463.98639" x="130.67999 135.85229 141.6906 146.4039 152.2422 154.46161 160.2189 164.93221 170.0415 172.62181 177.33511 182.93042 188.34572 191.22662 196.64192 201.35522 206.52753 209.64783 211.73312 217.14842 221.86172 227.03403 229.61433 231.53404 233.75345 238.46675 240.55205">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-451.98669" x="112.67999 115.31879 119.3409 121.5603 125.46179 130.2363 134.9478 138.8493 143.1288 145.34821 147.29671 150.63121 152.85062 158.11111 160.33052 164.98802 169.66353 173.03403 177.74553 179.96494 184.43344 186.35493 188.30344 192.96094 197.73544 202.44695 207.10445 209.32385 213.34235">(* check if 4 byte aligned *)</tspan><tspan y="-439.987" x="112.67999 114.77609 119.50019 121.71959 125.09369 129.80879 136.70909 141.3882 146.13031 150.93272 156.05283 158.27223 163.87833 169.72743 175.26154 177.48094 182.74504 187.48264 192.74673 194.96614 196.71124 201.83134 204.05075">IF tempSSP AND 0x3 != 0</tspan><tspan y="-427.9873" x="130.67999 135.85229 141.6906 146.4039 152.2422 154.46161 160.2189 164.93221 170.0415 172.62181 177.33511 182.93042 188.34572 191.22662 196.64192 201.35522 206.52753 209.64783 211.73312 217.14842 221.86172 227.03403 229.61433 231.53404 233.75345 238.46675 240.55205">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-415.98761" x="76.679993 81.414894 83.521797">FI;</tspan><tspan y="-403.98792" x="58.61969 63.354591 65.461494">FI;</tspan><tspan y="-391.98822" x="76.679993 80.099998 84.780899 91.7118 96.356697 102.07259 103.98149 108.62639 113.33429 118.43819 122.93729 125.15668 130.26059 132.48 137.1879 142.3494 146.7963">tempOldCPL = CPL;</tspan><tspan y="-367.98792" x="76.679993 81.407692 86.531395 90.998093 93.157196 94.914894 100.0386 102.258 107.68771 112.4064 115.7841 120.5658 123.8355 128.6172 133.29811 138.03932 142.65903 147.39934 152.14143 156.8403 161.51221 168.41251 173.13841 177.88051 181.26541 186.05431 190.73521 192.65671 197.38261 201.29851 204.68341 209.4183 212.66011 215.2395 220.67641 225.80731 230.24612 232.82552">CPL := ReturnCodeSegmentSelector(RPL);</tspan><tspan y="-355.98822" x="76.68 81.417603 86.209206 91.342804 93.501907 95.269508 100.40311 102.62251 106.01012 110.69102 117.65162 122.27132 127.00892 131.75102 136.88463">ESP := tempESP;</tspan><tspan y="-343.98853" x="76.68 81.432899 86.235298 88.454697 90.183594 95.278496 97.497894 100.84679 105.5871 112.509 117.1881 121.94099 126.74339">SS := tempSS;</tspan><tspan y="-331.98883" x="76.68 80.063103 84.744003 91.700104 96.319801 102.0609 103.995 108.61469 113.40179 118.1889 123.31799 125.53739 130.66649 132.88588 137.67297 142.41507 147.54417">tempOldSSP = SSP;</tspan><tspan y="-319.98914" x="76.68 78.789597 83.527199 85.746605 90.538208 95.280312 99.765915 104.38561 109.12321 116.02351 120.81512 124.20272 128.68832 132.60692 136.86662 141.60782 146.34991 150.84901 155.46872 157.39021 162.11882 166.73853 169.34312 174.08072 179.21432 183.69092">IF ShadowStackEnabled(CPL)</tspan><tspan y="-307.98944" x="94.68 96.767998 101.484 103.7034 108.4194 113.5314 117.9864 120.2058 125.3178 127.5372">IF CPL = 3</tspan><tspan y="-295.98975" x="112.68 117.8874 123.7086 128.457 134.2782 136.4976 139.85732 144.59761 151.49791 156.177 160.9794 165.7215 170.82269 172.9818 174.76019 179.86139 182.0997 184.2066 189.8235 195.0984 200.31841 204.88231 210.01321 214.48712 219.70712 224.27103 229.05992 233.84882 238.97972 240.86162 243.08101 247.7619 249.8625">THEN tempSSP := IA32_PL3_SSP; FI;</tspan><tspan y="-283.99005" x="94.68 96.784203 101.5164 103.6755 107.0577 111.7809 118.6812 123.3603 128.1024 132.9048 138.033 140.80321 146.07541 151.29541 153.05762 158.27762 163.54982 166.32002 168.53941 170.29262 175.42082 177.64021">IF tempSSP[63:32] != 0</tspan><tspan y="-271.99036" x="112.68 117.8604 123.70679 128.42819 134.2746 136.494 142.2594 147.5298 152.6472 155.2356 160.49699 163.08539 164.95378 167.17319 171.89459 173.98799">THEN #GP(0); FI;</tspan><tspan y="-259.99066" x="94.68 99.465302 104.2506 109.3779 111.537 113.2983 118.4256 120.645 124.02631 128.74861 135.70291 140.32262 145.10791 149.85001">SSP := tempSSP</tspan><tspan y="-247.99097" x="76.68 81.414902 83.521805">FI;</tspan><tspan y="-235.99127" x="76.68 79.282799 83.316597 85.536003 91.357208 96.098412 102.99871 105.21812 109.89091 114.33062 118.35542 121.74123 123.96063 128.44443 130.38123 132.31802 134.53741 137.83681 142.33591 147.078 148.9995 152.3853 154.30681 159.0966 163.71631 165.9357 170.60851 175.2894 177.2532 182.043 185.4288 189.4536 191.3364 193.5603 197.56531 202.02931 205.35931 210.06631 212.28572 215.65172 220.36772 222.58713 225.91713 229.21922 233.92622 238.63322 240.85263 244.21863 248.98863 253.69563 255.91504 259.28104 263.99704 268.27203 272.97903 277.74902 279.48962 281.70901 286.884 291.65399 296.36099 298.58038 301.94638 306.66238 310.93738 315.66058 320.4162 322.63559 325.99442 329.23621 333.9288 338.6691 340.88849 342.81808 346.80869 349.02808 353.70718 358.44839 363.20398 367.94427 370.16367 374.91925 378.90985 380.83945 385.64185 390.32095 392.54034 395.89194 400.64752 405.38782 407.60721 412.30881 414.2114 418.8905 421.10989 425.91229 430.65442">(* Now past all faulting points; safe to free the token. The token free is done using the old SSP</tspan><tspan y="-223.99158" x="76.680878 78.900284 82.933182 85.152588 89.63549 94.377594 99.049492 101.2689 106.0578 110.0196 111.9825 116.7246 121.3965 123.61591 128.0556 130.27499 134.29889 139.08778 143.70749 148.4478 151.7247 156.3786 158.30011 162.3222 167.0571 170.334 172.55339 177.28828 181.94218 186.62309 189.9252 193.2021 195.16501 199.78471 204.52502 206.74442 211.18411 215.20621 217.4256 222.16049 224.04059 228.66029 230.8797 235.60291 240.72211 245.18431 247.40372 254.34991 258.82111 262.83331 265.0527 269.5239 271.74329 275.75549 280.53268 285.19287 289.90707 293.17227 297.81448 299.76569 303.77789 308.5011 311.70059 313.92001 318.59912 321.84091 323.82269 328.4415 330.36389 332.34479 337.03018 341.70929 346.39468 348.61411 350.50949 355.24979 359.86319 364.54858 366.52948 368.7489 372.7413"> * and using a supervisor override as old CPL was a supervisor privilege level *)</tspan><tspan y="-211.99188" x="76.680893 78.791389 83.529892 85.749298 90.541801 95.283905 99.770409 104.39011 109.12861 116.02891 120.82141 124.20992 128.69641 132.61591 136.87561 141.61681 146.3589 150.858 155.47771 157.3992 162.12871 166.74841 169.35391 172.74242 177.42332 184.38393 189.00363 194.76184 196.70134 201.32104 206.05954 211.19405 215.67154">IF ShadowStackEnabled(tempOldCPL)</tspan><tspan y="-199.99219" x="94.680893 99.400497 104.1921 108.81181 113.5521 117.4617 120.8403 125.52121 130.20032 134.75792 138.13652 142.86513 147.15273 151.83363 156.63605 161.19365 165.84125 170.31784 172.24744 176.98953 181.72984 183.94923 189.07384 191.29323 194.67183 199.39143 206.29173 210.97084 216.66875 218.59024 223.25584 227.99796 232.78055 237.90515 240.12454 242.08115 244.30054 249.58174 255.28325 260.02536 265.18686 269.74445 275.02563 277.12622 282.2247 284.44409 287.0397 291.06631 293.28571 297.95129 302.73389 306.69571 311.3757 313.59509 318.26068 320.18219 323.56079 325.78018 328.61877 330.83817 335.45786 337.43967 340.81827 343.03766 347.70325 352.38416 356.40176 358.35837 361.73697 363.65848 368.38708 373.12918 375.34857 380.61719 382.83658 385.67517 387.89456 394.84616 399.58826 403.60587 406.98447 409.20386 413.86945 418.55035 420.76974 424.78735 429.50696 432.88556 435.10495 439.13156">expected_token_value = tempOldSSP | BUSY_BIT (* busy bit - bit position 0 - must be set *)</tspan><tspan y="-187.99249" x="94.680893 99.457191 104.17049 111.11579 115.66709 119.03939 123.76169 128.04298 132.75629 137.53259 142.08389 146.72519 151.1955 153.11879 157.8951 162.6084 164.8278 169.94611 172.16551 175.53781 180.25111 187.19641 191.85571 197.58601 199.50931 204.16861 208.86119 213.6384 218.7576 220.97701 223.19641 225.41582 227.63522 229.85463 232.07404 234.29344 236.51285 238.73225 240.95166 243.17107 245.39047 247.60988 249.82928 252.04869 254.2681 256.48749 258.70688 260.92627 263.14566 265.36505 267.58444 270.17465 274.19586 276.41525 280.31946 282.24365 286.95786 291.42905 294.69424 296.91364 300.28683 305.06403 309.77823 311.99762 316.65781 321.435 325.4472 330.1254 332.34479 337.00497 338.95618 342.32938 344.54877 348.56998">new_token_value = tempOldSSP                      (* clear the busy bit *)</tspan><tspan y="-175.9928" x="94.680893 98.702995 103.4901 107.9298 112.6089 117.342 124.2423 128.8044 132.82649 136.20959 140.64929 144.56339 148.85548 153.35638 155.33728 160.01817 163.91786 168.20996 172.71086 176.62495 183.58105 188.25116 192.98875 196.90285 201.68994 206.30965 211.58995 216.26006 218.86015 222.24326 226.92416 233.88026 238.55037 244.24828 246.16977 250.83987 255.58197 260.36908 265.49817 267.33328 269.5527 274.33981 279.0639 285.9642 290.52542 293.90851 298.6416 302.93372 307.65781 312.3999 316.96112 321.61322 326.09433 328.02844 332.77054 337.49463 339.32974 341.54916 346.27325 351.01086 355.68097 360.36185 364.27594 367.65903 372.3399 377.01901 381.51993 384.93991 389.62082 393.93994 398.62082 403.42322 407.92413 412.60324 417.04294 418.96445 423.75156 428.43243">shadow_stack_lock_cmpxchg8b(tempOldSSP, new_token_value, expected_token_value)</tspan><tspan y="-163.9931" x="76.680893 81.415794 83.522697">FI;</tspan><tspan y="-151.99341" x="58.62059 63.355492 65.462395">FI;</tspan><tspan y="-127.99311" x="58.62059 63.36269 69.112793 74.512794 76.732193 81.413094 85.912193 89.835297 94.577393 96.796791 101.59289 106.27379 110.95289 116.35289 121.08599 125.70569 127.92509 129.89519 134.63728 136.85667 139.46577 144.14667 148.94276 150.74187 152.96126 157.70335 162.44545 164.28955 166.50894 171.80005 176.54214 178.34125 180.56064 185.05074 189.79283 194.47192 196.69131 202.24341 207.03951">FOR each SegReg in (ES, FS, GS, and DS)</tspan><tspan y="-115.99341" x="76.680893 82.259094">DO</tspan><tspan y="-103.99371" x="94.680893 98.063095 102.744 109.6992 114.31889 119.86109 124.54199 128.56319 132.47638 134.63547 136.39767 141.52588 143.74527 148.41447 153.09538 157.11658 161.02979 164.30399 166.22549 170.8947 174.2769 178.95779 182.25989 184.47928 188.39249 192.83218 196.74539 201.53159 206.21249 208.43188 211.77809 216.51028 219.78448 222.00388 226.74597 231.48628 236.15549 241.58969 246.2706 250.94971 253.1691 255.7683 259.79849 262.01788 266.80408 268.72559 273.39478 278.01447 282.73767 287.47977 289.69916 294.36835 298.80804 302.08224 305.46445 307.68384 312.41605 315.71542 317.93481 321.95602 326.63693 331.30612 338.26132 342.94223 347.74463 351.12683 353.34622 356.62042 361.34363 365.96332 367.94513 371.96634 375.34854 380.02945 383.33154 385.55093 389.58115">tempDesc := descriptor cache for SegReg (* hidden part of segment register *)</tspan><tspan y="-91.994003" x="94.680893 96.757195 101.4984 103.7178 106.28909 111.09149 115.78679 120.46589 127.39319 132.13348 136.89178 140.31178 145.07008 149.81038 151.71568 156.41098 160.29628 163.65057 168.39177 171.63358 173.85298 179.01448 184.11568 186.33508 192.16438 197.86588 202.30917 206.80827 209.37958 211.59898 217.31128 222.71758 224.93698 227.57579 230.93549 235.63078 242.59138 247.23268 252.81088 257.5062 261.49948 265.3848 267.95609 273.4704 278.57071 283.06979 285.64917 287.86856 292.87885 295.09824 299.80255 304.90286 309.40195 311.62134 317.20764 323.03693 328.61514 330.83453 334.18884 338.88416 345.84476 350.46445 356.04266 360.72357 364.71686 368.60217 371.17346 376.33676 380.99606 385.67517 390.37048 392.94177 395.16116 397.14297 401.16507 403.38446 405.95575 410.63486 415.08716 418.44147 422.94058 425.15997 429.86426 433.16635 435.38574 440.14404 444.88522 449.64352 452.52441 456.40973 461.11401 465.91641 469.21582 473.957 477.19882 484.15942 486.08093 490.88333 495.56244 497.78183 501.66714 506.37146 511.05057 515.73145 518.30273 520.94153">IF (SegmentSelector == NULL) OR (tempDesc(DPL) &lt; CPL AND tempDesc(Type) is (data or non-conforming code)))</tspan><tspan y="-79.994301" x="112.68089 117.89909 123.72029 128.46149 134.28268 136.50209 139.07069 143.0703 145.2897 150.0921 154.77299 159.45209 166.41269 171.10529 175.90768 179.25928 181.47868 184.72229 189.46259 194.10118 196.08298 200.07358 203.42517 208.11777 211.41988 213.63928 215.56888 220.37128 224.99188 229.44148 231.34409 233.32588 238.00497 240.22438 244.22398">THEN (* Segment register invalid *)</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="357.20999pt" height="644.64813pt" viewBox="0 0 357.20999 644.64813" sodipodi:docname="1281.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="345.57943" inkscape:cy="423.77366" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg210" /><g transform="translate(-46.81543,-69.182129)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="131.52 136.3071 140.98801 145.65811 152.61421 157.29512 162.09752 165.48062 170.22272 174.94682 176.88092 181.60503 185.51912 188.90222 193.58311 196.85822 199.07761 200.84071 205.96982 208.18921 213.46231 215.34241 217.5618 220.1619 224.19299 228.98009 233.661 238.3311 245.2314 249.95551 254.6976 258.08069 260.30011 264.2619 269.0022 270.93631 275.61719 279.53128 282.91437 287.59528 290.89737 293.11679 297.73648 302.47678 306.39087 311.07178 318.02786 322.70874 326.73083 328.95026 333.73737 338.47946 340.41357 342.34769 346.37878">SegmentSelector := 0; (*Segment selector becomes null*)</tspan><tspan y="-703.98029" x="95.520004 100.25491 102.36181">FI;</tspan><tspan y="-691.98059" x="77.520004 83.257507 88.797005">OD;</tspan><tspan y="-667.98029" x="59.520004 61.617905 66.343803 68.563202 70.517105 75.297005 79.311905 82.687805 85.955704 90.735603 94.642502 98.018402 99.972305 104.65321 109.43311 111.6525 116.4324 120.9063 124.9212 127.1406 129.0945 136.0434 142.9437 147.68401 152.30371 154.28551 158.7594 162.1353 166.8522 169.07161 173.79752 178.41722 183.13412 186.40202 190.87592 195.65582">IF instruction has immediate operand</tspan><tspan y="-655.98059" x="77.520004 82.700401 88.546799 93.268196 99.114594 101.33399 103.92239 107.9418 110.16119 115.58459 120.297 122.2194 126.9318 131.4012 135.41161 140.12401 142.34341 147.00182 151.47122 154.73462 159.20403 166.14842 170.86082 174.23222 178.94463 182.20802 186.21843 188.43784 191.77324 194.99969 199.73639 206.63669 208.85608 212.77377 217.25847 219.19617 221.13387 223.05537 227.84607 232.51978 234.73917 239.35887 242.66098 247.34187 251.24156 255.96927 260.58899 265.3797 268.62149 273.34918 274.91159 278.93729 281.15671 285.1824 288.56909 293.00879 296.90848 301.20416 303.42358 307.45828">THEN (* Release parameters from calling procedure’s stack *)</tspan><tspan y="-643.9809" x="95.519997 97.631393 102.3708 104.5902 109.38361 112.773 117.21271 121.11241 125.37212 131.01152 135.63123 140.31033 143.55214 148.29245 152.32085 156.28264 161.07603 162.99754 167.17894">IF StackAddressSize</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-643.97998" x="171.84"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-643.97998" x="174.35988">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-643.97998" x="179.82001"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-643.97998" x="182.04031 187.32062">32</tspan><tspan y="-631.98029" x="113.52061 118.72981 124.55101 129.30121 135.12241">THEN </tspan><tspan y="-619.98059" x="131.52061 136.25281 141.039 146.16721 148.3866 150.1488 155.27701 157.4964 162.22861 166.9707 172.09891">ESP := ESP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-619.98059" x="174.30032">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-619.98059" x="179.22063 181.44002 186.23341 191.63342 196.31432"> SRC;</tspan><tspan y="-607.9809" x="113.52062 118.24922 122.71682 127.49942 132.22803 134.44742 137.04301 141.06961 143.289 148.0311 151.39079 155.86739 159.77699 164.06459 169.67519 174.34079 179.00639 182.27699 186.9966 190.95839 194.97598 199.75858 201.68008 205.88127 210.56218">ELSE (* StackAddressSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-607.97998" x="212.75999">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-607.97998" x="218.28"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-607.97998" x="220.50031 225.77071 230.99071 233.2101 237.23849">16 *)</tspan><tspan y="-595.98029" x="131.52 136.30261 141.42722 143.64661 145.40521 150.52982 152.74921 157.4913 162.5925">SP := SP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-595.98029" x="164.82001">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-595.98029" x="169.79971 172.0191 176.7648 182.22421 186.91591"> SRC;</tspan><tspan y="-583.98059" x="95.52002 100.25492 102.36182">FI;</tspan><tspan y="-571.9809" x="59.52002 64.254921 66.361824">FI;</tspan><tspan y="-547.98059" x="46.02002 48.61562 52.64222 54.861622 56.962223 62.572823 65.411423 70.680023 75.948624 80.629532 82.84893 89.431534 94.112434 98.778038 103.45894 105.67834 109.70494">(* IA-32e Mode *)</tspan><tspan y="-535.9809" x="59.52002 61.600819 66.309616 68.529022 71.10482 76.209618 80.918419 83.137825 88.242622 90.462029 95.710831 97.930237 102.38704 107.18944 111.83524 114.05464 119.75614 126.29644 128.51584 133.67734 135.89674 141.14554 143.36494 147.86404 152.60614 157.25194 159.47134 161.55214 167.14294 172.39174 177.64053 182.17833 186.88713 191.59593 196.30473 201.71553 203.45613 207.90393 214.50453 220.09534 222.31474 227.41954 229.63895 234.88774 237.46355 239.68295 244.13976 248.94215 253.58795 255.80736 257.74417 262.54657 266.54437 269.96436 273.21515 278.01755 281.90735 285.26614 287.20294 291.91174 296.67453 298.89392 304.05542 306.27481 309.59763 314.09671 317.3475 319.56689 322.81769 327.55798 330.91678 335.71918 338.96997">IF (PE = 1 and VM = 0 and IA32_EFER.LMA = 1) and instruction = far return</tspan><tspan y="-523.9812" x="77.52002 82.729218 88.550415 93.300613">THEN</tspan><tspan y="-511.98151" x="95.52002 97.587318 102.32851 104.54791 110.25121 114.93031 119.61662 122.91871 127.36201 132.16441 136.79671 141.59911 143.5224 147.7236 152.4099 154.62929 159.79079 162.01018 167.24548">IF OperandSize = 32</tspan><tspan y="-499.98181" x="113.52002 118.72922 124.55042 129.30061 135.12181">THEN </tspan><tspan y="-487.98212" x="131.52002 133.62512 138.35822 140.57761 144.5997 149.32381 153.2379 157.97099 162.75809 167.42819 169.64758 174.31769 178.99858 183.78568 188.40538 190.38628 195.06718 202.02328 206.70418 209.97928 214.56032 216.77972 221.49753 226.26933 228.48874 232.49554 235.86334 240.32915 244.22795 248.50475 250.72415 252.66995 256.67676 258.89615 263.66794 268.38574 271.75354 273.97293 280.91373 282.85953 286.22733 290.99911 292.94492 297.71671 299.9361 303.9429 307.3107 311.77649 315.67529 319.99438 322.21378 324.13257 326.07837 333.01917 334.96497 338.33276">IF second doubleword on stack is not within stack limits</tspan><tspan y="-475.98242" x="149.52002 154.70403 160.55403 165.27904 171.12904 173.34845 179.11745 183.89645 188.63857 191.21796 196.48296 199.07495 200.94695 203.16635 207.89136 209.98836">THEN #SS(0); FI;</tspan><tspan y="-463.98273" x="131.52002 133.60892 138.32582 140.54523 143.87613 145.82103 149.07993 153.08583 156.45273 158.67213 163.38904 166.64793 168.86734 172.87325 177.61354 181.51144 186.22835 191.03075 195.70985 197.92926 202.58316 207.30006 212.07097 216.72487 218.64276 223.35066 230.29056 235.00746 238.26636 242.92026 245.13966 249.85657 254.64001 256.85944 260.88333 264.26822 268.70792 272.6076 276.90152 279.12094 281.04242 285.06451 287.28394 292.07285 296.75375 300.13864 302.35806 304.32095 309.06305 311.28247 315.19836 319.68127 324.42337 329.16455 333.95346 335.87494 339.79083 344.27374 346.20966 348.42908 352.39087 357.06998 361.50967 365.40936">IF first or second doubleword on stack is not in canonical space</tspan><tspan y="-451.98303" x="149.52002 154.70403 160.55403 165.27904 171.12904 173.34845 179.11745 183.89645 188.63857 191.21796 196.48296 199.07495 200.94695 203.16635 207.89136 209.98836">THEN #SS(0); FI;</tspan><tspan y="-439.98334" x="113.52002 118.25312 122.72522 127.51232 132.24542">ELSE </tspan><tspan y="-427.98364" x="131.52002 133.58733 138.32852 140.54791 146.25121 150.9303 155.61659 158.9187 163.362 168.1644 172.79669 177.59909 179.58089 183.72179 188.40808 190.62747 195.78897 198.00836 203.24367">IF OperandSize = 16</tspan><tspan y="-415.98395" x="149.52002 154.72922 160.55042 165.30061">THEN</tspan><tspan y="-403.98425" x="167.58032 169.67192 174.39153 176.61093 180.61954 185.33014 189.23074 193.95035 198.72395 203.38055 205.59996 212.54256 217.26216 220.52376 225.18036 227.39977 232.11937 236.89297 239.11238 243.07419 246.49419 250.96179 254.8624 259.14099 261.36032 263.30792 267.31653 269.5368 274.31039 279.03 282.3996 284.61987 291.56247 293.51007 296.87967 301.65326 303.60086 308.37445 310.59473 314.60333 317.97293 322.44052 326.34113 330.66113 332.88141 334.802 336.7496 343.6922 345.6398 349.0607">IF second word on stack is not within stack limits</tspan><tspan y="-391.98456" x="185.58032 190.76433 196.61433 201.33934 207.18935 209.40875 215.17775 219.95676 224.69887 227.27826 232.54326 235.13525 237.00725 239.22665 243.95166 246.04866">THEN #SS(0); FI;</tspan><tspan y="-379.98486" x="167.58032 169.67462 174.39693 176.61633 179.95264 181.90294 185.16724 189.17854 192.55084 194.77025 199.49255 202.75685 204.97626 208.98756 213.70087 217.60417 222.32648 227.10278 231.76208 233.98149 240.92679 245.64909 248.91339 253.57269 255.7921 260.5144 265.29071 267.51013 271.52142 274.86032 279.30002 283.19971 287.49542 289.71484 291.63632 295.65842 297.87784 302.66855 307.34946 310.73615 312.95557 314.92026 319.66235 321.88177 325.79947 330.28418 335.02628 339.76746 344.55817 346.47964 350.39734 354.88205 356.81976 359.03918 363.00098 367.68008 372.16479 376.08249">IF first or second word on stack is not in canonical space</tspan><tspan y="-367.98517" x="185.58032 190.76433 196.61433 201.33934 207.18935 209.40875 215.17775 219.95676 224.69887 227.27826 232.54326 235.13525 237.00725 239.22665 243.95166 246.04866">THEN #SS(0); FI;</tspan><tspan y="-355.98547" x="149.52002 154.26122 158.70001 163.50241 168.24361 170.46301 173.02802 177.02402 179.24342 184.94942 189.62851 194.3175 197.61961 202.06561 206.86801 211.50301 216.3054 218.2314 222.4326">ELSE (* OperandSize</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-355.98001" x="227.10001"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-355.98001" x="229.56">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-355.98001" x="234.66"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-355.98001" x="237.17999 242.42609 247.70638 249.92578 253.92989">64 *)</tspan><tspan y="-343.98032" x="167.58029 169.68629 174.42029 176.63968 179.98769 181.90919 185.151 189.1731 192.5571 194.77649 199.51048 202.75229 204.97168 208.99467 213.71968 217.63467 222.31557 227.10356 231.77457 233.99396 238.61366 243.41606 247.85576 252.53487 259.43515 264.17636 267.41815 272.09723 274.31662 279.05063 283.79272 286.01212 290.03513 293.41913 297.90112 301.81613 306.07584 308.29523 310.21674 314.23886 316.45825 321.24625 325.92715 329.31116 331.53055 333.45206 338.25446 340.47385 344.38885 348.82855 353.61655 358.29745 363.08545 365.00696 368.92197 373.40396 375.33896 377.55835 381.58136 386.20105 390.68304 394.59805 399.27896">IF first or second quadword on stack is not in canonical space </tspan><tspan y="-331.98062" x="185.58029 190.7643 196.6143 201.33931 207.18932 209.40872 215.17772 219.95673 224.69884 227.27823 232.54323 235.13522 237.00722 239.22662 243.95163 246.04863">THEN #SS(0); FI;</tspan><tspan y="-319.98093" x="131.51999 136.26118">FI</tspan><tspan y="-307.98123" x="95.519989 100.25489 102.36179">FI;</tspan><tspan y="-295.98154" x="77.519989 79.606186 84.320389 86.539787 89.79599 94.536293 97.90049 102.70289 105.95909 110.72729 112.94669 116.8419 121.5561 126.2073 130.91251 133.13191 137.13512 141.87541 146.52661 153.47998 158.18248 162.98488 166.34637 168.56578 172.56628 177.26878 179.18129 183.92159 187.81409 191.17558 195.91678 199.15857 201.37798 203.35977 207.32158 209.54099 215.42159 221.06279 225.56189">IF return code segment selector is NULL</tspan><tspan y="-283.98184" x="95.519981 100.73818 106.55938 111.28168 117.12897 119.34837 124.61967 129.73798 132.32727 137.58957 140.17886 142.04816 144.26756 148.98987 151.08417">THEN GP(0); FI;</tspan><tspan y="-271.98215" x="77.519981 79.606178 84.320381 86.53978 89.795982 94.536285 97.900482 102.70289 105.95909 110.72729 112.94669 116.8419 121.5561 126.2073 130.91251 133.13191 137.13512 141.87541 146.52661 153.46381 158.16901 162.97141 166.3356 168.55501 172.55821 177.26341 179.17862 183.89998 187.81407 191.19717 195.93027 199.20537 201.42476 205.86446 210.53456 215.20467 218.47977 223.20387 227.16566 231.18776 235.91187 239.87366 242.09305 246.76315 251.48726 255.44905 259.34875 262.62384 264.54532 269.21542 272.59851 277.3316 280.60669 282.82611 287.49622 292.14029 296.79599 301.5372 306.2919 310.97101 313.1904 317.82809 322.56842 326.59052 330.49023 333.73294 335.71475 340.35245 343.70316 348.44437 351.68619 353.90558 357.32559 361.76529 366.4444 368.36591 373.05762 375.27701 377.17871 379.16052 386.08423 388.06604 391.41675">IF return code segment selector addresses descriptor beyond descriptor table limit </tspan><tspan y="-259.98245" x="95.519989 100.72469 106.54588 111.29158 117.11278 119.33218 124.62688 129.72807 132.30748 136.32957 141.06627 143.01297 147.69386 151.59357 154.95328 159.69447 162.93628 165.51569 167.40839 169.62778 174.30867 176.40927">THEN GP(selector); FI;</tspan><tspan y="-247.98276" x="77.519989 79.622391 84.352791 86.572189 89.844589 94.565987 97.946388 102.73079 106.00319 110.74529 112.96469 116.87609 121.60649 126.27389 130.95479 133.17418 137.19357 141.91498 146.53468 153.49529 158.17619 162.97859 166.35899 168.57838 172.59778 177.27869 179.21008 183.93149 187.8429 191.2233 195.9537 199.2261 201.4455 205.88519 210.5526 215.22 218.4924 223.21381 227.1756 231.19499 235.9164 239.87819 242.09758 246.76498 251.48639 255.44818 259.3479 262.6203 264.54181 269.2092 272.5896 277.32001 280.59241 282.8118 284.7702 289.5123 291.73169 296.51608 301.19699 305.98138 308.82178 312.73318 317.17288 321.95728 326.68768 331.42978 333.41159 337.323 341.7627 343.69409 345.91348 349.93289 354.60028 359.03998 362.9397">IF return code segment selector addresses descriptor in non-canonical space</tspan><tspan y="-235.98306" x="95.519989 100.72469 106.54588 111.29158 117.11278 119.33218 124.62688 129.72807 132.30748 136.32957 141.06627 143.01297 147.69386 151.59357 154.95328 159.69447 162.93628 165.51569 167.40839 169.62778 174.30867 176.40927">THEN GP(selector); FI;</tspan><tspan y="-223.98337" x="77.519989 83.278191 87.897888 91.317894 95.757599 97.739395 102.4815 104.7009 109.34489 114.04289 118.03889 121.9269 125.1759 127.15769 131.8017 135.22169 139.9287 143.23079 145.4502 148.80719 153.51419 155.7336 162.6636 167.466 169.401 173.289 178.0914 180.31081 183.5598 188.28029 191.64359 196.41089 199.71298 204.45508 206.67448 210.56879 215.28209 219.93239 224.63669 226.85609 230.8584 235.5627 240.213 247.14929 251.85359 256.62088 259.98419 262.20358 266.20587 270.91019 272.82449 277.52881 281.4231 284.78641 289.49969 292.80182 295.02121 299.67151 304.44058 306.40167 311.14377 314.52686 318.54895 320.76837 324.11548 327.39056 332.12366 339.02396 341.24338 345.91348 350.59436 354.61646 358.53055 361.80563 363.72711 368.39722 371.7803 376.46121 379.76331 381.98273 385.36581 389.80551 394.47562 396.40973 401.13382">Obtain descriptor to which return code segment selector points from descriptor table;</tspan><tspan y="-211.98367" x="77.520874 79.607071 84.321274 86.540672 89.796875 94.537178 97.901375 102.70377 105.95998 110.72818 112.94758 116.84278 121.55698 126.20818 130.91339 133.1328 137.136 141.8763 146.5275 153.46469 158.16989 162.97229 166.33649 168.55589 173.20709 177.91229 181.9155 185.8107 189.06689 191.04057 195.67467 199.09468 203.79178 207.09389 209.31329 211.23839 215.26048 217.47989 222.23099 226.97218 230.31929 232.5387 237.0378 239.2572 243.1353 247.8324 252.51149 257.19238 259.41177 263.4339 268.17419 272.80829 279.76889 284.457 289.2594 292.60651">IF return code segment descriptor is not a code segment </tspan><tspan y="-199.98398" x="95.520874 100.70397 106.55307 111.27717 117.12627 119.34566 125.11376 130.38686 135.50696 138.09805 142.11116 146.82626 148.75136 153.43227 157.33737 160.71147 165.43558 168.70168 171.29277 173.16386 175.38327 180.06418 182.16478">THEN #GP(selector); FI;</tspan><tspan y="-187.98428" x="77.520874 79.621475 84.362671 86.582069 89.822968 94.563271 97.91217 102.71457 105.95547 110.70837 112.92776 116.80766 121.54886 126.22796 130.90886 133.12827 137.15036 141.89066 146.52655 153.48715 158.17705 162.97945 166.32835 168.54776 173.22685 177.90775 181.92984 185.82954 189.07045 191.05225 195.68814 199.10815 203.80705 207.10916 209.32857 214.08147 218.58057 222.56847 224.78787 229.28697 232.10757 236.74347 238.72527 242.07417 244.29358 249.38847 251.60788 256.88818 259.10757 263.55447 268.35687 273.03598 275.25537 280.76428 283.57318 288.20908 290.19089 293.53979 295.75919 300.8541 303.07349 308.35379">IF return code segment descriptor has L-bit = 1 and D-bit = 1 </tspan><tspan y="-175.98459" x="95.520874 100.70397 106.55307 111.27717 117.12627 119.34566 125.11376 130.38686 135.50696 138.09805 142.11116 146.82626 148.75136 153.43227 157.33737 160.71147 165.43558 168.70168 171.29277 173.16386 175.38327 180.06418 182.16478">THEN #GP(selector); FI;</tspan><tspan y="-163.98489" x="77.520874 79.606171 84.319473 86.538879 89.794182 94.534485 97.897781 102.70019 105.95549 110.72279 112.9422 116.8365 121.5498 126.2001 130.9044 133.12381 137.12611 141.86641 146.51671 153.453 158.1573 162.9597 166.323 168.5424 172.54471 177.24901 179.16331 183.90361 187.79791 191.16121 195.87451 199.12981 201.34921 206.76451 211.92601 216.37831">IF return code segment selector RPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-163.98489" x="218.58057">&lt;</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-163.98489" x="223.50087 225.72028 230.43358 235.54288 239.99518"> CPL </tspan><tspan y="-151.9852" x="95.520866 100.70396 106.55306 111.27716 117.12626 119.34566 125.11375 130.38686 135.50696 138.09805 142.11116 146.82626 148.75136 153.43227 157.33737 160.71147 165.43558 168.70168 171.29277 173.16386 175.38327 180.06418 182.16478">THEN #GP(selector); FI;</tspan><tspan y="-139.9855" x="77.520866 79.598969 84.305069 86.524467 89.772568 94.512863 97.868965 102.67136 105.91946 110.67957 112.89896 116.78606 121.49216 126.13526 130.83237 133.05177 137.04688 141.78717 146.43027 153.35938 158.05647 162.85887 166.21497 168.43437 173.07747 177.77457 181.76967 185.65677 188.90486 190.88666 195.52975 198.94975 203.65585 206.95795 209.17735 211.11145 215.10655 217.32596 221.21306 225.91916 230.72156 234.08035 238.78645 242.08855 249.01764 250.99944 255.75954">IF return code segment descriptor is conforming</tspan><tspan y="-127.9858" x="77.520866 82.019966 86.76207 91.411469 93.630875 96.885277 101.62558 104.98798 109.79039 113.04479 117.8112 120.0306 123.9897 128.67061 133.32001 138.02341 140.24281 144.24422 148.98451 153.63391 160.56931 165.27271 170.0751 173.4375 175.65691 181.17931 186.2877 190.7868">and return code segment DPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-127.9858" x="192.96117">&gt;</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-127.9858" x="197.88147 200.10086 203.36966 208.08746 211.46426 216.20636 219.47516 224.21725 226.43665 230.34445 235.07126 239.73506 244.41597 246.63538 250.65117 255.33208 259.99588 266.94568 271.62659 276.42899 279.80579 282.02518 286.04099 290.72189 292.64969 297.36749 301.2753 304.6521 309.37891 312.64771 314.8671 320.2959 325.4187"> return code segment selector RPL</tspan><tspan y="-115.9861" x="95.521774 100.70487 106.55397 111.27807 117.12717 119.34657 125.11466 130.38776 135.50786 138.09895 142.11206 146.82716 148.75226 153.43317 157.33827 160.71237 165.43648 168.70258 171.29367 173.16476 175.38417 180.06508 182.16568">THEN #GP(selector); FI;</tspan><tspan y="-103.9864" x="77.521774 79.600777 84.307777 86.527176 89.776176 94.516472 97.873474 102.67587 105.92487 110.68587 112.90527 116.79327 121.50027 126.14427 130.84227 133.06168 137.05768 141.79797 146.44197 153.37198 158.06998 162.87238 166.22937 168.44878 173.09277 177.79077 181.78677 185.67477 188.92377 190.90556 195.54956 198.96956 203.67656 206.97865 209.19806 211.13306 215.12906 217.34846 222.10947 226.81647 231.61887 234.43947 238.32747 243.03447 247.83687 251.19566 255.90266 259.20477 266.13477 268.11658 272.87756">IF return code segment descriptor is non-conforming</tspan><tspan y="-91.986694" x="77.521774 82.020874 86.762978 91.412376 93.631783 96.886185 101.62649 104.98889 109.7913 113.0457 117.8121 120.03151 123.99061 128.67151 133.32091 138.02431 140.24371 144.24512 148.98541 153.63481 160.57021 165.27361 170.076 173.4384 175.65781 181.18021 186.2886 190.7877">and return code segment DPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-91.980003" x="192.96001 198.95947">≠ </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-91.980003" x="201.72 204.9744 209.71469 213.07709 217.87949 221.13388 225.90028 228.11969 232.01309 236.72549 241.37489 246.07829 248.2977 252.2991 257.0025 261.65192 268.58731 273.29071 278.09311 281.45551 283.6749 287.6763 292.3797 294.29309 299.03339 302.92679 306.28918 311.00159 314.25598 316.47537 321.88977 327.05127">return code segment selector RPL</tspan><tspan y="-79.980301" x="95.519997 100.70309 106.55219 111.27629 117.12539 119.34479 125.11288 130.38599 135.50609 138.09718 142.11029 146.82539 148.75049 153.4314 157.3365 160.7106 165.43471 168.70081 171.2919 173.16299 175.3824 180.06331 182.16391">THEN #GP(selector); FI;</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="298.50067pt" height="644.64355pt" viewBox="0 0 298.50067 644.64355" sodipodi:docname="1282.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.03808" inkscape:cy="423.76758" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg208" /><g transform="translate(-45.721443,-69.182129)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="76.68 78.766197 83.4804 85.699799 88.956001 93.696304 97.060501 101.86291 105.11911 109.92152 112.14091 116.03612 120.75032 125.40152 130.10672 132.32613 136.32933 141.06963 145.72083 152.65802 157.36322 162.16562 165.52982 167.74922 172.40042 177.05969 181.0629 184.9581 188.21429 190.15649 194.80769 198.22769 202.94189 206.24399 208.46339 210.40559 214.4088 216.6282 221.39641 226.11061 229.47481 231.69421 236.34541 239.60161 244.30681 248.31001 253.01521 257.78342 261.14761">IF return code segment descriptor is not present </tspan><tspan y="-703.98029" x="94.679993 99.863091 105.71219 110.43629 116.28539 118.50478 124.27288 130.12198 135.24208 137.83318 141.84628 146.52719 148.45229 153.16739 157.07249 160.44659 165.1707 168.4368 171.02789 172.89899 175.11839 179.8425 181.9386">THEN #NP(selector); FI:</tspan><tspan y="-691.98059" x="76.679993 78.763496 83.474998 85.694405 88.947906 93.68821 97.049713 101.85212 105.10562 109.90803 112.12743 116.01994 120.73144 125.37994 130.08244 132.30185 136.30235 141.04265 145.69115 152.62564 157.32814 162.13054 165.49203 167.71144 171.71194 176.41444 178.32695 183.06725 186.95975 190.32124 195.03275 198.28624 200.50565 205.91914 211.08064 215.53114">IF return code segment selector RPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-691.98059" x="217.6803">&gt;</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-691.98059" x="222.6006 224.82001 229.53331 234.64261 239.09491"> CPL </tspan><tspan y="-679.9809" x="94.680901 99.885605 105.7068 110.4525 116.2737 118.4931 123.7878 129.4857 134.6904 140.38829 142.60768 144.72539 150.30539 153.12599 158.4117 163.6974 168.3783 171.23399 177.77429 183.47218 189.05038 193.73128 196.55188 201.99957 206.68047 211.88516 217.52635 222.97406 228.79526 231.61586 236.83406 242.53197 245.35257 251.10626 256.74747 261.90628 266.64749 272.04749 274.92841 280.0296 285.4296 287.5473 293.24701 295.36472 299.80353 304.48444 309.76474 314.51044 317.33105 321.76987 326.51108 332.21078 336.89169 341.33051">THEN GOTO IA-32E-MODE-RETURN-TO-OUTER-PRIVILEGE-LEVEL;</tspan><tspan y="-667.9812" x="94.680901 99.396004 103.85011 108.6192 113.3343 115.5537 120.8178 126.5409 131.715 137.4381 139.6575 141.7446 147.384 150.20911 155.4642 160.7193 165.4344 168.25951 174.9006 180.6129 186.1272 190.8315 193.6458 199.05209 203.75639 208.91969 214.58699 219.99329 225.87389 228.68819 233.85149 239.56378 242.44469 247.20299 252.78929 259.38989 264.13107 266.94537 272.04568 277.452 279.52829 285.2298 287.33038 291.77368 296.47797 301.73126 306.43555 309.24985 313.74893 318.45325 324.15475 328.85907 333.35815">ELSE GOTO IA-32E-MODE-RETURN-TO-SAME-PRIVILEGE-LEVEL;</tspan><tspan y="-655.98151" x="76.680908 81.405006 83.501106 85.372208">FI; </tspan><tspan y="-643.98181" x="58.620605 63.355507 65.46241">FI;</tspan><tspan y="-619.98151" x="45.120605 47.213104 52.815605 55.646107 60.906609 66.167107 70.887604 73.718102 80.292603 86.021103 91.551605 96.272102 99.1026 104.562 109.2429 114.4224 120.1059 125.5284 131.3739 134.20441 139.38391 145.11241 147.9006 152.6517 158.29111 164.84221 169.5834 172.3905 177.4836 182.94299 185.04359 190.6947 192.76381 197.19991 201.9411 207.18719 211.88429 214.7652 219.20399 223.90109 229.6026 234.3438 238.78259">IA-32E-MODE-RETURN-TO-SAME-PRIVILEGE-LEVEL:</tspan><tspan y="-607.98181" x="45.120605 47.236504 51.917404 54.136806 57.530708 62.272808 67.007706 69.227104 72.468903 77.149803 80.543701 85.285797 88.571693 93.313789 95.533188 97.505089 102.24718 106.28008 109.67398 112.95988 117.70197 121.62688 125.02077 126.99268 131.67357 136.47147 138.69086 143.37175 148.05264 150.02454 154.76663 158.16054 162.89543 166.13724 168.35663 170.32852 174.36142 176.58081 181.32291 186.00031 189.3699 191.58931 198.53191 200.47951 203.84911 208.62271 210.57031 215.34392 217.56332 220.93292 225.70653 230.41713 232.63654 235.89813 240.60873 243.97833 248.75194 252.01353 256.78714 259.02002 262.91882 267.63663 272.29141 277.00021 279.2196 283.22641 287.93521 292.59 299.53079 304.23959 309.01138 312.37918 314.59857 316.51736 318.46317 325.40396 327.34976 330.71756">IF the return instruction pointer is not within the return code segment limit </tspan><tspan y="-595.98212" x="58.61972 63.800121 69.646523 74.36792 80.214317 82.433716 88.19912 93.469521 98.586922 101.17532 106.43672 109.02512 110.89352 113.11292 117.83432 119.92772">THEN #GP(0); FI;</tspan><tspan y="-583.98242" x="45.11972 47.231121 51.912022 54.13142 57.520821 62.26292 66.993324 69.21273 72.454536 77.135437 80.524834 85.266937 88.54834 93.290443 95.50985 97.477249 102.21935 106.24775 109.63715 112.91855 117.66065 121.58105 124.97045 126.93785 131.61874 136.41214 138.63153 143.30794 147.98883 149.95624 154.69833 158.08774 162.81815 166.05995 168.27934 170.24675 174.27515 176.49454 181.23663 185.97783 189.36723 191.58662 198.54903 200.47054 203.85994 208.65334 210.57484 215.37724 217.59663 221.51703 225.95673 230.75012 235.43102 240.22441 242.19182 246.11221 250.55191 252.49231 254.7117 259.1514 263.82779 268.50418 271.74597 276.47638 280.4382 284.46661 286.686 290.71442 295.39081 299.83051 303.72931">IF the return instruction pointer is not within canonical address space</tspan><tspan y="-571.98273" x="58.61972 63.800121 69.646523 74.36792 80.214317 82.433716 88.19912 93.469521 98.586922 101.17532 106.43672 109.02512 110.89352 113.11292 117.83432 119.92772">THEN #GP(0); FI;</tspan><tspan y="-559.98303" x="45.11972 47.218521 51.899422 54.11882 59.853619 64.47332 69.191116 72.459915 76.934715 81.715515 86.379318 91.160118 93.114922 97.283722">IF OperandSize</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-559.97998" x="102"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-559.97998" x="104.46012 109.9202">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-559.97998" x="112.44 117.72031">32</tspan><tspan y="-547.98029" x="58.620003 63.829205 69.650406 74.400604">THEN</tspan><tspan y="-535.98059" x="76.680305 81.395409 83.482506 88.593605 90.752701 92.497803 97.659302 99.8787 104.9898 109.7049 114.357 116.9391 119.5212">EIP := Pop();</tspan><tspan y="-523.9809" x="76.680305 81.410706 86.195107 88.354202 90.114601 95.240997 97.460396 102.58679 107.31719 111.98459 114.58199 117.17938 119.05679 121.27618 123.87358 127.90198 130.12137 135.39177 140.61177 143.45216 148.07187 150.03027 153.41068 155.63007 160.24977 164.99097 169.65837 171.49077 173.71016 178.49455 180.41606 185.08347 189.82556 192.66595 197.39636 200.66876 205.33617 210.05757 213.32997 215.54936 220.81976 226.03976 228.25916 232.92656 234.84807 238.22847 242.24786 244.46725 249.13466 251.05617 255.07556 258.98697 263.46536 266.73776 271.40515 276.08606 280.75345 282.97284 287.00125">CS := Pop(); (* 32-bit pop, high-order 16 bits discarded *)</tspan><tspan y="-511.9812" x="58.620003 63.353104 67.825203 72.612305 77.345406">ELSE </tspan><tspan y="-499.98151" x="76.680305 78.748505 83.4897 85.709099 91.4133 96.0924 100.8327 104.0745 108.5187 113.3211 117.9543 122.7567 124.7385 128.87941 133.5666 135.78601 140.94751 143.16692 148.40312">IF OperandSize = 16</tspan><tspan y="-487.98181" x="94.680305 99.889503 105.7107 110.4609">THEN</tspan><tspan y="-475.98212" x="112.68031 117.39541 119.48251 124.59361 126.7527 128.4978 133.6593 135.87871 140.98981 145.70491 150.35701 152.93912 155.52122">EIP := Pop();</tspan><tspan y="-463.98242" x="112.68031 117.41071 119.51311 124.63951 126.79861 128.55901 133.68541 135.9048 140.58569 142.68629 147.8127 150.03209 155.64449 161.49988 167.04028 169.25967 174.53008 179.80048 185.02048 190.29088 194.97177 199.70218 204.43259 209.11349 214.9689">EIP := EIP AND 0000FFFFH;</tspan><tspan y="-451.98273" x="112.68031 117.4035 122.1807 124.3398 126.09299 131.21219 133.43159 138.5508 143.274 147.9342 150.5244 153.11459 154.98479 157.20419 159.79439 163.81558 166.03499 171.29819 176.56139 179.44229 184.062 186.0132 189.3864 191.6058 196.26601 200.98921 205.64941 207.86882 211.89001">CS := Pop(); (* 16-bit pop *)</tspan><tspan y="-439.98303" x="94.680305 99.421501 103.86031 108.6627 113.4039 115.6233 118.1874 122.1825 124.4019 130.10699 134.78609 139.47418 142.77629 147.22139 152.02379 156.65788 161.46028 163.38538 167.58658 172.27467">ELSE (* OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-439.98001" x="174.42 179.93983">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-439.98001" x="182.39999 187.67039 192.8904 195.10979 199.13818">64 *)</tspan><tspan y="-427.98032" x="112.6797 118.1013 120.19289 125.30849 127.46759 129.21719 134.33279 136.5522 141.7137 146.39461 151.05121 153.6378 156.2244">RIP := Pop();</tspan><tspan y="-415.98062" x="112.6797 117.4101 122.1945 124.35359 126.11399 131.24039 133.45978 138.58618 143.31659 147.98399 150.58139 153.17879 155.05618 157.27557 159.87297 163.90137 166.12076 171.39116 176.61116 179.45155 184.07126 186.02966 189.41006 191.62946 196.24916 200.99036 205.65776 207.49016 209.70955 214.49394 216.41545 221.08286 225.82495 228.66534 233.39575 236.66815 241.33556 246.05696 249.32936 251.54875 256.81915 262.03912 264.25851 268.9259 270.84741 274.22781 278.24722 280.46661 285.134 287.05551 291.07492 294.98633 299.46472 302.73712 307.40451 312.08542 316.75281 318.9722 323.00061">CS := Pop(); (* 64-bit pop, high-order 48 bits discarded *)</tspan><tspan y="-403.98093" x="76.679695 81.414597 83.5215">FI;</tspan><tspan y="-391.98123" x="45.119392 49.800293 51.90089 53.820591">FI; </tspan><tspan y="-379.98154" x="45.119392 47.213692 51.894592 54.113991 56.064289 60.840591 64.851891 68.22419 71.488487 76.264786 80.168083 83.540382 85.490685 90.212982 94.989281 97.208679 101.98498 106.45528 110.46658 112.6797 114.6507 121.551 128.517 133.19789 137.87788 139.79938 144.29037 147.68338 152.41737 154.63676 159.31766 163.99675 168.67764 171.97975 176.41945 181.22185">IF instruction has immediate operand</tspan><tspan y="-367.98184" x="58.619396 63.809696 69.666 74.397301 80.253601 82.473 85.071297 89.100594 91.319992 96.753296 101.4342 103.36649 108.08879 112.5285 116.5506 121.2315 123.4509 128.1192 132.5589 135.8322 140.2719 147.2262 151.9071 155.28841 159.96931 163.24261 167.26291 169.4823 172.82761 176.10091 180.83221 187.73251 189.9519 193.9722 197.3535 201.83279 205.74509 210.03539 212.25478 216.28407">THEN (* Release parameters from stack *)</tspan><tspan y="-355.98215" x="76.679695 78.786598 83.5215 85.740906 90.529808 93.914711 98.354416 102.25412 106.51382 112.15321 116.77291 121.45201 124.69381 129.43411 133.45801 137.4198 142.20869 144.1716 148.3125">IF StackAddressSize</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-355.98001" x="152.94"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-355.98001" x="155.45988">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-355.98001" x="160.92"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-355.98001" x="163.1403 168.42061">32</tspan><tspan y="-343.98032" x="94.680008 99.889206 105.7104 110.4606 116.2818">THEN </tspan><tspan y="-331.98062" x="112.68001 117.40141 122.1768 127.2942 129.45331 131.20471 136.32211 138.54152 143.26292 148.03833 153.15573">ESP := ESP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-331.98062" x="155.4003">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-331.98062" x="160.3206 162.53999 167.33429 172.7343 177.47459"> SRC;</tspan><tspan y="-319.98093" x="94.680901 99.415802 103.8897 108.6786">ELSE</tspan><tspan y="-307.98123" x="112.6809 114.777 119.5011 121.7205 126.4986 129.8727 134.3448 138.24991 142.533 148.1391 152.7588 157.43791 160.70401 165.41911 169.43222 173.44533 178.22343 180.17554 184.34164 189.05675 191.27615 196.39626 198.61566 203.83566">IF StackAddressSize = 16</tspan><tspan y="-295.98154" x="130.68091 135.85951 141.70412 146.42372">THEN</tspan><tspan y="-283.98184" x="148.68091 153.43651 158.5341 160.75351 162.55531 167.65651 169.87592 174.63152 179.79301">SP := SP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-283.98184" x="181.98091">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-283.98184" x="186.90121 189.12061 193.8663 199.32571 204.01741"> SRC;</tspan><tspan y="-271.98215" x="130.68091 135.3618 139.8006 144.59219 149.32979 151.54918 154.15378 158.18938 160.40877 165.15086 168.51057 172.99617 176.91476 181.17447 186.81387 191.43358 196.11269 199.35449 204.0948 208.05659 212.07869 216.87029 218.79179 222.97139 227.6523">ELSE (* StackAddressSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-271.98001" x="229.86">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-271.98001" x="235.38"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-271.98001" x="237.60031 242.87071 248.09071 250.3101 254.3385">64 *)</tspan><tspan y="-259.98032" x="148.68031 154.08571 158.84311 164.00461 166.22401 167.95741 173.05681 175.27621 180.68161 185.48401 190.5834">RSP := RSP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-259.98032" x="192.78032">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-259.98032" x="197.70062 199.92001 204.71431 210.11432 214.85461"> SRC;</tspan><tspan y="-247.98062" x="112.68032 117.41522 119.52213">FI;</tspan><tspan y="-235.98093" x="76.680321 81.415222 83.522125">FI;</tspan><tspan y="-223.98123" x="45.120018 49.800919 51.901516">FI;</tspan><tspan y="-211.98154" x="45.120018 47.188217 51.884418 54.103817 58.906219 63.648319 68.147423 72.826523 77.52272 84.483315 89.233513 92.653511 97.09771 100.97491 105.23011 109.97131 114.7215 119.2206 123.8997 125.82121 130.50841 135.1875 137.7507 142.4469 147.6084 152.0472">IF ShadowStackEnabled(CPL)</tspan><tspan y="-199.98184" x="58.620018 60.720619 65.449219 67.668617 72.451218 77.193321 82.317924 84.537323 90.147926 96.001526 101.54012 103.75952 109.02812 113.76572 119.03432 121.25372 123.00333 128.12793 130.34732 135.61592 137.83531 140.43091 144.4575 146.6769 150.5865 155.36911 160.05002 163.94972 168.23732 170.45671 172.41331 175.75592 177.97531 182.41501 184.3365 186.29311 190.91281 195.6954 200.37631 205.04192 207.26131 210.63991 215.36852 217.58791 222.80791 225.0273 229.6929 234.3765 237.7551 242.436 246.4536 248.67299 252.69958">IF SSP AND 0x7 != 0 (* check if aligned to 8 bytes *)</tspan><tspan y="-187.98215" x="76.680321 81.859818 87.705315 92.425812 98.271309 100.49071 106.25521 110.97571 116.09221 118.67971 123.40021 129.0027 134.4252 137.25571 142.67821 147.39871 152.57822 155.70572 157.79822 163.22072 167.94122 173.12073 175.70822 177.57571 179.79512 184.51562 186.60812">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-175.98245" x="58.620018 62.040016 66.720917 73.681511 78.301216 83.103615 87.125717 91.823715 96.626114 98.845512 103.93951 106.15891 110.18102 114.92311 119.42221 124.10131 128.79932 135.75992 140.32112 144.28291 147.70293 152.14262 156.02162 160.27863 164.83983 166.76134 171.50253 175.94223 180.62132 182.84073 188.12103 190.34044 194.97543 199.62843 202.97644 207.71674 211.70374 213.92314 217.28194 220.52374 225.26494 232.22554 234.44495 239.19695 243.99934 249.09334 254.24133 259.52164 264.74164">tempSsCS = shadow_stack_load 8 bytes from SSP+16;</tspan><tspan y="-163.98276" x="58.620018 62.04002 66.720924 73.658127 78.309326 83.07753 87.080727 91.533928 93.620125 98.730324 100.94972 106.05992 108.27932 112.28252 117.05072 121.51292 126.16412 130.87833 137.81552 142.35872 146.36192 149.72612 154.18832 158.08353 162.40262 166.94582 168.89972 173.64091 178.14001 182.77411 184.99352 190.27382 192.49323 197.12732 201.77942 205.12653 209.86682 213.88892 216.10832 219.41942 222.72153 227.41862 234.37923 236.59863 241.40103 246.14313 251.23622 256.38333 261.66364">tempSsLIP = shadow_stack_load 8 bytes from SSP+8;</tspan><tspan y="-151.98306" x="58.620026 62.003124 66.684029 73.640129 78.259827 83.046928 87.789032 92.918129 95.137527 100.26662 102.48602 106.50813 111.25023 115.73133 120.35103 125.08413 132.04022 136.54112 140.56322 143.94632 148.42741 152.34151 156.63361 161.19571 163.12981 167.8629 172.3026 176.9727 179.19209 184.41209 186.63148 191.30159 195.98969 199.37279 204.0537 208.07579 210.29518 213.64229 216.91739 221.65048 228.60658 230.82597 235.56807 240.37047 245.49957">tempSSP = shadow_stack_load 8 bytes from SSP;</tspan><tspan y="-139.98337" x="58.620026 63.399025 68.178024 73.299026 75.518425 80.639427 82.858826 87.637825 92.379921 97.500923 99.720322 104.89532 107.11472 112.37972 117.64472">SSP = SSP + 24;</tspan><tspan y="-127.98367" x="58.620026 62.040024 66.720924 73.663528 78.320129 83.039734 87.813332 90.03273 95.148331 97.367729 102.08733 106.86092 108.72752 110.94692 113.53352 117.55112 119.77052 123.93212 128.64272 131.90431 136.62392 138.83972 143.51433 147.95403 152.62863 157.24834 161.97694 166.59665 168.81604 172.20364 176.88454 179.10393 184.38153 189.60153 191.82092 196.49553 198.46114 201.84874 204.06813 208.10373">tempCS = CS; (* zero padded to 64 bit *)</tspan><tspan y="-115.98396" x="58.620026 60.712524 65.433022 67.65242 71.022919 75.734421 82.677917 87.335419 92.055916 96.830414 99.049812 100.79131 105.90781 108.12721 111.54721 116.22811 123.17161 127.82911 132.60361 136.61311 141.33362 146.10812 148.32753 150.91502 154.93352 157.15292 162.41342 167.67392 169.89333 174.55083 176.49933 179.86983 182.08923 185.99074 190.71124 197.65474 202.26003 206.72853 209.99103 214.70253 216.57002 218.78943 223.50993 228.28444 230.50385 234.66635 239.37785 242.64035 247.36086 249.58026 254.23776 258.70627 263.36377 268.02127 272.73276 277.39026 279.60965 282.98016 287.70065 289.92004 295.18054 300.44104 302.66043 307.31793 309.26642 312.68643 316.64822 318.86761 322.88611">IF tempCS != tempSsCS (* 64 bit compare; CS zero padded to 64 bits *)</tspan><tspan y="-103.98426" x="76.680321 81.859818 87.705315 92.425812 98.271309 100.49071 106.25521 110.97571 116.09221 118.67971 123.40021 129.0027 134.4252 137.25571 142.67821 147.39871 152.57822 155.70572 157.79822 163.22072 167.94122 173.12073 175.70822 177.57571 179.79512 184.51562 186.60812">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-91.984558" x="58.620018 60.72242 65.45282 67.672218 72.402618 77.144722 82.469124 88.049126 92.833527 97.514427 99.733826 104.91422 107.13362 112.56602 114.66843 119.79483 122.01423 123.76562 128.89203 131.11142 134.49182 139.21323 146.11353 150.79263 155.57703 159.53972 164.01631 166.12592 171.22713 173.44652 176.02591 180.048 182.2674 187.545 192.765 194.98439 199.659 201.58051 204.94022 207.15961 211.0782 215.8158 222.7764 227.3961 231.8817 235.1235 239.85211 242.0715 246.1071">IF CSBASE + RIP != tempSsLIP (* 64 bit compare *)</tspan><tspan y="-79.984856" x="76.679413 81.85891 87.704407 92.424904 98.270401 100.4898 106.2543 110.9748 116.0913 118.6788 123.3993 129.0018 134.4243 137.25481 142.67731 147.39781 152.57732 155.70482 157.79732 163.21982 167.94032 173.11983 175.70732 177.57481 179.79422 184.51472 186.60722">THEN #CP(FAR-RET/IRET); FI;</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="349.91571pt" height="644.69238pt" viewBox="0 0 349.91571 644.69238" sodipodi:docname="1283.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.01931" inkscape:cy="423.77406" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg256" /><g transform="translate(-46.485519,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="59.52 61.619701 66.347404 68.566803 71.944504 76.663208 83.563507 88.242607 92.984711 97.787109 102.91081 105.13021 110.73991 116.59261 122.13031 124.34971 129.6174 134.355 139.6227 141.84209 143.59079 148.71449 150.93388 156.20158 158.42097 161.01567 165.04137 167.26076 171.16946 175.95117 180.63208 184.53178 188.81848 191.03787 192.99358 196.29298 198.51237 202.98807 204.91676 206.83827 211.51738 216.29907 220.97998 225.64468 227.86407 231.24178 235.92268 238.14207 243.40977 245.62917 250.29387 254.97656 258.35425 263.03513 267.05182 269.27124 273.29694">IF tempSSP AND 0x3 != 0 (* check if aligned to 4 bytes *)</tspan><tspan y="-703.98029" x="77.520004 82.699501 88.544998 93.265495 99.110992 101.33039 107.09489 111.81539 116.93189 119.51939 124.23989 129.84239 135.26489 138.0954 143.5179 148.2384 153.41791 156.54541 158.63791 164.06041 168.78091 173.96042 176.54791 178.41541 180.63481 185.35532 187.44781">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-691.98059" x="59.520004 61.614304 66.336601 68.556 71.145302 75.867599 80.609695 82.350296 86.8116 89.030998 94.1493 96.368698 101.631 103.8504 109.4547 115.30199 120.8343 123.0537 126.42599 131.1069 138.0522 142.7115 147.45361 152.25601 157.37431 160.13461 165.39691 170.61691 172.36922 177.63152 182.89381 185.65411 187.87352 189.61682 194.73512 196.95453 202.21683 204.80612 207.02553 212.72343">IF (CS.L = 0 AND tempSSP[63:32] != 0) OR</tspan><tspan y="-679.9809" x="69.600006 72.198303 76.929604 81.671707 83.412308 87.851105 90.070503 95.1978 97.417198 102.6885 104.9079 110.48789 116.30909 121.85039 124.06979 127.45109 132.13199 139.08629 143.70599 148.49129 153.27658 158.40388 160.62328 162.54478 166.56688 168.78627 173.57156 178.25246 181.63376 183.85315 187.76544 192.24474 196.98683 201.72804 206.51334 208.43484 212.34714 216.82643 218.75873 220.98001 224.2299 228.9702 230.8791 235.33501 238.6929 240.6747 245.30161 250.0005 252.21991 255.63991 260.3208 262.54019 265.8981 270.7005 275.44083 277.66022 281.5491 286.311 289.56091 292.86301 297.56192 302.36432 305.72223 307.94162 312.58652 317.04242 321.68732 323.62323 328.42563 333.04532 335.26471 342.19562 346.9035 351.5484 356.28873">(CS.L = 1 AND tempSSP is not canonical relative to the current paging mode)</tspan><tspan y="-667.9812" x="77.52002 82.700417 88.546814 93.268211 99.114609 101.33401 107.09941 112.36981 117.48721 120.07561 125.33701 127.92542 129.79381 132.01321 136.73462 138.82802">THEN #GP(0); FI;</tspan><tspan y="-655.98151" x="59.52002 64.312523 69.054626 74.189125 76.408531 78.177032 83.311531 85.530937 88.919441 93.648941 100.54924 105.22834 110.02084 114.76295">SSP := tempSSP</tspan><tspan y="-643.98181" x="46.02002 50.70092 52.801517">FI;</tspan><tspan y="-619.98151" x="46.02002 48.112518 53.715019 56.545521 61.806023 67.066521 71.787018 74.617516 81.192017 86.920517 92.451019 97.171516 100.00201 105.42451 110.14501 115.32451 121.00801 126.43051 132.27602 135.10652 140.28603 146.01453 148.80002 154.52222 160.19942 165.37262 170.08682 175.50302 178.32722 183.48872 188.88872 190.97491 196.64311 198.72931 203.22841 207.94261 213.20581 217.92001 220.74422 225.19742 229.91162 235.57982 240.29402 244.74722">IA-32E-MODE-RETURN-TO-OUTER-PRIVILEGE-LEVEL:</tspan><tspan y="-607.98181" x="46.02002 48.13142 52.812321 55.031719 58.42112 63.10202 67.778419 69.997826 72.604225 77.883629 83.10363">IF top (16 </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-607.98181" x="85.32032">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-607.98181" x="90.240623 92.460022 97.242622 102.67323 107.40182 109.99742 112.21682 116.88242 121.56602 124.94463 129.62553 133.64313 135.86252 140.59113 143.89053 146.10992 150.12752 153.50612 157.98271 161.89232 166.17992 168.39931 172.839 176.1411 180.82201 183.0414 187.82401 192.50491 195.88351 198.10291 205.0032 206.98502 210.36362 215.16061 217.09471 221.89711 224.11652 228.11162 231.53162 235.98572 239.87282 244.13792 246.35733 248.26443 250.24623 257.17532 259.10944 262.46555 266.46063 268.68091 271.2702 277.00049 281.65979 286.37308 289.63739 294.1077 298.884 303.5433 308.31961 310.2699 314.4342 319.14749 321.36691"> SRC) bytes of stack are not within stack limits (OperandSize =</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-607.98181" x="326.46091"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-607.98181" x="328.68121 333.97772 339.19772 341.82123">32) </tspan><tspan y="-595.98212" x="46.020905 50.719803 54.0219 56.241299 59.590199 64.331398 68.9673 71.186699 73.752602 79.032898">or top (8 </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-595.98212" x="81.240601">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-595.98212" x="86.160904 88.38031 93.170113 98.570107 103.30591 105.90871 108.12811 112.74781 117.42781 120.81361 125.49451 129.51932 131.73871 136.4196 139.77841 141.9978 146.0226 149.4084 153.8481 157.80719 162.06689 164.28629 168.72598 172.02809 176.709 178.92839 183.71819 188.39908 191.78488 194.00427 200.96307 202.92688 206.31268 211.05478 213.01859 217.76068 219.98007 224.00487 227.39067 231.87447 235.79126 240.05096 242.27036 244.20715 246.17096 253.07126 255.05307 258.43887 262.46368 264.68307 267.28589 272.9838 277.65659 282.33749 285.6153 290.05499 294.84479 299.46448 304.25427 306.17578 310.35358 315.03448 317.25388"> SRC) bytes of stack are not within stack limits (OperandSize =</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-595.98212" x="322.38123"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-595.98212" x="324.60153 329.88184 335.10184">16)</tspan><tspan y="-583.98242" x="59.52182 64.705818 70.555817 75.280815 81.130814 83.350212 89.119209 93.898209 98.640305 101.2197 106.4847 109.07671 110.94871 113.16811 117.8931 119.9901">THEN #SS(0); FI;</tspan><tspan y="-571.98273" x="46.02182 48.133221 52.814121 55.03352 58.42292 63.103821 67.78022 69.999626 72.606026 77.885429 83.105431">IF top (16 </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-571.98273" x="85.322121">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-571.98273" x="90.242424 92.46183 97.251633 102.65163 107.38743 109.99023 112.20963 116.88243 121.57323 124.95904 129.63994 133.66473 135.88412 140.61992 143.91933 146.13872 150.16351 153.54932 158.03311 161.94991 166.20961 168.429 172.8687 176.17081 180.85172 183.07111 187.8609 192.54179 195.9276 198.14699 200.0685 204.8709 207.09029 211.00708 215.44678 220.23657 224.91747 229.70726 231.62877 235.54556 240.02936 241.96616 244.18555 248.62524 253.29805 257.97086 261.21265 265.89355 269.91837 273.94318 276.16257 280.18738 284.80707 289.29086 293.20767 297.88858 300.10797 302.71078 308.40869 313.08148 317.76239 321.00418 325.50327 330.24536 334.92444 339.71423 341.63574 345.77664 350.51694 352.73633 357.86813 363.14392 368.36392 371.00275"> SRC) bytes of stack are not in canonical address space (OperandSize =32) </tspan><tspan y="-559.98303" x="46.022724 50.721626 54.023724 56.243122 59.592022 64.333221 68.969124 71.188522 73.754425 79.034721">or top (8 </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-559.98303" x="81.242424">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-559.98303" x="86.162727 88.382133 93.171036 98.57103 103.30593 105.90783 108.12724 112.74693 117.42693 120.81184 125.49274 129.51663 131.73602 136.41692 139.77573 141.99512 146.01901 149.40392 153.84361 157.8027 162.06241 164.2818 168.7215 172.02361 176.70451 178.9239 183.7128 188.39369 191.77859 193.99799 195.96089 200.74979 202.96918 206.88507 211.32477 216.11366 220.80273 225.57814 227.52754 231.42995 235.89935 237.82175 240.04115 244.51056 249.16896 253.78867 257.09076 261.80316 265.81357 269.82397 272.04337 276.05377 280.67346 285.14285 289.04526 293.75766 295.98242 298.54742 304.3056 308.94061 313.68091 316.9209 321.42001 326.17203 330.85114 335.60315 337.58493 341.72495 346.46524 348.68466 353.77866 355.99808 361.27838 366.49838"> SRC) bytes of stack are not in canonical address space (OperandSize = 16)</tspan><tspan y="-547.98334" x="46.02272 50.723419 54.025517 56.244915 59.595615 64.336815 68.974518 71.193916 73.76162 79.041916 84.322212 86.541611 91.692314 93.911713 98.666412 104.12582 108.82652 111.39422 113.61362 118.29272 122.97272 126.32342 131.06372 135.05342 137.27283 142.01402 145.37282 147.59222 151.58192 155.00192 159.45062 163.33232 167.59203 169.81143 174.31053 177.55234 182.29263 184.51204 189.26674 194.00793 197.35864 199.57805 201.55984 206.30194 208.52135 212.40305 216.90215 221.65685 226.39804 231.15274 233.13454 237.01624 241.46494 243.36664 245.58604 250.08514 254.70483 259.38394 262.62576 267.36609 271.38818 275.37787 277.59726 281.58694 286.26605 290.71475 294.59647 299.33679 301.55618 304.12387 309.83258 314.51169 319.1926 322.49469 326.93439 331.73679 336.35648 341.15887 343.08038 347.28159 351.96249 354.18188 359.27859 361.49799 366.77829 372.05859">or top (32 + SRC) bytes of stack are not in canonical address space (OperandSize = 64)</tspan><tspan y="-535.98364" x="59.52272 64.706718 70.556717 75.281715 81.131714 83.351112 89.12011 93.899109 98.641205 101.2206 106.4856 109.07761 110.94961 113.16901 117.894 119.991">THEN #SS(0); FI;</tspan><tspan y="-523.98395" x="46.02272 51.448822 56.163921 60.636021 65.297119 67.515617 70.781715 75.496819 78.870918 83.649017 86.915115 91.693214 93.911713 97.924812 101.29891 105.77101 109.67611 113.95921 116.17771 120.19081 124.90591 129.56702 136.46732 141.18242 145.96053 149.33463 151.55313 155.51494 160.25525 162.18034 166.89545 170.80055 174.17465 178.85556 182.15765">Read return stack segment selector;</tspan><tspan y="-511.98425" x="46.02272 48.11972 52.800617 55.020016 59.034016 62.409016 66.882019 70.788017 75.072014 77.291412 81.305412 86.021416 90.683418 97.631416 102.34742 107.12642 110.50142 112.72082 116.73482 121.45082 123.37682 128.09282 131.99883 135.37383 140.09883 143.36583 145.58524 147.53824 151.55225 153.77165 159.62166 165.26286 169.72687">IF stack segment selector is NULL</tspan><tspan y="-499.98456" x="59.52272 64.731918 70.553116 75.303314">THEN</tspan><tspan y="-487.98486" x="77.52272 79.623322 84.364517 86.583916 91.335915 96.076218 103.03681 105.25621 109.95421 114.75661 116.97601 121.61101 126.35131 130.37341 134.27312 137.51312 139.49492 144.12991 147.47792 152.21912 155.46092 157.68033 162.17943 165.00003 169.63503 171.61682 174.96483 177.18423 182.27823 184.49763 189.77794">IF new CS descriptor L-bit = 0 </tspan><tspan y="-475.98517" x="95.52272 100.70222 106.54771 111.26821 117.11371 119.33311 125.09761 130.36711 135.48361 138.07111 142.08061 146.79211 148.71361 153.39452 157.29602 160.66652 165.38702 168.64952 171.23701">THEN #GP(selector);</tspan><tspan y="-463.98547" x="77.52272 79.61972 84.344719 86.564117 90.578117 93.953117 98.426117 102.33212 106.61611 108.83551 112.84951 117.56551 122.22752 129.12782 133.84383 138.62283 141.99783 144.21724 148.23123 152.94724 154.87323 159.58923 163.49524 166.87024 171.59525 174.86224 177.08165 182.50865 187.62965 192.09366 194.31306 199.43407 201.65347">IF stack segment selector RPL = 3</tspan><tspan y="-451.98578" x="95.52272 100.70222 106.54771 111.26821 117.11371 119.33311 125.09761 130.36711 135.48361 138.07111 142.08061 146.79211 148.71361 153.39452 157.29602 160.66652 165.38702 168.64952 171.23701">THEN #GP(selector);</tspan><tspan y="-439.98608" x="46.02272 50.703621 52.804218">FI;</tspan><tspan y="-427.98639" x="46.02272 48.135921 52.816822 55.036224 58.319424 63.000324 66.360023 71.16243 74.404236 79.206635 81.426033 85.45623 88.815926 93.255623 97.155327 101.45553 103.67493 107.63673 112.37703 116.99673 123.95733 128.68953 133.43163 136.79134 139.01073 143.68893 148.36984 152.40004 156.32224 159.60544 161.52695 166.20515 169.56487 174.30606 177.54787 179.76726 181.68875 185.70273 187.92213 192.69664 197.41714 200.83714 203.05655 210.00005 211.94855 215.31905 220.09355 222.04205 226.81656 229.03596 233.69347 238.40497 242.41447 246.31598 249.61807 251.53958 256.19708 259.5676 264.28809 267.5506 269.76999 273.1405 277.60901 282.26651 284.18802 288.89951 291.1189 293.04041 294.98889 301.9324 303.88089 307.2514">IF return stack segment descriptor is not within descriptor table limits</tspan><tspan y="-415.98669" x="77.52272 82.705818 88.554916 93.279015 99.128113 101.34751 107.11561 112.38871 117.50881 120.09991 124.11301 128.82811 130.7532 135.43411 139.33922 142.71332 147.43742 150.70352 153.29462 155.16571 157.38512 162.06602 164.16663">THEN #GP(selector); FI;</tspan><tspan y="-403.987" x="46.02272 48.135921 52.816822 55.036224 58.319424 63.000324 66.360023 71.16243 74.404236 79.206635 81.426033 85.45623 88.815926 93.255623 97.155327 101.45553 103.67493 107.63673 112.37703 116.99673 123.95733 128.68953 133.43163 136.79134 139.01073 143.68893 148.36984 152.40004 156.32224 159.60544 161.52695 166.20515 169.56487 174.30606 177.54787 179.76271 181.68422 185.70631 187.9257 189.88951 194.63161 196.851 201.64079 206.32169 211.11148 213.95728 217.87407 222.35786 227.09996 231.84116 236.58325 238.56506 242.48186 246.92155 248.85835 251.07774 255.56154 260.18124 264.85403 268.09583 272.82263 276.84744 280.87225 283.09164 287.05347 291.73254 296.17224 300.07196">IF return stack segment descriptor is in non-canonical address space</tspan><tspan y="-391.9873" x="77.522713 82.705811 88.554909 93.279007 99.128105 101.3475 107.1156 112.3887 117.5088 120.09991 124.11301 128.82811 130.7532 135.43411 139.33922 142.71332 147.43742 150.70352 153.29462 155.16571 157.38512 162.06602 164.16663">THEN #GP(selector); FI;</tspan><tspan y="-379.98761" x="46.022713 51.455112 56.176514 60.616215 65.295319 67.514717 71.476517 76.216812 80.884209 87.784508 92.505905 97.248009 100.62841 102.84781 107.51521 112.19611 116.21551 120.12691 123.39931 125.3208 129.9882 133.36861 138.099 141.3714 143.59079 148.25819 152.93909 154.89749 159.63959 163.01999 167.74139 172.4088 174.62819 178.00859 182.68948 184.90887 189.57628 194.26167 196.48106 199.75346 204.47487 207.85527 212.59737 215.86977 220.61186 222.83125 226.85065 231.57205 236.19176 243.15236 247.83327 252.63567 256.01605 258.23544 262.25485 266.93576 268.86716 273.58856 277.49997 280.88037 285.61078 288.88318">Read segment descriptor pointed to by return segment selector;</tspan><tspan y="-367.98792" x="46.022713 48.117012 52.797913 55.017311 59.02861 62.400909 66.871208 70.774506 75.055809 77.275208 81.286507 85.999809 90.659111 97.604408 102.31771 107.09401 110.46631 112.68571 116.69701 121.41031 123.33361 128.04691 131.95021 135.32251 140.04482 143.30911 145.52852 150.95282 156.07112 160.53242">IF stack segment selector RPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-367.98001" x="162.72">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-367.98001" x="168.18007"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-367.98001" x="170.64 176.09669 181.19789 185.63669 187.85609 192.61079 195.91019 198.12959 201.53429 206.27638 211.02208 213.24149 216.48329 221.16418 224.56888 229.31097 232.60768 237.34978 239.56918 243.46889 248.21008 252.82977 257.57007 259.78946 263.83316 268.51407 273.20578 280.10608 284.85178 289.59387 292.99857 295.21796 299.17975 303.92004 305.84152 310.52243 314.42123 317.84122 322.52213">RPL of the return code segment selector</tspan><tspan y="-355.98032" x="46.019699 50.733002 54.035099 56.254498 60.256798 63.620098 68.081398 71.9757 76.2948 78.514206 82.51651 87.22081 91.871109 98.807411 103.51171 108.27901 111.64232 113.86172 115.80302 119.80533 122.02473 126.79204 131.50534 134.86864 137.0997 141.5466 143.76601 150.72661 153.96841 155.95021 159.30992 163.80902 168.42871 170.32861 175.06891 177.28831 181.92421 186.42331 189.77222 194.21912 196.43852 200.46062 205.20091 209.83681 216.79741 221.4873 226.2897">or stack segment is not a writable data segment</tspan><tspan y="-343.98062" x="46.019699 50.7006 54.002701 56.222103 60.255005 63.614708 68.054405 71.954109 76.257011 78.47641 82.43821 87.178513 91.79821 98.758804 103.49371 108.2358 111.5955 113.8149 118.4958 123.1767 127.20959 131.13449 134.42039 136.34189 141.02278 144.38249 149.12639 152.36819 154.58759 160.10548 165.2067 169.68959">or stack segment descriptor DPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-343.98001" x="171.89999">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-343.98001" x="177.36006"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-343.98001" x="179.82001 185.23531 190.3968 194.84911 197.06851 201.78181 205.10912 207.32852 210.69182 215.45912 220.16342 222.38283 225.68492 230.36581 233.72911 238.49641 241.75171 246.51901 248.73842 252.63272 257.40002 262.03592 266.77625 268.99564 272.98355 277.72388 282.40298 289.30328 294.04361 298.78571 302.13461 304.354 308.37613 313.11646 315.01636 319.70627 323.58618 326.93509 331.6763">RPL of the return code segment selector</tspan><tspan y="-331.98032" x="59.51973 64.702827 70.551926 75.276024 81.125122 83.344521 89.112617 94.385719 99.505821 102.09692 106.11002 110.82513 112.75023 117.43113 121.33623 124.71033 129.43443 132.70053 135.29163 137.16272 139.38213 144.06303 146.16364">THEN #GP(selector); FI;</tspan><tspan y="-319.98062" x="46.01973 48.11673 52.797626 55.017925 59.031925 62.406925 66.879929 70.785927 75.069923 77.290222 81.304222 86.020226 90.682228 97.630226 102.34623 107.12523 110.50023 112.72053 117.49953 122.22453 125.59953 127.81982 132.48183 135.74883 140.46483 144.42662 149.14262 153.92163 157.29663">IF stack segment not present </tspan><tspan y="-307.98093" x="59.51973 64.71093 70.56813 75.300331 81.157532 83.37693 89.15313 93.939331 98.681435 101.26083 106.04704 109.42924 113.86894 117.76865 122.05984 126.80195 131.52515 136.14485 143.10005 147.82326 152.56535 155.92505 160.71124 165.39215 167.32535 172.04855 175.96176 179.34396 184.07617 187.35037 189.94957 191.82877 194.04816 198.78036 200.88457">THEN #SS(StackSegmentSelector); FI;</tspan><tspan y="-295.98123" x="46.01973 48.134731 52.815632 55.035034 58.428036 63.170135 67.904137 70.123535 73.365341 78.046242 81.43924 86.181335 89.466339 94.208435 96.427834 98.398834 103.14093 107.17293 110.56593 113.80773 118.61013 122.53413 125.92713 127.89813 132.57903 137.37602 139.59541 144.2151 148.9563 150.92729 155.66939 159.06239 163.79639 167.03819 169.25758 171.22858 175.26057 177.47997 182.22206 186.89943 190.26903 192.48843 199.43103 201.37863 204.74823 209.52184 211.46944 216.24304 218.46245 221.83205 226.60565 231.31625 233.53566 236.79726 241.50786 244.87746 249.65106 252.91266 257.68625 259.85974 263.81885 268.49976 273.15634 277.86694 280.08633 284.09494 288.80554 293.46213 300.40472 305.11533 309.88892 313.25851 315.47791 317.3985 319.3461 326.2887 328.2363 331.6059">IF the return instruction pointer is not within the return code segment limit </tspan><tspan y="-283.98154" x="59.519745 64.700142 70.546539 75.267937 81.114334 83.333733 89.099136 94.369537 99.486938 102.07534 107.33674 109.92514 111.79354 114.01294 118.73434 120.82774">THEN #GP(0); FI:</tspan><tspan y="-271.98184" x="46.019745 48.130245 52.811146 55.030544 58.419044 63.161144 67.890648 70.110054 73.35186 78.032761 81.421265 86.163368 89.443871 94.185974 96.40538 98.37188 103.11398 107.14148 110.52998 113.77179 118.5742 122.4937 125.8822 127.8487 132.5296 137.3221 139.54149 144.16119 148.90239 150.8689 155.61099 158.9995 163.729 166.97081 169.1902 171.15671 175.1842 177.40359 182.14569 186.88689 190.27539 192.49478 199.45628 201.37779 204.7663 209.55879 211.4803 216.2827 218.50209 222.42159 226.86128 231.65378 236.33467 241.12717 243.04868 246.96817 251.45467 253.39417 255.61356 260.05325 264.72876 269.40427 272.64606 277.32693 281.35443 285.38193 287.60135 291.62885 296.30435 300.74405 304.64374 309.32462">IF the return instruction pointer is not within canonical address space </tspan><tspan y="-259.98215" x="59.519745 64.700142 70.546539 75.267937 81.114334 83.333733 89.099136 94.369537 99.486938 102.07534 107.33674 109.92514 111.79354 114.01294 118.73434 120.82774">THEN #GP(0); FI;</tspan><tspan y="-247.98245" x="46.019745 48.136543 52.817444 55.036846 60.789646 65.40934 70.145142 73.38694 77.879738 82.621834 87.303635 92.045731 94.018532 98.159431 102.89523">IF OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-247.98" x="105.12">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-247.98" x="110.58"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-247.98" x="112.8597 118.0797">32</tspan><tspan y="-235.9803" x="59.519402 64.7286 70.549797 75.299995">THEN</tspan><tspan y="-223.98061" x="77.519402 82.234505 84.321602 89.432701 91.6521 93.397202 98.558701 100.7781 105.8892 110.6043 115.2564 117.8385 120.4206">EIP := Pop();</tspan><tspan y="-211.98091" x="77.519402 82.240799 87.016197 89.235596 90.987 96.104401 98.323799 103.4412 108.1626 112.821 115.4094 117.9978 119.8662 122.0856 124.674 128.69341 130.91281 136.17421 141.43561 144.26701 148.92542 150.87482 154.24622 156.46562 161.12402 165.84543 170.50383 172.32722 174.5394 179.32379 181.2453 185.9127 190.6548 193.49519 198.22559 201.49799 206.16539 210.8463 214.14839 216.36778 221.58778 226.86809 229.08748 233.75488 235.67639 239.05679 243.07619 245.29558 249.96298 251.88449 255.90388 259.81528 264.29367 267.56607 272.23346 276.91437 281.58176 283.41415 285.63354 289.65295 294.33386 299.00125 305.95465 310.63556 315.43796 318.81836 321.03775 325.65744 330.39774 334.41714 338.32855 341.60095 343.55936 348.17905 351.53876 356.26917 359.54156 361.76096 363.69235 368.42276 372.90115 377.52084 382.24225 386.86194 389.08133 393.10974">CS := Pop(); (* 32-bit pop, high-order 16 bits discarded, segment descriptor loaded *)</tspan><tspan y="-199.98122" x="77.519402 82.236305 87.007202 89.591103 95.010002 100.1229 104.622 107.2059 109.4253 111.1722 116.2851 118.5045 123.9639 128.64481 132.0117 136.78261 140.0415 144.81241 149.52931 154.24622 158.90012 163.60802 168.37892 173.08682 177.74072 184.68062 189.38852 194.15942 197.52632 202.29723 207.00513 208.92303 213.63094 217.52884 220.89574 225.61264 228.87154 231.45543 236.91483 242.01602 246.47192 249.05582">CS(RPL) := ReturnCodeSegmentSelector(RPL);</tspan><tspan y="-187.98152" x="77.519402 79.617302 84.343201 86.562599 88.516502 93.296402 97.311302 100.6872 103.9551 108.735 112.6419 116.0178 117.9717 122.6526 127.4325 129.6519 134.43181 138.9057 142.92059 145.14 147.0939 154.0428 160.9431 165.68341 170.30312 172.28491 176.75882 180.13472 184.85162 187.07103 191.79694 196.41664 201.13354 204.40144 208.87534 213.65524">IF instruction has immediate operand</tspan><tspan y="-175.98183" x="95.519402 100.7106 106.5318 111.264 117.0852 119.3046 121.90379 125.93399 128.15338 133.58759 138.26849 140.20169 144.9249 149.36459 153.38669 158.0676 160.28699 164.95619 169.39589 172.67009 177.10979 184.06499 188.7459 192.1281 196.8513 200.1255 204.1467 206.36609 209.7123 212.9865 217.71869 224.61899 226.83838 230.75159 235.23178 237.16498 239.09818 243.77908 248.44829 250.66768 255.33688 258.61108 263.34329 267.2565 271.93741 276.61649 281.35858 284.66068 289.34158 290.96338 294.98459 297.20398 301.1658 304.52551 309.00571 312.91891 317.21011 319.4295 323.45972">THEN (* Release parameters from called procedure’s stack *)</tspan><tspan y="-163.98213" x="113.5194 115.6263 120.36121 122.58061 127.36951 130.75441 135.19411 139.0938 143.3535 148.9929 153.61261 158.29172 161.53352 166.27383 170.29773 174.25952 179.04842 181.01132 185.15222">IF StackAddressSize</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-163.98" x="189.84"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-163.98" x="192.35988">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-163.98" x="197.82001"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-163.98" x="200.04031 205.32062">32</tspan><tspan y="-151.9803" x="131.52061 136.72981 142.55101 147.30121 153.12241">THEN </tspan><tspan y="-139.98061" x="149.52061 154.24202 159.01743 164.13483 166.35423 168.10564 173.22304 175.44244 180.16385 184.93925 190.05666">ESP := ESP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-139.98061" x="192.30032">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-139.98061" x="197.22063 199.44002 204.23341 209.63342 214.31432"> SRC;</tspan><tspan y="-127.9809" x="131.52063 136.25552 140.72943 145.51833">ELSE</tspan><tspan y="-115.9812" x="149.52063 151.63203 156.37143 158.59082 163.38422 166.77362 171.21332 175.11301 179.37271 185.01212 189.63182 194.31093 197.55273 202.29305 206.32144 210.28323 215.07663 217.04404 221.18494 225.86584 228.08524 233.22064 235.44003 240.66003">IF StackAddressSize = 16</tspan><tspan y="-103.9815" x="167.58093 172.79013 178.61133 183.36153">THEN</tspan><tspan y="-91.981796" x="185.58093 190.36533 195.49173 197.65082 199.41122 204.53763 206.75702 211.49911 216.60031">SP := SP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-91.981796" x="218.88094">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-91.981796" x="223.80124 226.02063 230.76633 236.22574 240.91743"> SRC;</tspan><tspan y="-79.982094" x="167.58093 172.30954 176.77715 181.55975 186.28836 188.50775 191.10335 195.12994 197.34933 202.09143 205.45113 209.92772 213.83733 218.12492 223.73552 228.40112 233.06673 236.33733 241.05693 245.01872 249.03632 253.81891 255.74042 259.94162 264.62253">ELSE (* StackAddressSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-79.980003" x="266.76001">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-79.980003" x="272.28"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-79.980003" x="274.50031 279.77069 284.99066 287.21005 291.23846">64 *)</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="369.53775pt" height="644.46625pt" viewBox="0 0 369.53775 644.46625" sodipodi:docname="1284.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.03808" inkscape:cy="423.76554" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg204" /><g transform="translate(-45.721443,-69.35791)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="184.67999 190.08539 194.84279 200.00429 202.22369 203.95709 209.05649 211.27589 216.68129 221.48369 226.58308">RSP := RSP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-715.97998" x="228.78">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="233.7003 235.91969 240.71399 246.114 250.85429"> SRC;</tspan><tspan y="-703.98029" x="148.67999 153.3609 155.4615">FI;</tspan><tspan y="-691.98059" x="112.67999 117.41489 119.5218">FI;</tspan><tspan y="-679.9809" x="76.679993 81.414894 83.521797">FI;</tspan><tspan y="-667.9812" x="76.679993 80.099991 84.780891 91.722595 96.378296 101.097 105.8697 110.9844 113.14349 114.8922 120.0069 122.2263 127.38779 132.129 136.7847 139.37039 141.95609">tempESP := Pop();</tspan><tspan y="-655.98151" x="76.679993 80.060394 84.741295 91.694695 96.314392 101.09879 105.8409 107.99999 109.76039 114.8868 117.10619 122.23259 126.96299 131.58269 134.22148 136.81888 138.69627 140.91566 143.51306 147.54146 149.76085 155.03125 160.25125 163.09164 167.75905 169.68056 173.10056 175.31995 179.93965 184.68085 189.30055 191.15904 193.37843 198.12053 200.10234 204.76974 209.51184 212.35223 217.08264 220.35504 225.02245 229.70335 233.00545 235.22484 240.44484 245.72514 247.94453 252.61194 254.53345 257.91385 261.93326 264.15265 268.82004 270.74155 274.76096 278.67236 283.11206 286.41415 291.03384 295.77414 300.44153 302.27393 304.49332 308.51273 313.19363 317.86102 324.76132 329.48273 334.22482 337.60522 339.82462 344.44431 349.1846 353.20401 357.11542 360.38782 362.30933 366.97672 370.35712 375.08752 378.35992 380.57932 382.51071 387.24112 391.68082 396.35989 401.0408 405.71988 407.93927 411.96768">tempSS := Pop(); (* 32-bit pop, high-order 16 bits discarded, segment descriptor loaded *)</tspan><tspan y="-643.98181" x="58.61969 63.352791 67.82489 72.611992 77.345093">ELSE </tspan><tspan y="-631.98212" x="76.679993 78.748192 83.489388 85.708786 91.412987 96.092087 100.83239 104.07419 108.51839 113.32079 117.95399 122.75639 124.73819 128.87909 133.56628 135.78569 140.94719 143.1666 148.4028">IF OperandSize = 16</tspan><tspan y="-619.98242" x="94.679993 99.889191 105.71039 110.46059">THEN</tspan><tspan y="-607.98273" x="112.67999 117.3951 119.48219 124.59329 126.75239 128.49748 133.65898 135.87839 140.98949 145.70459 150.35669 152.9388 155.5209">EIP := Pop();</tspan><tspan y="-595.98303" x="112.67999 117.41039 119.51279 124.63919 126.79829 128.55869 133.68509 135.90448 140.58539 142.68599 147.81239 150.03178 155.64418 161.49957 167.03998 169.25937 174.52977 179.80017 185.02017 190.29057 194.97147 199.70187 204.43228 209.11319 214.9686">EIP := EIP AND 0000FFFFH;</tspan><tspan y="-583.98334" x="112.67999 117.41039 122.19479 124.35389 126.11429 131.24069 133.46008 138.58649 143.31689 147.9843 150.5817 153.17909 155.05649 157.27588 159.87328 163.90167 166.12106 171.39146 176.61147 179.45186 184.07156 186.02997 189.41037 191.62976 196.24947 200.99066 205.65807 207.53546 209.75485 213.77425 218.45515 223.12256 230.02286 234.74426 239.48636 242.86676 245.08615 249.70586 254.44617 258.40799 262.3671 265.6395 267.561 272.22839 275.6088 280.3392 283.6116 285.83099 287.76239 292.4928 296.9325 301.61157 306.29248 310.97156 313.19095 317.21936">CS := Pop(); (* 16-bit pop; segment descriptor loaded *)</tspan><tspan y="-571.98364" x="112.67999 117.39059 122.193 124.7706 130.1832 135.28979 139.78889 142.3665 144.5256 146.2662 151.3728 153.59221 159.05161 163.7325 167.09309 171.89549 175.14809 179.95049 184.66109 189.37169 194.01929 198.72089 203.52328 208.20418 212.85178 219.78537 224.52567 229.26776 232.68776 237.42986 242.17015 244.09166 248.79326 252.68486 256.04547 260.75607 264.00867 266.64746 272.06006 277.16666 281.61627 284.25507">CS(RPL) := ReturnCodeSegmentSelector(RPL);</tspan><tspan y="-559.98395" x="112.67999 114.79139 119.53079 121.75019 123.71759 128.45969 132.48808 135.87749 139.11929 143.92169 147.84209 151.23149 153.1989 157.87979 162.67319 164.89258 169.63467 174.13377 178.16217 180.38156 182.30307 189.26367 196.16397 200.90428 205.58069 207.5022 211.94189 215.36189 220.0428 222.26219 227.00159 231.62129 236.3517 239.59351 244.0809 248.823">IF instruction has immediate operand</tspan><tspan y="-547.98425" x="130.67999 135.8694 141.72479 146.4552 152.31061 154.53 157.1274 161.15579 163.37518 168.80759 173.48849 175.41989 180.1413 184.58099 188.60309 193.284 195.50339 200.17079 204.61049 207.88289 212.32259 219.27599 223.95689 227.3373 232.0182 235.2906 239.31 241.52939 244.87379 248.14619 252.87659 259.77689 261.99628 265.90768 270.38608 272.31747 274.24887 278.97028 283.58997 285.80936 290.47675 293.74915 298.47955 302.39096 307.07187 311.75095 316.49304 319.79514 324.47604 326.09784 330.11725 332.33664 336.29846 339.71848 344.15817 348.05789 352.34729 354.56668 358.59509">THEN (* Release parameters from called procedure’s stack *)</tspan><tspan y="-535.98456" x="148.67999 150.72119 155.4624 157.68181 162.45721 165.82861 170.29802 174.20042 178.48082 184.08421 188.70392 193.38303 196.64642 201.35883 205.36923 209.37964 214.15504 216.10445 220.26785">IF StackAddressSize</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-535.97998" x="224.94"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-535.97998" x="227.45988">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-535.97998" x="232.92"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-535.97998" x="235.19969 240.48">32</tspan><tspan y="-523.98029" x="166.67999 171.84689 177.67979 182.3877 188.2206">THEN </tspan><tspan y="-511.98059" x="184.67999 189.396 194.166 199.278 201.49741 203.24341 208.35541 210.57481 215.29082 220.06082 225.17282">ESP := ESP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-511.98059" x="227.4003">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-511.98059" x="232.3206 234.53999 239.33429 244.7343 249.47459"> SRC;</tspan><tspan y="-499.9809" x="166.68091 171.3708 175.7997 180.6021">ELSE</tspan><tspan y="-487.9812" x="184.68091 186.72211 191.46332 193.68272 198.45993 201.83313 206.30434 210.20854 214.49074 220.09593 224.71564 229.39474 232.65994 237.37415 241.38635 245.39856 250.17577 252.12697 256.29218 261.00638 263.22577 268.34497 270.56436 275.78436">IF StackAddressSize = 16</tspan><tspan y="-475.98151" x="202.68091 207.85951 213.70412 218.42372">THEN</tspan><tspan y="-463.98181" x="220.68091 225.43651 230.5341 232.75351 234.55531 239.65651 241.87592 246.63152 251.79301">SP := SP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-463.98181" x="253.98091">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-463.98181" x="258.90121 261.12061 265.8663 271.32571 276.01743"> SRC;</tspan><tspan y="-451.98212" x="202.68091 207.3618 211.8006 216.59219 221.32979 223.54918 226.15378 230.18938 232.40877 237.15086 240.51057 244.99617 248.91476 253.17447 258.81387 263.43356 268.11264 271.35443 276.09473 280.05655 284.07867 288.87027 290.79178 294.97137 299.65228">ELSE (* StackAddressSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-451.98001" x="301.85999">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-451.98001" x="307.38"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-451.98001" x="309.60031 314.8707 320.09067 322.31006 326.33847">64 *)</tspan><tspan y="-439.98032" x="220.68031 226.08571 230.84311 236.00461 238.22401 239.95741 245.05681 247.27621 252.68161 257.48404 262.58344">RSP := RSP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-439.98032" x="264.7803">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-439.98032" x="269.70059 271.92001 276.71432 282.11432 286.85461"> SRC;</tspan><tspan y="-427.98062" x="184.6803 189.36121 191.46181">FI;</tspan><tspan y="-415.98093" x="148.6803 153.36121 155.46181">FI;</tspan><tspan y="-403.98123" x="112.6803 117.4152 119.5221">FI;</tspan><tspan y="-391.98154" x="112.6803 116.1003 120.7812 127.7229 132.3786 137.09731 141.87001 146.98471 149.14381 150.89252 156.00722 158.22662 163.38812 168.12933 172.78503 175.37073 177.95642">tempESP := Pop();</tspan><tspan y="-379.98184" x="112.6803 116.1003 120.7812 127.71391 132.36061 137.12431 141.88802 144.10742 145.90923 151.01042 153.16953 158.27522 162.98492 167.63162 170.27043 172.84714 174.70384 176.92325 179.49995 183.50766 185.72707 190.97676 196.22646 199.04616 203.69286 205.63055 209.05055 211.26996 215.91666 220.6803 225.3 227.2197 229.43909 233.40088 238.14119 242.80949 249.70979 254.4321 259.17419 262.55548 264.7749 269.44321 274.12408 278.14438 282.05667 285.32996 287.25143 291.91974 295.30103 300.03232 303.3056 305.52502 307.45734 312.18863 316.62833 321.30743 325.98831 330.66742 332.88684 336.91614">tempSS := Pop(); (* 16-bit pop; segment descriptor loaded *)</tspan><tspan y="-367.98215" x="94.680298 99.376495 103.8117 108.6141 113.35529 115.57469 118.13789 122.1321 124.35149 130.05569 134.73479 139.42198 142.72409 147.16829 151.97069 156.60388 161.40628 163.33047 167.53168 172.21887">ELSE (* OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-367.98001" x="174.42 179.93983">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-367.98001" x="182.39999 187.67039 192.8904 195.10979 199.13818">64 *)</tspan><tspan y="-355.98032" x="112.6797 118.1013 120.19289 125.30849 127.46759 129.21719 134.33279 136.5522 141.7137 146.39461 151.05121 153.6378 156.2244">RIP := Pop();</tspan><tspan y="-343.98062" x="112.6797 117.40289 122.18009 124.33919 126.09238 131.21158 133.43098 138.55019 143.27339 147.93359 150.52379 153.11398 154.98418 157.20358 159.79378 163.81497 166.03438 171.29758 176.56078 179.44168 184.06139 186.01259 189.38579 191.60519 196.2654 200.9886 205.6488 207.4794 209.69879 214.44089 216.4227 221.0424 225.8448 228.6852 233.41559 236.68799 241.35539 246.0363 249.33839 251.55779 256.77777 262.05804 264.27744 268.94482 270.86633 274.24673 278.26614 280.48553 285.15292 287.07443 291.09384 295.00525 299.44495 302.74704 307.36673 312.10703 316.72672 318.64642 320.86581 324.82764 329.56793 334.23532 335.91562 338.13501 342.8024 347.48331 351.50272 355.41412 358.68652 360.64493 365.26462 368.68463 373.36554 376.66763 378.88702 380.81842 385.49933 389.97772 394.59741 399.31882 403.93851 406.1579 410.18631">CS := Pop(); (* 64-bit pop; high-order 48 bits discarded; seg. descriptor loaded *)</tspan><tspan y="-331.98093" x="112.6797 117.3903 122.1927 124.7703 130.18291 135.28951 139.7886 142.36621 144.52531 146.26591 151.37251 153.59192 159.05132 163.73221 167.0928 171.8952 175.1478 179.9502 184.6608 189.3714 194.019 198.7206 203.52299 208.20389 212.85149 219.78508 224.52538 229.26747 232.68747 237.42957 242.16986 244.09137 248.79297 252.68457 256.04517 260.75577 264.00836 266.64716 272.05975 277.16635 281.61597 284.25476">CS(RPL) := ReturnCodeSegmentSelector(RPL);</tspan><tspan y="-319.98123" x="112.6797 114.79109 119.53049 121.7499 123.7173 128.4594 132.48779 135.8772 139.119 143.9214 147.8418 151.2312 153.19861 157.8795 162.6729 164.89229 169.63438 174.13348 178.16188 180.38127 182.30278 189.26338 196.16368 200.90399 205.5804 207.50191 211.9416 215.3616 220.04251 222.2619 227.0013 231.621 236.35141 239.59322 244.08061 248.82271">IF instruction has immediate operand</tspan><tspan y="-307.98154" x="130.67969 135.86909 141.72449 146.4549 152.3103 154.52969 157.12709 161.15549 163.37488 168.80728 173.48819 175.41959 180.14099 184.58069 188.60278 193.28369 195.50308 200.17049 204.61018 207.88258 212.32228 219.27568 223.95659 227.33699 232.0179 235.2903 239.30969 241.52908 244.87349 248.14589 252.87628 259.77658 261.99597 265.90738 270.38577 272.31717 274.24857 278.96997 283.58966 285.80905 290.47644 293.74884 298.47925 302.39066 307.07156 311.75064 316.49274 319.79483 324.47574 326.09753 330.11694 332.33633 336.29816 339.71817 344.15787 348.05759 352.34698 354.56638 358.59479">THEN (* Release parameters from called procedure’s stack *)</tspan><tspan y="-295.98184" x="148.67969 154.08508 158.84248 164.00398 166.22339 167.95679 173.05618 175.27559 180.68098 185.48338 190.58278">RSP := RSP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-295.98184" x="192.77969">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-295.98184" x="197.7 199.91939 204.71368 210.11369 214.85399"> SRC;</tspan><tspan y="-283.98215" x="112.6797 117.4146 119.5215">FI;</tspan><tspan y="-271.98245" x="112.6797 116.09969 120.78059 127.72229 132.37799 137.09669 141.8694 146.9841 149.1432 150.89191 156.00661 158.22601 163.38751 168.12872 172.78442 175.37012 177.95581">tempESP := Pop();</tspan><tspan y="-259.98276" x="112.6797 116.09969 120.78059 127.74119 132.36089 137.16328 141.90538 144.12479 145.92659 151.02779 153.18689 158.28178 163.02298 167.65887 170.29768 172.86359 174.70949 176.92889 179.4948 183.4917 185.71111 190.99141 196.21141 199.02031 203.6994 205.6263 209.04631 211.26572 215.90161 220.64281 225.2787 227.19841 229.41782 234.17072 236.15251 240.78841 245.59081 248.3997 253.1409 256.38181 261.06091 265.75082 269.05292 271.21201 276.49231 281.77261 283.992 288.6279 290.60971 293.95862 297.98074 300.20013 304.83603 306.81784 310.83997 314.73969 319.18658 322.48868 327.12457 331.8649 336.50079 338.34668 340.56607 344.5882 349.32852 353.96442 355.70502 357.92441 362.5603 367.30063 371.32275 375.22247 376.90637 379.12576 381.02567 385.76688 390.21378 394.89288 399.58279 404.2619 406.48129 410.47818">tempSS := Pop(); (* 64-bit pop; high-order 48 bits discarded; seg. desc. loaded *)</tspan><tspan y="-247.98306" x="76.679695 81.360596 83.461197">FI;</tspan><tspan y="-235.98337" x="45.119392 49.800293 51.90089">FI;</tspan><tspan y="-211.98306" x="45.119392 47.187592 51.883793 54.103191 58.905594 63.647694 68.146797 72.825897 77.522095 84.482689 89.232887 92.652885 97.097084 100.97428 105.22948 109.97068 114.72088 119.21998 123.89908 125.82058 130.50778 135.18687 137.75008 142.44627 147.60777 152.04657">IF ShadowStackEnabled(CPL)</tspan><tspan y="-199.98337" x="58.619392 61.258194 65.280296 67.499695 71.401192 76.17569 80.887192 84.788689 89.068192 91.28759 93.236092 96.570595 98.789993 104.05049 106.26989 110.92739 115.60289 118.97339 123.68489 125.90429 130.37279 132.29428 134.24278 138.90028 143.67479 148.38629 153.04379 155.2632 159.28169">(* check if 8 byte aligned *)</tspan><tspan y="-187.98367" x="58.619392 60.718193 65.444992 67.664391 72.44519 77.187294 82.310097 84.529495 90.138298 95.990097 101.52689 103.74629 109.01309 113.75069 119.01749 121.23689 122.9847 128.1075 130.3269">IF SSP AND 0x7 != 0</tspan><tspan y="-175.98398" x="76.679695 81.859192 87.704689 92.425186 98.270683 100.49008 106.25459 110.97508 116.09158 118.67908 123.39958 129.00208 134.42458 137.25508 142.67758 147.39809 152.57759 155.70509 157.79759 163.22009 167.9406 173.1201 175.7076 177.57509 179.79449 184.515 186.6075">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-163.98428" x="58.619392 60.721794 65.452194 67.671593 73.103996 77.825394 81.205795 85.990196 89.262596 94.0047 98.7351 103.4655 108.0852 112.80659 117.5487 122.2701 126.88979 133.8432 138.56461 143.3067 146.6664 151.45079 156.1317 158.0631 162.7845 166.69591 170.07631 174.8067 178.0791 180.6765 186.1089 191.23531 195.70471 198.30211 200.5215 202.2729 207.39931">IF ReturnCodeSegmentSelector(RPL) !=3</tspan><tspan y="-151.98459" x="76.679695 81.888893 87.710091 92.460289">THEN</tspan><tspan y="-139.98489" x="94.679695 98.099693 102.78059 109.74119 114.36089 119.16329 123.18539 127.88429 132.68669 134.9061 140.00099 142.2204 146.24249 151.04489 155.49179 160.17088 164.86978 171.83038 176.39157 180.35338 183.77339 188.21309 192.09299 196.35089 200.91208 202.83359 207.57478 212.01448 216.69357 218.91298 224.19328 226.41269 231.04858 235.70248 239.05139 243.79169 247.81378 250.03319 253.34608 256.58698 261.32819 268.28879 270.50818 275.26108 280.06348 285.15839 290.30728 295.58759 300.80759">tempSsCS = shadow_stack_load 8 bytes from SSP+16;</tspan><tspan y="-127.98519" x="94.679695 98.099693 102.78059 109.7178 114.369 119.13719 123.14039 127.59359 129.67979 134.78999 137.0094 142.1196 144.339 148.34221 153.11041 157.57262 162.22382 166.93802 173.87521 178.41841 182.42162 185.78581 190.24802 194.14322 198.46231 203.00551 204.95938 209.70058 214.19968 218.83377 221.05318 226.33348 228.55289 233.18698 237.83908 241.18619 245.92648 249.94858 252.16798 255.47908 258.78116 263.47827 270.43887 272.65826 277.46066 282.20276 287.29587 292.44296 297.72327">tempSsLIP = shadow_stack_load 8 bytes from SSP+8;</tspan><tspan y="-115.98549" x="94.679688 98.06279 102.74369 109.69979 114.31949 119.10659 123.84869 128.9778 131.19719 136.32629 138.54568 142.56778 147.30988 151.79097 156.41068 161.14377 168.09987 172.60077 176.62286 180.00597 184.48706 188.40115 192.69325 197.25536 199.18945 203.92255 208.36224 213.03235 215.25174 220.47174 222.69113 227.36124 232.04933 235.43243 240.11334 244.13544 246.35483 249.70193 252.97704 257.71014 264.66623 266.88565 271.62775 276.43015 281.55923">tempSSP = shadow_stack_load 8 bytes from SSP;</tspan><tspan y="-103.98579" x="94.679688 99.458687 104.23769 109.35869 111.57809 116.69909 118.91849 123.69749 128.43959 133.56059 135.78 140.955 143.17441 148.43941 153.70441">SSP = SSP + 24;</tspan><tspan y="-91.986084" x="94.679688 97.318489 101.34059 103.55999 109.08599 113.80199 116.02139 121.27739 126.53339 128.75279 133.40579 135.34979 138.71579 140.9352 144.8322 149.5482 156.4872 161.1402 165.6042 168.9063 173.6133 175.8327 179.1987 183.9147 186.13411 190.78711 195.49411 198.86011 203.56711 207.46411 210.84 213.05939 217.67909 219.6609 223.04221 227.0625 229.28189 233.9502 238.6311 243.3174 248.04871 252.7908 257.46991 259.68933 264.90933 270.18964 272.40906 277.07736 281.75824 283.71753 288.45963 293.12793 295.34735 299.30914 304.04944 307.43073 309.65015 313.67944">(* Do 64 bit compare to detect bits beyond 15 being set *)</tspan><tspan y="-79.986382" x="94.679695 98.099693 102.78059 109.72409 114.38159 119.10209 123.87659 126.09599 131.21248 133.43188 138.15239 142.9269 144.79439 147.01379 149.60129 153.61978 155.83919 160.00169 164.7132 167.97569 172.6962 174.9156 179.5731 184.04161 188.69911 193.35661 198.06812 202.72562 204.94502 208.36502 213.04593 215.26534 220.52583 225.78633 228.00574 232.66324 234.61174 237.98224 240.20164 244.22014">tempCS = CS; (* zero padded to 64 bit *)</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="389.44745pt" height="632.28687pt" viewBox="0 0 389.44745 632.28687" sodipodi:docname="1285.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.27673" inkscape:cy="407.52639" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg184" /><g transform="translate(-46.29245,-69.35791)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="95.519997 97.609795 102.32759 104.54699 107.91479 112.62359 119.56439 124.21919 128.937 133.7088 135.92821 137.66701 142.78081 145.00021 148.42021 153.10112 160.04192 164.69672 169.46852 173.47533 178.19313">IF tempCS != tempSsCS</tspan><tspan y="-703.98029" x="113.52 118.69949 124.54499 129.26549 135.11099 137.3304 143.09489 147.8154 152.9319 155.51939 160.2399 165.84239 171.26489 174.0954 179.5179 184.2384 189.41791 192.54541 194.63791 200.06041 204.78091 209.96042 212.54791 214.41541 216.63481 221.35532 223.44781">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-691.98059" x="95.519997 98.116493 102.144 104.3634 109.90289 114.58379 116.80319 122.07269 127.34219 129.56158 134.18129 136.1631 139.5426 141.76199 145.6725 150.35341 157.30591 161.97241 166.41211 169.7142 174.39511 176.2554 178.47479 183.1413 187.58099 192.2475 194.46689 199.1478 203.9502 209.2737 214.88519 219.62729 224.39999 229.54889 235.00829 237.07919 242.24069 244.4601 251.382 253.3638 256.71271 261.51511 263.7345 268.97339 271.19278 274.55157 279.23248 282.53458 284.75397 289.99286 295.27316 297.49255 302.17166 304.09317 307.44208 309.66147 314.16055 316.20175 321.36325 323.58264 327.57953">(* Do 64 bit compare; pad CSBASE+RIP with 0 for 32 bit LIP *)</tspan><tspan y="-679.9809" x="95.519989 97.623291 102.35459 104.57399 109.30529 114.04739 119.3727 124.95269 129.73799 134.4189 136.63829 141.8196 144.03899 149.47229 151.57559 156.7029 158.92229 160.67459 165.8019 168.02129 171.40259 176.12489 183.02519 187.7043 192.48959 196.45139 200.92169 203.02499">IF CSBASE + RIP != tempSsLIP</tspan><tspan y="-667.9812" x="113.51999 118.69949 124.54498 129.26549 135.11099 137.3304 143.09489 147.8154 152.9319 155.51939 160.2399 165.84239 171.26489 174.0954 179.5179 184.2384 189.41791 192.54541 194.63791 200.06041 204.78091 209.96042 212.54791 214.41541 216.63481 221.35532 223.44781">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-655.98151" x="95.519989 98.158791 102.18089 104.40029 108.30179 113.07629 117.78779 121.68929 125.96879 128.18819 130.13669 133.47119 135.6906 140.9511 143.1705 147.828 152.50351 155.87401 160.58551 162.80492 167.27342 169.19492 171.14342 175.80092 180.57542 185.28693 189.94443 192.16383 196.18233">(* check if 4 byte aligned *)</tspan><tspan y="-643.98181" x="95.519989 97.616089 102.34019 104.55959 107.93369 112.64879 119.54909 124.22819 128.97029 133.77271 138.89281 141.11221 146.71831 152.56741 158.10152 160.32092 165.58502 170.32262 175.58672 177.80612 179.55122 184.67133 186.89073">IF tempSSP AND 0x3 != 0</tspan><tspan y="-631.98212" x="113.51999 118.69949 124.54498 129.26549 135.11099 137.3304 143.09489 147.8154 152.9319 155.51939 160.2399 165.84239 171.26489 174.0954 179.5179 184.2384 189.41791 192.54541 194.63791 200.06041 204.78091 209.96042 212.54791 214.41541 216.63481 221.35532 223.44781">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-619.98242" x="59.519989 64.25489 66.361794">FI;</tspan><tspan y="-607.98273" x="46.019989 50.70089 52.801487">FI;</tspan><tspan y="-595.98303" x="46.019989 49.382389 54.085789 61.021187 65.670586 71.390984 73.304382 77.953781 82.666183 87.827682 92.266479 94.485886 99.594284 101.81369 106.52609 111.63449 116.08589">tempOldCPL = CPL;</tspan><tspan y="-583.98334" x="46.019989 50.734188 55.895687 60.348888 62.568287 64.312485 69.422684 71.642082 77.101479 81.782379 85.146576 89.91478 93.170982 97.939178 102.65338 107.36758 112.01878 116.72398 121.49219 126.19739 130.84859 137.78578 142.49098 147.25919 150.62338 155.39159 160.09679 162.01199 166.71719 170.6124 173.97659 178.6908 181.99289 184.5723 189.98849 195.09869 199.59779 202.1772">CPL := ReturnCodeSegmentSelector(RPL);</tspan><tspan y="-571.98364" x="46.019989 50.718887 55.521286 60.616188 62.835587 64.564484 69.725983 71.945381 75.294281 79.984184 86.944778 91.623878 96.322777 101.12518 106.22008">ESP := tempESP;</tspan><tspan y="-559.98395" x="46.019989 50.78009 55.582493 57.801895 59.537994 64.640091 66.859489 70.279495 75.019791 81.980392 86.60009 91.402489 96.144592">SS := tempSS;</tspan><tspan y="-547.98425" x="46.019989 49.403088 54.083988 61.040089 65.71019 71.408089 73.329582 77.99968 82.741783 87.528885 92.657982 94.87738 100.00648 102.22588 107.01298 111.75508 116.88418">tempOldSSP = SSP;</tspan><tspan y="-535.98456" x="46.019989 48.130489 52.81139 55.030788 59.823288 64.565392 69.051895 73.671593 78.410095 85.371597 90.113701 93.473404 97.959908 101.87941 106.13911 110.88031 115.62241 120.12152 124.74122 126.72211 131.40302 136.08212 138.68762 143.36852 148.50302 152.94182">IF ShadowStackEnabled(CPL)</tspan><tspan y="-523.98486" x="59.519989 61.60799 66.32399 68.543388 73.259392 78.371391 82.826393 85.045792 90.157791 92.37719">IF CPL = 3</tspan><tspan y="-511.98517" x="77.519989 82.727386 88.548584 93.296982 99.118179 101.33758 104.69728 109.43758 116.33788 121.01698 125.81938 130.56148 135.66267 137.88208 139.66048 144.76167 146.99998 149.09879 154.70758 159.97438 165.19438 169.75018 174.87299 179.33879 184.55879 189.11459 193.89539 198.67618 203.79898 205.67278 207.89218 212.61899 214.71779">THEN tempSSP := IA32_PL3_SSP; FI;</tspan><tspan y="-499.98547" x="59.519981 61.614281 66.336578 68.555977 71.145279 75.867577 80.609673 82.350273 86.811577 89.030975 94.149277 96.368675 101.63097 103.85037 109.45467 115.30197 120.83427 123.05367 126.42597 131.10687 138.05217 142.71147 147.45358 152.25598 157.37428 160.13458 165.39688 170.61688 172.36919 177.63148 182.89378 185.65408 187.87349 189.61679 194.73509 196.9545 202.2168 204.80609 207.0255 212.7234">IF (CS.L = 0 AND tempSSP[63:32] != 0) OR</tspan><tspan y="-487.98578" x="69.599983 72.19828 76.929581 81.671684 83.412285 87.851082 90.07048 95.197784 97.417183 102.68848 104.90788 110.48788 116.30907 121.85037 124.06977 127.45107 132.13197 139.08627 143.70598 148.49127 153.27657 158.40387 160.62326 162.54477 166.56686 168.78625 173.57155 178.25246 181.63376 183.85315 187.76544 192.24474 196.98683 201.72804 206.51334 208.43484 212.34714 216.82643 218.75873 220.97998 224.22987 228.97017 230.87907 235.33498 238.69287 240.67467 245.30157 250.00047 252.21988 255.63988 260.32077 262.54016 265.89807 270.70047 275.4408 277.66019 281.54907 286.31097 289.56088 292.86298 297.56189 302.36429 305.7222 307.94159 312.58649 317.04239 321.68729 323.6232 328.4256 333.04529 335.26468 342.19559 346.90347 351.54837 356.2887">(CS.L = 1 AND tempSSP is not canonical relative to the current paging mode)</tspan><tspan y="-475.98608" x="77.519989 82.700386 88.546783 93.268181 99.114578 101.33398 107.09938 112.36978 117.48718 120.07558 125.33698 127.92538 129.79378 132.01318 136.73459 138.82799">THEN #GP(0); FI;</tspan><tspan y="-463.98639" x="59.519989 64.312492 69.054596 74.189095 76.408501 78.177002 83.311501 85.530907 88.919411 93.648911 100.54921 105.22831 110.02081 114.76292">SSP := tempSSP</tspan><tspan y="-451.98669" x="46.019989 50.70089 52.801487">FI;</tspan><tspan y="-439.987" x="46.019989 48.612888 52.636787 54.856186 60.677383 65.418579 72.367477 74.586876 79.206581 83.705681 87.66748 91.087479 93.306877 97.746574 99.673477 101.60038 103.81978 107.15968 111.59937 116.37927 118.30618 121.68208 123.60358 128.38348 133.04639 135.26579 139.8855 144.62671 146.54822 151.35063 154.72653 158.74142 160.61432 162.83998 166.84409 171.30719 174.63629 179.34239 181.5618 184.9269 189.642 191.8614 195.19051 198.4476 203.1537 207.8598 210.07921 213.44431 218.21341 222.91951 225.13892 228.50401 233.21912 237.49321 242.19931 246.96841 248.70901 250.92842 256.10251 260.87161 265.5777 267.79709 271.1622 275.87729 280.1514 284.94028 289.69229 291.91171 295.27054 298.51233 303.25262 307.93353 310.15295 312.13474 316.15683 318.37625 323.01126 327.75247 332.50449 337.24478 339.4642 344.21622 348.20322 350.185 354.92712 359.60623 361.82565 365.17365 369.97607 374.66507 376.88449 381.6257 383.54718 388.18219 390.40161 395.20404 399.94617">(* Now past all faulting points; safe to free the token. The token free is done using the old SSP</tspan><tspan y="-427.9873" x="46.019989 50.05109 52.270489 56.710186 61.512585 66.132286 68.351685 73.138786 77.160889 79.08239 83.884789 88.504486 90.723885 95.204987 97.424385 101.44649 106.18859 110.85869 115.53959 118.81469 123.46679 125.38829 129.41039 134.14348 137.41858 139.63797 144.37106 149.02316 153.74727 157.02237 160.29747 162.25858 166.92868 171.60959 173.82898 178.26868 182.29077 184.51016 189.24326 191.17735 195.84746 198.06685 202.74774 207.84895 212.32106 214.54045 221.44075 225.93985 229.96194 232.18134 236.62103 238.84042 242.86252 247.60461 252.27472 256.99881 260.2739 264.92599 266.88708 270.84888 275.59006 278.86514 281.08456 285.70425 288.94604 290.90714 295.55923 297.52032 299.45444 304.13531 308.81442 313.4953 315.71472 317.64883 322.37292 327.02502 331.74911 333.68323 335.90265 339.93375">* and using a supervisor override as old CPL was a supervisor privilege level *)</tspan><tspan y="-415.98761" x="46.019989 48.126888 52.807789 55.027187 59.816086 64.558189 69.041092 73.660789 78.395691 85.353592 90.095695 93.455399 97.938301 101.8542 106.1139 110.8551 115.59721 120.09631 124.716 126.6969 131.37781 136.05692 138.65881 142.04372 146.72462 153.68523 158.35713 164.05504 165.99094 170.66284 175.34373 180.50523 184.94405">IF ShadowStackEnabled(tempOldCPL)</tspan><tspan y="-403.98792" x="59.519989 64.260284 69.058189 73.696793 78.437088 82.319687 85.671288 90.363892 95.042992 99.573593 102.92519 107.66639 111.92609 116.61868 121.42108 125.95168 130.57228 135.02188 136.92448 141.72688 146.46718 148.68658 153.78418 156.00359 159.35518 164.04778 171.00838 175.68747 181.39706 183.29967 187.97876 192.72086 197.52325 202.62445 204.84386 206.82565 209.04506 214.34065 220.04214 224.79774 229.95924 234.48984 239.83133 241.90492 247.06552 275.56494 277.79968 280.39258 284.41647 286.63589 291.25558 296.05798 300.07288 304.6926 306.91202 311.57492 313.52881 316.90472 319.12415 321.96005 324.17947 328.84238 330.76385 334.13977 336.35919 341.02209 345.70297 349.71786 351.67175 355.04767 356.99969 361.7175 366.48929 368.70868 373.96649 376.18588 379.01367 381.23306 388.17386 392.94565 396.90744 400.32742 402.54681 407.2016 411.9104 414.12979 418.1366 422.8454 426.2132 428.43259 432.44839">expected_token_value = tempOldSSP | BUSY_BIT  (* busy bit - bit position 0 - must be set *)</tspan><tspan y="-391.98822" x="59.52002 64.294518 69.00602 75.949516 80.499016 83.869514 88.590012 92.869514 97.581017 102.35551 106.90501 111.54452 116.01302 117.93452 122.70901 127.42052 129.63992 134.75642 136.97583 140.34633 145.05783 152.00133 156.65883 162.38733 164.30882 168.96632 173.74083 178.51534 183.63184 185.85124 188.07065 190.29005 192.50946 194.72887 196.94827 199.16768 201.38708 203.60649 205.8259 208.02002 210.23943 212.45883 214.67824 216.89764 219.11705 221.33646 223.55586 225.77527 227.99467 275.5741 277.79349 280.3783 284.3941 286.61349 290.5123 292.43109 297.13989 301.60568 304.86548 307.08487 310.45267 315.22446 319.93326 322.15265 326.80743 331.57922 335.58603 340.25882 342.47821 347.133 349.0788 352.44659 354.66599 358.68179">new_token_value = tempOldSSP                      (* clear the busy bit *)</tspan><tspan y="-379.98853" x="59.52002 63.533119 68.311218 72.783318 77.44442 82.168518 89.115616 93.668716 97.681816 101.05592 105.52802 109.43311 113.71622 118.21712 120.13862 124.86272 128.76782 133.05092 137.60402 141.50912 148.45622 153.11732 157.90442 161.80952 166.58763 171.24873 176.51283 181.17393 183.72003 187.10674 191.78764 198.74734 203.42105 209.11896 211.04045 215.71416 220.45625 225.24695 230.37965 232.17876 234.39815 239.18884 243.86975 250.82945 255.39516 258.78186 263.51855 267.77826 272.45914 277.24985 281.81555 286.43436 290.93347 292.87119 297.61328 302.34097 304.14008 306.3595 311.08719 315.8248 320.4985 325.17938 329.09708 332.48376 337.16464 341.84375 346.34467 349.76465 354.44556 358.76468 363.44556 368.24796 372.74887 377.42798 381.86768 383.78918 388.5799 393.26077">shadow_stack_lock_cmpxchg8b(tempOldSSP, new_token_value, expected_token_value)</tspan><tspan y="-367.98883" x="46.020035 50.700935 52.801533">FI;</tspan><tspan y="-343.98853" x="46.020035 50.716236 56.474438 61.872639 64.092041 68.832344 73.272041 77.149239 81.951637 84.171036 88.867233 92.226036 94.445435 98.467537 103.14844 107.82754 114.72784 119.46814 124.21024 127.63023 129.84964 133.08784 137.82814 142.46133 144.44313 148.42833 151.84834 156.53554 159.77374 161.99315 164.63196 169.31285 174.11525 175.91435 178.13376 182.87495 187.61705 189.47556 191.69496 196.97525 201.71735 203.57585 205.79526 210.23946 215.04185 219.67505 221.89445 227.40065 232.20305">FOR each of segment register (ES, FS, GS, and DS)</tspan><tspan y="-331.98883" x="59.520035 65.098236">DO</tspan><tspan y="-319.98914" x="77.520035 79.620636 84.361832 86.58123 90.603325 95.284225 99.963326 106.86362 111.60393 116.40633 119.75072 121.97012 125.20652 129.94682 134.57822 136.56001 140.54341 143.96342 148.64882 151.95093 154.17032 158.80171 163.54291 165.4653 170.22003 173.58873 177.59644 179.81584 183.18454 187.90324 190.12265 194.77835 199.24506 202.61375 207.08046 209.29987 214.01857 217.27927 219.49867 224.27138 228.99008 233.76279 236.59149 240.4912 245.21973 249.96182 253.32063 258.05463 261.33063 268.28763 270.20914 274.99713 279.61682 281.83621 285.75122 290.48523 295.15622 299.83713 302.05652 306.07953 310.76044 315.43143 322.38843 327.06934 331.87173">IF segment register points to data or non-conforming code segment</tspan><tspan y="-307.98944" x="77.52002 82.012817 86.754913 91.436714 93.656113 98.400909 103.50211 107.94092">and CPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-307.98944" x="110.16032">&gt;</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-307.98944" x="115.08063 117.30003 121.31763 126.03723 130.65694 137.61754 142.29845 147.10086 150.47946 152.69885 157.36446 162.04536 166.06296 169.97256 173.24316 175.19977 179.86537 183.24397 187.92488 191.22697 193.44637 198.98497 204.10957 208.57718 210.45277 212.67216 215.26776 219.29436 221.51375 227.05235 232.17696 236.64456 238.86395 240.82056 245.56265 247.78204 252.56464 254.48615 259.15173 263.81732 268.49823 273.28082 275.50021 280.1199 284.61899 287.88959 291.26819 293.48758 298.21619 301.51556 303.73495 307.75256 312.47217 317.09186 324.05246 328.73337 333.53577 336.91437 339.13376 342.40436 347.08527 351.75085 353.67236 357.68997 361.06857 365.78818 369.05878 371.27817 375.30478"> segment descriptor DPL; (* DPL in hidden part of segment register *)</tspan><tspan y="-295.98975" x="95.520927 100.73913 106.56033 111.30153 117.12273 119.34212 124.14452 128.82542 133.50452 140.40483 145.14513 149.88722 153.30722 158.04932 162.78961 164.71112 169.40552 173.28992 176.64331 181.38451 184.62991 186.84932 188.65112 193.75232 195.97173 201.21512 203.13483 205.35423 207.92464 211.92604 214.14545 218.90285 223.64314 228.28354 235.24414 239.93854 244.74094 248.09433 252.89673 257.59113 259.49551 264.23581 268.1355 271.48889 276.2301 279.47549 281.69489 283.62628 288.42868 293.05109 297.55017 299.45456 301.38596 306.06506 308.28445 312.28586">THEN SegmentSelector := 0; (* SegmentSelector invalid *)</tspan><tspan y="-283.99005" x="77.520927 82.255829 84.362732">FI;</tspan><tspan y="-271.99036" x="59.520927 65.25843 70.797928">OD;</tspan><tspan y="-247.99005" x="46.020927 48.130527 52.811424 55.030823 56.996422 61.738522 65.765121 69.152725 72.432327 77.174431 81.093033 84.480637 86.446236 91.183838 95.925941 98.145348 102.93695 107.37666 111.40326 113.62267 115.54417 122.50477 129.46536 134.14627 138.82088 140.74239 145.22798 148.61559 153.29649 155.51588 160.25348 164.92809 169.60899 172.9111 177.3508 182.1532">IF instruction has immediate operand</tspan><tspan y="-235.99036" x="59.520927 64.701324 70.547722 75.269119 81.115517 83.334915 85.923317 89.942719 92.162117 97.585518 102.29792 104.22032 108.93272 113.40212 117.41252 122.12492 124.34432 129.00272 133.47212 136.73552 141.20493 148.14932 152.86172 156.23312 160.94553 164.20892 168.21933 170.43874 173.77414 177.00063 181.73732 188.63762 190.85701 194.7747 199.2594 201.1971 203.1348 205.0563 209.847 214.52071 216.7401 221.3598 224.66191 229.3428 233.24249 237.9702 242.5899 247.3806 250.62241 255.35011 256.91251 260.9382 263.15762 267.18332 270.57001 275.0097 278.90939 283.20508 285.4245 289.4592">THEN (* Release parameters from calling procedure’s stack *)</tspan><tspan y="-223.99066" x="77.520927 79.621529 84.350128 86.569527 91.352127 94.730728 99.207329 103.11693 107.40453 113.01513 117.63483 122.31393 125.58453 130.30414 134.32173 138.28352 143.06613 145.02274 149.19333">IF StackAddressSize</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cAF7646FE"><tspan y="-223.98" x="153.84"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-223.98" x="156.35988">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-223.98" x="161.82001"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-223.98" x="164.04031 169.32062">32</tspan><tspan y="-211.9803" x="95.520615 100.72981 106.55101 111.30121 117.12241">THEN </tspan><tspan y="-199.98061" x="113.52061 118.25282 123.03902 128.16722 130.38661 132.14882 137.27702 139.49641 144.22861 148.9707 154.09891">ESP := ESP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-199.98061" x="156.30032">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-199.98061" x="161.22063 163.44002 168.18571 173.64513 178.33682"> SRC;</tspan><tspan y="-187.98091" x="95.520622 100.25552 104.72942 109.51833">ELSE</tspan><tspan y="-175.98122" x="113.52062 115.63202 120.37142 122.59083 127.38423 130.77364 135.21333 139.11302 143.37273 149.01213 153.63184 158.31094 161.55275 166.29306 170.32146 174.28325 179.07664 181.04405 185.18495 189.86586 192.08525 197.22066 199.44005 204.66005">IF StackAddressSize = 16</tspan><tspan y="-163.98152" x="131.52063 136.72983 142.55103 147.30122">THEN</tspan><tspan y="-151.98183" x="149.52063 154.30322 159.42783 161.64722 163.40582 168.53043 170.74982 175.49191 180.59311">SP := SP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-151.98183" x="182.82063">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-151.98183" x="187.80034 190.01973 194.76543 200.22484 204.91653"> SRC;</tspan><tspan y="-139.98213" x="131.52063 136.24924 140.71684 145.49945 150.22806 152.44745 155.04305 159.06964 161.28903 166.03113 169.39082 173.86742 177.77702 182.06462 187.67522 192.34082 197.00642 200.27702 204.99663 208.95842 212.97601 217.75861 219.68011 223.8813 228.56221">ELSE (* StackAddressSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-139.98" x="230.75999">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-139.98" x="236.28"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-139.98" x="238.50031 243.77071 248.99071 251.2101 255.23849">64 *)</tspan><tspan y="-127.98029" x="149.52 154.9758 159.7179 164.86769 167.0871 168.8286 173.92979 176.1492 181.54919 186.35159 191.45279">RSP := RSP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-127.98029" x="193.6803">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-127.98029" x="198.6006 200.81999 205.61429 211.0143 215.75459"> SRC;</tspan><tspan y="-115.98059" x="113.5209 118.2558 120.3627">FI;</tspan><tspan y="-103.98089" x="77.520897 82.255798 84.362701">FI;</tspan><tspan y="-91.981186" x="46.020897 50.701797 52.802395">FI;</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="510.62497pt" height="534.78632pt" viewBox="0 0 510.62497 534.78632" sodipodi:docname="1286.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.67141" inkscape:cy="277.13405" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg112" /><g transform="translate(-45.246444,-69.064216)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-715.31989" x="45.119999 50.661743 53.175648 58.488312 64.128654 68.88356 71.403435 77.462105 81.360443 85.079506 90.718857 95.264603 99.24263 104.82421">Flags Affected</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-699" x="45.119999 51.843899 57.298798 62.987698 68.343597">None.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-673.31989" x="45.119999 51.181656 54.603912 60.003227 63.964321 69.569809 74.139458 78.100555 83.680145 89.305557 91.825439 99.52253 105.12802 110.75343 116.35892 118.8788 124.39764 129.68042 134.11958 139.69917 145.15926 149.12035 151.63823 157.24371 162.98865">Protected Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-658.97998" x="45.119999 52.471199 59.435398 64.851601 68.926804 74.640007 137.21881 140.99701 144.15421 146.97839 150.5136 156.1998 161.55299 164.43658 168.26878 173.62198 177.15718 182.84338 186.67558 192.36179 195.18597 199.86418 205.31638 210.91258 216.31528 219.13947 224.59166 228.42386 231.30745 235.98566 239.52086 244.91905 249.59726 254.91446 257.79807 262.47626 267.82947 273.42566 282.17188 287.52509 293.21127 296.74646 299.63007 304.30826 309.66147 312.11667 317.46988 322.14807 325.68326 331.13547 334.96768 337.85129 340.24799 344.92798 347.81158 354.53278 361.10999 366.11218 371.11438">#GP(0)If the return code or stack segment selector is NULL.</tspan><tspan y="-645.00031" x="137.2197 141.0051 144.16949 146.9937 150.5361 156.22951 161.5899 164.47351 168.31291 173.67331 177.21571 182.90912 186.74852 192.44193 195.26613 197.72853 203.42194 208.10733 211.64973 215.48914 221.18254 225.86794 229.41034 231.80704 237.26733 242.96074 245.84435 251.44774 256.90714 259.36954 265.01163 268.55402 273.91443 277.75381 280.578 283.04041 287.7258 290.54999 296.24338 301.67938 305.21817 308.10178 315.45657 317.91537 321.45416 327.14395 329.54065 335.24213 338.12573 341.66452 347.35431 352.71112 355.53534 359.37112 364.72794 368.26672 373.90881 377.7446 383.43439 386.31799 390.99979 396.4556 402.05539 407.4122 410.29581 414.9776 420.33441 425.9342 434.68399 440.0408 445.73059 449.26938 452.15298 454.54968 457.0058 465.75558 468.21439 471.75317">If the return instruction pointer is not within the return code segment limit.</tspan><tspan y="-631.02063" x="137.21968 141.00238 144.16408 146.98828 150.82498 156.18268 159.78268 165.42479 169.26149 174.95219 177.4119 183.1026 188.70331 191.52751 195.06721 200.52391 203.40752 209.12521 214.84291 218.92261 224.52332 226.92001 230.45972 233.34332 238.80002 242.63672 245.46092 250.14362 255.60031 264.35101 269.95172 275.35443 278.89413 281.35382 286.95453 289.41422 291.8739 294.33359 297.81299 303.13467 305.95889 314.70959 320.16629 325.767 331.12469 334.0083 339.41101 345.10172 350.70242 353.52664 357.06635 362.75705 368.15976 370.98398 376.58469 380.42139 385.8241 391.10617 393.56586 399.02255 404.71326 409.39597 412.22018 418.28348 424.46738 429.88809 432.71231 435.87402 439.71072 445.16742 453.91812 456.74234 461.42505 467.11575 472.51846 478.11917 483.57587 490.93158 493.7558 498.43851 501.97821 507.38092 512.0636 517.38531 520.26886 524.34857 531.70428 537.39496 542.75269 548.44336">If returning to 32-bit or compatibility mode and the previous SSP from shadow stack (when </tspan><tspan y="-619.98035" x="136.91998 140.75938 146.11978 149.66219 155.35559 159.19499 164.8371 167.2995 172.9929 178.5963 181.4799 185.02231 190.4817 193.30591 199.5843 205.00771 210.01711 212.84131 220.19971 225.9201 230.0025 232.82671 238.2861 242.1255 245.00911 248.17351 252.01291 257.47232 266.22571 269.0499 272.8353 278.9877 284.7081 290.4285 296.1489 301.5723 306.5817 312.30209 318.02249 324.08578 330.1203 335.5437 338.36789 342.45029 346.28967 351.65009 355.19247 360.88586 364.72525 370.41864 372.88104 378.57443 384.17783 387.00201 390.5444 396.00381 398.88739 405.12531 410.58472 415.59412 418.4183 424.1387 428.2211 431.04529 433.50769 438.19308 441.01727 446.62067 451.98108 457.20288 462.66318 468.35657 473.95996 476.84354 482.56393 489.53534 495.65985">returning to CPL &lt;3) or from IA32_PL3_SSP (returning to CPL 3) is beyond 4GB.</tspan><tspan y="-606.00067" x="45.119995 52.475697 59.444397 64.865097 68.944794 73.627495 78.985199 81.444901 86.802597 91.485298 95.025002 100.4817 104.31841 137.25751 141.03841 144.2001 147.02431 150.56401 156.25471 161.61241 164.49602 170.74472 176.16542 181.17212 183.99632 189.45302 192.61472 195.43892 198.97862 204.66933 210.02702 212.91063 216.74733 222.10503 225.64473 231.33543 235.17213 240.86284 243.68704 248.36974 253.82643 259.42712 264.7803 267.60449 272.28268 277.68539 283.28159 292.02777 297.38098 303.06717 306.60236 309.42654 314.10474 319.45795 321.91315 327.26636 332.00665 335.54633 340.94724 344.78934 347.67291 350.12811 354.8063 357.63049 360.08569 365.4389 370.1171 374.79529 377.67886 381.21405 386.90024 392.25345 397.93964 400.76382 404.29901 409.9852 415.33841 418.22198 424.49319 429.90939 434.91159">#GP(selector)If the RPL of the return code segment selector is less then the CPL.</tspan><tspan y="-592.021" x="137.22061 140.99971 144.15781 146.98199 150.5181 156.2052 161.5593 164.44289 168.27599 173.63008 177.16618 182.85329 186.68639 192.37349 195.19768 199.87677 205.32986 210.92697 216.32967 219.15385 224.60695 228.44005 231.32364 236.00275 239.53885 244.93794 249.61703 254.93513 257.81873 262.49783 267.85193 273.44904 282.19614 287.55023 293.23734 296.77344 299.65704 304.33615 309.69025 312.14633 317.50043 322.17953 325.71564 331.16873 335.00183 337.86032 340.2561 345.9567 351.5538 356.9079 362.22601 365.10962 367.5657 372.24481 375.06903 380.75613 386.20923 389.74533 392.56955 399.92166 402.37775 405.91385 411.55505 414.01114 419.69824 422.52246 424.97855 428.51465 433.19376 436.07736 441.67447 447.02856 451.70767 456.38678 460.21988 462.67596 468.27307 471.80917 477.26227 481.09537 483.97897 487.51508 492.91418 498.51129 500.96738 506.32147 509.20508 511.60086 514.05603 522.8031 525.25922 528.79529 533.47437">If the return code or stack segment selector index is not within its descriptor table limits.</tspan><tspan y="-577.98102" x="137.22061 141.00511 144.16861 146.99281 150.53432 156.22682 161.58632 164.46992 168.30843 173.66792 177.20943 182.90193 186.74043 192.43294 195.25714 199.94164 205.40013 211.00262 216.36212 219.18633 223.87082 229.23032 234.83281 243.58531 248.94481 254.63731 258.1788 261.00302 266.60553 271.96503 276.64954 281.33405 285.17255 287.63403 293.23654 296.77805 302.22031 306.05969 308.8848 314.48819 319.8891 325.29181 329.9718 332.79691 338.4903 343.94971 347.4921 350.3172 352.7796 358.47299 364.07639 366.53879 371.22418 376.62958 380.17197 385.53238 388.41687 393.82227 396.64737 401.33276 406.79218 412.39557 417.75598 420.58109 425.26648 430.66919 436.27258 445.02597 450.38638 456.07977 459.62216">If the return code segment descriptor does not indicate a code segment.</tspan><tspan y="-564.00134" x="137.22061 141.00601 144.17041 146.99551 150.53792 156.23132 161.59172 164.47623 168.31563 173.67603 177.21843 182.91183 186.75124 192.44464 195.26974 199.95514 205.41454 211.01793 216.37833 219.20343 223.88882 229.24922 234.85262 243.60602 248.96642 254.65982 258.20221 261.02731 263.48972 268.17511 271.00021 276.6936 282.15302 287.84641 291.9288 296.6142 302.07361 307.767 310.8909 316.35031 320.1897 328.94308 331.40549 337.09888 342.70227 345.48059 350.8833 356.57401 362.17471 364.99893 368.53864 374.22934 379.58704 382.47064 387.15335 392.51105 398.11176 406.86246 412.22015 417.91086 421.45056 424.33417 429.01688 434.37457 436.83426 442.19196 446.87466 450.41437 455.87106 459.83286 461.93707 466.6171 469.5007 476.43341 481.85413 486.86084 489.74445 492.14114 496.82117 499.70477 505.39548 510.85217 514.39185 517.21606 522.57379 528.1745 533.81659 539.28052 541.67633 544.55994 548.09961 553.55634">If the return code segment is non-conforming and the segment selector’s DPL is not equal to </tspan><tspan y="-553.02136" x="136.9209 140.457 146.09911 151.5018 154.326 160.57111 165.9882 170.9913 173.81551 179.2686 182.4267 185.3103 188.84641 194.48851 199.8912 202.71541 207.3945 212.8476 218.4447 223.8474 226.6716 231.35071 236.7534 242.35051 251.09761 256.45172 262.13882 265.73883 267.84305 272.52216 275.40576 280.08487 285.43896 291.03607 299.78317 305.18588 310.82797 314.36407 317.24768 321.92679 327.28088 329.73697 335.09106 339.77017 343.30627 348.75937">the RPL of the code segment’s segment selector</tspan><tspan y="-538.98138" x="137.2206 140.99969 144.15779 146.56079 150.09689 155.784 161.13809 163.60139 167.43449 172.78859 176.32469 182.0118 185.84489 191.4861 193.9494 198.62851 204.0816 209.67871 215.03281 217.49611 222.1752 227.5293 233.1264 241.8735 247.2276 252.9147 256.45081 258.91412 261.30991 265.98901 268.45233 273.13144 278.58453 284.27164 287.42975 292.88284 296.71594 305.46304 307.91913 313.60623 319.20334 321.60635 327.00546 332.69257 338.28967 340.7403 344.28 349.9707 355.3284 357.7323 362.41501 367.81772 373.41843 382.16913 387.52682 393.21753 396.75723 399.16113 403.84384 409.20154 411.66122 417.01892 421.70163 425.24133 430.69803 434.72012 436.82434 441.50436 443.90826 450.84097 456.1806 461.1828 463.647 469.24319 473.07541 478.42862 483.82681 487.362 492.71521 496.54742 498.95132 502.48651 508.1727 513.57092 519.25714 521.66107 525.19629 530.88251 536.23572 538.69995 544.94415 550.36035 555.36255">If the return code segment is conforming and the segment selector’s DPL greater than the RPL </tspan><tspan y="-528.0014" x="136.9209 142.32179 145.506 148.3896 151.92661 157.61461 162.9696 165.79381 170.47382 175.92781 181.52582 186.88081 189.70502 194.38501 199.7877 205.38571 214.13371 219.48871 225.17671 228.77672 230.94032 235.62033 238.44453 243.12454 248.47954 254.07755 262.82553 268.22824 273.87033 277.47031 280.29449 284.97449 290.3295 292.7865 298.14151 302.8215 306.35849 311.8125">of the code segment’s segment selector</tspan><tspan y="-513.96143" x="137.2206 141.0114 144.1812 147.0054 150.55321 156.25201 161.61781 164.50142 169.19221 172.74002 178.15082 182.84161 188.17142 190.99562 195.68642 201.05222 206.66101 215.36401 220.72981 226.42862 229.97643 232.80063 235.26843 239.95923 242.78343 248.48224 253.94704 257.49484 260.37842 265.78922 268.6134 275.9772 279.82199 282.21869 285.75839 291.16919 296.77798 299.17468 304.57739 307.40158 313.01038 318.42117 321.96896 327.37976 330.26334 334.95413 340.31995 345.92874 354.63174 359.99756 365.63965 369.18744">If the stack segment is not a writable data segment.</tspan><tspan y="-499.98172" x="137.2206 141.0033 144.16499 146.9892 150.5289 156.2196 161.5773 164.46091 169.1436 172.6833 178.086 182.76869 188.09039 190.9146 195.59729 200.95499 206.55569 215.3064 220.70909 226.4106 229.9503 232.77451 237.4572 242.8149 245.2746 250.63229 255.31499 258.85468 264.31137 268.14807 271.03168 277.28036 282.70108 287.70779 290.53201 292.9917 297.67441 300.49863 306.18933 311.64603 315.18573 318.06934 323.42703 329.02774 334.71844 340.12115 342.58084 345.40506 348.94476 354.3006 357.1842 360.71939 366.40558 371.75879 374.58301 380.82721 386.24341 391.24561 394.12921 399.53012 402.71432 405.59793 409.13312 414.81931 420.17252 422.99673 426.82895 432.18216 435.78214 441.42422 445.25644 450.94263 453.82623 458.50443 463.95663 469.55283 474.90604 477.78964 482.46783 487.82104 493.41724 502.16345 507.51666 513.20288 516.7381 519.6217 524.29993 529.65314 532.10834 537.46155 542.13977 545.67499 551.1272 553.70929">If the stack segment selector RPL is not equal to the RPL of the return code segment selector.</tspan><tspan y="-486.00201" x="137.2206 141.0087 144.1758 147 150.5451 156.24121 161.60431 164.48792 169.17601 172.72112 178.12921 182.81731 188.14441 190.96861 195.65671 201.01981 206.6259 215.3289 220.692 226.38811 229.93321 232.75742 238.36351 243.72661 248.4147 253.1028 256.94489 259.34158 264.98099 268.52609 273.98819 277.83029 280.65451 287.59262 293.01871 298.03082 300.91443 303.37952 308.06763 310.89185 316.58795 322.05005 325.59515 328.41937 333.78247 339.38858 345.08469 350.4928 352.95789 355.7821 359.32721 364.78931 367.61353 371.15863 376.85474 382.21783 385.10144 391.35553 396.78162 401.7937 404.61792 410.08002 413.24713 416.07135 419.61646 425.31256 430.67566 433.49988 437.34198 442.70508 446.25018 451.94629 455.78839 461.4845 464.30872 468.99683 474.45892 480.06503 485.42813 488.25235 492.94046 498.30356 503.90967 512.66577 518.02887 523.72498 527.27008">If the stack segment descriptor DPL is not equal to the RPL of the return code segment </tspan><tspan y="-474.9617" x="136.9209 141.59911 146.9523 149.4075 154.7607 159.4389 162.97411 168.4263 171.00839">selector.</tspan><tspan y="-460.98199" x="45.120903 52.476604 58.539906 64.689606 68.769302 74.487 137.2458 141.0285 144.1902 147.0144 150.55411 156.24481 161.60251 164.48611 168.02582 173.48251 179.08322 181.96683 187.56754 192.88924 196.42894 201.78664 206.46933 209.29353 214.75023 217.91193 220.73613 225.41882 228.95853 234.36122 239.04391 244.36562 247.18982 252.59251 256.4292 261.7869 264.61111 270.30182 275.75851 279.29822 282.12244 289.47815 291.93784 295.47754 301.11963 303.57932 309.27002 312.15363 316.83633 320.37604 325.77875 330.46146 335.78314 338.66675 341.12643 343.52313 352.27383 354.73352 358.27322 362.95593">#SS(0)If the top bytes of stack are not within stack limits.</tspan><tspan y="-447.00229" x="137.22061 141.00601 144.17041 146.99461 150.53702 156.23042 161.59082 164.47443 168.31383 173.67422 177.21663 182.91003 186.74944 192.44284 195.26704 199.95244 203.49484 208.90024 213.58563 218.91003 221.73424 226.41963 231.78003 237.38342 246.13683 251.49722 257.19061 260.733 263.55719 266.01959 270.70499 273.58856 279.23065 284.69095 288.23334 291.11691 296.72031 300.55969 305.9201 310.6055 315.96591 321.6593 325.20169">If the return stack segment is not present.</tspan><tspan y="-432.96228" x="45.120911 52.477512 59.204113 64.625717 68.706314 73.389915 78.748512 81.209114 86.567711 91.251312 94.791916 100.24952 104.08712 137.26651 141.04741 144.21001 147.03421 150.57481 156.26642 161.62502 164.50862 168.34622 173.70482 177.24542 182.93703 186.77463 192.46623 195.29044 199.97403 205.43163 211.03323 216.39183 219.21603 223.89963 229.25822 234.85983 243.61143 248.97003 254.66164 258.20224 261.02643 263.48703 268.17062 270.99481 276.6864 282.14401 285.6846 288.56818 294.16977 298.00735 303.36597 308.04956 313.40817 319.09976 322.64035">#NP(selector)If the return code segment is not present.</tspan><tspan y="-418.98257" x="45.120911 52.47121 57.930614 63.093914 67.168213 70.324516 75.721817 81.40712 83.86142 87.221123 91.299927 95.977226 101.42853 107.02383 112.42653 137.26562 141.04652 144.20282 147.02701 152.4243 155.30789 160.9032 166.30049 171.8958 177.29849 180.12268 183.27898 188.67627 194.36157 196.81587 200.35017 203.23376 208.68506 213.36237 218.03967 223.72498 227.55627 232.23358">#PF(fault-code)If a page fault occurs.</tspan><tspan y="-405.00287" x="45.120911 52.47121 58.615509 64.885811 68.960114 74.721916 137.24042 141.01772 144.17401 146.9973 152.39459 158.0799 160.96259 166.60379 172.3044 177.70169 180.15599 182.61029 188.2056 193.8909 199.24319 204.8385 207.72119 216.46649 221.81879 230.56409 236.01538 239.84668 245.16298 248.04567 253.44296 258.12027 262.79758 268.14987 272.82718 277.50449 280.38721 285.8385 290.51581 295.19312 300.83432 304.66562 309.34293 312.22565 319.57596 325.26126 330.66306 336.30426 339.18063 342.71762 348.40561 353.76062 356.58481 362.85782 368.27582 373.31943 376.14362 378.60062 383.28061 386.1048 391.86749 394.69168 400.09167 405.77966 411.37766 414.26123 419.66122 422.11823 424.51492 430.15433 435.84232 444.5903 449.94531 455.6333 459.17029 462.05386 466.73386 472.42184 477.77686 482.45685 487.77585 490.17255 495.86053 501.49994 504.32413 506.78113 511.46112 514.28534 519.68805 525.32922 530.72925 536.36865 538.7644 544.16711 549.76514">#AC(0)If an unaligned memory access occurs when the CPL is 3 and alignment checking is enabled.</tspan><tspan y="-390.96286" x="45.120911 52.47031 58.739712 64.154114 68.227516 72.970512 78.374115 82.204514 86.277916 92.520317 98.195717 103.77392 107.85272 111.62912 117.87152 123.54692 129.12512 137.34392 141.12482 144.28021 147.1044 150.6378 156.3222 161.6736 164.55719 170.1516 173.98199 179.33339 184.64879 187.10219 192.55258 198.23698 202.91339 205.73758 211.80089 217.92448 223.38388 226.20807 229.36346 233.19386 238.64426 247.38866 250.27225 254.94865 260.63306 266.02945 271.62384 277.07425 284.42365 287.24783 291.92422 295.44061 300.83701 305.5134 310.8288 313.65298 317.72638 325.07578 330.76016 336.11157 341.79596 344.62015 348.45056 353.80197 357.40106 363.04224 366.87265 372.55704 375.01044 380.69482 386.28922 389.1134 392.64679 398.0972 400.98077 407.25018 412.70868 417.70908 420.59265 427.94205 433.65344 437.72684 440.61041 446.06082 449.89124 452.71542 455.87082 459.70123 465.15164 473.89606 476.72025 480.49664 486.67966 492.39105 498.10245 503.81384 509.27234 514.27277 519.98419 525.74603 531.80841 537.95178 543.36621">#CP(Far-RET/IRET)If the previous SSP from shadow stack (when returning to CPL &lt;3) or from IA32_PL3_SSP </tspan><tspan y="-379.98285" x="136.92091 141.00241 144.84091 150.20041 153.74191 159.43442 163.27292 168.91502 171.37112 177.06363 182.66612 185.54971 189.09122 194.54971 197.3739 203.6514 209.0739 214.0824 216.90659 222.62608 226.70758 229.59117 231.98787 236.66786 239.55145 245.24396 250.70245 254.24396 257.06818 262.78769 265.6713 271.2738 276.59729 280.13879 285.49829 288.32251 293.72702 296.18851 298.64999 304.2525 309.94501 315.3045 320.90701">(returning to CPL 3) is not 4 byte aligned.</tspan><tspan y="-366.00314" x="137.22061 141.00421 144.16681 146.99101 150.82861 156.18721 159.78722 165.42932 169.26692 174.95853 177.84213 180.23883 185.94034 190.62393 194.16454 198.00214 203.69374 208.37733 211.91794 214.37854 219.83614 225.52774 228.35194 233.95355 239.41115 241.87175 247.56335 251.10396 256.46255 260.30014 263.18372 266.34631 270.1839 275.64151 284.3931 287.21729 291.90088 295.44147 300.84506 305.52866 310.85126 313.73483 319.13843 324.78052 330.38211 333.2063 337.88989 343.58148 348.98508 354.58667 360.04428 367.40088 370.22507 374.90866 378.44925 383.85284 388.59314 393.91574 396.79932 402.40091 407.85852 410.68271 416.3743 421.83191 425.3725 428.25607 437.00766 442.41125 445.95184 450.63544 456.32703">If return instruction pointer from stack and shadow stack do not match.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-340.32001" x="45.119999 51.299183 56.879772 62.182476 64.686417 67.75808 74.146423 79.787766 85.429108 88.852356 94.492706 99.233665 104.03439 106.4955 114.15872 119.79907 125.39062 131.03096 133.49208 139.07167 144.35545 148.73586 154.37621 159.77751 163.79936 166.28339 171.92374 177.6348">Real-Address Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-325.98001" x="45.119999 52.477501 59.448002 137.2674 141.04829 144.21179 147.036 150.5775 156.27 161.6295 164.51311 168.35161 173.71111 177.25261 182.94511 186.78362 192.47612 195.30032 197.76183 203.45433 208.13882 211.68033 215.51883 221.21133 225.89583 229.43733 231.83403 237.29433 242.98683 245.87044 251.47293 256.93143 259.39291 265.035 268.57651 273.936 277.77451 280.59872 283.06021 287.74472 290.56894 296.26144 301.6803 305.21909 308.10269 315.45749 317.91629 321.45508 327.14487 329.54156 335.24304 338.12665 341.66544 347.35522 352.71204 355.53625 359.37204 364.72885 368.26764 373.90973 377.74551 383.4353 386.31891 391.0007 396.45651 402.0563 407.41312 410.29672 414.97852 420.33533 425.93512 434.68491 440.04172 445.73151 449.27029 452.1539 454.5506 457.00671 465.7565 468.2153 471.75409">#GPIf the return instruction pointer is not within the return code segment limit </tspan><tspan y="-312.00031" x="45.119995 52.475697 58.538998 137.26289 141.04379 144.20549 147.02969 150.5694 156.2601 161.6178 164.5014 168.04111 173.4978 179.09851 181.98212 187.58282 192.90453 196.44423 201.80193 206.48462 209.30882 214.76552 217.92722 220.75142 225.43411 228.97382 234.37651 239.0592 244.38091 247.20511 252.6078 256.44449 261.80219 264.6264 270.31711 275.7738 279.31351 282.13773 289.49344 291.95312 295.49283 301.13492 303.5946 309.28531 312.16891 316.85162 320.39133 325.79404 330.47675 335.79843 338.68204 341.14172 343.53842 352.28912 354.74881 358.28851 362.97122">#SSIf the top bytes of stack are not within stack limits.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-286.32001" x="45.119999 51.591011 54.078022 57.700474 61.721329 67.435379 72.741074 75.248009 78.322662 84.445076 90.622269 96.744682 102.92188 105.382 113.04821 118.68757 124.2821 129.92146 132.38159 137.91637 143.19916 147.57857 153.21793 158.61824 162.6391 165.12611 170.76547 176.47952">Virtual-8086 Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-271.98001" x="45.119999 52.476601 59.446201 64.867798 68.948395 74.666992 137.24579 141.02939 144.19199 147.01619 150.55679 156.2484 161.60699 164.4906 168.3282 173.6868 177.2274 182.91901 186.75661 192.44821 195.27242 197.73302 203.42462 208.10822 211.64882 215.48642 221.17802 225.86162 229.40222 231.79892 237.25922 242.95082 245.83443 251.43604 256.89365 259.35425 264.99634 268.53693 273.89554 277.73312 280.55731 283.01791 287.70151 290.52029 296.21008 301.66589 305.20468 308.08829 315.44308 317.90189 321.44067 327.13046 329.52716 335.22864 338.11224 341.65103 347.34082 352.69763 355.52185 359.35764 364.71445 368.25323 373.89532 377.73111 383.4209 386.3045 390.9863 396.44211 402.0419 407.39871 410.28232 414.96411 420.32092 425.92072 434.6705 440.02731 445.7171 449.25589 452.1395 454.53619 456.99231 465.7421 468.2009 471.73969">#GP(0)If the return instruction pointer is not within the return code segment limit </tspan><tspan y="-258.00031" x="45.119995 52.475697 58.538998 64.688698 68.768402 74.486099 137.2449 141.0276 144.1893 147.0135 150.55321 156.24391 161.60161 164.48521 168.02492 173.48161 179.08231 181.96591 187.56662 192.88832 196.42802 201.78572 206.46841 209.29262 214.74931 217.91101 220.73521 225.41791 228.95761 234.36031 239.043 244.3647 247.1889 252.5916 256.42828 261.78598 264.6102 270.3009 275.7576 279.2973 282.12152 289.47723 291.93692 295.47662 301.11871 303.5784 309.2691 312.15271 316.83542 320.37512 325.77783 330.46054 335.78223 338.66583 341.12552 343.52222 352.27292 354.7326 358.27231 362.95502">#SS(0)If the top bytes of stack are not within stack limits.</tspan><tspan y="-243.96031" x="45.119995 52.470295 57.929699 63.092999 67.167297 70.323601 75.720901 81.406204 83.860504 87.220207 91.299011 95.976311 101.42761 107.02291 112.42561 137.26471 141.04561 144.2019 147.02609 152.42339 155.30698 160.90228 166.29958 171.89488 177.29758 180.12177 183.27806 188.67535 194.36066 196.81496 200.34926 203.23285 208.68414 213.36145 218.03876 223.72406 227.55536 232.23267">#PF(fault-code)If a page fault occurs.</tspan><tspan y="-229.98061" x="45.119995 52.470295 58.614594 64.884895 68.959198 74.721001 137.2395 141.0168 144.1731 146.99638 152.39368 158.07898 160.96167 166.60287 172.30348 177.70078 180.15508 182.60938 188.20468 193.88998 199.24228 204.83759 207.72028 216.46558 221.81787 230.56317 236.01447 239.84576 245.16206 248.04475 253.44205 258.11935 262.79666 268.14896 272.82626 277.50357 280.38629 285.83759 290.51489 295.1922 300.83969 304.698 309.37799 312.26157 319.57855 325.28006 330.65936 336.30148 339.18506 344.60934 347.06543 349.46213 355.10153 360.81384 369.51685 374.89615 380.53827 384.09958 386.98315 391.66315 397.36465 402.70706 407.38708 412.73038 415.12708 420.83939 426.4617 429.28589 431.74197 436.422 439.24619 444.62549 450.26761 455.69189 461.31421 463.71091 469.11362 474.69363">#AC(0)If an unaligned memory access occurs when alignment checking is enabled.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-204.3" x="45.119999 50.603973 56.19751 64.480247 70.093704 75.41832 79.408295 81.868416 87.508766 90.014702 92.540558 95.000679 99.02153 104.55531 107.07519 114.76032 120.35386 125.96732 131.56085 134.08073 139.63443 144.91721 149.35637 154.93596 160.39603 164.35712 166.86305 172.45659 178.18956">Compatibility Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-189.96001" x="45.119999 51.267899 56.6688 65.417702 70.773605 73.657204 79.058105 83.739006 86.563202 92.279099 97.994995 102.0729 107.6718 110.1297 113.6676 116.4918 125.2407 130.6956 136.29451 141.65041 144.47461 149.83051 155.11261 159.79352 165.14941 170.74832 174.28622 176.74413 182.19902 187.88792 192.56882">Same as 64-bit mode exceptions.</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="510.23798pt" height="411.73361pt" viewBox="0 0 510.23798 411.73361" sodipodi:docname="1287.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="345.75164" inkscape:cy="113.12862" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg86" /><g transform="translate(-46.68627,-69.112849)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-715.31989" x="46.02 52.164326 58.308651 61.405216 67.718857 70.227783 74.220749 76.68087 84.368996 89.965523 95.58197 101.1785 103.63862 109.1953 114.47809 118.8575 124.49686 129.89717 133.91803 136.42696 142.02348 147.75945">64-Bit Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-700.97998" x="46.02 53.377502 60.348003 65.7705 69.851997 75.571495 138.1503 141.9348 145.0983 147.9225 151.464 157.15651 162.51601 165.39961 169.23811 174.59761 178.13911 183.83162 187.67012 193.36263 196.18683 198.64833 204.34084 209.02533 212.56683 216.40533 222.04744 226.78773 230.32744 232.72414 238.18443 243.87694 246.76054 252.36304 257.82153 260.21823 265.91974 269.46124 274.82074 278.65924 281.48346 283.94495 288.62946 291.45367 297.14618 302.60468 308.29718 312.37869 317.0632 322.46771 328.16022 333.61871 339.2608 341.71689 346.4014 351.80591 354.2674">#GP(0)If the return instruction pointer is non-canonical.</tspan><tspan y="-687.00031" x="138.11971 141.90421 145.0677 147.89189 151.4334 157.1259 162.4854 165.36899 169.20749 174.56699 178.10849 183.80099 187.6395 193.332 196.15619 198.61769 204.3102 208.99469 212.53619 216.37469 222.0168 226.7571 230.2968 232.6935 238.15379 243.8463 246.72989 252.33238 257.79089 260.18759 265.8891 269.4306 274.7901 278.6286 281.45282 283.91431 288.59882 291.42303 297.11554 302.57404 306.11554 308.99915 316.35666 318.81815 322.35965 328.05215 330.44885 336.15036 339.03397 342.57547 348.21756 353.57706 356.40128 360.23978 365.59927 369.14078 374.83328 378.67178 384.36429 387.24789 391.9324 397.3909 402.99341 408.35291 411.23651 415.92102 421.28052 426.88303 435.63553 440.99503 446.68753 450.22903 453.11264 455.50934 457.96542 466.71793 469.17941 472.72092">If the return instruction pointer is not within the return code segment limit.</tspan><tspan y="-673.02063" x="138.11971 141.9006 145.0605 147.8847 151.42261 157.11151 162.46741 165.35101 170.03192 173.56982 178.97072 183.65161 188.97151 191.79572 196.47662 201.83252 207.43143 216.18033 221.58302 227.28453 230.82243 233.64664 238.32755 243.68344 246.14134 251.49724 256.17813 259.71603 265.17093 269.00583 271.88943 274.34732 279.02823 281.85245 288.57635 295.15625 300.16116 305.1597 307.98392 313.57202 319.01611 321.46323 327.14133 332.72943 335.61304 341.20114 346.59125 351.26135 356.57047 359.39468 362.92178 368.36588 371.24948 375.91959 381.36368 390.10178 395.74118 401.13129 404.65839 407.1055 412.7449 415.19202 417.63913 420.08624 423.61334 428.92245 431.74667 440.48477 445.92886 451.51697 456.91965">If the stack segment selector is NULL going back to compatibility mode.</tspan><tspan y="-658.98065" x="138.11971 141.8997 145.0587 147.8829 151.41991 157.10791 162.46291 165.34651 170.02652 173.56352 178.96352 183.64352 188.96252 191.78673 196.46674 201.82173 207.41974 216.16774 221.57043 227.27194 230.80894 233.63315 238.31314 243.66814 246.12514 251.48013 256.16013 259.69711 265.15112 268.98514 271.86871 274.32571 279.00571 281.8299 288.55289 295.1319 300.13589 305.13989 307.96408 313.56207 319.01608 321.47308 327.16107 332.75906 335.64264 341.24063 346.64062 351.32062 356.63962 359.46381 363.00079 368.4548 371.33838 377.61139 383.02939 388.03339 393.74838 396.63196 402.34695 408.06195 412.13895 417.73694 420.19394 423.73093 426.6145 435.36249 440.8165 446.41449 451.7695">If the stack segment selector is NULL going back to CPL3 64-bit mode.</tspan><tspan y="-645.00098" x="138.11971 141.8979 145.0551 147.63899 153.03719 155.62108 162.34229 168.91948 173.92168 178.92387 181.50777 186.18597 189.78598 195.18417 199.86238 205.17958 207.76347 212.44168 217.84438 223.44058 232.18678 237.53998 243.22618 246.76138 249.34528 254.02348 259.37668 261.83188 267.18509 271.86328 275.39847 280.85068 284.68289 287.26678 293.51099 298.92719 303.92938 306.51328 308.96848 313.64667 316.23056 321.91675 327.36896 330.90414 333.48804 338.84125 344.43744 350.12363 355.49939 357.97079 360.55469 364.10608 369.57449 372.15839 378.3963 383.85571 388.83902 391.42291 397.03531 402.50372 404.90042 410.60193 416.18192 418.76581 424.3782 429.7926 434.487 439.8204 442.4043 445.95569 451.4241 454.008 459.65009 465.11041 470.81281 474.90421 481.19162 486.59161 491.57492 497.33762 499.92151 505.6239 511.32629 515.40515 521.01758 523.41425 526.96564 529.54956 538.31195 543.78033 549.35944 554.76215">If a NULL stack segment selector RPL is not equal to CPL going back to non-CPL3 64-bit mode.</tspan><tspan y="-631.0213" x="138.11969 141.90239 145.06409 147.88829 151.42799 157.1187 162.47639 165.36 169.1967 174.5544 178.0941 183.78481 187.62151 193.31221 196.13641 200.81911 206.2758 211.8765 217.27919 220.10339 224.78609 230.14378 235.74448 244.49518 249.85287 255.54358 259.08328 261.9075 266.59021 271.94791 274.40759 279.76529 284.448 287.9877 293.4444 297.2811 300.1647 302.62439 307.3071 310.13132 316.85703 323.43872 328.44543 333.45215">If the return code segment selector is NULL.</tspan><tspan y="-616.98132" x="138.11969 141.90509 145.06949 147.89369 151.73309 157.09349 160.63589 166.3293 170.1687 175.86211 178.32451 184.01791 189.62131 192.44551 195.98792 201.44731 204.33092 210.05132 215.77171 219.85411 225.4575 227.8542 231.39661 234.28021 239.73961 243.57901 246.40321 251.08861 256.548 265.30139 270.90479 276.31018 279.85257 282.31497 287.91837 290.38077 292.84317 295.30557 298.78497 304.10938 306.93356 315.68695 321.14636 326.74976 332.11017 334.99374 340.39914 346.09253 351.69592 354.52011 358.0625 363.75589 369.1586 371.98279 377.58618 381.42557 386.82828 392.11038 394.57278 400.0322 405.72559 410.41098 413.23517 419.29846 425.42206 430.84546 433.66965 436.83405 440.67343 446.13284 454.88623 457.71042 462.39581 468.0892 473.4946 479.09799 484.5574 491.9158 494.73999 499.42538 502.96777 508.37317 513.05859 518.383 521.20721 525.28961 532.64801 538.34143 543.70184 549.39526">If returning to 32-bit or compatibility mode and the previous SSP from shadow stack (when </tspan><tspan y="-606.00134" x="137.81999 141.60179 147.00449 150.53879 156.22409 160.05539 165.69749 168.15179 173.8371 179.4324 182.31599 185.8503 191.30159 194.12578 200.39607 205.81137 210.81267 213.69626 221.04655 226.75885 230.83315 233.65733 239.10863 242.93993 245.82352 248.97981 252.84 258.28589 267.02579 269.85001 273.62192 279.80582 285.51273 291.21964 296.98233 302.39224 307.38815 313.15085 318.85327 324.91656 331.04016 336.49957 339.32379 343.3927 347.2186 352.56549 356.09439 361.77429 365.60019 371.28009 373.729 379.40891 385.04831 387.87253 391.40143 396.84732 399.73093 405.99582 411.45523 416.45114 419.27536 425.03806 429.11685 431.94107 434.38998 439.06189 441.88611 447.52551 452.86792 458.08972 463.55002 469.22992 474.81982 477.70343 483.41034 490.36823 496.4324">returning to CPL &lt;3) or from IA32_PL3_SSP (returning to CPL 3) is beyond 4GB.</tspan><tspan y="-592.02167" x="46.020004 53.375706 60.344406 65.765106 69.844803 74.527504 79.885208 82.34491 87.702606 92.385307 95.925011 101.38171 105.21841 138.15752 141.93842 145.10011 147.56432 151.10402 156.79472 162.15242 164.61662 170.21732 173.99911 179.45581 185.05652 190.51321 195.19591 200.5536 206.1543 208.6185 213.3588 218.70119 224.30188 233.05258 238.41028 244.10098 247.64069 250.10489 255.7056 261.10831 265.79102 270.47372 274.31042 276.77011 282.37082 285.91052 291.36722 295.20392 297.66812 300.82983 306.28653 310.12323 312.58743 317.99014 320.45435 325.13705 330.59375 336.19446 341.46027 343.98386 348.66476 354.02066 359.61957 368.36847 373.72437 379.41327 382.95117 385.41537 391.01428 396.46918 401.82507 406.50598 408.97018 414.65909 420.11398 423.65189 426.11609 428.57397 434.26288 439.86179 442.31967 447.00058 452.40149 455.93939 461.29529 463.75949 466.21738 469.75528 472.21948 474.67737 479.35828 481.82248 487.22339 489.68759 494.3685 499.82339 505.4223 510.7782 513.24243 517.92334 523.27924 528.87811 537.62701 543.02972 548.7312 552.2691 555.53699">#GP(selector)If the proposed segment descriptor for a code segment does not indicate it is a code segment. </tspan><tspan y="-577.98169" x="138.12057 141.90688 145.07217 147.89638 151.43968 157.13399 162.49529 165.37889 170.98318 174.82349 180.28378 185.88808 191.34837 196.03467 201.39597 207.00026 209.82446 215.51877 220.88007 228.23936 231.06357 235.74986 241.21016 246.81445 252.17575 254.99995 259.68625 265.04755 270.65186 279.40616 284.76746 290.46176 294.00507 296.82928 302.43359 307.79489 312.4812 317.16751 321.00781 323.4711 329.07541 332.61871 338.07901 341.91931 344.74353 350.43784 355.84415 360.53046 363.41406 369.01837 374.47867 378.02197 383.71628 386.5405 390.0838 395.77811 401.1394 403.96362 410.89993 414.98325 420.58755 423.05084 426.59415 429.41837 434.82468 440.51898 446.12329 449.0069 453.2702 457.34903 462.95334 465.34912 468.89243 471.77603 476.46234 481.82364 485.36694">If the proposed new code segment descriptor has both the D-bit and L-bit set.</tspan><tspan y="-564.00201" x="138.12057 141.90417 145.06677 147.89096 151.43156 157.12317 162.48177 165.36536 172.29895 177.72055 182.72815 185.55234 188.71494 194.17253 198.01013 200.89372 206.29732 209.12151 214.81311 220.27071 225.96231 230.6459 236.1035 241.74561 244.9082 250.3658 254.2034 262.95499 265.41559 271.05768 276.65927 280.73987 285.42346 290.88107 296.48267 301.84128 304.72488 309.40848 314.76709 320.36868 329.12027 334.47888 340.17047 343.71106 346.59467 348.99136 353.64087 356.52448 362.21606 367.67368 371.21426 374.03848 379.39709 384.99869 390.69028 396.09387 398.49149 401.37509 404.91568 410.37329 413.19751 416.7381 422.42969 427.7883 430.67191 436.92151 442.34311 447.35071 450.17493 455.63254 458.79514 461.61935 465.15994 470.85153 476.21014 479.09375 483.77734 489.23495 494.83655 500.19516 503.07877 507.76236 513.12097 518.7226 527.47418 532.83276 538.52435 542.06494">If the DPL for a nonconforming-code segment is not equal to the RPL of the code segment </tspan><tspan y="-553.02203" x="137.82088 142.49908 147.85228 150.30748 155.66068 160.33888 163.87408 169.32628 171.90837">selector.</tspan><tspan y="-538.98206" x="138.12057 141.91048 145.07938 147.90358 154.18648 159.61438 164.62828 167.45248 169.91939 174.60928 177.43349 183.04138 186.82318 192.18808 197.59798 201.14488 206.50978 210.35368 213.23729 216.78419 222.4263 227.8362 233.5341 236.41771 239.96461 245.60672 250.97162 253.79582 260.05173 265.47961 270.49353 273.37714 278.77805 281.96225 284.84586 288.39276 294.09067 299.45557 302.27979 306.9697 312.43359 318.0415 323.4064 326.23062 330.92053 336.28543 341.89334 350.65125 356.01614 361.71405 365.26096 368.08517 372.77509 378.13998 380.53668 385.93939 390.6293 394.17621 399.64011 402.1619">If CPL is greater than the RPL of the code segment selector.</tspan><tspan y="-525.00238" x="138.12057 141.90778 145.07397 147.89818 151.44238 157.13759 162.49979 165.38339 172.32059 177.74579 182.75699 185.58119 191.04239 194.20859 197.09219 202.49939 205.32359 210.01079 215.47198 221.16719 224.33339 229.79459 233.57639 242.33159 244.79579 250.491 256.09619 260.18039 264.86758 270.3288 275.93399 281.2962 284.12039 288.80759 294.1698 299.77499 308.53018 313.8924 319.58759 323.13177 325.95596 328.42017 333.10736 335.93155 341.53674 345.3006 350.65649 356.0574 359.59531 364.9512 368.7861 371.66971 375.20761 380.89651 386.29742 391.93951 394.82312 398.36102 404.04993 409.40582 412.23004 416.06494 421.42084 424.95874 430.60083 434.43573 440.12463 443.00824 447.68915 453.14404 458.74295 464.09885 466.98245 471.66336 477.01926 482.61816 491.36707 496.72296 502.41187 505.94977 508.83337 513.51428 518.87018 521.32806 526.68396 531.36487 534.90277 540.35767 544.19257">If the DPL of a conforming-code segment is greater than the return code segment selector </tspan><tspan y="-513.9621" x="137.82089 144.04979 149.45068 154.43759">RPL.</tspan><tspan y="-499.98239" x="138.12059 141.89879 145.05598 147.88017 153.27837 156.16196 160.84016 166.19336 171.78957 180.53577 185.88896 191.57516 195.11037 197.99396 202.67216 208.02536 210.48056 215.83376 220.51196 224.04716 229.49936 233.33156 236.15575 238.61095 244.29715 249.89336 255.29605 260.61325 263.49686 265.89355 270.57355 273.45715 278.90936 284.59555 288.13074 292.80893 295.20563 300.84503 306.19824 309.08185 311.47766 315.01733 319.69553 322.57913 328.17532 333.52853 338.20673 342.94702 346.72882 349.18491 354.7811 358.31628 363.71719 367.5593 370.4429 373.97809 379.37628 384.97247 387.42767 392.78088 395.66449 398.0603 400.51639 409.26257 411.71777 415.25296 419.93115">If a segment selector index is outside its descriptor table limits.</tspan><tspan y="-486.00269" x="138.12059 141.90059 145.05959 147.88377 153.28377 156.16736 160.84735 166.20235 171.80035 180.54836 185.90335 191.59135 195.12836 198.01195 203.60995 208.96495 213.64496 218.32495 222.15895 224.61595 230.21396 233.75096 239.20496 243.03896 245.92255 254.67055 260.07324 268.82123 274.22214 278.05615 283.37515 286.25876 291.65875 297.25674 302.85474 306.68875 312.04376 316.72375 321.46405 324.28827 326.74527 331.42526 334.24948 339.93747 345.39148 351.07947 355.15646 359.83646 365.23645 370.92444 376.37845 382.02054 384.47665 389.15665 394.55664 397.01364">If a segment descriptor memory address is non-canonical.</tspan><tspan y="-471.96268" x="138.12059 141.90959 145.07759 147.90179 151.4478 157.14481 162.5088 165.39241 170.08141 173.62741 179.03641 183.7254 189.05341 191.87761 196.5666 201.9306 207.5376 216.2406 221.6046 227.30161 230.84761 233.67181 236.13782 240.82681 243.65102 249.34802 254.81102 258.35703 261.18121 266.59021 269.47379 276.83578 280.67877 283.14478 286.69077 292.09976 297.70676 300.10345 305.50616 308.33035 313.93735 319.34634 322.89233 328.30133 331.18491 335.8739 341.23792 346.84491 355.54791 360.91193 366.55402 370.10001">If the stack segment is not a writable data segment.</tspan><tspan y="-457.98297" x="138.12059 141.90959 145.07759 147.90179 151.4478 157.14481 162.5088 165.39241 170.08141 173.62741 179.03641 183.7254 189.05341 191.87761 196.5666 201.9306 207.5376 216.2406 221.6046 227.30161 230.84761 233.67181 239.27881 244.64281 249.3318 254.0208 257.8638 260.2605 265.8999 269.44589 274.90891 278.75189 281.57608 288.51508 293.94208 298.95508 301.83865 304.30466 308.99365 311.81784 317.51483 322.97784 326.52383 329.34802 334.71204 340.20032 345.89462 351.30093 353.69672 356.58032 360.12363 365.58392 368.40814 371.95145 377.64575 383.00705 385.89066 392.14294 397.56723 402.57755 405.40176 410.86206 414.02737 416.85159 420.3949 426.0892 431.4505 434.33411 438.17441 443.53571 447.07901 452.77332 456.61362 462.30792 465.13214 469.81845 475.27875 480.88306 486.24435 489.06857 493.75488 499.11618 504.72049 513.47479 518.83612 524.5304 528.07367">If the stack segment descriptor DPL is not equal to the RPL of the return code segment </tspan><tspan y="-447.00296" x="137.82002 142.49823 147.85143 150.30663 155.65982 160.33803 163.87323 169.32542 171.90752">selector.</tspan><tspan y="-432.96295" x="138.11972 141.90242 145.06412 147.76772 151.30742 156.99812 162.35582 165.05942 169.74211 173.28181 178.68451 183.3672 188.6889 191.3331 196.07339 201.41579 207.01648 215.76718 221.12488 226.81558 230.35529 233.05888 237.74158 243.09927 245.55898 250.91667 255.59937 259.13907 264.59576 268.43246 271.13608 277.38477 282.80548 287.81219 290.51581 292.97549 297.6582 300.36182 306.05252 311.45343 314.99313 317.69675 323.05444 328.65515 334.34586 339.74857 342.20825 344.91187 348.45157 353.87943 356.52362 360.06241 365.7522 371.10901 373.81259 380.06039 385.48019 390.48599 393.18958 398.64539 401.80618 404.50977 408.04855 413.73834 419.09515 421.79874 425.63452 430.99133 434.53012 440.21991 444.05569 449.74548 452.44907 457.13086 462.58667 468.18646 473.54327 476.24686 480.92865 486.28546 491.88525 500.63504 505.99185 511.68164 515.22046 517.92407 522.6059 527.96271 530.42151 535.77832 540.46014 543.99896 549.45477 552.03687 555.30566">If the stack segment selector RPL is not equal to the RPL of the return code segment selector. </tspan><tspan y="-418.98325" x="46.019135 53.373936 59.437237 65.586037 69.664841 75.381638 138.14044 141.92224 145.08304 147.90724 153.30904 158.99884 161.82304 167.28694 170.82574 174.36455 179.72134 188.47115 194.07095 197.60976 200.43396 203.97276 209.42856 212.31216 217.91196 223.36775 228.96756 231.85117 237.25296 240.07716 245.23866 250.64226 253.10106 258.79086 264.14767 266.97186 272.42767 275.58847 278.74927 281.57346 285.11224 290.80203 296.15884 299.04242 303.72421 307.263 312.66479 317.34659 322.66739 325.49158 330.81238 333.20908 338.66489 341.12369 346.52548 350.06427 355.42108 360.10287 362.98645 366.52524 372.21503 377.57184 380.39603 386.45932 392.64322 395.46741 397.92621 400.38501 409.08798 411.54678 415.08557">#SS(0)If an attempt to pop a value off the stack violates the SS limit.</tspan><tspan y="-405.00354" x="138.11884 141.90063 145.06143 147.88564 153.28743 158.97723 161.80144 167.26534 170.80414 174.34294 179.69974 188.44954 194.04935 197.58815 200.41235 203.95116 209.40695 212.29056 217.89035 223.34615 228.94595 231.82956 237.23135 240.05556 245.21706 250.62065 253.07945 258.76926 264.12607 266.95026 272.40607 275.56686 278.72766 281.55185 285.09064 290.78043 296.13724 299.02081 303.70261 307.24139 312.64319 317.32498 322.64578 325.46997 330.15176 335.55356 341.24335 345.92514 351.28195 355.96375 358.84732 364.24911 367.0733 372.76309 378.2189 383.90869 387.98749 392.66928 398.07108 403.76086 409.21667 414.85876 417.31488 421.99667 427.39847 429.85727 432.68146 438.08325 443.68304 449.28284 453.11862 458.47543 463.15723 467.83902 470.7226 474.26138 479.71719 482.54138 488.14117 493.49799 496.32217 500.15796 505.56067 508.72147 514.12415 517.95996 523.31677 529.00659 533.68842 539.04523 544.64502">If an attempt to pop a value off the stack causes a non-canonical address to be referenced.</tspan><tspan y="-390.96353" x="46.019135 53.372135 60.095135 65.513138 69.590141 74.270142 79.625145 82.082146 87.437149 92.117149 95.654152 101.10815 104.94215 138.12155 141.90245 145.06145 147.88565 151.42265 157.11066 162.46565 165.34926 169.18326 174.53825 178.07526 183.76326 187.59726 193.28526 196.10947 200.78946 206.24345 211.84146 217.24416 220.06836 225.52235 229.35635 232.18056 236.86057 240.46057 245.86057 250.54056 255.85956 258.74313 263.42313 268.77814 274.37613 283.12411 288.47913 294.16711 297.7041 300.58768 302.98438 307.66437 310.54794 316.23593 321.68994 325.22693 328.05112 333.64911 337.48312 342.88583 347.56583 352.92084 358.60883 362.14581">#NP(selector)If the return code or stack segment is not present.</tspan><tspan y="-376.98383" x="46.019135 53.369434 58.828838 63.992138 68.066437 71.22274 76.620041 82.305344 84.759644 88.119347 92.198151 96.87545 102.32675 107.92205 113.32475 138.16385 141.94475 145.10104 147.92523 153.32253 156.20612 161.80142 167.19872 172.79402 178.19672 181.0209 184.1772 189.57449 195.2598 197.7141 201.2484 204.13199 209.58328 214.26059 218.9379 224.6232 228.4545 233.13181">#PF(fault-code)If a page fault occurs.</tspan><tspan y="-363.00412" x="46.019135 53.369434 59.513733 65.784035 69.858337 75.62104 138.14044 141.91774 145.07404 147.89822 153.29552 155.74982 158.20412 163.79942 169.48473 178.23003 183.58232 189.26762 192.80193 195.62611 200.30342 205.98872 211.34102 216.01833 221.33463 223.78893 229.47423 235.06953 237.89372 240.34802 245.02533 247.90892 253.26122 258.9465 264.34381 269.93912 272.39343 277.74573 283.34103 286.22464 291.62195 297.30725 302.90256 305.78616 311.18347 316.86877 319.73883 325.43494 331.07706 336.48517 338.95026 341.41534 347.02145 352.71756 358.08066 363.68677 366.51099 375.26709 380.63019 389.38629 394.84839 398.69049 404.01758 406.8418 410.6839 416.047 419.21411 424.57721 428.41931 433.78241 439.47852 444.16663 449.52972 452.35394 454.81903 459.50714 462.33136 471.08746 476.49557 482.10168 487.46478 490.289 497.65012 503.34622 505.742 508.19809 513.56122 516.44482 519.98993 525.68604 531.04913">#AC(0)If alignment checking is enabled and an unaligned memory reference is made while the </tspan><tspan y="-351.96381" x="137.81912 142.49373 148.17633 152.00493 155.83353 161.23622 166.91882 170.45042 173.33401 178.92662 182.75522 185.20682 190.52042 192.91711 195.37321 200.72281 206.31541 211.66501 214.4892 216.9408 222.29039 227.60399 232.95358 235.40518 238.22937 240.68097 245.35558 248.17976 253.94246">current privilege level is 3.</tspan><tspan y="-337.9841" x="46.019127 53.366726 59.634327 65.046928 69.11853 73.861526 79.265129 82.987526 87.126625 93.367226 99.040825 104.61903 108.69783 112.47243 118.71303 124.38663 129.96483 138.18362 141.96452 145.11812 147.94231 151.47391 157.15651 162.5061 165.38969 170.9823 174.8109 180.16049 185.47409 187.92569 193.37428 199.05688 203.7972 206.62138 212.68469 218.80829 224.26768 227.09187 230.24547 234.07407 239.52266 248.26526 251.14885 255.82346 261.50604 266.90063 272.49323 277.94183 285.28943 288.11362 292.78821 296.33881 301.73792 306.41702 311.73511 314.55933 318.63544 325.98755 331.67465 337.02875 342.71585 345.54007 349.37317 354.72726 358.26337 363.95047 367.78357 373.47067 375.92676 381.61386 387.21097 390.03519 393.57129 399.02438 401.90799 408.18008 413.6395 418.64261 421.52621 428.87833 434.59244 438.66855 441.55215 447.00525 450.83835 453.66257 456.82068 460.65378 466.10687 474.85397 477.67819 481.45731 487.6412 493.35532 499.06943 504.78354 510.24295 515.24603 520.96014 526.72284 532.72675 538.91064 544.31067">#CP(Far-RET/IRET)If the previous SSP from shadow stack (when returning to CPL &lt;3) or from IA32_PL3_SSP </tspan><tspan y="-327.00409" x="137.81911 141.8988 145.6806 151.0383 154.578 160.26871 164.10541 169.74751 172.20361 177.89432 183.49503 186.37862 189.91832 195.37502 198.1992 204.4749 209.8956 214.9023 217.78589 223.50359 227.58328 230.46687 232.86357 237.54356 240.42715 246.11786 251.57455 255.11426 257.93848 263.65619 266.53979 272.1405 277.46219 281.00189 286.35959 289.18381 294.58652 297.0462 299.50589 305.1066 310.7973 316.155 321.75571">(returning to CPL 3) is not 4 byte aligned.</tspan><tspan y="-312.96408" x="138.1188 141.90511 145.0704 147.89461 151.73491 157.09621 160.63951 166.33382 170.17412 175.86842 178.75203 181.14873 186.85023 191.53653 195.07983 198.92014 204.61444 209.30074 212.84404 215.30734 220.76764 226.40974 229.29335 234.89764 240.35794 242.82124 248.51555 252.05885 257.42017 261.26047 264.08469 267.25 271.0903 276.5506 285.3049 288.12912 292.81543 296.35873 301.76505 306.45135 311.77664 314.66025 320.06656 325.70868 331.31299 334.13721 338.82352 344.51782 349.92413 355.52844 360.98874 368.34805 371.17227 375.85858 379.40189 384.8082 389.49451 394.81979 397.7034 403.30771 408.76801 411.59222 417.28653 422.74683 426.29013 429.17374 437.92804 443.33435 446.87766 451.56396 457.25827">If return instruction pointer from stack and shadow stack do not match.</tspan></text></g></svg>     <hr />     <p class="not_instruction_page">         This <b>UNOFFICIAL</b> reference was generated from the official <a href="https://www.intel.com/content/www/us/en/developer/articles/technical/intel-sdm.html">Intel® 64 and IA-32 Architectures Software Developer’s Manual</a> by a dumb script.         There is no guarantee that some parts aren't mangled or broken and is distributed <b>WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE</b>.     </p> </body>  </html>
