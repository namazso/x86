<!DOCTYPE html> <html lang="en">  <head>     <meta charset="utf-8">     <title>CALL</title>     <link rel="stylesheet" href="styles.css">     <link rel="stylesheet" href="../intel.css"> </head>  <body>     <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="512.30463pt" height="646.97638pt" viewBox="0 0 512.30463 646.97638" sodipodi:docname="242.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.95288" inkscape:cy="426.47893" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg386" /><g transform="translate(-45.035339,-68.882812)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="12" class="cA49CCA52 cD0BE81C2 c209E837B"><tspan y="-714" x="45.119999 51.700798 59.199596 64.959602 70.719604 80.499611 87.080414 93.469215 96.486015 99.502815 102.50282 109.81561 113.95802 120.67081 125.94962 132.66241 139.39922 146.28001 150.48241">CALL—Call Procedure</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-356.34" x="235.2 237.83939 243.59726 248.27646 252.23755 255.89984 261.59796 266.17657 270.18747 272.64758 278.28693 283.98505 286.50494 293.15524 298.73483 304.34927 307.8313 313.1091 318.867 324.50137 326.96152 332.53613 338.29004 342.66946 348.28391 353.86349 356.39035 362.08847">Instruction Operand Encoding</tspan><tspan y="-284.34015" x="45.120377 51.602345 57.207832 61.986641 66.486572 70.1399 72.657791 78.117867 82.078964 84.596855 90.202347">Description</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-268.98001" x="45.119999 51.264297 56.607597 61.829395 67.232094 71.909393 74.733597 80.328896 84.160194 89.561096 94.301399 99.653702 105.249 110.9343 114.7656 120.1179 123.00151 125.39821 127.85431 133.53961 138.85591 141.25261 146.95412 152.54942 155.43301 157.88731 163.57262 166.72891 172.18021 176.01151 184.75681 190.1541 193.6884 196.1427 201.59399 207.2361 210.11969 215.57098 221.25629 224.08047 227.61478 233.30008 238.65237 241.53596 246.21327 249.74757 255.14487 259.82217 265.13849 268.02209 273.4194 279.10471 284.70001 287.58362 293.17892 296.84103 302.23834 307.92365 312.60095 318.35999 323.71048 328.38599 331.26959 334.80209 340.25159 343.07581 346.60831 352.29181 357.6423 360.52591 365.20142 370.59692 372.99365 375.44977 380.80026 386.43967 389.26389 394.90329 398.74539 404.19489 408.87039 414.27307 419.85309 425.53659 429.36609 434.71658 437.60019 442.2757 447.8692 453.2197 457.8952 460.34772 463.50223 465.95474 471.30524 476.89874 479.78235 485.46585 490.14136 492.59387 498.27737 503.87088 506.75449 510.28699 515.97046 521.32098 524.1452 527.67767 533.07318 536.90271 542.54211 547.89264 551.42511">Saves procedure linking information on the stack and branches to the called procedure specified using the target </tspan><tspan y="-258" x="45.119995 50.569496 56.162994 61.513496 65.235893 70.631393 76.314896 81.954292 85.196091 87.959999 93.490501 99.174004 104.52451 107.22811 110.76061 116.15611 119.98561 125.57911 130.98181 134.52151 137.22511 142.67461 148.26811 153.61861 157.341 162.73651 168.42001 174.01352 176.71712 181.39262 186.98613 192.38882 197.06883 199.46553 202.64972 205.10222 210.45271 215.12822 217.83182 221.36432 227.04782 232.45052 235.15411 240.54962 246.14313 251.73663 255.56613 260.96881 265.64432 270.31982 273.02344 278.47293 281.62744 284.33105 287.86356 293.54706 298.89755 301.55969 304.716 307.17032 311.00162 315.67892 319.21323 321.91684 324.37115 330.05646 334.73376 338.26807 342.09937 347.78467 352.46198 355.99628 358.45059 363.90189 369.58719 372.2908 374.74512 380.43042 383.13403 386.66833 392.35364 397.70593 400.40955 405.08685 410.48416 412.93848 415.39279 420.74509 426.34039 429.04401 434.68341 438.52551 443.97681 448.65411 454.00641 459.60172 465.28702 469.11832 474.47061 477.77274 480.47635 486.00864 491.69394 497.04623 499.81015 505.26144 510.90085 516.25317 519.91528 525.31256 530.99786 536.63727 539.34088 544.01819 549.41547 555.10077">operand. The target operand specifies the address of the first instruction in the called procedure. The operand can </tspan><tspan y="-246.9597" x="45.119995 50.720695 56.078396 58.961998 64.3647 70.055397 72.879593 75.339294 84.089996 92.792999 98.195694 103.79639 106.2561 111.6588 115.1985 120.5562 123.4398 128.54189 133.94548 136.40518 142.09589 147.45358 150.72328 153.54747 158.95016 161.83376 167.43445 172.79214 178.48285 183.84055 187.56294 192.96654 195.36324 199.44203 205.04272 210.68483 214.52153 220.08 225.5349 230.21579 235.57169 238.39589 242.23079 247.58669 253.18559 255.64349 260.3244 263.8623 269.2182 271.80029 275.06821 277.95181 283.40671 287.24161 290.06583 295.46674 298.35034 307.05334 312.45605 321.15906 326.61935 330.45425 335.77417 338.59839 341.05627 346.51117 351.19208 356.59299 360.13089 362.58878 368.04367 373.73257">be an immediate value, a general-purpose register, or a memory location.</tspan><tspan y="-231" x="45.119995 50.657696 56.348396 58.808098 63.490799 66.314995 68.774696 74.465393 79.148094 82.687798 86.524498 92.215195 96.897896 100.4376 102.8343 108.2946 113.9853 116.8689 121.5516 126.9543 132.645 135.46921 141.06992 146.47261 149.29681 154.98752 159.67021 165.02791 170.6286 173.51221 177.05191 182.50861 185.33281 190.7355 195.897 201.2997 205.97969 211.67039 215.2101 220.56779 223.392 226.5537 232.01039 237.7011 241.5378 244.362 247.9017 253.2234 258.8241 264.18179 268.8645 271.68872 277.14542 280.30713 283.13135 287.81406 293.27795 295.67465 298.13074 302.81345">This instruction can be used to execute four types of calls:</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-216" x="45.119999">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c89C0ADDA"><tspan y="-216" x="62.099998 69.718498 75.689995 81.697495 86.165993 88.928093 95.43959 101.44709 104.52059">Near Call</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-216" x="107.5797 110.4633 122.5836 125.4672 131.6097 134.43388 139.17419 144.5778 146.9745 149.4306 152.25479 155.8548 161.25569 164.13928 169.53479 172.35898 177.99838 181.84048 187.28998 191.96548 197.31598 202.90948 208.59299 212.42249 217.77298 220.65657 223.10907 228.79257 231.67616 235.20866 240.89217 246.24266 249.06685 253.74236 259.42584 263.25534 267.08484 272.43533 278.11884 281.65134 284.53494 289.21045 294.65994 300.25345 305.60394 308.48755 313.16306 318.51355 324.10706 332.82001 338.18222 343.87741 347.4216 350.30518 354.38937 357.93356 363.62875 368.99097 371.81516 376.50235 381.86456 387.46976 396.22495 401.58716 407.28235 410.82654 413.65073 418.33792 424.03311 427.8743 431.71548 437.0777 442.77289 446.31708 448.78128 454.10748 456.93167 462.53687 467.99808 470.46228 476.15747 479.70166 485.06387 490.66907 493.49326 497.03745 502.49866 505.32285 510.92804 516.25421 519.13782 522.68201 528.32318 533.68536 536.50958 542.78979 548.94397"> — A call to a procedure in the current code segment (the segment currently pointed to by the CS </tspan><tspan y="-204.9597" x="62.100006 65.937607 71.296204 76.897804 79.294502 84.034805 87.574509 92.933105 96.770706 100.8513 104.1219 107.0055 111.6891 117.14671 125.89831 131.25691 134.79752 137.25812 145.96112 151.36382 156.04741 158.87161 162.70921 168.06781 171.23041 176.589 180.42661 184.26421 189.6228 195.2244 198.0486 201.5892 207.0468 209.9304 215.334 220.01759 222.8418 228.24539 233.937 236.8206 239.2173 244.91881 248.45941 252.12151 257.52512 261.60571 266.28931 271.64792 277.24951 286.0011 291.35971 297.0513 300.59189 303.41608 308.09967 313.50327 315.96387 318.42447">register), sometimes referred to as an intra-segment call.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-189.96001" x="45.119999">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c89C0ADDA"><tspan y="-189.96001" x="62.099998 67.940102 73.9422 78.405296 81.167397 87.6735 93.675598 96.743698 99.811798">Far Call </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-189.96001" x="102.6 114.5403 120.72421 123.5484 128.23109 133.63379 136.09349 138.55319 141.3774 144.9171 150.37379 153.2574 158.6601 161.4843 167.08499 170.92169 176.37839 181.06108 186.46378 192.04378 197.73448 201.57118 206.92888 209.75308 212.21278 217.66948 222.35217 227.75487 231.29457 236.65227 242.25296 245.07716 247.53687 253.22757 256.05179 261.4545 264.3381 269.93881 272.3985 275.56021 278.72192 284.12463 287.90643 293.30914 299.01065 302.55035 305.37457 310.05728 315.29971 320.90491 329.60791 334.97012 340.66531 344.2095 347.03369 350.57788 356.27307 361.68027 367.37546 370.19965 373.74384 379.43903 384.80124 387.68481 392.37201 398.0672 401.90839 405.74957 411.11179 416.80698 420.35117 423.17535 427.86255 433.32376 438.92896 444.29117 447.11536 451.80255 457.16476 462.76996 471.52515 476.88736 482.58255 486.12674 489.40094 492.28452 496.97171 502.43292 511.13593 516.53864 520.08282 522.47949 531.23468 536.59686 541.28406">—A call to a procedure located in a different segment than the current code segment, sometimes </tspan><tspan y="-178.98001" x="62.100006 65.943909 71.308807 74.477707 79.842606 83.686508 87.530411 92.895309 98.503212 101.32741 104.87431 110.3382 113.2218 118.6317 123.3216 126.1458 131.55569 137.2536 140.13721 142.53391 148.23541 151.78232 157.14722 160.86961 164.94841 169.63831 175.0032 180.6111 189.3141 194.679 200.32111 203.92111 206.74532 211.43521 216.84511 219.31201 221.77892">referred to as an inter-segment call.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-163.98" x="45.119999">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c89C0ADDA"><tspan y="-163.98" x="62.099998 67.004097 73.402199 77.4963 83.462402 87.925499 92.235596 98.516693 102.97979 106.04789 111.92849 114.99659 118.06469 124.03079 130.31189 136.27798 140.58809 143.65619 149.62228 155.50288 161.46898 164.53708 167.29918 171.08728 177.08939 181.55249 184.25429 189.53639 195.5385 198.6066">Inter-privilege-level far call</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-163.98" x="204.77969 216.71999 222.8436 225.6678 228.8304 234.23399 238.07159 240.8958 245.57939 250.98299 253.44359 255.84029 258.66449 262.20508 267.66269 270.48688 275.89047 278.71466 284.31625 288.15384 293.61145 298.29504 303.65366 309.25525 314.94684 318.78442 324.14304 326.96722 329.42783 335.06992 337.8941 343.2977 346.12189 350.80548 356.16409 361.76569 370.51727 375.87589 381.56747 385.10806 387.93225 393.33585 396.87643 399.70062 405.10422 407.8681 413.4697 415.9303 419.0929 422.25549 427.61411 431.45169 436.8103 442.50189 446.04248 448.86667 454.46826 458.30585 460.70255 466.04404 468.50464 470.90134 476.25995 481.86154 487.22015 490.04434 492.50494 497.86356 503.18616 508.54477 511.00537 513.76929 517.30988 523.00146 528.40509 534.09668 536.9209 540.46149 546.15308 551.5567 555.09729">—A far call to a procedure in a segment at a different privilege level than that </tspan><tspan y="-153" x="62.099991 67.558495 70.721992 73.546188 77.087692 82.78019 88.139687 91.023285 95.707787 101.40028 105.23878 109.07729 114.43678 120.12928 123.67078 126.13229 131.45578 134.33939 139.69888 144.92068 150.28018 154.96468 160.65718 164.19868 166.66019 172.35269 177.95518 180.77939 186.38188 190.22038 195.67888 201.28137 204.94347 210.34706 219.09956 221.92377 227.38226 231.22076 234.10437 239.70686 243.54536 249.00386 253.68835 259.04785 264.65036 270.29245 274.13455 279.49405">of the currently executing program or procedure.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-138" x="45.119999">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c89C0ADDA"><tspan y="-138" x="62.099998 68.237099 74.248199 79.584297 85.622398 88.384499 93.720596 102.4758 105.5529 109.65601 114.94711">Task switch</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-138" x="124.56 136.50029 142.68419 145.50839 150.19289 155.59738 158.05888 160.52039 163.34459 166.88609 172.34459 175.2282 180.63269 183.45689 189.05939 192.89789 198.29878 202.97878 208.33827 213.94077 219.63327 223.47177 228.83127 231.71487 234.11157 239.57187 244.25636 249.66086 253.20236 258.56186 264.16437 266.98859 269.45007 275.14258 277.9668 283.37131 286.25491 291.85742 294.31891 297.48242 300.64594 306.00543 309.84393 315.20343 320.89594 324.43744 327.26166 330.80316 336.20767 340.89218 346.21567">—A call to a procedure located in a different task.</tspan><tspan y="-121.98" x="45.119698 50.660099 56.3535 61.713902 64.598404 66.99511 72.398712 75.941109 79.483505 84.843903 88.683304 91.5084 95.050797 102.40919 107.86859 110.69369 115.37909 120.78449 123.24689 125.7093 128.53441 132.01381 137.35532 142.95871 148.31911 153.0045 155.82961 159.912 162.3744 168.06781 171.61021 176.97061 180.75241 184.83481 190.4382 194.2776 196.74001 202.06441 204.52681 206.98921 212.34961 217.953 223.3134 227.3958 229.7925 235.15289 240.37469 245.73509 248.19749 251.0226 255.70799 261.17191 263.5686 266.02472 268.84982 274.25522 279.94861 285.552 288.37711 291.91949 297.23941 301.91852 307.23663 310.06085 314.73996 322.09207 324.54816 328.08426 332.76337 338.45047 342.52658 345.3508 350.02991 355.42902 361.11612 363.94034 369.39343 375.08054 377.53662 382.85474 385.67896 391.27606 396.67877 399.50299 404.85709 410.07886 415.43295 420.17325 425.86035 429.39645 434.79916 440.37918 443.2034 445.65948 451.34659 454.17081 459.81021 463.65231 469.10541 472.64151 477.99561 482.67471 486.21082 491.56491 497.20432 500.02853 508.77563 514.22876 519.82587 525.17999 528.48212 531.30627 537.49017 542.8443 548.19843">The latter two call types (inter-privilege-level call and task switch) can only be executed in protected mode. See </tspan><tspan y="-110.99999" x="45.119705 49.244404 55.520103 60.922802 63.382504 65.842201 68.238899 73.929596 79.530296 82.354492 87.775192 91.611893 97.068596 101.7513 107.15399 112.73399 118.42469 122.26139 127.61909 132.30179 135.12599 141.70769 146.39038 148.85008 154.54079 160.14148 162.96568 169.24138 174.64407 177.10378 179.56348 182.3994 187.80659 193.5018 199.10699 201.9906 208.2438 213.88051 219.42271 223.50241 226.38602 228.85022 234.49232 237.37593 243.65613 249.35133 254.75853 260.36374 263.90793 269.27014 273.11133 275.93555 281.65775 284.48196 289.94318 293.10938 295.93359 299.47778 305.17297 310.53519">“Calling Procedures Using Call and RET” in Chapter 6 of the </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-110.99999" x="313.37909 317.1546 322.8381 326.37061 331.7211 334.17361 343.16013 345.98434 351.74704 357.44946 360.27368 365.66919 371.35269 376.9462 379.8298 383.60532 389.73883 393.81134 399.57404 405.28455 408.10876 414.29269 418.1348 422.8103 428.4938 430.94632 434.47882 439.8815 444.56149 448.09399 453.7775 457.60699 462.95749 467.633 470.45721 476.5997 482.04919 485.2037 488.80371 496.15222 501.54773 505.37723 510.72772 513.61127 520.49176 525.84229 531.14777 536.55048 539.00299">Intel® 64 and IA-32 Architectures Software Devel-</tspan><tspan y="-99.959694" x="45.118805 50.575504 56.176205 61.533905 65.370605 67.834808 72.514809 75.339005 82.919708 88.322411 94.013107 99.703804 105.10651 107.56621 110.83591 113.6601 119.8008 125.25751 127.71721 133.40791 142.15862 147.51631 150.39992">oper’s Manual, Volume 1</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-99.959694" x="156.05911 159.33601 162.16022 165.32912 170.79301 174.63692 177.46112 182.87102 188.47891 194.08681 196.48351 200.03041 202.49731 207.96121 213.65912 219.06902 221.53592 224.36012 226.82703 232.52493 235.69383 241.15773 245.00163 253.75954 259.16943 262.71634 265.18323 270.64713 276.34503 279.16925 284.63315 290.33105 293.15527 298.85318 304.21808 309.62799 312.21008 315.48697 318.31119 321.4801 326.89001 329.47211 332.7139 335.5975 341.00742 346.49911 352.09531 354.91949 357.37469 363.06088 366.59607 371.94928 375.73108 379.80988 385.40607 389.23828 391.69348 397.01068 399.46588 401.92108 407.27429 412.87048 418.27319 422.34839 424.74509 430.1478 435.3696 440.72281 443.17801 446.0022 450.68039 456.14429 458.54099 460.99707 465.67526 468.94046 471.76465 477.90985 483.31256 488.66577 491.54935 497.82056 503.50674 508.90494 514.50116 518.03638 523.43909 527.2713 530.09552 535.80872 539.07391">, for additional information on near, far, and inter-privilege-level calls. See Chapter 7, </tspan><tspan y="-88.979691" x="45.118835 49.249836 53.687737 59.096737 63.785736 69.113739 71.937935 79.524933 84.933929 90.630928 96.039925 101.64693 107.01093 115.76793 121.13193 126.82893 130.37492 132.71672 136.85672 139.68092 142.07762 147.77913 150.60333 154.14934 159.79144 165.15544">“Task Management,” in the </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-88.979691" x="167.81854 171.59494 177.27934 180.81274 186.16414 188.61754 197.60493 200.42912 206.14052 211.85191 214.6761 220.07249 225.7569 231.3513 234.11519 237.89159 244.07458 248.14798 253.85938 259.57077 262.39496 268.52936 272.35977 277.03616 282.72055 285.17395 288.70734 294.05875 298.73514 302.26852 307.95291 311.78333 317.13474 321.81113 324.63531 330.77872 336.22913 339.38452 342.91791 350.2673 355.6637 359.49411 364.84552 367.60941 374.49081 379.84222 385.14862 390.50003 392.95343 398.40384 403.99823 409.40094 413.23135 415.63974 420.31613 423.14032 430.71472 436.11111 441.7955 447.47989 452.87628 455.39267 458.65607 461.48026 467.61465 473.06506 475.51846 481.20285 489.94727 495.34998 498.11386 503.82526">Intel® 64 and IA-32 Architectures Software Developer’s Manual, Volume 3A</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-88.979691" x="509.99854 513.24036 516.18427 519.54846 525.18872 529.21082 532.15472 534.79083 540.6723 543.9762 549.61646 553.57825">, for infor-</tspan><tspan y="-77.999687" x="45.118835 54.051338 59.635838 63.357338 65.934044 71.572548 77.445045 80.449242 86.087746 91.960243 94.964439 100.74694 106.28644 110.30494 113.64844 119.28694 123.30544 132.23795 134.87944 140.75194 146.53444 149.53865 153.26015 158.84465 163.70915 169.21265 172.21686 177.08136 184.61887 187.19556 190.91525 195.77975 201.65225 207.19176 212.05626 215.06047 222.59798 225.23947 228.96097 234.83347 237.83768 241.55917 247.43167 252.97118 255.97537 262.43286 268.76437 273.95288 279.14139 282.1456 284.60172 290.30322 294.98322 298.52292 302.36502 308.06653 312.74652 316.28622 318.74234 324.14322 329.84473">mation on performing task switches with the CALL instruction.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-700.97968" x="50.638535 56.594734 61.695034 65.654137 70.693237 75.731438 136.27084 138.65404 143.80023 147.99962 151.60051 154.8567 160.0029 164.142 167.6826 169.9623 175.0014 233.3799 239.3793 244.41751 247.83571">OpcodeInstructionOp/ </tspan><tspan y="-691.01935" x="233.39883 238.43704">En</tspan><tspan y="-700.97968" x="258.11914 263.63885 269.21707 271.98276 277.02545 279.26016 282.83588">64-bit </tspan><tspan y="-691.01935" x="258.11914 265.06354 270.11795 275.15793">Mode</tspan><tspan y="-700.97968" x="306.11884 311.08502 316.0647 323.55991 328.59988 333.42209 337.0383">Compat/</tspan><tspan y="-691.01935" x="306.11884 310.55945 315.59854 320.63852 322.85883 329.81851 334.79819 339.89847">Leg Mode</tspan><tspan y="-700.97968" x="352.85852 358.69232 363.73413 368.02893 372.13474 375.41254 377.66434 382.52435 386.12524 388.37704 393.41885">Description</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-676.01996" x="50.638489 55.379688 60.599689">E8 </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-676.01996" x="62.818188 66.778191">cw</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-676.01996" x="136.25819 140.95079 146.59019 151.02179 155.45338">CALL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-676.01996" x="157.67819 160.9182 165.65939 167.69879 172.97908">rel16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-676.01996" x="233.39789 258.11548 263.99606 265.70337 270.47968 306.12057 311.82208 316.29239 318.2157 320.16599 352.86569 357.58798 362.05829 363.9816 365.90491 368.12433 372.90063 377.61392 382.08423 385.34854 387.17285 389.39227 392.65659 397.36987 399.29318 403.76349 407.1358 409.08609 413.72739 418.44067 420.26498 422.48441 427.14371 429.05789 433.06738 437.72488 439.64639 444.1149 448.01639 452.72787 459.67139 464.38287 469.15738 472.52789 474.74728 478.0098 482.72128 484.64279 489.1113 492.48181 494.4303 499.06979 503.78128 506.00067 509.37119 514.09167 516.3111 521.08557 525.79706 530.58057 533.95105">DN.S.ValidCall near, relative, displacement relative to next </tspan><tspan y="-664.97968" x="352.8576 354.8277 359.56982 363.60092 366.99301 370.2771 375.01923 378.94232 382.33441 384.3045 388.98541 393.78152">instruction.</tspan><tspan y="-649.97937" x="50.637573 55.378773 60.598774">E8 </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-649.97937" x="62.817272 66.777275">cd</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-649.97937" x="136.25728 140.94987 146.58928 151.02087 155.45247">CALL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-649.97937" x="157.67728 160.91728 165.65848 167.69788 172.97816">rel32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-649.97937" x="233.39697 258.11456 263.81604 268.29083 270.21863 272.17343 306.13312 311.8139 316.2887 318.21649 320.1713 352.87097 357.61218 362.08698 364.01477 365.94257 368.16196 372.94275 377.66055 382.13535 385.40414 387.23294 389.39667 392.64386 397.38416 399.29034 403.74353 407.09872 409.08054 413.70474 418.40094 420.25943 422.47882 427.12103 429.10284 433.09705 437.73926 439.64545 444.14453 448.03073 452.72693 459.65512 464.39542 469.1546 472.49637 474.71579 477.99808 482.67896 484.62027 489.10858 492.46826 494.38974 499.04904 503.72992 505.94934 509.30902 514.05023 516.26959 521.01172 525.75201 530.5553 533.91504">DValidValidCall near, relative, displacement relative to next </tspan><tspan y="-638.99939" x="352.85669 354.8187 359.56079 363.5838 366.9678 370.2438 374.9859 378.90091 382.28491 384.24692 388.92783 393.71582 395.39612 397.61551 402.8895 408.16348 411.00748 415.62717 417.60898 420.99298 423.21237 427.88336 429.80487 433.82788 438.49887 440.43387 444.87357 448.78857 453.47668 460.39407 465.13437 469.88278 473.30276 475.52219 479.50558 481.48737 486.11877 490.92117 493.14059 497.82599 502.62387 505.96826 510.70856 515.45697 520.13611 524.82153 529.50067 531.72003 535.06445 539.80566">instruction. 32-bit displacement sign extended to </tspan><tspan y="-628.01941" x="352.85669 358.13699 363.35699 366.23788 370.85757 372.83939 376.1991 380.19598 382.41537 384.35129 389.15369 391.37308 396.62097 401.90128 404.71918 409.39828 411.3342 414.69211 416.9115 423.84241 428.58359 433.22849 437.96881">64-bits in 64-bit mode.</tspan><tspan y="-613.0191" x="50.636658 55.339157 60.041656 62.261059 65.37056 136.23117 140.93367 146.57307 151.01457 155.45607">FF /2CALL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-613.0191" x="157.67636 160.88846 163.94756 170.98465 176.20465">r/m16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-613.0191" x="233.39606 258.11636 263.99698 265.67728 270.41849 306.11877 311.82025 316.25995 318.18146 320.14526 352.84497 357.58078 362.02048 363.95728 365.89407 368.11346 372.90326 377.58417 382.06796 385.34576 387.18356 389.40295 393.84265 398.52173 402.48355 407.22476 409.16156 413.95135 417.33716 422.01807 424.23746 426.20126 430.94336 435.61615 437.57996 440.85776 445.53867 449.45547 452.84128 454.67908 456.89847 461.33817 466.01096 470.68375 473.96155 478.68835 482.65018 486.67499 488.89438 493.56717 495.48868 500.14349 504.8244 509.6142 511.83359 513.75507 518.55743">MN.E.ValidCall near, absolute indirect, address given in </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-613.0191" x="520.73633 523.93494 526.98053 534.00415 539.26373 544.52332 546.29993">r/m16. </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-598.0188" x="50.636627 55.339127 60.041626 62.261028 65.370529 136.23114 140.93364 146.57304 151.01454 155.45604">FF /2CALL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-598.0188" x="157.67633 160.88843 163.94753 170.98462 176.20462">r/m32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-598.0188" x="233.39603 258.11633 263.99695 265.67725 270.41846 306.11874 311.82022 316.25992 318.18143 320.14523 352.84491 357.58072 362.02042 363.95721 365.89401 368.1134 372.9032 377.58411 382.0679 385.3457 387.1835 389.40289 393.84259 398.52167 402.48349 407.2247 409.1615 413.95129 417.3371 422.01801 424.2374 426.2012 430.9433 435.61609 437.5799 440.8577 445.5386 449.45541 452.84122 454.67902 456.89841 461.3381 466.01089 470.68369 473.96149 478.68829 482.65012 486.67493 488.89432 493.56711 495.48862 500.14343 504.82434 509.61414 511.83353 513.755 518.55737">MN.E.ValidCall near, absolute indirect, address given in </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-598.0188" x="520.73633 523.93494 526.98053 534.00415 539.26373 544.52332 546.29993">r/m32. </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-583.01849" x="50.636627 55.339127 60.041626 62.261028 65.370529 136.23114 140.93364 146.57304 151.01454 155.45604">FF /2CALL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-583.01849" x="157.67633 160.88843 163.94753 170.98462 176.20462">r/m64</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-583.01849" x="233.39603 258.11633 263.81784 268.25754 270.17905 272.14374 306.10345 311.96515 313.64545 318.38214 352.82245 357.55914 361.99884 363.93655 365.87427 368.09369 372.8844 377.56528 382.04999 385.32867 387.16739 389.38681 393.82651 398.50562 402.46741 407.20859 409.1463 413.93701 417.3237 422.00458 424.224 426.18869 430.93079 435.60449 437.56918 440.84787 445.52875 449.44644 452.83313 454.67184 456.89127 461.33096 466.00467 470.67838 473.95706 478.68475 482.64655 486.67224 488.89166 493.56537 495.48685 500.14255 504.82343 509.61414 511.83356 513.75507 518.5575">MValidN.E.Call near, absolute indirect, address given in </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-583.01849" x="520.73633 523.93311 526.97693">r/m</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-583.01849" x="533.99603 539.216 544.49628">64.</tspan><tspan y="-568.01819" x="50.635742 55.894444 61.495144">9A </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-568.01819" x="63.715443 67.615143">cd</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-568.01819" x="136.25545 140.94804 146.58745 151.01904 155.45064">CALL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-568.01819" x="157.67545 162.41664 165.65755 168.82375 174.10405 179.33125 181.18976 186.41696">ptr16:16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-568.01819" x="233.39514 258.11273 260.21335 264.98514 269.62195 274.08774 276.06863 278.01443 306.15381 311.82562 316.29141 318.21021 320.15601 352.85568 357.59689 362.06268 363.98148 365.90027 368.11966 371.45145 375.91724 379.17703 380.99683 383.21622 387.68201 392.33679 396.3436 401.0614 402.98019 407.75485 411.13705 415.86026 417.69446 419.91385 424.39404 429.01373 433.68292 436.95712 441.68033 445.70154 449.66336 451.88275 456.55194 458.51215 463.16336 467.84427 472.63046 474.84985 476.77136 481.57376 483.79315 488.52536 493.14505 497.86826 501.14246 505.62265 510.36475 515.03394">DInvalidValidCall far, absolute, address given in operand.</tspan><tspan y="-553.01788" x="50.634857 55.893559 61.494259">9A </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-553.01788" x="63.714558 67.614258">cp</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-553.01788" x="136.25456 140.94716 146.58656 151.01816 155.44975">CALL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-553.01788" x="157.67456 162.41576 165.65666 168.82286 174.10316 179.33037 181.18887 186.41608">ptr16:32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-553.01788" x="233.39426 258.11185 260.21246 264.98425 269.62106 274.08685 276.06775 278.01355 306.15292 311.82474 316.29053 318.20932 320.15512 352.8548 357.59601 362.0618 363.98059 365.89938 368.11877 371.45056 375.91635 379.17615 380.99594 383.21533 387.68112 392.33591 396.34271 401.06052 402.97931 407.75397 411.13617 415.85938 417.69357 419.91296 424.39316 429.01285 433.68204 436.95624 441.67944 445.70065 449.66248 451.88187 456.55106 458.51126 463.16248 467.84338 472.62958 474.84897 476.77048 481.57288 483.79227 488.52448 493.14417 497.86737 501.14157 505.62177 510.36386 515.03308">DInvalidValidCall far, absolute, address given in operand.</tspan><tspan y="-538.01758" x="50.633972 55.336472 60.038971 62.258373 65.367874 136.22849 140.93098 146.57039 151.01189 155.45338">FF /3CALL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-538.01758" x="157.67368 164.70717 169.97667 175.24617 177.07767 182.34717">m16:16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-538.01758" x="233.39337 258.11368 263.81519 268.29089 270.2196 272.17529 306.13501 311.81671 316.29242 318.22113 320.17682 352.87653 357.61771 362.09341 364.02213 365.95084 368.17026 371.51196 375.98767 379.25739 380.99335 383.21274 387.69653 392.31622 396.34103 401.07684 403.01364 407.75574 411.14154 415.86835 418.08774 420.00925 424.81165 429.48444 431.40594 434.68375 439.41055 443.32736 446.71317 448.93256 453.41635 458.03604 462.70883 465.98663 470.71344 474.67526 478.70007 480.91946 485.59225 487.51376 492.16858 496.84949 501.63928 503.85867 505.78018 510.58258">MValidValidCall far, absolute indirect address given in </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-538.01758" x="512.75336 519.78503 525.005 530.27271 532.10242 537.37012 542.63782">m16:16.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-523.9776" x="352.85306 354.93567 359.73807 361.95746 367.20807 372.48837 375.30896 379.98807 381.92667 385.28726 387.50665 394.44025 399.18146 403.82907 408.56937 410.30997 412.52936 414.46796 417.82675 420.04614 424.04575 428.74734 430.65894 435.39923 439.29083 442.65143 447.39264 450.63443 452.81335 457.46725 462.18414 464.12903 468.89993 472.31995 476.28174 478.50113 481.86804 486.58493 488.80432 493.26923 495.48862 500.14252 504.60742 507.97433 512.68225 514.54077 516.76019 520.12708 524.89795 529.60583 534.37671 536.59613 542.05554 544.15619 549.2691">In 32-bit mode: if selector points to a gate, then RIP </tspan><tspan y="-512.99762" x="352.85306 357.95065 360.17004 365.45035 370.73065 373.55127 378.18988 380.17166 383.52325 385.74265 389.88623 394.62653 397.87012 402.61133 404.83072 409.52332 414.3212 417.67279 422.41309 427.1687 431.84781 436.54041 441.21951 443.4389 448.11801 450.03952 454.03012 458.70923 460.61182 465.0614 468.944 473.6843 480.60889 485.34918 490.1048 493.45639 495.67578 499.09576 503.53546 507.79605 512.53638 517.29199 519.51135 522.87018 526.112 530.85321 537.81384">= 32-bit zero extended displacement taken from </tspan><tspan y="-501.95731" x="352.85306 357.52405 361.96375 365.34775 370.07275 371.95377 374.17316 378.89816 380.83316 384.79498 389.53528 391.75467 397.15466 399.25525 404.38525 406.60464 411.73465 413.95404 418.09494 422.77585 426.05185 430.73276 432.95215 437.67715 442.47415 445.85815 450.53906 455.32706 459.94675 464.67175 469.34274 471.56213 476.78214 482.06241 484.9064 489.57739 491.4989 494.85861 497.078 501.81201 505.11139 508.45938 512.48236 517.16321 520.58319 522.80261 526.10205 529.34387 534.07788 541.03485">gate; else RIP = zero extended 16-bit offset from </tspan><tspan y="-490.97729" x="352.85306 356.16867 360.61826 363.92035 366.13974 370.77835 375.47995 377.40955 382.21198 385.56357 390.30386 393.54745 395.76685 399.01044 403.75073 407.06635 411.80664 415.05023 419.79053 424.54614 428.42874 433.16904 437.78876 440.00815 441.98993 446.73206 448.95145 452.37143 457.11353 461.85382 464.07321 466.00281 470.80524 474.79584 478.21582 481.45941 486.26184 490.14444 493.49603 495.42563 500.12723 504.88281">far pointer referenced in the instruction.</tspan><tspan y="-475.97699" x="50.633026 55.335526 60.038025 62.257427 65.366928 136.22754 140.93004 146.56944 151.01094 155.45244">FF /3CALL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-475.97699" x="157.67273 164.70622 169.97572 175.24522 177.07672 182.34622">m16:32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-475.97699" x="233.39243 258.11273 263.81424 268.28635 270.21146 272.16354 306.12323 311.80133 316.27344 318.19855 320.15063 352.85034 354.95093 359.72903 361.94846 367.21255 372.47665 375.31076 379.97186 381.92395 385.29807 387.51749 394.4646 399.18869 403.84979 408.56488 410.31897 412.53839 414.63449 417.9726 420.19202 424.20511 428.9202 430.84531 435.47214 439.37634 442.74954 447.47275 450.73795 452.95734 457.61752 462.34073 464.29193 469.06912 472.44232 476.45453 478.67392 482.04712 486.77032 488.99243 493.45374 495.67313 500.32343 504.78473 508.14804 512.85236 514.66766 516.88708 520.25037 525.01764 529.72192 534.4892 536.70862 542.1239 544.20923 549.31854">MValidValidIn 64-bit mode: If selector points to a gate, then RIP </tspan><tspan y="-464.99698" x="352.85211 357.96143 360.18173 365.43503 370.68832 373.51163 378.16193 380.14465 383.50797 385.72827 390.37857 392.31989 396.32217 400.97247 402.88678 407.34808 411.24237 415.94669 422.883 427.58731 432.35461 435.71793 437.93823 441.35913 445.79974 450.07205 454.77637 459.54367 461.76398 465.09128 468.34659 473.05988 479.99619 482.21649 486.86679 491.36679 494.7301 499.43442 501.35501 503.57532 508.27963 510.19394 514.19623 518.90051 521.12079 526.58105 528.68256 533.79187 536.01215 541.12146">= 64-bit displacement taken from gate; else RIP = </tspan><tspan y="-453.95667" x="352.85211 357.03082 361.7117 364.99039 369.72708 371.9465 376.67419 381.4118 384.79849 389.52618 394.26828 398.94739 403.67508 408.2948 410.51422 415.79092 421.01093 423.85764 428.47736 430.44205 433.82874 436.04816 440.72906 444.07977 447.43048 451.39227 456.11996 459.50665 461.72607 465.07678 468.35547 473.09216 479.99246 482.21188 485.56259 490.00229 493.28098 495.5004 500.12012 504.8613 506.78278 511.58517 514.97186 519.69958 522.97827">zero extended 32-bit offset from far pointer </tspan><tspan y="-442.97665" x="352.85211 356.15421 360.83511 364.19394 368.87485 372.12024 376.86053 381.66293 385.56262 390.25702 394.93613 397.15552 399.08691 403.88931 406.1087 409.4621 414.21948 418.95978 421.17917 423.11057 427.91299 431.9054 435.25879 438.50418 443.30661 447.19101 450.5444 452.52621 457.20712 462.00955 463.68985">referenced in the instruction. </tspan><tspan y="-427.97635" x="50.63208 56.054581 60.775082 66.43158 68.137077 75.397377 77.616776 82.337273 87.05777 89.277168 92.404671 136.20497 140.88588 146.52527 150.98477 155.44427">REX.W FF /3CALL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-427.97635" x="157.67178 164.70528 169.97478 175.24428 177.07578 182.34528">m16:64</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-427.97635" x="233.39148 258.11179 263.81329 268.2872 270.21411 272.168 306.12772 311.97861 313.68951 318.41541 352.85571 354.95361 359.73352 361.95294 367.17294 372.45325 375.28915 379.95206 381.90594 385.28186 387.50128 394.4502 399.17609 403.79578 408.53607 410.29196 412.51138 414.60928 417.94919 420.16861 424.1835 428.90039 430.8273 435.47119 439.3754 442.7486 447.4718 450.737 452.95639 457.61658 462.33978 464.29099 469.06818 472.44138 476.45358 478.67297 482.04617 486.76938 488.99149 493.45279 495.67218 500.32248 504.78378 508.14709 512.85138 514.66669 516.88611 520.24939 525.01666 529.72095 534.48822 536.70764 542.12292 544.20825 549.31757">MValidN.E.In 64-bit mode: If selector points to a gate, then RIP </tspan><tspan y="-416.99634" x="352.8512 357.96051 360.18082 365.43411 370.68741 373.51071 378.16101 380.14374 383.50705 385.72736 390.37766 392.31897 396.32126 400.97156 402.88586 407.34717 411.24146 415.94577 422.88208 427.5864 432.3537 435.71701 437.93732 441.35822 445.79883 450.07114 454.77545 459.54276 461.76306 465.09036 468.34567 473.05896 479.99527 482.21558 486.86588 491.36588 494.72919 499.4335 501.3541 503.5744 508.27872 510.19302 514.19531 518.8996 521.11987 526.58014 528.68164 533.79095 536.01123 541.12054">= 64-bit displacement taken from gate; else RIP = </tspan><tspan y="-405.95602" x="352.8512 358.12698 363.34698 366.19278 370.81247 372.77628 376.16208 378.38147 383.11728 386.41666 389.76645 393.72827 398.45508 401.84088 404.06027 407.41006 410.68787 415.42368 422.32397 424.54337 427.89316 432.33286 435.61066 437.83005 442.44974 447.19095 449.15475 453.89685 457.28265 462.00946 465.28726 467.50665 470.78445 475.51126 478.86105 483.54196 486.81976 491.54657 496.28867 500.18747 504.91428 509.58707 511.80646 513.72797 518.53033 520.74976 524.13556 528.87762 533.60443">64-bit offset from far pointer referenced in the </tspan><tspan y="-394.97601" x="352.8512 354.82129 359.56342 363.59451 366.9866 370.27069 375.01282 378.93591 382.328 384.2981 388.979 393.77512 395.45541">instruction. </tspan><tspan y="-341.99573" x="55.731476 61.429379 66.108475 69.226982 73.968178 127.01057 132.70848 137.38759 142.0685 145.13029 149.62939 154.37151 159.05061 161.27002 242.03062 247.72853 252.40764 257.08853 260.15033 264.64941 269.39151 274.07059 276.28998 360.1106 365.8688 370.48849 375.22879 378.29059 382.73029 387.53268 392.15237 394.37177 479.33179 485.02969 489.70877 494.44907 497.51086 501.95056 506.75296 511.37265 513.59204">Op/EnOperand 1Operand 2Operand 3Operand 4</tspan><tspan y="-325.97574" x="64.491173 134.68936 140.38727 143.74606 146.98515 150.94696 155.44788 256.06787 261.88904 374.14874 380.02933 493.36902 499.19019">DOffsetNANANA</tspan><tspan y="-309.95575" x="63.951172 119.93117 126.47147 131.21268 135.89178 141.29178 147.83208 149.63387 152.87567 155.99416 162.95474 165.17413 167.75352 170.99533 256.07413 261.89532 374.15503 380.03564 493.37534 499.19653">MModRM:r/m (r)NANANA</tspan></text><path transform="matrix(1,0,0,-1,0,792)" d="m 47.4,389.22 h 0.480014 V 709.74 H 47.4 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 133.02,388.74 h 0.48002 V 710.22 H 133.02 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 230.16,388.74 h 0.48002 V 710.22 H 230.16 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 254.88,388.74 h 0.48 v 321.48 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 302.88,388.74 h 0.48003 V 710.22 H 302.88 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 349.62,388.74 h 0.48 v 321.48 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 555.06,389.22 h 0.48 v 320.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 47.4,709.74 h 508.14006 v 0.48 H 47.4 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 47.4,684.78 h 508.14006 v 0.4801 H 47.4 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 47.4,658.74 h 508.14006 v 0.48 H 47.4 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 47.4,621.78 h 508.14006 v 0.48 H 47.4 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 47.4,606.78 h 508.14006 v 0.48 H 47.4 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 47.4,591.78 h 508.14006 v 0.48 H 47.4 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 47.4,576.78 h 508.14006 v 0.48 H 47.4 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 47.4,561.78 h 508.14006 v 0.48 H 47.4 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 47.4,546.78 h 508.14006 v 0.48 H 47.4 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 47.4,484.74 h 508.14006 v 0.48 H 47.4 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 47.4,436.74 h 508.14006 v 0.48 H 47.4 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 47.4,388.74 h 508.14006 v 0.48 H 47.4 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.6,305.22 h 0.48001 v 47.52 H 45.6 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 88.38,304.74 h 0.48 v 48.48 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 204.66,304.74 h 0.48002 v 48.48 H 204.66 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 318.42,304.74 h 0.48 v 48.48 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 440.88,304.74 h 0.48003 v 48.48 H 440.88 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 556.86,305.22 h 0.47999 v 47.52 H 556.86 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.6,352.74 h 511.73999 v 0.48 H 45.6 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.6,336.72 h 511.73999 v 0.48 H 45.6 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.6,320.76 h 511.73999 v 0.48 H 45.6 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.6,304.74 h 511.73999 v 0.48 H 45.6 Z" inkscape:connector-curvature="0" /></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="511.20746pt" height="632.74188pt" viewBox="0 0 511.20746 632.74188" sodipodi:docname="243.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.48885" inkscape:cy="407.8401" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg290" /><g transform="translate(-46.133362,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c1AE6E0A5"><tspan y="-715.97998" x="46.02 52.509903 57.505802 62.544003 66.022507 68.063705 74.553604 79.591805 82.085709 84.579605 87.073502">Near Call. </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-715.97998" x="89.100296 97.990494 103.6767 109.0299 114.7161 117.36031 122.71351 127.9353 133.2885 137.96671 143.65291 147.18811 149.64331 155.32951 160.96892 163.55281 168.951 171.5952 177.2814 182.6346 188.03279 191.86499 194.44888 199.12709 204.52528 206.98048 209.43568 212.73778 215.32167 218.85687 224.54308 229.89627 232.54047 238.13667 241.96887 247.42107 252.09927 257.45248 262.13068 266.80887 272.26108 276.09329 278.73749 284.33368 290.01987 294.69806 300.38425 305.73746 310.41565 313.05984 316.59503 322.28122 327.68393 330.26782 335.42932 340.7403 343.1973 348.88528 354.2403 356.82419 362.2782 365.43719 368.02109 371.62106 377.26315 382.66586 385.24976 390.92874 394.70874 400.12674 402.77094 406.60495 411.95996 417.55795 420.01495 424.69495 428.23193 433.58694 437.42096 440.06516 444.14215 451.49515 457.18314 459.64014 464.32013 470.00812 472.59201 477.272 482.72601 488.414 491.95099 497.35098 499.80798 505.49597 510.17596 512.75989 516.29688 521.98486 527.33984 529.98407 535.43805 538.59705 541.75604 546.43604 551.83875 555.37842">When executing a near call, the processor pushes the value of the EIP register (which contains the offset </tspan><tspan y="-705" x="46.019989 51.473991 54.632992 57.51749 61.054489 66.742493 72.097496 74.9226 77.379601 83.067604 87.747604 91.284607 95.118607 100.80661 105.48661 109.02361 111.48061 116.93462 122.62262 125.50712 128.66612 134.12012 136.51772 138.97472 144.42871 151.78171 154.23871 159.92671 165.52472 168.40921 171.94621 177.63422 182.98921 185.8143 192.0873 198.2343 203.2383 208.24229 211.12679 213.58379 219.27179 223.95178 227.48878 231.32278 237.01079 241.6908 245.2278 247.6848 253.13879 258.82678 262.90378 265.72888 271.18289 276.87088 279.69598 283.23297 288.92096 294.32458 297.12 301.8027 305.34241 310.74512 315.42783 320.74951 323.57373 327.65344 330.81516 336.27185 340.10855 342.93277 348.62347 353.30618 358.66388 361.54749 364.00717 369.40988 372.94958 378.30728 382.14398 384.9682 390.37091 395.05362 397.93723 403.33994 406.16415 410.00085 415.35855 418.89825 424.58896 428.37076 434.07227 438.15198 440.61166 446.30237 450.98508 454.52478 458.36148 464.05219 468.73489 472.2746 474.73428 480.13519 485.8367 488.72031 494.32101 499.77771 502.2374 507.9281 511.4678 516.8255 520.66217 524.74188 528.0116 530.89514 536.43286 542.12354 547.48126">of the instruction following the CALL instruction) on the stack (for use later as a return-instruction pointer). The </tspan><tspan y="-694.02002" x="46.020004 51.619804 55.455605 60.911404 65.593201 70.949997 75.631798 80.313599 85.769402 89.605202 92.4888 96.027603 101.71741 107.0742 112.76401 115.5882 121.188 124.9104 130.31219 136.002 140.68379 146.3259 151.72859 156.40858 159.23277 162.77158 168.22737 171.11096 174.64977 180.29187 185.69456 188.51875 193.92055 199.52036 205.12015 208.95595 214.31274 218.99454 223.67633 226.55992 228.95662 234.65813 237.54172 241.08052 246.77032 252.12712 254.95131 259.63312 265.32291 269.15869 272.99448 278.35129 284.04108 287.57986 290.46347 295.14526 300.54001 306.1344 311.48581 314.36942 319.04581 324.39722 329.99161 338.73602 344.08743 349.77182 353.30521 356.18881 360.8652 366.45959 371.811 376.4874 378.9408 382.09619 384.54959 389.901 395.49539 398.379 403.97339 409.28879 412.17239 415.70578 421.39017 426.74158 429.5658 433.09918 438.49557 442.32599 447.96539 453.3168 456.85019 459.67441 465.12482 470.76422 476.11563 479.77774 485.17413 490.85852 496.45291 499.755 502.57922 508.15744 513.79956 519.20221 522.02643 525.55981 530.95624 534.78662 540.42603 545.7774 549.31079">processor then branches to the address in the current code segment specified by the target operand. The target </tspan><tspan y="-682.97974" x="46.020004 51.473106 57.070206 62.424305 66.146706 71.545807 77.23291 82.872307 85.395905 90.075005 95.714401 101.0685 105.7476 108.2037 111.3618 113.7585 119.1612 123.8403 126.36389 131.76659 134.16328 137.69939 143.38649 148.74059 152.57368 155.15758 160.55667 166.24377 168.76736 174.16646 179.80586 184.48495 189.93805 192.33475 198.03625 201.57236 206.97505 209.49864 214.95174 218.10983 221.26793 225.94702 231.30112 234.83722 237.42111 239.81781 245.51932 248.10321 251.63931 257.32642 262.68051 265.26443 269.94354 275.39664 281.03604 286.37845 288.96237 293.64148 298.92001 304.51712 313.26422 318.61832 324.30542 327.84152 330.42453 334.50064 339.89975 345.58685 348.10956 353.56265 356.72076 359.87888 364.55798 369.91208 373.44818 376.03119 379.1893 383.0224 388.47549 397.2226 399.8056 403.34171 409.02881 414.3829 416.90561 422.54413 427.94684 432.62595 437.98004 440.56305 446.01614 449.17426 451.75726 455.29337 460.98047 466.33456 468.91757 473.59668 479.04977 484.64688 490.00098 492.58398 497.26309 502.61719 508.25571 516.95782 522.35968 528.00085 531.53693 535.61304 538.19604 543.64917 547.4823 550.06531 555.46442">operand specifies either an absolute offset in the code segment (an offset from the base of the code segment) or a </tspan><tspan y="-671.99976" x="46.020004 49.853104 55.207203 57.663303 63.062405 66.598503 69.054604 74.276405 79.618805 82.022697 87.4758 90.633896 93.791992 98.471092 103.8252 107.4252 109.76879 113.84489 119.244 121.6479 126.327 128.7831 134.3802 140.06731 145.4214 151.01851 153.42241 159.01952 161.47562 166.15472 171.75183 174.20793 179.60703 184.28613 189.64023 198.38733 203.74142 209.42853 212.96463 215.36853 219.20163 224.55573 227.01183 232.41092 235.94702 238.40312 243.62492 248.96732 251.37122 254.90732 260.36041 262.70401 266.30402 271.94611 277.34882 279.69241 284.37152 290.05862 293.89172 297.72482 302.99969 308.6886 312.2265 314.6304 319.73251 325.13611 327.59399 333.2829 338.63879 341.04269 346.49759 349.6575 352.0011 355.539 361.22791 366.5838 368.9877 371.44559 377.13449 381.87479 385.41449 389.24939 394.93829 399.6192 403.1571 405.61499 411.06989 416.75879 419.10239 424.70129 430.15619 432.55289 438.25439 441.7923 447.19501 451.02991 453.3735 455.83139 461.52029 463.86389 467.40179 473.0907 478.44659 480.85049 486.5304 490.31131 495.73022 498.13412 501.96902 507.32492 512.92383 515.38171 520.06262 523.60052 528.95642 532.79132 536.8692 539.27313 542.81104 548.49994 550.95782 555.63873">relative offset (a signed displacement relative to the current value of the instruction pointer in the EIP register; this </tspan><tspan y="-661.01978" x="46.019989 51.122089 56.525692 58.982693 64.670692 70.025696 72.909294 78.507294 83.961296 86.418297 92.1063 95.643303 100.3233 103.1475 106.6845 112.1385 115.0221 118.5591 124.24711 129.64981 132.47401 134.93102 140.61902 145.29901 148.83601 152.67001 158.35802 163.03802 166.57503 168.97173 174.43202 180.12003 183.00363 186.16263 191.61662 194.07362 196.53062 201.98462 209.33762 211.79462 217.48262 223.08063 225.90483 229.50484 235.14694 240.54964 243.37384 249.64684 255.79384 260.79785 265.80185 268.62604 271.08304 276.77103 281.45102 284.98801 288.82202 294.48029 299.16479 302.7063 305.16779 310.62628 316.26837 320.3472 323.61871 326.44293 331.98242 337.62451 343.02722 345.85144 352.12894 358.28043 361.16403 365.00253 370.36203 375.96454 378.42603 383.11053 386.65204 392.01154 395.85004 398.73364 401.12943 405.86972 408.69394 414.38644 419.84494 423.38644 426.21066 430.89517 436.58768 441.99219 447.68469 453.2872 458.68991 464.29242 467.11664 472.57513 478.26764 481.09186 486.78436 492.18707 497.59158 501.43008 504.2543 508.93881 514.34332 516.80481 519.2663 523.95081">value points to the instruction following the CALL instruction). The CS register is not changed on near calls.</tspan><tspan y="-644.99976" x="46.019974 50.942974 56.403275 60.241776 62.585377 67.989876 70.274071 75.966568 81.326065 86.730568 90.569069 92.912666 97.597168 103.00167 105.46317 107.85988 110.20348 115.60798 121.21048 125.89498 131.35349 133.81499 139.50749 143.049 148.40849 151.67999 153.96419 159.36868 165.06119 167.34538 172.74988 178.35237 183.03687 188.49536 190.89206 196.59357 200.13507 205.49457 207.83817 213.29666 216.46016 219.62366 224.30815 229.66765 233.20915 235.49335 237.95485 242.63934 244.92354 249.60803 255.21053 260.57004 265.25455 267.71603 270.87955 273.27625 278.67896 284.28146 286.56567 289.02716 294.66028 300.26007 302.71887 306.55466 311.91147 316.59326 320.13205 322.59085 327.91165 330.19586 332.65466 338.34445 340.62866 346.03046 348.37405 353.97385 359.33066 365.02045 370.37726 374.03934 379.44293 381.90173 385.98053 391.58032 397.27011 401.1059 406.70569 412.1615 416.84329 422.2001 424.5437 428.37949 433.7363 439.33609 441.79489 446.47668 450.01547 455.37228 459.20807 461.55167 467.00748 470.84326 473.12747 478.52927 480.87286 489.57584 494.97855 503.68152 509.14182 512.9776 518.2984 520.64203 523.03876 528.49908 533.18091 538.5827 542.12152 544.58032 550.03613 555.72595">For a near call absolute, an absolute offset is specified indirectly in a general-purpose register or a memory location </tspan><tspan y="-634.01978" x="46.019989">(</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-634.01978" x="50.099689 53.93549 58.01429 66.764091 72.480888">r/m16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-634.01978" x="78.179688 81.481789">, </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-634.01978" x="84.29969 88.139091 92.221489 100.97489 106.69529 112.41569 115.68809 118.51228 123.97168 127.81108 130.69469 134.53409 138.61649 147.31499 153.07768">r/m32, or r/m64</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-634.01978" x="158.7594 162.82829 166.08719 168.97078 174.49768 180.17758 185.52448 188.40807 193.85397 199.44388 204.79077 208.51317 213.90508 219.58498 225.22438 229.30318 233.97508 236.37178 241.07968 246.42657 249.31017 254.70207 258.23099 261.75989 265.58578 268.0347 273.6246 279.3045 282.8334 288.1803 291.0639 296.65381 302.0007 305.5296 310.93228 314.75818 323.49808 325.94699 331.62689 336.97379 341.64569 344.5293 348.0582 353.7381 359.14078 361.9191 366.59909 369.05521 373.73163 379.07401 381.89819 387.37201 390.55081 393.43439 396.99118 402.63327 408.00806 410.83224 414.38904 419.80884 423.66263 429.24261 434.6174 438.17419 440.99838 446.47217 452.05215 457.42694 461.08902 466.50882 472.21661 477.7966 480.68018 484.75897 490.46136 496.16376 499.46585 502.29004 507.99243 513.75513 516.57928 522.0531 525.90692 528.73108 534.46588 540.16827">). The operand-size attribute determines the size of the target operand (16, 32 or 64 </tspan><tspan y="-622.97949" x="46.019104 51.614403 54.068703 57.603004 62.280304 66.354607 69.618904 72.50251 81.391808 87.07711 92.429413 98.114716 100.93892 103.39322 109.07852 111.90273 117.66543 123.36783 127.44213 133.03743 135.49173 139.02603 141.90962 150.65492 156.10622 161.74562 167.08801 170.35231 173.2359 176.7702 182.45551 187.8078 190.63199 196.08328 201.72269 207.07498 210.73708 216.13437 221.81967 227.41498 230.29857 234.97588 237.43018 242.04628 247.44897 250.27316 253.42946 258.88077 262.71207 265.53629 271.22159 276.57388 281.97119 285.80249 288.6861 293.3634 298.76071 301.21503 303.59912 306.4827 310.56149 315.96329 321.65308 327.25287 330.07706 335.47885 337.93765 340.39645 343.22064 348.91043 354.26724 359.66904 363.50482 366.3884 371.98819 375.65027 381.05206 386.74185 391.42365 397.11343 402.47025 407.15204 411.23083 414.11441 416.57321 421.255 424.07919 427.23999 432.6958 436.53159 441.21338 446.57019 452.16998 455.05356 458.59235 464.04816 466.87234 472.63504 478.33743 482.41623 488.01602 490.47482 494.01361 498.6954 501.9642 504.78839 510.93719 516.53699 521.21881 526.67462 529.07135 534.77289 538.31171 543.71442">bits). When in 64-bit mode, the operand size for near call (and all near branches) is forced to 64-bits. Absolute </tspan><tspan y="-611.99951" x="46.019104 51.474007 54.633907 57.793808 62.474709 67.830612 71.430618 76.111519 78.755714 84.156616 87.991516 93.394218 96.038414 98.496315 103.95122 109.35212 114.95102 120.35372 125.93372 128.63733 134.23624 136.69414 140.52904 145.88493 150.56583 154.10373 156.56163 161.88153 164.52573 166.98363 172.67253 176.21043 181.66533 184.36893 187.90683 193.59573 198.99843 201.64262 207.32253 211.10342 216.52232 220.60022 226.84712 230.62802 236.04692 240.12482 242.82841 246.66331 252.01921 257.6181 260.07599 264.7569 268.2948 273.6507 276.23279 279.5007 282.14493 285.92584 289.08575 291.71912 295.2561 300.94409 306.2991 309.00269 314.4567 320.05469 325.4097 329.13211 334.5321 340.22009 345.81808 348.52167 353.20166 355.59836 360.31436 365.66937 368.37296 373.77295 377.30994 380.84692 384.68094 387.13794 392.73593 398.42392 401.96091 407.31592 410.0195 412.4765 417.15649 419.86008 425.57507 431.29007 434.55707 437.26065 440.79764 446.43973 451.79474 454.43893 460.12692 465.72491 471.32291 476.67792 480.51193 483.21552 486.7525 494.1055 499.55951 502.26309 507.86108 513.18005 516.71704 522.07202 526.75201 529.45563 534.90961 538.0686 540.71283 544.24982 549.93781 555.29279">offsets are loaded directly into the EIP(RIP) register. If the operand size attribute is 16, the upper two bytes of the </tspan><tspan y="-601.01953" x="46.019119 51.699921 55.541119 60.960918 63.785118 67.620918 73.023621 78.623421 81.082222 85.764023 89.302826 94.659622 98.495422 101.31962 106.72142 110.55722 115.95992 118.78411 123.46591 125.92471 131.28151 136.6833 140.5191 145.8759 151.47571 154.74451 157.62811 161.46391 166.82071 171.5025 177.19231 179.65111 183.18991 185.58661 191.28812 196.88791 199.71211 202.17091 207.86072 210.68492 216.08672 218.91092 227.66072 233.06252 238.38332 240.84212 249.59192 255.28172 264.03152 266.85571 269.31451 275.0043 279.6861 283.22488 287.06067 292.75046 297.43225 300.89911 303.35251 308.80292 314.44501 317.32861 322.923 328.37341 330.82681 336.5112 340.04459 345.396 349.22641 352.05063 356.72702 359.18042 363.89282 369.24423 372.12784 377.57825 380.73364 383.61725 389.32864 395.04004 397.92365 403.51804 405.97144 409.50482 414.18121 417.44461 420.32822 429.21661 434.901 440.25241 445.9368 448.76102 454.15741 458.8338 463.5741 468.9165 473.5929 478.26929 480.72269 486.36478 492.00418 494.8284 500.22479 505.90918 508.79279 514.18921 519.78363 524.46002 529.9104 532.36383 538.00592 541.53931 546.94196">EIP register are cleared, resulting in a maximum instruction pointer size of 16 bits. When accessing an absolute </tspan><tspan y="-589.97925" x="46.019104 51.474007 54.633907 57.793808 62.474709 67.830612 71.430618 74.254814 76.712715 82.401619 88.000519 90.45842 94.29332 99.649223 104.33012 107.86803 110.32593 115.64583 118.52943 124.21833 128.89923 131.29593 136.99744 142.59634 145.42055 148.95845 154.64735 160.00325 162.88686 167.56775 171.10565 176.50655 181.18744 186.50734 189.39095 194.98985 200.44475 202.90265 208.59155 212.12946 217.48535 221.32025 224.14445 228.22235 233.90225 240.05016 245.46906 249.54695 252.37115 257.77206 262.45297 265.33658 268.87448 274.56339 279.91928 282.7435 288.34241 293.74332 298.42422 303.71881 306.60239 310.4292 315.83191 321.4227 323.8725 328.54529 332.07507 337.42288 340.005 343.2648 346.14838 349.67816 355.35895 360.70676 363.53094 369.17035 374.57394 379.24673 384.59454 387.47812 392.58023 397.98383 400.43362 406.11441 411.46222 414.34579 420.02658 424.69937 430.10208 435.68207 438.50626 440.95605 445.62885 448.51242 452.04221 457.72299 463.0708 465.89499 471.05649 476.46008 478.90988 484.59067 489.93848 492.76266 498.20947 501.36127 504.18546 507.71524 513.39606 518.79871 521.62292 527.29474 533.43451 538.84534">offset indirectly using the stack pointer [ESP] as the base register, the base value used is the value of the ESP </tspan><tspan y="-578.99927" x="46.019104 51.616203 56.970303 60.128403 65.581505 69.414604 74.768707 77.652306 81.188408 86.875511 92.229614 95.05381 97.509911 103.19701 107.87611 111.41222 115.24532 120.93242 125.61152 129.14761 131.60371 137.05681 142.74391 145.6275 150.9816 156.2034 161.5575 166.2366 171.92371 175.45981 180.8139 185.49301">before the instruction executes.</tspan><tspan y="-562.97925" x="46.019104 52.142704 54.726604 58.565105 63.924606 66.386108 71.790611 75.332115 77.728821 83.010925 88.353325 90.876923 96.335426 99.498924 102.66242 107.34692 112.70642 116.24792 118.77152">A relative offset (</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-562.97925" x="122.81881 126.66361 132.02942 134.49722 140.22302">rel16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-562.97925" x="145.91911 148.44272 153.90392 157.74512"> or </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-562.97925" x="160.31911 164.14861 169.4991 171.9516 177.66209">rel32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-562.97925" x="183.3591 187.437 190.02089 192.41759 197.15788 199.68147 205.28038 210.63628 216.32518 221.72787 225.38997 230.79356 233.25146 235.64816 240.96806 243.49165 248.17255 253.77145 259.12735 263.80826 266.26614 269.42606 271.88394 277.23984 282.83875 285.36237 290.76328 295.44418 297.9678 303.36871 305.95264 308.41052 313.81143 319.41034 324.76624 327.22412 329.74774 332.20563 337.89453 340.41815 345.81906 350.49997 355.18088 360.53677 369.28568 374.88458 377.28128 382.6228 385.14642 389.82733 395.28223 400.88113 406.23703 409.50494 412.08887 418.25476 423.94366 427.48157 430.06549 435.4664 439.0043 441.52792 445.06583 450.75473 456.11063 458.63425 467.38315 472.78406 477.46497 483.15387 485.61176 491.30066 496.65656 499.18018 503.86108 509.31598 514.91486 520.31757 522.84119 525.29907 530.65497 535.87677 541.27948 543.67529 546.97736 549.50098 551.95886 555.49677">) is generally specified as a label in assembly code. But at the machine code level, it </tspan><tspan y="-551.99927" x="46.019104 48.471603 53.147102 55.8507 61.201202 66.884705 71.560204 77.009705 82.603203 88.005905 93.599403 96.363312 101.75881 106.43431 109.13792 114.53342 117.29733 121.97282 124.42532 130.01883 135.70233 141.05283 146.64633 149.94843 152.65202 158.41472 164.11711 168.18961 170.8932 176.3427 180.1722 182.9361 188.64659 194.35709 198.42958 204.06898 206.46568 209.99818 212.76208 215.21458 223.95808 232.70158 238.05208 243.69148 246.14758 251.54309 255.07559 260.42609 263.1297 268.2912 273.69479 276.14731 281.83081 287.1813 290.44382 293.20773 298.73822 304.42172 306.87424 311.54974 314.21909 319.3815 324.78601 327.23853 332.92203 338.27252 340.97702 343.42953 348.10504 350.86984 356.26535 361.85886 367.45236 372.85596 378.44946 381.15396 384.75485 390.15665 392.92145 396.45395 402.13745 407.48795 410.25275 415.35577 420.76028 423.2128 428.8963 434.2468 437.0116 439.46411 445.14761 447.91241 451.44492 457.12842 462.47891 465.18341 470.85791 474.63342 480.04694 484.11945 490.41763 494.19943 499.61295 503.68546 506.38995 510.21945 515.62305 521.21655 523.66907 528.34454 531.87701 537.22754 539.81055 543.07306 545.83783 549.61334 555.29681">is encoded as a signed, 16- or 32-bit immediate value. This value is added to the value in the EIP(RIP) register. In </tspan><tspan y="-541.01929" x="46.019104 51.742203 57.465302 61.5504 67.156502 69.553207 73.098305 75.981903 84.738007 90.200104 95.806206 101.1693 104.0529 107.598 113.2401 118.6032 121.42739 125.26949 130.6326 133.0977 138.5058 142.0509 144.51601 149.73781 155.1405 157.96471 163.4268 166.5939 169.761 174.4491 179.81219 183.3573 186.1815 188.64661 193.3347 196.15891 201.567 204.0321 211.2888 216.6321 221.9592 226.64729 229.4715 234.87959 237.7632 243.4863 249.2094 253.29449 258.9006 261.2973 264.84241 267.72601 270.1911 278.8941 287.65021 293.01331 298.61942 301.01611 306.42422 309.77939 315.1821 318.00629 323.16779 328.57138 331.02838 336.71637 342.11908 344.94327 352.29626 357.98425 360.38095 365.06094 370.74893 373.63251 376.02921 380.7092 383.59277 388.27277 390.72977 396.32776 402.01575 404.83994 410.24265 415.52475 419.06174 424.46445 430.15244 435.75043 441.10544 446.70343 449.58701 453.12399 458.578 461.40219 467.11719 472.87988 476.95688 482.55487 485.01187 488.54886 493.22885 496.05304 501.65103 507.00604 510.16504 515.61902 519.40082 524.80353 527.62775 530.08472 533.6217 536.44592 538.90289 543.58289">64-bit mode the relative offset is always a 32-bit immediate value which is sign extended to 64-bits before it is </tspan><tspan y="-529.979" x="46.019104 51.423603 57.026104 62.628605 67.988106 73.590607 75.994507 79.536011 84.994514 87.398415 90.939919 96.632416 101.99191 104.39581 109.55731 114.96091 117.42242 123.06451 128.42401 130.82791 133.22461 138.92612 141.33002 144.87152 150.56403 155.92352 158.32742 164.57793 168.36243 173.78493 176.18883 180.02733 185.38683 190.98932 193.45082 198.13531 201.67682 207.03632 210.87482 213.27872 216.44221 221.90071 225.73921 228.14311 231.68462 237.37712 242.73662 245.14052 248.68202 254.08652 257.92502 263.52753 268.88702 272.42853 274.83243 279.51694 284.92145 287.31815 292.05844 297.70053 300.15662 305.56113 308.99908 311.45517 316.90826 322.59537 325.86148 328.26538 334.41147 339.09058 341.49448 348.84659 351.30267 354.83878 360.52588 362.92978 368.32889 373.92599 378.6051 384.0582 386.51428 392.20139 395.73749 401.09158 403.49548 408.94858 412.10669 415.2648 419.94391 425.298 428.83411 433.51321 436.77933 439.18323 442.71933 448.40643 453.76053 456.16443 461.61752 467.21463 472.56873 476.23083 481.62994 487.31705 492.91415 496.99026 501.66937 504.12546 508.84055 514.19464 516.59851 521.99762 525.53369 529.06976 532.90289 535.35901 540.95612 546.64319 550.17926 555.53339">added to the value in the RIP register for the target calculation. As with absolute offsets, the operand-size attribute </tspan><tspan y="-518.99902" x="46.019104 51.614403 56.966702 60.501003 65.903702 69.735001 78.480301 80.934601 86.619904 91.972206 96.649506 99.173111 102.70741 108.39272 113.74502 116.26862 120.94592 123.40022 128.01633 133.41902 135.88321 141.3345 144.4908 147.01439 150.54869 156.23399 161.63669 164.10088 167.63518 173.09908 176.88087 182.52028 187.87257 191.40688 193.93047 199.38176 204.97707 210.32936 214.05176 219.44905 225.13435 230.72966 233.19385 237.26814 243.03084 248.74313 252.00743 254.47162 260.23434 265.93677 269.20108 271.7247 277.17599 281.00729 283.53091 289.24323 294.95554 297.35941 302.95651 305.4126 308.9487 313.62781 317.70392 320.97003 323.49365 327.27277 332.95987 335.48349 341.1976 346.91171 350.98782 356.58493 358.98071 362.51682 365.04044 373.78754 379.24063 384.83774 390.19183 392.71545 396.25156 401.93866 407.29276 409.81638 413.35248 418.75159 422.58469 428.18179 433.53589 437.13589 439.60013 445.05322 450.65033 456.05304 459.71515 465.11426 470.80136 476.39847 478.92209 486.2742 488.73029 491.18637 493.64246 496.10669 501.5058 503.96188 511.2186 516.56189 521.88 526.55908 529.02325 534.62036 539.97449 542.49805 548.21216 553.92627">determines the size of the target operand (16, 32, or 64 bits). In 64-bit mode the target operand will always be 64-</tspan><tspan y="-507.95871" x="46.019104 51.599102 54.055202 57.613804 62.293804 65.118004 70.737602 76.080002 80.760002 86.163605 91.873207 96.553207 101.89561 104.77921 108.33781 113.97992 119.35652 122.18073 127.65633 133.23633 138.61293 142.27504 147.69664 153.40623 158.98624 161.86984 166.54984 168.94655 173.62294 178.96535 181.84895 184.30505 188.98505 191.80925 194.98985 200.46545 204.32106 209.00105 214.34346 219.92346 222.80707 226.36566 231.84126 234.66547 240.40207 246.10448 250.18327 255.76328 258.21939 261.75909 266.43909 269.26328 272.44388 277.91946 281.77505 284.59924 290.30884 295.68542 301.10703 304.96262 307.7868 313.36679 317.08917 322.51077 328.15286 332.85446 338.49655 343.87314 348.55313">bits because the operand size is forced to 64-bits for near branches.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c1AE6E0A5"><tspan y="-491.99902" x="46.019104 51.495605 56.533806 60.012306 62.233505 68.709007 73.747208 76.226707 78.706207 83.687706 85.969208 88.448708 93.970207 96.191406 102.72991 107.71141 112.69291 115.17241 118.14691 124.62241 130.09891 135.62041 139.09891 144.08041 149.11862 154.09743 156.31863 161.84013 165.31863 167.60014 173.42044 175.94225 179.42075 182.39525 187.87175 192.90996 195.38947 198.36397 203.34547 208.38368 213.36519 218.34669 220.6282 228.10271 233.57921 239.10071 244.07951">Far Calls in Real-Address or Virtual-8086 Mode.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-491.99902" x="246.65881 249.5424 258.43262 264.1188 269.47202 275.1582 277.98242 283.38513 288.60693 293.96014 298.63834 304.32452 307.85971 310.25641 315.95789 321.59729 324.42151 329.8197 332.70331 335.8605 341.2587 345.09091 347.97452 352.65271 358.0509 360.5061 362.9028 365.78641 368.18311 373.88458 376.76819 380.6004 385.95361 391.35181 393.80701 397.8822 400.70642 406.10461 411.74402 417.34021 421.17242 426.52563 431.20383 435.88202 438.76562 444.21783 448.05005 450.93365 456.25085 458.64667 462.47888 466.01407 471.70026 477.09845 479.55365 483.62885 489.34204 495.05524 500.81793 506.53113 509.35535 518.10156 523.55377 529.14996 534.55267 537.81787 540.70148 544.23669 549.92291 555.27612"> When executing a far call in real- address or virtual-8086 mode, the </tspan><tspan y="-480.95871" x="46.019104 51.618904 55.454704 60.910503 65.5923 70.949097 75.630898 80.312698 85.768501 89.604301 92.4879 98.0877 103.7775 108.4593 114.14909 119.50589 124.18769 127.07129 130.61009 136.2522 141.65489 144.4791 149.16089 154.85069 158.68649 162.52229 167.87909 173.56889 177.1077 179.9319 185.0934 190.49699 192.9558 198.6456 204.0024 206.8266 212.28239 215.44319 218.2791 223.8708 229.31851 232.84921 238.53091 241.3551 244.8858 250.5675 255.9162 258.7998 265.0665 271.2504 274.07462 279.46832 285.15002 290.74173 293.62534 299.29803 303.13925 308.55096 311.37518 315.20288 320.60556 326.19727 328.64798 333.32169 336.85239 342.20108 346.02878 350.70248 353.5267 358.9744 364.6561 367.5397 371.0704 376.75211 382.1008 384.95911 389.6463 393.19049 398.59769 403.28488 408.61108 411.49469 414.66089 420.1221 423.96329 426.84689 432.48898 437.16898 442.53119 445.35541 450.7626 455.4498 458.3334 463.7406 466.56482 470.40601 475.76822 479.31241 485.0076 488.84879 494.54398 498.62817 501.09238 506.78757 511.47476 515.01898 518.86017 524.50226 529.24255 532.78674 535.18341 540.64459 546.33978">processor pushes the current value of both the CS and EIP registers on the stack for use as a return-instruction </tspan><tspan y="-469.9787" x="46.019104 51.618904 57.074703 59.533504 65.223305 68.762108 74.118912 76.701012 79.94281 82.826408 88.363205 94.053009 99.409805 102.234 107.8734 111.7155 117.1713 121.8531 127.2099 131.89169 136.57349 142.02928 145.86508 148.68927 152.22807 157.91788 163.27467 168.96448 171.84807 177.44788 182.80467 186.64047 189.80127 195.25706 199.09286 207.84267 212.52446 215.34865 220.75044 223.63403 227.75783 230.91862 236.32042 240.15622 243.03981 248.63962 252.30171 257.70352 263.39331 268.0751 273.76489 277.8887 280.71292 284.25171 289.70752 292.49939 296.04178 301.68387 307.04428 309.86847 314.55386 320.01328 325.61667 330.97708 333.80127 338.48666 343.84708 349.45047 358.20386 363.56427 369.25766 372.80005 375.62424 381.02963 386.72302 392.32642 395.20999 400.6694 403.8338 406.9982 411.68359 417.04401 420.5864 423.46997 428.15536 433.75876 439.11917 443.80457 446.20126 449.38547 451.84787 457.20828 462.81168 465.69525 473.05365 475.51605 479.05844 484.75183 487.57602 491.11841 496.8118 502.17221 504.9964 508.53879 513.94421 517.78363 523.38702 528.74744 532.28986">pointer. The processor then performs a “far branch” to the code segment and offset specified with the target </tspan><tspan y="-458.99869" x="46.019089 51.475788 57.076488 62.434189 66.156586 71.559288 77.201385 82.802086 85.086281 88.247978 93.704681 97.541382 99.884979 103.42468 109.11538 114.47308 116.81668 121.49938 126.90208 129.29878 131.75488 137.15758 142.73756 145.08116 150.68185 154.51855 159.97525 164.65794 170.01564 175.61633 181.30704 185.14374 190.50143 193.77113 196.11473 201.65244 207.34314 212.70084 215.04443 218.58414 223.98683 227.82353 233.42422 238.78192 242.32162 244.66522 250.12192 255.72263 261.12534 264.78745 270.19016 275.88086 281.48157 283.8252 288.5079 294.10861 299.51132 304.19135 306.58804 309.77225 312.23193 317.58963 322.27234 324.61597 330.01868 335.70938 337.99359 343.3963 348.99701 353.67972 359.13641 361.53311 367.23462 370.77432 376.17703 378.46124 381.62296 387.02567 390.86237 393.20599 398.6087 404.20941 409.81012 413.64682 419.04953 423.73224 428.41495 430.69916 436.10187 438.55795 442.09766 447.73975 453.14246 456.98456 459.2688 464.86951 467.2662 471.10291 476.50562 481.18832 484.72803 487.12473 492.46622 494.80981 502.16553 504.62521 508.16492 513.85559 516.19916 521.60187 523.88605 529.48676 534.94348 537.33929 543.04077 546.58044 551.98315 555.81982">operand for the called procedure. The target operand specifies an absolute far address either directly with a pointer </tspan><tspan y="-447.95837" x="46.019089">(</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-447.95837" x="50.098789 55.68959 59.219391 63.046192 68.75399 74.516693 78.595497 84.303299">ptr16:16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-447.95837" x="89.998489 92.882088 98.343292 102.18449"> or </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-447.95837" x="104.99879 110.59229 114.12479 117.95428 123.71699 129.42749 133.49998 139.21048">ptr16:32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-447.95837" x="144.89848 148.97908 151.86267 157.32027 161.15787 163.98206 166.44266 172.13426 177.73587 180.19647 184.03407 189.39267 194.07626 197.61687 200.07747 205.40007 208.22426 215.58086 217.97755 221.51816 227.20976 230.09335 235.49695 238.32114 247.07274 252.43134 261.18292 266.64053 270.47812 275.80072 278.68433 281.14493 286.60254 291.28613 296.68973 300.23032 302.62701 308.08463 313.77621 316.65982">) or indirectly with a memory location (</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-447.95837" x="320.69818 329.42368 335.18637 340.87888 344.93338 350.62589">m16:16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-447.95837" x="356.3382 359.2218 364.68301 368.5242"> or </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-447.95837" x="371.3385 380.09009 385.80869 391.52728 395.60788 401.32648">m16:32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-447.95837" x="407.03882 411.12302 414.39722 417.22141 426.12061 428.58481 432.129 437.82419 440.64838 444.19257 449.88776 455.24997 458.13354 463.73874 469.19995 471.66415 477.35934 480.90353 486.26575 490.10693 492.93112 501.68631 507.04852 510.59271 516.2879 521.74908 527.35431 530.62848 533.4527 536.99689 542.69208 548.05426">). With the pointer method, the </tspan><tspan y="-436.97836" x="46.019104 50.696404 56.048702 61.644005 70.389305 75.741608 81.42691 84.961212 87.785416 93.182716 98.868019 104.50742 107.33162 112.78292 115.93922 119.09553 123.77283 129.12512 132.65942 135.54301 140.99431 144.1506 146.97479 150.50909 156.1944 161.54669 164.43028 169.10759 174.50488 176.90158 179.35768 184.70998 190.34938 193.17357 198.76888 202.60017 208.05147 212.72878 218.08107 223.67911 229.32121 233.16331 238.56601 241.39021 243.85262 248.53801 251.36221 256.72263 262.41602 267.10141 272.56082 278.16422 283.52463 289.12802 291.95221 294.41461 300.0567 302.94028 306.48267 312.12476 317.52747 320.35165 322.74835 328.44983 333.13522 336.67761 340.517 346.21039 350.89578 354.43817 356.90057 362.35999 368.05338 370.87756 376.57095 381.25635 383.65305 389.27911 394.91852 397.74274 403.13824 405.96246 411.67297 415.74548 421.33899 426.6535 430.186 435.5365 438.36072 442.43323 448.14374 453.90643 457.98523 463.57874 466.03125 469.56375 472.38797 477.83746 483.43097 488.78146 492.50388 497.89938 503.58289 509.17639 512.00055 516.67603 519.12854 523.84003 529.19055 533.26306 536.08722 541.53674 545.36627 548.19043 553.90094">segment and offset of the called procedure is encoded in the instruction using a 4-byte (16-bit operand size) or 6-</tspan><tspan y="-425.99835" x="46.019104 51.612602 56.927101 60.527103 65.869499 68.093399 72.165901 77.876404 83.639107 87.717911 93.311409 95.763908 99.29641 101.52031 106.96981 112.60921 117.95971 121.62181 127.01731 132.70081 138.29431 140.57851 145.25401 147.70651 152.41801 157.76851 161.841 164.1252 167.27969 172.6752 176.5047 178.72859 184.12408 189.71759 195.35699 199.1991 204.54959 209.2251 213.9006 216.1245 218.577 227.3205 236.064 241.41449 247.008 249.46049 254.85599 258.38849 263.73898 267.04111 269.26501 278.15253 280.60504 284.13754 289.82104 292.04495 295.57745 301.19879 306.57269 308.79657 311.25266 316.95416 322.53418 324.99026 328.84317 334.18558 338.8656 342.4053 344.62918 353.39609 358.73849 362.2944 368.00131 373.47421 379.05423 382.34012 384.564 388.1199 393.82681 399.20071 401.42459 404.9805 410.39941 414.25232 419.83234 425.20624 428.76215 430.98602 436.45892 442.03894 447.41284 451.07495 456.49387 462.20078 467.78079 470.00467 474.68469 480.3241 485.6665 490.34653 492.80261 495.98679 498.38257 503.78528 508.4653 510.68918 516.10809 518.33203 527.09894 532.47284 541.17584 546.63617 550.48907 555.82697">byte (32-bit operand size) far address immediate. With the indirect method, the target operand specifies a memory </tspan><tspan y="-414.95804" x="46.019089 48.47879 53.879688 58.619987 64.02359 67.563293 69.959991 75.416695 81.107391 83.691292 87.230995 92.873093 98.275795 101.8155 104.3994 109.0821 114.5388 120.2295 123.7692 129.17191 131.63161 137.27371 141.9537 144.5376 149.94029 152.52419 158.24188 162.32158 167.92227 173.24397 176.78368 182.14137 184.66496 188.74466 194.46236 200.18005 204.25975 209.86044 212.32014 215.85985 218.44374 223.84464 229.48404 234.84174 238.50383 243.90652 249.59723 255.19794 257.72156 262.40427 264.86395 269.58264 274.94034 279.02005 281.54367 287.00037 290.83707 293.33908 299.04779 303.1185 308.71021 314.02292 317.55362 322.90231 325.48624 329.55695 335.26566 340.97437 345.04507 350.68448 353.08121 356.61191 359.19583 364.64352 370.23523 375.58392 379.30634 384.70004 390.38174 396.02115 398.54477 403.21848 405.66919 410.37888 415.72757 419.79828 422.3822 425.53491 430.92862 434.75632 437.34024 442.73395 448.32565 453.96506 457.80716 463.15585 467.82956 472.50327 475.76398 478.3479 483.87659 489.55829 494.90698 497.49091 502.9386 508.5303 513.87903 517.60144 522.99512 528.67682 534.26849 538.33917 543.01288 545.46356 550.07965 555.48236">location that contains a 4-byte (16-bit operand size) or 6-byte (32-bit operand size) far address. The operand-size </tspan><tspan y="-403.97803" x="46.019089 51.414589 54.94709 58.479591 62.30909 64.761589 70.355087 76.038589 79.571091 84.921593 87.685493 93.278992 98.629494 102.16199 107.5647 111.3942 120.1377 122.59019 128.2737 133.62419 138.2997 141.0636 144.5961 150.2796 155.6301 158.394 163.0695 165.522 170.23351 175.584 178.3479 183.79739 186.95189 189.71579 193.24829 198.93179 204.28229 207.04619 212.49568 215.65018 218.80467 223.48018 228.88287 232.42258 235.12617 239.19867 244.96136 250.67186 253.43576 258.88525 262.71475 265.47867 271.18918 276.89969 279.6636 285.25711 287.70963 291.24213 295.91763 299.99014 302.75406 305.20657 310.79907 313.56299 317.09729 322.78259 328.13489 330.8988 334.05511 339.45242 343.28372 346.04764 351.44495 357.04025 362.63556 366.46686 371.81915 376.55945 381.23676 384.50107 387.26498 392.79727 398.48257 403.83487 406.59879 409.7551 415.1524 418.9837 421.74762 427.14493 432.74023 438.33554 442.16684 447.51913 452.25943 456.93674 459.64035 462.09467 466.77197 469.53589 471.9902 477.4415 482.83881 488.43411 493.78641 499.42581 502.12943 507.76883 510.16556 513.99689 519.3996 524.0769 527.61121 530.00702 535.34851 538.11243 540.56671 546.25201 549.85199 555.25287">attribute determines the size of the offset (16 or 32 bits) in the far address. The far address is loaded directly into </tspan><tspan y="-392.99802" x="46.019073 49.553375 55.238674 60.590973 63.415173 69.685471 75.829773 78.713379 84.11068 89.795982 95.391281 98.215485 103.89178 107.66908 113.12848 115.95268 119.78398 125.13628 130.77568 133.17238 137.84969 141.38399 146.78668 150.62878 155.30609 158.57039 161.45398 165.23128 168.38757 171.27116 174.80547 180.49077 185.84306 188.66725 194.11855 199.75795 205.11024 208.77234 214.16963 219.85493 225.45024 229.52454 234.20184 236.65614 241.36945 246.72174 249.60533 255.00262 258.53693 262.07123 265.90253 268.29926 273.93866 279.62396 283.15826 288.51056 291.33478 293.78909 298.43936 301.32297 307.03348 312.74399 316.04611 318.87033 322.40283 328.08633 333.43683 336.32043 342.00394 347.59744 353.19095 358.54144 362.37094 365.25455 368.78705 376.13556 381.58505 384.46866 390.06216 395.37668 398.90918 404.25967 408.93518 411.7594 417.20889 420.3634 423.18762 426.72012 432.40363 437.8063 440.63052 446.30502 450.08054 455.49405 458.37766 462.20715 467.60983 473.20334 475.65585 480.33136 483.86386 489.21436 493.04385 495.92746 501.32297 505.15247 510.50296 513.32721 518.00269 520.4552 525.80573 531.20123 535.03076 540.43347 546.02698">the CS and EIP registers. If the operand-size attribute is 16, the upper two bytes of the EIP register are cleared.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c1AE6E0A5"><tspan y="-376.97803" x="46.019073 51.493774 56.531975 60.008675 61.930176 68.403877 73.383575 75.861275 78.338974 83.377174 85.238373 87.716072 93.190773 95.112274 101.09097 104.56767 110.08917 113.08887 118.06857 123.04827 126.02097 131.00067 136.52217 138.44368 145.91638 151.43788 156.91258 161.95079">Far Calls in Protected Mode.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-376.97803" x="164.45908 166.86298 175.77568 181.41777 186.79347 192.43556 194.89977 198.45746 204.09955 209.47525 211.87915 217.45915 221.30125 226.77596 231.45595 236.79836 241.47835 246.15834 251.61864 255.47334 257.87726 260.33334 265.01337 267.41727 272.89197 278.47198 283.84769 287.5098 292.93048 296.48819 298.94427 304.64578 310.2258 312.6297 315.08578 320.78729 323.19119 328.77121 332.61331 338.08801 341.64572 346.98813 351.66815 355.22586 360.47906 366.08246 368.48636 377.23975 382.69916 388.30255 393.66296 396.93536 399.33926 402.88165 408.57504 413.93546 416.33936 422.61777 428.77017 433.77957 438.78897 441.19287 443.65527 449.34866 454.03406 457.57645 461.41583 467.05792 471.74332 475.28571 477.74811 483.20752 488.90091 491.30481 495.9902 501.3956 507.08899 509.49289 515.09631 520.49902 522.90295 528.54419 533.28448 538.6449 544.24829 546.65222 550.19464 555.65405"> When the processor is operating in protected mode, the CALL instruction can be used to </tspan><tspan y="-365.99802" x="46.019073 51.616173 56.970272 60.803371 63.961472 69.414574 73.247673 81.994774 84.818977 88.35508 94.042183 99.396286 102.27988 105.43799 110.89109 113.34719 115.80329 121.25639 128.60849 131.06459 136.75169 142.3488 145.23239 148.71179 154.0533 159.65041 165.0045 169.68359 172.56718 178.02028 181.17838 184.06197 187.22006 192.61916 196.45226 199.27644 203.95554 209.35463 211.81073 214.26683 218.94592">perform the following types of far calls:</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-351" x="46.02">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-351" x="63 67.743004 73.146606 76.979706 79.803902 84.483002 89.882103 92.338203 94.794304 97.618507 101.15461 106.60771 109.49131 113.02741 118.71452 124.06862 126.89281 131.57191 136.97101 145.71811 151.0722 153.95581 159.55292 163.38602 165.84212 171.16022 173.55692 176.01302 181.36711 186.96422 192.31831 195.14252 197.59862 202.95271 208.27081 213.62491">Far call to the same privilege level</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-336" x="46.02">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-336" x="63 67.743004 73.146606 76.981506 79.805702 84.486603 89.887505 92.345406 94.803307 97.627502 101.16541 106.62031 109.50391 114.90481 117.729 123.3279 125.7246 128.88451 132.0444 137.4003 141.2352 146.59109 152.28 155.8179 158.70151 164.30042 168.13531 170.59322 175.91312 178.37102 180.82892 186.18481 191.78372 197.18642 200.01062 202.46852 207.82442 213.04622 218.44891 220.90681 223.73102 227.80891 230.26682 235.95572 239.49362 244.84952 248.57191 252.64981 258.24872 262.08362 264.48032 269.80023 272.25812 274.716 280.0719 285.67081 291.0267 293.91031 296.36819 301.72409 306.94589 312.2883 314.74619 317.62979 322.3107 327.71161 330.16949 332.56619">Far call to a different privilege level (inter-privilege level call)</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-321" x="46.02">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-321" x="63 67.498207 72.90181 77.583611 82.904411 85.728607 90.410408 97.765205 100.1619 103.70161 108.38341 114.07321 116.95681 121.03561 124.19641 129.66031 133.44211 136.3257 141.00749 146.40929 148.86809 151.26479 154.14838 157.68718 163.14297 165.96716 171.36896 177.05876 182.51456 186.05336 191.74316 197.09996 200.93576 203.81935 207.35815 212.75995 217.44174 222.76254">Task switch (far call to another task)</tspan><tspan y="-304.98001" x="46.019699 49.802399 55.493099 58.317299 63.917999 67.7547 73.211403 76.751106 82.153809 86.833809 90.373512 95.731216 101.33192 104.21552 112.96622 118.36712 123.96782 129.32552 132.59521 135.41942 138.95912 144.64983 150.00752 152.89113 158.49182 162.32852 167.78522 172.46791 177.82561 182.5083 187.19099 192.64769 196.48439 199.368 204.77069 207.16739 214.42409 219.76738 225.08908 229.77177 232.59598 238.28668 242.96938 248.37207 253.05206 255.87628 259.41599 265.10669 270.46439 273.34799 278.0307 283.3884 288.98911 297.73981 303.0975 308.78821 312.32791 315.21152 319.89423 325.25192 327.71161 333.06931 337.75201 341.29172 346.74841 350.58511 353.40933 359.01004 364.41275 368.24945 371.78915 374.61337 380.07007 383.23178 386.056 389.5957 395.28641 400.6441 403.52771 406.68942 412.09213 415.92883 418.75305 424.15576 429.75647 435.35718 439.19388 444.55157 449.23428 453.91699 456.74121 460.28091 465.73761 468.62122 474.02393 478.70663 483.38934 488.74704 493.42975 498.11246 500.99606 504.53577 510.22647 515.58417 518.40833 523.091 528.54773 532.3844 536.22107 541.62378">In protected mode, the processor always uses the segment selector part of the far address to access the corre-</tspan><tspan y="-294" x="46.019699 50.7006 56.2995 61.754402 67.443306 73.042206 75.500107 81.189011 86.78791 89.252106 94.851006 100.20691 104.88781 109.56871 113.40361 115.86151 121.46041 124.99831 130.45322 134.28812 136.75232 139.21022 144.89912 147.36333 150.90123 156.59013 161.94603 164.41023 171.37714 178.10194 183.63785 186.10205 191.55695 195.39185 197.85605 202.86095 209.58574 213.84364 217.08545 219.54965 225.08556 230.77446 236.13036 238.59456 244.19347 249.59616 254.27707 258.95798 262.79288 265.18958 270.82898 274.36688 279.82178 283.65668 286.12088 289.60028 294.94177 300.54068 305.87939 308.3436 312.41791 317.09521 322.54651 328.14182 333.49411 335.95831 340.63562 345.98792 351.58322 360.32852 365.73123 371.43274 374.96704 378.23135 380.69556 385.37286 390.77017 393.22449 395.6788 398.14301 403.73831 409.13562 412.66992 418.07263 421.33694 423.80115 427.33545 432.73276 437.41006 442.72638 445.19058 450.78589 456.1832 459.7175 465.06979 468.33411 470.8577 476.25858 480.10068 482.62427 488.08276 494.14606 500.29034 504.36465 506.82886 512.22614 517.91144 523.50671 526.03033 531.42761 536.10492 540.78223 546.13452 550.81183 555.48914">sponding descriptor in the GDT or LDT. The descriptor type (code segment, call gate, task gate, or TSS) and access </tspan><tspan y="-282.95969" x="46.019684 49.859085 52.255783 57.859184 63.552586 67.094986 71.780388 74.604584 80.207985 85.568382 89.110779 94.471176 98.310577 107.06398 109.52638 115.16848 120.52888 123.35307 126.89547 132.58887 137.94926 140.83286 144.31226 149.65376 155.25716 160.61755 163.50114 168.96054 172.12494 175.00853 179.69392 185.09932 187.56172 189.95842 192.84201 198.30141 203.9048 209.2652 212.98759 218.39299 221.93539 224.33209 229.79239 235.48579 238.36938 241.91179 247.37119 250.19537 255.79877 261.15918 263.9834 269.58679 274.9472 278.78659 281.95099 287.4104 291.24979 300.00317 305.36359 310.96698">rights determine the type of call operation to be performed.</tspan><tspan y="-267" x="46.019684 49.801483 52.962284 55.786484 59.325283 65.015083 70.371887 73.255486 77.937286 83.294083 85.752884 91.10968 95.791481 99.330284 104.68709 110.28689 113.11108 118.71088 124.11359 128.79538 133.47717 137.31297 139.70967 145.34908 148.88788 154.34367 158.17947 161.00368 163.46248 168.14427 170.96848 174.12927 179.58507 183.42087 186.24507 191.70897 194.53317 199.21497 204.67076 210.27057 215.67326 218.49747 223.17926 228.53606 234.13586 242.88567 248.28836 253.93047 257.53046 260.77225 263.59644 269.06033 271.88452 275.04532 280.44711 284.2829 287.03967 291.71426 297.10886 299.56046 302.01205 304.83624 308.36783 313.81644 316.70001 322.0946 324.91879 329.59338 335.04199 340.63458 346.03729 348.86148 353.53607 358.88568 364.47827 373.22089 378.6236 384.32507 387.85666 390.68085 396.07544 399.60703 402.4906 406.02219 411.70477 417.10748 419.93167 424.60626 430.00085 438.74347 444.09308 446.97665 452.56924 456.39786 458.84946 464.16306 466.61465 469.06625 474.41586 480.00845 485.41116 488.23535 490.68695 496.03656 501.35016 506.69977 509.15137 511.97559 514.42719 519.10181">If the selected descriptor is for a code segment, a far call to a code segment at the same privilege level is </tspan><tspan y="-255.9597" x="46.019669 51.617668 56.972668 60.806667 63.965668 69.41967 73.25367 82.001671 87.356674 92.954674 96.256775 98.840668 102.91767 106.69767 109.85667 112.44057 115.97757 121.66557 127.02058 129.66478 134.34479 139.69978 142.15678 147.51178 152.19177 155.72878 161.08377 166.72318 169.30707 173.98706 179.44106 185.03906 190.39406 193.03825 197.71826 203.07326 208.67126 217.41927 222.77426 228.46227 231.99927 234.58316 237.04016 241.72015 244.36435 249.76434 253.30135 255.88525 261.28525 263.86914 269.46713 271.92413 275.08313 278.24213 283.59714 287.43115 292.78616 298.47415 301.91937 304.50327 310.10306 313.93884 316.33554 321.67703 324.13583 326.59464 331.95145 337.55124 342.90805 345.55225 347.94894 353.35165 358.57346 363.91586 366.37466 368.95856 374.36035 380.05014 385.64993 388.29413 391.83292 397.52271 402.87952 405.46341 410.1452 415.60101 421.20081 426.60352 429.18741 433.8692 439.22601 444.82581 453.57559 458.9783 464.62039 468.15918 470.80338 473.26218 477.94397 480.52786 486.21765 491.67346 497.36325 501.44205 506.12384 511.57965 517.26947 520.4303 525.88611 529.72192 538.47174 540.86847 546.55829 552.15808 555.42688">performed. (If the selected code segment is at a different privilege level and the code segment is non-conforming, </tspan><tspan y="-244.97971" x="46.019669 51.41787 53.82177 59.417969 64.771172 70.457375 75.810577 79.472679 84.876282 87.331482 91.406685 97.002884 100.83508 106.28728 109.82249 115.22519 119.90519 123.44039 125.83709 131.28929 136.97549 139.4397 144.79289 150.01469 154.6929 160.0956 165.6918 169.22701 171.68221 177.1344 182.8206 185.28481 187.74001 192.41821 194.82211 200.41832 205.77151 211.45772 216.81091 220.47301 225.8766 229.4118 234.8145 240.41071 243.6759 247.7511 250.2153 256.3605 258.82471 261.9819 267.3801 271.21231 273.61621 278.2944 283.6926 286.1478 288.603 291.0069 294.54208 299.99429 302.4585 305.99368 311.67987 317.03308 319.49728 324.17548 329.57367 338.31989 343.7226 346.1265 351.72269 355.5549 357.9516 363.29309 365.74829 368.14499 373.5477 379.12769 384.4809 386.9451 389.4003 394.75351 399.97531 405.37802 407.77472 410.23892 412.69412 418.38031 420.84451 426.4407 430.27292 435.72513 439.26031 444.61353 449.29172 452.89169 458.2341 463.83029 466.29449 475.04071 480.49292 486.08911 491.44232 493.90652 496.30322 500.98322 503.44742 508.66922 514.0116 517.84381 523.16101 525.62524 530.30347 532.69928 541.4455 543.9007 546.3559 551.75409 555.5863">a general-protection exception is generated.) A far call to the same privilege level in protected mode is very similar </tspan><tspan y="-233.99971" x="46.019669 49.567471 55.032272 57.316471 62.717373 68.418877 73.784676 76.008575 80.699379 86.110176 89.954979 93.799782 96.267578 101.63338 107.24218 109.52638 114.92728 120.62878 124.17657 126.46078 128.92857 134.62738 136.85127 140.69608 146.06187 151.47267 153.86937 157.88876 163.29236 168.90115 174.50995 178.35475 183.72055 188.41135 193.10214 195.38634 200.85114 204.69594 206.91983 212.24963 214.61937 218.44527 221.97417 227.65407 233.04597 235.44267 239.52147 245.28416 250.99106 256.69797 262.46066 264.68457 273.42447 278.87036 284.46027 289.86295 293.12186 295.40607 300.93295 306.61285 311.95975 314.24396 317.77286 323.16476 326.99066 332.58057 337.98325 341.52295 343.80716 349.25305 354.89246 360.23935 363.90146 369.29337 374.97327 380.61267 382.83658 387.50848 393.14789 398.49478 403.1991 405.6615 408.8259 411.2226 416.62531 421.3107 423.53461 428.94 434.63339 436.9176 442.323 447.92639 452.61179 458.0712 460.5336 466.22699 469.76938 475.12979 477.414 480.5784 485.9838 489.82318 492.10739 497.51279 503.11618 508.71957 512.55896 517.91937 522.6048 527.34509 529.56903 534.92944 537.32526 540.86768 546.5611 551.92151 555.76093">to one carried out in real-address or virtual-8086 mode. The target operand specifies an absolute far address either </tspan><tspan y="-222.95941" x="46.018799 51.616798 54.073799 57.907799 63.262798 67.942795 71.479797 73.936798 79.255798 82.079994 89.432991 91.889992 95.426994 101.115 103.9986 109.39861 112.2228 117.8208 123.2748 125.7318 131.4198 134.9568 140.3118 144.1458 147.0294">directly with a pointer (</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-222.95941" x="151.07849 156.6711 160.2027 164.0313 169.74089 175.45049 179.52208 185.28477">ptr16:16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-222.95941" x="190.9782 193.8024 199.2636 203.1048"> or </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-222.95941" x="205.9785 211.56931 215.09911 218.9259 224.6337 230.39639 234.47519 240.18298">ptr16:32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-222.95941" x="245.8782 249.9543 252.83789 258.29099 262.12408 264.9483 267.40439 273.09149 278.6886 281.14468 284.97778 290.33188 295.01099 298.54709 301.00317 306.32129 309.2049 316.55701 319.01309 322.54919 328.2363 331.06052 336.45963 339.34323 348.09033 353.44443 362.19153 367.64462 371.47772 376.79584 379.67944 382.07614 387.53644 392.21555 397.61465 401.15076 403.60684 409.05994 414.74704 417.57126">) or indirectly with a memory location (</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-222.95941" x="421.6185 430.37009 436.08868 441.80728 445.88788 451.60648">m16:16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-222.95941" x="457.31879 460.20239 465.6636 469.50479"> or </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-222.95941" x="472.31909 481.06348 486.77487 492.48627 496.55966 502.32236">m16:32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-222.95941" x="508.01941 512.0874 515.3454 518.229 523.755 529.43402 534.78003">). The </tspan><tspan y="-211.97942" x="46.019684 51.467384 57.059086 62.407787 66.130188 71.523888 77.205589 82.844986 86.92379 89.687691 94.427986 96.824684 101.53439 106.88309 109.70729 115.10099 118.63169 122.16239 125.99009 128.4408 134.0325 139.7142 143.2449 148.5936 151.41779 157.00949 162.41219 165.94289 171.29158 175.11928 183.86098 186.25768 191.95918 197.30788 201.98158 204.80577 208.33647 214.01817 219.36687 222.19106 226.86476 229.31546 234.02516 239.37386 242.19804 247.64575 250.79845 253.62263 257.15332 262.83502 268.18372 271.00793 276.45563 279.60834 282.76105 287.43475 292.83743 296.37714 299.09967 303.17667 308.93936 314.65436 317.47855 322.93256 326.71439 329.53857 335.25357 341.01627 343.78015 349.37814 351.83514 355.37213 360.05212 364.12912 366.89301 369.35001 375.03799 377.86218 381.39917 387.04126 392.44397 395.26816 398.42715 403.82715 407.66116 410.48535 415.88535 421.48334 427.08133 430.91534 436.27036 440.95035 445.63034 448.89734 451.72153 457.25653 462.94452 468.34723 471.11111 476.7991 482.15411 489.50711 492.3313 497.01129 502.4653 508.06329 513.41827 516.24249 520.92249 526.27747 531.87549 540.62347 546.02618 551.66827 555.26825">operand- size attribute determines the size of the offset (16 or 32 bits) in the far address. The new code segment </tspan><tspan y="-200.99942" x="46.019669 50.700569 56.056469 58.51437 63.87027 68.55117 72.089073 77.543976 81.378876 83.782776 89.183678 94.872581 100.47148 102.87538 105.33328 108.87119 113.55209 115.89568 121.49458 126.85049 131.53139 136.21228 140.04718 142.50508 148.10399 151.64189 157.09679 160.93169 163.33559 168.73648 172.57138 177.92728 180.33118 182.78908 188.24397 193.64487 199.24377 204.59967 210.19858 212.54218 215.00008 220.68898 224.22688 229.68178 232.08568 238.35957 244.50748 246.91138 250.74628 256.10217 261.70108 264.15897 268.83987 272.37778 277.73367 281.56857 285.64648 288.05038 291.58829 297.27719 302.63309 305.03699 310.49188 313.61938 316.77838 321.45837 326.86108 330.40076 332.80466 335.96365 339.79767 345.25168 353.99966 356.40356 359.94055 365.62854 370.98355 373.38745 375.78415 381.48563 386.16562 389.70261 393.53662 399.22461 403.9046 407.44159 409.89859 415.3526 421.04059 423.38419 425.84119 430.52118 432.92508 435.38208 440.83609 446.23608 451.83408 457.18909 462.78708 465.13068 467.58768 473.27567 476.81265 482.26666 484.67056 488.20755 493.89554 499.25055 501.65445 507.33344 511.11343 516.53143 518.9353 522.76929 528.12427 533.72229 536.17926 540.85925 544.39624 549.75122 552.33331 555.60034">selector and its descriptor are loaded into CS register; the offset from the instruction is loaded into the EIP register. </tspan><tspan y="-184.97942" x="46.019684 52.163086 54.866684 59.543083 64.939484 67.392883 69.846283 72.549889 78.144287 83.540688 87.074089 92.476791 95.180397 99.253799 104.8482 110.1996 114.876 119.5524 123.3828 125.8362 131.4306 136.8333 142.4133 145.1169 147.5703 153.2547 155.9583 159.4917 165.1761 170.5275 173.23109 178.9155 184.26689 189.58229 193.11569 195.81929 201.4137 206.81009 210.53249 215.93608 221.53049 225.19258 230.58897 236.18338 241.86778 245.94118 248.64478 253.38509 258.7887 264.47308 267.17667 272.57306 275.02646 279.70285 285.15326 287.85684 293.45123 298.80264 301.5 307.19159 311.87518 317.2338 322.83539 325.59927 329.13986 334.59747 337.30106 342.90265 348.26126 352.09885 355.26144 360.71906 364.55664 373.30823 376.01181 381.41541 384.11899 387.28159 392.74548 396.52728 399.29117 403.97476 409.37836 411.77505 414.23117 416.93475 420.47534 425.93295 428.63654 434.04013 436.74371 441.42731 446.88492 452.48651 457.84512 460.54871 465.2323 470.59091 476.1925 484.89548 490.25409 495.94568 499.48627 502.18985 507.59344 511.13403 513.83765 517.37823 523.06982 528.42841 531.13202 535.81561 541.21924 549.97083 555.32941">A call gate (described in the next paragraph) can also be used to perform a far call to a code segment at the same </tspan><tspan y="-173.99942" x="46.019699 51.614998 55.446297 57.900597 63.216896 65.671196 68.125496 73.477798 79.073097 84.4254 87.249603 89.703903 95.056206 100.27801 105.68071 108.07741 111.37951 114.20371 120.78001 125.45731 127.85401 133.55551 139.15082 141.97501 145.57501 151.21712 153.67142 158.34872 161.17291 169.91821 175.27051 179.94781 185.63312 191.03041 196.71571 199.17001 203.84732 212.59262 215.47621 221.07152 224.90282 230.30371 235.58582 238.04012 243.63542 249.03812 253.71812 256.54233 261.93964 267.62494 270.44916 275.80145 281.11777 284.65207 288.31418 293.71149 296.53571 298.99002 304.3197 309.5415 314.94421 317.34091 320.1651 325.62091 328.78171 331.6059 334.0647 339.75449 345.35428 347.81308 351.64886 357.00568 361.68747 365.22626 367.68506 373.14087 378.83066 381.65485 387.05664 392.74643 398.34622 401.17041 403.62921 408.311 411.13519 414.67398 420.36377 425.72058 428.54477 434.14456 437.98035 443.33716 446.49796 451.85477 455.69055 459.52634 464.92905 470.52884 473.35303 482.10281 487.45963 490.99841 496.6882 502.14401 507.7438 510.56799 516.0238 519.18463 522.00885 530.75867 536.16046 541.48126 543.94006 549.62988 555.22968">privilege level. Using this mechanism provides an extra level of indirection and is the preferred method of making </tspan><tspan y="-162.95912" x="46.019684 50.692482 56.085281 58.53508 60.984879 65.657677 68.541275 74.132072 79.479874 83.009674 90.355476 95.703278 101.10598 106.78678 109.67038 115.37818 121.08598 125.15578 130.79518 133.19188 136.72168 139.60527 144.99808 150.67888 156.26968 159.15327 164.86107 170.56886 174.63866 180.22946 182.67926 186.20906 189.09265 193.76546 199.21225 204.80305 210.15085 213.03444 217.70724 223.05504 228.64584 237.38664 242.73444 248.41524 251.94504 256.61783">calls between 16-bit and 32-bit code segments.</tspan><tspan y="-146.99942" x="46.019684 54.912582 60.601482 65.957382 71.646286 74.050186 79.40609 84.627892 90.030594 94.710594 100.3527 103.8924 106.3503 112.03921 117.63811 120.10231 125.50321 131.14531 133.60951 136.00621 141.70772 145.24562 150.60152 154.38332 158.46211 164.06102 167.89592 170.35382 175.67372 178.07042 180.52652 185.88242 191.48132 196.83722 200.91512 203.37302 208.72891 213.95071 219.35341 221.75011 224.21431 227.37421 232.7751 236.61 239.0742 243.7551 249.15599 251.55269 254.00879 257.2767 259.6806 263.21851 268.90741 274.26331 276.66721 281.34811 286.80301 292.40192 297.75781 300.16171 304.84262 310.19852 315.79742 324.54633 329.94904 335.65054 339.18845 341.59235 344.75226 350.15317 353.98807 356.45227 359.99017 365.63226 371.03497 373.43887 379.03778 382.87268 388.32758 393.00848 398.41119 403.99121 409.68011 413.51501 418.87091 421.27481 426.87372 432.27643 434.67313 440.37463 445.97354 448.37744 453.05835 458.45926 460.91714 463.31384 468.71655 474.29657 476.70047 485.44937 491.13828 495.81918 499.35709 501.76099 507.35989 512.76263 515.16656 520.56744 525.24835 529.92926 535.28516 539.96606 544.64697 550.04968 555.64856">When executing an inter-privilege-level far call, the code segment for the procedure being called must be accessed </tspan><tspan y="-135.95912" x="46.019684 49.556683 55.244682 59.078682 64.532684 70.174789 75.814186 81.456291 84.339897 89.739899 92.564095 97.244095 102.6441 105.1011 107.5581 110.3823 115.9803 121.3803 124.9173 130.27231 133.53931 136.36349 141.8985 147.5865 152.9415 155.82509 160.5051 165.86009 171.4581 180.2061 185.6088 191.2509 194.7879 197.67149 202.3515 207.7065 210.1635 215.51849 220.19849 223.73549 229.18948 233.02348 235.90707 240.58707 246.18507 251.54007 256.22006 258.67706 261.83606 264.29306 269.64807 275.24606 278.12967 283.72766 289.04666 291.93027 295.46725 301.07968 306.43109 309.25528 312.78867 318.18506 322.01547 327.65488 333.00629 336.53967 339.36386 344.81427 350.45367 355.80508 359.46719 364.86359 370.54797 376.14236 379.02594 381.47934 387.07373 392.42514 398.10953 401.64291 404.09631 407.25171 409.70511 415.10782 419.78781 422.612 426.14539 431.82977 437.18118 440.06476 444.74115 450.13754 452.53424 454.99033 457.8739 463.46829 468.86469 472.39807 477.74948 481.05157 483.87576 489.45398 495.09607 500.49878 503.32297 506.85635 512.25275 516.08313 521.67755 527.0802 530.61987">through a call gate. The segment selector specified by the target operand identifies the call gate. The target </tspan><tspan y="-124.97912" x="46.019684 51.476383 57.077084 62.434784 66.157181 71.559883 77.201981 82.802681 85.026573 89.709274 95.111977 100.80267 103.08687 107.76957 113.37027 118.77296 123.45296 125.84966 128.97357 134.29527 136.57947 140.11917 145.76128 151.16397 153.38786 158.07056 163.47325 165.93295 168.39265 170.67685 176.27756 181.68025 185.21996 190.57765 192.86185 197.54454 202.90224 208.50293 217.25363 222.65633 228.29843 231.83813 234.12233 238.80502 244.16272 246.62242 251.98012 256.66281 260.20251 265.65921 269.49591 271.78012 277.13782 279.5975 283.13721 288.82791 294.18561 298.02231 300.30652 305.90723 308.36691 312.20361 317.56131 322.24402 325.78372 328.24341 333.56509 335.8493 343.20502 345.6008 349.1405 354.83121 357.11542 362.51813 364.74203 370.34274 375.79944 378.19614 383.89764 387.43735 392.84006 396.67676 398.90067">operand can specify the call gate segment selector either directly with a pointer (</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-124.97912" x="402.77969 408.35519 411.9552 415.76669 421.52939 427.22189 431.2764 436.9689">ptr16:16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-124.97912" x="442.73969 444.96359 450.4248 454.26599"> or </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-124.97912" x="456.5394 462.13019 465.65997 469.48679 475.19458 480.95728 485.03607 490.74387">ptr16:32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-124.97912" x="496.43909 500.51788 502.80209 508.2579 512.09369 514.31763 516.77643 522.46625 528.06604 530.52484 534.36066 539.71747 544.39929 547.93811 550.39691 555.71771">) or indirectly </tspan><tspan y="-113.99911" x="46.018799 53.335796 55.791893 59.334293 65.027695 67.851891 73.257294 76.140892 84.894295 90.254692 99.008095 104.4675 108.3069 113.589 116.4726 118.86931 124.32961 129.015 134.42039 137.9628 140.4252 145.8846 151.578 154.40219">with a memory location (</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-113.99911" x="158.4585 167.2101 172.9287 178.64729 182.72789 188.44649">m16:16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-113.99911" x="194.1588 197.0424 202.5036 206.3448"> or </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-113.99911" x="209.1591 217.9035 223.6149 229.32629 233.39969 239.16238">m16:32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-113.99911" x="244.85941 248.9364 252.2034 255.08699 260.62198 266.30997 271.66498 274.54858 280.14658 283.98059 289.4346 294.11459 299.4696 304.1496 308.82959 314.2836 318.11761 321.00122 326.45523 332.05322 335.59021 340.9902 343.4472 349.13519 353.81519 356.6394 360.17639 365.86438 371.21939 374.103 378.78299 384.138 389.73599 398.48398 403.83899 409.52698 413.06396 415.94757 420.62756 425.98257 428.43958 433.79459 438.47458 442.01157 447.46558 451.29959 454.12381 457.28281 462.73682 466.57083 469.39505 472.93204 478.62003 483.97504 486.85864 492.54663 497.90164 505.25464 508.07886 512.75885 518.21283 523.81085 529.21356">). The processor obtains the segment selector for the new code </tspan><tspan y="-102.95882" x="46.019714 50.706017 56.067318 61.671619 70.425919 75.787216 81.481514 85.024811 87.608711 93.015015 98.709312 104.31361 106.89751 110.44081 116.13511 121.49641 124.08031 129.77461 135.13591 142.49521 145.0791 147.5424 153.18451 157.8708 161.41411 165.25441 170.94872 175.63501 179.17831 181.64162 187.10191 192.79622 195.38011 200.98441 206.4447 208.908 214.60231 218.14561 223.50691 227.34721 229.93111 234.0144 239.4747 242.64 245.8053 250.54559 255.88799 259.43127 263.51459 266.09851 269.26382 273.10413 278.56442 287.26743 289.85135 293.39465 299.08896 304.45026 307.03418 311.72049 316.98001 319.4415 321.8382 324.42212 330.02463 335.42914 338.97064 344.33014 346.91406 352.51657 357.87607 362.56058 367.24509 371.08359 373.54507 379.14758 382.68909 388.14758 390.72968 393.9715 396.55542 400.63693 406.17642 411.81851 417.22122 419.80515 425.26364 428.42715 431.59067 436.27518 441.63467 445.17618 447.8204 450.98392 454.82242 460.28091 469.03342 471.61734 475.15884 480.85135 486.21085 488.79477 492.33627 497.74078 501.57928 507.18179 512.54132 516.08282 518.66675 524.12524 529.72772 535.08722 538.74933 544.15381 549.84631 555.44879">segment and the new instruction pointer (offset) from the call gate descriptor. (The offset from the target operand </tspan><tspan y="-91.978813" x="46.019714 48.475815 53.154915 55.979115 58.435215 64.032318 69.719421 75.172523 79.005623 84.359726 89.956825 92.840431 100.19254 105.87964 111.23374 116.92085 119.80445 125.20355 128.02776 132.70685 138.10594 140.56204 143.01814 145.84235 151.43945 156.83855 160.37465 165.72874 168.55295 171.00905 175.68814 178.57175 184.25885 188.93796 194.34065 199.92065 203.18675 207.26285">is ignored when a call gate is used.) </tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="512.71216pt" height="642.76154pt" viewBox="0 0 512.71216 642.76154" sodipodi:docname="244.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="348.33687" inkscape:cy="421.19966" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg214" /><g transform="translate(-44.747345,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-715.97998" x="45.119999 52.194901 57.883801 60.348 62.744701 68.446205 71.984108 77.340012 81.121811 85.200615 90.799515 94.634415 97.092316 102.41222 104.80891 107.26501 112.62092 118.21982 123.57572 127.65363 130.11153 135.46742 140.68922 146.09192 148.48862 150.95282 155.63373 161.03462 163.49252 165.95042 170.63132 173.89922 176.36342 179.90132 185.59023 190.99292 193.45712 199.05603 202.89093 208.34583 213.02673 218.38263 223.06354 227.74445 233.19934 237.03424 239.49844 244.17935 251.53325 253.99115 257.52905 262.20996 267.89886 273.30157 277.9816 280.4458 283.9837 289.4386 291.9028 295.4407 301.12961 306.4855 308.88028 313.55759 317.09189 322.4892 327.1665 332.48282 334.94702 338.10333 343.55463 347.38593 349.85013 353.38443 359.06973 364.42203 366.88623 372.52563 376.36774 378.76447 384.10599 386.5603 389.01462 394.36691 399.96222 405.36493 407.82913 410.22495 415.62766 420.84946 426.19186 428.64618 431.11038 436.56168 439.71799 442.18219 445.71649 451.40179 456.8045 459.26871 463.94601 469.34332 471.79764 474.19345 479.59616 485.17618 487.64038 493.23569 497.06699 502.51828 507.19559 512.54791 518.18732 523.87262 527.70392 533.05621 536.3205 538.78473 544.36292 550.06439 555.41669">On inter-privilege-level calls, the processor switches to the stack for the privilege level of the called procedure. The </tspan><tspan y="-705" x="45.119995 49.797295 55.149593 60.744896 69.490196 74.893799 80.536804 84.071106 86.415611 91.092911 96.445213 98.899513 104.25182 108.92912 112.46342 117.91472 121.74602 124.03112 127.18742 132.63872 136.47002 138.75511 142.28941 147.97472 153.32701 155.67151 161.31451 166.71811 174.06841 176.4129 181.09021 184.62451 190.0218 194.69911 200.01541 202.35991 207.03722 212.38951 217.98482 226.73012 232.08241 237.76772 241.30202 243.58711 246.04141 250.71872 253.06322 257.74051 263.33582 268.68811 273.36542 275.81973 278.97604 281.37366 286.77725 292.37256 294.65768 297.112 302.7973 305.03998 308.57968 314.27039 319.62808 321.97168 327.43018 333.49347 339.64316 341.98676 345.14847 350.60516 354.44186 356.78546 360.32516 365.96725 371.32495 373.60919 378.2919 383.9826 387.81931 391.65601 397.0137 402.70441 406.24411 408.7038 414.02548 416.36908 420.20578 425.84787 431.53857 437.22928 439.68896 445.37967 450.98038 453.26459 456.80429 462.207 466.88971 472.2114 475.48111 477.76532 483.30301 488.99371 494.35141 496.69501 502.29572 505.95782 511.36053 517.05121 521.73389 527.42456 529.70874 533.24841 538.70514 540.98932 544.52899 550.21967 555.57739">segment selector for the new stack segment is specified in the TSS for the currently running task. The branch to the </tspan><tspan y="-694.02002" x="45.119995 50.807995 56.162994 63.515995 66.399597 71.079597 76.5336 82.131599 87.534302 90.358498 95.038498 100.3935 105.9915 114.7395 120.1422 125.78431 129.3213 132.2049 137.65889 142.3389 147.01889 152.70689 156.54089 161.22089 164.04507 169.44507 172.60406 176.14107 181.49606 185.33006 188.21365 191.75066 197.43866 202.79366 205.61784 210.29785 213.83485 219.23485 223.91486 229.23386 232.11745 236.79745 244.15045 246.60745 250.14445 254.82446 260.51245 263.77945 266.66306 270.74005 277.46304 282.91705 286.45404 291.80905 294.63327 298.17026 303.85825 309.25824 312.79523 315.67883 323.03183 328.71982 334.07483 339.76282 342.64642 348.33441 353.0144 355.4111 361.11258 366.71057 369.59418 374.99417 377.81839 382.49838 387.89838 390.35538 392.81238 395.6366 401.23459 406.63458 410.17157 415.52658 418.41019 421.94717 427.34808 430.23169 435.82968 441.23239 445.06641 448.2254 453.67941 457.51343 466.26141 469.08563 474.48563 477.36923 480.52823 485.92822 489.76224 492.58646 497.26645 502.66644 505.12344 507.58044 510.40466 513.94165 519.39563 522.21985 527.61987">new code segment occurs after the stack switch. (Note that when using a call gate to perform a far call to a </tspan><tspan y="-682.97974" x="45.119995 49.799995 55.154995 60.752995 69.500992 74.904594 80.5476 84.084602 86.609108 92.009109 95.546112 98.07061 101.60761 107.29562 112.65062 115.17512 119.91632 125.32082 134.06882 139.47241 141.9969 147.59491 151.42891 153.88591 159.20491 161.66191 164.11891 169.47391 175.07191 180.47551 183 185.3976 190.80119 196.0239 201.36719 203.82419 207.09119 209.55627 215.24428 220.69827 223.22276 227.90277 231.43977 236.83977 241.51978 246.83878 249.36327 254.04327 261.39627 263.79388 267.33447 272.01447 277.70245 280.22696 285.68097 290.36096 295.04095 300.65967 304.49368 309.17368 312.47577 316.55457 319.07816 326.15216 331.84015 334.36374 337.90073 343.58871 348.94373 351.46732 357.1553 362.51031 369.86331 372.3869 377.06689 380.60388 386.00388 390.68387 396.00287 399.26987 401.79346 405.33044 411.01843 416.37344 418.89703 424.53644 428.37854 433.83255 438.51254 443.86755 448.54755 453.22754 458.68155 462.51556 465.03915 470.63715 476.32513 481.00513 486.69312 492.04813 496.72812 499.25171 502.7887 508.47668 513.83167 516.35529 521.03528 526.43799 532.03601 540.784 546.13898 551.82697 555.36395">segment at the same privilege level, no stack switch occurs.) On the new stack, the processor pushes the segment </tspan><tspan y="-671.99976" x="45.11998 49.804482 55.163982 57.625481 62.984982 67.669479 71.210983 76.669487 80.507988 83.391586 88.796089 94.438187 100.04069 102.86488 107.54939 111.09089 116.49539 121.17989 126.5034 129.32761 134.9301 140.3886 142.78529 148.4868 152.02831 157.431 161.2695 164.0937 167.2572 172.7157 176.5542 179.3784 182.91991 188.61241 193.97191 196.85551 201.54001 206.9445 209.3412 211.8027 214.26421 219.95671 225.5592 228.44281 234.0453 237.8838 243.3423 248.02679 253.38629 258.9888 264.6813 268.51981 273.92252 276.02673 280.71124 283.53546 288.21997 291.76147 297.16599 301.85049 307.17398 310.4455 313.26971 318.67422 324.36673 327.19095 332.64944 338.25195 341.79346 344.18924 349.64774 355.34024 360.74475 363.20624 366.03046 370.71497 376.11768 379.65918 382.4834 387.94189 391.10541 393.92963 399.53214 404.93665 408.59875 414.00238 422.75488 428.11438 431.65588 437.01538 440.85388 445.53839 448.422 451.58551 455.42401 460.88251 469.63501 472.45923 476.00073 481.69324 487.09595 489.92017 494.60468 500.00919 502.47067 504.93216 507.32794 513.02045 518.62292 521.50653 527.10901 530.94751 536.40601 541.09052 546.45001">selector and stack pointer for the calling procedure’s stack, an optional set of parameters from the calling proce-</tspan><tspan y="-661.01978" x="45.11998 50.71888 56.40778 60.24268 65.598579 70.27948 72.803078 77.483978 81.021881 86.422783 91.103683 96.423584 99.691483 102.21508 107.61598 113.30489 118.90379 121.42738 124.96529 130.65419 136.01009 138.53368 143.21457 148.57047 154.16937 162.91827 168.27417 173.96307 177.50098 180.02457 184.70547 190.06137 192.51927 197.87517 202.55606 206.09396 211.54886 215.38376 217.90735 223.30824 228.99715 234.59605 237.11964 239.51634 245.21785 249.89874 253.43665 257.27155 262.96045 267.64136 271.17926 273.63715 279.09204 284.78094 287.24518 292.84409 298.29898 300.69568 306.39719 309.93509 315.23969 319.07639 321.59998 324.76169 330.21838 334.05508 336.51929 340.05899 345.74969 351.1524 353.61661 358.29932 363.70203 366.16171 368.6214 371.0181 376.7088 382.30951 384.77371 390.37442 394.21112 399.66782 404.35052 409.70822 415.30893 420.99963 424.83633 430.19403 432.29825 436.98096 439.50455 444.18726 449.64395 455.24466 460.64737 463.11157 467.79428 473.19699 478.7977 487.5484 492.9061 498.5968 502.13651 505.40622 507.92981 512.00952 518.15924 520.62341 525.78491 531.18854 533.64825 539.33893 544.69666 547.22021 549.61603 555.3175">dures stack, and the segment selector and instruction pointer for the calling procedure’s code segment. (A value in </tspan><tspan y="-649.97949" x="45.119995 48.659695 54.350395 59.708096 62.531399 67.214096 72.616798 75.0765 77.536201 80.359497 85.960197 91.3629 94.902603 100.2603 103.143 108.7437 114.10139 118.7841 123.4668 127.3035 129.7632 135.36389 138.90359 144.36029 148.19699 151.07968 156.68039 162.03809 165.57779 170.93549 174.71638 183.47879 185.93849 191.6292 196.98689 201.66959 204.55228 210.19348 215.65288 223.00858 225.83186 234.58257 239.98526 245.56616 250.90677 253.78946 259.39017 264.79288 268.45407 273.85678 282.60748 287.96518 291.50488 296.86258 300.64349 305.33969 308.16391 311.70181 317.15671 319.98093 324.66183 330.11673 335.71564 341.03552 343.91913 347.45703 352.85794 355.74155 359.27945 364.96835 370.32425 373.20786 378.84995 384.25266 391.60657 394.49017 399.17108 402.70898 408.10989 412.7908 418.11072 421.37863 425.45654 428.28076 433.50345 435.90015 441.58905 446.98996 449.44785 451.90573 456.34726 459.61517 462.43939 465.97729 471.6662 477.02209 479.9057 485.50461 489.33951 494.7944 499.47531 504.83121 509.51212 514.25238 519.65326 523.48816">the call gate descriptor determines how many parameters to copy to the new stack.) Finally, the processor </tspan><tspan y="-638.99951" x="45.119995 50.720695 54.382797 59.785496 65.476196 70.158897 75.849594 81.207291 85.889992 88.77359 92.313293 97.769997 100.59419 104.1339 109.82459 115.1823 118.0659 123.4686 129.06931 134.67001 138.50671 143.86441 148.5471 153.2298 156.054 161.5107 164.67239 167.4966 171.0363 176.72701 182.0847 184.90891 190.50961 194.34631 199.80301 204.4857 209.8434 215.44409 221.1348 224.9715 230.32919 233.1534 238.75409 244.11179 246.57149 252.26219 257.86288 260.6871 265.36981 270.77252 273.23221 275.69189 281.04959 286.6503 289.47452 296.83023 299.22601 302.76572 308.45642 310.91611 316.60681 319.43103 322.97073 328.66144 334.01913 336.90274 342.59344 347.95114 355.30685 358.19046 362.87317 368.32986 373.93057 379.28827 382.17188 386.85458 392.21228 397.81299 406.56369 411.92139 417.61209 421.15179">branches to the address of the procedure being called within the new code segment.</tspan><tspan y="-622.97949" x="45.119995 50.801697 55.9632 61.365898 66.045898 71.736595 75.276299 77.672997 83.374496 88.975197 91.858795 97.261497 100.08569 103.6254 109.0281 113.7108 119.0325 121.9161 126.5988 133.9545 136.4142 139.9539 144.6366 150.3273 153.1515 160.5072 162.9669 166.50661 172.14871 175.03232 178.57202 184.26273 189.62042 192.44463 198.72032 204.87003 209.87672 214.88342 217.76703 220.22673 225.86884 230.55153 234.09123 237.92793 243.61864 248.30133 251.84103 254.30074 259.75745 265.44815 268.27237 270.73206 275.41476 278.23898 282.92169 285.38138 294.13208 296.59177 298.98846 304.39206 308.22876 311.11237 314.65207 320.10876 322.93298 328.33569 333.49719 338.8999 343.57993 349.27063 352.81033 355.20703 360.90854 366.50925 369.33347 374.73618 377.56039 382.30069 387.70428 390.10098 392.55707 395.38129 398.98129 404.62338 408.46008 413.91678 419.60748 425.20819 430.8989 433.7825 439.18521 442.00943 446.69214 452.09485 454.55453 457.01422 459.83844 465.43915 470.84186 474.44186 479.78427 483.05399 485.93759 491.47528 497.16599 502.52368 505.40729 508.94699 514.34967 518.18634 523.78705 529.14478 532.68445">Executing a task switch with the CALL instruction is similar to executing a call through a call gate. The target </tspan><tspan y="-611.99951" x="45.119995 50.572197 56.168396 61.521595 65.243996 70.642197 76.3284 81.967796 84.792 89.4702 95.109596 100.4628 105.141 107.5962 110.7534 113.2086 118.56181 123.24001 126.12361 129.65881 135.34502 140.69821 143.58182 148.26003 153.61322 159.20943 167.95563 173.30882 178.99503 182.53023 185.35443 190.09474 195.43713 197.89233 203.24553 207.92374 211.45894 216.91113 220.74333 223.56754 229.01973 232.17693 235.00113 238.53633 244.22253 249.57573 252.45934 255.99454 261.39273 266.07092 271.38812 274.21231 279.8085 285.2724 288.80759 294.1608 296.98499 300.14218 305.59439 309.42661 312.17969 315.71759 321.40649 326.76239 329.646 335.3349 340.6908 348.04471 350.86893 354.40683 359.80774 364.48865 369.80853 372.63275 378.03366 382.71457 386.25247 388.71036 393.87189 399.27548 402.81339 408.16928 413.76819 416.65179 422.2507 427.57062 430.39484 433.93274 439.62164 444.97754 447.86115 452.54205 459.89597 462.35385 465.89175 470.57266 476.26157 479.08578 483.1637 486.7016 492.3905 497.7464 500.63 506.0849 509.24481 512.40472 517.08563 522.44153 525.97943 528.80365 531.26154 536.95044 539.77466 543.31256 549.00146 554.35736">operand specifies the segment selector of the task gate for the new task activated by the switch (the offset in the </tspan><tspan y="-601.01953" x="45.119995 48.661495 54.065994 57.904495 63.506996 68.866493 72.407997 75.291595 80.750099 86.3526 91.712097 95.434502 100.839 106.5315 112.134 114.9582 117.4197 122.1042 124.9878 127.38451 133.0239 138.666 144.1263 147.9648 153.3243 158.92679 163.00829 166.27979 169.10399 174.64349 180.336 185.6955 188.5791 192.12061 197.5251 202.20959 207.5331 210.3573 215.95979 221.36429 224.90579 230.26529 233.08949 235.55099 241.2435 244.0677 247.60921 253.30171 257.1402 262.8327 265.65692 271.25943 276.66034 279.12183 284.81433 288.35583 292.98001 295.86362 299.40872 304.87082 307.69504 311.24014 316.93625 322.29935 325.18295 330.64145 336.70474 342.85983 345.74344 348.91055 354.37265 358.21475 361.09836 364.64346 370.33957 375.70267 378.52689 384.22299 389.58609 396.9472 399.77142 403.31653 408.72464 413.41275 418.73984 422.01492 424.83914 432.20026 437.84238 440.30746 444.99557 450.69168 453.57529 458.2634 463.72549 469.36761 472.90732 478.31543 480.78052 486.47662 491.16473 493.98895 497.53406 503.23016 508.59326 511.41748 516.10559 521.46869 527.07477 535.77777 541.14087 546.83698 550.38208">target operand is ignored). The task gate in turn points to the TSS for the new task, which contains the segment </tspan><tspan y="-589.97925" x="45.119995 49.804497 55.163998 57.625496 62.984997 67.669495 71.210999 76.669502 80.508003 85.192505 87.6567 90.820198 96.278702 100.1172 102.5814 106.1229 111.8154 117.1749 119.69849 123.24 128.6445 133.32899 138.6525 140.7567 145.49699 147.9612 152.64569 158.10419 163.70668 169.06618 171.53038 176.99428 182.63638 188.23888 190.70308 195.38757 198.92908 204.33357 209.01807 214.34157 216.80577 221.49026 226.84976 232.45226 241.20476 246.60745 252.24956 255.79106 260.47556 263.74707 266.21127 272.93878 278.39728 281.93878 287.29828 289.82187 293.36337 299.00546 304.40997 307.95148 310.47507 314.01657 319.70908 325.06857 327.53278 332.99127 339.05457 345.20605 347.67026 353.07477 355.53625 360.22076 365.67926 368.14346 372.82797 378.28647 383.97897 387.52048 392.92499 395.32169 401.01419 405.6987 408.1629 411.70441 417.39691 422.79962 425.26382 430.94733 434.73184 440.15433 442.61853 447.78003 453.18365 455.58035 461.28186 466.68457 469.14877 472.31229 477.77078 481.60928 484.13287 487.67438 493.31647 498.71918 501.18338 506.87589 512.23541 517.5589 521.1004 523.56464 526.02612 531.66821 536.35272 539.89423 543.73273 549.42523 554.04492">selectors for the task’s code and stack segments. Note that the TSS also contains the EIP value for the next instruc-</tspan><tspan y="-578.99927" x="45.119995 48.663296 51.126595 56.586895 62.228996 64.693199 68.236496 73.930794 79.337097 82.880394 85.284294 92.540993 97.944595 102.6849 105.0888 108.6321 114.09239 116.55659 122.1609 127.52219 129.9864 135.3477 140.5695 145.9308 150.6171 156.3114 159.85471 165.216 170.8203 173.2242 178.82849 184.18979 187.35509 192.81538 196.65569 202.01698 204.42088 207.96419 213.65849 219.01979 221.42369 226.10999 231.51628 233.97958 236.44289 238.83958 244.53389 250.13818 252.54208 256.08539 261.4917 266.17801 271.5033 273.9675 281.22421 286.62784 291.31415 293.71805 298.40436 304.02029 308.6994 314.29651 319.69922 325.40073 330.99783 336.35193 341.94904 345.21515 347.67935 353.21344 358.90054 361.29724 365.97723 368.44144 370.89752 376.58463 381.26373 384.79984 388.63293 394.32004 399.06033 402.60004 404.99673 410.45703 416.14413 418.60834 424.20544 429.65854 432.11462 437.80173 441.33783 446.74054 450.57364 452.97754 458.13907 463.54266 465.99875 471.68585 477.03995 479.44385 481.89993 486.57904 489.04324 491.49933 496.90024 502.29935 507.89645 513.25055 518.84766 521.31183 523.76794 529.45502 532.99109 538.44421 540.84808 544.38416 550.07123 555.42535">tion that was to be executed before the calling task was suspended. This instruction pointer value is loaded into the </tspan><tspan y="-568.01929" x="45.119995 50.803497 54.587997 60.010498 62.834702 66.673203 72.0327 77.635201 80.096703 84.781204 88.322708 93.682205 97.520706 100.3449 103.88641 109.34491 112.22851 116.06701 121.42651 125.508 130.1925 133.73401 139.1385 142.97701 146.51851 149.40211 152.94362 158.58572 163.94522 166.76942 171.45392 176.85841 179.31992 181.78142 184.17812 189.87062 195.47311 198.29732 201.83882 207.24332 211.92781 217.25131 220.52281">EIP register to re-start the calling task. </tspan><tspan y="-551.99927" x="45.119995 50.657696 56.348396 61.706097 64.589699 70.865402 77.015106 82.021805 87.028503 89.852699 92.312401 98.003098 102.6858 106.2255 110.0622 115.7043 120.387 123.9267 126.38641 131.84311 137.53381 140.35802 145.04071 150.50461 156.14671 159.03032 164.43301 166.89272 171.57541 177.0321 179.85631 184.539 190.13971 195.5424 200.2224 202.61909 205.743 211.0647 213.9483 217.48801 223.13011 228.53281 231.35701 236.0397 241.3974 246.99811 255.74881 261.10651 266.79721 270.33691 273.16113 277.84384 283.20154 285.66122 291.01892 295.70163 299.24133 304.69803 308.53473 311.34 316.79221 319.9494 322.83301 326.36819 332.05438 337.40759 340.2912 345.74969 351.81299 357.95819 360.8418 366.43799 368.89319 372.7254 378.07861 382.75681 386.29199 388.74719 393.18869 396.45389 399.27811 406.6293 412.31549 414.77069 419.44888 425.13507 428.01868 433.37189 435.82709 438.28229 447.0285 449.4837 455.16989 460.56808 464.10327 469.45648 474.13467 477.01828 480.55347 486.23965 491.59286 494.41708 496.87228 502.55847 508.15466 510.60986 514.44208 519.79529 524.47351 528.00873 530.46393 535.91614 541.60236 544.42657 549.87878 553.03601">The CALL instruction can also specify the segment selector of the TSS directly, which eliminates the indirection of </tspan><tspan y="-541.01929" x="45.119995 48.659695 54.350395 59.708096 62.471996 66.011696 71.414398 76.097099 81.4188 84.182701 89.783401 95.186104 98.725807 104.08351 107.35321 110.11711 116.26682 121.62451 126.98221 129.74611 136.0218 141.71251 147.1152 152.71591 156.25562 161.61331 165.45001 168.21391 173.93161 177.20131 179.96521 184.0899 188.5881 193.9908 198.67349 203.99519 206.75909 214.3398 219.74249 225.4332 230.83589 236.43658 241.79428 250.54498 255.90268 261.59338 265.13309 267.47491 271.6149 274.37881 276.8385 282.52921 285.29312 288.83282 294.52353 299.88123">the task gate. See Chapter 7, “Task Management,” in the </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-541.01929" x="302.58029 306.36121 312.05011 315.58801 320.94391 323.40179 332.39371 335.15762 340.92035 346.62277 349.38669 354.7876 360.4765 366.07541 368.83932 372.62024 378.80325 382.88116 388.59708 394.31299 397.0769 403.26083 407.04263 411.78293 417.42502 419.8829 423.42081 428.82352 433.50354 437.04144 442.73035 446.56525 451.92114 456.60205 459.36597 465.51385 470.96875 474.12866 477.66656 485.02048 490.42139 494.25629 499.61218 502.3761 509.26199 514.61792 519.92883 525.28473 527.74261 533.19751 538.79639 544.15228 547.98718 550.45135 555.13226">Intel® 64 and IA-32 Architectures Software Developer’s </tspan><tspan y="-529.979" x="45.119995 52.697994 58.097996 63.785995 69.473999 74.874001 77.331001 80.598 83.481606 89.619606 95.073608 97.530609 103.21861 111.96661 117.32162 120.14582 125.90852">Manual, Volume 3A</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-529.979" x="131.99969 135.27119 138.0954 141.2589 146.71739 150.55589 153.3801 155.8416 161.5341 164.6976 170.1561 173.9946 182.7471 188.1516 191.6931 194.1546 199.6131 205.3056 208.12981 213.5883 219.28081 222.10501 225.64651 231.33902 236.69852 239.58212 248.33463 253.69412 258.37863 264.07114 269.47565 275.16815 277.56485 282.24936 286.93387 289.81747 295.27597 298.43948 301.32309 306.7276 309.55182 313.09332 318.49783 323.18234 328.50583 331.38943 336.07394 343.43146 345.89294 349.43445 354.11896 359.81146">, for information on the mechanics of a task switch.</tspan><tspan y="-513.95898" x="45.119995 54.015594 59.707195 65.065796 70.757393 73.041588 78.364189 83.821793 89.46389 91.807487 97.166084 102.38789 107.74648 112.43008 118.12168 121.66228 127.02088 129.36449 134.76808 138.30869 140.59288 144.13348 149.53708 154.22067 159.54327 161.82747 166.51106 173.86766 176.32826 179.86887 184.55246 190.24406 192.52826 199.88486 202.28156 205.82216 211.51376 213.85736 219.26096 221.54515 227.82175 233.97235 238.97995 243.98755 246.27174 248.73235 254.42395 259.10754 262.64813 266.48572 272.17731 276.8609 280.40149 282.86209 288.263 293.95459 297.22519 299.5094 303.04999 308.70029 314.05258 316.39618 322.08148 327.43378 332.11108 335.64539 340.99768 346.63708 348.9213 352.4556 357.85291 362.53021 367.84653 370.13074 373.28705 375.74136 381.13867 386.73398 389.01819 393.0925 399.81281 405.39099 409.46979 411.754 414.20831 418.88562 421.16983 425.84714 431.24985 434.78415 437.06836 439.52267 445.20798 447.49219 451.02649 456.71179 462.06409 464.40768 470.08398 475.24728 480.29089 486.41449 493.37778 499.56168 501.84589 505.67719 511.02948 516.66888 519.0647 523.80499 527.34467 532.69696 536.52826 538.8125 544.20978 549.89508 555.49036">When you execute at task switch with a CALL instruction, the nested task flag (NT) is set in the EFLAGS register and </tspan><tspan y="-502.97897" x="45.119995 48.654297 54.339596 59.691895 62.516094 68.201393 73.604095 80.954399 83.838005 89.296509 95.35981 101.50411 103.60831 108.28561 111.16922 116.76452 120.59582 125.94812 131.26442 133.71872 139.17001 144.85532 149.53262 152.35681 155.89111 161.28841 165.96571 171.28201 174.1062 176.5605 179.0148 184.7001 190.0164 192.89999 196.05629 198.51059 203.91328 206.30998 211.90529 214.72948 217.18378 221.86108 224.68527 227.13957 232.59087 237.98816 243.58347 248.98616 254.56616 257.39038 264.74069 267.19501 270.72931 276.41461 279.29822 282.83252 288.51782 293.87012 296.75372 302.1546 304.61969 310.21768 313.04187 316.57886 321.97885 326.65884 331.97784 334.08203 338.76202 341.58621 347.12122 353.18451 359.33151 362.21509 366.89508 372.25009 374.70709 380.0621 384.7421 388.27908 393.73309 396.31522 399.58221 402.46579 408.7388 414.19281 419.7908 425.19351 428.0177 430.4747 435.15469 437.97888 443.38159 448.6637 454.26169 459.6167 464.29669 467.83368 473.18869 478.78668 481.61087 485.14786 490.60187 493.42606 498.10605 503.79404 508.47403 514.07202 519.427 525.11499 530.71301 533.59662 537.13361 542.7757 545.23267 549.91266">the new TSS’s previous task link field is loaded with the old task’s TSS selector. Code is expected to suspend this </tspan><tspan y="-491.99896" x="45.119995 50.810696 56.168396 60.851097 64.3908 69.748505 75.349205 77.573097 81.112801 86.515503 91.198204 96.519905 98.8041 104.4048 109.7265 112.0107 117.36839 122.59019 127.94789 132.63058 138.32129 141.86099 144.32069 150.0114 155.61209 157.89629 163.29898 168.94109 171.22528 175.00798 181.25668 186.93839 192.47609 194.76028 197.15698 202.85849 207.54118 211.08089 214.91759 220.60829 225.29099 228.83069 231.29039 236.74709 242.43779 244.66168 252.01738 257.70807 260.10477 264.78479 270.47549 273.74521 275.96912 281.56982 286.92752 291.61023 297.01294 302.70364 307.38635 312.74405 315.00031 318.54361 324.23792 329.59921 331.82312 338.55243 344.09372 346.31763 349.48294 351.94623 357.35254 362.95685 365.24106 367.63776 372.31778 374.60199 379.2883 384.6496 388.1929 391.46619 393.69009 399.15399 404.79611 408.33942 413.79971 422.55402 427.96033 431.50363 433.96692 438.65323 444.05954 446.52283 448.91861 454.2439 456.52811 462.17023 466.91052 472.27182 476.95813 479.18204 482.72534 488.41965 493.78094 496.00485 501.60916 505.44946 510.81076 516.13605 518.59937 524.05969 529.75397 534.44025 536.66412 540.2074 545.61371 550.354 555.63611">nested task by executing an IRET instruction which, because the NT flag is set, automatically uses the previous task </tspan><tspan y="-480.95865" x="45.119995 47.584194 49.980892 55.676094 61.002296 63.286495 66.830696 72.291901 74.576096 78.417297 83.779495 87.379494 93.021591 96.862793 102.55799 104.84219 108.38639 113.8476 116.19119 119.73539 125.37749 130.73969 133.02388 137.71107 143.11827 145.58247 147.97917 150.44337 156.13858 161.74377 164.08737 167.63158 173.03877 177.72597 183.05217 186.32637 188.61057 192.69476 198.84897 204.21117 209.57336 211.85756 215.98676 220.48495 225.89215 230.57935 235.90555 238.18974 243.20094 245.66515 251.36035 256.68655 259.08325 264.78473 270.38992 274.51913 276.80334 279.26755 284.96274 287.24695 293.52716 299.22235 304.62955 310.23474 313.77893 319.14114 322.98233 325.26654 330.98874 333.27295 338.73416 341.90036 344.18457 347.72876 353.42395 358.78616">link to return to the calling task. (See “Task Linking” in Chapter 7 of the </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-480.95865" x="360.9003 364.67941 370.36652 373.90262 379.25671 381.7128 390.70291 392.98712 398.74985 404.45227 406.73648 412.13559 417.82269 423.4198 425.7634 429.54251 435.67963 439.75574 445.46985 451.23257 453.51678 459.65387 463.48697 468.16608 473.85318 476.30927 479.84537 485.19946 489.87857 493.41467 499.10178 502.93488 508.28897 512.96808 515.31165 521.45776 526.91089 530.06897 533.60504 540.95715 546.35626 550.18939 555.5921">Intel® 64 and IA-32 Architectures Software </tspan><tspan y="-469.97864" x="45.119995 52.002296 57.354595 62.661896 68.064598 70.518898 75.9702 81.565498 86.917801 90.7491 93.213303 97.890602 100.3548 107.93011 113.32741 119.01271 124.69801 130.09531 132.54961 135.8139 138.33751 144.47281 149.9241 152.3784 158.06371 166.80901 172.1613 174.6255 180.3882">Developer’s Manual, Volume 3A</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-469.97864" x="186.4803 189.7518 192.27541 195.4389 200.8398 204.6783 207.2019 209.5986 215.30011 218.46361 223.9221 227.7606 236.51311 241.9176 245.45911 247.8558 253.3161 259.00861 261.53223 266.99072 272.63281 275.15643 280.84894 286.20844 290.89294 294.43445 299.79395 305.39645 307.92007 311.46158 316.86609 321.5506 326.87408 331.55859 334.83011 338.91162 341.43524 347.43912 354.81552 357.27701 360.81851 365.50302 371.19553 373.59222 379.29373 384.89624 387.36047 390.90198 396.30649 400.991 406.31448 410.99899 413.46323 420.82074 423.21744 426.75894 432.45145 434.97507 438.51657 444.15866 449.56137 452.0256 458.3031 464.45459 469.4631 474.47162 476.93585 479.39734 485.08984 489.77435 493.31586 497.15436 502.84686 507.53137 511.07288 513.53436 518.93524 524.62775 527.15137 532.75385 535.21533 538.37885 541.54236 546.90186 550.74036 555.42487">, for information on nested tasks.) Switching tasks with the CALL instruction differs </tspan><tspan y="-458.99863" x="45.119995 47.580597 53.222698 55.866901 59.407501 65.099098 67.5597 72.243301 74.887497 78.725098 84.083694 89.685295 95.088898 98.926498 104.5281 107.17229 110.33489 114.17249 119.6301 128.3331 130.97729 135.06689 142.6485 148.0701 150.71429 153.1749 158.8665 163.55009 167.0907 170.9283 176.6199 181.3035 184.8441 187.2408 192.7011 198.3927 201.6633 204.3075 208.39709 215.9787 221.4003 224.04449 229.64609 235.10368 240.46228 245.14587 247.79007 253.48167 258.93927 262.47986 265.12405 269.80765 275.16626 278.70685 281.35104 284.89163 290.58322 295.94183 298.56 305.28119 310.85941 313.5036 316.6608 319.116 324.51419 330.11038 332.75458 338.15277 343.83896 349.47836 352.12256 355.65775 361.34393 366.74664 370.58875 375.94196 379.09915 384.55136 388.38358 393.73679 396.38098 401.97717 407.42938 412.78259 417.46078 420.10498 425.79117 431.24338 434.77856 437.42276 442.77597 448.09317 453.68936 459.09207 463.77026 467.30545 469.94965 475.34784 481.03403 483.67822 487.45642 493.70062 499.37781 504.91101 507.55521 510.01041 515.69659 520.37482 523.91003 527.74225 533.42847 538.10669 541.64191 544.09711 549.54932 555.23553">in this regard from JMP instruction. JMP does not set the NT flag and therefore does not expect an IRET instruction </tspan><tspan y="-447.95831" x="45.119995 48.659695 54.116394 56.940594 61.623295 67.313995 71.996696 77.597397 82.955093 88.64579 94.24649 97.070686 100.61039 106.30109 111.65878 114.54238 118.08208 123.48479 128.16748 133.48918">to suspend the task.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c1AE6E0A5"><tspan y="-431.99863" x="45.119995 52.615196 55.115395 60.117596 62.617798 68.114998 73.612198 75.8937 80.895897 85.898094 88.893295 95.389496 97.889694 100.8849 103.10609 108.10829 113.52 119.0289 121.2501 126.2289 131.26711 134.274 140.78191 143.24341 146.2431 148.52461 155.03252 160.01132 162.52322 164.98473 169.99863">Mixing 16-Bit and 32-Bit Calls.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-431.99863" x="172.44029 175.3239 184.2141 189.9003 195.25349 200.9397 203.7639 212.5101 217.90829 223.22549 225.68069 231.3669 237.0063 239.83051 242.9877 248.38589 252.21809 255.0423 259.72049 265.11868 267.57388 270.02908 274.70728 277.53146 283.17087 288.51328 292.04846 299.39966 304.75287 310.10608 315.79227 318.61646 324.37915 330.08154 334.15674 339.75293 342.20813 345.74332 348.62689 354.02509 359.71127 365.35068 368.16058 373.87018 379.63287 383.70447 389.29706 391.74866 395.28024 398.10446 402.77905 408.22766 413.86707 419.20947 422.03369 426.70828 432.11099 437.70358 446.4462 451.79581 457.47839 461.00998 465.68457 468.94617 471.82977 477.51236 482.18695 487.53656 490.36078 495.75537 498.63898 503.31357 508.70816 511.15976 513.5556 516.43921 522.0318 527.42639 530.95801 536.36072 539.62231 542.50592 546.28052 549.43414"> When making far calls between 16-bit and 32-bit code segments, use a call gate. If </tspan><tspan y="-420.95831" x="45.12088 48.657879 54.345879 59.700878 62.525078 65.684082 71.084084 74.918083 77.801689 82.481689 87.881691 90.278389 92.734489 95.618095 98.014793 102.69479 105.57839 108.7374 112.5714 118.0254 126.7734 129.65701 135.05701 137.88121 143.59621 149.3589 153.4359 159.03391 161.49091 165.02791 167.85211 172.5321 177.9861 183.6255 188.9679 191.7921 196.47211 201.8748 207.47281 216.22081 221.57581 227.26381 230.80081 233.62502 237.16202 242.61601 245.49962 250.89961 253.72382 259.43881 265.20151 269.2785 274.8765 277.3335 280.87048 283.62088 288.30087 293.75488 299.39429 304.73669 307.56088 312.24088 317.64359 323.24158 331.98956 337.34457 343.03256 346.56955 349.83655 352.72012 356.25711 361.9451 367.30011 370.1243 374.80429 380.20428 382.66129 385.11829 387.94247 392.62247 398.31046 403.76447 409.45245 411.90945 417.50745 420.33163 425.97104 431.31345 434.19702 442.94501 448.345 453.98441 459.32681 462.151 465.31 469.14401 474.59802 483.34601 486.1702 489.70718 495.39517 500.75018 503.63376 506.79276 509.18945 513.02344 517.70343 521.24042 524.12402 529.83905 535.55408">the far call is from a 32-bit code segment to a 16-bit code segment, the call should be made from the first 64 </tspan><tspan y="-409.9783" x="45.12088 51.34528 57.50668 62.822079 66.355476 71.706879 76.383278 78.787186 84.237587 87.39299 89.796898 93.330299 99.014702 104.3661 106.70971 112.47241 118.17481 122.24821 127.84261 130.29602 133.82942 136.17302 140.84943 146.29982 151.93922 157.28162 159.62521 164.30162 169.70432 175.29872 184.04312 189.39452 195.07892 198.61232 201.87572 204.27962 209.81102 215.49542 217.89212 222.63243 224.97603 227.42943 232.10583 234.44943 240.04384 245.44653 250.12294 255.51933 261.20374 265.88013 271.23154 273.57513 277.10852 282.79291 288.14432 290.54822 295.99863 301.59302 306.94443 310.62088 316.02179 321.71069 327.3096 331.38751 336.06842 338.46512 343.18201 348.58472 350.92831 356.32922 359.86713 363.40503 367.23993 369.69781 375.29672 380.98563 384.52353 389.87943 392.22302 397.67792 400.83783 403.18143 406.78143 412.42352 417.82623 420.16983 422.62772 428.31662 432.99753 436.53543 440.37033 446.05923 450.74014 454.27805 456.73593 462.19083 467.87973 470.22333 472.68121 477.36212 479.70572 484.44601 489.78842 493.32632 495.66992 499.20782 504.66272 507.00632 512.76904 518.47144 521.73932 524.08295 528.76385 534.21875 536.56238 542.01727 547.70618 550.16406 555.48395">KBytes of the 32-bit code segment. This is because the operand-size attribute of the instruction is set to 16, so only </tspan><tspan y="-398.99829" x="45.12088 50.522682 53.346882 59.109581 64.811981 68.890778 74.490578 76.949379 80.488182 83.312378 87.148178 92.550873 96.089676 101.77948 105.56128 111.26279 114.14639 119.54819 125.14799 130.74779 134.58359 139.98628 144.66808 149.34987 152.17407 157.62987 160.79066 163.95146 168.63326 173.99005 177.52885 180.35306 185.03485 190.43665 196.12645 199.01006 204.60986 209.96666 212.85027 217.53206 222.87535 228.09715 233.43954 239.03934 242.30814 245.19174 251.34055 253.79935 258.48114 263.82175 267.09055 269.91473 273.51471 279.1568 284.55951 287.3837 292.06549 297.46729 299.92609 302.38489 305.20908 309.89087 315.58066 321.03647 326.72626 329.12296 334.76236 337.58655 343.18634 348.54315 351.36734 360.11713 365.51892 371.11871 376.52142 379.34561 385.0354 389.71719 392.17599 397.86578 403.46558 406.28976 411.69156 414.57513 420.29193 426.00873 430.08752 435.68732 438.08401 441.6228 444.50638 449.18817 454.58997 457.04877 459.44458 462.32816 467.92795 473.32974 476.86853 482.27124 485.09543 489.77722 495.23303 498.05722 501.59601 507.2858 512.68762 516.22644 519.11005 524.82684 530.54364 534.62244 540.22223 542.61896 546.15778">a 16-bit return address offset can be saved. Also, the call should be made using a 16-bit call gate so that 16-bit </tspan><tspan y="-387.95798" x="45.12088 50.282383 55.685982 58.082684 63.784184 69.142784 73.826385 76.709984 81.393585 86.797188 92.488785 95.312981 100.91458 106.27318 109.09737 114.69897 120.34107 125.02467 130.71628 136.11897 141.69897 144.52318 149.98077 155.67238 158.55598 162.09659 167.73869 173.14139 175.96559 180.64919 184.18979 189.59338 194.27698 199.59958 202.87018 205.75378 211.90439 217.30708 222.66568 225.48988 231.76648 237.45808 242.86168 248.46329 252.00389 257.28058 261.11548 263.99908 269.715 275.43091 278.69882 281.52304 285.64594 293.22482 295.68271 301.00262 303.46051 309.14941 314.74832 317.57254 323.28845 329.05118 333.12909 339.29498 341.75287 345.29077 348.17438 353.57529 359.26419 364.8631 367.68732 373.45004 379.15247 383.23038 389.39627 391.79297 395.33267 398.21628 404.49017 409.94507 415.54398 420.89987 423.2417 427.38168 430.2059 432.66379 438.35269 441.17691 444.71481 450.40372 455.75961">values can be pushed on the stack. See Chapter 21, “Mixing 16-Bit and 32-Bit Code,” in the </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-387.95798" x="458.58087 462.36539 468.05789 471.5994 476.95889 479.42038 488.41589 491.24011 497.00284 502.70526 505.52948 510.93399 516.62646 522.22894 525.05316 528.83765 534.98016 539.06165 544.82434 550.54382">Intel® 64 and IA-32 </tspan><tspan y="-376.97797" x="45.12088 51.259781 55.094681 59.775581 65.464485 67.922386 71.460289 76.816193 81.497093 85.034996 90.7239 94.5588 99.914703 104.5956 107.4792 113.62711 119.08201 122.24191 125.77981 133.13371 138.53461 142.36951 147.7254 150.54959 157.43549 162.79138 168.10228 173.45818 175.91608 181.37097 186.96988 192.32578 196.16068 198.57358 203.25449 206.13808 213.71698 219.11787 224.80678 230.44888 235.84978 238.36618 241.63408 244.51767 250.65657 256.11148 258.56937 264.25827 272.95676 278.35947 281.18369 286.8996">Architectures Software Developer’s Manual, Volume 3B</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-376.97797" x="293.04117 296.32166 299.14584 302.31833 307.78583 311.63333 314.45752 323.21902 328.68652 332.53403 337.90253 340.7861 343.1828 348.88431 352.05679 357.52429 361.3718 370.0748 375.53873 379.07843 381.47513 386.93542 392.63693">, for more information.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c1AE6E0A5"><tspan y="-360.95798" x="45.12088 50.582081 55.620281 59.123081 61.284882 67.784683 72.790482 75.251984 77.773781 82.779579 84.941376 87.445175 92.945976 95.107773 101.60757 107.10838 115.11118 120.33298 125.33878 128.33757 130.84137 136.30257 138.80637 141.31017 143.77167 146.77046 151.77626 153.93806 161.43686 166.89806 172.39885 177.40465">Far Calls in Compatibility Mode.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-360.95798" x="179.94087 182.64447 191.58687 197.22897 202.63167 208.33318 211.03677 214.57558 220.26538 225.66808 228.37167 233.97147 237.80727 243.26306 247.94485 253.30165 257.98346 262.66525 268.12106 271.95685 274.72073 277.17953 281.86133 284.62521 290.08102 295.68082 301.03763 304.69971 310.1015 313.64029 316.09909 321.78888 327.38867 330.15256 332.61136 338.30115 341.06503 345.74683 351.20264 359.95242 365.55222 370.95401 374.46057 376.92026 382.52097 384.98065 387.37735 389.83704 393.31644 398.63812 401.40292 410.15363 415.61032 421.21103 426.56873 429.83844 432.60324 436.14294 441.83365 447.19135 449.95615 456.23184 462.38153 467.38824 472.39496 475.15976 477.55646 483.25797 487.94067 491.48038 495.31708 501.00778 505.69049 509.23019 511.68988 517.14661 522.83728 525.54175 530.28204 535.68567 541.37634 544.14111 549.74182 555.09955"> When the processor is operating in compatibility mode, the CALL instruction can be </tspan><tspan y="-349.97797" x="45.12088 50.818779 55.508678 60.873577 66.481476 69.365074 72.911972 78.37587 81.200066 86.807968 92.172867 96.016769 99.185669 104.64957 108.49347 117.25137 120.13497 123.68187 129.32397 134.68887 137.51308 140.68198 146.14587 148.61278 151.00948 156.47337 163.83627 166.23297 171.93448 177.54237 180.36658 183.84598 189.18748 194.79538 200.16028 204.85017 207.67438 213.13828 216.30717 219.13138 222.30028 227.71017 231.55408 234.37828 239.06818 244.47807 246.94498 249.41188 254.10178">used to perform the following types of far calls:</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-334.98001" x="45.119999">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-334.98001" x="62.099998 66.843002 72.246605 76.080605 78.904808 83.584808 88.98481 91.441811 93.898811 96.723015 100.26002 105.71402 108.59762 112.13462 117.82262 123.17763 126.00182 130.68182 136.08182 144.82982 150.23251 153.0567 158.65471 162.48871 164.94571 170.26471 172.66141 175.11751 180.4725 186.07051 191.42551 194.3091 196.7058 202.10849 207.33029 212.67268 215.12968 218.39668 221.28027 225.11427 230.46927 239.21727 244.61726 247.07426 252.76227 255.21927 260.90726 266.50525 269.38885 271.84586 277.53384 280.41745 285.09744 290.55145 299.29944 304.89743 310.29742 313.83441 316.29141 321.8894 324.34641 326.7431 329.2001 332.6795 337.9985 340.88211 349.6301 355.08411 360.6821">Far call to the same privilege level, remaining in compatibility mode</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-319.98001" x="45.119999">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-319.98001" x="62.099998 66.843002 72.246605 76.080605 78.904808 83.584808 88.98481 91.441811 93.898811 96.723015 100.26002 105.71402 108.59762 112.13462 117.82262 123.17763 126.00182 130.68182 136.08182 144.82982 150.23251 153.05672 158.65472 162.48872 164.94572 170.26472 172.66142 175.11752 180.47252 186.07053 191.42552 194.30913 196.70583 202.10852 207.33032 212.67271 215.12971 218.39671 221.28032 224.81732 228.47942 233.87941 239.56741 244.24741 246.70441 250.24141 252.69841 258.0993 263.80078 266.25778 271.94577 277.54376 280.42734 283.96432 289.41833 292.24252 297.95752 303.72021 307.79721 313.3952 315.8522 319.38919 322.21338 330.96136 336.41537 342.01337">Far call to the same privilege level, transitioning to 64-bit mode</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-304.98001" x="45.119999">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-304.98001" x="62.099998 66.843002 72.246605 76.082405 78.906601 83.588402 88.990204 91.449005 93.907806 96.732002 100.27081 105.72661 108.61021 114.01201 116.8362 122.436 124.8327 127.9935 131.1543 136.51109 140.34689 145.70369 151.39349 154.9323 157.8159 163.41571 167.25151 169.71031 175.03111 177.48991 179.94872 185.30551 190.9053 196.308 199.1322 201.591 206.9478 212.2686 217.6254 220.0842 222.9084 226.9872 229.446 235.1358 238.67461 244.0314 247.7538 251.8326 257.4324 261.26819 263.66489 268.91998 271.37967 273.83936 279.19705 284.79776 290.15546 293.03906 295.49875 300.85645 306.07822 311.48093 313.87762 316.76123 321.44394 326.84665 329.30634 331.70303 335.78275 339.05246 341.87668 345.41638 349.13879 354.5415 360.23221 364.91492 367.3746 370.91431 373.37399 378.83069 384.52139 386.91809 392.6196 398.22031 401.04453 404.58423 410.04092 412.86514 418.62787 424.33029 428.41 434.01071 436.4704 440.0101 442.89371 451.64441 457.1011 462.70181">Far call to a different privilege level (inter-privilege level call), transitioning to 64-bit mode</tspan><tspan y="-288.96002" x="45.11969 51.84269 57.296692 60.833691 66.18869 69.072289 72.609291 78.297295 83.697296 87.234299 90.117897 95.517899 98.342094 104.6151 110.7621 115.7661 120.7701 123.65369 126.05039 131.75189 136.43188 139.96889 143.80289 149.49089 154.1709 157.7079 160.1649 165.6189 171.3069 174.13109 178.8111 184.21109 189.89909 192.78268 198.47069 203.92468 207.46169 210.34528 215.94328 221.29828 224.18187 229.86987 234.54987 239.90486 245.50287 248.38646 251.92346 257.37747 260.20169 264.88168 270.28168 275.96967 280.64966 286.00467 288.88828 294.28827 297 300.5379 305.93881 310.61972 315.93964 318.82324 323.50415 330.85806 333.31595 336.85385 341.53476 347.22366 350.04788 352.50577 358.19467 361.01889 365.6998 371.15469 379.90359 385.5025 390.90341 394.44131 396.8992 402.49811 404.95599 407.41388 409.87177 413.35117 418.67108 421.4953 430.2442 435.6991 441.298 446.6539 449.53751 454.21841 456.6763 462.3652 467.04611 472.44882 475.27304 478.81094 484.21185 488.89276 494.21265 497.03687 501.71777 509.07169 511.52957 515.06744 519.74835 525.43726 530.79315 535.47406 538.29828 543.69916 547.53406 552.93677">Note that a CALL instruction can not be used to cause a task switch in compatibility mode since task switches are </tspan><tspan y="-277.98001" x="45.119705 50.800507 56.247307 59.777107 62.601311 67.274109 72.95491 78.545708 84.185104 89.631905 93.458702 96.988503 102.3912 107.982 110.8656 113.2623 118.9638 121.8474 125.62019 131.50349 135.64259 141.35039 147.05818 152.40598 155.28957 164.03036 169.47717 175.11658 180.45897">not supported in IA-32e mode.</tspan><tspan y="-261.96002" x="45.119705 48.902405 54.593105 57.357006 62.039707 67.496407 76.247108 81.847809 87.250511 90.790215 93.249916 98.850616 101.31032 103.70702 106.16672 109.64612 114.96782 117.73172 126.48242 131.93912 137.53983 142.89752 146.16722 148.93112 152.47083 158.16153 163.51923 166.28313 171.88382 175.72052 181.12141 185.86171 191.21941 195.9021 200.58479 206.04149 209.87819 212.64209 218.04478 220.50449 227.76118 233.04507 238.36678 243.04947 245.81337 251.50407 256.18677 261.54446 266.22717 269.05139 272.59109 278.23318 283.63589 286.39981 291.08252 296.44022 302.04092 310.79163 316.14932 321.84003 325.37973 328.14365 332.82635 338.22906 340.62576 346.02847 350.71118 354.25089 359.70758 363.54428 366.3082 371.90891 377.31161 381.14832 384.68802 387.45193 392.90863 396.07034 398.83426 402.37396 408.06467 413.42236 416.18628 419.34799 424.7507 428.5874 431.35132 436.75403 442.35474 447.95544 451.79214 457.19485 461.87756 466.56027 469.32419 472.86389 478.32059 481.0845 486.48721 491.16992 495.85263 501.21033 505.89304 510.57574 513.3396 516.87927 522.56995 527.97266 530.73651 535.41919 540.87592 544.71259 548.54926 553.90698">In compatibility mode, the processor always uses the segment selector part of the far address to access the corre-</tspan><tspan y="-250.98003" x="45.119705 49.800606 55.399506 60.854408 66.543312 72.142212 74.600113 80.289017 85.887917 88.712112 94.311012 99.713715 104.39462 109.07552 112.91042 115.36832 120.96722 124.50512 129.96002 133.79492 136.61913 139.07703 144.71913 147.54333 151.08124 156.77014 162.12604 164.95024 171.96664 178.63115 184.16705 186.99126 192.44615 196.28105 199.10526 204.11015 210.83495 215.09285 218.33466 221.15886 226.69476 232.38367 237.73956 240.56377 246.16267 251.51857 256.19946 260.93976 264.72156 267.17764 272.77655 276.31445 281.71536 285.55746 288.38168 291.91959 297.17999 302.77798 308.133 310.95718 315.03418 319.71417 325.16818 330.76617 336.16888 338.99307 343.67307 349.02808 354.62607 363.37405 368.72906 374.41705 377.95404 381.22104 384.04523 388.72522 394.12521 396.52191 398.97803 401.80222 407.40021 412.86411 416.40109 421.7561 425.8331 428.65729 434.05728 439.74527 445.34326 448.16745 453.56744 458.24744 462.92743 468.28244 472.96243 477.64243 480.46661 484.30063 486.75763 492.35562 498.04361 501.5806 506.26059 509.08478 514.6828 520.03778 523.57477 528.92975 532.76373 541.51172 543.96869 549.65668 555.01166">sponding descriptor in the GDT or LDT. The descriptor type (code segment, call gate) and access rights determine </tspan><tspan y="-240.00003" x="45.11969 48.656689 54.344688 59.699688 62.523891 66.06089 71.37989 76.97789 82.332893 85.157097 90.611099 93.770096 96.653694 101.33369 106.7337 109.13039 111.58649 114.4701 119.871 125.5104 130.8654 134.5275 139.92749 143.46449 145.92149 151.37549 157.06349 159.88768 163.42468 168.87868 171.76227 177.36028 182.71527 185.59886 191.19687 196.55186 200.38586 203.54486 208.99886 212.83286 221.58086 226.93585 232.53386">the type of call operation to be performed.</tspan><tspan y="-223.98003" x="45.11969 48.900589 52.06049 54.884689 58.422588 64.111488 69.467392 72.35099 77.031891 82.387794 84.845695 90.201599 94.8825 98.420403 103.77631 109.37521 112.1994 117.7983 123.201 127.8819 132.56281 136.39771 138.85561 144.45451 147.99242 153.44731 157.28221 160.10641 162.56432 167.24521 170.06941 173.22931 178.6842 182.5191 185.40271 190.8036 193.62781 198.30872 203.76361 209.36252 214.76521 217.58942 222.27032 227.62622 233.22513 241.97403 247.37672 253.07823 256.61612 259.88403 262.76764 268.16855 270.99277 274.15268 279.55359 283.38849 286.13971 290.8179 296.21609 298.6713 301.1265 303.95068 307.48587 312.93808 315.82166 321.21985 324.04404 328.72223 334.17444 339.77063 345.17334 347.99753 352.67572 358.02893 363.62512 372.37134 377.72455 383.41074 386.94592 389.77011 395.1683 398.70349 401.58707 405.12225 410.80844 416.21115 419.03534 423.71353 429.11172 437.85791 443.21112 446.0947 451.69089 455.5231 457.9783 463.2955 465.7507 468.2059 473.55911 479.1553 484.50851 487.3327 489.7879 495.14111 500.45831 505.81152 508.26672 511.09091 513.54614 518.22437">If the selected descriptor is for a code segment, a far call to a code segment at the same privilege level is </tspan><tspan y="-213.00003" x="45.119705 50.720406 56.078106 59.914806 63.076508 68.533211 72.369911 81.120613 86.478317 92.079018 95.348717 97.992912 102.07262 105.85532 109.01701 111.66121 115.20091 120.84301 126.24571 128.88991 133.5726 138.9303 141.39 146.7477 151.43039 154.97009 160.32779 165.9285 168.57269 173.25539 178.71208 184.31277 189.67047 192.31467 196.99736 202.40005 208.00076 216.75146 222.10916 227.79987 231.33957 233.98376 236.38046 241.06046 243.70465 249.10735 252.70735 255.29124 260.69394 263.33817 268.93887 271.39856 274.56027 277.72198 283.07968 286.91638 292.31909 297.83972 301.37582 304.02005 309.61716 313.45026 315.84695 321.18845 323.64453 326.10062 331.45471 337.05182 342.40591 345.05014 347.50623 352.86032 358.17841 363.5325 365.98859 368.63281 374.03192 379.71902 385.31613 387.96036 391.49646 397.18356 402.53766 405.18188 409.86099 415.31409 420.91119 426.26529 428.90952 433.58862 438.99133 444.58844 453.33554 458.68964 464.37674 467.91284 470.55707 473.01315 477.69226 480.33649 486.02359 491.47668 497.16379 501.2399 505.91901 511.3721 517.0592 520.21729 525.67041 529.50354 538.25061 540.70673 546.3938 551.99091 555.25702">performed. (If the selected code segment is at a different privilege level and the code segment is non-conforming, </tspan><tspan y="-201.95973" x="45.11972 50.523319 53.347523 58.986923 64.329323 70.030823 75.373222 79.035324 84.438927 86.895027 90.973824 96.525925 100.36803 105.82833 109.36803 114.77072 119.45072 122.99042 125.38712 130.84743 136.54893 139.43253 144.77492 149.99672 154.67671 160.0191 165.65849 169.1982 171.6093 177.0696 182.7711 185.65469 188.0658 192.74579 195.62938 201.18147 206.58417 212.22627 217.62897 221.29106 226.69466 230.23436 235.57675 241.21614 244.45795 248.53674 251.42033 257.52142 260.34564 263.52985 268.93344 272.77551 275.65912 280.33911 285.74271 288.15381 290.60992 293.49353 297.03323 302.49353 305.31775 308.85745 314.55893 319.90134 322.78494 327.46494 332.86853 341.57062 346.97333 349.79755 355.34964 359.19171 361.64783 366.98932 369.44543 371.84125 377.24396 382.82394 388.16635 391.04996 393.46106 398.86377 404.13687 409.47928 411.93539 414.819 417.2301 422.93158 425.81519 430.49518 435.95547 444.65756 450.29697 455.70056 459.24026 461.65137 467.29077 469.70187 472.15799 474.61411 478.09351 483.435 486.25922 495.02249 500.48279 506.03488 511.43759 514.26184 516.7179 521.39789 524.22211 529.49518 534.83759 538.67969 544.02118">a general-protection exception is generated.) A far call to the same privilege level in compatibility mode is very </tspan><tspan y="-190.97974" x="45.11972 49.80872 52.274719 60.977718 63.443718 65.909721 71.318718 75.16172 77.985916 81.531914 86.994911 89.87851 95.341507 100.9836 106.3476 109.1718 113.8608 119.2698 123.1128 126.9558 129.4218 134.7858 140.39279 143.217 148.67999 154.377 157.923 160.74721 163.21321 168.91022 171.73442 177.34142 181.18442 186.58531 190.12502 195.48901 200.17801 203.72401 209.08801 214.69501 217.57861 226.33562 231.79861 237.40561 242.76961 246.04561 248.86981 254.41382 260.11081 265.47482 268.29901 271.845 277.254 281.09698 286.70398 292.06799 295.61398 298.43817 303.90118 309.35971 314.76242 318.4245 323.8299 329.52328 335.12668 337.95087 342.69116 348.27115 353.63156 358.31696 360.77936 363.94376 366.34045 371.74316 376.42856 379.25275 384.65814 390.35153 393.17572 398.58112 404.18451 408.8699 414.32932 416.79172 422.43381 425.9762 431.37891 434.20309 437.36749 442.77289 446.61227 449.43646 454.84186 460.44525 466.04865 469.88803 475.24844 479.93384 484.61923 487.50281 492.86322 495.32562 498.86801 504.5614 509.92181 513.76123 516.58545 522.18884 524.58557 528.42499 533.8277 538.51312 542.05554 544.45227 549.79376">similar to one carried out in protected mode. The target operand specifies an absolute far address either directly </tspan><tspan y="-179.99974" x="45.11972 52.475422 54.935123 58.474823 64.16552 66.809715 72.212418 74.856613 80.457314 85.914017 88.373718 94.015816 97.555519 102.91322 106.74992 109.33382">with a pointer (</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-179.99974" x="113.45942 119.05202 122.58362 126.41222 132.12181 137.83141 141.903 147.6657">ptr16:16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-179.99974" x="153.35912 156.00331 161.46451 165.30571"> or </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-179.99974" x="167.87881 173.51822 177.05792 180.88832 186.59972 192.31111 196.38451 202.1472">ptr16:32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-179.99974" x="207.83881 211.9203 214.5645 220.02299 223.8615 226.44539 228.90689 234.5994 240.20189 242.66339 246.50189 251.86139 256.5459 260.0874 262.54889 267.87238 270.4563 277.81381 280.2753 283.8168 289.50931 292.09323 297.49774 300.14197 308.89447 314.25397 323.00647 328.46497 332.30347 337.62695 340.21088 342.67236 348.13086 352.81537 358.21988 361.76138 364.22287 369.68137 375.37387 377.95779">) or indirectly with a memory location (</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-179.99974" x="382.0788 390.8241 396.58682 402.29913 406.37344 412.08575">m16:16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-179.99974" x="417.71881 420.36301 425.82422 429.66541"> or </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-179.99974" x="432.2988 441.0405 446.74921 452.45792 456.52863 462.23734">m16:32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-179.99974" x="467.99908 472.06979 475.33051 477.97562 483.5043 489.186 494.5347 497.17981 502.6275 508.21921 513.6228 517.28583 522.6795 528.36121 533.95288 538.02356 542.69727 545.14795 549.85767 555.20636">). The operand-size </tspan><tspan y="-168.95944" x="45.118805 50.515205 54.048607 57.582008 61.412407 63.865807 69.460205 75.144608 78.678009 84.029411 86.553017 92.147415 97.498817 101.03222 106.43492 110.26532 119.00972 121.46312 127.14752 132.49892 137.17532 139.69891 143.23232 148.91672 154.26811 156.7917 161.46811 163.86481 168.57721 173.9286 176.45219 181.90259 185.05798 187.52217 191.05557 196.73997 202.09137 204.61496 210.06535 213.22075 216.37614 221.05255 226.45525 229.99495 232.45914 236.53253 242.29523 248.00662 250.47081 255.9212 259.75162 262.27521 267.9866 273.698 276.22159 281.81598 284.26938 287.80276 292.47916 296.55255 299.03851 301.49911 307.1412 309.66479 313.20538 318.89697 324.25558 326.77917 329.94177 335.34537 339.18295 341.70654 347.11014 352.71173 358.31332 362.15091 367.50952 372.19312 376.87671 380.14731 382.61151 388.15012 393.84171 399.24442 401.70862 407.40021 412.75882 420.11542 422.57962 427.26321 432.72083 438.32242 443.68103 446.20462 450.88821 456.24683 461.84842 470.60001 475.95862 481.65021 485.1908 487.71439 492.39798 497.75659 500.21719 505.57581 510.2594 513.79999 519.25757 523.09515 525.61877 531.0224 536.66449 542.26611 544.73035 547.19092 550.73151 555.4151">attribute determines the size of the offset (16 or 32 bits) in the far address. The new code segment selector and its </tspan><tspan y="-157.97945" x="45.118805 50.711403 56.061005 60.735603 65.475899 69.304497 71.756096 77.395493 80.935196 86.383797 90.212395 93.096001 98.490601 102.3192 107.6688 110.55241 112.9491 118.40941 123.80401 129.44341 134.793 140.3856 143.2692 145.66589 151.3674 154.899 160.3476 163.23119 169.49878 175.68268 178.50687 182.33546 187.68506 193.32446 195.72116 200.46147 204.00117 209.35077 213.17937 216.00356 221.39816 227.08076 232.67337 235.55696 239.08856 244.77116 250.12076 252.94495 258.39355 261.54715 264.70074 269.37534 274.72495 278.25653 281.14014 284.29373 288.12234 293.57095 302.2785 305.10269 308.63968 314.32767 319.73038 322.55457 325.01157 330.69955 335.37955 338.91653 342.75055 348.43854 353.11853 356.71851 359.1152 364.5755 370.26349 373.08768 375.54468 380.22467 383.10825 385.50494 390.96524 396.36523 401.96323 407.31824 412.91623 415.7998 418.25681 423.94479 427.48178 432.93579 435.81937 439.35635 445.04434 450.39935 453.22354 458.90253 462.68253 468.10052 470.9841 474.81812 480.17313 485.77112 488.22812 492.90811 496.4451 501.80011 504.38223 507.64923 510.47342 516.00842 521.69641 527.09912 529.92334 535.52136 537.97833 541.13733 544.29633 549.65131 553.37372">descriptor are loaded into CS register and the offset from the instruction is loaded into the EIP register. The differ-</tspan><tspan y="-146.99945" x="45.118805 50.464806 56.143806 60.814808 66.160805 69.044411 71.492409 76.232704 79.056908 82.584908 88.263908 93.654907 97.182907 100.00711 105.76981 111.47221 115.54021 121.12921 123.57721 127.10521 129.9294 138.6684 144.1134 149.70241 155.1051 157.92929 166.66829 172.0593 177.36929 180.25288 185.84189 191.18788 194.07147 199.41747 205.09647 208.62447 213.97046 217.79546 223.19815 228.78716 232.04515 234.92874 240.45474 246.13374 248.58174 253.25275 256.07693 260.74792 266.38733 271.73334 276.41882 278.88123 282.04562 284.50803 289.86844 295.47183 298.29602 303.89941 309.22382 312.048 315.59039 321.28378 326.6442 329.52777 334.53717 337.42075 343.02414 345.48654 349.02893 351.85312 354.31552 360.00891 362.8331 366.37549 372.06888 377.42929 380.31287 386.00626 391.36667 398.72507 401.54926 406.23465 411.69406 417.29745 422.65787 425.48206 430.16745 435.52786 441.13126 449.83423 455.19464 460.88803 464.43042 467.25461 472.858 478.21841 482.90381 487.5892 491.42859 493.8244 499.46381 503.0062 508.46561 510.9874">ence is that 64-bit mode may be entered. This specified by the L bit in the new code segment descriptor.</tspan><tspan y="-130.97945" x="45.11882 51.840919 57.294022 60.83012 66.184219 69.067818 72.60392 78.246025 83.645126 87.181229 90.064827 95.463928 98.288124 104.00223 109.71633 113.79243 119.38953 121.84563 125.38174 128.20593 132.94624 138.34984 140.74654 143.20264 146.08623 151.68333 157.08243 160.61853 165.97263 168.85622 172.93231 178.52942 183.88351 188.56262 193.24173 197.07483 199.53093 205.07852 210.43982 216.04411 218.86832 221.33162 227.02592 229.85013 233.39343 239.08774 244.44904 247.27324 252.96754 258.32886 263.65414 267.19745 270.02167 275.62598 281.03229 284.6944 290.09802 295.70233 299.36444 304.82834 310.40836 316.10266 320.18597 323.01019 327.6965 333.10281 338.79712 341.62134 347.02765 349.49094 354.17725 359.63754 362.52115 368.12546 373.48676 376.37036 382.06467 386.75098 392.11227 397.71658 400.60019 404.14349 409.60379 412.42801 418.03232 423.39362 427.23392 430.35782 435.81812 439.65842 448.41272 451.23694 456.64325 459.52686 462.69217 468.09848 471.93878 474.763 479.44931 484.85562 487.31891 489.7822 492.60641 496.14972 501.61002 504.49362 509.89993 512.72412 517.4104 522.87073 528.47504 533.83636">Note that a 64-bit call gate (described in the next paragraph) can also be used to perform a far call to a code </tspan><tspan y="-119.99944" x="45.11882 49.79882 55.141224 60.683426 69.446724 74.849426 80.491531 84.031235 86.914841 92.318443 95.858147 98.68235 102.22205 107.92355 113.26595 116.14956 120.82956 126.23316 134.99648 140.33887 143.16306 148.80246 152.64456 155.04576 160.38725 162.84335 165.29945 170.64185 176.18405 181.58675 184.41093 186.86703 192.20943 197.47263 202.87532 205.27652 208.57861 211.4028 218.17889 223.63919 230.93639 236.33908 241.60228 246.94467 249.52676 252.76855 255.65215 261.35364 266.03363 268.43484 274.13635 279.77576 282.59998 286.13968 291.77911 294.23343 298.91074 301.73495 310.48026 315.83255 320.50986 326.19516 331.59247 337.27777 339.73209 344.40939 353.15469 356.0383 359.8696 365.22189 370.8172 376.5025 378.95682 382.78812 388.14041 392.81772 395.70132 399.23563 404.92093 410.31824 413.85254 416.67676 420.21106 425.89636 431.24866 434.13226 437.66656 443.06387 446.89517 452.49048 457.84277 461.37708 464.26068 468.93799 474.38928 479.98459 485.33688 488.22049 492.8978 498.25009 503.8454 512.5907 517.94299 523.6283 527.1626">segment at the same privilege level. However, using this mechanism requires that the target code segment </tspan><tspan y="-108.95914" x="45.118805 50.724007 56.086208 60.773407 65.51371 69.295509 71.75161 77.356812 80.901009 86.362213 90.144012 93.027611 98.722809 104.06611 109.28791 114.63031 117.51391 121.05811 126.7002 132.06241 134.88661 139.89781 142.72202 148.32721 150.79141 154.33562 157.21922 161.90642 167.26862 170.81282 174.08702 176.91122 181.59842 187.00562 192.70082 197.38802 199.85222 205.49432 211.09952 213.92372 219.33092 225.02612 227.90973 233.27193 238.96713 242.51134 246.35254 251.67874 254.56235 258.10654 263.56775 266.39194 272.11414 277.83633 281.92053 287.52573 289.98993 293.53412 296.35831 305.11349 310.57471 316.1799 321.54211">descriptor have the L bit set, causing an entry to 64-bit mode.</tspan><tspan y="-92.999443" x="45.118805 54.010803 59.698803 65.053802 70.741806 73.206001 78.561005 83.782806 89.13781 93.81781 99.505814 103.04282 105.49982 111.18782 116.78582 119.25002 124.65002 130.33803 132.80223 135.25923 140.94724 144.48424 149.88693 153.60933 157.68813 163.28613 167.06793 169.52493 174.84393 177.30093 179.69763 185.10033 190.68033 196.03532 200.11232 202.56932 207.92432 213.24332 218.59831 221.05531 223.51952 226.67851 232.07851 235.91251 238.37671 243.0567 248.4567 250.9137 253.3707 256.6377 259.1019 262.63889 268.32687 273.68188 276.14609 280.82608 286.28009 291.87808 297.1188 299.58301 304.2612 309.61441 315.2106 323.95679 329.3595 335.00159 338.53677 341.00098 344.15817 349.61038 353.4426 355.9068 359.44199 365.12817 370.48138 372.94559 378.54178 382.37399 387.8262 392.50439 397.9071 403.48709 409.17328 413.00549 418.3587 420.82291 426.4191 431.82181 434.21851 439.91998 445.51617 447.98038 452.65857 458.12247 460.51917 462.97525 468.32846 473.92465 476.38885 485.13507 490.82126 495.49945 499.03464 501.49884 507.09503 512.44824 514.91248 520.31067 524.98889 529.66711 535.02032 539.69855 544.37677 549.77948 555.37567">When executing an inter-privilege-level far call, the code segment for the procedure being called must be accessed </tspan><tspan y="-81.959145" x="45.118805 48.655804 54.343803 58.177803 63.631805 69.319809 74.917809 80.605812 83.189713 88.589714 91.173615 96.936317 102.63872 106.71572 112.31372 114.77072 118.30772 120.89162 125.57162 130.97162 133.42862 135.88562 138.46951 144.06752 149.46751 153.00452 158.35951 161.62651 164.27071 169.80571 175.49371 180.84871 183.4929 188.17291 193.52791 199.12592 207.87392 213.22891 218.91692 222.45392 225.03781 229.77811 235.1205 237.5775 242.9325 247.61249 251.14949 256.60349 260.4375 263.02139 267.70139 273.29938 278.65439 283.33438 285.79138 288.95038 291.40738 296.76239 302.36038 304.94427 310.54227 315.83881 318.4227 321.95789 327.64407 332.99728 335.64148 339.17667 344.57486 348.40707 354.00327 359.35648 362.89166 365.53586 370.98807 376.58426 381.93747 385.59958 390.99777 396.68396 402.32336 404.90726 407.36246 412.95865 418.31186 423.99805 427.53323 429.98843 433.14563 435.54233 440.94504 445.62503 448.20892 451.74411 457.4303 462.78351 465.4277 470.1059 475.50409 477.90079 480.35687 482.94077 488.58017 493.98376 497.51895 502.87216 506.17426 508.75815 514.29132 519.97754 525.33075 527.97498 531.51019 536.90839 540.7406 546.33679 551.69 555.22522">through a 64-bit call gate. The segment selector specified by the target operand identifies the call gate. The target </tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="509.68314pt" height="626.74261pt" viewBox="0 0 509.68314 626.74261" sodipodi:docname="245.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.48564" inkscape:cy="399.84104" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg212" /><g transform="translate(-46.135773,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-715.97998" x="46.02 51.4767 57.0774 62.435101 66.157494 71.560196 77.202293 82.802994 85.026886 89.709587 95.112289 100.80299 103.08718 107.76988 113.37058 118.77328 123.45329 125.84998 128.97389 134.29559 136.57979 140.11949 145.7616 151.16429 153.38818 158.07088 163.47357 165.93327 168.39297 170.67717 176.27786 181.68056 185.22026 190.57796 192.86215 197.54485 202.90254 208.50323 217.25394 222.65663 228.29874 231.83844 234.12263 238.80533 244.16302 246.62273 251.98042 256.66312 260.20282 265.65952 269.49622 271.78043 277.13812 279.59781 283.13751 288.82822 294.18591 298.02261 300.30682 305.90753 308.36722 312.20392 317.56161 322.24432 325.78403 328.24371 333.5654 335.84961 343.20532 345.6011 349.14081 354.83151 357.11572 362.51843 364.74234 370.34305 375.79974 378.19644 383.89795 387.43765 392.84036 396.67706 398.90097">operand can specify the call gate segment selector either directly with a pointer (</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-715.97998" x="402.78 408.3555 411.95551 415.767 421.52969 427.2222 431.2767 436.96921">ptr16:16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-715.97998" x="442.73999 444.9639 450.42511 454.2663"> or </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-715.97998" x="456.5397 462.13049 465.66028 469.48709 475.19489 480.95758 485.03638 490.74417">ptr16:32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-715.97998" x="496.43939 500.51819 502.8024 508.25821 512.09399 514.31793 516.77673 522.46655 528.06635 530.52515 534.36096 539.71777 544.3996 547.93842 550.39722 555.71802">) or indirectly </tspan><tspan y="-705" x="46.019104 53.336102 55.792198 59.334599 65.028 67.852196 73.257599 76.141197 84.8946 90.254997 99.0084 104.4678 108.30721 113.58931 116.47291 118.86961 124.32991 129.0153 134.4207 137.9631 140.42551 145.8849 151.57831 154.4025">with a memory location (</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-705" x="158.4588 167.2104 172.929 178.6476 182.7282 188.44679">m16:16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-705" x="194.1591 197.04271 202.50391 206.34511"> or </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-705" x="209.15941 217.90381 223.6152 229.3266 233.39999 239.16269">m16:32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-705" x="244.85971 248.93671 252.2037 255.0873 260.62228 266.31027 271.66528 274.54889 280.14688 283.9809 289.43491 294.1149 299.46991 304.1499 308.8299 314.28391 318.11792 321.00153 326.45554 332.05353 335.59052 340.99051 343.44751 349.1355 353.81549 356.63971 360.1767 365.86469 371.2197 374.1033 378.78329 384.13831 389.7363 398.48428 403.83929 409.52728 413.06427 415.94788 420.62787 425.98288 428.43988 433.79489 438.47488 442.01187 447.46588 451.2999 454.12411 457.28311 462.73712 466.57114 469.39536 472.93234 478.62033 483.97534 486.85895 492.54694 497.90195 505.25494 508.07916 512.75916 518.21313 523.81116 529.21387">). The processor obtains the segment selector for the new code </tspan><tspan y="-694.02002" x="46.02002 50.70182 56.05862 61.658421 70.408218 75.765015 81.454819 84.993622 87.69722 93.099022 98.788818 104.38862 107.03281 110.57162 116.26141 121.66411 124.3083 129.99811 135.3549 142.7097 145.3539 147.8127 153.5025 158.1843 161.7231 165.5589 171.2487 175.9305 179.4693 181.866 187.32629 193.0161 195.7197 201.31949 206.77528 209.23409 214.92389 218.46269 223.86539 227.70119 230.34538 234.42418 239.87997 243.04077 246.20157 250.88336 256.24017 259.77896 263.85776 266.50195 269.66275 273.49854 278.95435 287.70413 290.34833 293.88712 299.5769 304.93372 307.6373 313.3541 319.07089 323.10031 328.7037 334.02811 337.5705 342.93091 345.63452 350.31992 355.72531 358.18771 360.65012 363.29434 368.89774 374.30313 377.84552 383.20593 385.85016 391.45355 396.81396 401.49936 406.18475 410.02414 412.48654 418.08994 421.63232 427.09174 429.67383 432.91562 435.61923 439.70163 445.24203 450.93542 456.29584 458.94006 464.39948 467.56387 470.72827 475.41367 480.77408 484.31647 487.02008 490.18448 494.02386 499.48328 508.23666 510.94028 514.48267 520.12482 525.48523 528.12946 531.67188 537.07727 540.91669 546.52008 551.88049 555.42291">segment and the new instruction pointer (offset) from the 16-byte call gate descriptor. (The offset from the target </tspan><tspan y="-682.97974" x="46.02002 51.474922 57.073822 62.429722 66.152122 71.553024 77.241928 82.840828 85.665024 88.122925 92.803825 95.628021 98.085922 103.68482 109.37373 114.82863 118.66353 124.06623 129.66513 132.48933 139.84323 145.53214 150.88803 156.57693 159.40114 164.80203 167.68564 172.36655 177.76744 180.16414 182.62024 185.50385 191.10275 196.50365 200.04155 205.39745 208.28105 210.73895 215.41986 218.24406 223.93297 228.61386 233.96976 239.56866 242.83656 246.91446">operand is ignored when a call gate is used.) </tspan><tspan y="-667.02002" x="46.02002 53.09042 58.774818 61.239017 63.692417 69.376816 72.910217 78.31292 82.035316 86.11412 91.708519 95.538918 97.992317 103.30772 105.76112 108.15781 113.56052 119.14052 124.49192 128.56532 131.01872 136.37012 141.68552 147.03691 149.49031 151.89421 156.57062 161.96701 164.42041 166.87381 171.55022 174.81361 177.21751 180.75092 186.43532 191.83801 194.24191 199.83632 203.66672 209.11711 213.79352 219.14491 223.82132 228.49773 233.94812 237.77852 240.24272 244.91913 252.26852 254.72192 258.25531 262.9317 268.61609 273.9675 278.64389 281.10809 284.64148 290.04239 292.50659 296.03998 301.68033 307.03354 309.43744 314.11563 317.65082 323.04901 327.7272 333.0444 335.4483 338.6055 344.05771 347.88992 350.29382 353.82901 359.5152 364.86841 367.33261 372.9288 376.76102 379.21622 384.53342 386.98862 389.44382 394.79703 400.39322 405.74643 408.15033 410.60553 415.95874 421.27594 426.62915 429.08435 431.48825 436.94046 440.09766 442.50156 446.03674 451.72293 457.07614 459.48004 464.15823 469.55643 472.01163 474.46683 479.82004 485.41623 487.88043 493.47662 497.30884 502.76105 507.43924 512.79242 518.38861 524.07483 527.90704 533.30975 536.55157 539.01581 544.54901 550.23523 555.58844">On inter-privilege-level calls, the processor switches to the stack for the privilege level of the called procedure. The </tspan><tspan y="-655.97974" x="46.02002 50.70092 56.05682 61.65572 70.404617 75.760521 81.449425 84.987328 87.870926 92.551826 97.90773 100.36563 105.72153 110.40244 113.94034 119.39524 123.23014 126.11374 129.27364 134.72853 138.56343 141.44702 144.98492 150.62703 156.02972 158.85391 164.54282 169.89871 177.25261 180.0768 184.75769 188.29559 193.69649 198.37738 203.69728 206.58087 211.26178 216.61768 222.21658 230.96548 236.32138 242.01028 245.54819 248.37238 250.83028 255.51117 258.39478 263.07568 268.43158 271.96948 274.85309 278.39099 283.7919 286.67551 293.39941 299.97931 304.98422 309.90002 313.16882 315.99301 321.52982 327.2196 332.57642 335.4006 341.09039 346.4472 353.802 356.62619 361.30798 364.84677 370.24857 374.98886 380.30966 383.19324 388.79303 394.24884 396.70764 402.39743 405.99741 411.33981 415.1756 417.99979 420.45859 425.14038 427.96457 432.64636 438.24615 443.60297 448.28476 450.74356 453.90436 456.30017 461.70288 467.30267 470.12686 472.58566 478.27545 481.09964 484.63843 490.32822 495.73093 498.55511 504.01361 510.0769 516.22571 519.04993 522.21075 527.66656 531.50238 534.3266 537.86542 543.55524 548.91205">segment selector for the new stack segment is set to NULL. The new stack pointer is specified in the TSS for the </tspan><tspan y="-644.99976" x="46.02002 50.706322 56.400623 60.240925 64.081223 69.44252 75.136818 78.680115 81.07682 86.41832 89.242516 93.082817 98.777115 104.47141 110.16571 112.56242 118.25671 123.86102 126.68521 130.22852 135.63481 140.37511 145.65721 148.93051 151.75471 157.29602 162.99033 168.35162 171.17583 176.78012 180.50252 185.90881 191.60312 196.28941 201.93152 204.75572 208.29903 213.75932 216.58353 220.12683 225.82114 231.18243 234.00664 239.64874 245.05144 252.36844 255.19264 259.87894 265.33923 270.94354 276.30484 279.12906 283.81537 289.17667 294.78098 303.53528 308.89658 314.59088 318.13419 320.9584 326.4187 331.10501 335.79132 341.48563 345.32593 350.01224 352.83646 358.24277 361.40808 364.95139 370.31268 374.15298 376.9772 380.52051 386.21481 391.57611 394.40033 399.08664 402.62994 408.03625 412.72256 418.04785 420.87207 425.55838 432.91769 435.31439 438.8541 443.54041 449.23471 452.508 455.33221 459.41553 466.14484 471.60513 475.14844 480.50974 483.33395 486.87726 492.57156 497.97787 501.52118 504.3454 511.70471 517.3468 522.70813 528.3493 531.17346 536.86774 541.55402 544.01733 549.71161 555.31592">currently running task. The branch to the new code segment occurs after the stack switch. (Note that when using </tspan><tspan y="-634.01978" x="46.02002 51.42902 54.132618 58.821617 64.230614 66.696617 69.093323 71.796921 77.403923 82.81292 86.358917 91.722916 94.426514 97.972511 103.43551 106.13911 111.74611 117.11011 120.95311 124.12111 129.58411 133.42711 142.18411 144.88771 150.29671 153.00031 156.1683 161.5773 165.4203 168.0645 172.80479 178.20839 180.60509 183.06119 185.76479 189.31079 194.77379 197.47739 202.88638 205.58998 210.27898 215.64297 221.24997 229.95297 235.31697 240.95908 244.50508 247.20868 252.61768 256.21765 258.86188 262.46185 268.10394 273.46796 276.17157 280.86057 286.26956 294.97256 300.37527 303.07889 308.68588 312.35971 314.81311 320.12851 322.58191 325.03531 330.38672 335.98111 341.38382 344.0874 346.4841 351.88681 357.10861 362.45102 364.90442 368.16782 370.8714 376.26779 381.95218 384.65576 387.10916 395.85358 401.44797 403.90137 406.35477 411.03116 413.48456 417.01794 419.72153 424.39792 427.9313 433.3277 438.00409 443.31949 446.02307 450.69946 458.04886 460.50226 464.03564 468.71204 474.39642 477.10001 482.50092 487.18091 491.9212 497.56329 501.39371 506.0701 508.77368 514.1701 518.8465 521.55011 526.94653 529.65015 533.48053 538.88318 543.55957 549.24396 551.69739 555.23077">a call gate to perform a far call to a segment at the same privilege level, an implicit stack switch occurs as a result </tspan><tspan y="-622.97949" x="46.02002 51.46862 54.622219 57.505817 62.855415 68.538017 72.069618 77.41922 81.247818 83.699417 89.382019 94.974617 97.858223 103.56783 109.27743 113.34903 118.94163 121.39323 124.92483 127.80843 136.55104 141.99963 147.63904 152.98143 156.24303 159.12662 164.65622 170.33882 175.68842 178.57201 184.63531 190.75891 193.6425 198.31711 203.6667 206.1183 211.4679 216.1425 219.6741 225.1227 228.95129 231.77548 234.22708 238.90169 241.78528 247.46788 253.15048 257.82507 263.50766 268.90225 274.58484 280.17743 285.52704 291.16644 294.35971 297.24332 302.83951 308.5257 312.06088 314.8851 319.56329 323.09848 328.49667 333.23697 338.55417 341.43777 346.11597 351.46918 357.06537 365.81158 371.16479 376.85098 380.38617 383.26978 388.66797 393.34616 398.02435 403.37756 408.05576 412.73395 418.08716 422.76535 425.64896 431.33514 436.01334 441.36655 444.19077 449.65466 452.47888 457.15707 462.51028 468.10648 476.85266 482.25537 487.89746 491.43265 494.31625 499.91245 505.31064 509.98883 515.39154 518.21576 523.66797 526.8252 529.64941 535.36261 540.67981 546.39301 549.6582">of entering 64-bit mode. The SS selector is unchanged, but stack segment accesses use a segment base of 0x0, </tspan><tspan y="-611.99951" x="46.02002 49.56152 55.254021 60.613522 63.437725 65.899223 68.360725 77.113228 79.509933 83.049637 85.933235 88.394737 93.079239 95.903435 98.364937 103.96744 109.65993 115.11844 118.95694 124.31644 129.91893 133.19043 136.01463 141.41913 147.11163 152.71413 155.53833 159.07983 164.77234 170.13184 173.01544 178.61794 183.97743 187.14093 192.54543 198.23793 200.69943 204.24094 207.06514 211.74963 215.29114 220.69563 225.38013 230.70363 233.52783 238.21233 240.67383 245.39433 250.75383 253.63744 256.03415 260.71417 263.59778 269.31729 275.0368 279.11832 284.72083 287.11752 290.65903 295.34354 298.61505 301.32031 306.8985 312.60001 317.9487 320.77292 323.92563 329.60733 332.05804 334.45477 337.33838 342.44049 347.90439 350.30112 356.00262 361.35132 364.23492 369.68262 372.83533 375.71893 381.95865 388.09933 393.55875 396.38297 398.83368 403.50739 406.39099 412.07269 416.7464 422.14908 427.7291 430.55331 433.70602 439.15372 442.98141 445.86502 449.39572 455.07742 460.4801 463.30432 468.75201 471.90472 475.05743 479.79773 485.14642 488.67712 491.93784 494.82144 500.26913 503.42184 506.30545 513.65216 519.33386 521.78455 526.45825 532.13995 534.96417 538.49487 544.17657 549.52527">the limit is ignored, and the default stack size is 64-bits. The full value of RSP is used for the offset, of which the </tspan><tspan y="-601.01953" x="46.02002 51.69902 57.288021 62.877022 68.279724 72.104721 74.988319 80.694321 86.400322 90.468323 96.107727 98.563828 102.09183 106.76283 109.58702 114.97802 118.80302 124.14902 127.03262 132.71161 138.39061 144.03001 149.37241 152.5224 154.9704 160.6494 166.05209 171.6411 174.89909 178.96709 181.85068 188.91568 194.59468 197.41887 200.94687 206.62587 211.97186 214.85545 220.53445 225.88045 233.22444 236.10803 240.77904 244.30704 249.69804 254.36905 259.67905 262.93704 265.82065 269.34866 275.02765 280.43036 283.25458 288.84357 292.66858 298.11359 302.81973 308.22244 312.90335 317.58426 323.03915 326.87405 329.69827 335.29718 340.98608 345.66699 351.3559 356.71179 361.3927 364.27631 367.81421 373.50311 378.85901 381.68323 386.42352 391.76593 397.36484 406.11374 411.46964 417.15854 420.69644 423.52066 428.20157 433.60428 436.06216 441.41806 446.09897 449.63687 455.09177 458.92667 461.75089 467.15179 472.8407 478.43961 481.32321 486.00412 489.54202 494.94293 499.62384 504.94373 507.76794 513.36682 518.82172 521.2796 526.96851 530.50641 535.8623 539.6972 542.58081 545.74072 551.19562 555.03052">upper 32-bits are undefined.) On the new stack, the processor pushes the segment selector and stack pointer for </tspan><tspan y="-589.97925" x="46.02002 49.558819 55.248619 60.605419 63.430519 68.11232 73.514122 75.972923 78.431725 80.890526 86.580322 92.180122 95.005219 100.60502 104.44082 109.84172 114.58202 119.93883 125.53863 131.22842 135.06422 140.42102 142.52522 147.20702 150.09152 154.77332 158.31212 163.71391 168.39571 173.71651 176.54161 181.94341 187.63321 193.233 196.11751 199.65631 205.34612 210.70291 213.52802 218.20981 223.6125 229.21231 237.96211 243.31891 249.00871 252.54752 255.37262 260.05441 265.45712 267.85382 273.25653 277.93832 281.47711 286.93292 290.76871 293.59381 298.99561 304.68539 310.28519 313.16968 315.56638 321.26785 325.94965 329.48843 333.32422 339.01401 343.6958 347.23459 349.69339 355.1492 360.83899 363.66409 369.26389 374.7197 377.1785 382.86829 386.40707 391.76389 395.59967 398.48416 401.64496 407.10077 410.93655 413.82104 417.35983 423.04962 428.40643 431.23154 435.91333 441.31512 443.77393 446.23273 448.69153 454.38132 459.98111 462.80621 468.40601 472.24179 477.6427 482.32269 487.7254 493.30539 498.99518 502.83096 508.18777 510.29196 514.97375 517.85828 522.5401 527.99591 533.5957 538.95251">the calling procedure’s stack and the segment selector and instruction pointer for the calling procedure’s code </tspan><tspan y="-578.99927" x="46.02002 50.698219 56.051418 61.647617 70.393814 75.747017 81.43322 84.968422 88.270523 90.914726 94.989929 100.14963 105.54783 109.27023 114.66843 123.41463 128.76782 132.30302 137.65622 141.48842 144.13261 148.81082 154.26302 159.85922 165.17642 167.82062 170.27582 174.95403 177.59822 183.28442 188.73662 192.27182 194.91602 199.59422 205.28043 210.87663 216.47284 221.92503 225.75723 229.29243 234.69513 240.27513 242.91933 245.37453 251.06073 253.70493 257.48312 263.42673 267.50192 273.21512 278.97781 284.32022 286.96442 295.71063 301.16284 306.75903 311.99973 315.26764 319.34555 321.98978 327.15668 329.55338 335.24228 340.64319 343.10107 345.55896 350.06073 353.32864 355.97287 359.51077 365.19968 370.55557 373.1998 378.79871 382.63361 388.0885 392.76941 398.17212 402.85303 407.53394 412.98883 416.82373 419.40765 425.00656 428.66867 434.06958 439.75848 444.43939 450.1283 455.48419 460.1651 462.80933 466.34723 471.80212 474.44635 477.98425 483.67316 489.02905 491.67328 497.07419 502.6731 508.272 512.10693 517.50964 522.19055 526.87146 529.51569 534.97058 538.13049 540.77472 544.31262 550.00153 555.35742">segment. (Parameter copy is not supported in IA-32e mode.) Finally, the processor branches to the address of the </tspan><tspan y="-568.01929" x="46.02002 51.609921 55.435822 60.881721 65.553619 70.90052 76.539917 82.219818 86.045715 91.448418 94.272614 99.862511 105.26521 107.71411 113.39401 119.03341 121.8576 126.5295 131.9214 134.3703 136.8192 142.16609 147.756 150.63959 157.98448 160.43338 163.96228 169.64218 172.09108 177.77098 180.65457 184.18347 189.86337 195.21027 198.03445 203.71436 209.11705 216.46194 219.34554 224.01744 229.46335 235.05325 240.40015 243.28374 247.95564 253.30254 258.89243 267.63232 272.97922 278.65912 282.18802">procedure being called within the new code segment.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c1AE6E0A5"><tspan y="-551.99927" x="46.02002 52.506321 57.498623 62.536823 66.01532 68.505623 71.490921 76.978218 81.97052 85.459824 88.445122 90.546623 97.032921 102.07112 104.56142 107.05173 112.04403 114.14553 116.63583 122.12313 124.22463 129.26283 134.24162 137.22693 142.71423 145.20453 148.18983 150.29134 157.77664 163.26395 168.75125 173.74355">Near/(Far) Calls in 64-bit Mode.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-551.99927" x="176.27972 178.92392 187.81322 193.49852 198.85081 204.53612 207.23972 210.77402 216.45932 221.86201 224.50621 230.10152 233.93282 239.38411 244.06142 249.46411 254.14142 258.81873 264.27002 268.10132 270.80493 273.25925 277.93655 280.58078 286.03207 291.62738 296.97968 300.70209 306.0994 309.6337 312.08801 317.77332 323.41272 326.05695 328.51126 334.19656 336.84079 342.5531 348.26541 352.33972 357.97913 360.43524 363.96954 366.61377 375.35907 380.81036 386.40567 391.75797 395.06009 397.70432 401.23862 406.92392 412.27621 414.92044 421.19073 427.33502 432.37863 437.36194 440.06555 442.46228 448.16379 452.84109 456.3754 460.2067 465.892 470.56931 474.10361 476.55792 482.00922 487.69452 490.33875 495.01605 500.41336 506.09866 508.74289 514.38232 519.72473 522.36896 528.05426 532.73157 538.08386 543.72327 546.36749 549.90179 555.35309"> When the processor is operating in 64-bit mode, the CALL instruction can be used to </tspan><tspan y="-541.01929" x="46.02002 51.617119 56.971218 60.804317 63.962418 69.41552 73.248619 81.99572 84.819923 88.356026 94.043129 99.397232 102.28083 105.43893 110.89204 113.34814 115.80424 121.25734 128.60944 131.06554 136.75264 142.34975 145.23334 148.71274 154.05424 159.65135 165.00545 169.68454 172.56813 178.02122 181.17932 184.06291 187.22101 192.6201 196.4532 199.27739 203.95648 209.35558 211.81168 214.26778 218.94687">perform the following types of far calls:</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-525.96002" x="46.02">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-525.96002" x="63 67.743004 73.146606 76.980606 79.804802 84.484802 89.884804 92.341805 94.798805 97.623009 101.16001 106.61401 109.49761 113.03461 118.72262 124.07762 126.90182 131.58182 136.98181 145.72981 151.08481 153.96841 159.56642 163.40042 165.85742 171.17642 173.57312 176.02922 181.38422 186.98222 192.33722 195.16142 197.61842 202.97342 208.29242 213.64742 216.10442 219.37141 222.25502 225.79202 229.45412 234.85411 240.54211 245.22211 247.67911 251.21611 253.67311 259.07401 264.77548 267.23248 272.92047 278.51846 281.40204 284.93903 290.39304 293.21722 297.89722 303.35123 312.09921 317.6972 323.0972 326.63419 329.09119 334.68918 337.14618 339.60318 341.99988 345.53687 350.85587 353.73944 362.48743 367.88834 373.48633">Far call to the same privilege level, transitioning to compatibility mode</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-510.95999" x="46.02">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-510.95999" x="63 67.743004 73.146606 76.979706 79.803902 84.483002 89.882103 92.338203 94.794304 97.618507 101.15461 106.60771 109.49131 113.02741 118.71452 124.06862 126.89281 131.57191 136.97101 145.71811 151.0722 153.9558 159.5529 163.386 165.8421 171.1602 173.5569 176.013 181.3671 186.9642 192.3183 195.14249 197.59859 202.95268 208.27078 213.62488 216.08098 219.34708 222.23067 226.06377 231.41786 240.16496 245.56406 248.02016 253.70726 256.16336 261.85046 267.44757 270.33118 272.72787 278.42938 281.31299 287.0271 292.74121 296.81732 302.41443 304.81113 308.34723 311.23083 319.97794 325.43103 331.02814">Far call to the same privilege level, remaining in 64-bit mode</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-495.95999" x="46.02">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-495.95999" x="63 67.743004 73.146606 76.983307 79.807503 84.490204 89.892906 92.352608 94.812309 97.636505 101.17621 106.63291 109.51651 114.91921 117.74341 123.34411 125.74081 128.90251 132.06421 137.42191 141.25861 146.6163 152.30701 155.84671 158.73032 164.33102 168.16772 170.62743 175.94913 178.40883 180.86853 186.22623 191.82693 197.22963 200.05383 202.51353 207.87123 213.09303 218.49573 220.95543 223.77963 227.85933 230.31903 236.00974 239.54944 244.90714 248.62953 252.70923 258.30994 262.14664 264.48029 269.80017 272.25806 274.71594 280.07184 285.67075 291.02664 293.91025 296.36813 301.72403 306.94583 312.28824 314.74612 317.62973 322.31064 327.71155 330.16943 332.56613 336.64404 339.91196 342.73618 346.57108 351.92697 360.67587 366.07678 368.53467 374.22357 376.68146 382.37036 387.96927 390.79349 393.25137 398.94028 401.7645 407.48041 413.24313 417.32104 422.91995 425.37784 428.91574 431.73996 440.48886 445.94376 451.54266">Far call to a different privilege level (inter-privilege level call), remaining in 64-bit mode</tspan><tspan y="-480.00031" x="46.020584 52.745384 58.201183 61.739983 67.096786 69.981285 73.520088 79.162186 84.563988 88.102791 90.987289 93.446091 99.088196 101.97269 105.5115 111.20129 113.59799 118.33829 121.16339 129.91319 135.36899 140.96878 146.32558 149.21008 152.74889 158.43869 163.79549 166.62059 172.89539 179.04419 184.04999 189.05579 191.94029 194.33699 200.0385 204.72029 208.25909 212.09489 217.7847 222.46649 226.00529 228.4641 233.91989 239.6097 242.4348 247.11659 252.51839 258.20819 261.03329 266.72308 272.17889 275.71768 278.60217 284.20197 289.55878 292.44327 298.08536 302.82565 308.18246 313.78226 316.66675 320.20554 325.66135 328.48645 333.16824 338.57004 344.25983 348.94162 354.29843 357.18292 362.58472 365.40982 368.94861 374.3504 379.0322 384.353 387.1781 391.85989 399.21469 401.67349 405.21228 409.89407 415.58386 418.40897 420.86777 426.55756 429.38266 435.09946 440.86215 444.94095 450.54074 452.99954 456.53833 459.36343 468.11322 473.56903 479.16882 484.52563 487.41013 492.09192 494.55072 500.19281 504.93311 510.28992 513.11505 516.65387 522.05566 526.73749 532.05829">Note that in this mode the CALL instruction can not be used to cause a task switch in 64-bit mode since task </tspan><tspan y="-468.95999" x="46.020584 50.700584 58.053585 60.510586 64.047585 68.727585 74.415588 79.770592 84.450592 87.33419 92.734192 96.568192 101.92319 104.7474 110.4354 115.8894 119.42641 122.31001 126.99001 132.67801 138.27602 143.87402 149.32802 153.16202 156.69902 162.05402 167.65202 170.47623 172.93323 178.62123 181.44543 185.22543 191.16904 195.24603 200.96103 206.72372 212.06612 214.89032 223.63832 229.09232 234.69032 240.09302">switches are not supported in IA-32e mode.</tspan><tspan y="-453.00031" x="46.020584 49.801487 55.502987 57.726887 63.463486 69.165886 73.24469 78.824692 81.280792 84.820496 87.044395 95.813995 101.2896 106.8696 112.2723 115.5141 117.7983 121.3569 127.06651 132.40891 134.69312 140.27312 144.11522 149.59082 154.27081 159.61322 164.29321 168.97321 174.4335 178.28911 180.57332 185.99492 188.39163 195.64833 200.99164 206.33224 211.01224 213.29645 218.93854 223.61853 228.99513 233.67513 235.89903 239.45763 245.16722 250.54382 252.76773 257.44772 262.7901 268.4097 277.1127 282.48929 288.19888 291.75748 293.98138 298.66138 304.06406 306.46075 311.76086 316.44537 319.98688 325.44537 329.28387 331.50778 337.11029 342.5148 346.3533 349.89481 352.17902 357.63751 360.80103 363.02493 366.56644 372.25894 377.61844 379.90265 383.06616 388.47067 392.30917 394.53308 399.93759 405.5401 411.14261 414.98111 420.34061 425.02512 429.70963 431.99384 435.53534 440.99384 443.21774 448.62225 453.30676 457.99127 463.39398 468.07849 472.763 474.98691 478.52841 484.22092 489.62363 491.84753 496.53204 501.99054 505.82904 509.66754 515.02704 519.71155 525.31403 530.77252 536.41461 542.01709 544.47858 550.12067 555.76007">In 64-bit mode, the processor always uses the segment selector part of the far address to access the corresponding </tspan><tspan y="-441.95999" x="46.020569 51.617668 56.971767 61.650867 66.329971 70.163071 72.619171 78.21627 81.752373 87.153275 90.986374 93.869972 96.326073 101.96818 104.85178 108.38789 114.07499 119.42909 122.25329 129.26968 135.93419 141.46829 144.29248 149.74557 153.57867 156.46227 161.46536 168.19017 172.44807 175.68987 178.57346 184.10756 189.79466 195.14876 198.03235 203.62946 208.98355 213.66266 218.34177 222.17487 224.63097 230.22807 233.76418 239.21727 243.05037 245.93396 249.41336 254.75487 260.35196 265.70605 268.58966 272.66577 277.34488 282.79797 288.39508 293.74918 296.63278 301.31189 306.60028 312.20187 320.95346 326.31207 332.00366 335.54425 338.81485 341.63904 346.32263 351.72623 354.18683 356.64743 359.47162 365.07321 370.47681 374.0174 379.37601 383.4566 386.28079 391.68439 397.37598 402.97757 405.80176 411.20535 415.88895 420.57254 425.93115 430.67145 435.35144 438.17563 442.01321 444.47382 450.07541 455.767 459.30759 463.99118 466.81537 472.41696 477.77557 481.31616 486.67477 490.51236 499.26395 501.72455 507.41614 512.77472 515.59894 519.13953 524.83112 530.1897 533.0733 536.55267 541.89417 547.49579 552.85437">descriptor in the GDT or LDT. The descriptor type (code segment, call gate) and access rights determine the type </tspan><tspan y="-430.97998" x="46.020569 51.478168 54.64077 57.524372 62.207973 67.611572 70.072174 72.468872 75.35247 80.810074 86.411674 91.770271 95.492676 100.89628 104.43688 106.83358 112.29388 117.98548 120.86908 124.40968 129.86728 132.69147 138.29306 143.65166 146.47585 152.07745 157.43605 161.27365 164.43625 169.89384 173.73145 182.48305 187.84164 193.44324">of call operation to be performed.</tspan><tspan y="-414.95999" x="46.020569 49.802368 52.963169 55.787369 59.326168 65.015968 70.372772 73.256371 77.938171 83.294968 85.753769 91.110565 95.792366 99.331169 104.68797 110.28777 113.11197 118.71177 124.11447 128.79626 133.47806 137.31386 139.71056 145.34996 148.88876 154.34456 158.18036 161.00456 163.46336 168.14516 170.96936 174.13016 179.58595 183.42175 186.24596 191.70985 194.53406 199.21585 204.67165 210.27145 215.67415 218.49835 223.18015 228.53694 234.13675 242.88655 248.28925 253.93135 257.53134 260.77313 263.59732 269.06122 271.88541 275.0462 280.448 284.28378 287.04059 291.71518 297.10977 299.56137 302.01297 304.83716 308.36874 313.81735 316.70093 322.09552 324.91971 329.5943 335.04291 340.6355 346.03821 348.8624 353.53699 358.8866 364.47919 373.2218 378.62451 384.32599 387.85757 390.68176 396.07635 399.60794 402.49152 406.0231 411.70569 417.1084 419.93259 424.60718 430.00177 438.74438 444.09399 446.97757 452.57016 456.39877 458.85037 464.16397 466.61557 469.06717 474.41678 480.00937 485.41208 488.23627 490.68787 496.03748 501.35107 506.70068 509.15228 511.9765 514.4281 519.10272">If the selected descriptor is for a code segment, a far call to a code segment at the same privilege level is </tspan><tspan y="-403.97998" x="46.020584 51.618584 56.973583 60.807583 63.966583 69.420586 73.254585 82.002586 87.35759 92.955589 96.25769 98.841583 102.91859 106.69859 109.85759 112.44148 115.97849 121.66649 127.02149 129.6657 134.3457 139.7007 142.1577 147.5127 152.19269 155.72969 161.08469 166.72409 169.30798 173.98798 179.44197 185.03998 190.39497 193.03917 197.71918 203.07417 208.67218 217.42018 222.77518 228.46318 232.00018 234.58408 237.04108 241.72107 244.36526 249.76526 253.30226 255.88617 261.28616 263.87006 269.46805 271.92505 275.08405 278.24304 283.59805 287.43207 292.78708 298.47507 301.92029 304.50418 310.10397 313.93976 316.33646 321.67795 324.13675 326.59555 331.95236 337.55215 342.90897 345.55316 347.94986 353.35257 358.57437 363.91678 366.37558 368.95947 374.36127 380.05106 385.65085 388.29504 391.83383 397.52362 402.88043 405.46432 410.14612 415.60193 421.20172 426.60443 429.18832 433.87012 439.22693 444.82672 453.57651 458.97922 464.62131 468.1601 470.80429 473.26309 477.94489 480.52878 486.21857 491.67438 497.36417 501.44296 506.12476 511.58057 517.27039 520.43121 525.88702 529.72284 538.47266 540.86938 546.5592 552.159 555.4278">performed. (If the selected code segment is at a different privilege level and the code segment is non-conforming, </tspan><tspan y="-392.99997" x="46.020584 51.417885 54.062084 59.657387 65.060089 70.745392 76.148094 79.810196 85.213799 87.668098 91.742401 97.3377 101.169 106.6203 110.1546 115.5069 120.1842 123.71851 126.17281 131.6241 137.3094 139.9536 145.30589 150.62219 155.2995 160.65179 166.2471 169.7814 172.2357 177.687 183.3723 186.01649 188.47079 193.1481 195.7923 201.3876 206.7903 212.4756 217.8783 221.54039 226.94398 230.47829 235.83058 241.42589 244.69019 248.76448 251.40868 257.55298 260.1972 263.35352 268.75082 272.58212 275.22635 279.90366 285.30096 287.75528 290.20959 292.85382 296.38812 301.83942 304.48364 308.01794 313.6806 319.03021 321.7338 326.40839 331.80298 340.54559 345.9483 348.5925 354.18509 358.0137 360.4653 365.7789 368.1756 370.63168 375.98129 381.57388 386.92349 389.56769 392.01929 397.3689 402.6825 408.0321 410.4837 413.1279 415.5795 421.26208 423.96567 429.67526 435.38486 439.45645 445.04904 447.44485 450.97644 453.68002 462.42264 467.87125 473.46384 478.81345 481.45764 483.90924 488.58383 491.22803 496.54163 501.89124 505.71985 511.03345 513.73706 518.41168 520.86328 529.6059 532.0575 534.50909 539.90369 543.7323 546.37653 549.90814 555.35675">a general-protection exception is generated.) A far call to the same privilege level in 64-bit mode is very similar to </tspan><tspan y="-381.95966" x="46.020599 51.479099 57.1716 62.531101 65.355301 70.039803 75.444305 79.282806 83.121307 85.582809 90.942307 96.544807 99.369003 104.82751 110.52 114.06151 116.8857 119.34721 125.0397 127.8639 132.5484 138.0069 146.7594 152.36189 157.76639 161.30789 163.76939 169.37189 171.83339 174.29489 176.75639 180.23579 185.5593 188.3835 197.136 202.5945 208.19699 213.55649 216.82799 219.65219 225.1917 230.8842 236.2869 239.1111 242.6526 248.0571 251.8956 257.49811 262.8576 266.39911 269.22333 274.68182 280.28433 285.64383 289.30594 294.71045 300.40295 306.00546 308.82062 313.49973 319.09683 324.45093 329.13004 331.58612 334.74423 337.20032 342.55441 347.23352 350.05774 355.45685 361.14395 364.02756 369.42667 375.02377 379.70288 385.15598 387.61206 393.29916 396.83527 402.18936 405.01358 408.17169 413.5708 417.4039 420.28751 425.68661 431.28372 436.88083 440.71393 446.06802 450.74713 455.48743 458.31165 460.76773 466.45483 472.05194 474.50803 478.34113 483.69522 488.37433 491.91043 494.36652 499.68463 502.56824 509.92035 512.37646 515.91254 521.59961 524.42377 529.82288">one carried out in compatibility mode. The target operand specifies an absolute far address indirectly with a </tspan><tspan y="-370.97964" x="46.020599 54.775799 60.138 68.893204 74.294098 78.1353 83.461502 86.3451 88.741806 94.202103 98.889305 104.29651 107.84071 110.30491 115.76611 121.46131 124.28551">memory location (</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-370.97964" x="128.3409 137.0835 142.79309 148.55579 152.63458 158.34418 164.05377 167.35587 170.18005 178.92265 184.63225 190.34184 194.41344 200.17613">m16:16, m16:32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-370.97964" x="205.8606 208.6848 214.146 217.9872"> or </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-370.97964" x="220.8609 229.6026 235.31129 241.01999 245.09068 250.79938">m16:64</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-370.97964" x="256.56122 260.64001 263.90881 266.79242 272.32922 278.01901 283.37582 286.20004 289.36084 294.81665 298.65244 307.40222 310.22644 315.68225 318.84305 321.66727 327.94208 334.09088 339.09668 344.10248 346.98608 354.34088 356.79968 360.33847 366.02826 368.85248 374.25427 377.13788 382.73767 385.19647 389.03226 394.38907 399.07086 402.60965 405.49326 410.17505 415.77484 421.13165 425.81345 428.27225 431.43304 433.89185 438.57364 443.97543 447.51422 449.91003 455.37033 461.06012 463.94373 469.34464 472.52884 475.41245 480.81424 486.41403 491.09583 496.55164 499.01044 504.70023 508.23901 513.59583 516.42004 519.58087 524.98267 528.81848">). The form of CALL with a direct specification of absolute far </tspan><tspan y="-359.99963" x="46.02153 51.41703 57.010529 62.604027 66.433525 71.836227 76.511726 81.187225 84.011429 86.463928 91.139427 93.963631 99.647133 105.09663 108.62914 111.51274 117.10624 122.45674 125.61124 128.06375 133.74725 139.09775 144.69125 147.57484 150.02734 155.71085 158.59444 164.30493 170.01543 174.08792 179.72733 182.12402 185.65652 188.54012 197.28362 202.73311 208.37251 213.7149 217.017 219.84119 225.37169 231.05519 236.40569 239.28928 244.73877 250.33228 255.68277 259.40518 264.80069 270.48419 276.0777 280.15021 284.82571 287.27823 291.89432 297.297 300.12122 305.51672 309.04922 312.58173 316.38153 318.83224 324.42395 330.10565 333.63635 338.98505 341.86865 347.46036 352.80905 356.33975 361.74243 365.57013 374.31183 376.76254 382.44424 387.79294 392.46664 395.35025 398.88095 404.56265 409.91135 412.73557 417.40927 419.85999 424.56967 429.91837 432.80197 438.24966 441.40237 444.28598 447.81668 453.49838 458.84708 461.6713 467.11899 470.2717 473.42441 478.09811 483.44681 486.97751 489.80173 493.87244 499.63513 505.34384 508.64597 511.47018 517.17889 522.94159 526.20227 529.08588 534.53357 538.36127 541.24487 546.95355 552.66223">address is not defined in 64-bit mode. The operand-size attribute determines the size of the offset (16, 32, or 64 </tspan><tspan y="-348.95932" x="46.021515 51.617714 54.072914 57.608116 62.286316 66.361519 68.645721 71.100922 76.787125 79.071327 82.606529 88.248634 93.651337 95.935539 99.092743 104.49094 108.32314 110.60735 116.00555 121.60175 127.19794 131.03015 136.43285 141.11105 145.78926 149.05446 151.33865 156.87186 162.55806 167.96075 170.24495 175.88705 181.28975 188.64095 190.92514 195.60335 201.05554 206.65175 212.00494 214.28914 218.96735 224.32054 229.91675 238.66295 244.06564 249.70775 253.24295 255.58655 260.26474 265.61795 268.07315 273.42636 278.10455 281.63974 287.09195 290.92416 293.20837 298.60657 304.29276 309.88895 312.12183 314.57883 318.11581 322.79581 325.08002 330.67801 336.08072 340.76071 345.4407 349.27472 351.67142 357.31082 360.84781 366.30182 370.13583 372.42004 377.82004 381.65405 387.00906 389.29327 391.75027 397.20428 402.60428 408.20227 413.55728 419.19669 421.4809 423.87759 429.57907 433.11606 438.57007 440.85428 444.39127 450.07925 455.43427 457.71848 463.99149 470.17538 472.45959 476.29361 481.64862 487.24661 489.70361 494.38361 497.92059 503.2756 507.10962 511.18661 513.47083 517.00781 522.6958 528.05078 530.33496 535.78894 538.94794 542.10693 546.78693 552.14191 555.67889">bits) in the far address. The new code segment selector and its descriptor are loaded into the CS register; the offset </tspan><tspan y="-337.97931" x="46.021515 49.185913 52.967716 58.427116 67.180519 70.064117 73.606514 79.248611 84.651306 87.475502 89.937904 95.631302 100.3167 103.8591 107.6985 113.3919 118.0773 121.6197 124.0164 129.4767 135.1701 138.05371 140.45041 145.1304 148.01401 150.47641 155.93581 161.3412 166.9446 172.30499 177.90839 180.79199 183.25439 188.8965 192.49651 197.8974 200.78101 204.32341 210.01682 215.37721 218.20142 223.88582 227.67122 233.09462 235.91882 239.75822 245.11862 250.72202 253.11871 257.80411 261.3465 266.74921 269.271 272.5434 275.36758 280.90799 286.55008 291.95279 294.77698 300.47037 305.83078 313.18918 316.01337 320.69876 326.15817 331.76157 337.12198 339.94617 344.63156 350.03427 355.63766 364.39105 369.75146 375.44485 378.98724 381.81143 390.56482 395.90811 401.23251 404.11609 408.80148 414.40488 419.80759 424.48758 426.88428 430.00818 435.33258 438.21616 443.57657 449.26996 452.81235 456.65173 461.97614 464.85971 470.22012 472.68253 476.22491 481.9183 487.27872 491.1181 493.94229 496.40469 502.09808 505.64047 511.09988 513.92407 518.6095 524.06891 532.82233 538.42572 543.83112 547.37354 549.83594">from the instruction is loaded into the EIP register. The new code segment may specify entry either into compati-</tspan><tspan y="-326.9993" x="46.021515 51.611416 54.060318 56.509216 58.958115 62.487015 67.797913 70.681519 76.127419 79.953316 82.777519 88.484421 94.247124 98.316025 103.90592 106.35482 109.88372 112.70792 121.44782 126.89372 132.48363 137.83052 141.13261 143.9568 149.59621 154.99982 159.67172 165.01862 170.60852 173.49211 178.93802 184.61792 187.44211 190.97101 196.65091 201.9978 204.88139 209.87729 212.76088 218.35078 220.79968 224.32858 227.15277 232.31427 237.71788 240.16678 245.84668 251.24937">bility or 64-bit mode, based on the L bit value.</tspan><tspan y="-310.97931" x="46.021515 52.164017 54.747917 60.510616 66.213013 70.285515 75.879013 78.331512 81.864014 84.447914 89.123413 94.518913 96.971413 99.423912 102.00781 107.60131 112.99681 116.52931 121.87981 124.46371 128.53621 134.12971 139.48021 144.15572 148.83122 152.66072 155.11322 160.70673 166.05722 171.65073 174.23462 176.68712 182.37062 184.95451 188.48701 194.17052 199.57321 202.1571 207.84061 213.2433 218.5578 222.0903 224.7345 230.328 235.72351 239.3856 244.7892 250.38271 254.1051 259.50061 265.09412 270.77762 274.85013 277.43405 282.10956 287.50507 293.18857 295.77249 301.168 303.62051 308.29602 313.74182 316.32574 321.92285 327.27695 329.86087 335.54797 340.22708 345.62979 351.20889 353.79282 357.32892 362.78201 365.36594 370.96304 376.36575 380.19885 383.35696 388.81006 392.64316 401.39026 403.97418 409.37329 411.95721 415.11533 420.51443 424.34753 426.93146 431.61057 437.00967 439.46576 441.92184 444.56607 448.10217 453.55527 456.13919 461.5383 464.12222 468.80133 474.25443 479.85153 485.20563 487.78955 492.46866 497.87137 503.46848 512.21558 517.5697 523.25677 526.79285 529.37671 534.77582 538.31189 540.89575 544.43182 550.1189 555.47302">A 64-bit call gate (described in the next paragraph) can also be used to perform a far call to a code segment at the </tspan><tspan y="-299.9993" x="46.021515 50.700615 56.099716 64.846817 70.20092 73.025124 78.622223 82.455322 84.85202 90.19352 92.64962 95.105721 100.45982 106.05692 111.41103 114.29462 116.75072 122.10483 127.32663 132.72932 135.12602 138.42812 141.25232 148.00142 153.45451 160.80661 166.16071 171.47881 176.8329 179.41499 182.65678 185.54039 191.22749 195.90659 198.30328 204.00479 209.6019 212.4261 215.9622 221.64931 224.10541 228.78452 231.60872 240.35582 245.70992 250.38901 256.07611 261.47522 267.16232 269.61841 274.29752 283.04462 285.92822 289.76132 295.11542 300.71252 306.36182 308.8179 312.651 318.0051 322.6842 325.56693 329.10303 334.79013 340.18924 343.72534 346.54868 350.08478 355.77188 361.12598 364.0087 367.5448 372.94391 376.77701 382.37411 387.72821 391.26431 394.14703 398.82614 404.27924 409.87634 415.23044 418.11316 422.79227 428.14636 433.74347 442.49057 447.84467 453.53177 457.06787 459.95059 465.5477 470.90179 475.5809 480.26001 484.09311 486.54919 492.1463 495.6824 501.1355 504.9686 507.85132 513.53839 518.82141 524.13953 529.49365 532.31696 535.85303 541.5401 546.89423 549.71753 554.72064">same privilege level. However, using this mechanism requires that the target code segment descriptor have the L </tspan><tspan y="-288.95898" x="46.021515 51.624016 54.085518 57.627018 60.451221 65.135719 70.495216 74.03672">bit set.</tspan><tspan y="-272.9993" x="46.021515 54.914413 60.603313 65.959213 71.648117 74.052017 79.407921 84.629723 90.032425 94.712425 100.35453 103.89423 106.35213 112.04104 117.63994 120.10414 125.50504 131.14714 133.61134 136.00804 141.70955 145.24745 150.60335 154.38515 158.46394 164.06285 167.89775 170.35565 175.67555 178.07225 180.52835 185.88425 191.48315 196.83905 200.91695 203.37485 208.73074 213.95255 219.35524 221.75194 224.21614 227.37604 232.77693 236.61183 239.07603 243.75693 249.15782 251.55452 254.01062 257.27853 259.68243 263.22034 268.90924 274.26514 276.66904 281.34995 286.80484 292.40375 297.75964 300.16354 304.84445 310.20035 315.79926 324.54816 329.95087 335.65237 339.19028 341.59418 344.75409 350.155 353.9899 356.4541 359.992 365.63409 371.0368 373.4407 379.03961 382.87451 388.32941 393.01031 398.41302 403.99304 409.68195 413.51685 418.87274 421.27664 426.87555 432.27826 434.67496 440.37646 445.97537 448.37927 453.06018 458.46109 460.91898 463.31567 468.71838 474.2984 476.7023 485.4512 491.14011 495.82101 499.35892 501.76282 507.36172 512.76447 515.1684 520.56927 525.25018 529.93109 535.28699 539.9679 544.6488 550.05151 555.65039">When executing an inter-privilege-level far call, the code segment for the procedure being called must be accessed </tspan><tspan y="-261.95898" x="46.021515 49.559414 55.248314 59.083214 64.538116 70.180222 75.819618 81.461723 84.045624 89.446526 92.030426 97.746323 103.46222 107.54012 113.13902 115.59692 119.13483 121.65842 126.33932 131.74022 134.19812 136.65602 139.23991 144.83882 150.23972 153.77762 159.13351 162.40141 164.925 170.46091 176.14981 181.50571 184.0896 188.77051 194.1264 199.72531 208.47421 213.83011 219.51901 223.05692 225.64081 230.32172 235.67761 238.13551 243.49141 248.1723 251.71021 257.1651 261 263.58392 268.26483 273.86374 279.21964 283.95993 286.35663 289.54083 291.99872 297.35461 302.95352 305.53745 311.13635 316.45624 318.90152 322.44211 328.1337 333.49231 336.0159 339.55649 344.96008 348.79767 354.39926 359.75787 363.29846 365.88235 371.33997 376.94156 382.30017 385.96225 391.36584 397.05743 402.65903 405.18262 407.64322 413.24481 418.60342 424.29501 427.8356 430.2323 433.3949 435.8555 441.21411 445.89771 448.4816 452.02219 457.71378 463.07239 465.65628 470.33987 475.74347 478.14017 480.59628 483.18018 488.78177 494.18536 497.72595 503.08456 506.35516 508.93906 514.47766 520.16925 525.52783 528.11176 531.65234 537.05597 540.89355 546.49518 551.85376 555.45374">through a 64-bit call gate. The segment selector specified by the target operand identifies the call gate. The target </tspan><tspan y="-250.97899" x="46.021515 51.479115 57.080715 62.439316 66.162613 71.566216 77.209213 82.810814 85.63591 90.319511 95.723114 101.41471 104.29921 109.70101 115.40341 117.86401 123.18661 126.01171 130.69531 136.29691 141.6555 146.3391 148.7997 151.9623 157.2849 160.1694 163.71001 169.40161 174.76021 177.58531 182.26891 187.6725 190.1331 192.5937 195.41881 201.02042 206.42401 209.96461 215.32321 218.14832 222.83191 228.2355 233.8371 242.5887 247.9473 253.6389 257.1795 260.00461 264.6882 270.09183 272.48944 277.89307 282.57666 286.11725 291.57486 295.41245 298.23755 300.69815 306.38974 311.99133 314.45193 318.28952 323.64813 328.33173 331.87231 334.33292 339.65552 342.48062 349.83722 352.23483 355.77542 361.46701 364.3515 369.7551 372.5802 381.33179 386.6904 395.44199 400.8996 404.73718 410.05978 412.94427 415.40488 420.86249 425.54608 430.94968 434.49026 436.88788 442.34549 448.03708 450.92157">operand can only specify the call gate segment selector indirectly with a memory location (</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-250.97899" x="454.80148 463.53329 469.29599 474.99478 479.05557 484.75436 490.45316 493.75525 496.57944 505.31125 511.01004 516.77277 520.85156 526.55035">m16:16, m16:32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-250.97899" x="532.26178 535.14539 540.60657 544.44775"> or </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-239.99899" x="46.021484 54.763184 60.471886 66.180588 70.251289 75.959991">m16:64</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-239.99899" x="81.721786 85.801483 89.071182 91.954781 97.492477 103.18317 108.54088 111.36507 116.96577 120.80247 126.25918 130.94188 136.29958 140.98227 145.66496 151.12166 154.95836 157.78256 163.23926 168.83997 172.37967 177.78236 180.17906 185.88057 190.56326 193.44687 196.98657 202.67728 208.03497 210.85918 215.54187 220.94456 226.54526 235.29596 240.65366 246.34436 249.88406 252.70827 257.39096 262.79367 265.19037 270.59308 275.27579 278.81549 284.27219 288.10889 290.93311 294.09482 299.55151 303.38821 306.21243 309.75214 315.42209 320.7771 323.66071 329.34869 334.7037 342.0567 344.94031 349.6203 355.07431 360.6723 366.02731 368.91092 373.59091 378.94592 384.54391 393.2919 398.69461 404.3367 407.87369 410.75729 416.15729 421.84528 427.44327 430.26749 433.80447 439.49246 444.89517 447.71939 453.40738 458.76239 466.11539 468.93961 471.39661 477.08459 481.76459 485.30157 489.13559 494.82358 499.50357 503.04056 505.43726 510.89755 516.58557 519.46918 525.0672 530.52118 532.97815 538.62024 542.15723 547.55994 551.39392">). The processor obtains the segment selector for the new code segment and the new instruction pointer </tspan><tspan y="-228.95869" x="46.0224 50.097599 55.549801 58.707001 61.864201 66.542404 71.895607 75.495605 79.574409 82.398613 85.555817 89.388016 94.840218 103.58642 106.47002 110.00523 115.69143 121.04463 123.86884 129.63153 135.33392 139.40912 145.00533 150.32253 153.85773 159.21092 162.03513 166.71333 172.11153 174.56673 177.02193 179.84613 185.44234 190.84053 194.37573 199.72893 202.61253 208.20874 213.56194 218.24014 222.91835 226.75055 229.20575 234.80196 238.33716 243.78935 246.37144 249.61324 252.49684 256.57205 262.10526 267.79144 273.14465 276.02823 281.48044 284.63763 287.79483 292.47302 297.82623 301.32269 304.2063 307.36621 311.20111 316.60202 325.36533 328.24893 331.78683 337.47574 342.83163 345.65585 349.19376 354.59467 358.42957 364.02847 369.38437 372.92227 375.74649 381.20139 386.80029 392.15619 395.8183 401.21921 406.90811 412.50702 415.39062 417.84851 422.52942 425.35364 427.81152 433.41043 439.09933 444.55423 448.38913 453.74503 459.34393 462.22754 469.58145 475.27036 480.62625 486.31516 489.19876 494.59967 497.42389 502.1048 507.50571 509.96359 512.42151 515.24573 520.8446 526.24548 529.78339 535.13928 537.9635 540.42139 545.10229">(offset) from the 16-byte call gate descriptor. (The offset from the target operand is ignored when a call gate is </tspan><tspan y="-217.9787" x="46.0224 51.719398 56.408398 61.7724 67.379402 70.655403">used.)</tspan><tspan y="-201.95869" x="46.0224 53.0928 58.777199 61.241398 63.694798 69.379196 72.912598 78.3153 82.037697 86.116501 91.710899 95.541298 97.994698 103.3101 105.7635 108.16019 113.5629 119.1429 124.4943 128.5677 131.0211 136.3725 141.6879 147.03929 149.49269 151.89659 156.573 161.96939 164.42279 166.87619 171.5526 174.81599 177.21989 180.7533 186.4377 191.84039 194.24429 199.8387 203.6691 209.11949 213.7959 219.14729 223.8237 228.50011 233.9505 237.7809 240.2451 244.92151 252.2709 254.7243 258.25769 262.93408 268.61847 273.96988 278.64627 281.11047 284.64386 290.04477 292.50897 296.04236 301.68271 307.03592 309.43982 314.11801 317.6532 323.05139 327.72958 333.04678 335.45068 338.60788 344.06009 347.8923 350.2962 353.83139 359.51758 364.87079 367.33499 372.93118 376.7634 379.2186 384.5358 386.991 389.4462 394.79941 400.3956 405.74881 408.15271 410.60791 415.96112 421.27832 426.63153 429.08673 431.49063 436.94284 440.10004 442.50394 446.03912 451.72531 457.07852 459.48242 464.16061 469.55881 472.01401 474.46921 479.82242 485.41861 487.88281 493.479 497.31122 502.76343 507.44162 512.7948 518.39099 524.07721 527.90942 533.31213 536.55396 539.01819 544.55139 550.23761 555.59082">On inter-privilege-level calls, the processor switches to the stack for the privilege level of the called procedure. The </tspan><tspan y="-190.9787" x="46.0224 50.7033 56.0592 61.6581 70.406998 75.762901 81.451805 84.989708 87.873306 92.554207 97.91011 100.36801 105.72392 110.40482 113.94272 119.39762 123.23252 126.11612 129.27602 134.73091 138.56581 141.4494 144.9873 150.62941 156.0321 158.85629 164.5452 169.90109 177.25499 180.07918 184.76007 188.29797 193.69887 198.37976 203.69966 206.58325 211.26416 216.62006 222.21896 230.96786 236.32376 242.01266 245.55057 248.37476 250.83266 255.51355 258.39716 263.07806 268.43396 271.97186 274.85547 278.39337 283.79428 286.67789 293.40179 299.98169 304.9866 309.9024 313.1712 315.99539 321.5322 327.22198 332.5788 335.40298 341.09277 346.44958 353.80438 356.62857 361.31036 364.84915 370.25095 374.99124 380.31204 383.19562 388.79541 394.25122 396.71002 402.39981 405.99979 411.34219 415.17798 418.00217 420.46097 425.14276 427.96695 432.64874 438.24854 443.60535 448.28714 450.74594 453.90674 456.30255 461.70526 467.30505 470.12924 472.58804 478.27783 481.10202 484.64081 490.3306 495.73331 498.5575 504.01599 510.07928 516.22809 519.05231 522.21313 527.66895 531.50476 534.32898 537.8678 543.55762 548.91443">segment selector for the new stack segment is set to NULL. The new stack pointer is specified in the TSS for the </tspan><tspan y="-179.9987" x="46.0224 50.704201 56.394001 60.229801 64.065598 69.422394 75.112198 78.651001 81.047699 86.389198 89.272797 93.108597 98.750702 104.44051 110.13031 112.58911 118.27892 123.87872 126.70291 130.24171 135.64351 140.3253 145.6461 148.9149 151.73909 157.27589 162.9657 168.32249 171.20609 176.80588 180.52827 185.93007 191.57217 196.25397 201.94377 204.82736 208.36617 213.82196 216.64615 220.18495 225.87476 231.23155 234.11514 239.75725 245.15994 252.51474 255.39833 260.08014 265.53595 271.13574 276.49255 279.37616 284.05795 289.41476 295.01456 303.76434 309.12115 314.81094 318.34973 321.23334 326.68915 331.37094 336.05273 341.74252 345.57831 350.2601 353.08432 358.48611 361.64691 365.1857 370.54251 374.3783 377.2619 380.80069 386.44278 391.84549 394.66971 399.3515 402.89029 408.29208 412.97388 418.29468 421.1189 425.80069 433.15549 435.61429 439.15308 443.83487 449.52466 452.79346">currently running task. The branch to the new code segment occurs after the stack switch. </tspan><tspan y="-163.9787" x="46.0224 52.750801 58.210201 61.752602 67.112999 69.996597 73.538994 79.181091 84.586494 88.128891 91.012489 98.370888 104.06429 109.42468 115.11808 118.00168 123.69508 128.38048 130.77718 136.47868 142.08208 144.90628 150.31168 153.13588 157.87617 163.27977 165.67647 168.13257 170.95677 176.56017 181.96556 185.50797 190.86836 193.75197 197.29437 202.75377 205.57797 211.18137 216.54176 220.38116 223.54556 229.00496 232.84436 241.59776 244.42197 249.82736 252.71097 255.87537 261.28076 265.12015 267.94434 272.62973 278.03513 280.49753 282.95993 285.78412 289.32651 294.78592 297.48242 302.88422 305.76779 310.44958 315.8064 321.40619 330.15598 335.55869 341.20078 344.73956 347.62314 353.02493 356.56372 359.38791 362.9267 368.61649 374.0192 376.84338 381.52518 386.92697 395.67676 401.03357 403.91714 409.51694 413.35272 415.81152 421.13232 423.59113 426.04993 431.40674 437.00653 442.40924 445.23343 447.69223 453.04904 458.27084 463.67355 466.07025 469.37234 472.19653 477.59833 483.28812 486.17169 488.56839 497.33167 502.93146 505.32816 507.78696 512.46875 514.92755 518.46637 521.29059 525.97241 529.51123 534.91302 539.59485 544.91565">Note that when using a call gate to perform a far call to a segment at the same privilege level, an implicit stack </tspan><tspan y="-152.9987" x="46.022415 50.707817 58.066216 60.528614 64.071014 68.756416 74.449814 77.27401 82.733414 87.418816 92.104218 97.797615 101.63702 106.32242 109.20602 114.61142 119.29682 122.12102 127.52642 130.41003 134.24944 139.60983 144.29523 149.98863 152.45103 155.99344 158.81764 164.27704 167.44144 170.26564 175.62604 181.31944 184.86185 190.26454 194.10394 196.50064 202.19405 207.79744 210.68105 216.40144 222.12184 226.20424 231.80763 234.27003 237.81244 240.63664 249.39005 254.84944 260.45285 265.81326 269.08566 271.90985 277.45026 283.09235 288.49506 291.18243 297.24573 303.36932 306.25293 310.93384 316.28973 318.74762 324.10352 328.78442 332.32233 337.77722 341.61212 344.49573 346.89243 351.57245 354.45605 360.14496 365.78705 370.46796 376.15686 381.55777 387.24667 392.84558 398.24829 403.8472 407.11511 409.93933 415.53824 421.22714 424.76505 427.64865 432.32956 435.86746 441.26837 445.94928 451.26917 454.09338 458.77429 464.13019 469.7291 478.478 483.88071 489.5228 493.0607 495.94431 501.34521 506.02612 510.70703 516.06293 520.74384 525.42474 530.82745 535.50836 538.33258 544.02148 548.70239 554.05829">switch occurs as a result of entering 64-bit mode. The SS selector is unchanged, but stack segment accesses use </tspan><tspan y="-141.9584" x="46.02243 51.419731 54.243931 58.92123 64.273529 69.912926 78.615929 84.018631 89.720131 93.254433 96.078636 101.67393 107.07124 111.74854 117.15124 119.97544 125.42674 128.58304 131.40723 137.11952 142.43582 148.14812 151.45021 154.2744 157.8087 163.494 168.8463 171.67049 174.12479 176.57909 185.32439 187.77869 191.31299 194.19658 196.59328 201.27328 204.15688 206.55357 212.19298 217.87828 223.32957 227.16087 232.56357 238.15887 241.42317 244.30676 249.70406 255.38936 260.98465 263.80887 267.34317 273.02847 278.38077 281.26437 286.85968 292.21198 295.36829 300.76559 306.4509 308.90521 312.43951 315.18274 319.86365 323.40155 328.80246 333.48337 338.80328 341.6275 346.30841 348.7663 353.38239 358.7851 361.60931 364.0672 368.74811 371.57233 377.28824 383.05096 387.12888 392.72778 395.18567 398.72357 403.40448 406.67239 409.556 413.63391 419.1698 424.8587 430.2146 433.03882 436.19873 441.88763 444.34552 446.74222 449.62582 454.72794 460.13153 462.58942 468.27832 473.63422 476.45844 481.91333 485.07324 487.89746 494.14435 500.29224 505.71115 508.59476 510.99146 515.67145 518.55505 524.24396 528.92487 534.32758 539.90753 542.73175 545.89166 551.34656 555.18146">a segment base of 0x0, the limit is ignored, and the default stack size is 64-bits. (The full value of RSP is used for </tspan><tspan y="-130.97841" x="46.02243 49.56213 55.252831 60.610531 63.434731 68.891434 72.053131 75.214828 79.89753 85.255234 88.794937 92.064636 96.144333 98.968529 106.04523 111.73592 114.56012 118.09982 123.79052 129.14822 132.03183 137.72253 143.08023 150.43593 153.31953 158.00223 161.54193 166.94463 171.62732 176.94902 180.21872 183.10233 186.64203 192.33273 197.69043 200.51463 206.11533 209.95203 215.35292 220.09322 225.45091 230.13361 234.8163 240.27299 244.1097 246.9339 252.53461 258.22531 262.90802 268.59872 274.00143 278.68146 281.50568 285.04538 290.73608 296.09378 298.97739 303.6601 309.01779 314.6185 323.3692 328.7269 334.4176 337.95731 340.84091 345.52362 350.88132 353.341 358.6987 363.38141 366.92111 372.37781 376.21451 379.03873 384.44144 390.13214 395.73285 398.55707 403.23978 406.77948 412.18219 416.8649 422.18658 425.0108 430.61151 436.01242 438.47211 444.16281 447.70251 453.06021 456.89691 459.78052 462.94223 468.39893 472.23563 475.11923 478.65894 484.34964 489.70734 492.53156 497.21426 502.61697 505.07666 507.53635 509.99603 515.68671 521.28741 524.11157 529.71228 533.54895 539.00568 543.68835 549.04608">the offset.) On the new stack, the processor pushes the segment selector and stack pointer for the calling proce-</tspan><tspan y="-119.99841" x="46.02243 51.62043 57.30843 61.142429 66.497429 68.601631 73.281631 75.625229 80.305229 83.842232 89.242233 93.922234 99.241234 101.58484 106.98484 112.67284 118.27084 120.61444 124.15144 129.83945 135.19444 137.53804 142.21805 147.57304 153.17105 161.91905 167.27405 172.96205 176.49905 178.84265 183.52264 188.87764 191.33464 196.68964 201.36963 204.90663 210.36063 214.19463 216.53822 221.93822 227.62622 233.22423 235.56783 238.02483 243.66693 248.40723 251.94693 255.78093 261.42303 266.10303 269.64001 272.09702 277.55103 283.23901 285.58261 291.1806 296.63461 299.09161 304.68243 308.21942 313.62305 317.45706 319.80154 322.96054 328.41455 332.24857 334.59305 338.13004 343.81802 349.17303 351.51752 356.19751 361.5975 364.0545 366.45212 368.90912 374.59711 380.1951 382.53958 388.13757 391.97159 397.4256 402.10559 407.50922 413.09012 418.77811 422.61212 427.96713 430.07224 434.75223 437.09671 441.7767 447.23071 452.8287 458.23233 460.51743 465.19742 470.60104 476.19904 484.94702 490.30203 495.99002 499.52701 502.79401 505.13849 509.21548 514.4364 519.83643 523.49939 528.89941 537.6474 543.00238 546.53937 551.94293 555.72565">dure’s stack and the segment selector and instruction pointer for the calling procedure’s code segment. (Parameter </tspan><tspan y="-108.95811" x="46.02243 50.69883 56.149231 61.743629 67.059029 69.402634 71.856033 76.532433 78.876038 84.56044 90.010841 93.544243 95.828445 100.50484 106.18925 111.82864 117.40865 122.85905 126.68945 130.22284 135.57423 141.16864 143.51224 145.96564 151.65004 153.99364 157.77003 163.65334 167.72673 173.48943 179.20082 184.55222 186.89581 195.64021 201.09061 206.68501 212.03641 215.3385 219.4173 221.76089 226.92329 229.37669 235.0611 240.45749 242.91089 245.36429 249.86609 253.12949 255.47308 259.00647 264.69086 270.04227 272.38586 277.98026 281.81067 287.26108 291.93747 297.24213 301.92392 306.60571 312.06152 315.89731 318.24091 323.8407 327.56308 332.96487 338.65466 343.33646 348.97855 354.38126 359.06125 361.40485 364.94363 370.39944 372.68365 376.22244 381.91223 387.26904 389.61264 395.01443 400.61423 406.21402 410.0498 415.40662 420.08841 424.7702 427.1138 432.56961 435.73041 438.01462 441.55341 447.24319 452.6459 454.93011 460.52991 464.36569 469.8215 474.5033 479.86011 485.4599 491.14969 494.98547 500.34229 502.68588 508.28568 513.68835 516.08417 521.78571 527.3855 529.66974 534.35156 539.75336 542.21216 544.67096 550.02777 555.62756">copy is not supported in IA-32e mode.) Finally, the processor branches to the address of the procedure being called </tspan><tspan y="-97.978104" x="46.02243 53.370029 55.821629 59.35323 65.035828 67.487427 73.129532 76.013138 79.544739 85.227341 90.576942 93.460548 99.102654 104.50536 111.85296 114.73656 119.41116 124.85976 130.45236 135.80196 138.68555 143.36015 148.70975 154.30235 163.04495 168.39455 174.07715 177.60875">within the new code segment.</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="511.57016pt" height="641.68445pt" viewBox="0 0 511.57016 641.68445" sodipodi:docname="246.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.22481" inkscape:cy="419.76351" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg208" /><g transform="translate(-45.58139,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-715.97998" x="45.119999 51.117599 56.520302 59.682903 65.041504 68.879105 71.222702 74.763306 80.220909 82.624809 88.901413 94.54351 99.947113 105.54871 109.08932 114.44791 118.28551 120.68941 126.40801 129.67862 132.02222 136.14781 141.56941 145.40701 150.86461 155.5482 160.9068 166.50839 172.2 176.0376 181.39619 183.80009 190.07669 195.48029 197.94089 200.40149 205.08508 208.35568 210.71999 214.49458 220.17719 223.70879 229.05838 232.88698 236.71558 242.39818 247.99078 251.52238 256.19699 259.49908 261.90298 267.29758 272.98016 278.57275 280.97665 286.65027 291.87207 296.54666 301.94937 307.54196 311.07355 313.52515 318.97375 324.65634 329.33093 333.44754 335.85144 341.24603 346.92862 352.52121 354.92511 361.19272 366.87531 372.2699 377.9093 381.44089 386.82028 390.65518 393.05908 398.77499 404.49091 407.79303 410.19693 414.31982 420.59372 426.04861 431.73752 435.27542 439.11032 444.56522 446.96191 451.03983 456.20673 458.66461 464.11951 471.47342 473.81702 479.49692 485.18582 488.34573 493.80063 497.63553 502.37582 507.73172 516.48059 521.83649 527.52539 531.06329 533.40692 538.02478 543.36719 548.0481 553.737">Refer to Chapter 6, “Procedure Calls, Interrupts, and Exceptions” and Chapter 18, “Control-Flow Enforcement Tech-</tspan><tspan y="-705" x="45.119965 50.810665 56.267365 58.664066 64.124367 69.725067 75.046768 77.930367 82.010071 88.285774 93.967476 99.505173 103.58487 107.70957 110.53377 112.99347 118.68417 121.50836 125.04807 130.73877 136.14146">nology (CET)” in the </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-705" x="138.96027 142.74117 148.43007 151.96797 157.32387 159.78177 168.77367 171.65726 177.37315 183.08905 185.97264 191.37354 197.06244 202.66135 205.48553 209.26643 215.44943 219.52733 225.24323 230.95912 233.84271 239.98161 243.81651 248.49741 254.18631 256.6442 260.1821 265.53799 270.2189 273.75681 279.44571 283.28061 288.63651 293.31741 296.20102 302.34891 307.8038 310.96371 314.50162 321.85553 327.25644 331.09134 336.49405 339.31827 346.20416 351.56006 356.87097 362.22687 364.68475 370.13965 375.73856 381.09445 384.92935 387.39355 392.07446 394.89868 402.47757 407.87848 413.56738 419.25629 424.6572 427.11508 430.383 433.20721 439.39023 444.79114 447.24902 452.93793 461.68683 467.04272 469.92633">Intel® 64 and IA-32 Architectures Software Developer’s Manual, Volume 1</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-705" x="475.49997 478.38358 481.53268 486.97678 490.80087 493.68448 499.94757 505.64456 511.16968 514.05328 519.64136 524.98645 528.51355 533.90363 536.35071 538.79779 543.4679"> for CET details.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c1AE6E0A5"><tspan y="-688.97998" x="45.119965 47.581467 53.102966 58.081768 61.08147 64.593269 70.103073 75.081871 78.081566 80.594368 86.055573 91.565369 93.786568 99.296371 102.80817 108.31798 113.29678 116.80858 119.32138 124.78258 130.30408">Instruction ordering.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-688.97998" x="132.77997 135.60417 139.38867 145.08118 149.76567 153.30717 157.14568 162.83818 167.52267 171.06418 173.52568 178.92657 184.61908 189.30357 192.18718 195.35068 200.75157 203.21307 205.67458 211.13307 218.49057 220.95207 226.64458 232.24707 235.13068 240.53517 243.35938 246.52287 251.92737 255.76587 258.59009 263.2746 268.67911 271.14059 273.60208 276.4263 285.1788 290.52213 295.84561 298.66983 304.27234 309.67505 312.49927 315.66278 321.02228 324.56378 329.15997 334.85336 340.21378 345.81717 348.64139 351.80579 355.64517 361.10458 369.80756 372.69116 381.44455 386.80496 395.55835 401.01776 404.85715 410.18155 413.06516 418.66855 424.02896 427.19336 432.65277 436.49216 441.85257 444.73618 450.09659 455.50198 459.34137 461.80377 464.19958 469.60229 473.44168 476.2659 478.7283 484.42169 489.10709 492.64948 496.48886 502.18225 506.86765 510.41003 512.80676 518.26709 523.96051 528.64594"> Instructions following a far call may be fetched from memory before earlier instructions </tspan><tspan y="-678" x="45.119965 49.801765 55.257565 64.007362 69.607162 72.065964 77.42276 80.961563 86.318359 89.201958 94.558762 99.780563 105.13736 109.81916 115.50896 119.04776 121.50656 126.96236 132.65216 135.92096 138.74516 144.34497 150.03477 153.57358 156.39778 159.93658 165.62639 170.98318 176.30399 179.12819 186.48299 188.94179 191.33849 193.79459 196.67819 202.368 207.82379 211.36259 214.2462 219.603 224.8248 230.18159 234.86339 240.55319 244.092 249.44879 252.3324 256.41119 261.76801 266.98981 272.39252 278.08231 280.90649 285.58829 291.18808 296.59079 301.27078 306.96057 309.35727 314.75906 318.29785 320.75665 325.97845 331.38116 333.77786 339.09866 343.17746 346.06104 351.75082 357.44061 360.9794 363.4382 365.897 368.72119 374.12299 376.58179 379.04059 381.86478 384.32358 390.01337 394.69516 398.23395 402.06973 407.75952 412.44131 415.9801 418.3768 423.8371 429.52689 434.20868 437.09225 442.69205 446.52783 448.98663 454.44244 458.27823 461.10242 464.6412 470.09702 472.9212 476.45999 482.14978 487.55249 490.37668 493.53748 498.93927 502.77505 505.59924 510.28104 515.68286 518.14166 520.60046 523.42468 529.1145 534.45782 539.67963 545.02203">complete execution, but they will not execute (even speculatively) until all instructions prior to the far call have </tspan><tspan y="-667.02002" x="45.119965 49.801765 55.257565 64.007362 69.607162 72.065964 77.42276 80.961563 86.318359 91.918159 94.142059 99.498856 104.72066 110.07745 114.75925 120.44905 123.98785 126.44666 131.90245 137.59225 139.81615 143.89494 147.43375 153.12355 158.48035 160.70424 163.16304 168.56483 172.10364 177.46043 181.29623 183.52013 185.97893 191.66873 196.35052 199.88933 203.72513 209.41493 214.09673 217.63553 220.09433 225.49522 231.18503 235.86682 238.15102 246.90082 252.24411 257.56491 259.78882 265.14563 270.36743 275.72424 280.40604 286.09583 289.63461 295.03732 297.26123 302.86102 308.21783 311.37863 316.73996 320.57217 325.92538 328.20959 333.80579 339.20398 342.73917 348.13736 350.36127 355.03946 358.57465 364.02686 367.85907 373.21228 378.80847 381.03238 386.62857 391.94577 394.16968 397.70486 403.39105 408.74426 410.96817 416.32138 421.71957 425.55179 428.00699 430.46219 435.8154 439.64761 441.87152 444.32672 450.01291 454.6911 458.22629 462.0585 467.74469 472.42288 475.95807 478.41327 483.81418 489.50037 494.17856 496.46277 502.10486 507.44815 512.76538 518.11859 520.34253 525.93872 531.34143 536.01965 541.47186 550.21808 555.62079">completed execution (the later instructions may execute before data stored by the earlier instructions have become </tspan><tspan y="-655.97974" x="45.119965 50.709866 53.158768 58.604668 64.194565 69.586464 72.035362 74.484261 79.795158 82.678757 87.989655 90.438553 95.110451 97.559349 103.14925 105.59814 110.94505 115.01395">globally visible).</tspan><tspan y="-640.02002" x="45.119965 51.397465 56.756966 60.595467 64.136971 69.541473 71.938179 77.630676 80.514275 85.198776 87.660278 91.201782 96.84388 102.24838 105.78989 108.25139 113.70989 119.40239 124.08689 126.91109 135.66359 141.00688 146.33038 149.15459 151.61609 156.97559 162.38008 167.98257 170.86618 174.40768 179.86618 182.69038 186.23189 191.92439 197.28389 200.1675 205.86 211.2195 216.543 220.0845 222.90871 227.5932 232.9527 238.55519 244.2477 249.60719 255.2997 258.84119 261.23788 266.70178 269.09848 271.98209 274.37878 280.08029 284.7648 288.23969 292.07907 297.77246 302.45786 306.00024 308.46265 313.92206 319.61545 322.44055 327.84595 331.01035 334.55273 339.91315 343.75253 346.63702 352.04242 354.86752 360.56091 365.92133 371.32672 375.16611 378.0506 380.4473 386.14877 391.75217 394.14886 397.98825 403.34866 408.03406 411.57645 414.40155 420.67996 426.83237 431.84177 436.85117 439.67627 445.27966 450.64008 453.10248 458.79587 464.39926 467.22437 471.90976 477.51315 482.87357 487.55896 493.25235 495.71475 501.12015 504.66254 507.05923 512.34131 517.70172 520.16412 525.48853">Certain situations may lead to the next sequential instruction after a near indirect CALL being speculatively </tspan><tspan y="-628.97974" x="45.11998 50.472279 55.694077 61.046375 65.723679 71.408981 74.943283 80.295586 85.934982 89.19928 91.60318 95.380478 98.536781 100.88038 105.55768 111.00898 114.16528 117.69958 124.95629 130.35989 134.19119 139.54349 141.94739 147.63269 152.98499 158.33728 163.97668 168.65399 170.99759 174.53189 179.98318 182.38708 187.98239 191.81369 197.16599 202.48228 207.83458 213.51988 217.05418 219.45808 222.99239 228.67769 231.13199 235.8093 238.2132 242.28749 247.63979 250.94188 256.52188 259.22369 262.52582 264.86942 267.32373 273.00903 275.35263 280.80392 284.63522 290.27463 295.5603 299.3916 301.73431 305.26862 310.71991 313.12292 318.71823 322.54953 327.95132 333.17224 338.52454 344.20984 347.74414 350.14716 355.54446 357.88718 362.56448 368.203 373.5553 378.2326 383.91791 386.37222 391.76953 395.30383 397.69965 402.98087 408.33316 410.73618 416.08847 421.30939 426.66168 431.33899 437.02429 440.55859 443.01291 448.4642 454.14951 456.55252 461.22983 463.68414 469.27945 474.63174 477.03476 481.71207 487.39737 492.79468 498.47998 504.16528 509.51758 511.97189 516.0462 519.31049 521.7135 525.2478 530.93311 536.2854 541.9707 544.31342 549.71069 555.396">executed. If software needs to prevent this (e.g., in order to prevent a speculative execution side channel), then an </tspan><tspan y="-617.99976" x="45.119995 50.125793 55.293594 60.974396 67.699196 73.973999 79.6548 82.538399 84.9972 90.639297 95.321098 98.859901 102.6957 108.3855 113.0673 116.6061 119.0649 124.52071 130.21051 133.0347 138.49049 144.0903 148.8306 154.23149 159.8313 165.1881 168.07169 172.75348 178.15527 183.79738 186.68097 192.28076 197.63756 200.52115 206.12094 208.57974 213.98154 218.66333 224.02013 229.61993 232.44412 237.84592 241.00671 244.54552 249.90231 253.73811 256.62173 260.16052 265.80261 271.20532 274.02954 279.71933 285.07614 290.47794 294.31372 297.12 299.51669 305.2182 310.8414 313.2381 317.09729 322.47748 327.15747 330.69717 333.52139 339.81958 345.94318 350.97238 355.95569 358.77991 361.23602 366.93753 369.76175 375.24094 379.10013 384.72333 390.0657 393.9249 396.74911 400.31131 405.7905 408.6741 414.25409 416.71021 422.18939 426.86938 432.21359 435.03781 439.7178 445.29779 450.67798 455.35797 461.00006 463.45618 468.88138 472.44357 474.89969 480.12149 485.50168 488.3259 493.66827 498.89008 504.27026 508.95026 514.59235 518.13202 520.58807 526.04834 531.76154">LFENCE instruction opcode can be placed after the near indirect CALL in order to block speculative execution.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-594.29999" x="45.119999 51.730453 57.3708 62.945412 66.367668 71.673363 75.694214 78.181229 83.820587">Operation</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-574.97998" x="45.119999 47.216999 51.8979 54.117298 58.896297 63.612297 68.085297 71.352295 73.571693 77.477692 81.950691 83.876694">IF near call</tspan><tspan y="-562.98029" x="58.619999 63.8382 69.659401 74.370903 80.207405 82.426811 84.510315 89.221817 91.441223 96.206726 100.94703 105.40653 108.70863 110.92804 114.18154 118.88404 120.79654 125.29564 128.65714 130.63893 135.26942 139.97192 142.19133 146.08383 150.58293 152.49544">THEN IF near relative call</tspan><tspan y="-550.98059" x="76.680298 81.889496 87.710693 92.460892 98.282089">THEN </tspan><tspan y="-538.9809" x="94.680298 96.751198 101.49239 103.71179 109.41869 114.09779 118.8381 122.0799 126.52679 131.32919 135.96509 140.76749 142.74928 146.89018 151.58008">IF OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-538.97998" x="153.72 159.60039">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-538.97998" x="162.36 167.6403">64</tspan><tspan y="-526.98029" x="112.68 117.8892 123.7104 128.4606">THEN</tspan><tspan y="-514.98059" x="130.67999 134.0631 138.744 145.7001 150.31981 155.86292 160.54381 165.3309 170.4897 172.70909 174.4722 179.6013 181.82069 186.60779 188.5293 193.1994 197.9865 202.66739 207.46529 210.84839 215.57249 220.31459 224.9937 227.5938 233.1369 237.87 242.5797 247.7601 250.3485 252.21689 254.43629 257.02469 261.0441 263.26349 268.79489 273.5163 278.29169 283.47208 285.69147 287.64087 291.65128 293.87067 297.13406 301.84647 303.76886 309.03027 314.29169 316.51108 320.53049 323.1189">tempDEST := SignExtend(DEST); (* DEST is rel32 *) </tspan><tspan y="-502.9809" x="130.67999 134.0397 138.72061 145.68211 150.30182 155.74232 157.85283 162.95404 165.17343 166.91493 172.01614 174.23553 179.67604 181.78654 186.88776">tempRIP := RIP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-502.9809" x="189.11969">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-502.9809" x="194.03999 196.2594 199.6236 204.3288 211.26599 215.91719 221.44139 226.15559 230.9238 236.142"> tempDEST;</tspan><tspan y="-490.9812" x="130.67999 132.72119 137.46239 139.68178 143.70477 147.08878 151.52847 155.42816 159.72116 161.94055 166.68265 171.42384 174.80785 177.02724 178.96223 183.44423 186.72023 191.39124 196.07214 198.29153 203.01654 207.75864 212.49263 217.23473 221.90573 226.64783 228.86722 232.21523 236.94922 240.22522 242.44461 246.92661 249.146 254.366 257.18658 261.85757 266.54657 269.93057 274.61148 276.83087 280.10687 284.78778 288.17178 292.91388 296.18988 300.97787 303.19727 307.63696 312.30795 316.97894 320.25494 324.97995 328.94177">IF stack not large enough for a 8-byte return address</tspan><tspan y="-478.98151" x="148.67999 153.8595 159.705 164.42551 170.27101 172.49042 178.25491 183.02942 187.77153 190.35092 195.61142 198.19891 200.06641 202.28581 207.00632 209.09882">THEN #SS(0); FI;</tspan><tspan y="-466.98181" x="130.67999 135.79019 140.5584 144.5616 149.3298 151.91101 157.32721 159.41341 164.52361 167.10481">Push(RIP);</tspan><tspan y="-454.98212" x="130.67999 132.72119 137.46239 139.68178 144.46977 149.21187 153.69386 158.31357 163.04756 169.94786 174.73586 178.11986 182.60185 186.51685 190.77655 195.51775 200.25984 204.75894 209.37865 211.30014 216.02515 220.64485 223.24585 227.97984 233.10985 237.58286 240.18385 242.40324 247.98325 253.80444 259.34845 261.56784 267.11185 271.79276 276.58075 281.73953 283.95892 285.71393 290.84393 293.06332">IF ShadowStackEnabled(CPL) AND DEST != 0</tspan><tspan y="-442.98242" x="148.67999 153.43289 158.23529 162.68219 167.36128 172.06018 179.02078 183.77368 187.1937 191.64059 195.52049 199.7784 204.9399 209.69279 213.68069 218.48309 223.70309 229.0446 231.62401 237.0249 239.09579 244.19069 246.75659">ShadowStackPush8B(RIP);</tspan><tspan y="-430.98273" x="130.67999 135.3609 137.4615">FI;</tspan><tspan y="-418.98303" x="130.67999 136.09169 138.17339 143.27908 145.49849 147.23819 152.34389 154.56329 157.98329 162.66418 169.59688 174.24358 179.70297 181.80357 186.90927">RIP := tempRIP;</tspan><tspan y="-406.98334" x="94.679993 99.414894 101.5218">FI;</tspan><tspan y="-394.98364" x="94.679993 96.750893 101.49209 103.71149 109.41839 114.09749 118.83779 122.07959 126.52649 131.32889 135.96478 140.76718 142.74898 146.88988 151.57977">IF OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-394.98001" x="153.72 159.60039">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-394.98001" x="162.36 167.6403">32</tspan><tspan y="-382.98032" x="112.68 117.8892 123.7104 128.4606">THEN</tspan><tspan y="-370.98062" x="130.67999 134.04059 138.74219 145.67578 150.32338 155.03398 157.11658 162.22318 164.44258 166.18318 171.34468 173.56409 178.27469 180.35728 185.46388">tempEIP := EIP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-370.98062" x="187.67969">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-370.98062" x="192.65939 194.87878 200.42908 205.10997 209.90427 215.06306 216.95036 219.16975 221.77705 225.73885 227.95824 233.50853 238.18942 242.98372 248.14252 250.36191 252.33022 256.29202"> DEST; (* DEST is </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-370.98062" x="258.5394 261.77939 266.52057 268.55997 273.84027">rel32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-370.98062" x="279.05939 281.27878 285.29999"> *)</tspan><tspan y="-358.98093" x="130.67909 132.76799 137.48489 139.7043 143.0712 147.7791 154.71899 159.37289 164.0898 166.1787 171.34019 173.5596 175.5045 179.51041 181.72981 186.50072 191.21762 194.58452 196.80392 203.74382 205.68872 209.05562 213.82652 215.77142 220.54233 222.76173 226.65964 231.37654 236.03044 240.73834 242.93878 246.94469 251.65259 256.30649 263.2464 267.95428 272.72519 276.0921 278.31149 280.2294 282.17429 289.1142 291.05908 294.42599 296.64539 301.82129 307.66318 312.38007 318.22195 320.44135 326.20224 331.46814 336.58105 339.21985 344.47675 347.06064 348.92453 351.14392 355.86081 357.94971">IF tempEIP is not within code segment limit THEN #GP(0); FI;</tspan><tspan y="-346.98123" x="130.67908 132.72028 137.46147 139.68086 143.70386 147.08786 151.52756 155.42725 159.72025 161.93964 166.68173 171.42293 174.80693 177.02632 178.96132 183.44331 186.71931 191.39032 196.07123 198.29062 203.01562 207.75772 212.49171 217.23381 221.90482 226.64691 228.8663 232.21431 236.9483 240.2243 242.4437 246.92569 249.14508 254.36508 257.18567 261.85666 266.54565 269.92966 274.61057 276.82996 280.10596 284.78687 288.17087 292.91296 296.18896 300.97696 303.19635 307.63605 312.30704 316.97803 320.25403 324.97903 328.94086">IF stack not large enough for a 4-byte return address</tspan><tspan y="-334.98154" x="148.67908 153.85858 159.70409 164.42459 170.2701 172.4895 178.254 183.0285 187.77061 190.35001 195.6105 198.198 200.06549 202.2849 207.0054 209.0979">THEN #SS(0); FI;</tspan><tspan y="-322.98184" x="130.67908 135.79018 140.55928 144.56339 149.33249 151.9146 156.6297 158.7168 163.8783 166.4604">Push(EIP);</tspan><tspan y="-310.98215" x="130.67908 132.72028 137.46147 139.68086 144.46886 149.21095 153.69295 158.31265 163.04665 169.94695 174.73494 178.11894 182.60094 186.51593 190.77563 195.51683 200.25893 204.75803 209.37773 211.29922 216.02423 220.64394 223.24493 227.97893 233.10893 237.58194 240.18294 242.40233 247.98233 253.80353 259.34753 261.56693 267.11093 271.79184 276.57983 281.73862 283.95801 285.71301 290.84302 293.06241">IF ShadowStackEnabled(CPL) AND DEST != 0</tspan><tspan y="-298.98245" x="148.67908 153.42928 158.23167 162.67587 167.35497 172.05116 179.01176 183.76196 187.18198 191.62617 195.50337 199.75858 204.92007 209.67027 213.65547 218.45787 223.67787 229.01938 231.59879 236.29498 238.36319 243.52469 246.1041">ShadowStackPush4B(EIP);</tspan><tspan y="-286.98276" x="130.67908 135.35999 137.46059">FI;</tspan><tspan y="-274.98306" x="130.67908 135.37798 137.47858 142.57347 144.79288 146.52177 151.68327 153.90268 157.25159 161.94148 168.90208 173.58118 178.28008 180.38068 185.47557">EIP := tempEIP;</tspan><tspan y="-262.98337" x="94.679077 99.413979 101.52088">FI;</tspan><tspan y="-250.98367" x="94.679077 96.747276 101.48847 103.70787 109.41207 114.09117 118.83147 122.07327 126.51747 131.31987 135.95306 140.75546 142.73726 146.87816 151.56535 153.78476 158.94626 161.16566 166.40187">IF OperandSize = 16</tspan><tspan y="-238.98398" x="112.67908 117.88828 123.70947 128.45967">THEN</tspan><tspan y="-226.98428" x="130.67908 134.04237 138.74667 145.68297 150.33327 155.04657 157.13187 162.24117 164.46057 166.20387 171.36537 173.58478 176.16508 180.87839 182.96368 188.12518">tempEIP := (EIP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-226.98428" x="190.31938">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-226.98428" x="195.23969 197.45909 202.98059 207.69209 212.4576 217.6281 220.26691 222.48631 228.07982 233.91632 239.43782 241.65723 246.90872 252.16022 257.41171 262.66321 267.37469 272.08618 276.79767 281.50916 287.38974 289.24823 291.46762 294.04611 298.0556 300.27499 305.79651 310.508 315.2735 320.4917 322.71109 324.6506 328.65109"> DEST) AND 0000FFFFH; (* DEST is </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-226.98428" x="330.89938 334.08627 338.82117 340.92087 346.14087">rel16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-226.98428" x="351.41937 353.63876 357.65997"> *)</tspan><tspan y="-214.98459" x="130.67908 132.76797 137.48488 139.70428 143.07118 147.77908 154.71898 159.37288 164.08978 166.17868 171.34018 173.55959 175.50449 179.51039 181.7298 186.5007 191.21761 194.5845 196.80391 203.7438 205.68871 209.0556 213.82651 215.77141 220.54231 222.76172 226.65962 231.37653 236.03043 240.73833 242.93878 246.94469 251.65259 256.30649 263.2464 267.95428 272.72519 276.0921 278.31149 280.2294 282.17429 289.1142 291.05908 294.42599 296.64539 301.82129 307.66318 312.38007 318.22195 320.44135 326.20224 331.46814 336.58105 339.21985 344.47675 347.06064 348.92453 351.14392 355.86081 357.94971">IF tempEIP is not within code segment limit THEN #GP(0); FI;</tspan><tspan y="-202.98489" x="130.67908 132.72028 137.46147 139.68086 143.70386 147.08786 151.52756 155.42725 159.72025 161.93964 166.68173 171.42293 174.80693 177.02632 178.96132 183.44331 186.71931 191.39032 196.07123 198.29062 203.01562 207.75772 212.49171 217.23381 221.90482 226.64691 228.8663 232.21431 236.9483 240.2243 242.4437 246.92569 249.14508 254.36508 257.18567 261.85666 266.54565 269.92966 274.61057 276.82996 280.10596 284.78687 288.17087 292.91296 296.18896 300.97696 303.19635 307.63605 312.30704 316.97803 320.25403 324.97903 328.94086 332.96387">IF stack not large enough for a 2-byte return address </tspan><tspan y="-190.9852" x="148.67908 153.85858 159.70409 164.42459 170.2701 172.4895 178.254 183.0285 187.77061 190.35001 195.6105 198.198 200.06549 202.2849 207.0054 209.0979">THEN #SS(0); FI;</tspan><tspan y="-178.9855" x="130.67908 135.79198 140.56288 144.56879 149.33969 151.92358 154.01248 159.12538 161.70927">Push(IP);</tspan><tspan y="-166.98581" x="130.67908 132.72028 137.46147 139.68086 144.46886 149.21095 153.69295 158.31265 163.04665 169.94695 174.73494 178.11894 182.60094 186.51593 190.77563 195.51683 200.25893 204.75803 209.37773 211.29922 216.02423 220.64394 223.24493 227.97893 233.10893 237.58194 240.18294 242.40233 247.98233 253.80353 259.34753 261.56693 267.11093 271.79184 276.57983 281.73862 283.95801 285.71301 290.84302 293.06241">IF ShadowStackEnabled(CPL) AND DEST != 0</tspan><tspan y="-154.98611" x="148.67908 151.26477 155.28146 157.50087 159.59157 164.70627 166.92567 168.87238 172.88008 175.09949 179.26019 183.96989 187.23059 191.9493 194.1687 198.8784 203.6601 207.02879 211.73849 216.5112 221.1669 225.8766 230.5323 232.73907 237.21298 241.99289 246.65579 248.8752 253.4949 258.2973 262.31219 267.0921 271.80899 276.42868 278.6481 283.12201 287.0838 289.30322 293.77713 295.99655 301.26245 306.48245 308.70187 313.36478 315.31866 318.69458 320.914 325.5589 330.03281 331.95972 336.73962 341.45651 343.67593 348.40182 353.18173 355.40115 359.41605 364.19595 368.66986 373.33276 378.01364 384.97424 387.19366 391.20856 394.58447 399.05838 402.96527 407.25018 409.4696 413.4935">(* IP is zero extended and pushed as a 32 bit value on shadow stack *)</tspan><tspan y="-142.98642" x="148.67908 153.43288 158.23528 162.68307 167.36217 172.06197 179.02257 183.77637 187.19638 191.64418 195.52498 199.78378 204.94528 209.69908 213.68788 218.49028 223.71028 229.05179 231.6312 233.70299 238.79878 241.36559">ShadowStackPush4B(IP);</tspan><tspan y="-130.98672" x="130.67908 135.35999 137.46059">FI;</tspan><tspan y="-118.98702" x="130.67908 135.37798 137.47858 142.57347 144.79288 146.52177 151.68327 153.90268 157.25159 161.94148 168.90208 173.58118 178.28008 180.38068 185.47557">EIP := tempEIP;</tspan><tspan y="-106.98732" x="94.679077 99.413979 101.52088">FI;</tspan><tspan y="-94.987617" x="76.679077 81.400475 85.860878 90.636276 95.357674 97.577072 100.16547 104.18488 106.40427 112.25067 116.96307 121.43247 124.69587 126.91527 131.38467 136.04308 140.05348 144.77489 146.69728 151.47269 154.89268 159.57359 161.793 165.6954 170.16481 172.0872 174.0096 176.229 180.2484">ELSE (* Near absolute call *)</tspan><tspan y="-82.987915" x="94.679077 96.749977 101.49117 103.71057 109.41747 114.09657 118.83688 122.07867 126.52557 131.32797 135.96387 140.76627 142.74806 146.88896 151.57886">IF OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-82.980003" x="153.72">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-82.980003" x="159.60001 161.8194 167.0529"> 64</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="370.78973pt" height="632.16028pt" viewBox="0 0 370.78973 632.16028" sodipodi:docname="247.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="345.46814" inkscape:cy="407.51579" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg168" /><g transform="translate(-46.898895,-69.476563)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="113.52 118.72919 124.55039 129.3006">THEN</tspan><tspan y="-703.98029" x="131.51999 134.93999 139.62088 146.55807 151.20927 156.66867 158.76927 163.87947 166.09888 167.84308 172.95328 175.17268 180.69688 185.41109 190.17929 195.35249 197.2137 199.43311 202.01431 206.02652 208.24593 213.77013 218.48433 223.25253 228.47073 230.69014 232.63234 236.63554">tempRIP := DEST; (* DEST is </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-703.98029" x="238.86029 242.06248 245.11168 252.13889 257.4021">r/m64</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-703.98029" x="262.6203 264.83969 268.8609"> *)</tspan><tspan y="-691.98059" x="131.52 133.62241 138.35281 140.5722 144.5916 147.972 152.4117 156.3114 160.6008 162.82019 167.56229 172.3035 175.6839 177.90329 179.83469 184.31308 187.58548 192.25288 196.93379 199.15318 203.87459 208.61668 213.34708 218.08917 222.75658 227.49867 229.71806 233.06247 237.79288 241.06528 243.28467 247.72437 249.94376 255.21416 258.05457 262.72195 267.40735 270.78775 275.46866 277.68805 280.96045 285.64136 289.02176 293.80615 297.07855 301.86295 304.08234 308.52203 313.18942 317.85681 321.12921 325.81012 329.82953 333.84894">IF stack not large enough for a 8-byte return address </tspan><tspan y="-679.9809" x="149.52 154.70401 160.55402 165.27902 171.12903 173.34843 179.11743 183.89644 188.63855 191.21794 196.48294 199.07494 200.94693 203.16634 207.89134 209.98834">THEN #SS(0); FI;</tspan><tspan y="-667.9812" x="131.52 136.6815 141.42361 145.43132 150.20403 152.78972 158.21042 160.30112 165.41582 168.00151 169.86722">Push(RIP); </tspan><tspan y="-655.98151" x="131.52 133.62961 138.3672 140.58659 145.37819 150.12029 154.60588 159.22559 163.96318 170.86348 175.65508 179.04268 183.52827 187.44687 191.70657 196.44777 201.18987 205.68896 210.30867 212.23016 216.95877 221.57848 224.18307 228.92067 234.05428 238.53087">IF ShadowStackEnabled(CPL)</tspan><tspan y="-643.98181" x="149.52 154.29181 159.06361 163.52942 168.18422 172.90202 179.84282 184.61462 188.03462 192.47433 196.37314 200.64993 205.81143 210.55354 214.56035 219.33215 224.58995 229.90175 232.48654 237.90634 239.99614 245.10994 247.69473">ShadowStackPush8B(RIP);</tspan><tspan y="-631.98212" x="131.52 136.2549 138.3618">FI;</tspan><tspan y="-619.98242" x="131.52 136.974 139.09799 144.19919 146.41859 148.1601 153.26129 155.4807 158.88269 163.56358 170.53859 175.15828 180.61227 182.65347 187.80147">RIP := tempRIP;</tspan><tspan y="-607.98273" x="95.520004 100.25491 102.36181">FI;</tspan><tspan y="-595.98303" x="95.520004 97.589104 102.3303 104.5497 110.2548 114.9339 119.622 122.9241 127.3692 132.1716 136.80569 141.60809 143.53319 147.73439 152.42249">IF OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-595.97998" x="154.62">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-595.97998" x="160.5 162.71939 167.9529"> 32</tspan><tspan y="-583.98029" x="113.52 118.7292 124.5504 129.3006">THEN</tspan><tspan y="-571.98059" x="131.52 134.90491 139.58582 146.54372 151.16342 155.89832 158.00522 163.13612 165.35551 167.12041 172.25131 174.4707 180.01561 184.6965 189.4854 194.6442 196.52609 198.74548 201.34738 205.38028 207.59967 213.14458 217.82547 222.61436 227.77316 229.99255 231.95546 235.91725">tempEIP := DEST; (* DEST is </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-571.98059" x="238.1403 241.36411 244.3656 251.4144 256.69919">r/m32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-571.98059" x="261.9606 264.17999 268.2012"> *)</tspan><tspan y="-559.9809" x="131.5209 133.6116 138.33031 140.54971 143.91841 148.62811 155.56981 160.22551 164.94421 167.03491 172.19641 174.41582 176.36252 180.37022 182.58963 187.36234 192.08104 195.44974 197.66914 204.61084 206.55754 209.97754 214.71965 216.66635 221.43906 223.65846 227.55817 232.27687 236.93257 241.64227 243.8409 247.8558 252.53671 257.19962 264.14853 268.82941 273.63181 277.00769 279.22711 281.15402 283.0755 290.02441 291.94589 295.32178 297.5412 302.7261 308.577 313.30289 319.15378 321.3732 327.1431 332.418 337.53989 340.13278 345.39868 347.99158 349.86447 352.08389 356.80978 358.90768">IF tempEIP is not within code segment limit THEN #GP(0); FI;</tspan><tspan y="-547.9812" x="131.5209 133.62331 138.3537 140.57309 144.59248 147.97289 152.41258 156.31229 160.60168 162.82108 167.56317 172.30438 175.68478 177.90417 179.83557 184.31396 187.58636 192.25377 196.93468 199.15407 203.87547 208.61757 213.34796 218.09006 222.75746 227.49956 229.71895 233.06335 237.79376 241.06616 243.28555 247.72525 249.94464 255.21504 258.05545 262.72284 267.40823 270.78864 275.46954 277.68893 280.96133 285.64224 289.02264 293.80704 297.07944 301.86383 304.08322 308.52292 313.19031 317.8577 321.1301 325.811 329.83041 333.84982">IF stack not large enough for a 4-byte return address </tspan><tspan y="-535.98151" x="149.5209 154.70491 160.55492 165.27992 171.12993 173.34933 179.11833 183.89734 188.63945 191.21884 196.48384 199.07584 200.94783 203.16724 207.89224 209.98924">THEN #SS(0); FI;</tspan><tspan y="-523.98181" x="131.5209 136.6689 141.411 145.452 150.258 152.8374 157.5183 159.64229 164.74348 167.36249 169.22279">Push(EIP); </tspan><tspan y="-511.98212" x="131.5209 133.63051 138.3681 140.58749 145.37909 150.12119 154.60678 159.22649 163.96408 170.86438 175.65598 179.04358 183.52917 187.44777 191.70747 196.44867 201.19077 205.68987 210.30957 212.23106 216.95967 221.57938 224.18398 228.92157 234.05518 238.53177">IF ShadowStackEnabled(CPL)</tspan><tspan y="-499.98242" x="149.5209 154.29271 159.06451 163.53032 168.18512 172.90292 179.84372 184.61552 188.03552 192.47523 196.37404 200.65083 205.81233 210.55444 214.56125 219.33305 224.59085 229.90265 232.48744 237.20525 239.29504 244.45654 247.04134">ShadowStackPush4B(EIP);</tspan><tspan y="-487.98273" x="131.5209 136.2558 138.3627">FI;</tspan><tspan y="-475.98303" x="131.5209 136.23601 138.3231 143.4342 145.65361 147.39871 152.56021 154.77962 158.14471 162.85081 169.78891 174.44101 179.15611 181.24321 186.35431">EIP := tempEIP;</tspan><tspan y="-463.98334" x="95.520905 100.25581 102.36271">FI;</tspan><tspan y="-451.98364" x="95.520905 97.590004 102.3312 104.5506 110.2557 114.9348 119.6229 122.925 127.3701 132.1725 136.80659 141.60899 143.53409 147.73529 152.42339">IF OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-451.98001" x="154.62">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-451.98001" x="160.5 162.71939 167.9529"> 16</tspan><tspan y="-439.98032" x="113.52 118.7292 124.5504 129.3006">THEN</tspan><tspan y="-427.98062" x="131.52 134.90041 139.58131 146.53471 151.15442 155.88483 157.98723 163.11363 165.33302 167.09343 172.21983 174.43922 179.97963 184.66052 189.44492 194.63432 196.85371 202.46611 208.3215 213.86191 216.0813 221.3517 226.5717 231.8421 237.1125 241.7934 246.5238 251.20471 255.93512 261.79053 263.66794 265.88733 268.48474 272.51315 274.73254 280.27295 284.95386 289.73825 294.92764 297.14703 299.10544 303.12485">tempEIP := DEST AND 0000FFFFH; (* DEST is </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-427.98062" x="305.33969 308.5275 311.56229 318.57507 323.82388">r/m16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-427.98062" x="329.0997 331.31909 335.3403"> *)</tspan><tspan y="-415.98093" x="131.51999 133.61069 138.32939 140.5488 143.9175 148.6272 155.56889 160.22459 164.9433 167.034 172.1955 174.4149 176.3616 180.36931 182.58871 187.36142 192.08012 195.44882 197.66823 204.60992 206.55663 209.97662 214.71873 216.66544 221.43814 223.65755 227.55725 232.27596 236.93166 241.64136 243.83998 247.85489 252.5358 257.1987 264.14761 268.82849 273.63089 277.00677 279.2262 281.15311 283.07458 290.0235 291.94498 295.32086 297.54028 302.72519 308.57608 313.30197 319.15286 321.37228 327.14218 332.41708 337.53897 340.13187 345.39777 347.99066 349.86356 352.08298 356.80887 358.90677">IF tempEIP is not within code segment limit THEN #GP(0); FI;</tspan><tspan y="-403.98123" x="131.51999 133.62239 138.35278 140.57217 144.59157 147.97197 152.41167 156.31137 160.60077 162.82016 167.56226 172.30347 175.68387 177.90326 179.83466 184.31305 187.58545 192.25285 196.93376 199.15315 203.87456 208.61665 213.34705 218.08914 222.75655 227.49864 229.71803 233.06244 237.79285 241.06525 243.28464 247.72433 249.94373 255.21413 258.05453 262.72192 267.40732 270.78772 275.46863 277.68802 280.96042 285.64133 289.02173 293.80612 297.07852 301.86292 304.08231 308.522 313.18939 317.85678 321.12918 325.81009 329.8295 333.84891">IF stack not large enough for a 2-byte return address </tspan><tspan y="-391.98154" x="149.51999 154.70399 160.554 165.27901 171.12901 173.34842 179.11742 183.89642 188.63853 191.21793 196.48293 199.07492 200.94691 203.16632 207.89133 209.98833">THEN #SS(0); FI;</tspan><tspan y="-379.98184" x="131.51999 136.66888 141.41098 145.45288 150.25978 152.83919 154.93977 160.04097 162.62038">Push(IP);</tspan><tspan y="-367.98215" x="131.51999 133.62959 138.36719 140.58658 145.37817 150.12027 154.60587 159.22557 163.96317 170.86346 175.65506 179.04266 183.52826 187.44685 191.70656 196.44775 201.18985 205.68895 210.30865 212.23015 216.95876 221.57846 224.18306 228.92065 234.05426 238.53085">IF ShadowStackEnabled(CPL)</tspan><tspan y="-355.98245" x="149.51999 152.15878 156.18088 158.40028 160.44148 165.60298 167.82239 169.76999 173.77859 175.998 180.15961 184.87021 188.13181 192.85141 195.07082 199.78142 204.56403 207.93362 212.64423 217.41783 222.07443 226.78503 231.44164 233.64029 238.09169 242.89409 247.57318 249.79259 254.43298 259.23538 263.22778 268.03018 272.77048 277.3902 279.60959 284.10867 288.07047 290.28986 294.78894 297.00833 302.25174 307.53204 309.75143 314.43054 316.35205 319.70544 321.92484 326.60394 331.04364 332.94803 337.75046 342.44485 344.66425 349.40546 354.14755 356.36694 360.35934 365.16177 369.61316 374.29227 378.99567 385.95627 388.17566 392.16806 395.52145 399.97284 403.85724 408.17633 410.39572 414.39713">(* IP is zero extended and pushed as a 32 bit value on shadow stack *)</tspan><tspan y="-343.98276" x="149.51999 154.31339 159.10678 163.54648 168.22289 172.90378 179.86618 184.60828 187.99768 192.43738 196.35777 200.61748 205.75288 210.49498 214.52338 219.26547 224.54488 229.87828 232.48468 234.59608 239.73149 242.33789">ShadowStackPush4B(IP);</tspan><tspan y="-331.98306" x="131.51999 136.25488 138.36179">FI;</tspan><tspan y="-319.98337" x="131.51999 136.23509 138.32219 143.43329 145.65269 147.3978 152.5593 154.7787 158.1438 162.8499 169.78799 174.44009 179.1552 181.24229 186.35339">EIP := tempEIP;</tspan><tspan y="-307.98367" x="95.519989 100.25489 102.36179">FI;</tspan><tspan y="-295.98398" x="59.519989 64.246788 66.345589 68.219391 71.48819 76.205994 78.133797 81.267593 85.742393 90.362099">FI;rel/abs</tspan><tspan y="-283.98428" x="59.519989 61.613388 66.334785 68.554184 71.142586 75.863983 80.333382 82.255783 84.178185 86.397583 91.172981 95.885384 100.35478 103.61818 105.83758 107.78698 112.56238 117.22078 119.17018 122.43358 127.14598 131.04839 134.39999 136.23599 138.45538 142.89508 147.57419 151.59718 156.27808 158.21307 163.00107 166.36076 171.10107 173.32047 175.24197 180.04437 184.66408 186.64589 189.8877 194.62801 198.543 201.90269">IF (Call near indirect, absolute indirect)</tspan><tspan y="-271.98459" x="77.519989 79.623291 84.354591 86.57399 91.30529 96.047394 100.71569 105.33539 108.60869 113.04839 117.83369 121.74599 126.4881 131.22929 135.97139 140.47049 145.09019 147.07109 151.752 156.43111 162.0444 166.7865 171.4548 177.276 182.00729 185.3886 190.17389 194.91599 199.58429 204.25259 207.52589 212.2068 216.2271 220.24739 224.9697 229.5894 232.16879 236.90009 242.02739 246.4977">IF EndbranchEnabledAndNotSuppressed(CPL)</tspan><tspan y="-259.98489" x="95.519989 97.607986 102.32399 104.54339 109.25939 114.37139 118.82639 121.04579 126.15779 128.3772">IF CPL = 3</tspan><tspan y="-247.9852" x="113.51999 118.72919 124.55038 129.30058">THEN</tspan><tspan y="-235.9855" x="131.51999 133.61609 138.34019 140.5596 143.1507 145.3701 150.14821 154.87231 157.09172 162.35582 167.07993 172.92903 175.14844 179.80954 183.07564 187.79074 191.12885 193.08095 197.81854 200.03795 205.77005 211.19615 213.41556 215.51166 221.11775 226.38185 231.59999 236.15579 241.8456 246.4014 251.08231 255.80911 260.9949 262.7067 268.5585 274.2933 278.79419 283.97998 289.40878 295.01758 299.74438 305.0022 309.55798 314.28479 320.1366 322.35599 327.47879 332.60159 334.82098 340.04095 342.26035">IF ( no 3EH prefix OR IA32_U_CET.NO_TRACK_EN == 0 )</tspan><tspan y="-223.98581" x="149.51999 154.72919 160.55038 165.30058">THEN</tspan><tspan y="-211.98611" x="167.58029 169.66379 175.30319 180.55469 185.80618 190.34668 196.02118 200.56168 205.27318 209.98468 215.15518 216.85168 222.06989 227.48338 233.07689 237.78839 243.03088 247.74239 253.15588 255.37529 260.53677 262.75616 270.05066 275.64417 277.72766 282.94586 287.48636 292.19785 297.95605 303.35608 307.89658 312.60806 318.48865 324.00656 329.31207 334.77148 340.36499 346.20148 350.91296">IA32_U_CET.TRACKER = WAIT_FOR_ENDBRANCH</tspan><tspan y="-199.98642" x="131.51999 136.25488 138.36179">FI;</tspan><tspan y="-187.98672" x="113.51999 118.25489 122.72879 127.51769">ELSE</tspan><tspan y="-175.98703" x="131.51999 133.61609 138.34019 140.5596 143.1507 145.3701 150.14821 154.87231 157.09172 162.35582 167.07993 172.92903 175.14844 179.80954 183.07564 187.79074 191.12885 193.08095 197.81854 200.03795 205.77005 211.19615 213.41556 215.51166 221.11775 226.38185 231.59999 236.15309 240.9312 245.4843 250.16521 254.88931 260.07242 261.78152 267.63062 273.3627 277.9158 283.09891 288.52499 294.1311 298.85519 304.11029 308.66339 313.38748 319.23657 321.45599 326.57608 331.69617 333.91559 339.13559 341.35501">IF ( no 3EH prefix OR IA32_S_CET.NO_TRACK_EN == 0 )</tspan><tspan y="-163.98734" x="149.51999 154.72919 160.55038 165.30058">THEN</tspan><tspan y="-151.98764" x="167.58029 169.67369 175.27708 180.49709 185.77739 190.32779 195.1032 199.65359 204.375 209.05591 214.27411 215.98051 221.16092 226.58432 232.18771 236.90912 242.16151 246.88292 252.30632 254.52029 259.62509 261.84448 269.13629 274.72708 276.80789 282.02609 286.5639 291.27271 296.9895 302.44891 306.98672 311.69553 317.57614 323.09406 328.39685 333.85626 339.44705 345.28085 349.98965">IA32_S_CET.TRACKER = WAIT_FOR_ENDBRANCH</tspan><tspan y="-139.98795" x="131.51999 136.25488 138.36179">FI;</tspan><tspan y="-127.98824" x="95.519989 100.25489 102.36179">FI;</tspan><tspan y="-115.98854" x="77.519989 82.25489 84.361794">FI;</tspan><tspan y="-103.98884" x="59.519989 64.25489 66.361794">FI;</tspan><tspan y="-91.989136" x="46.019989 50.71529 52.815887 54.658188 56.877586 61.679985 66.420288 70.863586">FI; near</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="361.2012pt" height="644.73889pt" viewBox="0 0 361.2012 644.73889" sodipodi:docname="248.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.16613" inkscape:cy="423.83613" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg278" /><g transform="translate(-45.625401,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="45.119999 47.216099 51.940201 54.159599 57.4977 61.969799 65.235901 67.455299 71.360397 75.832497 77.757599 79.682701 81.9021 86.374199 91.152298 95.8134 98.032799 100.6239 105.744 110.4681">IF far call and (PE </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-715.97998" x="112.62 118.44063">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="121.26 126.4953 128.71469 133.45589 136.69769 138.91708 141.47939 146.64088 151.33618">0 or (PE </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-715.97998" x="153.53999 159.42038">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="162.17999 167.39999 169.61938 174.11848 178.86058 183.53969 185.75908 191.46059 198.00089">1 and VM </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-715.97998" x="200.22 206.04062">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="208.86 214.09981 216.66661 219.30542 221.52483 224.09163 228.08943 230.30884 235.71063 240.40143 244.90053 246.82204 249.63184 254.13094 258.76773 263.44684 266.68863 271.42892 275.41772 279.43982 281.65924 286.40045 289.61969 291.83908 296.49567 298.41718 301.69678 305.05649 309.79858 314.29767 316.23627 319.05685 324.33444 329.55444 334.83203 340.05203 342.27142 349.23203 353.96964 358.58932 363.32962 365.54901 369.58463">1)) (* Real-address or virtual-8086 mode *)</tspan><tspan y="-703.98029" x="58.619385 63.828587 69.649788 74.399986">THEN</tspan><tspan y="-691.98059" x="76.679688 78.775787 83.499886 85.719284 91.451385 96.112488 100.82759 104.09369 108.56579 113.34389 117.96359 122.76599 124.71809 128.8842">IF OperandSize</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-691.97998" x="133.5 136.32167"> =</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-691.97998" x="142.14 144.35939 149.63339"> 32</tspan><tspan y="-679.98029" x="94.680298 99.889496 105.71069 110.46089">THEN</tspan><tspan y="-667.98059" x="112.6803 114.7863 119.5203 121.7397 125.7627 129.1467 133.5864 137.48608 141.77908 143.99847 148.74057 153.48177 156.86577 159.08516 161.02016 165.50215 168.77815 173.44916 178.13007 180.34946 185.07446 189.81656 194.55055 199.29265 203.96365 208.70575 210.92514 214.27315 219.00714 222.28314 224.50253 228.98453 231.20392 236.42392 239.24451 243.91551 248.60451 251.98851 256.6694 258.88879 262.16479 266.8457 270.22971 274.9718 278.2478 283.0358 285.25519 289.69489 294.36588 299.03687 302.31287 306.99377 311.01678 315.03979">IF stack not large enough for a 6-byte return address </tspan><tspan y="-655.9809" x="130.6803 135.8598 141.70531 146.42581 152.27132 154.49072 160.25522 165.02972 169.77184 172.35123 177.61172 180.19922 182.06671 184.28612 189.00662 191.09912">THEN #SS(0); FI;</tspan><tspan y="-643.9812" x="112.6803 114.7818 119.5113 121.7307 127.2702 131.99969 136.74179 141.95999 144.72749 149.94749 155.217 156.9765 162.246 167.466 170.23351 172.4529 174.4104 178.42889 180.64828 185.39038 190.13159 193.51109 195.73048 199.90198 204.62248 207.89398 212.62349 214.78258 219.97108 225.82559 230.5065 236.3871 238.60649 244.37999 249.60089 254.72639 257.32291 262.54291 265.12231 266.99881 269.21823 273.89911 275.99973">IF DEST[31:16] is not zero THEN #GP(0); FI;</tspan><tspan y="-631.98151" x="112.6803 117.8139 122.556 126.5826 131.37419 133.97879 138.65968 143.45128 146.05588 147.94048 150.15987 152.76447 156.80006 159.01945 164.15306 168.59276 173.26736 177.88707 182.61568 187.23538 189.45477 196.41537 198.33688 201.72449 206.46658 208.68597 213.96358 219.18358 221.40297 226.19456 228.11607 232.79068 237.58228 240.42987 245.11076 248.39037 253.01007 257.73868 261.01828 263.23767 267.91226 269.83377 273.22137 277.1832 279.40259 283.4382">Push(CS); (* Padded with 16 high-order bits *)</tspan><tspan y="-619.98181" x="112.6803 117.8418 122.58389 126.59249 131.36609 133.95268 138.67229 140.76389 145.92538 148.51198">Push(EIP);</tspan><tspan y="-607.98212" x="112.6803 117.40079 122.17529 124.39469 126.1452 131.26169 133.48109 139.0116 143.7321 148.50661 153.68611 156.44461 161.70511 166.96561 168.71611 173.97661 179.23711 181.99561 183.9153 186.1347 188.7222 192.74069 194.9601 200.4906 205.21111 209.98561 215.16512 217.38452 219.33302 223.34253">CS := DEST[47:32]; (* DEST is </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-607.98212" x="225.48001 230.16092 233.40182 236.60762 241.87442 247.14122 248.97002 254.23682">ptr16:32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-607.98212" x="259.4397 261.65909 266.37958 269.64209 271.86148"> or [</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-607.98212" x="274.62 281.6535 286.923 292.1925 294.02402 299.29352">m16:32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-607.98212" x="304.5 307.26031 309.47974 313.50003">] *)</tspan><tspan y="-595.98242" x="112.68031 117.39632 119.48431 124.59631 126.81571 128.56171 133.72321 135.94261 141.46861 146.18462 150.95462 156.12962 158.88362 164.13962 169.39561 171.14162 176.39761 179.15161 181.07132 183.29073 185.87372 189.88773 192.10713 197.63313 202.34914 207.11914 212.29414 214.51355 216.49535 220.51746">EIP := DEST[31:0]; (* DEST is </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-595.98242" x="222.66031 227.34122 230.58212 233.78792 239.05472 244.32152 246.15031 251.41711">ptr16:32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-595.98242" x="256.62 258.83939 263.55988 266.82239 269.04178"> or [</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-595.98242" x="271.80029 278.8338 284.1033 289.3728 291.20432 296.47382">m16:32</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-595.98242" x="301.6803 304.44061 306.66003 310.68033">] *)</tspan><tspan y="-583.98273" x="94.680298 99.421494 103.86029 108.66269 113.40388 115.62328 118.18829 122.18429 124.40369 130.10968 134.78877 139.47777 142.77988 147.22588 152.02827 156.66327 161.46567 163.39166 167.59286">ELSE (* OperandSize</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-583.97998" x="172.2 174.96191 180.8423"> = </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-583.97998" x="183.60001 188.87041 194.09041 196.3098 200.3382">16 *)</tspan><tspan y="-571.98029" x="112.68001 114.78601 119.52001 121.73941 125.76241 129.14641 133.58611 137.48579 141.77879 143.99818 148.74028 153.48148 156.86548 159.08487 161.01987 165.50186 168.77786 173.44887 178.12978 180.34917 185.07417 189.81627 194.55026 199.29236 203.96336 208.70546 210.92485 214.27286 219.00685 222.28285 224.50224 228.98424 231.20363 236.42363 239.24422 243.91522 248.60422 251.98822 256.66913 258.88852 262.16452 266.84543 270.22943 274.97153 278.24753 283.03552 285.25491 289.69461 294.3656 299.03659 302.31259 306.9935 311.01651 315.03952">IF stack not large enough for a 4-byte return address </tspan><tspan y="-559.98059" x="130.68001 135.85951 141.70502 146.42552 152.27103 154.49043 160.25493 165.02943 169.77155 172.35094 177.61143 180.19893 182.06642 184.28583 189.00633 191.09883">THEN #SS(0); FI;</tspan><tspan y="-547.9809" x="112.68001 117.82801 122.57011 126.61111 131.41711 133.99652 138.67741 143.48341 146.06282">Push(CS);</tspan><tspan y="-535.9812" x="112.68001 117.82891 122.57101 126.61292 131.41982 133.99922 136.09981 141.201 143.78041">Push(IP);</tspan><tspan y="-523.98151" x="112.68001 117.40051 122.175 124.3944 126.14491 131.2614 133.4808 139.01131 143.73181 148.50632 153.68582 156.44432 161.70482 166.96532 168.71582 173.97632 179.23682 181.99532 183.91501 186.13441 188.72191 192.7404 194.95981 200.49031 205.21082 209.98532 215.16483 217.38423 219.33273 223.34224">CS := DEST[31:16]; (* DEST is </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-523.98151" x="225.47971 230.16061 233.40152 236.60732 241.87411 247.14091 248.96971 254.23651">ptr16:16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-523.98151" x="259.43939 261.65878 266.37927 269.64178 271.86118"> or [</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-523.98151" x="274.61969 281.6532 286.9227 292.1922 294.02371 299.29321">m16:16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-523.98151" x="304.49969 307.26001 309.47943 313.49973">] *)</tspan><tspan y="-511.98181" x="112.68001 117.39601 119.48401 124.59601 126.81541 128.5614 133.7229 135.94231 141.46831 146.18431 150.95432 156.12932 158.88332 164.13931 169.39531 171.14131 176.39731 179.15131 181.07101 183.29042 185.87341 189.88742 192.10683 197.63283 202.34883 207.11884 212.29384 214.51324 216.49504 220.51715">EIP := DEST[15:0]; (* DEST is </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-511.98181" x="222.66 227.34091 230.58182 233.78761 239.05441 244.32121 246.15001 251.41681">ptr16:16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-511.98181" x="256.61969 258.83908 263.55957 266.82208 269.04147"> or [</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c36E3F4EC"><tspan y="-511.98181" x="271.79999 278.8335 284.103 289.3725 291.20401 296.47351">m16:16</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-511.98181" x="301.67999 304.42319 306.27539 308.49478 312.38098 314.28717 319.02747 323.46716 326.76926 328.98865 333.74783 338.42694 343.06915 347.80945 351.05664 353.27603 358.55634 363.83664 366.05603 370.69824 372.68005 376.03525 380.05734 382.27673 386.27994">]; clear upper 16 bits *)</tspan><tspan y="-499.98212" x="76.679993 81.414894 83.521797">FI;</tspan><tspan y="-487.98242" x="45.11969 49.800591 51.901188">FI;</tspan><tspan y="-463.98212" x="45.11969 47.21579 51.939888 54.159286 57.497387 61.969486 65.235588 67.454987 71.360085 75.832184 77.757286 79.682388 81.901787 86.373886 91.151985 95.813087 98.032486 100.62359 105.74369 110.46779">IF far call and (PE </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-463.98001" x="112.62 118.44063">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-463.98001" x="121.26 126.4836 128.703 133.2021 137.9442 142.62331 144.8427 150.4803 157.0809">1 and VM </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-463.98001" x="159.3 165.12062">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-463.98001" x="167.88 173.1468 175.7406 177.95999 180.55379 184.57858 186.79797 191.92078 195.18958 199.91638 203.29318 207.97409 211.87379 215.2506 219.9684 224.5881 226.8075 233.75729 238.4841 243.10381 247.84412 250.06351 254.74442 258.04651 260.2659 262.36469 267.97348 270.81027 276.07709 281.34387 286.02032 288.23972 294.8403 299.52118 304.17148 308.87579 310.73431 312.9537 317.72101 322.4343 325.79761 328.017 332.64929 334.6311 337.88641 341.24973 346.05212 350.49182 352.40613 355.28702 360.54031 365.79361 371.04691 376.3002 378.51959 385.4559 390.16919 394.81949 399.5238 403.5351">0) (* Protected mode or IA-32e Mode, not virtual-8086 mode*)</tspan><tspan y="-451.98032" x="58.620026 63.829227 69.650429 74.400627">THEN</tspan><tspan y="-439.98062" x="76.680328 78.771027 83.489731 85.709129 89.716827 94.426529 99.08223 106.02393 110.73363 115.50632 118.87502 121.09442 125.10212 129.81181 131.73151 136.44121 140.34091 143.70961 148.39052 151.69261 153.91202 155.85872 160.68002 162.89941 166.28792 170.72762 174.00812 178.62782 183.35733 186.74583 188.96523 193.70372 198.32343 203.05293 206.29474 210.78123 215.52333 220.19884 222.41823 228.23943 233.94093 238.37973 242.81853">IF segment selector in target operand NULL </tspan><tspan y="-427.98093" x="94.680321 99.860718 105.70712 110.42851 116.27491 118.49431 124.25971 129.53011 134.64751 137.2359 142.4973 145.08569 146.95409 149.17349 153.8949 155.9883">THEN #GP(0); FI;</tspan><tspan y="-415.98123" x="76.680321 78.77372 83.495117 85.714516 89.724915 94.437317 99.095718 106.04012 110.75252 115.52792 118.89931 121.11871 125.12911 129.84151 131.7639 136.4763 140.37871 143.75011 148.43102 151.73311 153.95251 155.90192 160.67732 165.29703 170.03732 174.82172 177.04112 181.81653 186.53793 189.90933 192.12062 199.07582 200.99733 204.37953 209.16573 211.08723 215.88963 218.10902 222.77823 227.45914 231.48033 235.39352 238.66772 240.62793 245.24763 248.60733 253.33954 256.61374 258.83313 262.21533 266.65503 271.32422 273.25742 277.93832 280.15771 282.09091 284.05112 290.95142 292.93323 296.31543">IF segment selector index not within descriptor table limits</tspan><tspan y="-403.98154" x="94.680321 99.876022 105.69723 110.43393 116.25513 118.47454 124.25524 129.54094 134.64215 137.22154 142.01224 146.69315 153.65285 155.87224 159.78993 164.52663 169.14633 173.88664 176.10603 180.13173 184.80002 189.47911 196.37941 201.11971 205.8618 209.21429 211.4337 215.4558 220.19609 222.09959 226.79309 230.67659 234.09659 238.79909 242.1012 244.6707 246.5202 248.73961 253.44211 255.54269">THEN #GP(new code segment selector); FI;</tspan><tspan y="-391.98184" x="76.680321 82.121719 86.80262 91.290024 95.909721 98.129128 101.51852 106.13822 110.81462 115.49552 117.71493 122.20233 126.94444 131.62083 133.84023 138.32762 142.24802 146.16841 150.84932 154.87772 158.90611 161.1255 164.36731 166.34912 170.96883 175.77122 179.16063 183.18903 185.40842 190.08931 193.44002 195.65942 199.66893 204.38043 206.30193 211.01343 214.91493 218.28543 222.99693 227.65443 229.87384 233.88335 238.59485 243.25235 250.19585 254.90735 259.68185 263.05237 265.27176 269.89145 274.63174 278.64124 282.54272 285.80524 287.75372 292.37341 295.73312 300.45361 303.71613">Read type and access rights of selected segment descriptor;</tspan><tspan y="-379.98215" x="76.680321 78.776421 83.500519 85.719917 87.816017 93.422119 98.686218 103.90622 108.45932 113.18342 117.90752 122.58842 128.01451 129.72362 134.18672 140.76482 146.37091 148.59032 153.71042 155.92982">IF IA32_EFER.LMA = 0</tspan><tspan y="-367.98245" x="94.680321 99.889519 105.71072 110.46091">THEN</tspan><tspan y="-355.98276" x="112.68032 114.78812 119.52393 121.74333 125.76814 130.44904 135.12184 142.08064 146.76155 151.56395 154.94975 157.16914 160.55495 165.24574 169.86545 174.60576 176.82515 178.74666 182.76875 184.98814 189.77794 194.45883 197.84464 200.06403 204.50372 206.72311 210.63991 215.3757 220.1178 223.47659 228.15749 231.45959 238.35989 240.34171 245.1315 249.75121 251.9706 256.70639 259.94818 262.16757 266.95737 271.63828 276.42807 280.34488 285.08069 289.82278 293.17258 297.85349 301.13129 308.03159 309.99539 314.73749 319.41028 321.62967 325.54648 330.28229 334.90198 339.64227 341.86166 345.88647 350.56738 355.24017 362.14047 366.86728 371.60938 374.99518 376.83298 379.05237 382.96918 387.40887 389.34567 391.28247">IF segment type is not a conforming or nonconforming code segment, call </tspan><tspan y="-343.98306" x="112.68032 117.33602 121.80272 125.17142 129.88112 131.73961 133.95901 137.32771 141.79442 145.80212 150.07982 152.29922 156.95493 161.42163 164.84163 169.52254 171.34323 173.56264 178.28134 181.54204 183.76144 188.97964 193.72176 198.49446">gate, task gate, or TSS </tspan><tspan y="-331.98337" x="130.68033 135.85983 141.70534 146.42584 152.27135 154.49075 160.25525 165.52475 170.64125 173.22874 177.23825 181.94975 186.56946 193.53006 198.21097 203.01337 206.38387 208.60327 212.61278 217.29369 219.21518 223.92668 227.82819 231.19868 235.91919 239.18169 241.76918 243.63667 245.85608 250.57658 252.66908">THEN #GP(segment selector); FI;</tspan><tspan y="-319.98367" x="94.680328 99.413429 103.88553 108.67263 113.40573">ELSE </tspan><tspan y="-307.98398" x="112.68033 114.78993 119.52753 121.74694 125.77354 130.45445 135.12906 142.08966 146.77057 151.57297 154.96057 157.17996 160.56757 165.26016 169.87987 174.62018 176.83957 178.76108 182.78317 185.00256 189.79416 194.47505 197.86266 200.08205 204.52174 206.74113 210.65973 215.39732 220.13942 223.49821 228.17911 231.48122 238.38152 240.36333 245.15492 249.77463 251.99402 256.73163 259.97342 262.19281 266.98441 271.66531 276.45691 280.37552 285.11313 289.85522 293.20682 297.88773 301.16733 308.06763 310.03323 314.77533 319.44992 321.66931 325.58792 330.32553 334.94522 339.68552 341.90491 345.93152 350.61243 355.28702 362.18732 366.91592 371.65802 375.04562 377.26501 382.00262 385.24442">IF segment type is not a conforming or nonconforming code segment or </tspan><tspan y="-295.98428" x="112.68033 117.93993 123.19952 126.02912 130.68571 132.63332 136.00291 138.22232 142.12292 146.59053 148.51112 150.43172 152.65112 157.30772 161.77533 165.14493 169.85553 171.71402">64-bit call gate, </tspan><tspan y="-283.98459" x="130.68033 135.85983 141.70534 146.42584 152.27135 154.49075 160.25525 165.52475 170.64125 173.22874 177.23825 181.94975 186.56946 193.53006 198.21097 203.01337 206.38387 208.60327 212.61278 217.29369 219.21518 223.92668 227.82819 231.19868 235.91919 239.18169 241.76918 243.63667 245.85608 250.57658 252.66908">THEN #GP(segment selector); FI;</tspan><tspan y="-271.98489" x="76.680328 81.41523 83.522133">FI;</tspan><tspan y="-259.9852" x="76.680328 82.23333 86.91423 91.594231 96.275131 101.07213 105.69183 107.66283 112.40492 117.08492 119.30432 124.04732 128.78941 131.0088 134.40181 139.09981 143.7798 148.46069 150.68008 155.17108 159.91318 164.59317 166.81256 171.25226 175.17625 179.10025 183.83424 187.86624 191.82803 194.04742 197.33243 199.25392 203.93391 208.67601 212.06902 216.03081">Depending on type and access rights:</tspan><tspan y="-247.9855" x="94.680328 99.960632 105.69994 107.91933 113.10963 118.80754 121.02694 125.75824 131.45615 137.31244 141.99333 147.73264 153.16594 159.75124 161.85454 167.71085 172.99115 175.83244 180.56375 186.26166 191.77956 196.51086 199.35216 204.13745 208.81834 214.09865 220.63895 225.37024 231.22653 236.41684">GO TO CONFORMING-CODE-SEGMENT;</tspan><tspan y="-235.98581" x="94.680328 99.969627 105.71793 107.93732 113.09613 118.79403 121.01343 126.87873 132.57663 138.44193 143.12282 148.87112 154.69232 159.43262 165.13052 170.53053 177.13113 179.24344 185.06464 190.35394 193.20424 197.94453 203.64244 209.16034 213.90154 216.75183 221.54613 226.22702 231.50732 238.10162 242.78252 248.64781 253.80661">GO TO NONCONFORMING-CODE-SEGMENT;</tspan><tspan y="-223.98611" x="94.680328 99.95163 105.68193 107.90133 113.08263 118.81293 121.03233 125.75462 131.35892 135.82022 140.28152 143.11383 148.38513 153.98943 159.17073 163.85164">GO TO CALL-GATE;</tspan><tspan y="-211.98642" x="94.680328 99.95163 105.68193 107.90133 113.08263 118.81293 121.03233 126.21362 131.81792 136.59422 141.84752 144.67982 149.95113 155.55542 160.73672 165.41763">GO TO TASK-GATE;</tspan><tspan y="-199.98672" x="94.680328 99.938126 105.69632 107.91573 113.08353 118.80032 121.01973 126.23793 131.81793 136.62033 141.84033 144.65913 149.46153 154.62933 160.22014 165.43834 170.11925 172.93805 177.74045 182.44925 187.70705 194.30765 199.04884 204.88264 210.05045">GO TO TASK-STATE-SEGMENT;</tspan><tspan y="-187.98703" x="45.120029 49.80093 51.901527">FI;</tspan><tspan y="-163.98672" x="45.120029 49.820732 55.578934 61.404633 66.105331 71.814034 77.273438 83.82814 85.900841 91.72654 96.976242 99.786942 104.48764 110.19634 115.77454 120.47524 123.28594 128.08835 132.82954 138.07924 144.67984 149.38054 155.20624 160.36594">CONFORMING-CODE-SEGMENT:</tspan><tspan y="-151.98703" x="58.620029 60.721531 65.451035 67.670433 72.138931 74.35833 79.024826 80.982323 84.361824">IF L bit </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-151.98" x="86.580002 92.400627">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-151.98" x="95.160004 100.4403 102.6597 107.0994 111.90179 116.53049 118.74989 124.32809 126.54749 131.17619 133.15799 136.49969">1 and D bit </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-151.98" x="138.72">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-151.98" x="144.53999 146.75938 152.03339 154.25278 158.69247 163.49487 168.11458 170.33397 172.43997 178.05597 183.27597 188.55627 193.11928 197.80017 202.53416 207.21506 212.65106 214.37006 218.84306 225.38336 230.99936"> 1 and IA32_EFER.LMA </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-151.98" x="233.22">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-151.98" x="239.10001 241.3194 246.5529"> 1 </tspan><tspan y="-139.9803" x="76.679718 81.861916 87.710114 92.433311 98.281509 100.50091 105.77311 110.89231 113.48251 118.25971 122.97392 129.92012 132.13953 136.04373 140.76694 145.42714 150.14134 152.36075 156.37296 161.03941 165.70592 172.60622 177.32672 182.06882 185.44832 187.66771 191.6862 196.40671 198.3372 203.01811 206.92862 210.30812 215.03763 218.30913 220.90562 222.78212 225.00151 229.68242 231.78302">THEN GP(new code segment selector); FI;</tspan><tspan y="-127.9806" x="58.619415 60.723614 65.455811 67.675209 73.217407 78.345604 82.816803">IF DPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-127.9806" x="85.019119">&gt;</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-127.9806" x="89.939423 92.158829 96.872131 101.98143 106.43373"> CPL </tspan><tspan y="-115.9809" x="76.679726 81.875427 87.696632 92.433334 98.254539 100.47395 106.25465 111.54034 116.64154 119.22094 124.01164 128.69255 135.65225 137.87164 141.78934 146.52603 151.14574 155.88605 158.10544 162.13113 166.79942 171.47852 178.37881 183.11911 187.86121 191.2137 193.43311 197.4552 202.1955 204.099 208.7925 212.67599 216.09599 220.79849 224.1006 226.6701 228.51961 230.73901 235.44151 237.5421">THEN #GP(new code segment selector); FI;</tspan><tspan y="-103.98119" x="58.619415 60.710114 65.428818 67.648216 71.655914 76.365616 81.021317 87.963013 92.672714 97.445412 100.81411 103.03351 107.80621 112.5249 115.8936 118.113 122.7687 126.0294 130.73909 134.7468 139.4565 144.2292 147.6492">IF segment not present </tspan><tspan y="-91.981491" x="76.679718 81.864616 87.715515 92.441414 98.292313 100.51171 106.28161 112.13251 117.25441 119.84731 124.58941 129.32971 136.27861 138.49802 142.40492 147.08583 151.74873 156.42964 158.64905 162.66394 167.38084 172.00055 178.96115 183.64206 188.44447 191.82037 194.03978 198.05469 202.7356 204.66249 209.37939 213.2863 216.6622 221.38811 224.65601 227.2489 229.1218 231.3412 236.06711 238.16501">THEN #NP(new code segment selector); FI;</tspan><tspan y="-79.981789" x="58.619415 60.703815 65.416214 67.63562 71.637024 74.999428 79.459831 83.353233 87.672333 89.891739 94.658142 99.370544 102.73295 104.95235 106.86575 111.36485 114.61926 119.26865 123.97205 126.19146 130.93176 135.67386 140.38626 145.15266 149.80206 154.56847 156.78787 160.11427 164.82668 168.08107 170.30048 173.55487 178.29517 181.65756 186.45996 189.71436 194.51675 196.73616 201.19656 205.84596 210.49536 213.79745 218.50085 222.50226">IF stack not large enough for return address</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="423.75095pt" height="644.69342pt" viewBox="0 0 423.75095 644.69342" sodipodi:docname="249.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.64" inkscape:cy="423.83409" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg166" /><g transform="translate(-46.019997,-69.182129)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="77.519997 82.703995 88.553993 93.278992 99.12899 101.34839 107.11739 111.89639 116.63848 119.21788 124.48288 127.07488 128.94688 131.16629 135.8913 137.9883">THEN #SS(0); FI;</tspan><tspan y="-703.98029" x="59.519997 62.914799 67.595695 74.563492 79.183189 83.927994 86.044792 91.145996 93.365395 95.106895 100.26839 102.48779 108.00569 112.68658 117.48538 122.64418 125.22358 130.98178 134.28117 137.63997 141.67377 146.35466 149.71437 152.29378">tempEIP := DEST(Offset);</tspan><tspan y="-691.98059" x="59.519997 61.619698 66.347397 68.566795 71.944496 76.420197 79.689896 84.354599 89.0355 92.395203 94.614601 101.5653 106.2462 110.9109 115.62961 117.84901 122.97271 125.19211 129.87302 134.61423 141.56493 146.18463 150.66032 154.03802 155.99373 160.65843 162.61414 164.54283 166.49854 169.87624 174.55893 176.77832 183.72902 188.40993 193.07463">IF target mode = Compatibility mode</tspan><tspan y="-679.9809" x="46.019997 48.238495 50.456993 52.675491 77.513687 82.699486 88.551285 93.278084 99.129883 101.34838 104.72518 109.44298 116.34328 121.02238 125.74918 127.84798 132.97078 135.18929 136.94609 142.06889 144.2874 147.6642 152.382 159.3318 163.95151 168.67831 170.77711 175.89992 178.11842 183.72722 189.57903 195.11583 197.33434 202.55434 207.82114 213.08794 218.30794 223.57474 228.79474 234.06154 239.32834 243.88414 248.56505 253.30626 257.98715 262.71396 267.44077 272.12167 276.84848 281.57529 287.42709 289.3009 291.51941 296.24622 298.345">    THEN tempEIP := tempEIP AND 00000000_FFFFFFFFH; FI;</tspan><tspan y="-667.9812" x="59.519997 61.589996 66.331192 68.550591 74.256592 78.935692 83.624695 86.926796 91.372795 96.175194 100.8102 105.61259 107.5386 111.7398">IF OperandSize</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-667.97998" x="116.4 119.22167"> =</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-667.97998" x="125.04"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-667.97998" x="127.2603 132.5406">16</tspan><tspan y="-655.98029" x="77.520004 82.729202 88.5504 93.300598">THEN</tspan><tspan y="-643.98059" x="95.520004 98.902206 103.58311 110.53831 115.158 119.89021 121.99441 127.1226 129.342 131.1042 136.23241 138.4518 141.834 146.51491 153.47011 158.08981 162.82202 164.92622 170.05443 172.27382 177.88802 183.74521 189.28741 191.50681 196.77901 201.99901 207.27121 212.54341 217.2243 221.95651 226.68872 231.36963 237.22684 239.10603 241.32542 246.00632 248.10692 249.98611 252.20551 254.8047 258.76651 260.9859 265.71811 267.65131 272.37451 276.81421 280.08841 282.3078 287.09399 291.76318 296.38287 301.12317 304.39737 306.61676 311.88895 317.10895 319.32834 323.99753 325.91904 329.30124 333.26306 335.48245 339.51266">tempEIP := tempEIP AND 0000FFFFH; FI; (* Clear upper 16 bits *)</tspan><tspan y="-631.9809" x="59.520004 61.620605 66.361801 68.5812 71.148903 73.249504 78.832207 84.112503 89.392799 93.8937 98.634895 103.37609 108.05699 113.5164 115.19669 119.63639 126.23699 131.81969 134.03909 139.13579 141.35519 146.6355 148.8549 153.5961 156.83791 159.05731 162.40802 166.90712 170.14983 174.82892 179.52061 182.87131 185.09071 192.05132 196.79251 201.43021 206.1705 208.38991 213.4866 215.70601 220.4472 225.1281 232.0887 236.70839 241.20749 244.5672 246.549 251.16869 253.15048 255.07199 257.0007 260.35141 265.00711 267.2265 274.1871 278.92831 283.56601 288.30634 290.87402 293.09341 297.54211 302.34451 306.98221 309.2016 311.84039 315.2001 319.89182 326.85242 331.49011 336.23132 338.33191 343.43311 345.6525 350.39371 355.1358 358.55582 362.51761 364.49942 369.17853 373.87024 376.08963 380.89203 385.57294 392.53354 394.75293 398.63464 403.33536 408.01447 412.69537 414.91476 418.93686 423.67719 428.31488 435.27548 439.96719 444.76959 448.1203 450.33969 452.24139 454.22321 461.14691 463.12872 466.47943 469.04712">IF (IA32_EFER.LMA = 0 or target mode = Compatibility mode) and (tempEIP outside new code segment limit) </tspan><tspan y="-619.9812" x="77.520004 82.700401 88.546799 93.268196 99.114594 101.33399 107.0994 112.3698 117.4872 120.0756 125.337 127.9254 129.79379 132.0132 136.7346 138.828">THEN #GP(0); FI;</tspan><tspan y="-607.98151" x="59.520004 61.626003 66.360001 68.579399 71.963402 76.6884 83.588699 88.267799 92.9487 95.049301 100.1793 102.3987 104.3202 108.3423 110.5617 115.3038 120.04501 124.83301 127.67701 131.59201 136.03171 140.8197 145.5006 150.28859 152.2506 156.16559 160.60529 162.54028">IF tempEIP is non-canonical </tspan><tspan y="-595.98181" x="77.520004 82.700401 88.546799 93.268196 99.114594 101.33399 107.0994 112.3698 117.4872 120.0756 125.337 127.9254 129.79379 132.0132 136.7346 138.828">THEN #GP(0); FI;</tspan><tspan y="-583.98212" x="59.520004 61.627804 66.363602 68.583008 73.325111 78.127518 82.567223 87.246323 91.982124 98.882423 103.67223 107.05803 111.54183 115.45863 119.71833 124.39923 129.18903 133.62872 138.30153 140.23833 144.96513 149.58484 152.18764 156.92343 162.05524 166.53003">IF ShadowStackEnabled(CPL)</tspan><tspan y="-571.98242" x="77.520004 79.587303 84.328499 86.547897 92.251198 96.930298 101.6166 104.91869 109.36199 114.16439 118.79669 123.59909 125.52239 129.7236 134.4099 136.62929 141.79079 144.01018 149.24548">IF OperandSize = 32</tspan><tspan y="-559.98273" x="95.520004 100.7292 106.5504 111.3006">THEN</tspan><tspan y="-547.98303" x="113.52 116.94 121.6209 128.55721 133.2075 138.369 143.1111 147.1134 151.88071 156.37981 158.48041 163.58971 165.80911 170.91841 173.13782 177.85112 182.61842 187.92572 193.52103 198.28833 203.00163 205.22104 210.38434 212.60374 217.31705 219.40234 224.51164">tempPushLIP = CSBASE + EIP;</tspan><tspan y="-535.98334" x="95.520004 100.25491 104.72881 109.51771">ELSE</tspan><tspan y="-523.98364" x="113.52 115.5873 120.3285 122.5479 128.25119 132.93028 137.61658 140.91869 145.36198 150.16438 154.79668 159.59908 161.52237 165.72357 170.40987 172.62926 177.79076 180.01015 185.24545">IF OperandSize = 16</tspan><tspan y="-511.98395" x="131.52 136.7292 142.5504 147.3006">THEN</tspan><tspan y="-499.98425" x="149.52 152.94 157.6209 164.5509 169.1949 174.3564 179.0985 183.0945 187.8555 192.3546 194.4552 199.5582 201.7776 206.8806 209.10001 213.80701 218.56801 223.869 229.45801 234.21901 238.92601 241.14542 246.36362 248.58302 250.66202 255.82352">tempPushLIP = CSBASE + IP;</tspan><tspan y="-487.98456" x="131.52 136.2612 140.7 145.5024 150.24359 152.46298 155.02438 159.01678 161.23618 166.93857 171.61766 176.30305 179.60516 184.04756 188.84996 193.48135 198.28375 200.20615 204.40735 209.09274 211.31213 216.40253 218.62192 223.90222 229.18253 231.40192 235.39432">ELSE (* OperandSize = 64 *)</tspan><tspan y="-475.98486" x="149.52 152.94 157.6209 164.55269 169.19849 174.35999 179.10208 183.09988 187.86269 192.36179 194.46239 199.56718 201.78659 206.89139 209.11079 214.52159 216.60239 221.76389">tempPushLIP = RIP;</tspan><tspan y="-463.98517" x="113.52 118.25491 120.36181">FI;</tspan><tspan y="-451.98547" x="77.520004 82.254906 84.361809">FI;</tspan><tspan y="-439.98578" x="77.520004 80.911201 85.592102 92.556305 97.176003 102.3132 107.0553 111.08549 115.82759 120.56879 125.364 127.5834 132.7206 134.93999 139.68118 144.42328">tempPushCS = CS;</tspan><tspan y="-427.98608" x="59.520004 64.254906 66.361809">FI;</tspan><tspan y="-415.98639" x="59.520004 61.589104 66.330299 68.549698 74.254799 78.933899 83.622002 86.924103 91.369202 96.1716 100.8057 105.6081 107.5332 111.73441 116.42251">IF OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-415.98001" x="118.62 124.50039">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-415.98001" x="127.26 132.5403">32</tspan><tspan y="-403.98032" x="77.519699 82.728897 88.550095 93.300293">THEN</tspan><tspan y="-391.98062" x="95.519699 100.6515 105.3936 109.4184 114.20821 116.811 121.49191 126.28171 128.88451 130.7673 132.98669 135.58949 139.62329 141.84268 146.97449 151.41418 156.08699 160.7067 165.4335 170.05321 172.2726 179.2314 181.15291 184.53871 189.28081 191.5002 196.776 201.996 204.21539 209.00519 210.9267 215.5995 220.3893 223.23509 227.91599 231.19379 235.81349 240.5403 243.8181 246.03749 250.7103 252.63181 256.01761 260.04242 262.26181 266.29562">Push(CS); (* Padded with 16 high-order bits *)</tspan><tspan y="-379.98093" x="95.519699 100.6677 105.4098 109.4508 114.2568 116.8362 121.51711 123.64111 128.74231 131.36131">Push(EIP);</tspan><tspan y="-367.98123" x="95.519699 100.26089 105.06329 107.28269 109.01069 114.10469 116.32409 121.83209 126.57329 131.32529 136.54349 139.10849 143.80649 148.54768 153.22678 157.91577 162.71817 167.40717 172.08626 179.00726 183.74756 188.49956 191.91957 196.67157 201.41187 203.31087 207.99986 211.87886 215.22687 219.96806 223.20987 225.84868 227.70898">CS := DEST(CodeSegmentSelector); </tspan><tspan y="-355.98154" x="95.519699 98.158501 102.1806 104.4 109.1511 113.8914 118.52551 125.4861 130.17419 134.97659 138.3237 140.54311 145.2222 149.90309 153.92519 157.82489 161.064 163.04579 167.67989 171.0999 175.797 179.09911 181.31851 183.24361 188.04601 191.3571 196.0983 199.3374 206.298 210.7431 214.09021 216.07201 220.8132 225.5643 227.78371 232.28281 234.20432 238.19041 242.93161 245.15102 247.04912 251.79031 256.23541 260.91452 265.60263 270.28174 272.50113 276.49622">(* Segment descriptor information also loaded *)</tspan><tspan y="-343.98184" x="95.519699 100.2339 105.00211 107.58331 112.9995 118.1097 122.6088 125.19 127.4094 129.15359 134.26379 136.4832 141.1974 146.3076 150.7608">CS(RPL) := CPL;</tspan><tspan y="-331.98215" x="95.519699 100.2348 102.3219 107.433 109.6524 111.3975 116.559 118.7784 122.14349 126.84959 133.78769 138.43979 143.15489 145.24199 150.35309">EIP := tempEIP;</tspan><tspan y="-319.98245" x="77.519699 82.254601 86.7285 91.517403">ELSE</tspan><tspan y="-307.98276" x="95.519699 97.588799 102.32999 104.54939 110.25449 114.93359 119.6217 122.9238 127.3689 132.1713 136.80539 141.60779 143.53288 147.73409 152.42218">IF OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-307.98001" x="154.62">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-307.98001" x="160.5 162.71939 167.9529"> 16</tspan><tspan y="-295.98032" x="113.52 118.7292 124.5504 129.3006">THEN</tspan><tspan y="-283.98062" x="131.52 136.668 141.4101 145.4511 150.2571 152.8365 157.5174 162.32339 164.9028">Push(CS);</tspan><tspan y="-271.98093" x="131.52 136.6689 141.411 145.4529 150.2598 152.8392 154.93979 160.04099 162.62039">Push(IP);</tspan><tspan y="-259.98123" x="131.52 136.2612 141.0636 143.283 145.011 150.105 152.3244 157.8324 162.57359 167.32559 172.54379 175.1088 179.80679 184.54799 189.22708 193.91608 198.71848 203.40747 208.08656 215.00757 219.74786 224.49986 227.91988 232.67188 237.41217 239.31117 244.00017 247.87917 251.22717 255.96837 259.21017 261.84897 263.70926">CS := DEST(CodeSegmentSelector); </tspan><tspan y="-247.98154" x="131.52 134.15881 138.18091 140.40031 145.15231 149.89261 154.5276 161.4882 166.1772 170.9796 174.32761 176.54701 181.2261 185.907 189.92909 193.8288 197.0688 199.0506 203.68559 207.10561 211.8036 215.10571 217.32512 219.25111 224.05351 227.36551 232.1067 235.34671 242.30731 246.75331 250.17332 252.09932 256.84055 261.59256 263.81198 268.3111 270.23257 274.25467 278.93558 281.155 283.05399 287.7952 292.24121 296.92032 301.60931 306.28842 308.50784 312.50385">(* Segment descriptor information also loaded *)</tspan><tspan y="-235.98184" x="131.52 136.23421 141.00241 143.58362 148.99982 154.11002 158.60912 161.19032 163.40973 165.15393 170.26413 172.48354 177.19774 182.30794 186.76114">CS(RPL) := CPL;</tspan><tspan y="-223.98215" x="131.52 136.23511 138.3222 143.4333 145.65271 147.39781 152.55931 154.77872 158.14381 162.84991 169.78801 174.44011 179.15521 181.24231 186.35341">EIP := tempEIP;</tspan><tspan y="-211.98245" x="113.52 118.2612 122.7 127.5024 132.24359 134.463 137.0271 141.0222 143.24161 148.9467 153.62579 158.31389 161.616 166.0611 170.86349 175.49759 180.29999 182.22508 186.42628 191.11438">ELSE (* OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-211.98" x="193.32001">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-211.98" x="199.14 201.35939 206.63159 211.90379 214.12318 218.15338"> 64 *)</tspan><tspan y="-199.9803" x="131.52029 136.6539 141.396 145.42259 150.21419 152.81879 157.49968 162.29128 164.89587 166.78047 168.99986 171.60446 175.64006 177.85945 182.99306 187.43275 192.10736 196.72707 201.45567 206.07538 208.29477 215.25537 217.17688 220.56448 225.30658 227.52597 232.80357 238.02357 240.24297 245.03456 246.95607 251.63068 256.42227 259.26987 263.95078 267.23038 271.85007 276.57867 279.85828 282.07767 286.75226 288.67377 292.06137 296.02319 298.24258 302.2782">Push(CS); (* Padded with 48 high-order bits *)</tspan><tspan y="-187.98061" x="131.52029 136.68179 141.4239 145.43161 150.20432 152.79001 158.21071 160.30141 165.41611 168.0018">Push(RIP);</tspan><tspan y="-175.98091" x="131.52029 136.26149 141.06389 143.28329 145.01129 150.10529 152.32469 157.83269 162.57388 167.32588 172.54408 175.10909 179.80708 184.54828 189.22737 193.91637 198.71877 203.40776 208.08685 215.00786 219.74815 224.50015 227.92017 232.67216 237.41246 239.31146 244.00046 247.87946 251.22746 255.96866 259.21045 261.84924 263.70953">CS := DEST(CodeSegmentSelector); </tspan><tspan y="-163.98122" x="131.52029 134.1591 138.1812 140.4006 145.1526 149.8929 154.52789 161.48849 166.17749 170.97989 174.3279 176.5473 181.22639 185.90729 189.92938 193.82909 197.06909 199.05089 203.68588 207.1059 211.80389 215.106 217.32541 219.2514 224.0538 227.3658 232.10699 235.347 242.3076 246.7536 250.17361 252.09961 256.84082 261.59283 263.81226 268.31137 270.23285 274.25494 278.93585 281.15527 283.05426 287.79547 292.24149 296.92059 301.60959 306.2887 308.50812 312.50412">(* Segment descriptor information also loaded *)</tspan><tspan y="-151.98152" x="131.52029 136.2345 141.0027 143.58391 149.00011 154.11031 158.60941 161.19061 163.41002 165.15422 170.26442 172.48383 177.19803 182.30823 186.76143">CS(RPL) := CPL;</tspan><tspan y="-139.98183" x="131.52029 136.98059 139.08209 144.19229 146.4126 148.1568 153.267 155.4873 158.9082 163.59 170.52719 175.17839 179.89259 181.97879 187.08899">RIP := tempEIP;</tspan><tspan y="-127.98212" x="95.520294 100.2552 102.3621">FI;</tspan><tspan y="-115.98242" x="59.520294 64.255196 66.362099">FI;</tspan><tspan y="-103.98272" x="59.520294 61.628094 66.363892 68.583298 73.325401 78.127808 82.567513 87.246613 91.982414 98.882713 103.67252 107.05832 111.54212 115.45892 119.71862 124.39952 129.18932 133.62901 138.30182 140.23862 144.96542 149.58513 152.18793 156.92372 162.05553 166.53033">IF ShadowStackEnabled(CPL)</tspan><tspan y="-91.983017" x="77.520294 79.624496 84.356697 86.576096 89.175293 91.279495 96.893692 102.16589 107.4381 111.939 116.6712 121.4034 126.0843 131.51849 133.19879 137.67 144.2562 149.87039 152.08978 156.56998 161.31207 165.98128 168.20067 173.74287 178.47507 183.21716 188.37596 190.97516 195.65607 200.38828 205.00798 209.73119 214.47328 219.19649 223.86569 230.76599 235.5063 240.2484 243.60809 248.39429 253.0752 255.00839 259.7316 263.64481 267.02701 271.75922 275.03342 277.63263 279.34982 283.82101 286.42023 288.63962 293.76782 295.98721">IF (IA32_EFER.LMA and DEST(CodeSegmentSelector).L) = 0</tspan><tspan y="-79.983315" x="95.520294 98.159096 102.1812 104.4006 106.4418 109.8006 112.02 115.38869 119.85539 123.11609 127.77179 132.48149 135.85019 138.0696 140.0163 144.024 146.24341 148.1631 152.8728 157.5285 161.99521 165.89491 170.56862 172.78802 177.50673 180.76743 182.98683 186.88654 191.60524 198.54694 203.20264 207.66934 211.08934 213.03604 217.69174 219.63844 221.55814 223.50484 226.87354 231.54724 233.76028 240.70108 245.41888 250.07368 254.78249 257.00098 260.36877 265.14056 269.84937 274.62115 276.83963 280.20743 284.97922 289.68802 291.90649 296.67828 301.45007 306.56387 308.78235 315.72314 320.52029 324.48209 327.90207 330.12054 334.77533 339.48413 341.70261 343.64841 348.4202 350.63867 352.55746 357.27527 364.21606 366.43454 371.69235 376.95917 382.27097 384.48944 388.50525">(* If target is legacy or compatibility mode then the SSP must be in low 4GB *)</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="423.66516pt" height="644.69556pt" viewBox="0 0 423.66516 644.69556" sodipodi:docname="250.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.84041" inkscape:cy="423.83692" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg192" /><g transform="translate(-45.11969,-69.182129)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="94.68 96.785103 101.5182 103.7376 106.3377 111.1248 115.86691 120.9681 123.1875 129.14459 131.36398 136.63708 141.43318 146.11407 150.84717 155.58026 160.26115 164.99425 169.72734 174.40823 179.14133 184.41443 189.63443 194.91473 200.13474 205.40784 210.68094 215.90094 221.17404 223.39343 225.14754 230.27664 232.49603 237.76913">IF (SSP &amp; 0xFFFFFFFF00000000 != 0)</tspan><tspan y="-703.98029" x="112.68 117.8604 123.70679 128.42819 134.2746 136.494 142.2594 147.5298 152.6472 155.2356 160.49699 163.08539 164.95378 167.17319 171.89459 173.98799">THEN #GP(0); FI;</tspan><tspan y="-691.98059" x="76.68 81.414902 83.521805">FI;</tspan><tspan y="-679.9809" x="76.68 79.318802 83.340904 85.560303 90.0261 91.944901 93.890701 98.545502 103.3173 105.5367 108.9045 113.6223 115.8417 121.09949 123.31889 127.97369 132.6465 136.0143 140.7231 142.9425 147.59731 152.31511 157.08691 161.85872 166.51352 170.97932 174.23912 178.92 181.1394 183.0762 186.435 188.6544 193.4568 198.13771 201.49651 203.71591 208.21501 210.13652 213.38731 218.12761 222.58441 227.2635 231.92731 234.14671 238.60352 240.51332 242.49512 247.11482 251.91722 256.59814 261.27725 263.49664 267.50345">(* align to 8 byte boundary if not already aligned *)</tspan><tspan y="-667.9812" x="76.68 80.100006 84.780907 91.715408 96.363907 101.12941 105.89491 111.05641 113.27582 118.38332 120.60272 125.36823 130.13373 135.24123">tempSSP = SSP;</tspan><tspan y="-655.98151" x="76.68 81.466202 86.252403 90.692108 95.361305 100.04221 106.99741 111.55861 115.52041 118.94041 123.38012 127.27982 131.57103 136.13223 140.15343 143.53563 148.26782 151.54202 156.26523 158.48462 163.70462 165.92401 170.59322 175.28041 178.66261 183.38582 187.34761 189.567 194.29919 197.6454 199.86479 205.08479 207.30418 210.68639 215.41858 217.63797 220.23717 225.02336 229.76546 234.86667 237.08606 241.05325 243.27264 248.54485">Shadow_stack_store 4 bytes of 0 to (SSP – 4)</tspan><tspan y="-643.98181" x="76.68 81.467102 86.254204 91.383301 93.6036 98.732697 100.953 105.7401 110.4822 115.6113 117.8316 123.7887 126.009 131.28209 136.07819 140.75908 145.49217 150.22527 154.90616 159.63925 164.37234 169.05324 173.78633 178.46722 183.20032 187.93341 192.6143 197.3474 202.08049 206.76138 212.03448">SSP = SSP &amp; 0xFFFFFFFFFFFFFFF8H</tspan><tspan y="-631.98212" x="76.68 81.471603 86.263206 90.702911 95.37751 100.05841 107.01901 111.76112 115.14872 119.58842 123.50703 127.76672 132.90033 137.64243 141.66902 146.41112 151.68872 157.02032 159.62492 163.01253 167.69344 174.65404 179.32864 184.46225 189.20435 193.22644 198.01804 202.69893 207.49052 210.09512 211.97972 214.19911 216.80371 220.83931 223.0587 228.19231 232.632 237.30661 241.92632 246.65492 251.27463 253.49402 260.45462 262.42023 265.80783 270.54993 272.76932 278.04691 283.26691 285.4863 290.27789 292.2435 296.86319 301.66559 304.51318 309.25079 312.49258 317.11227 321.84088 325.08267 327.30206 331.97665 333.89816 337.28577 341.24759 343.46698 348.20459 351.55618 353.77557 358.99557 361.21497 365.25058">ShadowStackPush8B(tempPushCS); (* Padded with 48 high-order bits of 0 *)</tspan><tspan y="-619.98242" x="76.68 81.465302 86.250603 90.690308 95.358604 100.03951 106.9938 111.73591 115.11721 119.55692 123.46922 127.75951 132.88681 137.62891 141.6492 146.3913 151.6626 156.9879 159.5862 162.9675 167.64841 174.60901 179.27731 184.40462 189.14671 193.16881 197.9541 202.42441 204.52771 209.65501 212.25331 214.13161 216.351 218.9493 222.97859 225.19798 230.32529 234.76498 239.43329 244.10159 248.7825 253.45081 255.6702 262.57053 264.55231 267.93359 272.67569 274.89511 280.16641 285.43771 287.65714 292.39923 294.38101 299.0007 303.8031 306.64441 311.3757 314.64899 319.31729 323.99817 327.30026 329.51968 334.13937 336.12115 339.50244 343.52274 345.74216 350.42303 353.78183 356.00125 361.27255 363.49197 366.79138 371.53256 374.80585 377.02527 382.29657 387.51657 389.73599 394.4043 396.32578 399.70706 401.92648 406.39679 408.50009 413.62738 417.65668">ShadowStackPush8B(tempPushLIP); (* Padded with 32 high-order bits of 0 for 32 bit LIP*)</tspan><tspan y="-607.98273" x="76.68 81.472504 86.265007 90.704712 95.380211 100.06111 107.02261 111.76472 115.15322 119.59293 123.51243 127.77213 132.90663 137.64873 141.67622 146.41832 151.69682 157.02933 159.63483 163.02333 167.70424 174.66484 179.34035 184.08244 188.87494 194.00945 196.61494">ShadowStackPush8B(tempSSP);</tspan><tspan y="-595.98303" x="58.619698 63.354599 65.461502">FI;</tspan><tspan y="-583.98334" x="58.619698 60.692398 65.433594 67.652992 72.394188 77.136284 81.815384 86.435089 89.73719 94.176888 98.979286 102.87898 107.63368 112.37488 117.12958 121.62868 126.30778 128.22928 132.92097 137.60007 140.16777 144.86847 150.02997 154.46877">IF EndbranchEnabled(CPL)</tspan><tspan y="-571.98364" x="76.68 78.767998 83.484001 85.7034 90.419403 95.531403 99.986404 102.2058 107.3178 109.5372">IF CPL = 3</tspan><tspan y="-559.98395" x="94.68 99.889198 105.7104 110.46059">THEN</tspan><tspan y="-547.98425" x="112.68 114.7635 120.4029 125.6544 130.9059 135.4464 141.1209 145.66139 150.37289 155.0844 160.2549 161.9514 167.1696 172.5831 178.17661 182.88811 188.13062 192.84212 198.25562 200.47502 205.63652 207.85593 215.15042 220.74393 222.82742 228.04562 232.58612 237.29762 243.05582 248.45581 252.99631 257.70779 263.58838 269.10629 274.4118 279.87122 285.46472 291.30121 296.0127">IA32_U_CET.TRACKER = WAIT_FOR_ENDBRANCH</tspan><tspan y="-535.98456" x="112.68 114.7806 120.3912 125.61121 130.89151 135.44911 141.09032 145.64792 150.37653 155.10513 160.29274 161.97305 166.77545 172.41666 177.57816 182.70276 188.13336 192.86197 197.60406 202.38666 204.60605 209.73065 211.95004">IA32_U_CET.SUPPRESS = 0</tspan><tspan y="-523.98486" x="94.68 99.414902 103.8888 108.6777">ELSE</tspan><tspan y="-511.98517" x="112.68 114.7734 120.3768 125.5968 130.87711 135.42751 140.20291 144.75331 149.47472 154.15562 159.37383 161.08023 166.26064 171.68404 177.28743 182.00883 187.26123 191.98264 197.40604 199.62 204.72479 206.9442 214.23599 219.8268 221.90759 227.12579 231.66359 236.37239 242.08919 247.54858 252.08638 256.79517 262.67578 268.1937 273.49649 278.9559 284.54669 290.38049 295.08929">IA32_S_CET.TRACKER = WAIT_FOR_ENDBRANCH</tspan><tspan y="-499.98547" x="112.67999 114.77429 120.37859 125.59859 130.87891 135.43021 140.20651 144.75781 149.48012 154.16103 159.37923 161.08653 165.86284 171.50404 176.66554 181.78384 187.20815 191.93045 196.70676 201.48306 203.70247 208.82077 211.04018">IA32_S_CET.SUPPRESS = 0</tspan><tspan y="-487.98578" x="76.679993 81.414894 83.521797">FI;</tspan><tspan y="-475.98608" x="58.61969 63.354591 65.461494">FI;</tspan><tspan y="-463.98639" x="45.11969 49.814091 55.694691 61.199089">END;</tspan><tspan y="-439.98608" x="45.11969 50.94899 56.707188 62.536488 67.240784 72.953087 78.782387 83.486687 89.19899 94.658394 101.19869 103.27499 109.15559 114.4089 117.28979 121.99409 127.7523 133.2666 137.9709 140.85181 145.5939 150.2982 155.5515 162.1098 166.8141 172.6434 177.8067">NONCONFORMING-CODE-SEGMENT:</tspan><tspan y="-427.98639" x="58.61969 60.720291 65.448891 67.668289 72.135887 74.974487 80.297089 82.253693">IF L-Bit</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-427.98001" x="85.620003 88.381912 94.198555"> = </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-427.98001" x="97.019997 102.2562 104.47559 108.97469 113.71679 118.39589 120.61529 126.12149 128.92769 134.2692 136.3698 141.52499">1 and D-BIT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-427.98001" x="143.75999 149.58061">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-427.98001" x="152.34 157.614 159.83339 164.31538 169.05748 173.72849 175.94788 178.05388 183.66988 188.94388 194.16388 198.72688 203.46088 208.14177 212.88297 218.31897 220.03796 224.51097 231.05127 236.66727">1 and IA32_EFER.LMA </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-427.98001" x="238.86 244.68062">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-427.98001" x="247.44 252.72031">1 </tspan><tspan y="-415.98032" x="76.680298 81.862495 87.710693 92.433891 98.282089 100.50149 105.77369 110.89289 113.48309 118.26029 122.97449 129.9207 132.14011 136.04431 140.76752 145.42772 150.14192 152.36133 156.37354 161.03999 165.7065 172.6068 177.3273 182.0694 185.4489 187.66829 191.68678 196.40729 198.33778 203.01869 206.9292 210.3087 215.03821 218.30971 220.9062 222.7827 225.00209 229.683 231.7836">THEN GP(new code segment selector); FI;</tspan><tspan y="-403.98062" x="58.619995 60.716095 65.440193 67.659592 70.250694 75.676796 80.796898 85.259995">IF (RPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-403.98062" x="87.480293">&gt;</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-403.98062" x="92.400597 94.619995 99.334198 104.4444 108.8976 111.5364 113.7558 118.47 121.7262 123.9456 126.5268 132.05099 137.16119"> CPL) or (DPL</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-403.98001" x="141.60001"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-403.98001" x="144.41968">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-403.98001" x="149.87975"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-403.98001" x="152.64 157.36951 162.49501 166.96352 169.56001">CPL) </tspan><tspan y="-391.98032" x="76.68 81.875702 87.696907 92.433609 98.254814 100.47422 106.25492 111.54062 116.64182 119.22121 124.01192 128.69283 135.65253 137.87192 141.78961 146.52631 151.14601 155.88632 158.10571 162.13141 166.7997 171.47879 178.37909 183.11938 187.86148 191.21397 193.43338 197.45547 202.19577 204.09927 208.79277 212.67627 216.09627 220.79877 224.10088 226.67038 228.51988 230.73929 235.44179 237.54237">THEN #GP(new code segment selector); FI;</tspan><tspan y="-379.98062" x="58.61969 60.710388 65.429092 67.648491 71.656189 76.365891 81.021591 87.963287 92.672989 97.445686 100.81438 103.03378 107.80648 112.52518 115.89388 118.11327 122.76897 126.02967 130.73936 134.74707 139.45677 144.22948 147.64948">IF segment not present </tspan><tspan y="-367.98093" x="76.679993 81.864891 87.71579 92.441689 98.292587 100.51199 106.28188 112.13278 117.25468 119.84759 124.58968 129.32999 136.27888 138.49829 142.4052 147.08611 151.74901 156.42992 158.64932 162.66422 167.38112 172.00082 178.96143 183.64233 188.44475 191.82065 194.04005 198.05496 202.73587 204.66277 209.37967 213.28658 216.66248 221.38838 224.65628 227.24918 229.12207 231.34148 236.06738 238.16528">THEN #NP(new code segment selector); FI;</tspan><tspan y="-355.98123" x="58.61969 60.70499 65.418289 67.637695 71.639999 75.003296 79.4646 83.358902 87.678001 89.8974 94.664703 99.378006 102.7413 104.96071 106.87501 111.37411 114.62941 119.27971 123.98401 126.20341 130.94371 135.68581 140.39911 145.16641 149.81671 154.58401 156.80342 160.13072 164.84402 168.09932 170.31873 173.57402 178.31432 181.67761 186.48001 189.73531 194.5377 196.75711 201.21841 205.86871 210.51901 213.82111 218.52541 222.52771 226.53001">IF stack not large enough for return address </tspan><tspan y="-343.98154" x="76.679993 81.863991 87.713989 92.438988 98.288986 100.50838 106.27738 111.05638 115.79848 118.37788 123.64288 126.23488 128.10687 130.32628 135.05128 137.14828">THEN #SS(0); FI;</tspan><tspan y="-331.98184" x="58.61969 62.014492 66.695389 73.663193 78.28289 83.027695 85.144493 90.245697 92.465096 94.206596 99.368095 101.58749 107.10539 111.78629 116.58508 121.74388 124.32328 130.08148 133.38087 136.73967 140.77347 145.45436 148.81407 151.45287">tempEIP := DEST(Offset);</tspan><tspan y="-319.98215" x="58.61969 60.721191 65.450691 67.67009 71.049591 75.527092 78.798592 83.465088 88.145988 91.505692 93.72509 100.67759 105.40709 110.02679 114.76709 116.98649 122.11199 124.33139 129.0609 133.74181 140.69431 145.31401 149.7915 153.17101 155.12851 159.74821 161.70572 163.63622 165.59372 168.97322 173.65771 175.87711 182.82961 187.55911 192.17882">IF target mode = Compatibility mode</tspan><tspan y="-307.98245" x="45.11969 47.339088 49.558487 51.777885 76.677284 81.863083 87.714882 92.441681 98.29348 100.51288 103.88968 108.60748 115.50778 120.18688 124.91368 127.01248 132.13528 134.35468 136.11148 141.23428 143.45367 146.83047 151.54828 158.49808 163.11778 167.84459 169.94339 175.06619 177.28558 182.89438 188.74619 194.28299 196.50238 201.72238 206.98918 212.25598 217.47598 222.74278 228.00958 233.22958 238.49638 243.05219 247.73309 252.4599 257.18671 261.86761 266.59442 271.27533 276.00214 280.72894 286.58075 288.45456 290.67395 295.40076 297.49954">    THEN tempEIP := tempEIP AND 00000000_FFFFFFFFH; FI;</tspan><tspan y="-295.98276" x="58.61969 60.69059 65.431786 67.651184 73.358086 78.037186 82.777489 86.019287 90.466187 95.268585 99.904488 104.70689 106.68869 110.82959 115.51949">IF OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-295.98001" x="117.72 123.60039">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-295.98001" x="126.36 131.6403">16</tspan><tspan y="-283.98032" x="76.68 81.865799 87.717598 92.444397 98.296196 100.51559 103.8924 108.6102 115.5105 120.1896 124.9164 127.0152 132.138 134.35739 136.1142 141.237 143.45639 146.83319 151.55099 158.50079 163.1205 167.84731 169.94611 175.06891 177.2883 182.89709 188.7489 194.28571 196.5051 201.7251 206.9919 212.2587 217.4787 222.20551 226.93231 231.61322 236.34003 242.19183 244.06563 246.28503 251.01184 253.11064 254.98444 257.20383 259.79764 263.82245 266.04184 270.76865 272.69644 277.37735 281.87643 285.14523 287.36462 292.14542 296.76511 301.42889 306.1098 309.3786 311.59799 316.81799 322.09827 324.31766 328.98145 330.90295 334.27975 338.29556 340.51495 344.53976">THEN tempEIP := tempEIP AND 0000FFFFH; FI; (* Clear upper 16 bits *)</tspan><tspan y="-271.98062" x="58.619698 60.723 65.4543 67.673698 70.271996 72.375298 77.988602 83.259903 88.531204 93.032104 97.763405 102.49471 107.17561 112.60891 114.28921 118.75951 125.3448 130.9581 133.17749 138.30479 140.52419 145.74419 147.96358 152.69489 155.96819 158.18758 161.56888 166.04817 169.32147 173.98978 178.67068 182.03038 184.24977 191.20407 195.93536 200.55507 205.29538 207.51477 212.64207 214.86147 219.59277 224.27367 231.22797 235.89627 240.33597 243.69566 245.65497 250.27467 252.23398 254.16628 256.08777 259.50775 264.12747 266.34689 273.30121 278.0325 282.65219 287.39249 289.99078 292.21021 296.6499 301.4523 306.12061 308.34003 310.93832 314.31961 319.00049 325.96106 330.62936 335.31024 337.41354 342.54083 344.76025 349.49155 354.27686 357.65814 361.61993 363.57922 368.24753 372.92841 375.14783 379.93314 384.61401 391.5683 393.78772 397.70001 402.38089 407.04919 411.77148 413.99091 417.9527 422.69299 427.31268 434.27325 438.99554 443.73764 447.11893 449.33835 451.27066 453.22995 460.13028 462.11206 465.49335">IF (IA32_EFER.LMA = 0 or target mode = Compatibility mode) and (tempEIP outside new code segment limit)</tspan><tspan y="-259.98093" x="76.68 81.860397 87.706795 92.428192 98.27459 100.49399 106.25939 111.52979 116.64719 119.2356 124.49699 127.0854 128.9538 131.1732 135.89461 137.98801">THEN #GP(0); FI;</tspan><tspan y="-247.98123" x="58.619698 60.725697 65.459694 67.679092 71.063095 75.788094 82.688393 87.367493 92.101494 94.1427 99.272697 101.4921 103.4136 107.4357 109.6551 114.4431 119.124 123.912 126.756 130.67101 135.1107 139.8987 144.63269 149.37479 151.3566 155.27159 159.71129 161.64629">IF tempEIP is non-canonical </tspan><tspan y="-235.98154" x="76.68 81.860397 87.706795 92.428192 98.27459 100.49399 106.25939 111.52979 116.64719 119.2356 124.49699 127.0854 128.9538 131.1732 135.89461 137.98801">THEN #GP(0); FI;</tspan><tspan y="-223.98184" x="58.619698 60.729298 65.466896 67.686302 72.477905 77.220009 81.705612 86.32531 91.062912 97.963211 102.75481 106.14242 110.62802 114.54662 118.80632 123.54752 128.28963 132.78873 137.40843 139.32993 144.05853 148.67824 151.28284 156.02043 161.15404 165.63063">IF ShadowStackEnabled(CPL)</tspan><tspan y="-211.98215" x="76.68 78.784203 83.516403 85.735802 87.840004 93.454208 98.72641 103.94641 108.50761 113.23981 117.97202 122.65292 128.08711 129.76741 134.23862 140.82481 146.43901 148.6584 154.61461 156.834 161.56619 166.30829 168.02548">IF IA32_EFER.LMA &amp; CS.L</tspan><tspan y="-199.98245" x="45.119698 47.339096 49.558495 51.777893 53.997292 56.21669 58.436089 60.655487 94.674591 98.094589 102.77549 109.72079 114.38009 119.49839 124.27469 128.286 133.0623 137.52361 139.6179 144.73621 146.95561 152.07391 154.29332 159.71762 161.75882">        tempPushLIP = RIP</tspan><tspan y="-187.98276" x="45.119698 47.3391 49.558502 51.777905 76.677307 81.405907 85.873505 90.656105">    ELSE</tspan><tspan y="-175.98306" x="45.119698 47.3391 49.558502 51.777905 53.997307 56.216709 58.436111 60.655514 94.674622 98.09462 102.77552 109.71542 114.36932 119.48222 124.25312 128.25902 133.02992 137.48582 139.57472 144.68762 146.90703 152.01993 154.23933 158.95624 163.72714 169.03804 174.63695 179.40785 184.12476 186.34416 191.56236 193.78177 198.49867 200.58757 205.70047">        tempPushLIP = CSBASE + EIP;</tspan><tspan y="-163.98337" x="45.119698 47.339096 49.558495 51.777893 76.677292 81.404091 83.502892">    FI;</tspan><tspan y="-151.98367" x="76.68 80.071198 84.752098 91.716301 96.335999 101.4732 106.2153 110.2455 114.98759 119.7288 124.524 126.7434 131.8806 134.09999 138.84119 143.58328">tempPushCS = CS;</tspan><tspan y="-139.98398" x="58.619698 63.354599 65.461502">FI;</tspan><tspan y="-127.98428" x="58.619698 60.690598 65.431793 67.651192 73.358093 78.037193 82.777496 86.019295 90.466194 95.268593 99.904495 104.70689 106.6887 110.8296 115.5195">IF OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-127.98" x="117.72 123.60039">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-127.98" x="126.36 131.6403">32</tspan><tspan y="-115.9803" x="76.68 81.889198 87.710396 92.460594">THEN</tspan><tspan y="-103.9806" x="94.68 99.813599 104.5557 108.58231 113.37391 115.97851 120.65941 125.45101 128.05562 129.94022 132.15961 134.76421 138.7998 141.0192 146.1528 150.5925 155.26711 159.88681 164.61542 169.23512 171.45451 178.41512 180.33662 183.72423 188.46632 190.68571 195.96332 201.18332 203.40271 208.19431 210.11581 214.79042 219.58202 222.42961 227.1105 230.39011 235.00981 239.73842 243.01802 245.23741 249.91202 251.83353 255.22113 259.18295 261.40234 265.43796">Push(CS); (* Padded with 16 high-order bits *)</tspan><tspan y="-91.980896" x="94.68 99.841499 104.5836 108.59219 113.36579 115.95239 120.672 122.7636 127.92509 130.51169">Push(EIP);</tspan><tspan y="-79.981194" x="94.68 99.405899 104.1858 106.4052 108.16109 113.283 115.5024 121.0383 125.7642 130.5063 135.7245 138.3174 142.99831 147.72421 152.38712 157.06802 161.87044 166.55135 171.23045 178.13075 182.87106 187.65097 191.02687 195.76898 200.50929 202.43619 207.1171 211.024 214.3999 219.12581 222.39371 224.9866 226.8595">CS := DEST(CodeSegmentSelector); </tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="345.27109pt" height="644.67719pt" viewBox="0 0 345.27109 644.67719" sodipodi:docname="251.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="345.96619" inkscape:cy="423.75382" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg128" /><g transform="translate(-46.52536,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="95.519997 98.158798 102.1809 104.4003 109.1514 113.8917 118.5258 125.4864 130.1745 134.9769 138.32401 140.54341 145.2225 149.9034 153.92549 157.8252 161.0643 163.0461 167.68019 171.1002 175.7973 179.09941 181.31882 183.24391 188.04631 191.35741 196.0986 199.33771 206.29831 210.74341 214.09052 216.07231 220.81351 225.56461 227.78401 232.28311 234.20462 238.19072 242.93192 245.15132 247.04942 251.79062 256.23572 260.91483 265.60294 270.28204 272.50143 276.49652">(* Segment descriptor information also loaded *)</tspan><tspan y="-703.98029" x="95.519997 100.2342 105.0024 107.5836 112.99979 118.10999 122.60909 125.19029 127.40969 129.15388 134.26408 136.48349 141.19769 146.30789 150.76109">CS(RPL) := CPL;</tspan><tspan y="-691.98059" x="95.519997 100.2351 102.3222 107.4333 109.65269 111.3978 116.5593 118.77869 122.14379 126.84989 133.78799 138.44009 143.1552 145.24229 150.35339">EIP := tempEIP;</tspan><tspan y="-679.9809" x="77.519997 82.254898 86.728798 91.5177">ELSE</tspan><tspan y="-667.9812" x="95.519997 97.587296 102.32849 104.54789 110.25119 114.93029 119.61659 122.91869 127.36198 132.16438 136.79668 141.59908 143.52237 147.72357 152.40987 154.62926 159.79076 162.01015 167.24545">IF OperandSize = 16</tspan><tspan y="-655.98151" x="113.52 118.72919 124.55039 129.3006">THEN</tspan><tspan y="-643.98181" x="131.51999 136.66798 141.41008 145.45108 150.25708 152.83649 157.51738 162.32338 164.90279">Push(CS);</tspan><tspan y="-631.98212" x="131.51999 136.66888 141.41098 145.45288 150.25978 152.83919 154.93977 160.04097 162.62038">Push(IP);</tspan><tspan y="-619.98242" x="131.51999 136.26118 141.06358 143.28299 145.01099 150.10498 152.32439 157.83238 162.57358 167.32558 172.54378 175.10878 179.80678 184.54797 189.22707 193.91606 198.71846 203.40746 208.08655 215.00755 219.74785 224.49985 227.91986 232.67186 237.41216 239.31116 244.00015 247.87915 251.22716 255.96835 259.21014 261.84894 263.70923">CS := DEST(CodeSegmentSelector); </tspan><tspan y="-607.98273" x="131.51999 134.1588 138.18089 140.4003 145.1523 149.89259 154.52759 161.48819 166.17719 170.97958 174.32759 176.547 181.22609 185.90698 189.92908 193.82878 197.06879 199.05058 203.68558 207.10559 211.80359 215.1057 217.3251 219.2511 224.0535 227.36549 232.10669 235.34669 242.3073 246.7533 250.17331 252.0993 256.84052 261.59253 263.81195 268.31107 270.23254 274.25464 278.93555 281.15497 283.05396 287.79517 292.24118 296.92029 301.60928 306.28839 308.50781 312.50381">(* Segment descriptor information also loaded *)</tspan><tspan y="-595.98303" x="131.51999 136.23419 141.0024 143.5836 148.9998 154.11 158.6091 161.19031 163.40971 165.15392 170.26411 172.48352 177.19772 182.30792 186.76112">CS(RPL) := CPL;</tspan><tspan y="-583.98334" x="131.51999 136.23509 138.32219 143.43329 145.65269 147.3978 152.5593 154.7787 158.1438 162.8499 169.78799 174.44009 179.1552 181.24229 186.35339">EIP := tempEIP;</tspan><tspan y="-571.98364" x="113.51999 118.26118 122.69999 127.50239 132.24359 134.46298 137.02438 141.01678 143.23618 148.93857 153.61766 158.30305 161.60516 166.04756 170.84996 175.48135 180.28375 182.20615 186.40735 191.09274 193.31213 198.40253 200.62192 205.90222 211.18253 213.40192 217.39432">ELSE (* OperandSize = 64 *)</tspan><tspan y="-559.98395" x="131.51999 136.65359 141.39569 145.42229 150.21388 152.81848 157.49937 162.29097 164.89557 166.78017 168.99956 171.60416 175.63976 177.85915 182.99275 187.43245 192.10706 196.72676 201.45537 206.07507 208.29446 215.25507 217.17657 220.56418 225.30627 227.52567 232.80327 238.02327 240.24266 245.03426 246.95576 251.63037 256.42197 259.26956 263.95047 267.23007 271.84976 276.57837 279.85797 282.07736 286.75195 288.67346 292.06107 296.02289 298.24228 302.27789">Push(CS); (* Padded with 48 high-order bits *)</tspan><tspan y="-547.98425" x="131.51999 136.68149 141.4236 145.4313 150.20401 152.7897 158.2104 160.3011 165.4158 168.0015">Push(RIP);</tspan><tspan y="-535.98456" x="131.51999 136.26118 141.06358 143.28299 145.01099 150.10498 152.32439 157.83238 162.57358 167.32558 172.54378 175.10878 179.80678 184.54797 189.22707 193.91606 198.71846 203.40746 208.08655 215.00755 219.74785 224.49985 227.91986 232.67186 237.41216 239.31116 244.00015 247.87915 251.22716 255.96835 259.21014 261.84894 263.70923">CS := DEST(CodeSegmentSelector); </tspan><tspan y="-523.98486" x="131.51999 134.1588 138.18089 140.4003 145.1523 149.89259 154.52759 161.48819 166.17719 170.97958 174.32759 176.547 181.22609 185.90698 189.92908 193.82878 197.06879 199.05058 203.68558 207.10559 211.80359 215.1057 217.3251 219.2511 224.0535 227.36549 232.10669 235.34669 242.3073 246.7533 250.17331 252.0993 256.84052 261.59253 263.81195 268.31107 270.23254 274.25464 278.93555 281.15497 283.05396 287.79517 292.24118 296.92029 301.60928 306.28839 308.50781 312.50381">(* Segment descriptor information also loaded *)</tspan><tspan y="-511.98517" x="131.51999 136.23419 141.0024 143.5836 148.9998 154.11 158.6091 161.19031 163.40971 165.15392 170.26411 172.48352 177.19772 182.30792 186.76112">CS(RPL) := CPL;</tspan><tspan y="-499.98547" x="131.51999 136.98029 139.08179 144.19199 146.41229 148.15649 153.26669 155.487 158.9079 163.58969 170.52689 175.17809 179.89229 181.97849 187.08868">RIP := tempEIP;</tspan><tspan y="-487.98578" x="95.519989 100.25489 102.36179">FI;</tspan><tspan y="-475.98608" x="59.519989 64.25489 66.361794">FI;</tspan><tspan y="-463.98639" x="59.519989 61.627789 66.363586 68.582993 73.325096 78.127502 82.567207 87.246307 91.982109 98.882408 103.67221 107.05801 111.54182 115.45862 119.71832 124.39922 129.18901 133.62871 138.30151 140.23831 144.96512 149.58482 152.18762 156.92342 162.05522 166.53003">IF ShadowStackEnabled(CPL)</tspan><tspan y="-451.98669" x="77.519989 79.624191 84.356392 86.57579 89.174988 91.27919 96.893387 102.16559 107.43779 111.93869 116.67089 121.40309 126.08399 131.51819 133.19849 137.66969 144.25589 149.87009 152.08948 156.56967 161.31177 165.98097 168.20036 173.74257 178.47476 183.21686 188.37566 190.97485 195.65576 200.38797 205.00768 209.73088 214.47298 219.19618 223.86539 230.76569 235.506 240.24809 243.60779 248.39398 253.07489 255.00809 259.73129 263.6445 267.0267 271.75891 275.03311 277.63232 279.34952 283.82071 286.41992 288.63931 293.76752 295.98691">IF (IA32_EFER.LMA and DEST(CodeSegmentSelector).L) = 0</tspan><tspan y="-439.987" x="95.519989 98.158791 102.18089 104.40029 106.44149 109.80029 112.01969 115.38839 119.85509 123.11578 127.77148 132.48119 135.84988 138.06929 140.01599 144.0237 146.2431 148.1628 152.8725 157.5282 161.9949 165.89461 170.56831 172.78772 177.50642 180.76712 182.98653 186.88623 191.60493 198.54663 203.20233 207.66904 211.08904 213.03574 217.69144 219.63814 221.55783 223.50453 226.87323 231.54694 233.75998 240.70078 245.41858 250.07338 254.78218 257.00067 260.36847 265.14026 269.84906 274.62085 276.83932 280.20712 284.97891 289.68771 291.90619 296.67798 301.44977 306.56357 308.78204 315.72284 320.51999 324.48178 327.90176 330.12024 334.77502 339.48383 341.7023 343.6481 348.41989 350.63837 352.55716 357.27496 364.21576 366.43423 371.69205 376.95886 382.27066 384.48914 388.50494">(* If target is legacy or compatibility mode then the SSP must be in low 4GB *)</tspan><tspan y="-427.9873" x="95.519989 97.625092 102.35819 104.57759 107.17769 111.96479 116.70689 121.80809 124.02749 129.98459 132.20398 137.47708 142.27318 146.95407 151.68716 156.42026 161.10115 165.83424 170.56734 175.24823 179.98132 185.25443 190.47443 195.75473 200.97473 206.24783 211.52094 216.74094 222.01404 224.23343 225.98753 231.11664 233.33603 238.60913">IF (SSP &amp; 0xFFFFFFFF00000000 != 0)</tspan><tspan y="-415.98761" x="113.51999 118.70039 124.54678 129.26819 135.11459 137.334 143.0994 148.3698 153.4872 156.07559 161.33699 163.92538 165.79378 168.01318 172.73459 174.82799">THEN #GP(0); FI;</tspan><tspan y="-403.98792" x="77.519989 82.25489 84.361794">FI;</tspan><tspan y="-391.98822" x="59.519989 62.123688 66.085487 68.304893 72.789597 74.727295 76.691994 81.311691 86.102394 88.3218 91.708504 96.389404 98.60881 103.88551 106.10492 110.77862 115.47032 118.85703 123.53793 125.75733 130.43103 135.11192 139.90262 144.69331 149.31302 153.79771 157.03952 161.73122 163.95061 165.87212 169.23091 171.4503 176.241 180.92189 184.30859 186.52798 191.01268 192.95038 196.19218 200.9325 205.37219 210.0513 214.743 216.96239 221.40208 223.32358 225.28828 229.90799 234.69868 239.37959 244.0533 246.27269 250.30739">(* align to 8 byte boundary if not already aligned *)</tspan><tspan y="-379.98853" x="59.519989 62.939987 67.620888 74.555389 79.203888 83.969391 88.734894 93.896393 96.115799 101.2233 103.4427 108.20821 112.97371 118.08121">tempSSP = SSP;</tspan><tspan y="-367.98883" x="59.519989 64.302589 69.08519 73.56179 78.227394 82.908295 89.868896 94.426498 98.388298 101.7669 106.2435 110.1531 114.4407 118.9983 123.0159 126.3945 131.12311 134.39371 139.11331 141.3327 146.5527 148.77209 153.4377 158.0997 161.472 166.1853 170.19661 172.41602 177.13832 180.47462 182.69403 187.95633 190.17574 193.54803 198.27034 200.48975 203.07904 207.85535 212.63165 217.74995 219.96936 223.92667 226.14607 231.40837">Shadow_stack_store 4 bytes of 0 to (SSP – 4)</tspan><tspan y="-355.98914" x="59.519997 64.309799 69.051903 74.183701 76.403107 81.534904 83.754311 88.496414 93.29882 98.430618 100.65002 106.60983 108.82923 114.10503 118.90383 123.58473 128.32053 133.05632 137.73721 142.47301 147.1539 151.88969 156.62549 161.30638 166.04218 170.77797 175.45886 180.19466 184.93045 189.61134 194.88715">SSP = SSP &amp; 0xFFFFFFFFFFFFFFF8H</tspan><tspan y="-343.98944" x="59.519997 64.322395 69.064499 73.563599 78.242699 82.945198 89.9058 94.6623 98.082298 102.5328 106.4163 110.6778 115.8393 120.5958 124.5873 129.34381 134.6241 139.96559 142.545 145.89749 150.59099 157.55159 162.23068 167.32918 172.08568 176.07718 180.87958 185.58208 190.38448 192.95398 194.80348 197.02289 199.59239 203.5929 205.8123 210.9738 215.39999 220.07999 224.69968 229.43367 234.05336 236.27275 243.23875 245.16025 248.55325 253.29535 255.51474 260.79773 266.01773 268.23712 273.03412 274.95563 279.63562 284.45969 287.29019 292.01068 295.31281 299.9325 304.64398 307.90649 310.12589 315.38638 317.60577 322.26328 324.21176 327.58228 331.59177 333.81116 337.82965">ShadowStackPush8B(tempPushCS); (* Padded with 48 high-order 0 bits *)</tspan><tspan y="-331.98975" x="59.519989 64.322388 69.064491 73.563591 78.242691 82.94519 89.905792 94.662292 98.082291 102.53279 106.41629 110.67779 115.83929 120.59579 124.5873 129.3438 134.6241 139.96559 142.545 145.89749 150.59099 157.55159 162.23068 167.32918 172.08568 176.07718 180.87958 185.32108 187.39557 192.49406 195.06357 196.91307 199.13248 201.77129 205.7934 208.0128 213.1113 217.5618 222.24089 226.86058 231.60088 236.27997 238.49937 243.74188 249.02217 251.24158 255.99808 257.97989 262.61938 267.42178 270.23428 274.97549 278.22 282.89911 287.59262 290.89471 293.11411 297.7536 299.73541 303.08792 307.07941 309.2988 314.00131 317.36011 319.5795 324.8598 327.07919 330.39569 335.1369 338.38141 340.6008 345.8811 351.1011 353.3205 357.9996 359.98141 363.33392 365.55331 369.99481 372.06931 377.16782 381.1683">ShadowStackPush8B(tempPushLIP); (* Padded 32 high-order bits of 0 for 32 bit LIP*)</tspan><tspan y="-319.99005" x="59.519989 64.322388 69.064484 73.563583 78.242683 82.939781 89.900375 94.651474 98.071472 102.51657 106.39467 110.65077 115.81227 120.56337 124.54947 129.30057 134.58087 139.92238 142.50179 145.84889 150.53699 157.49759 162.17668 166.92778 171.73018 176.82327 179.38737">ShadowStackPush8B(tempSSP);</tspan><tspan y="-307.99036" x="59.519989 64.25489 66.361794">FI;</tspan><tspan y="-295.99066" x="59.519989 61.589989 66.331184 68.550583 73.291779 78.033875 82.712975 87.33268 90.634781 95.074478 99.876877 103.77657 108.52857 113.26977 118.02177 122.52087 127.15587 129.13676 133.82576 138.50485 141.06985 145.76785 150.92935 155.36815">IF EndbranchEnabled(CPL)</tspan><tspan y="-283.99097" x="77.519989 79.607986 84.32399 86.543388 91.259392 96.371391 100.82639 103.04579 108.15779 110.37719">IF CPL = 3</tspan><tspan y="-271.99127" x="95.519989 100.72919 106.55038 111.30058">THEN</tspan><tspan y="-259.99158" x="113.51999 115.61609 121.22219 126.44219 131.7225 136.2756 141.91681 146.46991 151.19402 155.87492 161.09312 162.80223 167.98534 173.41144 179.01753 183.74164 188.99673 193.72084 199.14694 201.35999 206.46478 208.68419 215.97598 221.56679 223.64758 228.86578 233.40358 238.11238 243.82918 249.28857 253.82637 258.53516 264.41577 269.93369 275.23648 280.69589 286.28668 292.12048 296.82928">IA32_U_CET.TRACKER = WAIT_FOR_ENDBRANCH</tspan><tspan y="-247.99188" x="113.51998 115.61788 121.22578 126.44579 131.72609 136.28099 141.9222 146.4771 151.203 155.88391 161.10211 162.81302 167.59293 173.23413 178.39563 183.51753 188.94543 193.67134 198.45125 203.23116 205.45056 210.57246 212.79187">IA32_U_CET.SUPPRESS = 0</tspan><tspan y="-235.99219" x="95.519981 100.25488 104.72878 109.51768">ELSE</tspan><tspan y="-223.99249" x="113.51998 115.61338 121.21678 126.43678 131.71709 136.26749 141.04289 145.59329 150.3147 154.99561 160.21381 161.92021 167.10062 172.52402 178.12741 182.84882 188.10121 192.82262 198.24602 200.45999 205.56749 207.7869 215.08139 220.6749 222.75839 227.92889 232.46939 237.18089 242.90039 248.35979 252.90028 257.61179 263.44827 269.02649 274.332 279.74551 285.38492 291.20612 295.9176">IA32_S_CET.TRACKER = WAIT_FOR_ENDBRANCH</tspan><tspan y="-211.9928" x="113.51999 115.61429 121.21859 126.43859 131.7189 136.2702 141.04651 145.59781 150.32011 155.00102 160.21922 161.92653 166.70284 172.34404 177.50554 182.62384 188.04814 192.77045 197.54675 202.32306 204.54247 209.66077 211.88017">IA32_S_CET.SUPPRESS = 0</tspan><tspan y="-199.9931" x="77.519989 82.25489 84.361794">FI;</tspan><tspan y="-187.99341" x="59.519989 64.25489 66.361794">FI;</tspan><tspan y="-175.99371" x="46.019989 50.71439 56.59499 62.099388">END;</tspan><tspan y="-151.99341" x="46.019989 50.71439 56.35379 60.787189 65.220589 68.101486 73.344887 78.984291 84.137688 88.832085">CALL-GATE:</tspan><tspan y="-139.99371" x="59.519989 61.609791 66.327591 68.546989 72.445786 76.911583 78.830383 80.811287 83.030685 87.685486 92.151283 95.519081 100.22788 102.44728 105.03208 110.55988 115.67368 120.13049 122.34988 127.37369 129.59309 134.3109 139.4247 143.8815 146.46629 148.6857 153.4035 156.6633 158.88271 161.4675 166.8873 172.0011 176.4579 178.67731 183.70111 185.92052 191.44832 196.56212 201.01892">IF call gate (DPL &lt; CPL) or (RPL &gt; DPL)</tspan><tspan y="-127.99401" x="77.519989 82.700386 88.546783 93.268181 99.114578 101.33398 107.09938 112.36978 117.48718 120.07558 123.97798 128.44739 130.36978 132.29218 135.12358 139.78198 144.25139 147.62279 152.33519 154.5546 158.565 163.2774 165.1998 169.9122 173.81461 177.186 181.90741 185.17081 187.7592 189.62759 191.847 196.56841 198.6618">THEN #GP(call-gate selector); FI;</tspan><tspan y="-115.99431" x="59.519989 61.62059 66.361786 68.581184 72.463783 76.913383 78.815987 80.79689 83.016289 87.654892 92.153992 95.505592 100.1982 102.41759 107.21999 111.90089 115.32089 117.54029 122.17889 125.481 130.1736 134.19569 138.88829 143.69069 147.04228">IF call gate not present </tspan><tspan y="-103.99461" x="77.519989 82.695892 88.537796 93.2547 99.096603 101.316 107.0769 112.91881 118.03171 120.61561 124.51351 128.97841 130.8963 132.81421 135.69511 140.34901 144.81392 148.18082 152.88872 155.10812 159.11403 163.82193 165.73984 170.44774 174.34564 177.71254 182.42944 185.68834 188.27223 190.19194 192.41135 197.12825 199.21715">THEN #NP(call-gate selector); FI;</tspan><tspan y="-91.994904" x="59.519989 61.609791 66.327591 68.546989 72.445786 76.911583 78.830383 80.811287 83.639084 88.293884 92.759682 96.12748 100.83628 103.05568 106.95448 111.67229 116.32709 121.03589 123.86369 127.87048 132.57928 137.23409 144.17488 148.86029 153.64288 157.02148 159.24088 163.25847 167.97807 169.90767 174.62727 178.53688 181.91548 186.64409 189.91469 192.13408 194.09068 198.05247 200.27187 206.12547 211.81708 216.28468">IF call-gate code-segment selector is NULL</tspan><tspan y="-79.995201" x="77.519989 82.700386 88.546783 93.268181 99.114578 101.33398 107.09938 112.36978 117.48718 120.07558 125.33698 127.92538 129.79378 132.01318 136.73459 138.82799">THEN #GP(0); FI;</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="367.60818pt" height="642.66754pt" viewBox="0 0 367.60818 642.66754" sodipodi:docname="252.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.66933" inkscape:cy="421.13287" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg256" /><g transform="translate(-45.998001,-69.182129)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="58.619999 60.725998 65.459999 67.679398 71.594398 76.034103 77.969101 79.904099 82.7481 87.367798 91.8498 95.233803 99.914703 102.1341 106.0491 110.7831 115.4541 120.135 122.979 127.00201 131.72701 136.34671 143.30371 147.98462 152.77261 156.15662 158.37601 162.399 167.07991 169.01491 173.69582 177.61081 180.99481 185.72881 189.00481 191.2242 193.1862 197.9283 202.5993 207.28021 212.07721 214.2966 216.25861 220.2204 222.43979 227.17378 231.96178 235.34578 239.36877 241.29028 245.96939 250.6503 252.86969 257.54068 262.22159 266.2446 270.15961 273.43561 275.39761 280.0173 283.43732 288.11823 291.42032 293.63971 297.02371 301.46341 306.1344 308.0694 312.75031 314.9697 316.90469 318.8262 325.7832 327.70471 331.08871">IF call-gate code-segment selector index is outside descriptor table limits</tspan><tspan y="-703.98029" x="76.680298 81.860695 87.707092 92.42849 98.274887 100.49429 106.25969 111.53009 116.64749 119.23589 123.13829 127.60769 129.53009 131.45248 134.28389 138.94229 143.4117 146.7831 151.4955 153.7149 157.61731 162.33871 166.99712 171.70952 174.54092 178.5603 183.2574 187.93649 194.8656 199.6059 204.366 207.72209 209.9415 213.9366 218.6769 220.584 225.2811 229.1682 232.52429 237.26549 240.56758 243.14069 244.99379 247.2132 251.9193 253.99739">THEN #GP(call-gate code-segment selector); FI;</tspan><tspan y="-691.98059" x="58.620003 64.056 68.7369 73.218903 77.8386 80.057999 83.973 88.455002 90.389999 92.324997 95.168999 99.839996 104.2797 107.6637 112.3887 114.6081 118.5231 123.204 127.875 132.60001 135.444 139.467 144.1479 148.82701 155.72731 160.46762 165.20972 168.56941 170.7888 175.45981 180.18481 184.14661 188.0463 191.3223 193.2438 197.91481 201.29881 206.03281 209.30881">Read call-gate code-segment descriptor;</tspan><tspan y="-679.9809" x="58.620003 60.725101 65.458199 67.676697 71.590797 76.030502 77.9646 79.898697 82.741798 87.361496 91.842598 95.2257 99.906601 102.1251 106.0392 110.7723 115.4424 120.1233 122.9664 126.9885 131.7126 136.33231 143.28841 147.96931 152.75641 156.13951 158.358 163.02811 167.70901 171.73111 175.6452 178.9203 180.88141 185.55151 188.93462 193.61551 196.9176 199.13609 203.7558 208.49699 213.1779 217.2 219.41849 224.20558 228.88647 232.26958 234.48807 236.40958 241.21198 245.83168 247.81349 251.72758 256.16727 259.55035 264.27444 266.49295 270.93265 273.15115 277.06525 281.79834 286.46844 291.14932 293.36783 297.38992 302.0708 306.74091 313.69699 318.37787 323.18027">IF call-gate code-segment descriptor does not indicate a code segment</tspan><tspan y="-667.9812" x="58.620003 63.339603 66.601204 68.820602 72.721199 77.188797 79.109398 81.029999 83.859596 88.516197 92.983795 96.353394 101.064 103.28339 107.18399 111.90359 116.5602 121.2708 124.1004 128.10899 132.8196 137.52029 144.4476 149.1879 153.9462 157.3662 159.5856 164.2269 168.96719 172.96049 176.84579 180.0921 182.0244 186.6657 190.01999 194.72429 197.9706 200.19 205.7043 210.8658 215.3091">or call-gate code-segment descriptor DPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-667.9812" x="217.56">&gt;</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-667.9812" x="222.4803 224.69971 229.41301 234.52231 238.97461"> CPL </tspan><tspan y="-655.98151" x="76.680298 81.860695 87.707092 92.42849 98.274887 100.49429 106.25969 111.53009 116.64749 119.23589 123.13829 127.60769 129.53009 131.45248 134.28389 138.94229 143.4117 146.7831 151.4955 153.7149 157.61731 162.33871 166.99712 171.70952 174.54092 178.5603 183.2574 187.93649 194.8656 199.6059 204.366 207.72209 209.9415 213.9366 218.6769 220.584 225.2811 229.1682 232.52429 237.26549 240.56758 243.14069 244.99379 247.2132 251.9193 253.99739">THEN #GP(call-gate code-segment selector); FI;</tspan><tspan y="-643.98181" x="58.620003 60.714302 65.4366 67.655998 69.750298 75.354599 80.616898 85.836899 90.388199 95.110497 99.832794 104.51369 109.938 111.64529 116.1066 122.6829 128.2872 130.50661 135.62491 137.84431 143.10661 145.32602 150.93031 156.77762 162.30992 164.52933 167.11862 171.02193 175.49223 177.41553 179.39642 182.21703 186.83673 191.3403 194.7207 199.40161 201.621 205.53241 210.26282 214.93022 219.61113 222.45152 226.47092 231.19232 235.81203 242.76543 247.44633 252.23073 255.61113 257.83054 262.49792 267.17883 271.19824 275.10965 278.38205 280.34045 284.96014 288.38016 293.06107 296.36316 298.58255 300.50406 304.52615">IF IA32_EFER.LMA = 1 AND (call-gate code-segment descriptor is </tspan><tspan y="-633.00183" x="58.619995 63.391796 68.109596 71.477394 73.696793 78.16259 80.381989 85.639786 90.897583 93.72538 98.38018 100.32598 103.69378 105.91318 109.81198 114.52979 119.18459 123.89339 126.11279 130.11958 134.82838 139.48318 146.42398 151.13278 155.90459 159.27238 161.55209 166.2699 169.52969 171.7491 175.70821 180.1803 182.082 183.9837 186.7944 191.4735 195.91319 199.26389 204.00418 206.22359 210.10529 214.84648 219.48418 224.22447 227.03517 231.05727 235.74896 240.42805 247.35176 252.09206 256.84677 260.26678 262.48618 267.12387 271.8642 275.88629 279.78601 283.02872 284.95743 289.63654 292.99625 297.73746 300.9603 303.17969 307.94968 312.41367 316.41867 318.63806 323.29108 328.00708 331.37308 336.14307 338.36246 342.81744 345.64343 350.29645 352.24045 355.60645 357.82584 362.28983 367.05981 371.71283 373.93222 379.45822 382.33911 386.99213 388.93613 392.30212 394.52151 398.52652 403.23352 406.59952">not a 64-bit code segment or call-gate code-segment descriptor has both L-bit and D-bit set)</tspan><tspan y="-621.00214" x="76.680298 81.860695 87.707092 92.42849 98.274887 100.49429 106.25969 111.53009 116.64749 119.23589 123.13829 127.60769 129.53009 131.45248 134.28389 138.94229 143.4117 146.7831 151.4955 153.7149 157.61731 162.33871 166.99712 171.70952 174.54092 178.5603 183.2574 187.93649 194.8656 199.6059 204.366 207.72209 209.9415 213.9366 218.6769 220.584 225.2811 229.1682 232.52429 237.26549 240.56758 243.14069 244.99379 247.2132 251.9193 253.99739">THEN #GP(call-gate code-segment selector); FI;</tspan><tspan y="-609.00244" x="58.620003 60.698101 65.439308 67.658707 71.545807 75.999908 77.980804 79.902298 82.718399 87.361496 91.860596 95.220299 99.917397 102.1368 106.0239 110.7651 115.4442 120.1251 122.3445 126.3396 131.0799 135.72299 142.68359 147.38069 152.18309 155.53918 157.75859 162.56099 167.24188 170.59798 172.81738 177.49648 180.73827 185.47856 189.50066 194.19775 199.00015 202.35625">IF call-gate code segment not present </tspan><tspan y="-597.00275" x="76.680305 81.857109 87.699905 92.417709 98.260513 100.47991 106.24171 112.08452 117.19832 119.78312 123.68192 128.14772 130.06651 131.98531 134.86621 139.52101 143.98682 147.35461 152.06342 154.28282 158.18163 162.89943 167.55423 172.26303 175.09084 179.10031 183.81992 188.43962 195.39122 200.07213 204.85474 208.23334 210.45273 214.47032 219.15123 221.08083 225.80043 229.71004 233.08864 237.81725 241.08784 243.68344 245.55904 247.77843 252.50703 254.60764">THEN #NP(call-gate code-segment selector); FI;</tspan><tspan y="-585.00305" x="58.62001 60.708912 65.425812 67.64521 71.543114 76.008011 77.988914 79.910416 82.737312 87.391212 91.85611 95.223007 99.930908 102.15031 106.04821 110.76511 115.41901 120.12691 122.34631 126.35221 131.0601 135.714 142.6539 147.3618 152.13271 155.4996 157.73972 159.66122 163.68332 165.90271 170.69431 175.3752 180.16679 183.01439 186.93298 191.67058 196.41267 199.77147 204.50906 207.75087 214.71147 216.63298 221.42458 226.04428 228.26367 232.74927 237.49136 242.16597 244.38536 249.93295 255.06656 259.54315">IF call-gate code segment is non-conforming and DPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-585.00305" x="261.71942">&lt;</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-585.00305" x="266.63971 268.85913 273.55353 278.71503"> CPL</tspan><tspan y="-573.00336" x="76.679398 81.859795 87.706192 92.427589 98.273987 100.49339 105.15179 109.87318 112.09258 115.51258 120.19348 122.41288 128.98828 134.71768 140.14108 144.86249 147.69389 152.81129 158.2347 160.32809 166.00349 168.09689 172.5573 177.2787 182.5491 187.27051">THEN go to MORE-PRIVILEGE;</tspan><tspan y="-561.00366" x="76.679398 81.400795 85.861198 90.636597 95.357994 97.577393 102.23579 106.95719 109.17659 112.54799 117.26939 119.48878 124.26418 129.86758 136.44298 141.16438 143.99579 149.11319 154.53659 156.62999 162.30539 164.39879 168.85919 173.5806 178.8015 183.54271">ELSE go to SAME-PRIVILEGE;</tspan><tspan y="-549.00397" x="58.619095 63.353996 65.460899">FI;</tspan><tspan y="-537.00427" x="45.119095 49.813496 55.694096 61.198494">END;</tspan><tspan y="-513.00397" x="45.119095 51.681896 57.440098 62.850899 67.5597 70.378502 75.483299 80.894096 82.974899 88.676399 90.777 95.2248 99.933601 105.1914 109.9002">MORE-PRIVILEGE:</tspan><tspan y="-501.00427" x="58.619095 60.699894 65.408691 67.627197 71.516998 76.318497 79.569298 82.820099 87.559494 92.322296 95.741402 97.959908 103.12771 107.89051 112.69201 114.91051 116.84731 120.84512 123.06362 128.31242 133.56122 136.44122 141.06003 143.04092">IF current TSS is 32-bit</tspan><tspan y="-489.00458" x="76.679398 81.888596 87.709793 92.459991 98.281189">THEN </tspan><tspan y="-477.00488" x="94.679398 99.862495 104.64059 109.41869 113.43179 116.80589 121.27799 125.18309 129.46619 135.07228 139.73338 144.35309 147.59488 152.30998 156.32309 160.3362 162.5556 164.30971 169.42981 171.64922 174.24031 179.03909 183.72989 190.69049 192.9099 196.7907 201.53189 206.16869 210.90898 213.71878 217.70758 222.39838 227.07747 234.00027 238.74057 243.49437 246.91438 249.13379 254.64359 259.73938 264.17819">TSSstackAddress := (new code-segment DPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-477.00488" x="266.33908">∗</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-477.00488" x="270.83908 273.05847 278.32349 280.9155"> 8) </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-477.00488" x="283.13937">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-477.00488" x="288.05966 290.27905 295.55304"> 4;</tspan><tspan y="-465.00519" x="94.679367 96.791664 101.53197 103.75137 106.35867 111.51747 116.31177 121.10606 125.06786 128.45816 132.89786 136.81915 141.07886 146.70116 151.32086 155.99817 159.23997 163.97128 167.93307 171.96237">IF (TSSstackAddress </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-465.00519" x="174.11966">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-465.00519" x="179.09937 181.31877 186.56937 189.14697 191.36638 196.38298 198.60239 202.49399 207.29639 210.54898 213.80157 218.54187 223.30647 226.72647 228.94588 234.11548 238.88008 243.68248 245.90189 247.81349 249.75209 256.6857 258.66751"> 5) &gt; current TSS limit</tspan><tspan y="-453.00549" x="112.67937 117.86156 123.70976 128.43297 134.28117 136.50058 142.26778 147.44998 152.22719 154.81738 158.72159 163.49879 166.76399 170.02919 174.74339 179.4855 182.9055 185.12491 190.30711 195.04922 199.82643 202.04584 206.05804 210.73895 212.66315 217.37735 221.28156 224.65475 229.37796 232.64316 235.23335 237.10355 239.32295 244.04616 246.14136">THEN #TS(current TSS selector); FI;</tspan><tspan y="-441.0058" x="94.679367 100.52307 105.23277 112.17447 116.94717 121.71986 123.93926 125.68797 130.80267 133.02208 138.28078 140.50018 145.15588 149.82959 153.19829 157.90799 161.9157 164.1351 166.05479 170.7735 175.2402 179.8959 184.60561 189.26131 191.48071 194.81342 198.07411 202.79282 209.73451 211.97906 214.57466 219.76227 224.54486 229.32745 231.54684 236.16655 240.66565 244.68324 249.40285 251.62224 256.80084 259.02023 264.20782 268.99042 273.77301 277.73483 281.11343 285.59003 289.49963 293.78723 299.39783 304.01752 308.68311 311.9537 316.67331 320.63513 324.65274">NewSS := 2 bytes loaded from (TSS base + TSSstackAddress </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-441.0058" x="326.75876">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-441.0058" x="331.73846 333.95786 339.20215 341.77344"> 4);</tspan><tspan y="-429.0061" x="94.678467 100.52396 105.23547 112.17896 116.89946 121.67396 126.79046 129.00986 130.81166 135.91286 138.13226 143.39276 145.61217 150.26967 154.94518 158.31567 163.02718 166.98898 169.20839 171.12988 175.85039 180.31889 184.97639 189.6879 194.3454 196.5648 199.89931 203.1618 207.88231 214.82581 217.07846 219.66595 224.84546 229.61996 234.39447 236.61388 241.27138 245.73988 249.74939 254.46089 256.68027 261.85077 264.07016 269.24966 274.02417 278.79868 282.80817 286.17868 290.64719 294.54868 298.82819 304.43069 309.0882 313.70789 316.94971 321.66119 325.67068 329.68018 332.26767">NewESP := 4 bytes loaded from (TSS base + TSSstackAddress);</tspan><tspan y="-417.00641" x="76.678452 81.411552 85.883652 90.670753 95.403854">ELSE </tspan><tspan y="-405.00671" x="94.678452 96.760155 101.46986 103.68926 107.57996 112.38236 115.63406 118.88577 123.62606 128.38976 131.80975 134.02916 139.19786 143.96156 148.76396 150.98337 152.92107 156.91977 159.13918 164.38887 169.63857 172.51947 177.13918 179.12097">IF current TSS is 16-bit</tspan><tspan y="-393.00702" x="112.67845 117.88765 123.70885 128.45905">THEN</tspan><tspan y="-381.00732" x="130.67845 135.84085 140.59825 145.40065 149.42274 152.77614 157.22754 161.11194 165.43105 171.01645 175.69554 180.33594 183.63805 188.33244 192.32484 196.31725 198.53665 200.27005 205.36945 207.58885 210.15926 214.96165 219.65605 226.61665 228.83606 232.72046 237.46165 242.10205 246.84235 249.65575 253.64815 258.34256 263.02167 269.94806 274.68835 279.44574 282.86572 285.08511 290.59851 295.69791 300.14032">TSSstackAddress := (new code-segment DPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-381.00732" x="302.33813">∗</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-381.00732" x="306.83813 309.05753 314.32254 316.91455"> 4) </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-381.00732" x="319.13843">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-381.00732" x="324.05872 326.27811"> 2</tspan><tspan y="-369.00763" x="130.67842 132.71962 137.46082 139.68021 142.28751 147.4463 152.2406 157.0349 160.99669 164.38699 168.82669 172.74799 177.00769 182.62999 187.24969 191.927 195.16881 199.90012 203.86191 207.8912">IF (TSSstackAddress </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-369.00763" x="210.11871">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-369.00763" x="215.09842 217.31783 222.56842 225.14603 227.36543 232.38203 234.60144 238.49304 243.29544 246.54803 249.80063 254.54092 259.30551 262.72549 264.94489 270.11447 274.87906 279.68146 281.90085 283.81244 285.75104 292.68463 294.66644"> 3) &gt; current TSS limit</tspan><tspan y="-357.00793" x="148.67842 153.84802 159.68362 164.39423 170.22983 172.44833 178.20293 183.37253 188.17403 190.75253 194.64413 199.44563 202.69823 205.95082 210.69022 215.49171 218.85051 221.06902 226.23862 231.04012 235.80472 238.02322 242.02283 246.72443 248.63603 253.37543 257.26703 260.62762 265.33823 268.59082 271.16843 273.02603 275.24451 279.95511 282.03772">THEN #TS(current TSS selector); FI;</tspan><tspan y="-345.00824" x="130.67842 136.51942 141.22643 148.16542 152.93542 157.70543 159.92484 161.67084 166.78284 169.00224 174.25824 176.47765 181.13065 185.80165 189.16765 193.87465 197.87965 200.09906 202.01607 206.73207 211.19608 215.84908 220.55608 225.20908 227.42848 230.75848 234.01648 238.73248 245.67148 247.91873 250.51433 255.70193 260.48453 265.26712 267.48651 272.1062 276.60529 280.62289 285.3425 287.56189 292.74048 294.95987 300.14746 304.93005 309.71265 313.67447 317.05307 321.52966 325.43927 329.72687 335.33746 339.95715 344.62274 347.89334 352.61295 356.57477 360.59238">NewSS := 2 bytes loaded from (TSS base + TSSstackAddress </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-345.00824" x="362.75873">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-345.00824" x="367.73843 369.95782 375.20212 377.77341"> 2);</tspan><tspan y="-333.00854" x="130.67844 136.52304 141.23364 148.17624 152.89584 157.66945 162.78505 165.00446 166.80626 171.90746 174.12686 179.38646 181.60587 186.26247 190.93707 194.30667 199.01727 202.97908 205.19849 207.17938 211.86029 216.3279 220.9845 225.6951 230.3517 232.57111 235.90471 239.16631 243.88591 250.82851 253.01813 255.60562 260.78513 265.55963 270.33414 272.55353 277.21103 281.67953 285.68903 290.40051 292.6199 297.79041 300.0098 305.1893 309.96381 314.73831 318.7478 322.11832 326.58682 330.48831 334.76782 340.37033 345.02783 349.64752 352.94965 357.66113 361.67062 365.68011 368.26761">NewESP := 2 bytes loaded from (TSS base + TSSstackAddress);</tspan><tspan y="-321.00885" x="112.67844 117.41334 121.85213 126.64104 131.37593 133.59532 136.19722 140.23012 142.44951 146.3654 151.1075 154.3844 157.62621 162.35211 167.09421 170.47911 172.6985 177.8924 182.63449 187.42339 189.64278 191.56429 195.58638 197.80577 203.08067 208.30067 211.14557 215.81747 217.73898 221.15898 223.37837 227.41127">ELSE (* current TSS is 64-bit *)</tspan><tspan y="-309.00916" x="130.67844 135.84084 140.59824 145.40063 149.42273 152.77612 157.22752 161.11192 165.43103 171.01643 175.69553 180.33592 183.63803 188.33243 192.32483 196.31723 198.53664 200.27003 205.36943 207.58884 210.15924 214.96164 219.65604 226.61664 228.83604 232.72044 237.46164 242.10204 246.84233 249.65573 253.64813 258.34253 263.02164 269.94803 274.68832 279.44574 282.86572 285.08511 290.59851 295.69791 300.14032">TSSstackAddress := (new code-segment DPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-309.00916" x="302.33813">∗</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-309.00916" x="306.83813 309.05753 314.32254 316.91455"> 8) </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-309.00916" x="319.13843">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-309.00916" x="324.05872 326.27811 331.55209"> 4;</tspan><tspan y="-297.00946" x="130.67842 132.71962 137.46082 139.68021 142.28751 147.4463 152.2406 157.0349 160.99669 164.38699 168.82669 172.74799 177.00769 182.62999 187.24969 191.927 195.16881 199.90012 203.86191 207.8912">IF (TSSstackAddress </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-297.00946" x="210.11871">+</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-297.00946" x="215.09842 217.31783 222.56842 225.14603 227.36543 232.38203 234.60144 238.49304 243.29544 246.54803 249.80063 254.54092 259.30551 262.72549 264.94489 270.11447 274.87906 279.68146 281.90085 283.81244 285.75104 292.68463 294.66644"> 7) &gt; current TSS limit</tspan><tspan y="-285.00977" x="148.67842 153.84802 159.68362 164.39423 170.22983 172.44833 178.20293 183.37253 188.17403 190.75253 194.64413 199.44563 202.69823 205.95082 210.69022 215.49171 218.85051 221.06902 226.23862 231.04012 235.80472 238.02322 242.02283 246.72443 248.63603 253.37543 257.26703 260.62762 265.33823 268.59082 271.16843 273.02603 275.24451 279.95511 282.03772">THEN #TS(current TSS selector); FI;</tspan><tspan y="-273.01007" x="130.67842 136.51402 141.21562 148.14922 152.95161 157.71622 159.93562 161.67622 166.83772 169.05713 173.82173 178.56203 185.49562 187.71503 191.60663 196.31723 200.96483 205.70512 208.52573 212.52533 217.22693 221.87453 228.80812 233.50972 238.31212 241.67181 243.89122 249.41182 254.51842 259.01752 260.87781 263.0972 265.6748 269.68341 271.9028 277.7384 283.41202 287.86163 292.31122 294.53061 298.53021 303.27051 305.1821 309.8837 313.7753 317.13589 321.8465 325.14859 327.36798 334.30157 336.28339 339.64398 344.40857 346.62796 352.08737 357.18857 361.63818 363.85757 368.96417 371.18356 375.98596 380.66687 387.60046 389.81985 394.53046 399.63705 404.08667 406.30606 410.31467">NewSS := new code-segment DPL; (* NULL selector with RPL = new CPL *)</tspan><tspan y="-261.01038" x="130.67842 136.52213 141.23183 148.17352 153.59422 158.36693 163.48163 165.70103 167.44974 172.56444 174.78384 180.04254 182.26195 186.91765 191.59135 194.96005 199.66975 203.67746 205.89687 207.81656 212.53526 217.00197 221.65767 226.36737 231.02307 233.24248 236.57518 239.83588 244.55458 251.49628 253.71568 256.30139 260.20108 264.97379 268.19843 271.45914 276.16882 280.94153 284.31024 286.52963 291.70734 296.48004 301.25275 303.47214 308.12784 312.59454 316.60223 321.31192 323.53131 328.70001 330.9194 336.09711 340.86981 345.64252 349.65021 353.01892 357.48563 361.38531 365.66302 371.26373 375.91943 380.53912 383.84125 388.55093 392.55862 396.56631 399.15201">NewRSP := 8 bytes loaded from (current TSS base + TSSstackAddress);</tspan><tspan y="-249.01068" x="94.678421 99.413322 101.52023">FI;</tspan><tspan y="-237.01099" x="58.618122 63.353024 65.459923">FI;</tspan><tspan y="-225.01129" x="58.618122 60.715122 65.440125 67.659523 69.756523 75.363525 80.628525 85.848526 90.402527 95.127525 99.852524 104.53342 109.96043 111.67043 116.13442 122.71342 128.32042 130.53983 135.66083 137.88023 143.14523 145.36464 149.83765 154.61665 159.27866 161.49806 167.34807 172.06407 179.01207 183.79108 188.57008 190.78949 192.74249 196.7043 198.92371 204.77371 210.46172 214.92572">IF IA32_EFER.LMA = 0 and NewSS is NULL</tspan><tspan y="-213.0116" x="76.678421 81.869621 87.690819 92.423019 98.244217 100.46362 106.23981 111.39861 116.18481 118.78401 124.60521 129.34552 136.30072 141.04282 145.82901 148.42821 150.3074 152.52679 157.259 159.3632">THEN #TS(NewSS); FI;</tspan><tspan y="-201.0119" x="58.618118 64.047821 68.766525 73.242226 77.861931 80.081329 84.863029 89.581726 96.532425 98.751823 102.76852 106.14622 110.62193 114.53062 118.81732 121.65502 125.67172 130.31842 134.97862 141.87892 146.59312 151.37033 154.74353 156.96294 161.58264 166.32294 170.33514 174.23935 177.50455 179.42606 184.08626 187.45946 192.18266 195.44786 197.31805">Read new stack-segment descriptor; </tspan><tspan y="-189.01221" x="58.618118 60.715118 65.440117 67.659515 69.756516 75.363518 80.628517 85.848518 90.402519 95.127518 99.852516 104.53342 109.96042 111.67042 116.13441 122.71342 128.32042 130.53983 135.66083 137.88023 143.14523 145.36464 149.83765 154.61665 159.27866 161.49806 164.09006 169.94006 174.65607 181.55637 186.33537 191.11438 193.33379 198.76079 203.88179 208.34579">IF IA32_EFER.LMA = 0 and (NewSS RPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-189" x="210.53999">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-189" x="216.06 218.2794 223.0386 227.7789 234.70711 236.92651 240.81271 245.55391 250.233 254.91389 257.7291 261.7233 266.46359 271.08331 278.04391 282.72482 287.52722 290.8869 293.10629 298.62149 303.72269"> new code-segment DPL</tspan><tspan y="-177.00031" x="58.6203 63.339901 66.601501 68.8209 73.594498 78.305099 85.205399 87.424797 91.433395 94.802994 99.270592 103.17119 107.44979 110.27939 114.28799 118.99859 123.65519 130.59779 135.3084 140.082 143.4516 145.67101 151.20061 156.31621 160.77481">or new stack-segment DPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE c8037F88D"><tspan y="-177" x="163.08">≠</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-177" x="168.53999 170.75938 175.50148 180.24179 187.19699 189.41638 193.32959 198.0105 202.6797 207.36061 210.2028 214.1646 218.8878 223.50751 230.46271 235.18591 239.92801 243.2877 245.5071 251.0493 256.17749 260.64868 262.86807 267.60028 270.87448 273.09387 277.88007 282.56097 289.51617 291.73557 295.69739 299.1174 303.5571 307.45682 311.74802 313.96741 317.98862 322.71182 327.33151 334.29211 338.97302 343.77542 347.15762 349.37701 351.33722 355.29904 357.51843 362.30463 367.03683 370.41904 372.63843"> new code-segment DPL or new stack segment is not a</tspan><tspan y="-165.9597" x="58.620293 65.580894 68.822693 70.804497 74.1642 78.6633 83.283005 85.184708 89.925011 92.144409 96.782112 101.28121 104.63191 109.08061 111.30001 115.32211 120.06242 124.70012 131.66072 136.35242 141.15482 144.50552">writable data segment)</tspan><tspan y="-153.96001" x="76.680595 81.872696 87.693893 92.426994 98.248192 100.46759 106.24469 111.40349 116.19059 118.79069 124.61189 129.35219 136.30829 141.05038 145.83748 148.43758 150.31767 152.53706 157.27016">THEN #TS(NewSS); FI</tspan><tspan y="-141.96031" x="58.620293 60.722694 65.453094 67.672493 69.774895 75.387299 80.6577 85.877701 90.437103 95.167503 99.897903 104.5788 110.01121 111.69151 116.1609 122.7453 128.3577 130.57709 135.70349 137.92288 143.19328 145.41267 149.85237 154.65477 159.32217 161.54156 166.28366 171.02397 177.92427 180.14366 184.16306 187.54346 192.02185 195.93326 200.22266 202.44205 206.46144 211.14235 215.80975 222.76315 227.44406 232.24646 235.62686 237.84625 242.58835 247.32956 250.70996 252.92935 257.59674 260.86914 265.59055 269.55237 274.27377 279.01587 282.39627">IF IA32_EFER.LMA = 0 and new stack segment not present </tspan><tspan y="-129.96062" x="76.680595 81.869995 87.725395 92.455795 98.311195 100.53059 106.30499 111.08939 115.8315 118.4109 124.2663 128.9472 135.9006 140.6427 145.42709 148.02449 149.90189 152.12128 156.85168 158.95409">THEN #SS(NewSS); FI;</tspan><tspan y="-117.96091" x="58.620293 60.698391 65.439598 67.658997 72.4002 76.839905 78.747002 80.654099 85.909195 90.363297 93.783302 98.4804 103.2828 105.2169 109.4181 114.1152">IF CallGateSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-117.96" x="116.34 122.16062">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-117.96" x="124.98 130.2">32</tspan><tspan y="-105.9603" x="76.679703 81.888901 87.710098 92.460297">THEN</tspan><tspan y="-93.960594" x="94.679703 96.790199 101.5287 103.74811 108.54061 113.22151 120.18301 122.40242 126.42992 129.81842 134.25812 138.15781 142.41751 144.6369 149.31241 154.0509 158.73181 162.75391 164.9733 169.76579 174.44669 177.83519 180.05458 184.84708 189.28677 193.94427 198.62518 200.84457 204.12508 208.80597 213.54446 220.43939 222.6588 225.9852 230.6976 233.952 236.1714 240.8208 245.2812 248.5356 253.0347 259.97009 264.67349 268.03589 272.77618 276.03058 280.03198 282.25137 286.90079 288.88168 293.64807 297.64948 299.86887 305.12128 310.37369 312.59308 317.24249 321.90988 325.27228 329.97568">IF new stack does not have room for parameters plus 16 bytes</tspan><tspan y="-81.960892" x="112.6797 117.86909 123.72449 128.4549 134.3103 136.52969 142.30409 147.08849 151.83058 154.40997 160.26538 164.94629 171.89969 176.64178 181.42618 184.02357 185.90097 188.12036 192.85077 194.95317">THEN #SS(NewSS); FI;</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="457.9035pt" height="644.68066pt" viewBox="0 0 457.9035 644.68066" sodipodi:docname="253.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="327.96743" inkscape:cy="423.81706" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg130" /><g transform="translate(-60.024429,-69.182129)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="95.519997 97.594498 102.33569 104.55509 109.29629 113.73598 115.63949 117.54299 122.79449 127.245 130.66499 135.35849 137.92799 140.00249 144.80489 148.79639 152.21638 155.46089 160.26329 164.14679 167.49928 169.42978 174.17097 178.92747 184.08897 188.79147 190.77327 195.52977 198.94977 203.64326 206.88777 209.52658 211.74599 216.50249 221.24368 224.59618 226.81558 233.77618 235.69768 239.05017 243.85257 245.78307 250.58546 252.80487 257.56137 262.3017 269.2272 271.44659 275.33011 280.07132 284.75043 289.43134 292.24384 296.23532 300.97565 305.59534 312.55594 317.23685 322.03925 325.39896 327.61835 329.52185 331.50366 338.42917 340.41098 343.76349">IF CallGate(InstructionPointer) not within new code-segment limit </tspan><tspan y="-703.98029" x="113.52 118.70039 124.54679 129.26819 135.11459 137.334 143.0994 148.3698 153.4872 156.07559 161.33699 163.92538 165.79378 168.01318 172.73459 174.82799">THEN #GP(0); FI;</tspan><tspan y="-691.98059" x="95.519997 100.3224 105.12479 107.34419 109.07399 114.16979 116.38919 121.14299 125.88329 132.84389 137.58598 142.38838 144.24869 149.52809 152.1669 156.18901 158.40842 163.16222 167.90251 172.53931 179.49991 184.1907 188.9931 192.34291 194.56232 199.24141 203.9223 207.9111 211.7919 215.03371 217.0155 221.6523 225.07231 229.77211 233.07422 235.29362 237.22142 242.02382 245.33762 250.07881 253.32062 260.28122 264.72903 268.14902 270.07681 274.81802 279.57184 281.79126 286.29037 288.21185 292.20065 296.90045 299.11987 301.02066 305.76187 310.20969 314.88879 319.57959 324.2587 326.47812 330.47592">SS := newSS; (* Segment descriptor information also loaded *)</tspan><tspan y="-679.9809" x="95.519997 100.2549 105.0438 110.1747 112.3941 114.159 119.2899 121.50931 126.29821 130.97911 137.93701 142.67191 147.414 152.51521 154.39711">ESP := newESP; </tspan><tspan y="-667.9812" x="95.519997 100.2477 105.0294 106.78709 111.46799 113.5677 118.6914 120.9108 122.6685 127.7922 130.0116 134.7393 139.179 141.1077 143.03639 148.3131 152.75279 156.17279 160.8537 163.43309 168.1608 172.90291 174.66061 176.76031 181.50243 185.52452 188.90222 192.17192 196.95361 200.86232 204.24002 206.19572 210.87663 215.67903 220.80273 225.53044 227.45195 232.25435 235.63205 240.31296 243.58266 246.17735 248.05205">CS:EIP := CallGate(CS:InstructionPointer); </tspan><tspan y="-655.98151" x="95.519997 98.158798 102.1809 104.4003 109.1514 113.8917 118.5258 125.4864 130.1745 134.9769 138.32401 140.54341 145.2225 149.9034 153.92549 157.8252 161.0643 163.0461 167.68019 171.1002 175.7973 179.09941 181.31882 183.24391 188.04631 191.35741 196.0986 199.33771 206.29831 210.74341 214.09052 216.07231 220.81351 225.56461 227.78401 232.28311 234.20462 238.19072 242.93192 245.15132 247.04942 251.79062 256.23572 260.91483 265.60294 270.28204 272.50143 276.49652">(* Segment descriptor information also loaded *)</tspan><tspan y="-643.98181" x="95.519997 100.6383 105.4146 109.4259 114.20219 116.7915 121.51379 123.4371 128.09639 132.8727 137.649 139.40131 144.12361 146.04691 150.70621 155.42851 160.20482 165.32312 167.91241 169.78171 172.00111 174.59041 178.6107 180.83011 185.55241 188.75999 193.4868 200.4366 202.65601 206.56381 211.00351 212.9313 214.8591 216.8139 221.556 226.23511 228.4545 233.1183 236.3871 241.11391 245.02171 249.70262 254.38173 259.12384 262.42593 267.10684 269.32623 273.35104">Push(oldSS:oldESP); (* From calling procedure *)</tspan><tspan y="-631.98212" x="95.519997 98.939995 103.6209 110.56439 115.22189 117.44129 119.2431 124.3443 126.5637 131.22119 135.6897 138.95219 143.4207 150.3642 155.0757 158.4462 163.1577 166.4202 168.6396 172.54111 177.26161 182.03612 186.81062 190.18112 192.40053 195.73503 198.99753 203.71803 210.66153 212.8197 216.7131 221.17351 223.08691 225.06783 227.28723 231.93663 236.39703 239.75943 244.46283 246.32133 248.54074 255.47614 259.93652 263.93793 268.20932 272.91272 277.56213 279.78152 283.14392 287.85632 290.07571 295.32812 297.54752 302.19693 304.13733 307.55731 311.5191">temp := parameter count from call gate, masked to 5 bits;</tspan><tspan y="-619.98242" x="95.519997 100.6815 105.42361 109.41601 114.21841 116.7888 121.42921 125.92831 129.1701 133.6692 140.56952 145.30981 148.66951 153.36391 156.66602 160.65842 162.87782 166.19522 169.44063 174.18182 181.14243 183.36183 187.24623 191.69763 193.60204 195.50644 197.48824 202.24564 206.92473 209.14413 213.82323 217.06503 221.80623 225.70593 230.40033 235.07942 239.83682 243.13893 247.83333 249.45512 253.44753 255.66693 259.65933 263.01273 267.51181 271.4115 275.67389 277.53238 279.75177 283.10516 287.79956 294.76016 299.43927">Push(parameters from calling procedure’s stack, temp)</tspan><tspan y="-607.98273" x="95.519997 100.6347 105.40739 109.41509 114.18779 116.77349 121.49219 123.41189 128.06758 132.78629 137.55899 139.30769 144.0264 145.94609 150.60179 155.3205 157.41119 162.52589 165.16469 167.0304 169.2498 171.83549 175.85219 178.07159 183.49229 188.202 191.57069 196.3434 199.6041 204.3768 206.57999 211.06828 215.68799 220.3653 223.6071 228.33841 232.36771 236.3295 238.54889 241.93919 246.62009 248.83948 252.76077 257.24908 259.1904 261.13171 263.05319 267.8475 272.46722 274.68665 279.36395 282.60574 287.34604 291.26733 295.99863 300.61835 305.41266 308.65445 313.38574 315.60516 319.64346">Push(oldCS:oldEIP); (* Return address to calling procedure *)</tspan><tspan y="-595.98303" x="77.519989 82.25309 86.725189 91.512291 96.245392">ELSE </tspan><tspan y="-583.98334" x="95.519989 97.611588 102.33119 104.55059 109.27019 113.73779 115.65839 117.57899 122.84759 127.31519 130.73518 135.44579 140.21939 142.16699 146.3286 151.0392 153.25861 158.37421 160.59361 165.85321">IF CallGateSize = 16</tspan><tspan y="-571.98364" x="113.51999 118.72919 124.55038 129.30058">THEN</tspan><tspan y="-559.98395" x="131.51999 133.60619 138.32039 140.53979 145.34219 150.02309 156.96028 159.17969 163.18289 166.60289 171.06509 174.9603 179.23349 181.4529 186.1041 190.8183 195.5235 199.5267 201.74611 206.51431 211.22852 214.59271 216.81212 221.61452 226.05421 230.73331 235.4142 237.63361 240.8898 245.604 250.31821 257.2554 259.47479 262.80298 267.51718 270.77338 272.99277 277.64398 282.10617 285.36237 289.86145 296.79865 301.50385 304.86804 309.60834 312.86453 316.86774 319.08713 323.73834 325.65353 330.45593 334.47803 336.69742 341.95163 344.17102 348.82224 353.49142 356.85562 361.59592">IF new stack does not have room for parameters plus 8 bytes</tspan><tspan y="-547.98425" x="149.51999 154.7094 160.56479 165.2952 171.1506 173.37 179.14439 183.92879 188.67088 191.25027 197.10568 201.78659 208.73999 213.48209 218.26648 220.86388 222.74127 224.96066 229.69107 231.79347">THEN #SS(NewSS); FI;</tspan><tspan y="-535.98456" x="131.51999 133.62057 138.36177 140.58118 143.14888 147.89008 152.33878 154.24048 156.14218 161.42247 165.92157 169.28128 173.97298 176.54068 178.64127 183.44366 187.46576 190.82547 194.06818 198.87057 202.75227 206.10297 208.03166 212.77286 217.57526 222.67645 227.37715 229.35895 234.16135 237.52106 242.21275 245.51486 248.08257 250.30197 255.88467 261.71039 267.2886 269.508 274.20871 278.94992 283.65063 288.39185 294.21756 296.85635 299.07574 303.83044 308.57166 311.92236 314.14175 316.07047 320.87286 323.09225 327.89465 332.57556 339.53616 341.75555 345.63727 350.33798 355.01709 359.698 362.57889 366.54068 371.28101 375.96011 382.88382 387.62415 392.37885 395.72955 397.94894 399.85065 401.83246 408.79306 410.71457">IF (CallGate(InstructionPointer) AND FFFFH) not in new code-segment limit</tspan><tspan y="-523.98486" x="149.51999 154.70039 160.5468 165.2682 171.11461 173.33401 179.09941 184.36981 189.48721 192.07561 197.33701 199.9254 201.79379 204.0132 208.7346 210.828">THEN #GP(0); FI;</tspan><tspan y="-511.98517" x="131.51999 136.30528 141.09058 143.30997 145.07127 150.19858 152.41797 157.20326 161.88417 168.83847 173.58057 178.36586 180.24416 185.58385 188.18214 192.21144 194.43083 199.17293 203.91324 208.53294 215.49355 220.17445 224.97685 228.35815 230.57755 235.24585 239.92676 243.94705 247.85934 251.10115 253.08296 257.70264 261.12262 265.8035 269.10559 271.32501 273.24649 278.04889 281.3483 286.08948 289.33127 296.29187 300.73157 304.15155 306.07303 310.81421 315.5563 317.77573 322.25504 324.18735 328.20764 332.88852 335.10794 337.04025 341.77155 346.21124 350.89035 355.57123 360.25034 362.46976 366.49905">SS := newSS; (* Segment descriptor information also loaded *)</tspan><tspan y="-499.98547" x="131.51999 136.25488 141.04378 146.17468 148.39407 150.15897 155.28987 157.50926 162.29816 166.97906 173.93697 178.67186 183.41396 188.51517 190.39706">ESP := newESP; </tspan><tspan y="-487.98578" x="131.51999 136.24049 141.015 142.7655 144.858 149.9745 152.19391 153.94441 159.06091 161.28032 166.00082 170.46933 172.39082 174.31232 179.58182 184.05032 187.42082 192.13232 194.71982 199.44032 204.21483 205.96533 208.08029 212.8476 216.8499 220.2132 223.51529 228.28259 232.1769 235.59689 237.51839 242.23169 246.99899 252.16049 256.84137 258.78268 263.54999 266.9133 271.61761 274.87292 277.45322">CS:IP := CallGate(CS:InstructionPointer);</tspan><tspan y="-475.98608" x="131.51999 134.1588 138.18089 140.4003 145.1523 149.89259 154.52759 161.48819 166.17719 170.97958 174.32759 176.547 181.22609 185.90698 189.92908 193.82878 197.06879 199.05058 203.68558 207.10559 211.80359 215.1057 217.3251 219.2511 224.0535 227.36549 232.10669 235.34669 242.3073 246.7533 250.17331 252.0993 256.84052 261.59253 263.81195 268.31107 270.23254 274.25464 278.93555 281.15497 283.05396 287.79517 292.24118 296.92029 301.60928 306.28839 308.50781 312.50381">(* Segment descriptor information also loaded *)</tspan><tspan y="-463.98639" x="131.51999 136.63829 141.4146 145.4259 150.20221 152.7915 157.51381 159.4371 164.09641 168.87271 173.64902 175.40132 180.12363 182.04692 186.70622 191.42853 196.20483 201.32314 203.91243 205.78172 208.00113 210.59042 214.61072 216.83012 221.55243 224.75998 229.48679 236.43658 238.65598 242.56378 247.00348 248.93127 250.85907 252.81387 257.55597 262.23505 264.45444 269.11823 272.38702 277.11383 281.02164 285.70255 290.38162 295.12372 298.42581 303.10672 305.32611 309.35092">Push(oldSS:oldESP); (* From calling procedure *)</tspan><tspan y="-451.98669" x="131.51999 134.93999 139.6209 146.56439 151.22189 153.4413 155.2431 160.3443 162.56371 167.22121 171.68971 174.95221 179.42072 186.36421 191.07571 194.44621 199.15771 202.42021 204.63962 208.54112 213.26163 218.03613 222.81064 226.18114 228.40054 231.73505 234.99754 239.71805 246.66154 248.8197 252.72211 257.1915 259.17239 261.0939 263.31329 267.97168 272.44107 275.81247 280.52487 282.34827 284.56766 291.51205 295.98145 299.99185 304.1994 308.90909 313.56479 315.78418 319.15289 323.87158 326.09097 331.34967 333.56906 338.22476 340.17145 343.54016 347.54785">temp := parameter count from call gate, masked to 5 bits;</tspan><tspan y="-439.987" x="131.51909 136.68059 141.42268 145.41418 150.21658 152.78609 157.42558 161.92468 165.16649 169.66559 176.56589 181.30618 184.66588 189.35938 192.66148 196.65298 198.87239 202.18889 205.491 210.1935 217.1541 219.3735 223.257 227.7075 229.61101 231.51451 233.49631 238.25281 242.9319 245.15131 249.8304 253.0722 257.81342 261.71313 266.40665 271.08575 275.84225 279.14435 283.83786 285.45966 289.45114 291.67053 295.66202 299.01453 303.51364 307.41245 311.67395 313.53244 315.75183 319.10434 323.79785 330.75845 335.43756">Push(parameters from calling procedure’s stack, temp)</tspan><tspan y="-427.9873" x="131.51909 136.63379 141.40649 145.4142 150.1869 152.7726 157.4913 159.411 164.0667 168.7854 173.55811 175.30681 180.02551 181.94521 186.60091 191.31961 193.41031 198.52501 201.1638 203.02951 205.24892 207.83461 211.8513 214.07071 219.49141 224.20111 227.56981 232.34251 235.60321 240.37592 242.57909 247.06738 251.68709 256.36438 259.60617 264.33746 268.36676 272.32855 274.54797 277.93826 282.61917 284.83859 288.75989 293.2482 295.18951 297.13083 299.05231 303.84662 308.46634 310.68576 315.36307 318.60486 323.34515 327.26645 331.99774 336.61746 341.41177 344.65356 349.38486 351.60428 355.64258">Push(oldCS:oldEIP); (* Return address to calling procedure *)</tspan><tspan y="-415.98761" x="113.51909 118.25219 122.69099 127.47809 132.21118 134.43057 137.03067 141.06177 143.28116 147.96205 152.46115 154.39525 156.32935 161.61145 166.05115 169.41084 174.13495 178.87704 180.83815 184.97905 189.70316 191.92255 197.05165 199.27104 204.54414 209.76414 211.98354 216.01463">ELSE (* CallGateSize = 64 *)</tspan><tspan y="-403.98792" x="131.51909 133.62509 138.35909 140.57938 145.25038 149.99248 154.01547 158.75757 160.71957 165.50757 170.12727 172.34756 177.62157 182.84157 185.06186 189.73286 194.42186 197.80586 202.53087 206.49266 208.71295 213.44695 218.23494 220.45523 223.83923 228.58133 233.30634 235.52663 239.54962 242.93362 247.37332 251.27301 255.56601 257.78632 264.74332 269.47733 274.21942 276.14093 280.81192 283.03223 287.82022 291.78204 296.50705 298.72736 303.16705 305.38736 310.17535 314.85626 319.64426 322.48825 326.40326 330.88525 335.62735 340.36856 345.11066 347.09247 351.00748 355.44717 357.38217 359.60248 364.08447 368.70416 373.37515 376.65115 381.37616 385.39917">IF pushing 32 bytes on the stack would use a non-canonical address</tspan><tspan y="-391.98822" x="149.51909 154.7085 160.5639 165.29431 171.14972 173.36911 179.14351 183.9279 188.67 191.24939 197.1048 201.78571 208.73911 213.4812 218.26559 220.86299 222.74039 224.95978 229.69019 231.79259">THEN #SS(NewSS); FI;</tspan><tspan y="-379.98853" x="131.51909 133.61789 138.3447 140.56409 143.15788 147.88469 152.3244 154.2522 156.17999 161.4558 165.9306 169.3074 173.98831 176.5677 178.6665 183.4473 187.46309 190.83989 194.0817 198.88409 202.7919 206.1687 208.09021 212.83142 217.61221 222.73502 227.41592 229.39772 234.17853 237.55533 242.23624 245.53833 248.13213 250.35153 252.27304 256.29514 258.51453 263.29532 267.97623 272.75702 275.59381 279.50162 283.94131 288.72211 293.44891 298.19101 300.17282 304.08063 308.52032 310.44812 313.04193">IF (CallGate(InstructionPointer) is non-canonical) </tspan><tspan y="-367.98883" x="149.51909 154.69949 160.5459 165.2673 171.11371 173.33311 179.09851 184.36891 189.48631 192.07471 197.33611 199.9245 201.79289 204.0123 208.7337 210.8271">THEN #GP(0); FI;</tspan><tspan y="-355.98914" x="131.51909 136.30348 141.08788 143.30727 145.06767 150.19408 152.41347 158.23466 162.97498 169.87527 174.65967 179.44406 181.32146 183.54085 186.13824 190.16664 192.38603 198.20723 202.94754 209.84784 214.65024 219.39233 221.61172 223.57013 227.58952 229.80891 235.63011 241.33162 245.77043 250.20924">SS := NewSS; (* NewSS is NULL)</tspan><tspan y="-343.98944" x="131.51909 136.9641 141.70619 146.84518 149.06458 150.80608 155.90727 158.12666 163.94786 168.68816 175.58846 180.32965 185.12665 190.22786 192.11786">RSP := NewESP; </tspan><tspan y="-331.98975" x="131.51909 136.23959 141.0141 142.7646 144.8571 149.9736 152.19301 153.94351 159.06001 161.27942 165.99992 170.46843 172.38992 174.31142 179.58092 184.04942 187.41992 192.13142 194.71892 199.43942 204.21393 205.96443 208.07938 212.84668 216.84898 220.21228 223.51437 228.28168 232.17598 235.59598 237.51747 242.23077 246.99808 252.15958 256.84045 258.78177 263.54907 266.91238 271.6167 274.87201 277.4523">CS:IP := CallGate(CS:InstructionPointer);</tspan><tspan y="-319.99005" x="131.51907 134.15788 138.17998 140.39938 145.15138 149.89168 154.52667 161.48727 166.17627 170.97867 174.32668 176.54608 181.22517 185.90607 189.92816 193.82787 197.06787 199.04967 203.68466 207.10468 211.80267 215.10478 217.32419 219.25018 224.05258 227.36458 232.10577 235.34578 242.30638 246.75238 250.17239 252.09839 256.8396 261.59161 263.81104 268.31015 270.23163 274.25372 278.93463 281.15405 283.05304 287.79425 292.24026 296.91937 301.60837 306.28748 308.5069 312.5029">(* Segment descriptor information also loaded *)</tspan><tspan y="-307.99036" x="131.51907 136.63737 141.41368 145.42499 150.20129 152.79059 157.51289 159.43619 164.09549 168.8718 173.6481 175.40041 180.12271 182.04601 186.70531 191.42761 196.20392 201.32222 203.91151 205.78081 208.00021 210.58951 214.6098 216.82921 221.55151 224.75906 229.48587 236.43567 238.65506 242.56287 247.00256 248.93036 250.85815 252.81296 257.55505 262.23413 264.45352 269.11731 272.38611 277.11292 281.02072 285.70163 290.38071 295.1228 298.4249 303.1058 305.3252 309.35001">Push(oldSS:oldESP); (* From calling procedure *)</tspan><tspan y="-295.99066" x="131.51907 136.63377 141.40648 145.41418 150.18689 152.77258 157.49129 159.41098 164.06668 168.78539 173.55809 175.30679 180.0255 181.94519 186.60089 191.3196 193.41029 198.52499 201.16379 203.0295 205.2489 207.83459 211.85129 214.07069 219.49139 224.2011 227.56979 232.3425 235.6032 240.3759 242.57907 247.06737 251.68707 256.36438 259.60617 264.33746 268.36676 272.32855 274.54797 277.93826 282.61917 284.83859 288.75989 293.2482 295.18951 297.13083 299.05231 303.84662 308.46634 310.68576 315.36307 318.60486 323.34515 327.26645 331.99774 336.61746 341.41177 344.65356 349.38486 351.60428 355.64258">Push(oldCS:oldEIP); (* Return address to calling procedure *)</tspan><tspan y="-283.99097" x="95.519073 100.25397 102.36088">FI;</tspan><tspan y="-271.99127" x="59.519073 64.253975 66.360878">FI;</tspan><tspan y="-259.99158" x="59.519073 61.625973 66.36087 68.580276 73.32238 78.124779 82.564484 87.243584 91.978485 98.878784 103.66769 107.05259 111.53549 115.45139 119.71109 124.39199 129.18089 133.62059 138.2925 140.22839 144.9543 149.57401 152.1759 156.9108 162.0417 166.51561 169.11751 171.3369 176.9169 182.7381 188.283 190.5024 195.23729 200.36819 204.8421 207.06149 212.1924 214.41179">IF ShadowStackEnabled(CPL) AND CPL = 3</tspan><tspan y="-247.99188" x="77.519073 82.728271 88.549469 93.299667">THEN</tspan><tspan y="-235.99219" x="95.519073 97.615173 102.33927 104.55867 106.65477 112.26087 117.52497 122.74497 127.29807 132.02217 136.74628 141.42719 146.85329 148.56239 153.0255 159.60359 165.20969 167.42909 172.54919 174.7686">IF IA32_EFER.LMA = 0</tspan><tspan y="-223.99249" x="113.51907 118.70937 124.56567 129.29697 135.15326 137.37265 139.47595 145.08925 150.36055 155.63185 160.13275 165.26006 169.73036 175.00166 179.50256 184.28786 189.02995 194.15726 196.37665 198.13795 203.26526 205.48465 210.26994 215.01204 220.13934">THEN IA32_PL3_SSP := SSP;</tspan><tspan y="-211.9928" x="113.51907 118.23957 122.69907 127.47357 132.19408 134.41348 137.00098 141.01947 143.23888 147.70738 152.36488 154.31339 159.08789 163.0974 166.4679 168.6873 172.69681 177.41731 179.63672 184.29422 186.24272 189.61322 193.62273 195.84213 201.10263 206.36313 208.11363 213.95914 216.17854 220.83604 225.54755 228.91805 231.13745 234.55745 239.29956 244.01106 246.23047 250.86996 255.33847 257.25998 262.03448 266.74597 268.96536 273.68585 277.02036 279.23975 283.89725 285.84573 289.21625 291.43564 297.28113 301.23663 306.49713 308.27905 310.49844 317.46265 322.20474 326.93695 330.17874 334.91095 337.13034 342.95154 345.17093 347.14014 351.10196 353.32135 356.71255 361.45465 366.18686 368.40625 373.08716 378.24866 383.88986 385.51166 389.54187 391.76126 398.66156 403.16064 407.89825 409.88007 416.78036 421.58276 428.54697 430.76636 432.70856 434.63007 439.42526 444.10617 448.59537 451.83716 454.68835 459.17755 463.79724 468.47632 471.71811 476.4584 480.48862 484.45044 486.66983 493.63403 495.60324 500.22293 503.58264 508.37784 510.59723 514.63641">ELSE (* adjust so bits 63:N get the value of bit N–1, where N is the CPU’s maximum linear-address width *)</tspan><tspan y="-199.9931" x="131.51906 133.61246 139.21585 144.43585 149.71616 154.26656 159.38396 163.84436 169.10576 173.65616 178.43156 183.20697 188.32437 190.54378 192.29518 197.41258 199.61935 204.09775 209.67775 214.24615 218.68585 223.36226 225.28377 230.07716 234.10556 237.49496 240.10136 244.89476 249.63686 254.77226 257.37866">IA32_PL3_SSP := LA_adjust(SSP);</tspan><tspan y="-187.99341" x="95.519058 100.25396 102.36086">FI;</tspan><tspan y="-175.99371" x="59.519058 64.25396 66.360863">FI;</tspan><tspan y="-163.99402" x="59.519058 64.252159 69.381256 73.853355 76.072754 77.835854 82.964951 85.184349 89.91745 94.598351 99.268448 103.94935 108.73645 113.41735 118.08745 125.04355 129.72446 134.52686 137.90996 140.51006 146.05316 151.18227 155.65437">CPL := CodeSegment(DPL)</tspan><tspan y="-151.99432" x="59.519058 64.235962 69.006859 71.590759 77.009659 82.122559 86.621658 89.205559 91.424957 93.17186 98.28476 100.50416 105.22106 110.33396">CS(RPL) := CPL</tspan><tspan y="-139.99463" x="59.519058 61.626858 66.362656 68.582062 73.324165 78.126572 82.566277 87.245377 91.981178 98.881477 103.67128 107.05708 111.54089 115.45769 119.71738 124.39828 129.18808 133.62778 138.30058 140.23738 144.96419 149.58389 152.18669 156.92249 162.05429 166.52908">IF ShadowStackEnabled(CPL)</tspan><tspan y="-127.99493" x="77.519058 82.25486 84.191658 88.864456 93.60656 98.396362 103.52816 105.74757 107.51337 112.64516 114.92487 119.71468 124.50448">oldSSP := SSP</tspan><tspan y="-115.99522" x="77.519058 82.317856 87.059952 92.200752 94.420151 96.161652 101.26286 103.48225 105.59905 111.17905 116.46385 121.74865 126.24955 131.39035 135.82915 137.75064 142.31184 147.11064 151.85274 156.99353 158.85384 161.07323 163.65263 167.67473 169.89412 176.86192 181.60402 186.33981 189.58162 194.26251 196.4819 198.4547 200.67409 202.59558 206.61768 208.83707 212.19678 216.99918 221.68007 223.89946 228.64426 233.74545 238.22925 240.44864 244.49144">SSP := IA32_PLi_SSP; (* where i is the CPL *)</tspan><tspan y="-103.99552" x="77.519058 79.612457 84.333855 86.553253 91.328651 96.10405 101.22145 103.44085 109.38625 111.60564 116.86704 121.65144 126.91284 132.17424 134.39365 136.13605 141.25345 143.47285 148.73425 150.95366 153.54205 157.56145 159.78085 161.73026 165.06566 167.28506 172.06047 176.83588 181.95328 184.17268 188.94809 193.61905 197.03905 199.25845 203.72516 205.64485 207.59155 212.24725 217.01996 221.72966 226.38536 228.60477 231.97346 236.69217 238.91158 244.17027 246.38968 251.04538 255.71909 259.0878 263.79749 267.80518 270.02457 273.39328 278.16599 282.87567 287.64838 289.86777 295.63046 300.89816 306.01288 308.23227 312.24896">IF SSP &amp; 0x07 != 0 (* if SSP not aligned to 8 bytes then #GP *)</tspan><tspan y="-91.995819" x="95.519051 100.69945 106.54585 111.26724 117.11364 119.33304 125.09844 130.36884 135.48624 138.07463 143.33603 145.92442 147.79282 150.01222 154.73363 156.82703">THEN #GP(0); FI;</tspan><tspan y="-79.996117" x="77.519051 80.157852 84.179955 86.399353 91.575256 96.29216 100.61126 105.29216 110.06306 112.28246 116.74735 121.51825 126.17215 128.39156 133.10846 137.87936 139.62627 144.08217 146.17107 151.28397 153.03087 157.74777 159.66568 164.31958 169.09048 173.86139 178.97429 181.1937 185.8476 190.6185 194.6244 199.39531 204.10321 208.75711 210.97652 215.69342 220.49936 222.71875 226.74355 231.48564 235.96944 240.58914 245.32494 252.22523 254.44463 258.46942 261.85522 266.33902 270.25583 274.51553 276.73492 283.69373 288.43582 292.46063 295.84644 298.06583 302.73862 307.41953 309.63892 313.55573 318.29153 323.08133 326.46713 330.90683 332.88864 337.63074 342.37103 346.99072 349.21011 351.17392 355.91602 358.13541 362.6192 364.83859 369.58069 374.07977 377.46558 382.25537 385.49716 389.93686 391.87366 393.81046 398.43015 400.64954 405.13333 407.07013 408.99164 413.67072 418.46051 423.14142 427.81421 430.0336 435.2536 440.53387 443.37967 448.05246 452.74326 456.12906 460.80997 463.02936 466.30716 470.98807 475.66086 477.58237 482.31818 487.06027 491.09409">(* Token and CS:LIP:oldSSP pushed on shadow stack must be contained in a naturally aligned 32-byte region*)</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="494.25476pt" height="644.69037pt" viewBox="0 0 494.25476 644.69037" sodipodi:docname="254.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.05485" inkscape:cy="423.83" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg144" /><g transform="translate(-45.708862,-69.182129)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="76.68 78.767097 83.482201 85.701599 88.283699 93.052795 97.821899 102.933 105.1524 111.0915 113.3109 118.431 123.6861 128.4642 133.7193 138.4344 141.07321 143.29262 145.02872 150.13982 152.35922 154.94133 157.52344 162.29254 167.06165 172.22314">IF (SSP &amp; ~0x1F) != ((SSP </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-715.97998" x="174.42">–</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="179.22 181.43939 186.70799 191.92799 194.52359 196.74298 202.69559 204.91498 210.04858 215.31718 220.05478 225.33508 230.01599"> 24) &amp; ~0x1F)</tspan><tspan y="-703.98029" x="94.680298 100.4322 105.68909 110.85059 113.42999 118.67789 121.25279 123.17249 125.39188 130.09978 132.17967">#GP(0); FI;</tspan><tspan y="-691.98059" x="76.680298 78.781799 83.511299 85.730698 88.327194 90.846291 92.947792 98.559296 103.7793 109.0596 113.6181 118.299 123.0285 127.758 133.1895 134.90399 139.3725 145.9128 151.4928 153.71219 158.18968 162.93178 167.59828 169.81767 174.54718 179.28928 181.00377 185.47227 188.06877 190.28816 195.41367 197.63306 202.90256 205.12195 210.73344 216.58795 222.12746 224.34685 229.08894 233.89134 239.01685 241.78435 247.05385 252.27385 254.03336 259.25336 264.52286 267.29034 269.50977 271.26025 276.38574 278.60516 283.87466">IF ((IA32_EFER.LMA and CS.L) = 0 AND SSP[63:32] != 0)</tspan><tspan y="-679.9809" x="94.680298 99.860695 105.70709 110.42849 116.27489 118.49429 124.25969 129.53009 134.64749 137.23589 142.49728 145.08568 146.95407 149.17348 153.89488 155.98828">THEN #GP(0); FI;</tspan><tspan y="-667.9812" x="76.680298 81.420601 86.218506 90.856209 95.596512 99.47821 102.82891 107.52061 112.19971 116.76092 120.12062 124.86182 129.12152 133.81322 138.61562 143.1768 147.79561 152.29471 154.21622 158.97092 163.71121 165.93062 171.02731 173.24672 178.00142 182.80382 187.90051 238.71992 241.28763 245.28633 247.50574 252.14343 256.94583 260.96793 265.64792 267.86731 272.505 274.48682 277.83752 280.05692 282.86761 285.08701 289.76611 291.68762 295.03833 297.25772 301.93683 306.61774 310.63983 312.62164 315.97235 317.90106 322.64227 327.44467 329.66406 334.90475 337.12415 339.93484 342.15424 349.11484 353.91724 357.90692 361.32693 363.54633 368.18402 372.92435 375.14374 379.02545 380.92715 385.61887 390.11798 393.36069 395.58008 399.57877">expected_token_value = SSP (* busy bit - bit position 0 - must be clear *)</tspan><tspan y="-655.98151" x="76.680298 81.4674 86.191498 93.091797 97.653 101.0361 105.7692 110.0289 114.7692 119.5113 124.0725 128.69131 133.19041 135.12451 139.86661 144.59071 146.8101 151.93921 154.1586 158.94569 163.68779 168.81689 171.03629 172.99739 175.21678 180.49799 186.19949 190.98659 196.0878 200.6499 205.93111 208.03621 213.1806 215.40001 217.61942 238.67853 241.26242 245.27731 247.49672 252.26762 256.97552 260.34244 262.56183 265.92874 270.69965 275.40753 277.62692 282.28082 287.05173 291.05762 295.72952 297.94891 302.60281 304.5477 307.91461 310.134 314.1489">new_token_value = SSP | BUSY_BIT   (* Set the busy bit *)</tspan><tspan y="-643.98181" x="76.680298 78.781799 83.511299 85.730698 89.749199 94.491302 98.968803 103.5885 108.318 115.2705 119.7714 123.7935 127.173 131.6505 135.561 139.8495 144.408 146.3385 151.06801 154.97852 159.26701 163.82552 167.73602 174.63632 179.30283 184.08 187.9662 192.7254 197.4045 202.68478 207.32698 209.89919 214.70158 219.44368 224.60518 226.40428 228.62369 233.42609 238.10698 245.06758 249.62877 252.98396 257.68915 262.00824 266.68915 271.49155 275.99246 280.67157 285.11127 287.01746 291.81985 296.51605 298.37454 300.59393 305.29013 310.05832 314.70053 319.44083 323.32703 326.68222 331.42252 336.04224 340.57645 343.93164 348.67285 352.93256 357.67285 362.41495 366.94916 371.57336 376.07245 377.99393 382.75311 387.49341 390.06561 392.285 394.0112 399.1124 401.33179 406.07208 410.80966 415.48877 420.22906 424.11526 427.47046 432.16666 436.84576 441.37997 444.73517 449.44037 453.75946 458.45566 463.25806 467.79227 472.41647 476.86966 478.77585 483.57825">IF shadow_stack_lock_cmpxchg8b(SSP, new_token_value, expected_token_value) != expected_token_value</tspan><tspan y="-631.98212" x="94.680298 99.860695 105.70709 110.42849 116.27489 118.49429 124.25969 129.53009 134.64749 137.23589 142.49728 145.08568 146.95407 149.17348 153.89488 155.98828">THEN #GP(0); FI;</tspan><tspan y="-619.98242" x="76.680298 78.779999 83.507698 85.727097 90.454796 92.383499 97.003204 101.8056 106.5873 108.3 113.8377 118.9614 123.4281 125.6475 127.3962 132.5199 134.67899">IF oldSS.DPL != 3</tspan><tspan y="-607.98273" x="94.680298 97.267799 101.2863 103.5057 108.6852 113.45969 118.1712 122.18069 126.8922 129.1116 133.12111 136.49161 140.96011 144.86162 149.14111 151.36052 156.01802 160.79253 164.80203 169.57654 174.28804 178.29755 180.51695 184.52646 189.30096 194.02147 198.79597 200.71747 205.37497 207.59438 212.36888 217.08939 220.45988 222.67929 226.5808 231.0493 235.82381 239.83331 244.54482 246.76422 250.06363 254.5806 259.35059 261.26758 264.63358 268.63858 270.49707 272.71646 278.38647 284.95648 287.17587 291.88287 296.66187 298.60587 301.97186 305.97687 307.83536 310.05475 314.77075 318.07285 320.29224 324.94525 329.40924 332.77524 337.23923 339.45862 344.11163 347.36963 352.07663 356.54062 360.85971 365.47943 370.19543 372.13943 376.90942 380.27542 384.28043 386.49982 390.51382">(* These stack pushes should not cause faults, VM exits, or data breakpoints *)</tspan><tspan y="-595.98303" x="94.680298 97.319099 101.3412 103.5606 108.3342 113.1078 117.00839 121.78199 124.00139 128.71199 133.35059 138.06119 142.83479 146.20439 150.213 152.4324 159.375 161.3226 163.24319 165.16379 167.38319 171.8508 176.5074 181.164 183.08459 187.7592 189.97861 193.34821 198.06781 200.28722 203.65681 208.38 213.10861 215.328 220.00891 224.50801 227.74982 229.67131 231.63692 236.31783 239.59743 241.81682 246.25652 250.17511 254.0937 258.8223 262.78412 266.80624 271.53485 275.56146 277.78085 281.16846 285.84937 288.06876 291.45636 296.19846 300.92706 303.14645 306.53406 311.21497 315.51157 320.19247 324.98407 326.78317 329.00256 335.96317 340.70526 342.67087 346.58948 351.33157 353.55096 355.51657 359.54318 361.76257 363.68408 368.48648 370.70587 374.09348 378.83557 383.56418 385.78357 389.81018 394.24988 401.21048 405.89139 408.11078 412.90237 417.34207 420.72968 425.52127 428.76306 433.26215 435.20074 437.13934 441.83194 444.05133 448.49103 450.41254 452.37814 456.99783 461.78943 466.51804 471.13773 473.35712 478.6347 483.85471 486.7023 491.32199 496.01459 499.40219 504.1308 506.35019 509.59198 514.33228 518.95203 520.93378 525.61469 530.41711 532.63654 536.67212">(* Such events will apply to the earlier accesses to the token, which is in the same naturally aligned 32-byte region *)</tspan><tspan y="-583.98334" x="94.680305 99.432304 104.2347 108.6807 113.3598 118.0578 125.01839 129.7704 133.19041 137.63641 141.51541 145.77242 150.93391 155.68591 159.67291 164.42491 169.70522 175.04672 177.62613 182.32413 184.30502 188.94002 193.68121 198.43321 200.99821 202.91792 205.13733 207.70233 211.69833 213.91774 219.01173 223.45773 228.13683 232.81592 237.49681 242.1759 244.39531 251.31631 253.29811 256.64612 261.44855 263.66797 268.90598 274.18628 276.4057 281.15771 283.1395 287.77451 292.57693 295.38495 300.12616 303.36615 308.04526 312.73425 316.03635 318.25577 322.89078 324.87256 328.22055 332.20755 334.42697 339.12497 342.4838 344.70322 349.98352 352.20294 356.19894">ShadowStackPush8B(oldCS); (* Padded with 48 high-order bits of 0 *)</tspan><tspan y="-571.98364" x="94.680305 99.467407 104.25451 108.69421 113.36431 118.04521 125.00131 129.74341 133.12651 137.56621 141.4803 145.7724 150.9015 155.6436 159.6657 164.40779 169.68089 175.008 177.60809 182.28899 184.22308 188.84279 193.57588 198.31798 203.64508 209.26018 214.04727 218.72816 223.91127 228.64436 230.57846 235.24857 240.68367 242.78877 247.91788 250.51797 252.39807 254.61746 257.21756 261.24866 263.46808 268.59717 273.03687 277.70697 282.32666 287.05075 291.72086 293.94028 300.84058 302.82236 306.20544 310.94754 313.16696 318.44006 323.71317 325.93259 330.67468 332.65646 337.27615 342.07855 344.92166 349.65475 352.92984 357.59995 362.28082 365.58292 367.80234 372.42203 374.40381 377.7869 381.80899 384.02841 388.70932 392.06812 394.28754 399.50754 401.72696 405.07407 409.80716 413.08224 415.30167 420.57477 425.79477 428.01419 432.6843 434.60577 437.98886 440.20828 444.68039 446.78549 451.91458 455.94568">ShadowStackPush8B(oldCSBASE+oldRIP); (* Padded with 32 high-order bits of 0 for 32 bit LIP*)</tspan><tspan y="-559.98395" x="94.680305 99.479103 104.2779 108.7176 113.3994 118.08029 125.0481 129.79019 133.185 137.62469 141.55049 145.8102 150.95099 155.69308 159.72688 164.46898 169.75378 175.09259 177.70439 182.38528 184.33109 188.95078 193.74957 198.49167 203.63246 206.24426">ShadowStackPush8B(oldSSP);</tspan><tspan y="-547.98425" x="76.680305 81.415207 83.52211">FI;</tspan><tspan y="-535.98456" x="58.620003 63.354904 65.461807">FI;</tspan><tspan y="-523.98486" x="58.620003 60.694504 65.435699 67.655098 72.396294 77.138397 81.817497 86.437202 89.739304 94.179001 98.9814 102.8811 107.6376 112.37879 117.13529 121.63439 126.31349 128.235 132.9285 137.60759 139.827 142.3965 147.099 152.2605 156.6993">IF EndbranchEnabled (CPL)</tspan><tspan y="-511.98517" x="76.680305 78.773705 84.377106 89.597107 94.877403 99.427803 104.2032 108.7536 113.475 118.1559 123.3741 125.0805 130.26089 135.6843 141.28769 146.00909 151.26149 155.98289 161.4063 163.6203 168.7251 170.9445 178.2363 183.8271 185.9079 191.1261 195.66389 200.3727 206.08949 211.54889 216.08669 220.79549 226.67609 232.19398 237.49678 242.95618 248.54698 254.38078 259.08957">IA32_S_CET.TRACKER = WAIT_FOR_ENDBRANCH</tspan><tspan y="-499.98547" x="76.680298 78.774597 84.378899 89.5989 94.879196 99.430496 104.20679 108.75809 113.48039 118.16129 123.37949 125.08679 129.8631 135.5043 140.6658 145.7841 151.2084 155.93071 160.70702 165.48332 167.70273 172.82103 175.04044">IA32_S_CET.SUPPRESS = 0</tspan><tspan y="-487.98578" x="58.619995 63.354897 65.4618">FI;</tspan><tspan y="-475.98608" x="45.119995 49.814396 55.694996 61.199394">END;</tspan><tspan y="-451.98578" x="45.119995 49.872894 55.512295 62.065193 66.806389 69.615288 74.71019 80.169594 82.270195 87.923096 89.993996 94.431892 99.173088 104.42099 109.11989">SAME-PRIVILEGE:</tspan><tspan y="-439.98608" x="58.619995 60.698093 65.439293 67.658691 72.399895 76.8396 78.746696 80.653793 85.90889 90.362991 93.782997 98.480095 103.28249 105.21659 109.41779 114.11489 116.33429 121.43639 123.65578 128.93608">IF CallGateSize = 32</tspan><tspan y="-427.98639" x="76.680298 81.889496 87.710693 92.460892">THEN</tspan><tspan y="-415.98669" x="94.680298 96.797997 101.54369 103.76309 107.79779 111.15749 115.59718 119.49688 123.80158 126.02098 130.64067 135.38187 140.11856 144.08035 146.29974 151.09944 155.78033 159.17604 161.39543 166.13753 170.63663 175.25543 179.93633 182.15572 185.44342 190.12431 194.87001 201.83871 204.05811 207.3575 212.09869 215.3405 217.55989 222.8456 225.06499 229.74768 234.36739 237.76309 242.44398">IF stack does not have room for 8 bytes</tspan><tspan y="-403.987" x="112.6803 117.8643 123.71429 128.4393 134.28931 136.50871 142.27771 147.05672 151.79883 154.37822 159.64322 162.23521 164.10721 166.32661 171.05162 173.14862">THEN #SS(0); FI;</tspan><tspan y="-391.9873" x="94.680298 96.772797 101.49329 103.71269 108.43319 112.90169 114.82319 116.74469 122.01419 126.48269 129.8532 134.5647 137.15219 139.24469 144.0192 148.0287 151.3992 154.6617 159.4362 163.33771 166.70821 168.65671 173.4006 178.1499 183.3114 188.0067 189.98849 194.73779 198.15781 202.8441 206.08141 208.72021 210.93961 215.6889 220.4301 223.77541 225.9948 232.9554 234.87689 238.2222 243.0246 244.94789 249.75029 251.9409 255.83971 260.5575 265.21228 269.92108 272.14047 276.14728 280.85608 285.51086 292.45166 297.16046 301.93225 305.30005 307.51944 309.43823 311.38403 318.32483 320.27063 323.63843">IF CallGate(InstructionPointer) not within code segment limit </tspan><tspan y="-379.98761" x="112.6812 117.8616 123.70799 128.4294 134.2758 136.49521 142.2606 147.53101 152.64841 155.2368 160.4982 163.08659 164.95499 167.17439 171.8958 173.9892">THEN #GP(0); FI;</tspan><tspan y="-367.98792" x="94.681198 99.412498 104.1978 105.9591 110.6904 112.7316 117.8931 120.1125 121.8738 126.975 129.1944 133.92569 138.36539 140.29768 142.22998 147.51028 151.98958 155.37088 160.05179 162.63118 167.36249 172.14778 173.90909 178.58998 180.69328 185.82059 188.41888 190.63828 193.23657 197.26587 199.48526 204.22736 208.96767 213.58737 220.54797 225.27028 230.01237 233.39368 235.61307 240.28137 244.96228 248.98257 252.89487 256.16815 258.08963 262.75793 266.13922 270.8201 274.12219 276.34161 278.26309 283.06549 286.3649 291.10608 294.34787 301.30847 305.78778 309.16907 311.09055 315.83173 320.57382 322.79324 327.27255 329.20486 333.22516 337.90604 340.12546 342.05777 346.78906 351.26837 355.88806 360.61035 365.23004 367.44946 371.47876">CS:EIP := CallGate(CS:EIP) (* Segment descriptor information also loaded *)</tspan><tspan y="-355.98822" x="94.681198 99.797699 104.5722 108.5817 113.35619 115.9437 120.66419 122.58569 127.24319 131.9637 136.7382 138.48871 143.20921 145.13071 149.78821 154.50871 156.60121 161.71771 164.30521 166.1727 168.39211 170.9796 174.99809 177.2175 182.64 187.3515 190.722 195.49651 198.759 203.53351 205.7412 210.22859 214.8483 219.5247 222.76651 227.49692 231.52531 235.48711 237.7065 241.0959 245.77679 247.99619 251.91658 256.40399 258.34439 260.28479 262.2063 266.99969 271.67609 273.89548 278.51517 281.75696 286.49637 290.41678 295.14719 299.76688 304.56027 307.80206 312.53247 314.75186 318.78928">Push(oldCS:oldEIP); (* Return address to calling procedure *)</tspan><tspan y="-343.98853" x="76.681198 81.414299 85.886398 90.6735 95.406601">ELSE </tspan><tspan y="-331.98883" x="94.681198 96.772797 100.1064 102.3258 107.04539 111.51299 113.43359 115.35419 120.6228 125.09039 128.51039 133.22099 137.9946 139.9422 144.10381 148.81441">If CallGateSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cC7C7E1F8"><tspan y="-331.98001" x="150.96001">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-331.98001" x="156.78 158.99939 164.27339"> 16</tspan><tspan y="-319.98032" x="112.67999 117.88919 123.71039 128.46059">THEN</tspan><tspan y="-307.98062" x="130.67999 132.72119 137.46239 139.68178 143.71468 147.07439 151.51408 155.41377 159.71667 161.93607 166.55576 171.29695 176.03185 179.99364 182.21303 187.01093 191.75482 195.11453 197.33392 202.07602 206.57512 211.19392 215.87482 218.09421 221.38011 226.061 230.8049 237.7718 239.9912 243.29059 248.03178 251.27359 253.49298 258.77689 260.99631 265.67722 270.29694 273.69083 278.37173">IF stack does not have room for 4 bytes</tspan><tspan y="-295.98093" x="148.67999 153.8595 159.705 164.42551 170.27101 172.49042 178.25491 183.02942 187.77153 190.35092 195.61142 198.19891 200.06641 202.28581 207.00632 209.09882">THEN #SS(0); FI;</tspan><tspan y="-283.98123" x="130.67999 132.75449 137.49568 139.71509 144.45628 148.89598 150.79948 152.70299 157.95448 162.40498 165.82498 170.51848 173.08798 175.16248 179.96487 183.95638 187.30887 190.55338 195.35577 199.23927 202.59177 204.52226 209.26346 214.06586 219.16705 223.86955 225.85135 230.60785 234.02785 238.72134 241.96585 244.60466 246.8403 251.60941 256.32449 259.68961 261.909 268.84711 270.79022 274.15533 278.92444 280.86755 285.63666 287.85605 291.75214 296.46722 301.11932 305.88031 308.0997 312.10379 316.80988 321.46198 328.40009 333.1062 337.87531 341.24042 343.45981 345.37592 347.31903 354.25714 356.20026 359.56537">IF CallGate(InstructionPointer) not within code segment limit </tspan><tspan y="-271.98154" x="148.68001 153.85681 159.69962 164.41742 170.26022 172.47963 178.24142 183.50822 188.62202 191.20682 196.46461 199.04941 200.91422 203.13362 207.85143 209.94122">THEN #GP(0); FI;</tspan><tspan y="-259.98184" x="130.68001 135.39781 140.16962 141.91742 144.00722 149.12102 151.34042 153.08823 158.20203 160.42143 165.13924 169.60504 171.52383 173.44263 178.70943 183.17523 186.54303 191.25183 193.83662 198.55443 203.32623 205.07404 207.0603 211.83031 215.83531 219.20131 222.5034 227.27341 231.17041 234.53641 236.48041 241.19641 245.96642 248.18582 252.83882 257.55481 259.49881 264.2688 267.6348 272.3418 275.59979 278.1828 280.10251">CS:IP := CallGate(CS:instruction pointer); </tspan><tspan y="-247.98215" x="130.67999 133.2459 137.2428 139.4622 144.2151 148.9554 153.59129 160.5519 165.24179 170.04419 173.3931 175.6125 180.2916 184.97249 188.99458 192.89429 196.13519 198.11699 202.75288 206.1729 210.8718 214.1739 216.39331 218.32021 223.1226 226.4355 231.1767 234.4176 241.3782 245.8251 249.24512 251.17201 255.91321 260.66611 262.8855 267.38458 269.30609 273.32822 278.00912 280.22852 282.12842 286.86963 291.31653 295.99564 300.68555 305.36465 307.58405 311.58093">(* Segment descriptor information also loaded *)</tspan><tspan y="-235.98245" x="130.67999 135.79649 140.571 144.58051 149.35501 151.9425 156.66301 158.5845 163.242 167.96251 172.73701 174.48752 179.20802 181.12952 185.78702 187.87952 192.99602 195.58351 197.451 199.67041 202.2579 206.2764 208.4958 213.9183 218.62981 222.00031 226.77481 230.03731 234.81181 236.99969 241.4511 246.13019 250.77058 254.07269 258.76709 262.75949 266.75189 268.97128 272.32468 277.06589 279.28528 283.16968 287.62106 289.52545 291.42984 293.41165 298.16907 302.84818 305.06757 309.70798 313.01007 317.75128 321.65009 326.34448 331.02359 335.78101 339.0831 343.7775 345.99689 349.99829">Push(oldCS:oldIP); (* Return address to calling procedure *)</tspan><tspan y="-223.98276" x="112.67999 117.41399 121.85279 126.64079 131.37479 133.59418 136.19518 140.22717 142.44656 147.12746 151.62656 153.56155 155.49655 160.77956 165.21925 168.57895 173.30396 178.04605 180.00806 184.14896 188.87396 191.09335 196.22336 198.44275 203.71675 208.93675">ELSE (* CallGateSize = 64)</tspan><tspan y="-211.98306" x="130.67999 132.72119 137.46239 139.68088 144.35098 149.09308 153.11517 157.90227 159.82378 164.62617 169.24588 171.46437 176.73747 181.95747 184.17596 188.84607 193.53416 196.91727 201.64137 205.60316 207.82166 212.55475 217.34184 219.56033 222.94344 227.68553 232.40964 234.62813 238.65022 242.03333 246.47302 250.38 254.69911 256.91852 260.27551 264.98251 269.78491 273.6846 278.44559 283.18588 287.18188 289.40128 294.16226 298.90347 303.66446 306.54535 310.43335 314.88834 319.69073 324.37164 329.17404 331.09555 334.98355 339.48264 341.39062 343.61002 348.065 352.74411 357.42322 360.66501 365.36301 369.35901 373.35501 378.09531">IF pushing 16 bytes on the stack touches non-canonical addresses</tspan><tspan y="-199.98337" x="148.67999 153.8595 159.705 164.42551 170.27101 172.49042 178.25491 183.02942 187.77153 190.35092 195.61142 198.19891 200.06641 202.28581 207.00632 209.09882">THEN #SS(0); FI;</tspan><tspan y="-187.98367" x="130.67999 132.75539 137.49658 139.71599 145.12138 147.19678 152.35828 154.57768 159.33508 164.07628 168.83368 171.64708 175.53148 180.03058 184.78798 189.52917 194.33157 196.25307 200.13747 204.63657 206.54097">IF RIP non-canonical </tspan><tspan y="-175.98398" x="148.67999 153.8568 159.6996 164.4174 170.26021 172.47961 178.24141 183.50821 188.62201 191.2068 196.4646 199.04939 200.9142 203.13361 207.85141 209.94121">THEN #GP(0); FI;</tspan><tspan y="-163.98428" x="130.67999 135.3978 140.1696 141.9174 144.0072 149.121 151.34041 153.08821 158.20201 160.42142 165.13922 169.60503 171.52382 173.44261 178.70941 183.17522 186.54301 191.25182 193.83661 198.55441 203.32622 205.07402 207.0603 211.83031 215.83531 219.20131 222.5034 227.27341 231.17041 234.53641 236.48041 241.19641 245.96642 248.18582 252.83882 257.55481 259.49881 264.2688 267.6348 272.3418 275.59979 278.1828 280.10251">CS:IP := CallGate(CS:instruction pointer); </tspan><tspan y="-151.98459" x="130.67999 133.2459 137.2428 139.4622 144.2151 148.9554 153.59129 160.5519 165.24179 170.04419 173.3931 175.6125 180.2916 184.97249 188.99458 192.89429 196.13519 198.11699 202.75288 206.1729 210.8718 214.1739 216.39331 218.32021 223.1226 226.4355 231.1767 234.4176 241.3782 245.8251 249.24512 251.17201 255.91321 260.66611 262.8855 267.38458 269.30609 273.32822 278.00912 280.22852 282.12842 286.86963 291.31653 295.99564 300.68555 305.36465 307.58405 311.58093">(* Segment descriptor information also loaded *)</tspan><tspan y="-139.98489" x="130.67999 135.79649 140.571 144.58051 149.35501 151.9425 156.66301 158.5845 163.242 167.96251 172.73701 174.48752 179.20802 181.12952 185.78702 187.87952 192.99602 195.58351 197.451 199.67041 202.2579 206.2764 208.4958 213.9183 218.62981 222.00031 226.77481 230.03731 234.81181 236.99969 241.4511 246.13019 250.77058 254.07269 258.76709 262.75949 266.75189 268.97128 272.32468 277.06589 279.28528 283.16968 287.62106 289.52545 291.42984 293.41165 298.16907 302.84818 305.06757 309.70798 313.01007 317.75128 321.65009 326.34448 331.02359 335.78101 339.0831 343.7775 345.99689 349.99829">Push(oldCS:oldIP); (* Return address to calling procedure *)</tspan><tspan y="-127.98519" x="94.679993 99.414894 101.5218">FI;</tspan><tspan y="-115.98549" x="58.619694 63.354595 65.461494">FI;</tspan><tspan y="-103.98579" x="58.619694 63.336594 68.107491 70.691391 76.110291 81.22319 85.72229 88.30619 90.525589 92.272491 97.385391 99.60479 104.32169 109.43459">CS(RPL) := CPL</tspan><tspan y="-91.986084" x="58.619694 60.729294 65.466896 67.686302 72.477905 77.220009 81.705612 86.32531 91.062912 97.963211 102.75481 106.14242 110.62802 114.54662 118.80632 123.54752 128.28963 132.78873 137.40843 139.32993 144.05853 148.67824 151.28284 156.02043 161.15404 165.63063">IF ShadowStackEnabled(CPL)</tspan><tspan y="-79.986382" x="76.679993 79.284592 83.32019 85.539597 91.119598 93.0411 94.962601 99.641701 104.4333 106.65271 110.04031 114.72121 116.94062 121.73222 126.41312 131.21373 134.60133 136.82072 142.09833 144.31772 148.99232 153.61201 156.99962 161.68053 163.89992 168.57452 173.25542 178.04701 182.78911 187.46371 191.90341 195.18301 199.87561 202.095 206.1306">(* Align to next 8 byte boundary *)</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="400.42014pt" height="608.27466pt" viewBox="0 0 400.42014 608.27466" sodipodi:docname="255.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.64" inkscape:cy="375.51011" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg136" /><g transform="translate(-46.019997,-69.35791)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="77.519997 80.940002 85.620903 92.555405 97.203903 101.96941 106.73491 111.89641 114.11581 119.22331 121.44272 126.20822 130.97372 136.08122">tempSSP = SSP;</tspan><tspan y="-703.98029" x="77.519997 82.302597 87.085197 91.561798 96.227402 100.9083 107.8689 112.42651 116.38831 119.76691 124.24351 128.15311 132.4407 136.99831 141.0159 144.3945 149.12311 152.39371 157.11331 159.3327 164.5527 166.77209 171.4377 176.0997 179.472 184.1853 188.19661 190.41602 195.13832 198.47462 200.69403 205.95633 208.17574 211.54803 216.27034 218.48975 221.07904 225.85535 230.63165 235.74995 237.96936 241.92667 244.14607 249.40837">Shadow_stack_store 4 bytes of 0 to (SSP – 4)</tspan><tspan y="-691.98059" x="77.519997 82.309799 87.051903 92.183701 94.403107 99.534904 101.75431 106.54411 111.28622 116.41801 118.63742 124.59722 126.81663 132.09242 136.89122 141.57211 146.30791 151.0437 155.72459 160.46039 165.14128 169.87708 174.61287 179.29376 184.02956 188.76535 193.44624 198.18204 202.91783 207.59872 212.87453 218.73532">SSP = SSP &amp; 0xFFFFFFFFFFFFFFF8H;</tspan><tspan y="-679.9809" x="77.519997 80.115601 84.142204 86.361603 90.981308 95.783707 99.745506 104.5479 106.7673 110.6769 114.6945 116.4531 118.38271 120.33931 124.95901 126.71761 130.73521 134.75281 139.41841 141.6378 146.31871 151.12112 153.34052 157.35811 162.14072 166.61731 171.23701 175.96562 182.86592 185.08531 189.10291 192.48151 196.9581 200.86771 205.1553 207.37469 211.40129">(* push cs:lip:ssp on shadow stack *)</tspan><tspan y="-667.9812" x="77.519997 82.322395 87.064491 91.563591 96.242691 100.94249 107.90309 112.65689 116.07689 120.52469 124.40549 128.66429 133.82579 138.57959 142.56839 147.32219 152.60249 157.944 160.52341 165.22321 167.12401 171.8031 176.5443 181.2981 183.8649 185.78461 188.00401 190.57082 194.56862 196.78802 201.88382 206.33162 211.01071 215.6304 220.3707 225.04979 227.2692 234.192 236.1738 239.52361 244.2774 246.49681 251.77711 257.0574 259.27682 264.03064 266.01242 270.64923 275.45166 278.26147 283.00269 286.24448 290.92358 295.61438 298.91647 301.13589 305.77271 307.75449 311.10428 315.09308 317.3125 322.0123 325.37112 327.59055 332.83035 335.04977 339.04758">ShadowStackPush8B(oldCS); (* Padded with 48 high-order bits of 0 *)</tspan><tspan y="-655.98151" x="77.519997 82.322395 87.064499 91.563599 96.242699 100.9443 107.9049 112.6605 116.0805 120.5301 124.4127 128.67329 133.83479 138.59039 142.58099 147.33659 152.61688 157.95837 160.53778 165.23938 167.14198 171.82108 176.56227 181.31787 186.65936 192.24297 197.04536 201.74696 203.96637 209.11797 211.33737 216.07857 218.00008 222.67917 228.07916 230.15276 235.25035 237.81895 239.66756 241.88696 244.52577 248.54788 250.76729 255.86488 260.31448 264.99359 269.61331 274.35361 278.97333 281.19272 288.15332 290.1351 293.48669 298.24231 300.4617 305.742 311.02231 313.2417 317.99731 319.9791 324.61771 329.4201 332.23172 336.97293 340.21652 344.89563 349.58823 352.83182 355.05121 359.73032 361.7121 365.06369 369.05429 371.27368 375.97528 379.33411 381.5535 386.7951 389.0145 392.37332 397.11453 400.35812 402.57751 407.85782 413.07782 415.29721 419.97632 421.89783 425.31781 427.5372 431.97781 434.05142 439.14902 443.14862">ShadowStackPush8B(oldCSBASE + oldRIP); (* Padded with 32 high-order bits of 0 for 32 bit LIP*)</tspan><tspan y="-643.98181" x="77.519997 82.322395 87.064491 91.563591 96.242691 100.93979 107.90038 112.65148 116.07148 120.51658 124.39468 128.65077 133.81227 138.56337 142.54947 147.30057 152.58087 157.92238 160.50179 163.84889 168.53699 175.49759 180.17668 184.92778 189.73018 194.82327 197.38737">ShadowStackPush8B(tempSSP);</tspan><tspan y="-631.98212" x="59.519997 64.254898 66.361801">FI;</tspan><tspan y="-619.98242" x="59.519997 61.590897 66.332092 68.551491 73.292686 78.034782 82.713882 87.333588 90.635689 95.075386 99.877785 103.77748 108.53038 113.27158 118.02448 122.52357 127.15948 129.14037 133.83026 138.50935 140.72876 143.29466 147.99356 153.15506 157.59386">IF EndbranchEnabled (CPL)</tspan><tspan y="-607.98273" x="77.519997 79.607994 84.323997 86.543396 91.259399 96.371399 100.8264 103.0458 108.1578 110.3772">IF CPL = 3</tspan><tspan y="-595.98303" x="95.519997 100.72919 106.55039 111.30059">THEN</tspan><tspan y="-583.98334" x="113.52 115.6143 121.2186 126.4386 131.7189 136.2702 141.91141 146.46271 151.18501 155.86592 161.08412 162.79143 167.97273 173.39703 179.00133 183.72363 188.97693 193.69923 199.12354 201.34294 206.46124 208.6797 215.9859 221.59109 223.68629 228.8685 233.3694 238.11061 243.80852 249.26791 253.82011 258.50101 264.34921 269.88242 275.1636 280.62302 286.22821 292.07642 296.79962 302.64783">IA32_U_CET.TRACKER = WAIT_FOR_ENDBRANCH;</tspan><tspan y="-571.98364" x="113.52 115.6179 121.2258 126.4458 131.7261 136.28101 141.92221 146.47711 151.20302 155.88393 161.10213 162.81303 167.59294 173.23415 178.39565 183.51755 188.94545 193.67136 198.45126 203.23117 205.45058 210.57248 212.79189">IA32_U_CET.SUPPRESS = 0</tspan><tspan y="-559.98395" x="95.519997 100.2549 104.7288 109.5177">ELSE</tspan><tspan y="-547.98425" x="113.52 115.6116 121.2132 126.4332 131.7135 136.2621 141.03571 145.5843 150.30391 154.98482 160.20302 161.90762 167.08623 172.50783 178.10944 182.82904 188.07964 192.79924 198.22084 200.44025 205.55585 207.77969 215.08679 220.69289 222.78899 227.97209 232.52519 237.2493 242.9472 248.4066 252.9075 257.64868 263.49777 269.03186 274.31308 279.71307 285.31918 291.16827 295.89236 301.74146">IA32_S_CET.TRACKER = WAIT_FOR_ENDBRANCH;</tspan><tspan y="-535.98456" x="113.52 115.6143 121.2186 126.4386 131.7189 136.2702 141.04651 145.59781 150.32011 155.00102 160.21922 161.92653 166.70284 172.34404 177.50554 182.62384 188.04814 192.77045 197.54675 202.32306 204.54247 209.66077 211.88017">IA32_S_CET.SUPPRESS = 0</tspan><tspan y="-523.98486" x="77.519997 82.254898 84.361801">FI;</tspan><tspan y="-511.98517" x="59.519997 64.254898 66.361801">FI;</tspan><tspan y="-499.98547" x="46.019997 50.714397 56.594997 62.099396">END;</tspan><tspan y="-475.98517" x="46.019997 51.198597 56.800198 61.6026 66.822601 69.703499 74.9244 80.563805 85.722603 90.4422">TASK-GATE:</tspan><tspan y="-463.98547" x="59.519997 61.603497 66.314995 68.534401 71.895905 76.355408 80.355911 84.675011 86.894417 91.542915 96.002419 99.363922 104.06642 106.28583 111.86403 116.96523 121.41573">IF task gate DPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-463.98547" x="123.66029">&lt;</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-463.98547" x="128.5806 130.8 135.51601 140.62801 145.08301 147.30241 152.01842 155.27641 157.49582 162.91382 168.02582 172.48082"> CPL or RPL </tspan><tspan y="-451.98578" x="77.520897 82.739098 88.560295 93.278992 99.122696 101.34209 107.1048 112.3725 117.4872 120.0729 123.4416 127.90829 131.916 136.1937 138.4131 143.0688 147.53551 150.90421 155.61391 157.83331 161.84102 166.55072 168.47041 173.18011 177.07982 180.44852 185.16722 188.46931 191.05501 192.92072 195.14012 199.85883 201.94952">THEN #GP(task gate selector); FI;</tspan><tspan y="-439.98608" x="59.520897 61.606197 66.319496 68.538895 71.902191 76.363495 80.365799 84.684898 86.904297 91.554596 96.0159 99.379196 104.0835 106.3029 111.07021 115.78351 119.1468 121.36621 126.01651 129.3186 134.0229 138.02521 142.72951 147.49681 150.86011">IF task gate not present </tspan><tspan y="-427.98639" x="77.520897 82.739098 88.560303 93.275406 99.115509 101.33491 107.09401 112.93411 118.09561 120.67501 124.04011 128.5032 132.50731 136.8264 139.04581 143.69791 148.16101 151.52611 156.23221 158.45161 162.45572 167.16182 169.07793 173.78403 177.68013 181.04523 185.76033 189.01743 191.59953 193.51924 195.73865 200.45375 202.54085">THEN #NP(task gate selector); FI;</tspan><tspan y="-415.98669" x="59.520897 64.967697 69.648598 74.141396 78.761093 80.980492 84.340187 89.142586 93.823486 96.042885 101.24669 105.98878 110.78758 113.00698 117.04078 121.72168 126.40348 133.30377 138.03957 142.78166 146.17647 148.39586 152.35765 157.09795 159.04375 163.72464 167.65044 171.04524 175.72614 179.02824 181.2612 183.207 187.97881 190.19821 193.56601 198.33781 203.04662 205.26602 208.63382 213.09962 217.10643 221.42552 224.25333 228.90813 233.37393 236.74173 241.45053 243.66994 248.32474 253.03354 257.04034 260.93915 264.24124 266.16275 270.81754 274.18533 278.90314 282.16293">Read the TSS segment selector in the task-gate descriptor;</tspan><tspan y="-403.987" x="59.520897 61.613396 66.333893 68.553291 73.732788 78.507286 83.281784 85.501183 89.510681 94.222183 98.841881 105.80247 110.51398 115.28848 118.65897 120.87837 124.88787 129.59937 131.52086 136.23236 140.13387 143.5206 148.2375 151.4964 153.71581 155.6337 160.3506 164.2485 168.71341 170.63132 173.75522 178.40912 180.32703 185.04393 189.69783 194.16273 196.08063 198.30003 202.95393 204.96091 208.33051 210.54991 212.49751 216.50612 218.72552 222.73413 227.44473 230.81433 233.03374 236.40334 241.12294 243.34235 245.26294 249.98254 253.88315 258.35074">IF TSS segment selector local/global bit is set to local</tspan><tspan y="-391.9873" x="59.520905 64.264801 67.506599 69.725998 71.697899 76.439995 81.120895 85.855797 90.593399 92.812798 97.610695 102.2916 105.68549 107.90489 114.8052 116.787 120.1809 124.923 126.8949 131.69279 133.91219 139.13307 144.65097 149.85387 152.07326 154.01816 155.93965 162.90656 164.82805 168.22195">or index not within GDT limits</tspan><tspan y="-379.98761" x="77.520905 82.719307 88.540512 93.279915 99.10112 101.32052 107.10392 112.39232 117.49352 120.07291 125.27132 130.01341 134.80681 137.0262 140.98799 145.7283 147.6687 152.34961 156.27 159.65941 164.3403 167.64241 170.22182 172.08212 174.30151 179.04091 181.15231">THEN #GP(TSS selector); FI;</tspan><tspan y="-367.98792" x="59.520905 65.122505 69.023102 72.923698 77.6343 81.642899 85.651497 87.870895 93.0495 97.823097 102.59669 104.81609 109.47269 114.1833 118.19189 122.09249 125.35409 127.30169 131.95828 135.32788 140.00879 143.31088 145.53029 147.47789 152.2515 154.4709 159.7395 165.2691 170.44771">Access TSS descriptor in GDT;</tspan><tspan y="-355.98822" x="59.520905 61.608006 66.323105 68.542503 73.194603 77.900703 81.9048 85.800903 89.058006 91.039803 95.691902 99.056999 103.7721 107.0742 109.2936 111.2367 115.2408 117.4602 122.22929 126.9444 130.30949 132.5289 137.028 139.24741 144.42151 149.19061 153.99301 156.21242 160.21652 164.92262 169.57472 176.51282 181.21892 186.02132">IF descriptor is not a TSS segment</tspan><tspan y="-343.98853" x="46.020905 48.240307 50.459709 52.679111 54.898514 57.117916 59.337318 61.556721 63.776123 65.995522 68.21492 70.434319 72.653717 74.873116 77.092514 82.271118 88.115723 92.835327 98.679932 100.89933 106.66293 111.93153 117.04713 119.68594 124.86453 129.63814 134.41174 136.63115 140.63976 145.35036 147.27095 151.98155 155.88216 159.25175 163.97136 167.23296 169.81955 171.68616 173.90556 178.62517 180.71677">              THEN #GP(TSS selector); FI;</tspan><tspan y="-331.98883" x="59.520905 61.625103 66.3573 68.576698 73.767899 78.5541 83.296204 85.515602 90.184799 94.8657 98.886902 102.8001 106.0743 107.9958 112.665 116.0472 120.7794 124.0536 126.273 130.2942 134.91391 139.63712 143.55032 145.47183 148.8009 150.75031 155.46271 159.47311 161.69252 165.06392 169.83932 174.30873 177.68013 179.89954 183.27094 188.04634 192.75874 194.97815 200.19635 204.93846 209.71387 211.93327 213.88268 217.89308 220.11249 224.77089 229.5463 233.5567">IF TSS descriptor specifies that the TSS is busy</tspan><tspan y="-319.98914" x="46.020905 48.240307 50.459709 52.679111 54.898514 57.117916 59.337318 61.556721 63.776123 65.995522 68.21492 70.434319 72.653717 74.873116 77.092514 82.271118 88.115723 92.835327 98.679932 100.89933 106.66293 111.93153 117.04713 119.68594 124.86453 129.63814 134.41174 136.63115 140.63976 145.35036 147.27095 151.98155 155.88216 159.25175 163.97136 167.23296 169.81955 171.68616 173.90556 178.62517 180.71677">              THEN #GP(TSS selector); FI;</tspan><tspan y="-307.98944" x="59.520905 61.595406 66.336601 68.556 73.717499 78.519897 83.276398 85.495796 90.298195 94.979095 98.399094 100.61849 105.258 108.5601 113.2536 117.2451 121.9386 126.741 130.09349">IF TSS not present </tspan><tspan y="-295.98975" x="77.520905 82.709404 88.563904 93.293404 99.147903 101.3673 107.1408 112.9953 118.1208 120.7173 125.9058 130.6893 135.4314 137.65079 141.66928 146.35019 148.28069 152.96159 156.8721 160.2516 164.98111 168.25261 170.84911 172.7256 174.94499 179.6259 181.7265">THEN #NP(TSS selector); FI;</tspan><tspan y="-283.99005" x="59.520905 64.308907 71.625908 73.667114 78.885315 83.566216 89.446815 92.290817 97.449615 103.06561 107.80772 113.07272 117.81482 120.03422 122.63522 129.59221 131.51372 134.93372 139.67581 141.8952 146.6832 151.36411 155.3871 158.7711 160.73311 165.4752 170.14621 172.74721 174.9666 178.3506 183.08459 185.30399 190.46278 195.26518 200.00728">SWITCH-TASKS (with nesting) to TSS;</tspan><tspan y="-271.99036" x="59.520905 61.611603 66.330307 68.549706 73.268402 75.3591 80.520599 82.739998 87.512695 92.2314 95.600098 97.819496 104.7612 106.7079 110.0766 114.8493 116.796 121.5687 123.78091 127.67701 132.39211 137.0442 141.75031 143.96971 147.97382 152.67992 157.33202 164.27011 168.97621 173.74532 177.11041 179.32982 181.31073 183.23222 190.17032 192.11342 195.47852">IF EIP not within code segment limit </tspan><tspan y="-259.99066" x="77.520905 82.701302 88.547699 93.269096 99.115494 101.33489 107.1003 112.3707 117.4881 120.0765 125.3379 127.9263 129.79469 132.0141 136.7355 138.8289">THEN #GP(0); FI;</tspan><tspan y="-247.99097" x="46.020905 50.715305 56.595905 62.100304">END;</tspan><tspan y="-223.99066" x="46.020905 51.188705 56.779507 61.581905 66.80191 69.682816 74.424919 79.59272 85.232117 90.399918 95.108719 97.927521 102.69032 107.39912 112.65692 119.21972 123.92852 129.76231 134.98051">TASK-STATE-SEGMENT:</tspan><tspan y="-211.99097" x="59.520905 61.600803 66.308701 68.528099 73.695 78.497398 83.2593 85.478699 90.996597 96.158096 100.605">IF TSS DPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-211.99097" x="102.84061">&lt;</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-211.99097" x="107.76091 109.98031 114.69991 119.81551 124.27411 126.49351 131.2131 134.4747 136.69411 142.11571 147.23131"> CPL or RPL</tspan><tspan y="-199.99127" x="59.520908 64.262108 67.503906 69.723305 74.941505 79.683601 84.486 86.705399 91.341301 96.081604 100.10371 104.0034 107.2443 109.2261 113.86201 117.21091 121.9521 125.1939 127.4133 129.3951 134.13719 138.81628 140.79808 144.67798 149.12488 152.47379 157.21408 161.20198 163.42139 168.63959 173.38168 178.18408 180.40349 185.15639 189.89758 193.24649 195.4659 199.965 204.5838 209.0307 211.0125 212.9124 217.3593 222.03839 223.9599">or TSS descriptor indicates TSS not available</tspan><tspan y="-187.99158" x="77.520905 82.719307 88.540512 93.279915 99.10112 101.32052 107.10392 112.39232 117.49352 120.07291 125.27132 130.01341 134.80681 137.0262 140.98799 145.7283 147.6687 152.34961 156.27 159.65941 164.3403 167.64241 170.22182 172.08212 174.30151 179.04091 181.15231">THEN #GP(TSS selector); FI;</tspan><tspan y="-175.99188" x="59.520905 61.599903 66.341103 68.560501 73.726501 78.5289 83.289902 85.5093 87.491096 91.513199 93.732597 98.493599 103.2348 106.5918 108.8112 113.4903 116.7321 121.4301 125.4261 130.1664 134.90849 138.26549">IF TSS is not present </tspan><tspan y="-163.99219" x="77.520905 82.709404 88.563904 93.293404 99.147903 101.3673 107.1408 112.9953 118.1208 120.7173 125.9058 130.6893 135.4314 137.65079 141.66928 146.35019 148.28069 152.96159 156.8721 160.2516 164.98111 168.25261 170.84911 172.7256 174.94499 179.6259 181.7265">THEN #NP(TSS selector); FI;</tspan><tspan y="-151.99249" x="59.520905 64.308907 71.625908 73.667114 78.885315 83.566216 89.446815 92.290817 97.449615 103.06561 107.80772 113.07272 117.81482 120.03422 122.63522 129.59221 131.51372 134.93372 139.67581 141.8952 146.6832 151.36411 155.3871 158.7711 160.73311 165.4752 170.14621 172.74721 174.9666 178.3506 183.08459 185.30399 190.46278 195.26518 200.00728">SWITCH-TASKS (with nesting) to TSS;</tspan><tspan y="-139.9928" x="59.520905 61.611603 66.330307 68.549706 73.268402 75.3591 80.520599 82.739998 87.512695 92.2314 95.600098 97.819496 104.7612 106.7079 110.0766 114.8493 116.796 121.5687 123.78091 127.67701 132.39211 137.0442 141.75031 143.96971 147.97382 152.67992 157.33202 164.27011 168.97621 173.74532 177.11041 179.32982 181.31073 183.23222 190.17032 192.11342 195.47852">IF EIP not within code segment limit </tspan><tspan y="-127.9931" x="77.520905 82.701302 88.547699 93.269096 99.115494 101.33489 107.1003 112.3707 117.4881 120.0765 125.3379 127.9263 129.79469 132.0141 136.7355 138.8289">THEN #GP(0); FI;</tspan><tspan y="-115.99339" x="46.020905 50.715305 56.595905 62.100304">END;</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="510.29822pt" height="647.81012pt" viewBox="0 0 510.29822 647.81012" sodipodi:docname="256.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.68766" inkscape:cy="427.83244" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg126" /><g transform="translate(-45.234257,-69.064216)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-715.31989" x="45.119999 50.661743 53.175648 58.488312 64.128654 68.88356 71.403435 77.462105 81.360443 85.079506 90.718857 95.264603 99.24263 104.82421">Flags Affected</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-700.02002" x="45.119999 51.268799 53.7276 56.186401 59.010601 62.171402 64.630203 70.032005 75.631805 80.313606 83.197205 88.599007 92.434807 97.791611 100.61581 106.01761 109.17841 112.3392 117.696 122.3778 125.9166 131.27341 136.8732 139.6974 142.1562 145.317 148.1412 153.543 156.42661 159.96541 165.3672 170.049 175.3698 178.2534 182.9352 190.28999 192.74879 196.2876 200.96939 206.65919 209.4834 214.93919 219.62099 224.30278 229.99258 233.82838 238.51018 242.58897 245.47258 251.16238 256.61819 259.38031 262.54471 264.94141 270.3468 275.9502 280.63559 283.45978 288.86517 292.70456 298.10727 300.93146 306.33685 309.50125 312.66565 318.02606 322.71146 326.25385 331.61426 337.21765 340.10123 342.56363 345.72803 348.6116 354.017 356.84119 360.38358 365.78897 370.47437 375.79877 378.68234 383.36774 390.72614 393.18854 396.73093 401.41632 407.10971 409.9339 415.53729 420.9382 426.34091 431.0209 433.84509 439.53848 444.99789 448.54028 451.36447 456.82388 461.50928 466.19467 471.88806 474.47015">All flags are affected if a task switch occurs; no flags are affected if a task switch does not occur.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-676.31989" x="45.119999 51.181656 54.603912 60.003227 63.964321 69.569809 74.139458 78.100555 83.680145 89.305557 91.825439 99.52253 105.12802 110.75343 116.35892 118.8788 124.39764 129.68042 134.11958 139.69917 145.15926 149.12035 151.63823 157.24371 162.98865">Protected Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-661.97998" x="45.119999 52.470299 59.433601 64.892998 68.971802 74.684105 137.26291 141.04021 144.1965 147.02069 150.55499 156.2403 161.59259 164.47618 168.01048 173.40778 177.23907 182.83438 188.18668 191.72098 194.60457 200.05586 203.21216 206.36845 211.04576 216.44846 219.98816 222.81235 225.26665 230.95195 233.77614 239.37144 244.77414 249.45145 252.98575 255.44005 261.12534 266.52264 270.05695 272.51126 277.96255 283.64786 286.47208 291.92337 297.54028 302.89258 306.55377 311.95108 317.63638 323.23169 326.11438 328.5687 333.246 336.06931 341.66461 347.06641 352.28732 357.7467 363.43201 369.02731 371.85062 375.38492 381.07022 386.47202 389.29532 394.98062 400.33292 407.68323 410.50653 415.18384 420.63513 426.23044 431.63223 434.45554 439.13284 444.48514 450.08044 458.82574 464.17804 469.86334 473.39764 476.22095 478.67526 481.12958 489.87488 492.32919 495.86349">#GP(0)If the target offset in destination operand is beyond the new code segment limit.</tspan><tspan y="-648.00031" x="137.2206 141.0006 144.15959 146.98378 150.52078 156.20879 161.56378 164.44737 169.12738 174.48238 180.08038 188.82838 194.18338 199.87138 203.40839 206.29198 210.97198 216.32698 218.78398 224.13898 228.81897 232.35597 237.80997 241.64397 244.52756 246.92426 252.62576 255.50935 259.04636 264.66058 270.06329 272.88748 278.48547 283.88818 288.56818 292.10516 294.56216 300.25015 305.65015 309.18713 311.64413 317.09814 322.78613 325.61032 331.06433 336.66232 342.01733 345.67944 351.07944 356.76743 362.36542 365.24899 367.70599 372.38599 375.21017 381.93317 388.51218 393.51617 398.52017">If the segment selector in the destination operand is NULL.</tspan><tspan y="-634.02063" x="137.22058 140.99788 144.15417 146.97836 150.51266 156.19797 161.55026 164.43385 169.11116 174.56245 180.15776 185.51006 188.39365 193.07095 198.42325 204.01855 212.76385 218.16655 223.80865 227.34296 230.22655 234.90385 240.25615 242.71045 248.06274 252.74005 256.27435 261.72565 265.55695 268.44055 270.83728 276.53879 279.42239 282.9567 288.59879 294.0015 296.82571 302.42102 307.88492 311.41922 316.77151 319.59573 322.05005 326.72736 329.61096 336.33127 342.90756 347.90887 352.91019">If the code segment selector in the gate is NULL.</tspan><tspan y="-619.98065" x="137.22058 141.00508 144.16858 146.99277 152.39726 155.28085 163.98386 169.38655 178.13905 183.53995 187.37845 192.70195 195.58554 200.98643 206.62582 211.98532 215.64742 221.05191 226.74442 232.34691 235.2305 240.59 243.75349 246.91699 252.27649 256.961 260.5025 262.96399 268.18576 273.54526 276.42886 281.83337 287.43588 293.03839 296.82019 302.17969 306.8642 311.54871 314.37292 316.83441 321.51892 324.40253 329.80344 335.50494 339.04645 343.6806 346.15201 351.73111 357.10052 359.92474 363.47614 369.17853 374.5209 377.40451 383.64243 389.70572 392.98712 395.81134 402.75574 408.81903 412.06082 414.94443 420.58112 426.64441 429.92581 432.75003 437.93042 443.99371 447.27512 450.09933 455.56775 459.41614 462.29974 469.28015 475.40375 478.28735 482.98175 488.32413 493.90323 502.6665 508.00888 513.71039 517.26178 520.14539 522.54114 524.99719 533.75958 536.23096 539.78235">If a memory operand effective address is outside the CS, DS, ES, FS, or GS segment limit.</tspan><tspan y="-606.00098" x="137.2206 140.99969 144.15779 146.98198 150.51808 156.20518 161.55928 164.44287 171.37198 177.43529 180.70139 183.52557 189.20367 195.26698 198.53308 201.41667 206.58177 212.64508 215.91118 218.79477 224.24786 228.08096 230.90515 237.87025 244.01636 246.84055 250.67365 256.07635 261.67346 264.12955 268.80865 272.34476 277.69885 281.53195 284.35617 286.81226 291.49136 294.37497 300.01706 304.69705 310.09976 315.67978 318.56339 322.09949 327.5004 330.384 335.78311 340.46222 345.14133 350.49542 355.17453 359.85364 362.73724 371.48434 376.83844 385.58554 391.03864 394.87173 400.18982 403.07343 408.47253 414.15964 419.75674 422.58096 425.03705 428.57315 431.45676 436.13586 441.53677 447.22388 450.75998 456.15909 458.61517 464.30228 468.98138 471.8056 477.20471 480.08832 486.81042 493.38852 498.39163 503.39474 506.27835 510.95746 516.31158 521.90869 530.65576 536.05847 541.70056 545.23663">If the DS, ES, FS, or GS register is used to access memory and it contains a NULL segment </tspan><tspan y="-595.021" x="136.9209 141.59911 146.9523 149.4075 154.7607 159.4389 162.97411 168.4263 171.00839">selector.</tspan><tspan y="-580.98102" x="137.2206 140.99969 144.15779 146.98199 150.5181 155.91719 159.75029 165.3474 170.70149 174.23759 177.0618 185.8089 191.26199 196.8591 202.2618 205.086 207.5421 212.22119 215.04539 219.72449 225.17758 233.92468 239.52179 244.92088 248.45699 250.91309 256.51019 258.96628 261.42236 263.87845 267.35785 272.67596 275.50018 284.24728 289.70038 295.29749 300.65158 303.53519 308.9343 314.6214 320.21851 323.04272 329.10602 335.28992 340.70703 343.59064 345.98642 350.66641 353.55002 359.23712 364.69022 368.22632 371.05054 373.50662 379.19373 382.01794 384.47403 389.92712 397.27924 400.16284 405.87695 412.84204 418.90622">If target mode is compatibility mode and SSP is not in low 4GB.</tspan><tspan y="-567.00134" x="137.2206 140.99789 144.15419 146.97838 153.04169 159.22559 164.64088 167.46507 169.91937 175.60468 178.42886 182.20616 188.35046 194.06276 199.77505 205.53775 210.95305 215.95435 218.40865 224.12094 230.18425 236.36815 241.78345 244.60764 248.68193 256.03223 261.71753 267.06982 270.90112 276.25342 279.13702 281.59134 284.41556 286.86987 291.54718 294.3606 297.8967 303.5838 308.9379 311.8215 317.50861 322.8627 330.21481 333.09842 339.37051 344.78763 349.79074 353.86685 356.75046 359.14716 363.88745 366.71167 372.39877 377.85187 381.38797 384.21219 389.9263 392.80991 398.40701 403.7251 407.2612 412.6153 415.43951 420.83862 423.29471 425.75079 431.3479 437.035 442.3891 447.98621">If SSP in IA32_PLi_SSP (where i is the new CPL) is not 8 byte aligned.</tspan><tspan y="-553.02167" x="137.22061 141.00151 144.16141 146.505 150.04291 155.73181 161.08771 163.4313 166.96921 172.4241 177.6459 183.0486 188.7375 191.0811 196.48199 202.1709 207.76981 210.1134 213.65131 219.34021 224.69611 227.10001 231.78091 235.31882 240.71971 245.4006 250.7205 253.1244 256.2843 260.00671 265.40762 274.11063 279.46652 281.81012 285.34802 290.80292 293.14651 298.74542 304.10132 306.44492 312.04382 317.73273 322.41364 328.10254 333.45844 339.05734 341.46124 346.91614 352.50061 354.90451 359.58362 365.27072 370.66983 376.26694 381.72003 389.07214 391.47604 396.15515 399.69125 405.09036 409.76947 415.08759 417.49149 422.89059 426.72369 432.07779 434.42139 440.10849 445.56158 449.09769 451.44128 456.12039 461.57349 467.26059 470.79669 476.1958 478.65189 484.33899 489.69308 495.29019 497.63379 500.08987 505.77698 508.12057 513.51965 515.86322 521.55029 526.9494 530.48547 536.17255 539.83466 545.23828 547.6944 550.15051 555.46863">If the token and the stack frame to be pushed on shadow stack are not contained in a naturally </tspan><tspan y="-541.98138" x="136.9209 142.31999 144.71579 147.17189 152.769 158.4561 163.8102 169.4073 172.23061 177.9447 183.6588 187.73489 193.332 198.6501 202.1862 207.5403 210.3636 214.1967 219.5508 225.1479 227.604 233.0571 238.6983 241.58101 247.0341 250.1922 253.07491 256.61099 262.2981 267.65219 270.47549 275.2149 280.85611 286.25522 291.85233 297.30542 304.65753 307.54022 312.21933 315.75543 321.15454 325.83365 331.15173">aligned 32-byte region of the shadow stack.</tspan><tspan y="-528.00171" x="137.2206 141.0051 144.16859 146.9928 151.11929 155.80379 161.49629 167.09879 172.45828 176.29678 181.62029 184.08179 188.76628 194.22478 198.06328 200.88748 207.03899 212.73149 218.13599 223.73848 229.19698 236.55447 239.43808 245.58958 249.13109 254.53558 259.22009 264.54358 268.67007 271.49429 275.0358 280.49429 285.71606 291.11877 296.76086 299.64447 305.10297 310.79547 313.61969 319.31219 324.67169 332.02921 334.85342 339.53793 345.23044 350.63495 356.23746 361.69595 369.05347 371.87769 376.56219 380.1037 385.50821 390.19272 395.5162 398.39981 400.79651 405.47653 408.36014 417.11264 422.51715 426.35565 431.57742 436.93692 442.53943 445.42303 451.02554 456.71805 461.40256 465.90436">If “supervisor Shadow Stack” token on new shadow stack is marked busy.</tspan><tspan y="-513.96173" x="137.2206 141.0006 144.15959 146.9838 152.5818 157.9368 162.61679 166.15379 168.61079 174.2988 179.7627 183.3024 185.6991 191.15939 196.8474 199.6716 208.4196 213.8736 219.4716 224.8743 227.6985 230.1555 234.83551 237.65971 243.42241 249.1248 253.2018 258.7998 261.25681 264.79379 267.67737 273.07828 276.92038 279.80396 284.48395 289.93796 298.68594 304.28394 309.68393 313.22092 315.67792 321.27591 323.73291 326.18991 328.58661 332.1236 337.38062 340.26511 349.01309 354.4671 360.06509 365.4201 368.6871 371.57159 377.16959 382.85757 386.39456 389.27905 395.28384 401.46866 406.88666 409.77115 415.17114 420.76913 426.36713 430.20114 435.60477 440.28476 444.96475 447.78986 450.24686 455.93484 458.75995 462.88196 467.56195 473.24994 478.84793 484.20294 488.03696 493.35596 495.81296 500.49295 505.94696 509.78098 512.60614 517.28613 522.97412 528.37415 533.97217 539.42615 546.77917">If destination mode is 32-bit or compatibility mode, but SSP address in “supervisor shadow </tspan><tspan y="-502.98172" x="136.92091 141.60091 145.14061 150.5442 155.2242 160.5063 164.6463 167.52989 171.0696 176.52989 181.75169 187.09409 192.79559 195.61978 198.07588 202.75587 205.63947 211.21945 216.56184 221.78365 227.24394 232.94545 238.58484 241.40903 247.11142 254.06752 260.19202">stack” token is beyond 4GB.</tspan><tspan y="-489.00201" x="137.22061 141.00421 144.16681 146.991 153.05431 159.2382 164.65981 167.48399 172.88759 178.4892 184.09079 187.92839 193.28699 197.97058 202.65417 205.53777 207.99837 213.64047 216.52406 220.64966 225.33325 230.97536 236.61476 241.97336 245.81096 251.13356 253.53026 258.21387 263.67148 267.50906 270.39267 275.07626 280.76785 286.17145 291.77304 297.23065 304.58725 307.47086 312.15445 315.69504 321.09863 325.78223 331.10483 335.23044 338.11404 341.65463 347.11224 352.33405 357.67645 363.36804 366.25165 371.85324 377.31085 382.66946 387.35306 390.23666 395.87875 401.33905 404.87964 407.76324 416.51483 421.91843 425.45901 430.14261 435.8342 438.65842 444.72171 450.84531 456.26691 459.09113 464.49472 470.09631 475.69791 479.53549 484.8941 489.5777 494.26129 497.1449 499.5416 505.24307">If SSP address in “supervisor shadow stack” token does not match SSP address in </tspan><tspan y="-477.9617" x="136.92091 140.69731 146.84071 152.55211 158.3148 164.0262 169.4406 174.48419 176.88089 182.64359 188.64749 194.83139 200.23138 203.11497 207.18837 214.53777 220.22217 225.57356 229.40396 234.80666 237.63084 240.08424 242.90843 245.36183 250.03824 252.92183 256.45523 262.13962 267.54233 270.36652 276.0509 281.40231 288.75171 291.5759 297.84531 303.2597 308.30331 312.38211">IA32_PLi_SSP (where i is the new CPL).</tspan><tspan y="-463.98199" x="45.120918 52.472118 59.436317 64.852516 68.927719 73.605919 78.959122 81.414322 86.767525 91.445724 94.980927 100.43313 104.26533 137.20444 140.98534 144.14253 146.96672 152.36491 155.2485 159.92671 165.37891 170.97511 176.32831 179.2119 183.89011 189.2433 194.83951 203.58571 208.9389 214.62511 218.16031 221.0439 226.49609 230.32829 233.15248 238.74869 244.14688 247.68208 253.08478 255.90897 261.36118 265.19339 268.077 273.53549 279.59879 285.74399 288.62759 293.30579 298.659 301.1142 306.46741 311.1456 314.68079 320.133 323.96521 326.78943 329.24463 334.93082 340.52701 345.92972 351.24692 354.13052 356.52722 361.20721 364.09082 369.54303 375.22922 378.7644 383.4426 385.83929 391.4787 396.83191 399.71552 405.31171 410.66492 415.34311 420.0213 423.85352 426.30872 431.90491 435.44009 440.8923 444.72452 447.60812 451.14331 456.5415 462.1377 464.5929 469.94611 472.77032 475.22552 477.68073 486.42694 488.82364 492.36331 497.10361 500.3454">#GP(selector)If a code segment or gate or TSS selector index is outside descriptor table limits. </tspan><tspan y="-450.00229" x="137.22061 141.00511 144.16861 146.7525 150.29401 155.98651 161.34601 163.9299 168.6144 173.97389 179.57639 188.32889 193.68839 199.38089 202.92239 205.50629 211.10878 216.46828 221.15277 225.83727 229.67577 232.13727 237.73976 241.28127 246.73976 250.57826 253.16216 258.76465 264.22314 266.61984 272.32135 275.86285 281.22235 286.82486 289.40878 292.95029 298.40878 300.99271 306.59521 311.9187 314.50262 318.04413 323.73663 329.09613 331.68005 336.36456 341.72406 347.32657 356.04028 361.39438 367.08148 370.61758 373.20151 377.88062 383.23471 385.6908 391.04489 395.724 399.2601 404.7132 408.5463 411.13022 413.5863 419.27341 421.85733 425.39343 431.08054 436.43463 439.01855 444.61566 450.01837 454.69748 458.23358 460.63028 466.33179 471.7309 475.267 477.72308 483.17618 488.86328 491.4472 496.9003 502.49741 507.8515 511.57391 516.97302 522.6601 528.2572 530.84106 533.29718 537.97626 540.56012 546.24719 551.70032 555.23639">If the segment descriptor pointed to by the segment selector in the destination operand is not </tspan><tspan y="-438.96198" x="136.91998 140.04388 145.50418 149.34538 152.22899 157.63618 160.46039 165.14758 170.60878 176.30399 179.47018 184.93138 188.77258 197.47559 199.93169 205.62689 211.23209 215.31628 220.00348 225.46468 231.06987 236.43207 239.25627 243.94347 249.30566 254.91086 263.66605 269.02826 274.72345 278.26764 281.54184 284.42542 290.12061 295.52151 301.21671 305.9039 311.36511 317.0603 320.2265 325.68771 329.5289 338.2319 340.69611 346.3913 351.99649 356.08069 360.76788 366.1203 371.71921 377.0751 379.89932 384.58023 389.93613 395.53503 404.28394 409.63983 415.32874 418.86664 422.13455 425.01816 429.69907 435.09998 437.55786 439.95456 442.83817 448.43707 453.83798 457.37589 462.73178 465.99969 468.8833 472.4212 477.82211 482.50302 487.82294 490.70654 496.30545 501.70636 505.24426 510.60016 513.86804 516.69226 522.14716 525.98206 528.86566 532.40356 537.80444 542.48535 547.80524">for a conforming-code segment, nonconforming-code segment, call gate, task gate, or task </tspan><tspan y="-427.98196" x="136.92 141.59909 145.13519 150.53429 154.07039 159.42448 162.24869 166.9278 172.33049 177.9276 186.6747 192.02879 197.7159 201.252">state segment.</tspan><tspan y="-414.00226" x="137.2197 141.0024 144.16409 146.98828 150.52798 156.21869 161.57639 164.45998 171.39267 176.81337 181.82007 184.70366 187.82756 193.28786 197.12456 200.00815 205.41084 208.23503 213.92574 219.38243 225.07314 229.75583 235.21252 240.85463 244.01633 249.47302 253.30972 262.06042 264.52011 270.1622 275.76291 279.84262 284.52533 289.98203 295.58273 300.94043 303.82404 308.50674 313.86444 319.46515 328.21585 333.57355 339.26425 342.80396 345.6597 348.0564 352.79669 355.62091 361.30981 366.76471 370.30261 373.12683 378.48273 384.08163 389.77054 395.17145 397.56815 400.45175 403.98965 409.44455 412.26877 415.80667 421.49557 426.85147 429.73508 436.00897 441.42789 446.4328 449.31641 454.7713 458.5531 461.43671 464.97461 470.66351 476.01941 478.90302 485.1499 490.56882 495.57373 498.45734 501.61725 507.01816 510.85306 513.73663 517.27454 522.96344 528.31934">If the DPL for a nonconforming-code segment is not equal to the CPL or the RPL for the </tspan><tspan y="-402.96194" x="136.92 141.60359 146.96219 152.56378 161.31538 166.67398 172.36559 176.02499 178.1292 182.81279 185.63699 190.32059 195.72328 201.32489 210.07649 215.43509 221.12669 224.6673 227.4915 232.17509 237.57779 239.97449 245.37718 250.06078 253.60138 259.05899 262.89658 265.72076 268.18137 272.86496 275.68915 281.29074 285.12833 290.48694 295.89053 299.43112 304.78973 308.62732 311.51089 315.05148 320.69357 326.09717 331.78876 334.67233 338.21292 343.90451 349.26312 352.08731 358.36392 363.78552 368.79312">segment’s segment selector is greater than the CPL.</tspan><tspan y="-388.98224" x="137.2197 141.0051 144.16949 146.9937 150.5361 156.22951 161.5899 164.47351 171.40891 176.83231 181.84171 184.72531 187.88971 193.34911 197.18851 200.07211 205.47751 208.30171 212.98711 218.4465 224.13991 227.30431 232.7637 236.5455 245.2989 247.76131 253.45471 259.05811 263.1405 267.8259 273.28531 278.8887 284.24911 287.0733 291.7587 297.11911 302.7225 311.47589 316.8363 322.52969 326.07208 328.89627 331.35867 336.04407 338.86826 344.47165 348.31104 353.67145 359.07684 362.61923 367.97964 371.81903 374.70261 378.245 383.93839 389.34378 394.98587 397.86945 401.41183 407.10522 412.46564 415.28983 421.56824 426.99164 432.00104">If the DPL for a conforming-code segment is greater than the CPL.</tspan><tspan y="-375.00253" x="137.2197 141.0051 144.16949 146.9937 150.5361 156.17821 161.5386 164.36281 171.2982 176.7216 181.731 184.55521 187.7196 191.55901 197.0184 205.7718 208.59601 214.0014 216.82561 221.511 226.9164 229.3788 231.7755 235.85789 241.46129 246.86668 250.40909 255.76949 259.0419 261.80579 265.40576 270.80936 275.49475 280.35657 284.43896 290.04236 295.44775 298.99014 304.35056 307.62296 310.44714 315.90656 319.74594 322.57013 328.02863 334.09192 340.24432 342.95972 347.64331 353.00192 358.60352 367.3551 372.71371 378.4053 381.94589 384.77008 390.37167 395.73029 400.41388 405.09747 408.93506 411.39566 416.99725 420.53784 425.99545 429.83304 432.65723 435.11783 439.80142 442.62561 445.08621 450.44482 455.12842 459.81201 462.6362 466.17679 471.86838 477.27197 482.91406 485.73825 489.27884 494.97043 500.32904 503.15323 509.42984 514.85144 519.85907 522.62299 528.08057 531.91815 534.74237 538.28296 543.97455 549.37817 555.06976">If the DPL from a call-gate, task-gate, or TSS segment descriptor is less than the CPL or than </tspan><tspan y="-363.96222" x="136.92003 140.45883 146.10094 151.50363 154.32784 160.57564 165.99544 171.00124 173.82544 179.28123 182.44203 185.32564 188.86444 194.50655 199.90924 202.73344 207.41524 212.81703 215.27583 217.73463 221.81343 227.41324 232.81503 236.35384 241.71063 244.97943 247.80363 251.34244 256.74423 261.42603 266.34811 270.42691 276.0267 281.4285 284.96729 290.3241 293.5929 296.41708 301.87289 305.70868 308.59225 314.05075 320.11404 326.26285 328.42642 333.10822 335.9324 340.6142 345.97101 351.5708 360.32059 365.6774 371.36719 374.90598 377.73016 382.41196 387.76877 390.22757 395.58438 400.26617 403.86615 409.26706 411.84915">the RPL of the call-gate, task-gate, or TSS’s segment selector.</tspan><tspan y="-349.98251" x="137.21973 141.00423 144.16772 146.81192 150.35342 156.04593 161.40543 164.10902 168.79352 174.15302 179.75551 188.50801 193.91071 199.61221 203.15372 205.79791 211.40041 216.7599 221.4444 226.12889 229.96739 232.42889 238.03139 241.57289 247.03139 250.86989 253.51408 256.67758 262.13608 265.97458 268.67819 274.0827 276.72693 281.41144 286.81415 292.41666 301.16916 306.52866 312.22116 315.76266 318.40689 323.0914 328.49411 330.89081 336.29352 340.97803 344.51953 349.97803 353.81653 356.46075 359.62427 363.46277 368.92126 377.67377 380.31799 385.7225 388.42612 393.11063 398.51514 400.97662 403.37332 406.07693 411.67944 417.08395 420.62546 426.02817 428.67239 434.2749 439.67581 445.07852 449.75854 452.40277 458.09528 463.55377 467.09528 469.79889 472.19559 477.89709 483.4996 485.8963 490.58081 495.98532 499.52682 504.92953 507.57376 510.03525 513.57672 516.28033 518.677 523.35699 526.06061 531.46509 534.1687 538.85321 544.31171 549.91418 555.27368">If the segment descriptor for a segment selector from a call gate does not indicate it is a code </tspan><tspan y="-339.0025" x="136.92003 141.59912 146.95322 152.55032 161.29742 166.65152 172.33862 175.87473">segment.</tspan><tspan y="-324.96249" x="137.21973 141.00153 144.16232 146.98653 150.52533 156.21513 161.57193 164.45554 169.13733 174.49413 180.09393 188.84373 194.20053 199.89034 203.42914 206.31274 210.99454 216.35133 218.81013 224.16693 228.84872 232.38753 237.84332 241.67912 244.56273 247.72353 251.55933 257.01514 265.76492 268.58911 273.99091 276.87448 281.55627 286.95807 289.41687 291.81357 294.69714 300.29694 305.69873 309.23752 314.64023 317.46442 319.92322 324.60501 327.4292 333.02899 338.3858 343.6076 349.0679 354.75769 360.35748 363.24106 366.77985 372.46964 377.82645 380.65063 386.25043 391.60724 396.28903 400.97083 404.80661 407.26541 412.8652 416.40399 421.8598 425.69559 428.51978 432.05856 437.46036 443.06015 445.45685 450.85956 453.68375 456.14255 458.60135 467.35114 469.80994 473.34872 478.03052">If the segment selector from a call gate is beyond the descriptor table limits.</tspan><tspan y="-310.98279" x="137.21973 140.99432 144.14792 146.97211 150.50371 156.18631 161.5359 164.41949 171.3441 176.8035 181.80209 184.68568 187.83928 193.28787 197.11647 200.00006 205.39465 208.21884 212.89345 218.34204 223.93465 229.33734 233.40894 238.08354 243.43314 249.02574 257.76834 263.11795 268.80054 272.33212 275.21573 280.66434 286.25693 289.78851 295.18311 297.6347 303.31729 308.6669 314.25949 317.1431 320.29669 324.12003 329.58032 338.33463 341.15884 346.56516 349.44876 354.13507 359.54138 362.00467 364.40137 367.28497 372.88928 378.29559 381.8389 387.2002 390.02441 392.4877 397.17401 399.99823 405.60254 409.44284 414.80414 420.21045 423.75375 429.11505 432.95535 435.83896 439.38226 445.02438 450.43069 456.125 459.00861 462.55191 468.24622 473.60751 476.43173 482.71103 488.13531 493.14563">If the DPL for a code-segment obtained from a call gate is greater than the CPL.</tspan><tspan y="-297.00308" x="137.21973 141.00423 144.16772 146.99191 150.53342 156.22592 161.58542 164.46901 169.1535 174.513 180.11549 188.868 194.22749 199.92 203.4615 206.34509 211.02959 216.38908 218.85059 224.21008 228.89458 232.43608 237.89458 241.73308 244.61667 247.78017 253.23866 257.07715 259.96075 265.36526 268.18948 273.64798 279.71127 285.86276 288.68698 294.37949 299.784 304.46851 307.35211 309.74881 313.28851 317.97302 320.85663 323.31812 328.71902 333.45932 338.86295 341.25964 345.33847 350.94098 353.33768 358.79617 364.39868 369.80319 372.19989 375.0835 380.686 383.14749 386.689 389.51321 394.19772 399.60043 403.14194 405.96616 409.12967 414.58817 418.42667 421.25089 423.71237 429.17087 433.85538 439.25989 441.72137">If the segment selector for a TSS has its local/global bit set for local.</tspan><tspan y="-282.96307" x="137.21973 140.99792 144.15512 146.97931 152.3775 155.26109 160.71959 166.7829 172.9281 175.81169 180.4899 185.84309 191.4393 200.1855 205.5882 211.2303 214.7655 217.64909 223.2453 228.5985 233.2767 237.95491 241.78711 244.24231 249.83852 253.37372 258.77463 262.60684 265.49045 270.16864 275.76483 281.16754 285.84753 288.24423 291.42844 293.88364 299.23685 303.91504 306.79865 310.33383 315.97592 321.37411 324.9093 327.79291 331.32809 337.01428 342.36749 345.19171 350.72491 356.78821 362.93341 365.81702 368.21371 372.89371 375.77731 381.3735 387.05969 391.73788 397.05508 399.8793 405.33151 409.16373 412.04733 417.68942 423.14972 426.68491 429.56851 434.9118 440.01392 445.41211 447.86731 450.32251 455.7207 461.31689 463.77209 469.12531">If a TSS segment descriptor specifies that the TSS is busy or not available.</tspan><tspan y="-268.98337" x="45.120026 52.476627 58.539928 64.690529 68.771126 74.489723 137.24852 141.03212 144.19472 147.01892 152.62051 158.26262 162.94621 168.63782 171.09842 176.79002 182.39163 185.27524 188.81584 194.45795 199.86064 202.68484 206.52245 211.88104 215.42165 221.11325 224.95085 230.64246 233.46666 238.93056 244.53217 250.13376 253.97136 259.32996 264.01355 268.69714 271.96774 274.79193 280.39352 285.79712 289.4592 294.86279 303.61438 308.97299 312.51358 317.87219 321.70978 326.39337 329.66397 332.48816 337.94577 341.78336 344.66693 349.35052 352.89111 358.29471 362.9783 368.3009 371.12509 375.80869 381.1673 386.76889 395.52048 400.92319 406.62466 410.16525 412.98944 418.59103 424.04865 426.50925 432.20084 435.74142 441.10004 444.93762 447.8212 453.22211 458.92358 462.46417 467.92178 470.80536 474.34595 480.03754 485.39615 488.22034 492.90393 496.44452 501.84811 506.53171 511.85431 514.73792 520.0965 525.31824 530.00183 535.36041 540.76312 546.34314 551.02673">#SS(0)If pushing the return address, parameters, or stack segment pointer onto the stack exceeds </tspan><tspan y="-258.00336" x="136.92001 140.45612 146.09822 151.50092 154.3251 159.92221 165.37531 171.06241 176.74951 182.34662 187.02573 189.90932 195.36241 198.52051 201.3447 204.8808 210.5679 215.922 218.80559 223.48468 227.02078 232.41988 237.09897 242.41707 245.30066 249.97977 255.33386 260.93097 269.67807 275.03217 280.71927 284.25537 287.52148 290.3403 297.69241 303.37952 308.73361 314.42072 317.24402 322.93112 328.38422 331.20752 335.88663 339.42273 344.88574 349.56485 354.88293 357.76562 362.44473 369.79684 372.25293 375.78903 380.46814 386.15524 388.97855 394.43164 399.11075 403.78986 409.47696 413.31006 417.98917">the bounds of the stack segment, when no stack switch occurs.</tspan><tspan y="-243.96336" x="137.2206 141.006 144.17039 146.99458 152.39998 155.28357 163.98657 169.38927 178.14267 183.54356 187.38297 192.70737 195.59096 200.99185 206.63124 211.99164 215.65373 221.05913 226.75253 232.35593 235.23952 240.59991 243.76431 246.92871 252.28911 256.97452 260.51691 262.97931 268.20111 273.56152 276.44513 281.85052 287.45392 293.05731 296.83911 302.16089 306.84 311.5191 314.34332 316.79941 321.47852 324.36212 329.76303 335.46454 339.00064 343.67975 346.13583 351.73294 357.13565 359.95987 363.49597 369.18307 374.53717 377.42078 383.48407 389.60767 392.43188 397.17218 402.51459 408.11169 416.8588 422.21289 427.89999 431.4361 434.26031 436.7164 439.17249 447.91959 450.31537 453.85507">If a memory operand effective address is outside the SS segment limit.</tspan><tspan y="-229.98366" x="45.12088 52.476582 58.539883 64.689583 68.769287 73.451988 78.809692 81.269394 86.62709 91.309792 94.849495 100.3062 104.1429 137.26199 141.04289 144.20459 146.84879 152.44949 158.1402 162.82289 168.5136 170.9733 176.6154 182.21609 184.86029 188.39999 194.0907 199.44839 202.09259 205.92929 211.28699 214.82669 220.5174 224.3541 230.0448 232.689 238.09169 243.69238 249.29309 253.12979 258.48749 263.1702 267.85291 271.12262 273.82623 279.42694 284.82965 288.49176 293.89536 302.64606 308.00375 311.54346 316.8606 320.6424 325.38269 328.6488 331.29303 336.74612 340.57922 343.22345 347.90256 351.43866 356.83777 361.51688 366.83496 369.47919 374.15829 379.51239 385.1095 393.8566 399.25931 404.9014 408.4375 411.14111 416.73822 422.19131 424.6474 430.28949 433.82559 439.2283 443.0614 445.70563 451.15872 456.80081 460.33691 465.79001 468.43423 471.97034 477.65744 483.06015 485.70438 490.38348 493.91959 499.3187 503.9978 509.31592 511.96011 517.36279 522.58459 527.26367 532.6178 538.02051 543.60052 548.2796">#SS(selector)If pushing the return address, parameters, or stack segment pointer onto the stack exceeds </tspan><tspan y="-219.00366" x="136.9209 140.4606 146.10271 151.5054 154.32961 159.9303 165.38699 171.0777 176.7684 182.36911 187.0518 189.93541 195.39211 198.5538 201.37801 204.91771 210.60841 215.96611 218.84972 223.53241 227.07211 232.47481 237.1575 242.4792 245.36281 250.0455 255.4032 261.00391 269.75461 275.1123 280.80301 284.34271 287.61243 290.43665 297.79236 303.48306 308.84076 314.53146 317.35568 322.75839 325.642 330.32471 333.86441 339.26712 343.94983 349.27151 352.09573 356.77844 364.13416 366.53085 370.07056 374.75327 380.44397 383.32758 388.78427 393.46698 398.14969 403.79178 407.62848 412.31119">the bounds of the stack segment, when a stack switch occurs.</tspan><tspan y="-204.96367" x="137.2206 140.99519 144.14879 146.97298 150.50458 156.18718 161.53677 164.42036 170.48367 176.60727 179.49086 183.31946 188.66905 194.26166 196.71326 201.38786 204.91946 210.26906 214.09766 216.98125 219.43285 224.10745 226.99104 232.58365 237.93324 240.38484 246.06744 251.66005 254.54364 256.99524 262.44385 267.90775 273.48773 278.83734 284.42993 287.31354 292.70813 297.38272 300.20694 305.84634 311.24994 315.07855 318.61014 321.43436 326.88297 330.00061 332.82483 338.22574 341.10934 345.79025 349.32816 354.72906 359.40997 364.72986 367.55408 372.23499 379.5889 381.98468 385.52438 390.20529 395.8942 398.7778 404.17871 409.86761 415.46652 418.29074 421.82864 427.51755 432.87344 435.75705 440.43796 445.79385 451.39276 460.14166 465.54437 471.18646 474.72437 477.60797 483.20688 488.66177 491.11966 496.80856 500.34647 505.70236 511.30127 514.18488 517.72278 523.17767 526.00189 528.45978 533.14069">If the SS register is being loaded as part of a stack switch and the segment pointed to is </tspan><tspan y="-193.98367" x="136.9209 145.6239 151.02751 154.89571 160.11751 165.50671 171.08672 173.97032 179.61243 185.07274 188.64394 191.52754 197.10754 200.94965 206.29205 210.97206 216.36127 222.00337 225.57457">marked not present.</tspan><tspan y="-180.00397" x="137.2206 141.0078 144.174 146.9982 151.68539 155.2296 160.6368 165.32399 170.65019 173.5338 178.22099 183.58319 189.18839 197.94359 203.30579 209.00099 212.5452 215.3694 220.97459 226.43579 231.79799 236.48518 239.36879 245.01089 250.47119 254.0154 256.89899 262.59418 267.87808 273.20428 278.5665 281.39069 285.23187 290.69308 296.1543 304.90948 307.73367 310.89987 316.36108 320.20227 323.08585 326.63004 332.27213 337.63434 340.32089 344.16208 349.52429 353.06848 358.76367 362.60486 368.30005 371.12424 376.53143 382.13663 387.74182 391.58301 396.94522 401.63242 406.31961 409.59381 412.418 418.02319 423.43039 427.09247 432.49606 441.25125 446.61346 450.15765 455.51987 459.36105 464.04825 467.32245 470.14664 475.60785 479.44904 482.33261 487.01981 490.564 495.97119 500.65839 505.98459 508.80878 513.49597 518.85815 524.46338 533.21857 538.62128 544.32275 547.86694">If stack segment does not have room for the return address, parameters, or stack segment </tspan><tspan y="-168.96367" x="136.92088 142.52158 147.97827 150.43797 156.08008 159.61978 165.02248 167.54428 170.84637 173.67058 181.02628 186.71698 192.07468 197.76538 200.58958 205.27228 208.81198 214.21468 218.89737 224.21907 227.10268 231.78537 239.14107 241.60077 245.14047 249.82317 255.51387 258.33807 263.79477 268.47748 273.16019 278.85089 282.68759 287.3703">pointer, when stack switch occurs.</tspan><tspan y="-154.98396" x="45.120888 52.478386 59.205887 64.628387 68.709885 73.394386 78.753883 81.215385 86.574883 91.259384 94.800888 100.25939 104.09789 137.2773 141.0582 144.22169 147.0459 152.45039 155.334 160.01849 165.47699 171.07948 176.43898 179.32259 184.00708 189.36658 194.96907 203.72157 209.08107 214.77357 218.31508 221.58658 224.41078 230.01328 235.41777 238.95927 244.36377 247.18797 251.87247 257.23196 262.83447 271.58698 276.94647 282.63898 286.18048 289.452 292.3356 297.02011 302.42462 304.82132 307.2774 310.16101 315.76352 321.16803 324.70953 330.06903 333.34055 336.16476 339.70627 345.11078 349.79529 355.11877 357.94299 363.5455 368.95001 372.49152 377.85101 381.12253 383.94675 389.40524 393.24374 396.06796 401.60745 407.67075 413.82224 416.70584 419.10254 423.78256 426.66617 432.35867 437.81717 441.35867 444.18289 449.7854 453.6239 458.9834 463.66791 469.0274 474.71991 478.26141">#NP(selector)If a code segment, data segment, call gate, task gate, or TSS is not present.</tspan><tspan y="-141.00426" x="45.120888 52.473888 58.008888 64.155891 68.232895 72.912895 78.315598 80.712296 86.114998 90.794998 94.332001 99.786003 103.62 137.27911 141.06001 144.21901 147.04321 150.58022 156.26822 161.62321 164.50682 170.19482 175.54982 182.90282 185.78642 190.46643 194.00343 199.40343 204.08344 209.40244 212.22664 216.90665 222.26164 227.85965 236.60765 241.96265 247.65065 251.18765 254.01186 258.69186 264.04688 266.50388 271.85889 276.59918 280.13885 285.53976 289.38187 292.26544 297.66544 303.35342 308.95142 311.83499 317.51398 323.66098 329.07898 331.90317 337.30316 341.13718 346.53989 349.36407 354.96207 360.36478 365.58658 371.04688 376.73486 382.33286 385.21643 388.75342 394.39551 399.79822 402.62241 407.97742 413.66541 419.2634 422.08759 427.5416 430.70059 433.52478 437.06177 442.74976 448.10477 450.98834 456.44684 462.51013 468.57343">#TS(selector)If the new stack segment selector and ESP are beyond the end of the TSS.</tspan><tspan y="-126.96426" x="137.22058 141.00238 144.16318 146.98738 150.52618 156.21599 161.57278 164.45639 170.14619 175.50299 182.85779 185.74139 190.42319 193.96199 199.36378 204.04558 209.36638 212.19058 216.87238 222.22917 227.82898 236.57878 241.93558 247.62538 251.16418 253.98839 258.6702 264.02701 266.48581 271.84262 276.58292 280.12259 285.5235 289.36557 292.24915 294.70795 299.38974 302.21393 308.93872 315.51953 320.52533 325.53113">If the new stack segment selector is NULL.</tspan><tspan y="-112.98456" x="137.22058 141.00238 144.16318 146.98738 150.52618 156.21599 161.57278 164.45639 170.70419 176.12399 181.12979 183.95399 189.40979 192.57059 195.39479 198.93359 204.6234 209.98019 212.8638 218.5536 223.9104 231.2652 234.1488 238.8306 242.3694 247.77119 252.45299 257.77377 260.59796 265.27975 270.68246 276.28226 285.03204 290.38885 296.07864 299.61743 302.44162 307.12341 312.48022 314.93903 320.34174 325.02353 328.56232 333.96323 337.8053 340.68887 343.14767 348.72058 351.60419 355.14569 360.8382 366.19769 369.0813 374.53979 380.60309 386.75458 389.63818 392.03488 396.7149 399.59851 405.29102 410.74951 414.29102 417.11523 422.47473 428.07724 433.76974 439.17426 441.57095 444.45456 447.99606 453.45456 456.27878 459.82028 465.51279 470.87228 473.75589 480.6904 486.11288 491.1214 493.94562 499.40411 502.56763 505.45123 508.99274 514.63483 519.99432 522.81854 527.50305 532.96155 538.56403 543.92352">If the RPL of the new stack segment selector in the TSS is not equal to the DPL of the code </tspan><tspan y="-102.00455" x="136.92088 141.60089 146.95589 152.55389 161.3019 166.65689 172.34489 175.8819 178.76549 184.36349 189.71849 192.17549 197.86349 203.4615 206.28569 211.74959 216.4296 221.10959 226.46458 231.14459 235.82458 241.17958 246.77759">segment being accessed.</tspan><tspan y="-87.964554" x="137.22058 141.00688 144.17218 146.51578 153.45207 158.87637 163.88667 166.23027 171.69057 174.85587 177.19946 180.74277 186.43707 191.79837 194.14197 198.82826 202.37157 207.77786 212.46416 217.78946 220.13306 224.81935 230.18065 235.78494 244.53925 249.90054 255.59485 259.13815 261.48178 267.08609 272.44739 277.18768 281.86771 285.70801 288.10471 293.70901 297.25232 302.71262 306.55292 308.89655 312.06186 317.52216 321.36246 323.70609 327.24939 332.9437 338.30499 340.64862 346.29074 351.60059 358.95538 361.29898 365.98077 369.51956 374.92136 379.66165 384.98245 387.32605 392.00784 397.36465 402.96445 411.71423 417.07104 422.76083 426.29962 428.64322 431.10202 435.78381 438.12741 443.8172 449.27301 452.8118 455.1554 460.51221 466.112 471.80179 477.20358 479.66238 482.00598 485.54477 491.00058 493.34418 496.88297 502.57275 507.92957 510.27316 517.20496 522.62476 527.63055 529.97418 535.42999 538.59082 540.99475 544.53357 550.17566 555.53247">If DPL of the stack segment descriptor for the new stack segment is not equal to the DPL of the </tspan><tspan y="-76.98455" x="136.92088 141.59819 147.04948 152.64479 157.99709 160.88068 165.55798 170.91028 176.50558 185.25089 190.60318 196.28848 199.82278 202.70638 208.30168 213.65398 218.33128 223.00859 226.83989 229.29419 234.8895 238.4238 243.87509 246.45718">code segment descriptor.</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="509.53183pt" height="643.71783pt" viewBox="0 0 509.53183 643.71783" sodipodi:docname="257.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.47141" inkscape:cy="422.47465" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg128" /><g transform="translate(-46.146446,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-715.97998" x="138.12 141.9072 145.07339 147.8976 151.4418 157.13701 162.49921 165.38281 171.07802 176.44022 183.80042 186.68402 191.37122 194.91542 200.32262 205.00981 210.33601 213.16022 217.84741 223.20961 228.8148 237.57001 242.93221 248.62741 252.17162 254.99582 257.46002 262.14722 264.97141 270.6666 276.12781 279.672 282.55557 287.96277 290.78696 298.14716 301.98834 304.38504 307.92474 313.33194 318.93713 321.33383 326.73654 329.56073 335.16592 340.57312 344.11731 349.58121 352.4054 357.09259 362.4548 368.06 376.763 382.12521 387.7673 391.36728">If the new stack segment is not a writable data segment.</tspan><tspan y="-702.00031" x="138.12 141.89909 145.05719 147.88139 152.56049 157.96318 163.56029 172.30739 177.66148 183.34859 186.70828 190.78708 195.46619 200.82028 203.27638 208.63048 213.30957 216.84567 222.29877 226.13187 228.95607 231.41217 237.09927 242.69638 248.09908 253.41718 256.30078 259.45889 264.91199 268.74509 271.62869 276.3078 279.8439 285.24301 289.92212 295.24023 298.06445 302.74356 308.09766 313.69476 322.44186 327.79596 333.48306 337.01917 339.84338 342.29947 346.97858 349.8028 355.25589 360.94299 364.4791 369.1582 371.61429 377.2114 382.56549 385.4491 391.0462 396.44891 401.12802 405.80713 409.64023 412.03693 417.67633 421.21243 426.66553 430.49863 433.32285 436.85895 442.25806 447.85516 450.31125 455.66534 458.54895 461.00504 463.40173 472.14883 474.60492 478.14102 482.82013 486.08624">If segment-selector index for stack segment is outside descriptor table limits. </tspan><tspan y="-688.02063" x="46.020294 53.370594 58.829998 63.993298 68.067596 71.2239 76.621201 82.306503 84.760803 88.120506 92.19931 96.87661 102.32791 107.92321 113.32591 138.16501 141.94591 145.1022 147.92639 153.32368 156.20728 161.80258 167.19987 172.79518 178.19788 181.02206 184.17836 189.57565 195.26096 197.71526 201.24956 204.13315 209.58444 214.26175 218.93906 224.62436 228.45566 233.13297">#PF(fault-code)If a page fault occurs.</tspan><tspan y="-673.98065" x="46.020294 53.370594 59.514893 65.785194 69.859497 75.6222 138.1416 141.9189 145.0752 147.89938 153.29668 155.75098 158.20528 163.80058 169.48589 178.23119 183.58348 189.26878 192.80309 195.62727 200.30458 205.98988 211.34218 216.01949 221.33578 223.79008 229.47539 235.07069 237.89488 240.34918 245.02649 247.91008 253.26237 258.94766 264.34497 269.94028 272.39459 277.74689 283.34219 286.2258 291.62311 297.30841 302.90372 305.78732 311.18463 316.86993 319.73999 325.4361 331.07822 336.48633 338.95142 341.4165 347.02261 352.71872 358.08182 363.68793 366.51215 375.26825 380.63135 389.38745 394.84955 398.69165 404.01874 406.84296 410.68506 416.04816 419.21527 424.57837 428.42047 433.78357 439.47968 444.16779 449.53088 452.3551 454.82019 459.5083 462.33252 471.08862 476.49673 482.10284 487.46594 490.29016 497.65128 503.34738 505.74316 508.19925 513.56238 516.44598 519.99109 525.68719 531.05029">#AC(0)If alignment checking is enabled and an unaligned memory reference is made while the </tspan><tspan y="-663.00067" x="137.82028 142.49489 148.17749 152.00609 155.83469 161.23738 166.91998 170.45158 173.33517 178.92778 182.75638 185.20798 190.52158 192.91827 195.37437 200.72397 206.31657 211.66617 214.49036 216.94196 222.29155 227.60515 232.95474 235.40634 238.23053 240.68213 245.35674 248.18092 253.94362">current privilege level is 3.</tspan><tspan y="-649.021" x="46.020287 53.367886 59.941486 66.866089 138.1488 141.9234 145.077 147.90028 151.43188 157.11449 162.46408 165.34677 170.26886 177.34737 183.61496 189.83755 192.66084 198.29935 202.14055 207.49014 210.64374 213.03954 218.38013 221.26282 223.65862 228.33772 231.22041 236.90302 241.57762 246.92722 252.51982">#UD If the LOCK prefix is used.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-625.32001" x="46.02 52.198189 57.777782 63.078495 65.580444 68.650116 75.036469 80.676819 86.256416 89.738434 95.377785 100.12074 104.86369 107.38357 115.0448 120.68415 126.2737 131.91306 134.37317 139.95175 145.17378 149.61296 155.2523 160.65262 164.67346 167.15549 172.79483 178.50391">Real-Address Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-610.97998" x="46.02 53.337002 60.293102 138.11252 141.89342 145.05602 147.88022 153.28381 156.16742 164.87042 170.27312 178.97612 184.43642 188.27402 193.59662 196.42082 201.87842 207.48001 212.83861 216.5007 221.9043 227.5959 233.19751 236.08112 241.43971 244.60231 247.76491 253.1235 257.8071 261.34769 263.80829 269.03009 274.3887 277.27228 282.67587 288.27747 293.87906 297.71664 303.07526 307.75885 312.44244 315.26663 317.72723 322.41083 325.23502 330.69263 336.35999 339.90057 344.58417 347.04477 352.64636 358.00497 360.83008 364.37067 370.06226 375.42087 378.30536 384.58197 390.64618 393.91678 396.74188 403.67548 409.73969 413.01028 415.89478 421.57736 427.64157 430.91217 433.73727 438.90686 444.97107 448.24167 451.06677 456.52438 460.36197 463.24646 470.21606 476.36667 479.25116 483.93475 489.29337 494.89496 503.64655 509.00516 514.69678 518.23737 521.12189 523.51947 525.97644 534.72803 537.1886 540.72919">#GPIf a memory operand effective address is outside the CS, DS, ES, FS, or GS segment limit.</tspan><tspan y="-597.00031" x="138.11969 141.89969 145.05869 147.88289 151.41989 157.10789 162.46289 165.3465 168.8835 174.28349 178.11749 183.7155 189.0705 192.6075 195.4911 200.9451 204.1041 207.26309 211.94308 217.34578 220.88548 223.70969 226.16669 230.84668 233.67088 239.31029 244.65268 249.87448 255.33478 261.02277 266.62076 269.50433 273.04132 278.72931 284.08432 286.90851 291.5885 297.04251 302.68192 308.02432 310.84851 315.5285 320.93121 326.52921 335.27719 340.6322 346.32019 349.85718 352.68137 355.13837 357.59537 366.34335 368.74005 372.27972">If the target offset is beyond the code segment limit.</tspan><tspan y="-583.02063" x="46.019989 53.368488 59.942989 66.868492 138.1521 141.9276 145.08209 147.90628 151.43878 157.12228 162.47278 165.35637 170.27936 177.35876 183.62726 189.85075 192.67494 198.31435 202.15645 207.50694 210.66144 213.05814 218.39963 221.28322 223.67992 228.35992 231.24352 236.92702 241.60252 246.95302 252.54652">#UD If the LOCK prefix is used.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-559.32001" x="46.02 52.492008 54.980015 58.603462 62.624317 68.339363 73.646049 76.153976 79.229622 85.353027 91.53022 97.653625 103.77703 106.29691 113.96412 119.60347 125.199 130.83836 133.29849 138.83426 144.05629 148.49545 154.13481 159.53513 163.55597 166.04398 171.68333 177.39838">Virtual-8086 Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-544.97998" x="46.02 53.3685 60.330002 65.789398 69.868202 75.578705 138.15752 141.93301 145.08751 147.9117 153.30719 156.19078 164.93428 170.33698 179.08047 184.52997 188.35947 193.67397 196.49815 201.94765 207.58705 212.93755 216.59964 221.99515 227.67865 233.27216 236.15575 241.50624 244.66074 247.81523 253.16573 257.84122 261.37372 263.82623 269.04803 274.39853 277.28214 282.67764 288.27115 293.86465 297.69415 303.09683 307.77234 312.44785 315.27206 317.72458 322.40009 325.19998 330.65759 336.34918 339.88977 344.57336 347.03397 352.63556 357.99417 360.81839 364.35898 370.05057 375.40918 378.29279 384.5694 390.63269 393.90329 396.72751 403.6611 409.7244 412.995 415.8786 421.56119 427.62448 430.89508 433.7193 438.88889 444.95218 448.22278 451.047 456.50461 460.34219 463.2258 470.1954 476.34601 479.22961 483.91321 489.27182 494.87341 503.625 508.98361 514.67523 518.21582 521.09943 523.49609 525.95215 534.70374 537.16431 540.7049">#GP(0)If a memory operand effective address is outside the CS, DS, ES, FS, or GS segment limit.</tspan><tspan y="-531.00031" x="138.11969 141.89969 145.05869 147.88289 151.41989 157.10789 162.46289 165.3465 168.8835 174.28349 178.11749 183.7155 189.0705 192.6075 195.4911 200.9451 204.1041 207.26309 211.94308 217.34578 220.88548 223.70969 226.16669 230.84668 233.67088 239.31029 244.65268 249.87448 255.33478 261.02277 266.62076 269.50433 273.04132 278.72931 284.08432 286.90851 291.5885 297.04251 302.68192 308.02432 310.84851 315.5285 320.93121 326.52921 335.27719 340.6322 346.32019 349.85718 352.68137 355.13837 357.59537 366.34335 368.74005 372.27972">If the target offset is beyond the code segment limit.</tspan><tspan y="-516.96033" x="46.019989 53.370289 58.829693 63.992992 68.067291 71.223595 76.620895 82.306198 84.760498 88.120201 92.199005 96.876305 102.32761 107.9229 113.32561 138.1647 141.9456 145.1019 147.92609 153.32338 156.20697 161.80228 167.19957 172.79488 178.19757 181.02176 184.17805 189.57535 195.26065 197.71495 201.24925 204.13284 209.58414 214.26144 218.93875 224.62405 228.45535 233.13266">#PF(fault-code)If a page fault occurs.</tspan><tspan y="-502.98062" x="46.019989 53.372089 59.518188 65.790291 69.866394 75.629097 138.1485 141.9276 145.08569 147.9099 153.30899 155.76509 158.22119 163.8183 169.5054 178.2525 183.6066 189.2937 192.8298 195.65401 200.3331 206.0202 211.3743 216.05341 221.37151 223.82761 229.51471 235.11182 237.93602 240.39212 245.07123 247.95483 253.30893 258.99603 264.39514 269.99225 272.44833 277.80243 283.39954 286.28314 291.68225 297.36029 302.9664 305.85001 311.25812 316.90024 319.78384 325.47995 331.12207 336.53018 338.99527 341.46036 347.06647 352.76257 358.12567 363.73178 366.556 375.3121 380.6752 389.4313 394.8934 398.7355 404.06259 406.88681 410.72891 416.09201 419.25912 424.62222 428.46432 433.82742 439.52353 444.21164 449.57474 452.39896 454.86404 459.55215 462.37637 471.13248 476.54059 482.1467 487.5098">#AC(0)If alignment checking is enabled and an unaligned memory reference is made.</tspan><tspan y="-489.00092" x="46.019989 53.368488 59.942989 66.868492 138.1521 141.9276 145.08209 147.90628 151.43878 157.12228 162.47278 165.35637 170.27936 177.35876 183.62726 189.85075 192.67494 198.31435 202.15645 207.50694 210.66144 213.05814 218.39963 221.28322 223.67992 228.35992 231.24352 236.92702 241.60252 246.95302 252.54652">#UD If the LOCK prefix is used.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-465.29999" x="46.02 51.503975 57.097511 65.380249 70.993706 76.318321 80.308296 82.768417 88.408768 90.914703 93.440559 95.900681 99.921532 105.45531 107.97519 115.66032 121.25386 126.86732 132.46085 134.98073 140.53442 145.8172 150.25636 155.83595 161.29602 165.25711 167.76305 173.35658 179.08955">Compatibility Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-450.95999" x="46.02 52.1679 57.568802 66.317703 71.673607 74.557205 79.913109 85.134911 89.815811 95.218513 100.81741 104.35532 106.81322 112.26812 117.95702 122.63792 125.52152 130.92242 135.60333 138.42754 140.88544 146.57434 149.39854 154.99745 158.83235 164.28725 167.82515 173.18105 177.86194 181.39984 186.75574 192.35464 195.17885 203.92775 209.38264 214.98155 220.33745">Same exceptions as in protected mode.</tspan><tspan y="-436.98029" x="46.02 53.372101 60.3372 65.754303 69.830406 74.509506 79.863609 82.31971 87.673813 92.352913 95.889015 101.34212 105.17522 138.11432 141.89522 145.05331 147.87752 153.27661 156.16022 164.90732 170.31001 179.05711 184.51021 188.34331 193.66141 196.48561 201.94951 207.54662 213.14372 216.97682 222.33092 227.01001 231.68912 234.57272 239.97182 244.65091 249.33002 254.68411 259.36322 264.04233 269.44504 275.04214 277.86636 283.46347 288.78156 291.66516 295.20126 300.84335 306.24606 309.07028 313.74939 319.1521 321.5488 326.95151 331.63062 335.16672 340.61981 344.45291 347.27713 349.73322 354.41232 357.23654 359.69263 365.37973 368.20395 373.89105 379.34415 385.03125 389.10736 393.78647 399.18558 404.87268 410.32578 415.96786 418.42395 423.10306 428.50217 430.95825 433.78247 438.52277 444.10278 449.50189 454.181 459.5351">#GP(selector)If a memory address accessed by the selector is in non-canonical space.</tspan><tspan y="-423.00058" x="46.02 53.3703 60.333603 65.792999 69.871803 75.584106 138.1629 141.9402 145.0965 147.92068 151.45499 157.14029 162.49258 165.37617 168.91048 174.30777 178.13907 183.73438 189.08667 192.62097 195.50456 200.95586 204.11215 207.26845 211.94576 217.34845 220.88815 223.71234 226.16664 231.85194 234.67613 238.21043 243.89574 249.24803 252.12 257.7153 263.0676 267.7449 271.27921 273.73352 279.41882 284.81613 288.35043 290.80475 296.25604 301.94135 304.82407 310.27536 315.87067 321.22296 324.94446 330.34177 336.02707 341.62238 344.44571 346.90002 351.57733 354.46005 360.14536 365.59665 371.28195 375.35626 380.03357 385.43088 391.11618 396.56747 402.25278 404.64859 409.388 414.79071 417.18652">#GP(0)If the target offset in the destination operand is non-canonical.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-399.29999" x="46.02 52.164326 58.308651 61.405216 67.718857 70.227783 74.220749 76.68087 84.368996 89.965523 95.58197 101.1785 103.63862 109.1953 114.47809 118.8575 124.49686 129.89717 133.91803 136.42696 142.02348 147.75945">64-Bit Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-384.95999" x="46.02 53.371201 60.3354 65.751602 69.826805 75.540009 138.1188 141.897 145.0542 147.8784 153.2766 156.1602 164.9064 170.3091 179.0553 184.50749 188.33969 193.65689 196.48109 201.94499 207.5412 213.13741 216.9696 222.3228 227.00101 231.67921 234.56282 237.01802 241.69623 244.52043 250.20663 255.65883 261.34503 265.42023 270.09842 275.49661 281.1828 286.63501 292.2771 294.73318 299.41138 304.80957 307.26477">#GP(0)If a memory address is non-canonical.</tspan><tspan y="-370.98029" x="138.11971 141.90691 145.0731 147.89731 151.44151 156.84871 160.68991 166.2951 171.6573 175.20151 178.02571 183.48691 186.65311 189.81931 194.5065 199.8687 203.4129 206.23711 208.70131 214.39651 217.22072 222.82591 228.18811 232.87531 236.41951 238.88371 244.57892 249.98611 253.53032 255.92702 261.38733 267.08252 269.96609 275.42731 281.0325 286.39471 290.05679 295.52069 301.16278 306.76797 309.59216 312.05637 316.74356 319.56775 325.26294 330.72415 336.41934 340.50354 345.19073 350.59793 356.29312 361.75433 367.44952 369.84622 374.53342 379.94061 382.40482">If target offset in destination operand is non-canonical.</tspan><tspan y="-357.00058" x="138.11971 141.9006 145.0605 147.88469 151.42259 157.1115 162.46739 165.35098 170.03189 175.38779 180.98669 189.7356 195.09149 200.7804 204.3183 207.20189 211.88278 217.23868 219.69658 225.05247 229.73337 233.27127 238.72617 242.56107 245.38525 247.84315 253.53206 256.41565 259.95355 265.55969 270.92371 273.74789 279.35489 284.7189 289.4079 292.95389 295.35059 301.05206 306.46106 310.00705 312.47305 317.93607 323.63306 326.45724 331.92026 337.52725 342.89127 346.55334 351.96234 357.65933 363.26633 366.1499 368.54572 373.28601 376.1102 382.84219 389.43021 394.44321 399.45621">If the segment selector in the destination operand is NULL.</tspan><tspan y="-342.96057" x="138.11969 141.89879 145.05688 147.88107 151.41718 157.10428 162.45837 165.34196 170.02106 175.47415 181.07126 186.42535 189.30894 193.98804 199.34213 204.93924 213.68634 219.04044 224.72754 228.26364 231.14723 235.82632 241.18042 243.63652 248.99062 253.66971 257.20581 262.65891 266.492 269.37561 271.77231 277.47382 280.35742 283.89352 289.53561 294.93832 297.76254 303.47665 309.23938 313.31549 318.9126 321.36868 324.90479 327.729 333.32611 338.72522 342.26132 347.61542 350.43964 352.89572 357.57483 360.45844 367.18054 373.75864 378.76175 383.76486">If the code segment selector in the 64-bit gate is NULL.</tspan><tspan y="-328.98087" x="138.11969 141.89879 145.05688 147.88019 151.41629 156.81538 160.64848 166.24559 171.59969 175.13579 177.95909 186.70619 192.15929 197.75639 203.15819 205.98149 208.43759 213.1167 215.94 220.61911 226.0722 234.81931 240.41641 245.81551 249.35161 251.80771 257.40482 259.8609 262.31699 264.77307 268.25159 273.5697 276.39301 285.14011 290.5932 296.19031 301.5444 304.42709 309.8262 315.51331 321.11041 323.93372 329.99609 336.17908 341.59619 344.41949 346.87558 351.55469 354.43738 360.12448 365.52448 369.06058 371.94327 374.39935 380.08646 382.90976 385.36584 390.81894 398.17105 401.05374 406.76785 413.73294 419.79623">If target mode is compatibility mode and SSP is not in low 4GB.</tspan><tspan y="-315.00116" x="138.11969 141.90149 145.06229 147.88649 153.9498 160.07339 165.49319 168.3174 170.7762 176.466 179.29021 183.07201 189.22081 194.93761 200.6544 206.4171 211.8369 216.8427 219.3015 225.0183 231.0816 237.2655 242.6853 245.50951 249.5883 256.94312 262.6329 267.98972 271.8255 277.18231 280.06589 282.52469 285.34888 287.80768 292.48947 295.25967 298.79578 304.48288 309.83698 312.72058 318.40768 323.76178 331.11389 333.9975 340.26959 345.68671 350.68982 354.76593 357.64954 360.04623 364.72623 367.60983 373.29694 378.75003 382.28613 385.11035 390.82446 393.70807 399.30518 404.62329 408.15939 413.51349 416.33771 421.73682 424.1929 426.64899 432.24609 437.9332 443.28729 448.8844">If SSP in IA32_PLi_SSP (where i is the new CPL) is not 8 byte aligned.</tspan><tspan y="-300.96115" x="138.11969 141.90599 145.07129 147.35548 150.89879 156.59309 161.95439 164.29799 167.84129 173.30159 178.52339 183.86578 189.56009 191.90369 197.30998 203.00429 208.60858 210.95218 214.49548 220.13759 225.49889 227.78308 232.46938 236.01268 241.41898 246.10527 251.43057 253.77417 256.93948 260.6619 266.06821 274.77121 280.13251 282.41675 285.96005 291.42035 293.76398 299.36829 304.72958 307.07321 312.67752 318.37183 323.05814 328.75244 334.11374 339.71805 342.00229 347.46259 353.03967 355.32388 360.00479 365.6937 371.0946 376.69351 382.14841 389.50232 391.84592 396.52682 400.06473 405.46564 410.14655 415.46643 417.81003 423.21094 427.04584 432.40173 434.74533 440.43423 445.88913 449.42703 451.71124 456.39215 461.84705 467.53595 471.07385 476.47476 478.93265 484.62155 489.97745 495.57635 497.91995 500.37784 506.01993 508.36353 513.7644 516.10803 521.75012 527.15369 530.69159 536.38049 540.0426 545.50647 547.90228 550.3584 555.67828">If the token and the stack frame to be pushed on shadow stack are not contained in a naturally </tspan><tspan y="-289.98114" x="137.81998 143.21907 145.61577 148.07187 153.66898 159.35608 164.71017 170.30728 173.13148 178.84558 184.55968 188.63577 194.23288 199.55098 203.15099 208.50508 211.32928 215.16238 220.51648 226.11359 228.56969 233.97058 239.67209 242.55569 248.00879 251.16689 254.05049 257.58658 263.27368 268.62778 271.452 276.1311 281.81821 287.21732 292.81442 298.26752 305.61963 308.50323 313.18234 316.71844 322.11755 326.79666 332.11475">aligned 32-byte region of the shadow stack.</tspan><tspan y="-276.00143" x="138.11967 141.90598 145.07127 147.89548 152.02377 156.71007 162.40437 168.00867 173.36996 177.21027 182.53557 184.99887 189.68517 195.14546 198.98576 201.80997 207.96327 213.60538 219.01167 224.61597 230.07626 237.43556 240.31917 246.47247 250.01578 255.42207 260.10837 265.43365 269.56195 272.38617 275.92947 281.38977 286.61157 292.01428 297.6564 300.54001 306.00031 311.69461 314.51883 320.21313 325.57443 332.93375 335.75797 340.44427 346.13858 351.54489 357.1492 362.6095 369.96881 372.79303 377.47934 381.02264 386.42896 391.11526 396.44055 399.32416 401.72086 406.40088 409.28448 418.03879 423.4451 427.2854 432.5072 437.8685 443.47281 446.35641 451.96072 457.65503 462.34134 466.84314">If “supervisor Shadow Stack” token on new shadow stack is marked busy.</tspan><tspan y="-261.96143" x="138.11967 141.90057 145.06047 147.88467 153.48358 158.83948 163.52039 167.05829 169.51619 175.20509 180.60599 184.14389 186.60179 192.05669 197.74559 200.56979 209.3187 214.77359 220.3725 225.77519 228.5994 231.0573 235.73819 238.56239 244.32509 250.02748 254.10538 259.70428 262.16217 265.70007 268.52429 277.27319 282.72809 288.327 293.72971 296.55392 302.00882 305.84372 308.72733 313.40823 318.86313 327.61203 333.21094 338.61185 342.12 344.56619 350.20557 352.65176 355.09796 357.54416 361.07037 366.37857 369.20276 377.93997 383.38318 388.97037 394.37308 397.62927 400.51285 406.10004 411.77722 415.30344 418.12762 424.19092 430.37482 435.78201 438.6062 443.99539 449.63477 455.22195 459.04517 464.38937 469.05856 473.72775 476.61133 479.05753 484.73474 487.61832 491.72952 496.39871 502.07593 507.7153 513.05951 516.78186 520.68066 526.02222 528.46844 533.13763 538.58081 542.40399">If destination mode is 32-bit mode or compatibility mode, but SSP address in “super-visor </tspan><tspan y="-250.98143" x="137.81999 142.4955 148.1376 153.53311 159.12662 164.57611 171.92461 176.04211 178.8663 183.54181 187.07431 192.46982 197.21013 202.52463 205.40822 208.94072 214.39021 219.61201 224.95441 230.63791 233.4621 235.9146 240.5901 243.47369 249.0672 254.41769 259.73221 265.13309 270.81659 276.4101 279.23431 284.94482 291.90631 298.0668">shadow” stack token is beyond 4GB.</tspan><tspan y="-237.00172" x="138.11969 141.90329 145.06589 147.89008 153.95338 160.077 165.4986 168.32278 173.72638 179.32797 184.92957 188.76717 194.12576 198.80936 203.49295 206.37654 208.77324 214.47475 217.35834 221.48393 226.22423 231.86633 237.50572 242.86432 246.70192 252.02452 254.42122 259.10483 264.56244 268.40002 271.28363 275.96722 281.65881 287.06241 292.664 298.12161 305.47821 308.36182 313.04541 316.586 321.98959 326.67319 331.99579 336.1214 339.005 342.54559 348.0032 353.22501 358.56741 364.259 367.14261 372.7442 378.20181 383.56042 388.24402 391.12762 396.76971 402.23001 405.7706 408.65421 417.40579 422.80939 426.34998 431.03357 436.67566 439.55927 445.62256 451.74615 457.16776 459.99197 465.39557 470.99716 476.59875 480.43634 485.79495 490.47855 495.16214 497.98636 500.44696 506.13855">If SSP address in “supervisor shadow stack” token does not match SSP address in </tspan><tspan y="-225.96143" x="137.81999 141.59819 147.74339 153.45659 159.21928 164.93248 170.34868 175.39227 177.78897 183.55167 189.55557 195.73947 201.13947 204.02307 208.09827 215.44946 221.13567 226.48886 230.32106 235.72375 238.54796 241.00316 243.82736 246.28256 250.96077 253.78497 257.32016 263.00635 268.40906 271.23325 276.91943 282.27264 289.62384 292.44803 298.71924 304.13544 309.13763 313.21283">IA32_PLi_SSP (where i is the new CPL).</tspan><tspan y="-211.98172" x="46.019997 53.372997 60.338997 65.756996 69.834 74.514 79.869003 82.326004 87.681007 92.361008 95.89801 101.35201 105.18601 138.12512 141.90602 145.06502 147.88922 152.56921 158.02321 163.62122 169.02391 171.84811 176.52811 181.9308 187.52881 196.27681 201.63181 207.31981 210.85681 213.68102 219.13501 222.96901 225.85262 231.56761 237.28261 241.3596 246.95761 249.41461 252.95161 255.83524 260.51523 265.91522 268.31192 270.72031 273.60391 279.1983 284.5947 288.12808 293.47949 296.3631 298.7598 303.50009 306.32431 311.77472 317.45911 320.99249 325.66888 328.12228 333.71667 339.06808 341.95169 347.54608 352.89749 357.57388 362.25027 366.08069 368.53409 374.12848 377.66187 383.11227 386.94269 389.82629 393.35968 398.75607 404.35046 406.80386 412.15527 415.03888 417.43558 419.89166 428.63605 431.08945 434.62283 439.29922 442.56262">#GP(selector)If code segment or 64-bit call gate is outside descriptor table limits. </tspan><tspan y="-198.00201" x="138.12061 141.9006 145.0596 147.88379 152.56378 158.01778 163.61578 169.01848 171.84267 176.52267 181.92537 187.52338 196.27138 201.62637 207.31438 210.85138 213.67557 219.12956 222.96356 225.84715 231.56215 237.27715 241.35414 246.95215 249.40915 252.94615 255.82976 260.50977 265.90976 268.30646 270.76257 273.64618 279.24417 284.64417 288.18115 293.53616 296.41977 301.82068 307.04248 312.39749 316.23151 318.68851 324.0885 329.68649 334.36649 337.25009 342.93808 348.39209 354.03418 358.11298 362.79297 368.19296 373.88095 379.33496 385.02295 387.47995 392.15994 397.55994 400.01694 402.84116 407.52115 413.11914 418.51913 423.19913 428.60184 431.84363">If code segment or 64-bit call gate overlaps non-canonical space. </tspan><tspan y="-183.96202" x="138.12061 141.90421 145.0668 147.59039 151.131 156.8226 162.1812 164.76509 169.44868 174.80728 180.40887 189.16048 194.51907 200.21068 203.75128 206.27487 211.87646 217.23506 221.91866 226.60225 230.43985 232.90045 238.50204 242.04265 247.50024 251.33784 253.86143 259.46304 264.92065 267.31735 273.01883 276.55942 281.91803 287.51962 290.04321 293.5838 299.04141 301.565 307.1666 312.4892 315.01279 318.55338 324.24496 329.60358 332.18747 336.87106 342.22968 347.83127 356.58286 361.94147 367.58356 371.12415 373.70804 378.39163 383.75024 386.21085 391.56946 396.25305 399.79364 405.25125 409.08884 411.61243 414.07303 419.76462 422.28821 425.8288 431.52039 436.879 439.46289 445.06448 450.4231 455.10669 458.64728 461.10788 466.79947 472.20306 475.74365 478.20425 483.66187 489.30396 491.88785 497.34546 502.94705 508.30566 512.02808 517.4317 523.07379 528.67542 531.19904 533.65961 538.3432 540.86682 546.55841 552.01599 555.55658">If the segment descriptor pointed to by the segment selector in the destination operand is not </tspan><tspan y="-172.98203" x="137.82091 140.94481 146.40511 150.24721 153.13081 158.53891 161.36311 166.05121 171.51331 177.20941 180.37651 185.83861 189.62041 198.37651 200.84161 206.53772 212.14381 216.22891 220.91701 226.3791 231.9852 237.3483 240.1725 244.8606 250.22369 255.82979 264.58588 269.94897 275.64508 279.19019 282.46527 285.34888 290.991 296.45129 302.1474 306.83551 312.29761 317.99371 321.16083 326.62292 330.46503 339.06091 341.5188 347.2077 352.80661 356.88452 361.56543 367.02032 372.61923 377.97513 380.79935 385.48026 390.88297 396.48187 405.23077 410.58667 416.27557 419.81348 423.08139 425.965 431.41989 435.25479 438.07901 443.79492 449.55765 453.63556 459.23447 461.69235 465.23026 468.05447 472.73538 478.13629 480.59418 483.05206 485.87628 491.47519 496.8761 500.414 505.7699">for a conforming-code segment, nonconforming-code segment, or 64-bit call gate.</tspan><tspan y="-159.00232" x="138.12061 141.8988 145.056 147.88019 151.41539 157.10159 162.45479 165.33838 170.01659 175.36978 180.96599 189.71219 195.06538 200.75159 204.28679 207.17038 212.76659 218.11978 222.79799 227.4762 231.3084 233.7636 239.3598 242.895 248.3472 252.1794 255.06299 260.65918 266.11139 268.56659 274.25278 277.78796 283.14117 288.73737 291.62097 295.15616 300.60837 303.43259 309.02878 314.34598 317.1702 320.70538 326.39157 331.74478 334.62839 339.30658 344.65979 350.25598 358.98062 364.38425 370.02722 373.56241 376.44601 381.12421 386.47742 388.93262 394.28583 398.96402 402.49921 407.95142 411.78363 414.66724 417.06485 422.76724 425.65085 429.18604 434.87222 440.27585 443.10007 448.69626 454.09988 458.77808 462.31326 464.76846 470.45465 475.85284 479.38803 481.84323 487.29544 492.98163 495.80585 501.25806 506.85425 512.20746 515.87048 521.26868 526.9549 532.55109 535.43469 537.88989 542.56812 545.39233 550.79053">If the segment descriptor pointed to by the segment selector in the destination operand is a </tspan><tspan y="-147.96202" x="137.82092 142.50542 147.90631 153.5088 158.8683 161.75189 166.43639 171.79588 177.39838 186.15088 191.51038 197.20288 200.74438 203.62798 209.03247 214.67458 220.27707 223.10126 228.79376 234.19826 238.88275 241.70694 247.30943 252.76793 256.30942 262.00192 264.82614 268.36765 274.06015 279.41965 282.30325 289.23776 293.31927 298.92178 301.38327 304.92477 307.80838 313.21289 318.85498 324.45749 327.28171 330.82321 336.51572 341.87521 344.75882 349.08243 353.16125 355.98547 361.58798 364.04947 367.59097 370.47458 375.15909 380.51859 384.06009">code segment and has both the D-bit and the L- bit set.</tspan><tspan y="-133.98232" x="138.12062 141.90422 145.06682 147.89011 151.43071 157.12231 162.48091 165.3636 172.2972 177.7188 182.72639 185.54968 188.71228 194.16988 198.00748 200.89017 206.29376 209.11705 214.80865 220.26625 225.95786 230.64145 236.09904 241.74115 244.90375 250.36134 254.19894 262.95053 265.41113 271.05322 276.65482 280.73541 285.41901 290.87662 296.47821 301.83682 304.71951 309.40311 314.76172 320.36331 329.1149 334.47351 340.1651 343.70569 346.58838 348.98508 353.64093 356.52451 362.2215 367.68451 371.2305 374.05469 379.4187 385.0257 390.72269 396.13168 398.52838 401.41196 404.95795 410.42096 413.24515 416.79114 422.48813 427.85214 430.73572 437.01773 442.44473 447.45773 450.73373 453.55792 459.02094 462.86392 465.68811 469.2341 474.93109 480.2951 483.11929 489.3743 494.8013 499.8143 502.63849 505.80649 511.2695 515.11249 517.93671 521.48273 527.17975 532.54376">If the DPL for a nonconforming-code segment is not equal to the CPL, or the RPL for the </tspan><tspan y="-123.00231" x="137.82094 142.50633 147.86673 153.47012 162.22353 167.58392 173.27733 176.93674 179.04094 183.72633 186.55054 191.23593 196.63863 202.24202 210.99542 216.35582 222.04922 225.59163 228.41583 233.10123 238.50392 240.90062 246.30331 250.98871 254.53111 259.99051 263.8299 266.65408 269.11649 273.80188 276.62607 282.22946 286.01126 291.41397 296.81757 300.35995 305.72037 309.55975 312.44333 315.98572 321.62781 327.0332 332.72659 335.61017 339.15256 344.79465 350.19736 353.02155 359.29996 364.72336 369.73276">segment’s segment selector is greater than the CPL.</tspan><tspan y="-108.96231" x="138.12064 141.90604 145.07043 147.89374 151.43614 157.12955 162.48994 165.37265 172.30804 177.73145 182.74084 185.56415 188.72855 194.18794 198.02734 200.91005 206.31544 209.13875 213.82414 219.28354 224.97694 228.14134 233.54134 237.38254 246.13594 248.59834 254.29175 259.89514 263.97754 268.66293 274.12234 279.72574 285.08615 287.90945 292.59485 297.95526 303.55865 312.31204 317.67245 323.36584 326.90823 329.73154 332.19394 336.87933 339.70264 345.30603 349.14542 354.50583 359.91122 363.45361 368.81403 372.65341 375.5361 379.07849 384.7197 390.18268 395.82388 398.70657 402.24896 407.94235 413.30276 416.12607 422.40448 427.82788 432.83728">If the DPL for a conforming-code segment is greater than the CPL.</tspan><tspan y="-94.982613" x="138.12064 141.89973 145.05783 147.88202 151.41812 157.10522 162.45932 165.34291 172.272 177.7314 182.7345 185.55869 188.71678 192.54988 198.00298 206.75008 209.57426 214.97336 217.85695 223.57104 229.28514 233.36124 239.00064 241.39734 244.93344 247.81703 252.49612 257.89523 260.35132 262.74802 266.82413 272.46353 277.86264 281.39874 286.75284 289.63644 292.03314 296.71313 299.59674 302.05283 307.40692 312.08603 316.76514 319.58936 323.12546 328.81256 334.21167 339.89877 342.72034 346.32034 351.96243 357.32193 360.14615 366.42365 371.84613 376.85464 379.73825 385.19675 389.03525 391.85947 395.40097 401.09348 406.49799 412.19049 415.01471 418.55621 424.24872 429.60822 432.49182 438.74231 444.16479 449.17331 451.99753 457.45602 460.61954 463.44376 466.98526 472.67776 478.03726 480.92087 486.64038 492.35989 496.44141 502.04391 504.5054 508.04691 510.87112 515.5556 520.96008 523.42157 525.88306 529.96454 535.56702 540.9715 544.513 549.8725">If the DPL from a 64-bit call-gate is less than the CPL or than the RPL of the 64-bit call-gate.</tspan><tspan y="-81.002914" x="138.12064 141.91144 145.08124 147.90544 151.45325 157.15205 162.51785 165.40146 171.10027 176.70906 182.31786 187.68365 191.46545 194.34906 197.82846 203.16997 208.77876 214.14456 217.02817 220.19797 222.59467 227.96046 230.35716 235.96596 238.79016 244.25496 247.42476 250.24896 255.65976 258.54337 264.26917 269.99496 274.08276 279.69156 282.08826 285.63605 288.51965 293.21045 298.62125 301.08905 303.48575 306.36935 311.97815 317.38895 320.93674 326.30255 329.12677 331.59457 336.28537 339.10959 344.80838 350.27319 353.82098 356.6452 362.371 367.70081 373.42661">If the upper type field of a 64-bit call gate is not 0x0.</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="511.31134pt" height="245.73831pt" viewBox="0 0 511.31134 245.73831" sodipodi:docname="258.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.69702" inkscape:cy="-108.16467" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg60" /><g transform="translate(-45.977234,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-715.97998" x="137.22 141.0027 144.1644 146.9886 150.52831 156.21901 161.57671 164.46031 169.14301 174.5007 180.10141 188.85211 194.20981 199.90051 203.44022 206.32382 211.00652 216.36421 218.82391 224.18161 228.8643 232.40401 237.8607 241.6974 244.58101 247.74271 251.57941 257.0361 265.7868 268.61102 274.01373 276.89734 282.61505 288.33276 292.41248 298.01318 300.40988 303.94958 306.83319 311.5159 316.91861 319.3783 321.83798 324.6622 330.26291 335.66562 339.20532 344.56302 347.38724 349.84692 354.52963 357.35385 362.95456 368.31226 373.53403 378.99432 384.68503 390.28574 393.16934 396.70905 402.39975 407.75745 410.58167 416.18237 421.54007 426.22278 430.90549 434.74219 437.20187 442.80258 446.34229 451.79898 455.63568 458.4599 461.9996 467.40231 473.00302 475.46271 480.8204 483.64462 486.10431 488.564 497.3147 499.7114 503.2511 507.93381">If the segment selector from a 64-bit call gate is beyond the descriptor table limits.</tspan><tspan y="-702.00031" x="137.22 140.9973 144.15359 146.97778 150.51208 156.19739 161.54968 164.43327 171.36058 176.81998 181.82127 184.70486 187.86116 193.31245 197.14375 200.02734 205.42464 208.24883 212.92613 218.37743 223.97273 229.37543 233.44972 238.12703 243.47932 249.07463 257.81995 263.17224 268.85754 272.39185 275.27545 280.72675 286.32205 289.85635 295.25366 297.70798 303.39328 308.74557 314.34088 317.22449 320.3808 324.2121 329.66339 338.40869 341.23291 346.63022 349.51382 355.22614 360.93845 365.01276 370.65216 373.04889 376.6489 379.47311 384.15042 389.54773 392.00204 394.45636 397.28058 402.87589 408.27319 411.8075 417.21021 420.03442 422.48874 427.16605 429.99026 435.62967 439.47177 444.82407 450.22137 453.75568 459.10797 462.93927 465.82288 469.35718 475.04248 480.43979 486.12509 489.0087 492.543 498.2283 503.5806 506.40482 512.67511 518.09039 523.13397">If the DPL for a code-segment obtained from a 64-bit call gate is greater than the CPL.</tspan><tspan y="-688.02063" x="137.22 141.0081 144.1752 146.69881 150.24391 155.94002 161.30312 163.88702 168.57512 174.03722 179.64331 185.00641 187.53001 192.21811 197.58121 203.1873 211.8903 217.2534 222.94951 226.49461 229.01822 234.62431 239.98741 244.67551 249.3636 253.2057 255.6024 261.24179 264.7869 270.24899 274.09109 276.61472 282.22083 287.62173 290.08682 295.78293 299.32803 304.69113 310.29724 312.82086 316.36597 321.82806 324.41199 330.0181 335.34518 337.92911 341.47421 347.17032 352.53342 355.02002 359.70721 365.06943 367.53363 372.89584 377.58304 381.12723 386.58844 390.42963 392.95322 395.41742 401.11261 403.6362 407.18039 412.87558 418.23779 420.76138 426.48358 432.20578 436.28998 441.89517 444.35938 447.90356 450.42715 456.03235 461.43954 464.98373 470.34595 472.86954 478.47473 483.93594 489.29816 493.98535 499.68054 502.09973 505.64392 508.22781 513.86993 519.21326 524.53943 529.90161 532.42523 535.96942 541.66461 547.02679 549.55042 553.87402">If the code segment descriptor pointed to by the selector in the 64-bit gate doesn't have the L-</tspan><tspan y="-676.98035" x="136.92032 142.52103 144.98073 148.52043 151.34464 156.02733 161.38503 164.92473 167.80833 173.21103 178.90173 184.50244 187.38605 190.92575 196.56786 201.92555 204.74976 211.68245 215.76215 221.36285 223.82256 227.36226 230.18646 234.86916 237.32886 242.68655 248.08925 250.67136">bit set and the D-bit clear.</tspan><tspan y="-663.00067" x="137.22002 141.00272 144.16441 146.98862 150.52832 156.21902 161.57672 164.40092 169.08362 174.48631 180.08701 188.83771 194.1954 199.88611 203.42581 206.25002 211.85071 217.2534 221.9361 226.61879 230.45549 232.85219 238.49158 242.03128 247.48798 251.32468 254.14888 257.31058 262.76727 266.60397 269.42819 274.8309 277.65512 282.33783 287.69553 293.29623 302.04694 307.44965 313.15115 316.69086 319.51508 324.19778 329.55548 332.01517 337.37286 342.05557 345.59528 351.05197 354.88867 357.71289 360.8746 364.6203 370.077 378.8277 381.65192 385.19162 390.88232 396.24002 399.06424 404.78195 410.49966 414.57938 420.18008 422.63977 426.17947 429.00369 433.6864 439.08911 441.5488 444.00848 446.8327 452.43341 457.83612 461.37582 466.73352 469.55774 475.15845 480.61514 485.97284 490.65555 493.53915 499.18124 504.64154 508.18124 511.06485 513.46155 519.16302 524.76373 527.22345 531.90613 537.30884 540.84851 546.20624 549.0304 551.49011 555.02979">If the segment descriptor for a segment selector from the 64-bit call gate does not indicate it </tspan><tspan y="-652.02069" x="136.9203 139.317 143.99699 146.8806 152.28149 155.1057 159.78659 165.24149 170.84039 176.19629 179.02049 183.70139 189.10408 194.70299 203.45189 208.80779 214.49669 218.03459 221.30249">is a code segment. </tspan><tspan y="-637.98071" x="45.120308 52.477806 58.541107 64.692604 68.774101 74.493599 137.2524 141.0369 144.20039 147.0246 152.62709 158.2692 162.95369 168.64619 171.1077 176.8002 182.40269 185.2863 188.8278 194.46991 199.8726 202.69681 206.53531 211.89481 215.43631 221.12881 224.96732 230.65982 233.48402 238.94252 242.10602 245.26952 249.95401 255.31351 258.85501 261.73862 267.19711 271.03561 273.85983 280.13733 286.28882 289.11304 293.85333 299.19574 301.65723 307.01672 311.70123 315.24274 320.70123 324.53973 327.36395 332.82245 338.51495 342.05646 347.51495 350.33917 353.88068 359.57318 364.97589 367.80011 372.48462 376.02612 381.43063 386.11514 391.43863 394.26285 399.66556 404.88733 409.57184 414.93134 420.29083 425.89334 430.57785 433.40207 436.94357 442.63608 447.99557 450.87918 456.48169 461.94019 467.63269 473.3252 478.9277 483.61221 486.43643 491.89493 495.05844 497.94205 501.48355 507.12564 512.52838 515.3526 520.03711 523.57861 528.98309 533.6676 538.99109">#SS(0)If pushing the return offset or CS selector onto the stack exceeds the bounds of the stack </tspan><tspan y="-627.00073" x="136.9203 141.5994 146.95349 152.5506 161.2977 166.65179 172.3389 175.875 178.75859 186.11069 191.79779 197.15189 202.83899 205.66318 211.35028 216.80338 219.68697 224.36606 227.90216 233.30125 237.98035 243.29845 246.18204 250.86115 258.21326 260.60995 264.14966 268.82877 274.51587 277.39948 282.85257 287.53168 292.21078 297.85287 301.68597 306.36508">segment when no stack switch occurs.</tspan><tspan y="-613.02106" x="137.22 141.0054 144.1698 146.99399 152.39938 155.28297 163.98598 169.38867 178.14207 183.54297 187.38237 192.70677 195.59036 200.99126 206.63065 211.99104 215.65314 221.05853 226.75194 232.35533 235.23892 240.59932 243.76372 246.92812 252.28851 256.97391 260.5163 262.9787 268.2005 273.56091 276.44452 281.84991 287.45331 293.0567 296.8385 302.16031 306.83942 311.51852 314.34274 316.79883 321.47794 324.36154 329.76245 335.46396 339.00006 343.67917 346.13525 351.73236 357.13507 359.95929 363.49539 369.1825 374.53659 377.4202 383.48349 389.60709 392.4313 397.1716 402.51401 408.11111 416.85822 422.21231 427.89941 431.43552 434.25974 436.71582 439.17191 447.91901 450.31479 453.85449">If a memory operand effective address is outside the SS segment limit.</tspan><tspan y="-598.98108" x="137.22 141.0045 144.168 146.99219 150.53369 156.2262 161.58569 164.46928 169.15378 172.69528 178.09978 182.78427 188.10777 190.93196 196.33646 201.93895 207.54144 211.37994 216.73944 221.42393 226.10843 228.99202 231.38872 236.06871 238.9523 241.4138 247.05591 249.9395 255.34399 258.16821 263.86072 269.31921 275.01172 279.09323 283.77774 289.18225 294.87476 300.33325 306.02576 308.42245 313.10696 318.51147 320.97296 323.85657 327.02008 332.47858 336.31708 345.06958">If the stack address is in a non-canonical form.</tspan><tspan y="-585.0014" x="45.1203 52.472401 58.535698 64.681801 68.757904 73.437004 78.791107 81.247208 86.601311 91.280411 94.816513 100.26962 104.10271 137.22182 141.00272 144.16081 146.985 152.58211 158.22421 162.90332 168.59042 171.04652 176.73363 182.33073 185.21432 188.75043 194.39253 199.79523 202.61942 208.07251 210.52861 216.12572 219.00931 224.1114 229.515 231.9711 237.6582 243.0123 247.69141 250.575 256.02811 259.18622 262.06982 268.13312 274.25671 277.14032 281.81943 287.17352 289.62961 294.9837 299.66281 303.19891 308.65201 311.2341 314.50021 317.34061 322.017 325.55038 330.94678 335.62317 340.93857 343.82217 349.41656 354.86697 357.32037 363.00476 366.53815 371.88956 374.47168 377.71347 380.59708 386.27249 391.43491 396.4353 402.5787 409.54111 415.6044 418.8678 421.69202 427.96143 434.10483 436.98843 441.66483 447.01624 449.46964 454.82104 459.49744 463.03082 468.48123 471.06335 474.32675 477.21036 482.66077 485.81616 488.97156 493.64795 499.05066 502.59033 505.85373 508.73734 514.13824 517.98035 520.86395 526.21533 530.04572 533.8761 539.32648 543.15686">#SS(selector)If pushing the old values of SS selector, stack pointer, EFLAGS, CS selector, offset, or error </tspan><tspan y="-574.02142" x="136.92032 141.60211 147.05791 152.65771 158.01451 160.8981 166.3539 171.996 175.53481 180.9906 183.87419 187.41299 193.1028 198.45959 201.28378 205.96558 209.50438 214.90617 219.58797 224.90877 227.79236 233.11316 235.57196 241.02776 243.48656 248.88835 252.42715 257.78397 262.46576 265.34937 268.88815 274.53024 279.93295 282.75717 287.43896 292.84076 298.53055 303.98636 309.67615 312.07285 316.81314 322.21674 324.61343 327.49704 333.09683 338.55264 344.24243 349.93222 355.53201 360.93381 364.76959 370.09039 372.91461 380.26941 385.9115 391.31421 397.01569 399.8399 405.2417 408.06592 412.80621 416.34589 421.74768 426.42947 431.75027 434.63388 439.31567 446.67047 449.12927 452.66806 457.34985 463.03964 465.86386 471.31967 476.00146 480.68326 486.37305 490.20883 494.89062">code onto the stack violates the canonical boundary when a stack switch occurs.</tspan><tspan y="-559.98145" x="45.120323 52.473324 59.196323 64.614326 68.69133 73.37133 78.726334 81.183334 86.538338 91.218338 94.755341 100.20934 104.04334 137.22275 141.00365 144.16264 146.98685 152.38684 155.27045 159.95044 165.40443 171.00244 176.35744 179.24104 183.92105 189.27605 194.87405 203.62206 208.97705 214.66505 218.20206 221.08566 226.53966 230.37366 233.19786 238.91286 244.67555 248.75255 254.35056 256.80756 260.34454 263.16873 267.84872 273.24872 275.70572 278.16272 280.98691 286.5849 291.98489 295.52188 300.87689 303.70108 306.15808 310.83807 313.72165 319.36374 324.82404 328.36102 331.2446 336.84259 340.67661 346.03162 350.71161 356.11432 361.75641 365.2934">#NP(selector)If a code segment or 64-bit call gate is not present.</tspan><tspan y="-546.00177" x="45.120323 52.481422 58.024521 64.179619 68.264717 72.95282 78.315918 80.712624 86.115318 90.803421 94.348518 99.810616 103.65272 137.31181 141.09271 144.25981 147.08401 150.62912 156.32523 161.68832 164.57193 167.03703 172.43793 177.90182 183.48183 186.30603 191.76813 194.93523 197.75943 201.30453 207.00064 212.36374 215.18794 220.88405 226.24715 233.60825 236.43245 242.68655 248.84166 254.26776 257.09198 262.45508 267.67688 272.36499 277.72809 283.09119 288.6973 293.38541 296.20963 299.75473 305.45084 310.81393 313.69754 316.16263 318.55933 327.31543 329.78052 333.32562 336.14984 341.61194 344.77905 347.60327 351.14838 356.84448 362.20758 365.0318 370.4903 376.55359 382.61688">#TS(selector)If the load of the new RSP exceeds the limit of the TSS.</tspan><tspan y="-531.96179" x="45.120323 52.475124 59.055923 137.24072 141.31952 147.03632 152.79901 156.87781 162.4776 164.9364 168.4752 171.29941 180.04921 185.505 191.1048 196.46159 199.3452 204.80099 210.4908 212.8875 218.229 222.3078 225.132 228.97321 232.09711 234.98071 240.38251 243.20671 246.36751 251.7693 255.6051 258.42929 263.11108 268.51288 270.97168 273.43048 276.25467 278.71347 283.39526 286.27884 291.87863 294.33743 298.17322 303.53003 308.21182 311.75061 314.5748 318.11359 323.5694 326.45297 331.85477 337.54456 340.36874 345.77054 351.37033 356.05212 361.45303 363.91183 369.60162 373.14041 378.49722 381.3808 386.78259 392.38239 397.98218 401.81796 407.22067 411.90247 416.58426 419.40845 421.86725 427.55704 430.38123 439.13101 444.48782 453.23761 458.69342 462.52921 467.03101">#UD(64-bit mode only) If a far call is direct to an absolute address in memory.</tspan><tspan y="-517.98212" x="137.22003 140.99733 144.15363 146.97781 150.51212 156.19742 161.54971 164.4333 169.35631 176.43571 182.70601 188.9313 191.75549 197.3949 201.237 206.58929 209.74559 212.19989 217.51619 220.39978 222.79648 227.47649 230.36008 236.04538 240.72269 246.07498 251.67029">If the LOCK prefix is used.</tspan><tspan y="-504.00241" x="45.120331 52.470631 57.930035 63.093334 67.167633 70.323936 75.721237 81.40654 83.86084 87.220543 91.299347 95.976646 101.42795 107.02325 112.42595 137.26505 141.04594 144.20224 147.02643 152.42372 155.30731 160.90262 166.29991 171.89522 177.29791 180.1221 183.2784 188.67569 194.36099 196.81529 200.34959 203.23318 208.68448 213.36179 218.03909 223.7244 227.55569 232.233">#PF(fault-code)If a page fault occurs.</tspan><tspan y="-489.9624" x="45.120331 52.470631 58.614929 64.885231 68.959534 74.722237 137.24164 141.01894 144.17523 146.99942 152.39671 154.85101 157.30531 162.90062 168.58592 177.33122 182.68352 188.36882 191.90312 194.72731 199.40462 205.08992 210.44221 215.11952 220.43582 222.89012 228.57542 234.17073 236.99492 239.44922 244.12653 247.01012 252.36241 258.0477 263.44501 269.04031 271.49463 276.84692 282.44223 285.32584 290.72314 296.40845 302.00375 304.88736 310.28467 315.96997 318.84003 324.53702 330.23401 335.64301 338.0397 340.49582 346.10281 351.7998 357.16382 362.77081 365.595 374.35199 379.716 388.47299 393.936 397.77899 403.10699 405.93118 409.77417 415.13818 418.30618 423.6702 427.51318 432.8772 438.51929 443.19928 448.56329 451.38748 453.85349 458.54248 461.36667 470.12366 475.53265 481.13965 486.50366 489.32785 496.68985 502.38684 504.78354 507.23965 512.60364 515.48724 519.03326 524.73029 530.0943">#AC(0)If alignment checking is enabled and an unaligned memory reference is made while the </tspan><tspan y="-478.98239" x="136.92032 141.59492 147.27753 151.10612 154.93472 160.33742 166.02002 169.55162 172.43521 178.02782 181.85641 184.30801 189.62161 192.01831 194.47441 199.82401 205.41661 210.7662 213.59039 216.04199 221.39159 226.70518 232.05478 234.50638 237.33057 239.78217 244.45677 247.34036 253.04996">current privilege level is 3.</tspan></text></g></svg>     <hr />     <p class="not_instruction_page">         This <b>UNOFFICIAL</b> reference was generated from the official <a href="https://www.intel.com/content/www/us/en/developer/articles/technical/intel-sdm.html">Intel® 64 and IA-32 Architectures Software Developer’s Manual</a> by a dumb script.         There is no guarantee that some parts aren't mangled or broken and is distributed <b>WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE</b>.     </p> </body>  </html>
