<!DOCTYPE html> <html lang="en">  <head>     <meta charset="utf-8">     <title>IRET/IRETD/IRETQ</title>     <link rel="stylesheet" href="styles.css">     <link rel="stylesheet" href="../intel.css"> </head>  <body>     <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="512.66351pt" height="633.96832pt" viewBox="0 0 512.66351 633.96832" sodipodi:docname="632.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.95133" inkscape:cy="409.13485" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg220" /><g transform="translate(-45.036499,-68.882812)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="12" class="cA49CCA52 cD0BE81C2 c209E837B"><tspan y="-714" x="45.119999 48.298798 55.676399 62.334 68.331596 72.89399 76.13279 83.518791 90.176392 97.013985 104.81519 109.37759 112.55639 119.94239 126.65999 133.13759 141.2952 151.0152 154.254 160.884 165.6852 172.40401 176.78641 181.10881 188.00641 194.54642 199.34761 202.34761 209.73361 216.27242 221.07361 227.91121 232.29361">IRET/IRETD/IRETQ—Interrupt Return</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-607.32001" x="235.2 237.83939 243.59726 248.27646 252.23755 255.89984 261.59796 266.17657 270.18747 272.64758 278.28693 283.98505 286.50494 293.15524 298.73483 304.34927 307.8313 313.1091 318.867 324.50137 326.96152 332.53613 338.29004 342.66946 348.28391 353.86349 356.39035 362.08847">Instruction Operand Encoding</tspan><tspan y="-551.33984" x="45.120377 51.602345 57.207832 61.986641 66.486572 70.1399 72.657791 78.117867 82.078964 84.596855 90.202347">Description</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-535.97998" x="45.119999 51.117599 56.520302 60.061802 65.703903 69.542404 75.234901 79.919403 82.503304 88.105804 91.944305 97.402809 103.00531 106.66741 112.07101 120.82352 123.34711 128.03162 133.49011 139.18262 142.72412 146.56262 152.02112 154.48262 157.00621 160.16971 164.00821 169.46671 178.21921 180.8031 186.2076 191.8497 194.43359 199.79309 205.01489 209.69939 215.05888 220.66138 224.20288 226.66438 232.12288 237.76498 240.34888 245.74977 249.59187 252.17577 254.57246 260.27396 263.81546 269.21817 273.05667 276.83847 282.53098 288.13348 291.67499 294.19861 299.89111 305.22 310.91071 316.51141 318.9711 324.3288 328.1655 330.68912 334.22882 339.68552 342.20914 347.61185 350.19577 355.79648 359.63318 365.08987 370.69058 374.35269 379.75629 388.50699 391.03061 396.4873 400.32401 402.84763 408.44833 412.28503 417.74173 422.42444 427.78214 433.38284 439.07355 442.91025 448.26794 450.85187 454.39157 460.03366 465.43637 469.03638 471.56 478.81671 484.22031 488.90302 491.42664 493.88632 499.57703 503.11673 508.47443 512.3111 516.14777 521.83844 527.43915 530.97882 536.33655 541.93726 544.46082 550.06152 555.38324">Returns program control from an exception or interrupt handler to a program or procedure that was interrupted by </tspan><tspan y="-525" x="45.119995 50.520897 56.209797 58.793697 64.149597 69.469498 74.150398 79.506302 85.105202 88.643105 91.101006 96.555908 102.24481 105.51271 108.15691 113.55781 119.24671 121.8306 127.18651 132.50641 136.04431 141.40021 145.18201 150.88351 156.28441 158.74231 161.38651 163.7832 169.48471 173.02261 178.37851 182.21341 186.04831 191.73721 197.33612 200.87402 204.14192 206.78612 212.24101 216.02281 218.66701 224.0679 226.7121 231.39301 236.8479 240.0078 243.5457 250.8024 256.20599 260.04089 265.39679 269.4747 275.07361 280.3566 286.05811 291.414 295.07611 300.41943 303.89969 309.24298 314.82928 317.41321 319.80991 325.51141 329.03671 334.3197 338.142 341.96429 347.64059 353.2269 356.7522 360.00751 362.59143 368.11475 373.79105 379.13434 383.80264 389.14594 391.72986 394.12567 399.82718 404.49548 408.02078 411.84308 417.51938 422.18768 425.71298 428.10968 433.51056 439.18686 443.81998 446.40387 451.78946 455.60907 460.94968 463.53357 468.91916 471.31586 475.98145 481.42105 484.06525 489.73886 494.40445 499.74506 505.32864 507.91254 511.43515 516.87476 519.45862 525.04224 530.38281 534.20239 537.34698 542.78656 546.60614 555.33972">an exception, an external interrupt, or a software-generated interrupt. These instructions are also used to perform </tspan><tspan y="-513.95972" x="45.119995 50.463295 53.346897 57.1287 62.4711 66.0009 71.643005 75.469803 81.111908 83.936111 87.087914 90.869713 96.316513 105.05731 107.88152 113.27431 116.09852 121.77932 127.06232 131.73512 135.26492 140.61272 146.20352 149.02771 152.50711 157.91072 162.58353 167.89532 171.15512 173.97931 178.0491 184.1889 187.01309 192.69389 198.04169 202.66139 206.2011 211.54889 217.13969 219.96388 223.44328 228.84689 233.5197 238.8315 241.65569 244.10548 248.72519 251.54938 256.22217 260.04898 265.39679 270.74008 274.26987 279.61768 285.20847 288.03265 295.37845 301.02054 306.36835 311.94031 314.76453 320.16003 322.98425 329.25275 335.39523 340.39474 345.39426 348.21848 350.67099 356.31308 360.98859 364.46799 368.29749 373.93958 378.61508 382.14758 384.54431 390.00461 395.6467 398.47092 400.92343 405.54315 408.36737 414.05087 418.67059 424.02109 429.61459 432.43881 435.97131 441.42081 444.24503 446.64175 452.34326 454.73999 458.27969 460.67642 466.08002 469.55942 474.90182 477.72604 483.12155 485.94577 489.47827 494.82159 499.4971 504.81161 507.63583 512.31134 519.65985 522.11237 525.59174 530.26721 535.9093 538.79285 544.19379 548.03589">a return from a nested task. (A nested task is created when a CALL instruction is used to initiate a task switch or </tspan><tspan y="-502.97971" x="45.119995 52.424397 58.063797 63.406197 69.107697 71.931892 77.335495 82.9776 85.801796 88.257896 93.899994 97.439697 102.7821 106.5675 110.4096 116.049 121.5984 125.1381 127.9623 133.36771 137.20981 140.03401 145.3764 150.59821 155.2782 160.56119 166.1106 169.6503 172.0587 177.519 183.1584 186.04201 190.6734 196.077 201.7164 206.39639 211.73878 216.41878 219.24298 224.59438 227.41858 230.95828 236.36188 240.99327 246.33478 249.15898 253.79037 261.16678 263.57516 267.11487 271.74628 277.44778 280.272 283.81171 289.21262 292.03683 297.44043 303.08252 305.90674 308.36282 314.00491 317.54462 322.88702 326.67242 330.51453 336.15393 341.70334 345.24304 348.06726 353.52756 357.30936 360.13358 365.47598 370.69775 375.37778 380.72018 386.26959 389.758 392.21408 397.61499 403.3165 406.14072 411.78012 417.18372 422.82312 428.37253 430.82861 436.17102 438.69281 441.93463 446.01346 448.83768 454.93607 460.27847 465.62088 468.4451 471.9335 477.63501 482.97742 485.80164 490.48166 495.82407 500.45547 503.99518 506.40356 511.86386 517.50323 520.32745 523.86713 526.26379 529.80347 532.20013 537.54254 543.1225">when an interrupt or exception causes a task switch to an interrupt or exception handler.) See the section titled </tspan><tspan y="-491.99969" x="45.119995 49.199696 53.697899 59.055599 63.7356 69.012299 71.836494 76.798195 79.254295 84.899994 90.241493 92.656197 98.301895 103.8576 107.9976 110.8218 113.2365 118.938 121.7622 127.9929 133.6386 139.04219 144.62219 148.1619 153.50429 157.29599 160.12019 165.82259 168.64679 174.10709 177.23099 180.05519 183.59489 189.237 194.57939">“Task Linking” in Chapter 7 of the </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-491.99969" x="197.33969 201.11969 206.80769 210.3447 215.74739 218.20439 227.14409 230.02768 235.74268 241.45767 244.34126 249.74126 255.42926 261.02725 263.91086 267.69086 273.82886 277.90585 283.62085 289.33585 292.21945 298.35745 302.19147 306.87146 312.55945 315.01645 318.55344 323.90845 328.58844 332.12543 337.81342 341.64743 347.05014 351.73013 354.55435 360.70135 366.15536 369.31436 372.85135 380.20435 385.60434 389.43835 394.79337 397.61758 404.50259 409.8576 415.1676 420.52261 422.97961 428.43362 434.03162 439.38663 443.22064 445.63263 450.31262 453.19623 460.77423 466.17422 471.86221 477.5502 482.9502 485.4072 488.67419 491.5578 497.6958 503.14981 505.60681 511.2948 519.99329 525.396 528.22021 533.93524">Intel® 64 and IA-32 Architectures Software Developer’s Manual, Volume 3A</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-491.99969" x="540.05969">.</tspan><tspan y="-475.97971" x="45.119995 48.903595 55.153194 60.835796 66.374397 69.198593 74.602196 80.293793 85.895393 88.719589 92.503189 98.752792 104.43539 109.974 116.9076 119.7318 125.1354 128.97299 134.33159 137.21519 145.9668 151.6089 157.0116 165.7146 171.1722 176.8638 179.3244 184.008 188.69159 191.51579 194.67839 200.13599 203.97359 206.85719 210.3978 216.0399 221.4426 224.2668 228.95039 234.35399 243.10559 248.46419 251.34779 256.80539 262.40698 267.09058 272.54819 278.14978 283.55249 286.82309 289.64728 295.18588 300.87747 306.23608 309.06027 312.84387 319.01968 324.70407 330.24448 337.17987 340.00406 348.75745 354.45084 359.81125 368.56464 374.02405 379.71744 382.11414 386.85443 389.67862 393.76102 396.22342 401.91681 405.4592 410.81961 414.659 418.49838 424.19177 429.79517 433.33755 436.16174 440.00113 445.36154 448.90393 454.54602 458.38541 464.0788 466.96237 472.56577 478.02518 483.71857 489.32196 491.78436 497.14478 501.22717 504.11075 506.50745 511.18744 514.07104 516.53345 522.1756 525.71802 531.07843 536.77185 542.37524 547.73566 553.33905">IRET and IRETD are mnemonics for the same opcode. The IRETD mnemonic (interrupt return double) is intended </tspan><tspan y="-464.99969" x="45.119995 48.284393 53.685295 57.524696 60.408295 66.101692 70.787094 76.147491 79.03109 86.389488 92.082886 97.443283 103.13668 105.96088 109.80028 115.16068 118.70307 124.39647 128.17827 133.87978 136.34218 142.03558 147.63898 150.52258 153.68698 157.52638 162.98578 171.73918 174.56339 179.96878 185.66219 188.54579 191.00819 196.6503 200.1927 205.5531 209.3925 213.2319 218.87401 224.4774 228.01981 230.84401 238.20241 243.89581 249.25621 254.94962 257.7738 263.46719 268.15259 270.61499 276.30838 281.91177 284.73596 288.27835 293.94031 299.28632 302.16992 307.87592 313.58191 317.6499 323.28931 325.686 329.28601 332.11023 337.55524 343.14423 348.49023 352.21265 357.60364 363.28262 368.87161 371.69583 376.36682 378.81482 383.52182 388.86783 392.93582 395.81943 401.49841 406.94342 414.28741 419.63342 424.94342 430.28943 432.87155 436.11334 438.99695 447.73596 453.18097 457.85196 461.37997 464.26358 469.65457 474.32556 478.99655 484.34256 493.08157 498.67056 501.11856 506.46457 510.28958 514.96057 517.84418 523.52319 528.26349 533.6095 536.43372 539.96173 545.64075 550.98676">for use when returning from an interrupt when using the 32-bit operand size; however, most assemblers use the </tspan><tspan y="-453.95938" x="45.12001 48.90451 55.15501 60.838509 66.378006 69.202202 77.954704 83.647202 89.006699 97.759201 103.2177 108.9102 111.3717 116.05621 118.8804 121.3419 127.0344 130.5759 135.93539 139.7739 144.45839 150.15089 155.55539 161.24789 166.85039 172.20988 177.61438 183.21687 185.61357 190.93707 193.76128 196.92477 202.38327 206.22177 209.04597 214.64847 220.10696 223.64847 229.34097 232.16518 237.62367 243.22617 248.62886 252.29095 257.69547 263.38797 268.99048 271.8147 276.49921 278.96069 283.68118 289.04068 293.72519">IRET mnemonic interchangeably for both operand sizes.</tspan><tspan y="-437.99969" x="45.12001 48.90451 54.597012 57.300613 63.357613 68.700012 74.104515 76.566017 80.405411 86.58931 92.191811 97.794312 101.63281 107.03551 111.72001 116.40451 119.10811 126.69061 132.14911 137.7516 143.1111 146.3826 149.0862 152.6277 158.32021 163.6797 166.4436 170.2281 176.47861 182.16211 187.70161 190.40521 192.86671 198.55922 203.24371 206.78522 210.62372 216.31622 221.00072 224.54222 227.00372 232.40462 238.09712 240.86102 246.46352 251.82301 255.66151 258.82501 264.28351 268.12201 276.87451 281.55902 284.26263 289.66714 292.43106 295.59457 300.99908 304.83759 307.44031 311.27789 316.63651 320.17709 325.86868 329.70627 335.39786 338.10144 341.64203 347.09964 349.86353 353.40411 359.0957 364.45432 367.2182 369.6149 375.31638 378.85696 384.21558 388.05316 391.89075 397.58234 403.18393 406.78391 412.14252 417.74411 420.508 426.10959 429.94717 435.40479 441.00638 444.66846 450.07205 458.82364 461.58752 467.04514 470.88272 473.5863 479.1879 483.02548 488.48309 493.16669 498.5253 504.12689 509.81848 513.65607 519.01465 522.28528 524.98889 531.92249 537.56366 541.40125 543.86182 549.55341 555.15503">In Real-Address Mode, the IRET instruction performs a far return to the interrupted program or procedure. During </tspan><tspan y="-426.95938" x="45.119995 48.664196 54.359398 56.756096 61.4361 64.080299 69.541504 75.146706 80.508904 84.171005 89.578209 93.122406 95.586609 101.04781 106.743 110.0172 112.6614 116.2056 121.90079 127.26299 129.9072 135.51239 139.35359 144.81479 149.50198 154.86418 159.55138 164.23857 169.69977 173.54097 176.18517 181.79036 187.19125 192.79645 197.48364 200.12784 203.67204 209.31415 214.67635 217.32054 221.10234 226.50504 230.04924 235.74445 239.58565 245.22775 247.87195 250.33615 256.03134 260.71854 264.26273 268.10391 273.7991 278.4863 282.03049 284.42719 289.88751 295.5827 298.13971 303.7377 309.19171 311.64871 317.3367 320.87369 326.2287 328.81082 332.05261 334.69681 338.53082 343.88583 347.42282 353.11081 356.94482 362.63281 365.27701 369.957 375.41101 381.009 386.36401 389.00821 393.6882 399.04321 404.6412 413.38919 418.7442 424.43219 427.96918 430.55307 435.29337 440.63577 443.09277 448.44778 453.12778 456.66476 462.11877 464.64059 467.90759 470.55179 475.95178 481.63977 487.23776 489.88196 495.56094 500.78363 505.78763 511.93463 518.90063 525.04761 527.69183 530.1488 538.85181 544.25183 549.84985 555.20483">this operation, the processor pops the return instruction pointer, return code segment selector, and EFLAGS image </tspan><tspan y="-415.97937" x="45.12001 48.279011 52.11301 57.514809 66.279007 69.163506 72.700508 78.388512 83.743515 86.568611 91.248611 94.785614 100.18562 104.86562 110.18462 113.06911 116.60612 122.00792 124.89242 128.42941 134.11742 139.47241 142.3569 148.0359 151.8159 155.9568 159.19949 162.02458 168.29758 174.36179 177.62878 180.45387 185.85387 191.54187 197.13988 200.02437 205.70337 210.92697 215.93097 222.07797 229.09528 235.21977 238.10426 241.88696 247.29056 252.88857 255.34557 260.02557 263.56256 268.91757 272.75159 277.43158 280.69858 283.52368 287.3577 292.62 297.2955 302.93491 308.2854 312.96091 316.49341 318.94592 324.16772 329.51013 331.96265 336.46445 339.72696 342.61057 348.00607 353.68958 359.28308 362.16669 365.69919 371.38269 376.78537 382.42746 385.31107 389.14056 394.49106 399.16656 404.85007 413.59357 418.94406 423.61957 426.50317 431.85367 437.07547 442.42596 447.10147 452.78497 456.31747 458.76999 464.21948 469.90298 472.78659 478.23608 481.39059 484.21481 487.74731 493.43082 498.78131 501.66492 504.06165 509.76315 513.29565 518.64618 522.47571 526.30524 531.98871 537.58221 541.11469 546.5174 552.0965">from the stack to the EIP, CS, and EFLAGS registers, respectively, and then resumes execution of the interrupted </tspan><tspan y="-404.99936" x="45.119995 50.722496 54.560997 60.019497 65.621994 69.344398 74.748001 83.451004 86.334602 91.793106 95.631607 98.455803 104.0583 107.8968 113.29771 117.97771 123.3372 128.9397 134.6322 138.4707 143.8302">program or procedure.</tspan><tspan y="-388.97937" x="45.119995 48.904495 54.596996 57.241199 62.6637 66.502197 71.960701 75.502205 80.861702 85.546204 89.087708 94.447205 100.04971 102.6939 110.2764 115.7349 121.3374 126.6969 129.9684 132.672 136.2135 141.85561 147.2151 149.8593 155.26379 159.94829 163.48979 165.95129 171.40979 177.0519 179.69609 185.15459 188.31808 190.96228 194.50378 200.19629 205.55579 208.19998 211.98448 218.28178 223.96529 229.50479 232.14899 234.54568 240.24719 244.93169 248.47319 252.31169 258.00418 262.68869 266.23019 268.69168 274.15018 279.84268 282.48691 288.08942 293.44891 299.05142 304.31998 310.00888 315.60779 320.2887 322.93292 328.38782 334.07672 336.72095 340.25885 345.94775 351.30365 353.94788 358.62878 363.98468 367.52258 371.06049 373.45718 379.14609 384.745 389.48529 392.12952 397.58441 400.74432 403.38855 406.92645 412.61536 417.97125 420.67487 427.39877 432.90027 435.54449 439.62961 445.32571 450.68881 455.37692 458.92203 464.28513 469.89124 472.53546 476.08057 481.48868 486.17679 491.50388 495.58899 498.23322 503.64133 509.33743 514.94354 517.58777 523.74286 531.32898 533.97321 537.14032 539.53613 544.94421 550.55029 555.2384">In Protected Mode, the action of the IRET instruction depends on the settings of the NT (nested task) and VM flags </tspan><tspan y="-377.99936" x="45.119965 47.573364 53.257763 55.901962 59.435364 65.119766 70.471169 73.055069 78.730469 83.892868 88.893265 95.077164 102.03957 108.18297 110.82717 114.65757 120.00897 125.60337 128.05678 132.73318 136.26659 141.61798 145.44838 148.09258 153.48897 159.17337 164.76778 167.35167 170.88507 176.56947 181.92087 184.56506 190.70847 198.33057 200.91446 204.06985 206.46655 211.86295 217.50235 220.08624 222.53964 228.22404 230.80794 234.34134 240.02574 245.37714 247.96103 253.63643 258.79883 263.84244 269.96603 276.92844 283.11234 285.69623 288.14963 296.87967 302.28418 307.88669 313.24619 315.83011 320.5704 324.11011 329.51102 333.35312 338.71262 344.31512 346.89905 352.35754 358.05005 360.63397 364.17548 369.86798 375.22748 377.8114 382.49591 388.18842 392.02692 395.86542 401.22491 406.91742 410.45892 413.04285 417.72736 421.26886 426.67337 431.35788 436.68137 439.95288 442.5368 449.47131 454.83081 460.43332 465.79282 471.48532 477.08783 479.54932 485.24182 490.84433 493.48856 498.94705 504.58914 507.23337 510.77487 516.46735 521.82684 524.41077 529.09528 534.45477 537.99628 541.53778 543.93445 549.62695 555.22943">in the EFLAGS register and the VM flag in the EFLAGS image stored on the current stack. Depending on the setting </tspan><tspan y="-366.95905" x="45.119965 50.570366 53.725765 56.609364 60.142765 65.827164 71.178566 75.854965 81.206367 84.089973 87.245377 89.642075 95.038475 100.67787 105.35427 108.61767 111.50127 115.03468 120.71908 126.07048 128.89467 134.53407 138.37617 143.82657 148.56688 153.91827 158.59468 163.27109 168.72148 172.55188 175.37607 181.01547 186.35786 190.18826 193.34366 198.79405 202.62445 211.36885 216.04526 218.88026 222.42357 228.11787 233.47917 236.30338 239.46867 244.92897 247.39227 249.78897 255.24927 262.60858 265.07187 270.71399 276.3183 279.14252 282.62192 287.96341 293.56772 298.92902 303.61533 306.43954 311.89984 315.06516 317.88937 320.35266 326.04697 329.59027 334.95157 338.79187 342.63217 348.32648 353.93079 357.47409 360.3577 364.198 369.5593 373.1026 378.79691 382.63721 388.33151 393.01782">of these flags, the processor performs the following types of interrupt returns:</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-351.95999" x="45.119999">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-351.95999" x="62.099998 68.156998 73.499405 77.037308 82.726212 86.561111 92.250015 95.074211 98.234108 102.06901 107.52391 116.27281 119.15641 124.47631 126.87301 130.70792 134.24582 139.93472 145.33562 147.79352 151.87141 157.58731 163.30321 169.0659 174.7818 177.606 186.3549 191.8098 197.40871 202.8114">Return from virtual-8086 mode.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-336.95999" x="45.119999">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-336.95999" x="62.099998 68.156998 73.499397 77.044495 82.740593 86.582695 92.278793 95.102989 98.648087 104.11018 106.93438 112.26148 114.72659 118.56869 122.11378 127.80988 133.21799 135.61469 139.69348 145.41658 151.13968 156.86278 162.58588 165.41008 174.16618 179.62828 185.23438 190.59747">Return to virtual-8086 mode.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-321.95999" x="45.119999">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-321.95999" x="62.099998 65.882698 71.573395 75.113098 78.7752 84.177902 88.257599 93.858299 97.695 100.0917 105.4332 107.8929 110.3526 115.7103 121.311 126.6687 129.55229 132.01199 137.36969 142.59149 147.99419 150.39088 153.27448 157.11118 162.46887 166.00858 171.69928 175.53598 181.22668">Intra-privilege level return.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-306.95999" x="45.119999">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-306.95999" x="62.099998 65.879097 71.5662 75.102303 80.456406 84.238205 88.317009 93.914108 97.747208 100.20331 105.52141 107.91811 110.37421 115.72831 121.32541 126.67951 129.50372 131.95982 137.31392 142.63202 147.98611 150.44221 153.26642 157.09952 162.45361 165.98972 171.67682 175.50992 181.19702">Inter-privilege level return.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-291.95999" x="45.119999">•</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-291.95999" x="62.099998 68.157005 73.499405 77.040009 82.731606 86.569206 92.260803 95.084999 98.247597 102.0852 107.5428 116.2944 119.178 124.8696 130.2282 134.91179 138.45239 143.81099 149.4126 152.2368 155.7774 161.181 165.86459 171.18719 174.0114 178.092 181.6326 187.03619 191.71979 197.04239 199.92599 204.60959 211.96619 214.42679 217.96739 222.65099 228.34259 232.42319">Return from nested task (task switch).</tspan><tspan y="-276.00031" x="45.119698 48.895199 52.049698 54.513897 58.046398 63.729897 69.080399 71.604004 78.322502 83.853004 86.37661 89.531113 91.983612 97.379112 102.97261 105.49622 109.56872 115.24322 120.40472 125.40422 131.58812 138.54422 144.68672 147.21031 151.03981 156.3903 161.98381 164.43631 169.11182 172.64432 177.99481 181.82431 185.8968 188.42039 190.81709 195.5574 198.02159 202.6971 205.1496 210.50009 215.8956 219.7251 225.07559 230.715 233.95679 236.48038 240.01288 245.69638 251.04688 253.51106 257.28656 263.52805 269.20255 274.73303 277.25665 279.70917 285.39267 290.13297 293.6394 297.47879 303.12088 307.80627 311.34866 313.81107 319.27048 324.96387 327.42807 333.03146 338.39188 342.23126 345.39566 350.85507 354.69446 363.39743 368.07742 370.60101 376.00641 378.47061 381.63501 387.04041 390.87979 393.40338 397.24277 402.60318 406.14557 411.83896 415.67834 421.32043 423.84402 427.00842 430.84781 436.30722 445.01019 447.53378 451.07617 456.76956 462.12997 464.59418 467.05658 472.74997 476.29236 481.65277 485.49216 489.33154 495.02493 500.62833 504.17072 506.69431 512.29773 516.13715 521.59656 526.28198 531.6424 537.24579 542.93921 546.77863 552.13904 555.41144">If the NT flag (EFLAGS register) is cleared, the IRET instruction performs a far return from the interrupt procedure, </tspan><tspan y="-264.95999" x="45.119705 52.475407 54.935108 58.474808 64.165504 69.622208 75.312904 78.852608 81.676804 87.079506 89.963104 93.502808 98.90551 103.58821 108.90991 111.79351 116.47621 123.83191 126.29161 129.83131 134.51401 140.20471 143.47441 146.2986 151.8363 157.52701 162.8847 165.7683 170.45099 175.90768 181.50839 186.86609 189.74968 194.43237 199.79007 205.39078 214.09378 219.45148 225.09358 228.63329 231.51688 237.11758 242.47528 244.87198 250.57349 256.17419 259.0578 262.8945 268.2522 271.7919 277.4826 281.31931 287.01001 292.36771 297.96841 300.85202 304.39172 309.71973 312.54391 321.2973 326.99069 331.67609 335.21848 338.04266 343.64606 349.00647 351.83066 357.23337 362.81335 368.50674 373.91214 376.37454 378.77124 384.09564 386.91983 392.37924 396.21863 399.1022 401.4989 406.90161 411.58701 416.2724 419.09659 424.69998 428.53937 430.93607 436.27756 438.73996 441.20236 446.56277 452.16617 457.52658 463.12997 465.95416 469.49655 475.18994 480.59534 486.28873 489.11292 492.6553 498.34869 503.70911 506.59268 509.05508 514.74847 518.29089 523.6936 527.53302 531.37244 537.06586 542.66925 546.21167">without a task switch. The code segment being returned to must be equally or less privileged than the interrupt </tspan><tspan y="-253.98" x="45.11972 50.810421 56.21312 61.90382 67.504517 69.964218 75.321915 79.158615 81.982811 85.819511 91.276215 96.966911 100.50661 102.96632 108.65701 114.01471 116.83891 120.91861 126.32131 131.00401 133.8876 136.34731 141.98941 147.59012 149.98682 154.72711 160.13071 163.67041 169.02811 174.62881 177.51241 183.1131 188.3952 191.27879 194.8185 200.5092 205.8669 208.69109 214.93979 220.36049 225.36719 228.25078 231.37468 233.83078 239.18848 241.64818 247.24887 250.07306 255.52975 258.69147 261.47974 265.01492 270.70111 276.05432 278.93793 283.61612 289.06833 294.66452 300.01773 302.90134 307.57953 312.93274 318.52893 327.27515 332.62836 338.31454 341.84973 344.73334 349.41153 354.76474 357.21994 362.57315 367.25134 370.78653 376.23874 380.07095 382.89517 388.49136 393.94357 399.53976 405.13596 410.53867 416.13486 418.95908 422.11627 425.94849 431.4007 440.14691 442.97113 446.50632 452.1925 457.54572 460.42932 465.10751 468.6427 474.04089 478.71909 484.03629 488.11148 491.37668">handler routine (as indicated by the RPL field of the code segment selector popped from the stack). </tspan><tspan y="-237.95999" x="45.11972 51.270321 55.953922 58.778122 66.13472 68.595322 72.135925 77.827522 80.591423 85.995026 88.758926 92.596527 97.955124 103.35873 105.75542 109.77482 115.17842 120.78002 126.38162 130.21922 135.57782 140.26141 144.94501 147.70891 156.46051 161.91811 167.51971 172.87831 175.64221 178.10281 183.79442 187.33502 192.69362 196.53122 200.36882 206.06042 211.66202 215.20262 217.96652 221.80412 227.09972 230.64122 236.33372 240.17223 245.86473 249.13623 251.90103 255.44254 261.13504 266.49454 269.25934 273.04385 279.29434 284.93103 290.50922 293.27402 295.7355 301.37759 306.0621 309.60361 313.44211 319.13461 323.81912 327.36063 329.82211 335.28061 340.97311 343.73792 349.34042 354.79892 360.40143 365.08594 367.85074 371.39224 377.08475 382.44424 385.26935 389.10785 394.46735 398.00885 403.70135 407.53986 413.18195 416.00705 418.40375 424.10526 428.78976 432.33127 436.16977 441.86227 446.54678 450.08829 452.54977 458.00827 463.70078 466.46558 472.06808 477.52658 479.98807 485.68057 489.22208 494.58157 497.16367 500.40549 503.23059 507.06909 512.42859 515.97009 521.6626 525.5011 531.1936 533.95844 538.64294 544.10144 549.70392 555.06342">As with a real-address mode interrupt return, the IRET instruction pops the return instruction pointer, return code </tspan><tspan y="-226.98" x="45.11972 49.799721 55.15472 60.75272 69.500717 74.903419 80.545525 84.082527 86.966133 91.646133 97.001137 99.458138 104.81314 109.49314 113.03014 118.48415 121.06625 124.33324 127.21685 132.61685 138.30486 143.90286 146.72705 152.40605 157.57205 162.57605 168.72305 175.68906 181.83606 184.66025 187.11725 195.86525 201.26524 206.86325 212.21825 215.10184 218.26083 222.09483 227.54883 236.29683 239.18042 242.71742 248.35953 253.76222 256.58646 261.26645 264.80344 270.20343 274.88342 280.20242 283.02664 286.56363 292.01764 294.90125 298.43823 304.12622 309.48123 312.23972 317.9187 321.6987 325.83868 329.08047 331.96405 338.23706 344.30035 347.56735 350.39154 355.79153 361.47952 367.07751 369.96109 375.64008 380.80609 385.81009 391.95709 398.9231 405.0701 407.89429 411.7283 417.13101 422.729 425.186 429.866 433.40298 438.758 442.59201 447.272 450.539 453.36319 457.1972 462.55222 467.23221 472.8302 478.18521 482.8652 486.40219 488.85919 494.08099 499.4234 501.8804 506.3822 509.6492 512.53284 517.93286 523.62085 529.21887 532.04309 535.58008 541.26807 546.67078 552.31195">segment selector, and EFLAGS image from the stack to the EIP, CS, and EFLAGS registers, respectively, and then </tspan><tspan y="-216" x="45.11972 48.959122 54.319523 59.004921 64.698318 73.451721 78.812119 83.49752 86.321716 91.682114 96.903915 102.26431 106.94971 112.64311 116.18551 118.64791 124.04881 129.74222 132.62582 138.08522 141.24962 144.13322 147.67563 153.36903 158.72943 161.55363 164.01604 169.70944 173.25185 178.61224 182.45164 186.29105 191.98445 197.58784 201.13025 206.49065 212.09404 214.91824 220.52164 224.36104 229.82043 235.31943 238.98152 244.38512 253.13852 255.96272 261.42212 265.26151 268.14511 273.7485 277.58789 283.0473 287.7327 293.09311 298.6965 304.38989 308.17169 313.5321 316.8045 319.68811 323.47351 326.63791 329.46213 333.00452 338.69791 344.05832 346.94193 350.78131 356.14172 359.68411 365.3775 369.21689 374.85898 377.74258 380.20499 384.89038 387.65973 391.19403 396.64532 399.52893 404.92624 410.61154 416.06284 419.59714 425.28244 430.63474 434.46603 437.34964 442.94495 446.77625 449.23056 454.54688 456.9436 459.39972 464.75201 470.34732 475.69962 478.52383 480.97815 486.33044 491.64676 496.99905 499.45337 502.71768 505.60129 509.13559 514.82086 520.17316 522.99738 526.77466 533.01794 538.69427 544.22656">resumes execution of the interrupted program or procedure. If the return is to another privilege level, the IRET </tspan><tspan y="-204.9597" x="45.11972 47.580322 53.222424 57.906025 61.446625 65.284225 70.975822 75.659424 79.200027 81.660629 87.118233 92.80983 95.513428 100.91703 103.37763 108.06123 113.51884 116.22243 121.82404 127.28164 132.88324 137.56683 140.27043 143.81104 149.50264 154.86124 157.56483 162.24843 165.78903 171.19263 175.87622 181.19882 183.90242 189.50403 194.96162 197.42223 203.11383 206.65443 212.01303 215.85063 218.55423 223.95782 229.64943 235.25104 238.01494 244.01884 250.20274 252.90634 256.06894 259.90652 265.36414 274.11572 276.81931 280.35989 286.05148 291.4101 294.11368 298.79727 302.33786 307.74146 312.35944 317.68292 320.95444 323.71835 329.32086 334.68036 337.84387 343.30237 347.14087 352.50037 355.20398 359.04248 364.40198 369.14227 374.78436 383.53687 385.99835 391.69086 397.29337 399.99698 405.59949 409.43799 414.89648 420.49899 424.1611 429.56473 438.31723 441.02084 446.38034 451.60211 456.96161 461.64612 467.33862 470.88013 473.34161 478.80011 484.49261 487.76413 490.46774 494.30896 497.43286 500.13647 503.67798 509.37048 514.72998 517.43359 521.27209 526.63159 530.1731 535.8656 539.7041 545.39661 548.10022 550.56171 555.24622">instruction also pops the stack pointer and SS from the stack, before resuming program execution. If the return is </tspan><tspan y="-193.97971" x="45.11972 48.655819 54.108917 56.933117 62.251217 64.707314 68.540413 72.076515 77.763618 83.227516 85.624214 89.703018 95.465721 101.17982 106.89393 112.60803 115.49163 124.23873 129.69183 135.33124 140.67363 143.97572 146.79993 150.33603 156.02313 161.37723 164.26083 169.85794 173.69104 179.14413 183.82324 189.17734 193.85645 198.53555 203.98865 207.82175 210.70535 216.10445 218.50114 223.18024 228.63333 231.51694 237.11404 242.56714 248.16425 252.84335 255.72697 259.26306 264.95016 270.30426 273.12848 278.76788 284.17148 287.70758 293.10669 295.93091 300.61002 306.01273 311.60983 320.35693 325.71103 331.39813 334.93423 337.75845 341.59155 346.99426 352.59137 355.04745 359.72656 363.26266 368.61676 372.44986 377.12897 379.95319 383.1113 386.9444 392.39749 401.14459 403.96881 407.50491 413.19202 418.54611 421.42972 426.10883 429.64493 435.04404 439.72314 445.04126">to virtual-8086 mode, the processor also pops the data segment registers from the stack.</tspan><tspan y="-177.9597" x="45.11972 48.90242 52.064121 54.888321 58.42802 64.118721 69.476425 72.360023 79.085724 84.623428 87.447624 90.609322 93.069023 98.471725 104.07243 106.95602 109.35272 114.09303 116.91722 121.59992 126.95763 130.49733 133.76703 136.59123 140.13094 145.82164 151.17934 154.06294 157.84564 164.09435 169.77605 175.31375 178.13795 180.59766 186.28836 190.97105 194.51076 198.34746 204.03816 208.72086 212.26056 214.72026 220.17696 225.81906 228.70267 234.30338 239.66107 243.49777 246.65947 252.11617 255.95287 264.70355 269.38626 272.21048 277.61319 280.4968 284.0365 289.43921 294.12192 299.4436 302.22003 306.90454 314.26205 316.65875 320.19846 324.88297 330.57547 333.45908 337.54059 341.37909 346.73859 350.28009 355.9726 359.8111 365.5036 369.58511 372.40933 375.57285 379.41135 384.86984 393.62234 396.50595 401.91046 404.73468 410.42719 415.78668 420.47119 424.0127 429.41541 434.99542 437.87903 441.42053 446.82504 451.50955 456.83304 459.71664 463.79816 469.20267 472.02689 475.56839 480.9729 485.65741 490.9809 493.80511 498.54541 503.94904 506.34573 508.80182 514.16132 519.76379 522.58801 529.9455 532.34216 535.88367 541.57617 544.45978 549.86426">If the NT flag is set, the IRET instruction performs a task switch (return) from a nested task (a task called with a </tspan><tspan y="-166.97971" x="45.11972 51.398121 57.550522 62.559921 67.569321 70.394417 72.856819 78.550217 83.235619 86.778015 90.617416 96.310814 100.99622 104.53861 106.93532 112.39561 118.08901 121.36141 124.18651 129.5919 135.28531 138.11041 140.57281 146.26622 149.80862 155.16902 159.00842 162.84782 168.54123 174.14462 177.68703 180.95943 183.78453 189.24393 193.08333 195.96783 201.37323 207.06664 209.89174 215.25214 220.47394 225.21423 230.55663 236.16002 239.70242 242.16483 247.62422 253.31763 257.40002 260.22513 265.82852 271.23392 275.97421 281.25632 284.14081 287.6832 293.04001 295.86423 299.40393 305.09464 310.45233 313.33594 318.01865 323.42136 325.81805 328.27774 330.73743 336.42813 342.02884 344.91245 350.31335 354.15546 357.03906 359.49875 365.14084 368.68054 374.03824 377.87494 381.71164 387.35373 392.95444 396.49414 401.85184 407.45255 410.33615 413.87585 419.27856 423.96127 429.28296 432.55267 435.43628 440.97397 446.66467 452.02237 454.84659 460.53729 466.138 471.73871 477.14142 480.68112 486.03882 491.63953 494.46375 499.14645 502.68616 508.08887 511.62857 516.98627 519.86987 525.3266 528.48828 531.3125 534.85217 540.54285 545.90057">CALL instruction, an interrupt, or an exception) back to the calling or interrupted task. The updated state of the </tspan><tspan y="-155.99971" x="45.11972 48.656719 54.056721 58.736721 64.055725 66.51992 71.874924 77.096725 82.499428 87.179428 92.867432 96.404434 98.861435 104.54944 110.14744 112.67104 116.20805 121.89605 127.25105 129.71526 133.49525 139.79256 145.47156 151.00656 153.47076 155.92776 161.61577 166.29578 169.83278 173.66678 179.35478 184.03479 187.57179 190.02879 195.48279 201.17079 203.63499 206.092 210.772 213.29561 217.97562 223.31891 228.54071 233.8831 239.48111 241.94531 244.40231 250.09032 252.55452 255.01152 258.54852 263.22852 265.69272 271.22772 277.29102 283.35431 286.5961 289.11969 292.89969 296.05869 298.58228 302.11926 307.73972 313.10193 315.56613 319.11032 324.51752 329.25781 334.53992 337.06351 339.46021 344.1402 346.66379 350.50497 355.86719 359.95139 365.3136 371.00879 374.55298 379.91519 383.75638 389.11859 394.72379 397.24738 399.64407 405.04767 408.59186 413.95407 416.47586 419.77795 422.24216 425.78635 431.48154 436.84375 439.30795 443.99515 449.45636 455.06155 460.42377 462.88797 466.43216 472.12735 477.53455 481.07874 483.54294 486.70914 492.17035 494.63455 497.09875 502.55997 509.92017 514.60736 517.13092 520.67511 526.3172 531.67938 534.14355 537.93073 544.1839 549.87012 555.41229">task executing the IRET instruction is saved in its TSS. If the task is re-entered later, the code that follows the IRET </tspan><tspan y="-144.95941" x="45.11972 47.574921 53.26112 57.93932 61.474522 65.306725 70.992928 75.671127 79.206329 81.66153 87.113731 92.799934 95.624138 98.079338 102.75754 105.64114 110.99435 116.21615 121.56935 126.24755 131.93375 135.46895 140.82214 146.41835">instruction is executed.</tspan><tspan y="-128.99971" x="45.11972 48.904221 52.067722 54.891926 58.433426 64.125923 69.48542 72.369019 79.096519 84.636017 87.460213 90.623711 93.085213 98.489716 104.09222 106.97581 109.37252 114.11282 116.93702 121.62152 126.98102 130.52252 133.40613 138.81062 144.50313 150.10562 152.92982 156.47133 162.16383 167.52333 170.34753 175.95003 179.78853 185.24702 189.93152 195.29102 199.97551 204.66 210.1185 213.9003 216.78391 219.24541 223.9299 226.7541 229.21561 234.90811 237.73232 241.51682 247.46042 251.54192 257.26141 262.98093 268.34042 271.16464 279.91714 285.30005 290.89444 296.29715 299.56055 302.44412 305.97751 311.6619 317.01331 319.83749 323.61389 329.85629 335.53171 341.06311 343.94669 346.40009 352.08447 356.76086 360.29425 364.12466 369.80905 374.48544 378.01883 380.47223 385.92264 391.60703 394.43121 399.1076 404.504 410.18839 414.86478 420.21619 424.95648 427.78067 433.17706 436.00125 441.64066 446.98306 452.66745 458.01886 461.68097 467.08456 469.53796 472.42154 478.01593 481.84634 487.29675 490.83014 496.18155 500.85794 504.39133 506.84473 512.2951 517.97949 520.80371 526.15509 531.47052 536.14691 541.49829 547.09271">If the NT flag is set and the processor is in IA-32e mode, the IRET instruction causes a general protection excep-</tspan><tspan y="-117.95941" x="45.119736 48.660336 51.120937 56.578537 62.220638">tion.</tspan><tspan y="-101.99971" x="45.119736 48.899734 52.058735 54.882935 60.570934 66.024933 71.712936 80.460938 85.860939 90.540939 95.85994 101.25994 106.89934 109.29604 114.69874 117.52294 119.97994 125.66795 129.20494 134.55994 138.39394 142.22794 147.91594 153.51395 157.05095 161.73096 164.55516 168.63216 175.41187 182.98987 186.76987 191.44986 195.52686 198.35106 203.75105 207.58505 212.98775 215.81195 221.40996 223.86696 229.32095 234.00095 239.22275 244.62544 250.22345 253.04765 257.12466 261.80466 267.20737 272.54977 275.33972 281.48761 286.84351 291.52441 295.06232 297.5202 302.9751 308.664 311.48822 317.20413 320.47205 326.18796 329.45587 335.17178 338.4397 341.26392 345.38681 352.13773 357.53864 363.22754 368.82645 371.28433 373.74222 379.43112 385.03003 387.91364 395.49252 401.18143 403.57721 407.11691 409.5748 415.17371 417.63159 422.98749 425.87109 432.595 440.17389 443.9548 448.63571 452.75861 455.64221 458.03891 463.74042 466.62402 470.16193 475.85083 481.25354">If nonmaskable interrupts (NMIs) are blocked (see Section 6.7.1, “Handling Multiple NMIs” in the </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-101.99971" x="484.02002 487.79642 493.4808 497.01419 502.3656 504.819 513.8064 516.69 522.40143 528.11285 530.99646 536.39288 542.07727 547.67169">Intel® 64 and </tspan><tspan y="-90.959412" x="45.11972 48.896122 55.030521 59.10392 64.815323 70.578026 73.402229 79.586128 83.367928 88.108231 93.750336 96.203735 99.737137 105.13984 109.81984 113.35324 119.03764 122.86804 128.21944 132.89584 135.72003 141.86343 147.31383 150.46922 154.00262 161.35202 166.74841 170.57881 175.93021 178.8138 185.69519 191.09789 196.40428 201.80698 204.26038 209.71077 215.30518 220.65657 224.48697 226.89537 231.57178 234.45537 242.02977 247.42616 253.11057 258.79495 264.19135 266.64474 269.90814 272.79175 278.92615 284.37656 286.82996 292.51434 301.25873 306.61014 309.43436 315.19705">IA-32 Architectures Software Developer’s Manual, Volume 3A</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-90.959412" x="321.30002 325.38062 328.65121 331.4754 336.83401 342.05582 347.41443 352.15472 357.79681 361.33652 363.79712 369.25473 374.94632 377.77051 383.22812 386.39072 389.2149 392.75549 398.44708 403.84979 406.67398 410.45758 416.70718 422.38977 427.92838 430.81195 433.20865 438.91013 443.59372 447.13431 450.97189 456.66348 461.34708 464.88766 467.34827 472.80588 478.49747 481.32166 487.01324 492.70483 498.30643 500.76703 506.22464 510.90823 516.23083 520.91443 523.79803 530.52466 538.10626 541.88989 546.57349 549.84412">), execution of the IRET instruction unblocks NMIs. </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-700.97943" x="48.779999 54.762299 59.826599 63.845997 68.825699 73.889999 146.96912 149.37842 154.55072 158.75012 162.35103 165.63333 170.80563 174.88535 178.48625 180.70656 185.74565 258.46387 264.46326 269.52756 272.97186">OpcodeInstructionOp/ </tspan><tspan y="-691.0191" x="258.47998 263.45877">En</tspan><tspan y="-700.97943" x="283.25967 288.77579 294.2919 297.05402 302.72311 305.00284 308.57495">64-Bit </tspan><tspan y="-691.0191" x="283.25967 290.17258 295.19547 300.23636">Mode</tspan><tspan y="-700.97943" x="331.25937 336.22556 341.20523 348.70044 353.74042 358.56262 362.17883">Compat/</tspan><tspan y="-691.0191" x="331.25937 335.69998 340.73907 345.77905 347.99936 354.95905 359.93872 365.039">Leg Mode</tspan><tspan y="-700.97943" x="377.99905 383.83286 388.87466 393.16946 397.27527 400.55307 402.80487 407.66489 411.26578 413.51758 418.55939">Description</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-676.01971" x="48.779022 53.512123 146.99333 149.09843 154.53354 159.26663 258.50513 263.48395 283.28214 288.92334 293.42245 295.35657 297.27805 331.29715 336.99866 341.43835 343.35986 345.32095 378.02066 380.12576 384.91287 388.29596 392.97684 396.25192 399.52701 404.31412 408.93381 412.31689 414.53632 417.8114 422.45901 425.82773 430.60043 433.86115 438.63385 440.85324 443.43893 448.69763 453.95633 456.78503 461.44073 463.38742 466.80743 469.01871 473.7113 478.39041 483.07401 486.3761 490.81671 495.61911 500.24872 502.46814 506.49023 508.47202 512.60663 517.34692 519.90649">CFIRETZOValidValidInterrupt return (16-bit operand size).</tspan><tspan y="-661.01941" x="48.779022 53.512123 146.99333 149.09843 154.53354 159.26663 164.45872 258.53665 263.51547 283.31366 288.95486 293.43597 295.37009 297.29156 331.31067 336.99777 341.43747 343.37158 345.33267 378.03238 380.133 384.9201 388.30319 392.98407 396.28616 399.56125 404.34836 408.96805 412.32773 414.54715 417.82224 422.50311 425.8862 430.67331 433.94839 438.7355 440.95493 443.55502 448.82812 454.04813 456.86874 461.53885 463.46033 466.84341 469.06284 473.74374 478.42285 483.10373 486.40582 490.84552 495.64792 500.26761 502.48703 506.50912 508.47021 512.64532 517.36945 519.96954">CFIRETDZOValidValidInterrupt return (32-bit operand size).</tspan><tspan y="-646.0191" x="48.779022 54.215923 58.896824 64.567726 66.248032 73.565933 75.785339 80.970238 83.189644 87.924545 146.96545 149.07236 154.50926 159.24416 164.43805 258.51776 263.49658 283.29477 288.93597 293.41888 295.3548 297.27628 331.29538 337.15527 338.83557 343.57047 378.01077 380.11768 384.90659 388.29147 392.97235 396.24924 399.52612 404.31503 408.93475 412.31964 414.53906 417.81595 422.49683 425.88171 430.67062 433.94751 438.73642 440.95584 443.55774 448.83264 454.05264 456.87326 461.54517 463.46664 466.85153 469.07095 473.75186 478.43097 483.11185 486.41394 490.85364 495.65604 500.27576 502.49518 506.51907 508.48196 512.65887 517.38477 519.98669">REX.W + CFIRETQZOValidN.E.Interrupt return (64-bit operand size).</tspan><tspan y="-592.97943" x="55.079021 60.837223 65.456924 68.635727 73.316628 123.47903 129.17693 133.85603 138.53694 141.59874 146.09784 150.83995 155.51906 157.73846 238.31908 244.01698 248.69609 253.377 256.43881 260.9379 265.67999 270.35907 272.57846 355.97876 361.73697 366.35666 371.09695 374.15875 378.59845 383.40085 388.02054 390.23993 476.04056 481.73846 486.41754 491.09845 494.16025 498.65933 503.40143 508.08051 510.2999">Op/EnOperand 1Operand 2Operand 3Operand 4</tspan><tspan y="-577.01971" x="61.259323 66.238121 137.51633 143.33752 252.35724 258.17844 370.01782 375.89841 490.07779 495.89899">ZONANANANA</tspan></text><path transform="matrix(1,0,0,-1,0,792)" d="m 45.54,640.26 h 0.48001 v 69.48 H 45.54 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 143.76,639.72 h 0.47999 v 70.5 H 143.76 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 255.24,639.72 h 0.48002 v 70.5 H 255.24 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 280.02,639.72 h 0.48 v 70.5 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 328.02,639.72 h 0.48 v 70.5 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 374.76,639.72 h 0.48003 v 70.5 H 374.76 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 556.92,640.26 h 0.48 v 69.48 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.48,709.74 H 557.4 v 0.48 H 45.48 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.48,684.78 H 557.4 v 0.4801 H 45.48 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.48,669.78 H 557.4 v 0.4801 H 45.48 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.48,654.78 H 557.4 v 0.4801 H 45.48 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.48,639.78 H 557.4 v 0.48 H 45.48 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.24,572.22 h 0.480014 v 31.5 H 45.24 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 87.48,571.74 h 0.48001 v 32.52 H 87.48 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 198.48,571.74 h 0.48 v 32.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 317.16,571.74 h 0.48 v 32.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 433.86,571.74 h 0.47998 v 32.52 H 433.86 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 557.22,572.22 h 0.47998 v 31.5 H 557.22 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.24,603.78 H 557.7 v 0.48 H 45.24 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.24,587.76 H 557.7 v 0.48 H 45.24 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.24,571.74 H 557.7 v 0.48 H 45.24 Z" inkscape:connector-curvature="0" /></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="511.49179pt" height="648.71179pt" viewBox="0 0 511.49179 648.71179" sodipodi:docname="633.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.64" inkscape:cy="429.13327" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg224" /><g transform="translate(-46.02,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-715.97998" x="46.02 51.5532 57.239399 59.694599 64.372803 67.017006 72.703209 78.389412 83.985611 86.440811 91.893013 96.571213 101.88841 104.34361 110.02982 115.62601 118.32962 123.78182 128.46002 133.13823 138.78033 142.61253 147.29074 149.99434 155.34753 160.56934 165.97203 171.67354 174.31773 176.77293 179.93013 182.63373 186.16893 191.85513 197.20833 199.85252 202.30772 207.99393 212.67213 216.20734 220.03954 225.72574 230.40395 233.93915 236.33585 241.79614 247.48235 250.18594 254.86415 260.26236 265.90445 270.58444 275.98715 280.66714 283.31134 288.70953 291.41312 294.57031 299.9397 305.62408 308.07748 311.61087 314.87427 317.57785 321.35425 327.03864 329.68283 334.35922 340.04361 344.72 350.40439 353.04858 358.44498 361.08917 365.82947 371.23306 375.90945 381.26086 384.52426 387.22784 393.94724 401.52164 405.29803 409.97443 412.67801 418.0744 421.90482 427.25623 429.90042 435.58481 441.2692 450.01361 455.41 460.0864 465.3082 470.6506 476.245 478.94858 484.54297 489.89438 493.04977 498.50018 502.3306 507.68201 510.38559 513.91901 519.56018 524.96283 527.60706 532.95844 538.27386 542.95026 548.30164 553.89606">This unblocking occurs even if the instruction causes a fault. In such a case, NMIs are unmasked before the excep-</tspan><tspan y="-705" x="46.019989 49.562389 52.024788 57.42569 63.12719 66.010788 71.704185 77.109589 82.802986 88.406387 90.803093 96.205788 100.04519 102.86938 105.33179 110.01719 112.84138 115.30379 120.88558 126.20998 131.66939 136.89119 142.23358 147.83698">tion handler is invoked.</tspan><tspan y="-688.97998" x="46.019989 49.801788 55.491589 57.83519 63.551991 69.31469 73.393494 78.993294 81.452095 84.990898 87.334496 96.084297 101.5401 107.1399 112.4967 115.7655 118.1091 121.6479 127.33771 132.6945 135.0984 137.55721 143.19931 147.8811 151.41991 155.25571 160.94551 165.6273 169.16611 171.62491 177.0807 182.77051 184.87471 189.5565 191.9001 197.49991 202.8567 206.0175 211.4193 217.1091 219.5058 223.0446 225.4485 230.9043 236.50409 241.86089 245.58328 250.98508 254.52388 256.92056 262.38086 268.07065 270.47455 275.15634 277.55304 282.27084 287.62766 290.03156 292.49036 297.17215 299.45999 305.16238 310.92508 313.26868 318.84869 321.30478 324.86429 329.54431 332.8338 335.1774 341.7789 346.45892 351.80133 354.14493 359.62143 362.80292 365.14651 368.70602 374.41653 379.79404 382.13763 388.37463 394.07166 400.19077 403.49286 412.37494 414.71854 420.33905 424.19556 429.53796 432.72214 435.11884 440.46033 442.86423 448.44424 452.28635 457.76285 466.53336 471.93427 475.47397 480.85147 485.53149 487.87509 493.35159 498.93161 504.30911 507.97122 513.39374 516.95325 519.40936 524.86969 530.5802 532.92383 536.48334 541.95984 544.30347 550.04095 555.74335">In 64-bit mode, the instruction’s default operation size is 32 bits. Use of the REX.W prefix promotes operation to 64 </tspan><tspan y="-678" x="46.019989 51.620689 54.080391 57.62009 62.302792 65.126991 69.206696 72.989395 79.286697 84.923401 90.461105 97.537804 101.61751 104.88721 107.7114 113.8611 119.2188 124.57649 127.46009 130.99979 136.69049 142.04819 144.87239 149.55508 155.24579 163.99649 172.74719 178.14989 181.98659 187.30829 190.19189 194.87459 200.56529 205.96799 209.80469 213.34439 216.16859 221.57129 225.11099 227.9946 231.5343 237.22501 242.5827 245.40691 251.0076 256.3653 261.966 264.42569 270.11639 275.8071 278.2038 283.8945 289.49969 292.32391 297.77881 300.93872 303.76294 307.30084 312.98975 315.44763 320.12854 322.95276 327.63367 333.03638 337.71729 341.25519 343.65189 349.11218 354.80109 357.68469 360.8446 366.2995 370.1344 373.01801 378.3739 384.06281 388.74371 394.19861 399.79752 402.2554 407.94431 413.54321 416.36743 421.96634 427.36725 430.90515 436.30606 439.13028 444.53119 450.22009 455.819 458.70261 461.16049 463.55719 472.30609 474.76398 478.30188 482.98279 486.2507">bits (IRETQ). See the summary chart at the beginning of this section for encoding data and limits. </tspan><tspan y="-661.97998" x="46.019989 52.01759 57.420292 60.584694 65.945091 69.784492 72.608688 76.151085 81.610489 84.434685 90.713081 96.406479 101.81188 107.41528 110.95768 116.31808 120.15748 123.04108 128.76147 132.03387 134.85808 138.98547 144.40887 148.24828 153.70767 158.39307 163.75346 169.35686 175.05026 178.88966 184.25006 187.07426 193.35266 198.75806 201.22046 203.58029 208.27649 211.55969 214.3839 218.1801 223.88429 227.4375 232.8087 236.5905 240.4326 246.1368 251.75099 255.3042 260.0004 263.24219 266.12576 271.54196 277.18405 282.79825 285.62244 291.31763 296.53943 301.23563 306.578 312.1922 315.74539 318.2186 323.61951 329.3237 334.0199 338.15811 341.04169 346.45789 352.09998 357.71417 360.53836 366.82758 372.48059 377.87878 383.47498 387.01016 392.36337 396.19559 399.07919 404.79239 410.50558 413.80768 416.6319 420.75211 427.02332 432.47552 438.16171 441.6969 445.52911 450.98132 453.43652 457.51172 462.67593 465.13113 470.58334 477.93454 480.81815 486.49536 492.18155 495.33875 500.79095 504.62317 509.30136 514.65454 523.40076 528.75397 534.44019 537.9754">Refer to Chapter 6, “Procedure Calls, Interrupts, and Exceptions” and Chapter 18, “Control-Flow Enforcement </tspan><tspan y="-651" x="46.020874 50.579372 55.921772 60.602673 66.291573 71.980476 77.435379 79.89328 85.348183 90.947083 96.266983 99.091179 103.16908 109.44299 115.12289 120.65879 124.73669 128.85959 131.74318 134.20108 139.84319 142.72678 146.26468 151.95358 157.30948">Technology (CET)” in the </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-651" x="160.14087 163.91637 169.59987 173.13237 178.53506 180.98756 189.97406 192.85765 198.56815 204.27864 207.16223 212.55774 218.24124 223.83475 226.65894 230.50014 236.62373 240.69623 246.40672 252.11722 255.00081 261.13431 264.96381 269.63931 275.32281 277.77533 281.30783 286.65833 291.33383 294.86633 300.54984 304.37933 309.72983 314.47012 317.29434 323.43683 328.88632 332.04083 335.57333 342.92184 348.31735 352.14685 357.49734 360.32156 367.20206 372.55255 377.85806 383.20856 385.66107 391.11057 396.70407 402.10675 405.93625 408.34375 413.01926 415.90286 423.47635 428.87186 434.55536 440.23886 445.70276 448.15887 451.42139 454.30499 460.43851 465.888 468.34052 474.02402 482.76752 488.1702 490.99442">Intel® 64 and IA-32 Architectures Software Developer’s Manual, Volume 1</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-651" x="496.68057 499.56418 502.72858 508.12949 511.96887 514.85248 521.09033 526.78729 532.3277"> for CET </tspan><tspan y="-640.02002" x="46.020874 51.615273 56.966675 60.500076 65.896477 68.349876 70.803276 75.479675">details.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c1AE6E0A5"><tspan y="-624" x="46.020874 48.499474 54.020973 59.001572 61.97517 65.452774 70.974274 75.954872 78.928474 81.407074 86.882675 92.404175 94.445374 99.920975 103.45978 108.93538 113.91598 117.45478 119.91628 125.43778 130.89897">Instruction ordering.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-624" x="133.44058 136.02448 139.79997 146.04147 151.71597 157.24648 159.83037 162.28287 166.95837 169.54227 174.93777 177.52167 182.19717 187.59987 191.42937 193.82607 199.22156 201.67406 204.12656 208.83806 211.29056 216.97406 222.56757 225.15146 227.60396 233.28746 237.96297 241.49547 245.32497 251.00847 255.68398 259.21646 261.66898 267.11847 272.80197 276.06448 278.64841 284.79089 290.19357 295.54407 298.12799 304.27048 309.67316 314.34866 317.88116 320.33368 325.78317 331.46667 334.0506 339.81329 343.05511 348.81781 351.46204 356.86292 360.04712 362.63104 366.16354 371.84705 377.19754"> IRET is a serializing instruction. See Section 8.3 of the </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-624" x="379.74088 383.58209 389.22418 392.75848 398.16119 400.61551 409.60382 412.24805 417.96036 423.67267 426.25659 431.6539 437.3392 442.93451 445.51843 449.29575 455.47876 459.55307 465.26538 470.97769 473.56161 479.74554 483.58765 488.26495 493.95026 496.40457 499.93887 505.29117 509.96848 513.50275 519.18805 523.01935 528.37164 533.04895 535.63287 541.81677 547.21765 550.37396 553.90826">Intel® 64 and IA-32 Architectures Soft-</tspan><tspan y="-613.02002" x="46.020844 53.380142 58.786442 62.626743 67.988045 70.812241 77.703537 83.064835 88.381134 93.742432 96.205734 101.66603 107.27033 112.63163 116.47193 118.89023 123.57653 126.40073 133.98503 139.44893 145.09103 150.79254 156.19884 158.66214 161.93544 164.75964 170.90395 176.30484 178.76814 184.46245 193.21675 198.57805 201.46165 207.18295">ware Developer’s Manual, Volume 3A</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-613.02002" x="213.24084">.</tspan><tspan y="-597" x="46.020844 52.160645 57.563347 62.911148 65.495049 69.609848 75.875648 81.55645 86.949249 92.630051 98.269447 103.61725 108.29005 110.93425 114.46405 119.91085 122.49475 126.26755 131.94835 136.62115 140.15096 143.97775 149.65855 154.33136 157.86116 160.31096 165.75775 171.43855 174.08275 180.24055 185.58835 191.26915 196.66196 201.97375 204.42355 209.87036 213.69716 216.34135 218.73805 224.43956 227.08376 233.22356 240.90054 247.05385 249.69804 256.41833 261.86963 267.55493 271.62924 277.62683 283.07812 288.52942 292.06372 294.70795 301.77924 307.41864 312.77094 316.43304 321.83035 325.36465 327.81897 333.27026 338.95557 343.07486 345.65878 348.1131 353.7984 356.38232 362.65262 368.33792 373.73523 379.33054 382.86484 388.21713 392.04843 394.69266 400.40497 406.11728 408.76151 414.2128 417.36911 419.95303 423.48734 429.17264 434.52493">See “Changes to Instruction Behavior in VMX Non-Root Operation” in Chapter 25 of the </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-style="italic" class="cAFCCD1DD c9256B18F c0F4078D5"><tspan y="-597" x="437.22021 440.99753 446.68283 450.21713 455.56943 458.02374 467.01205 469.65628 475.36859 481.0809 483.72513 489.12244 494.80774 500.40305 503.04727 506.82458 512.9599 517.03418 522.74646 528.45874 531.10297 537.23828 541.06958 545.74689 551.43219 553.88647">Intel® 64 and IA-32 Archi-</tspan><tspan y="-586.02002" x="46.019897 49.558697 54.915497 59.597298 63.136097 68.825897 72.661697 78.018494 82.700294 85.583893 91.732697 97.188499 100.3493 103.8881 111.2429 116.6447 120.4805 125.88319 128.7074 135.59419 140.95099 146.26279 151.61958 154.07838 159.53418 165.13397 170.53667 174.31847 176.78267 181.46446 184.28867 191.86847 197.27026 202.91237 208.61388 214.01567 216.47447 219.74327 222.56747 228.75137 234.21167 236.67047 242.31258 251.06238 256.41919 259.30276 265.01956">tectures Software Developer’s Manual, Volume 3C</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-586.02002" x="271.26019 274.52631 277.40991 280.56802 286.02112 289.85422 292.73782 301.48492 306.93802 310.77112 316.17383 318.99805 321.45413 327.14124 330.29935 335.75244 339.58554 348.33264 353.73175 357.26785 359.72394 365.17703 370.86414 373.68835 379.08746 384.68457 390.13766 395.82477 399.36087 402.24448 405.78058 411.46768 416.87039 419.69461 425.29172 430.64581 436.33292 441.61682 446.93494 449.39102 454.84412 458.67722 461.50143 466.95453 470.11264 472.93686 476.47296 482.16006 484.61615 489.29526 492.11948 494.57556 500.26266 504.94177 508.47787 512.31097 517.99805 522.67712 526.2132 528.66931 534.12244 539.80951 542.69305 545.14917 550.83624">, for more information about the behavior of this instruction in </tspan><tspan y="-574.97974" x="46.019897 52.169598 59.750298 65.908997 68.792595 74.434692 79.894997 85.585693 89.66539 93.50209 98.958794 104.4155 107.9552 110.7794 116.2361 121.8368 127.1945 130.8566 136.25929 139.799 142.2587 147.71539 153.4061">VMX non-root operation.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-551.34003" x="46.02 52.630455 58.270802 63.845413 67.26767 72.573364 76.594215 79.08123 84.720589">Operation</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-531.96002" x="46.02 48.122402 52.803303 55.022705 60.149105 64.830002 67.0494 72.175797 74.395195">IF PE = 0</tspan><tspan y="-519.96033" x="59.52 64.725601 70.546799 75.293396 81.114594 83.333992 88.629593 94.327492 99.533089 105.23099 107.45039 112.85039 117.59158 123.17159 127.67068 130.49129 136.07129 141.58919 147.10709 152.56648 157.24738 162.04977 166.79187 169.67278 176.21307 181.91096 187.46756 192.14845">THEN GOTO REAL-ADDRESS-MODE;</tspan><tspan y="-507.96063" x="46.02 50.731499 55.230598 59.996098 62.079597 66.7911 69.010506 71.589005 73.672508 79.266006 84.517509 89.769012 94.309509 99.021011 103.73251 108.44402 113.85751 115.59811 120.04861 126.64922 132.24272 134.46213 139.56963 141.78903 147.04053">ELSIF (IA32_EFER.LMA = 0)</tspan><tspan y="-495.96094" x="59.52 64.729202 70.5504 75.300598">THEN</tspan><tspan y="-483.96124" x="77.520004 79.614304 84.336601 86.556 89.145302 93.867599 98.5485 103.04761 108.65191 113.92321 118.69951 120.40681 126.08311 132.65941 134.87881 139.99712 142.21652 147.47882">IF (EFLAGS.VM = 1)</tspan><tspan y="-471.96155" x="95.520004 100.7076 106.5612 111.2898 117.1434 119.3628 124.6404 130.3383 135.52591 141.22382 143.44321 148.87381 153.60242 158.79002 164.48163 169.91223 175.76584 178.60445 183.28535 188.71596 194.41386 200.99646 203.83507 209.47627 211.57687 217.00748 222.19508 227.88669 233.49728 237.96489 240.8035 246.0721 251.3407 256.5607 261.82928 264.66788 271.25049 276.94839 282.487 287.21561">THEN GOTO RETURN-FROM-VIRTUAL-8086-MODE;</tspan><tspan y="-459.96185" x="95.520004 100.22701 104.673 109.4754 114.21661 116.436 121.692 127.4502 132.61621 138.33121 140.55061 145.71211 151.11211 156.8271 162.0453 166.7523 171.4593 176.62531 181.33231 186.8493 189.66631 196.26691 201.9648 207.4818 212.1888">ELSE GOTO PROTECTED-MODE;</tspan><tspan y="-447.96216" x="77.520004 82.254906 84.361809">FI;</tspan><tspan y="-435.96246" x="59.520004 64.235107 68.689209 73.458313 78.173416 80.392815 85.656914 91.380013 96.554115 102.27721 104.49661 106.58371 112.22311 115.04821 120.30331 125.55841 130.26451 133.08961 139.65872 145.38182 150.90692 155.62202">ELSE GOTO IA-32e-MODE;</tspan><tspan y="-423.96277" x="46.020004 50.700905 52.801502">FI;</tspan><tspan y="-399.96246" x="46.020004 51.437103 56.152203 61.749302 66.2034 69.084305 74.664307 80.189407 85.714508 91.131607 95.84671 100.61581 105.38492 108.21002 114.77912 120.50222 126.02732 130.74242">REAL-ADDRESS-MODE;</tspan><tspan y="-387.96277" x="59.520004 61.587303 66.328499 68.547897 74.251198 78.930298 83.6166 86.918694 91.361992 96.164391 100.79669 105.59909 107.52239 111.72359 116.4099 118.6293 123.79079 126.01019 131.2455">IF OperandSize = 32</tspan><tspan y="-375.96307" x="77.520004 82.729202 88.5504 93.300598">THEN</tspan><tspan y="-363.96338" x="95.520004 100.23511 102.3222 107.4333 109.6527 111.3978 116.5593 118.7787 123.8898 128.6049 133.257 135.83911 138.42122">EIP := Pop();</tspan><tspan y="-351.96368" x="95.520004 100.2504 105.03481 107.2542 109.0146 114.14101 116.3604 121.4868 126.2172 130.8846 133.48199 136.07939 137.95679 140.17618 142.77357 146.80197 149.02136 154.29176 159.51176 162.35216 166.97186 168.93027 172.31067 174.53006 179.14977 183.89096 188.55836 190.39076 192.61015 197.39455 199.31606 203.98346 208.72556 211.56595 216.29636 219.56876 224.23616 228.95757 232.22997 234.44936 239.71976 244.93976 247.15915 251.82655 253.74806 257.12845 261.14786 263.36725 268.03464 269.95615 273.97556 277.88696 282.36536 285.63776 290.30515 294.98605 299.65344 301.87283 305.90125">CS := Pop(); (* 32-bit pop, high-order 16 bits discarded *)</tspan><tspan y="-339.96399" x="95.520004 98.899506 103.58041 110.53291 115.1526 119.8821 124.6116 129.08011 134.6916 139.97011 144.7536 146.97299 148.7325 153.858 156.07739 161.2029 165.9324 170.55211 173.1909 175.7874">tempEFLAGS := Pop();</tspan><tspan y="-327.96429" x="95.520004 100.2468 104.9736 109.4394 115.0482 120.32401 125.1048 127.3242 129.08101 134.20381 136.42322 139.01701 142.39381 147.11162 154.06142 158.68112 163.42233 168.10324 172.60234 178.21114 183.48694 188.22903 190.44843 196.05722 201.90903 207.44583 209.66522 214.93202 220.15202 225.41882 230.14563 235.68243 240.90244 246.75424 249.34804 251.56744 257.26535 262.72476 264.94415 267.53796 272.26477 276.94568 281.38446 286.99326 292.26904 297.01114 299.23053 304.83932 310.69113 316.22794 318.44733 323.71411 329.32291 334.58972 339.80969 345.07648 350.29645 356.14825 358.74207">EFLAGS := (tempEFLAGS AND 257FD5H) OR (EFLAGS AND 1A0000H);</tspan><tspan y="-315.9646" x="77.520004 82.2612 86.699997 91.502396 96.243591 98.46299 101.02709 105.02219 107.24159 112.94669 117.62579 122.3139 125.616 130.0611 134.86349 139.49759 144.29999 146.22508 150.42628 155.11438">ELSE (* OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-315.95999" x="157.32001">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cC7C7E1F8"><tspan y="-315.95999" x="163.37987"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-315.95999" x="166.38 171.65401 176.92801 179.1474 183.1794">16 *)</tspan><tspan y="-303.9603" x="95.520302 100.26151 102.36211 107.4633 109.6827 111.4179 116.57941 118.79881 123.90001 128.6412 133.2834 135.85561 138.42781 140.34752 142.56693 145.13913 149.14233 151.36174 156.60693 161.88722 164.70242 169.38152 171.31471 174.66991 176.88931 181.56841 186.3096 190.9518 192.804 195.02341 198.90961 200.81581 205.55611 209.9958 213.29791 215.51732 220.27652 224.95561 229.59781 234.3381 237.5853 239.8047 245.08499 250.36528 252.58469 257.2269 259.20871 262.5639 266.586 268.80539 272.80859">EIP := Pop(); (* 16-bit pop; clear upper 16 bits *)</tspan><tspan y="-291.9606" x="95.520302 100.2435 105.0207 107.2401 108.99329 114.1125 116.33189 121.4511 126.17429 130.83449 133.42468 136.01488 137.88507 140.10448 142.69467 146.71587 148.93527 154.19847 159.46167 162.34258 166.96228 168.91348 172.28668 174.50609 179.16629 183.8895 188.5497 190.7691 194.7903">CS := Pop(); (* 16-bit pop *)</tspan><tspan y="-279.96091" x="95.520302 100.2408 104.9613 109.4208 115.0233 120.2928 125.0673 127.8258 133.0863 138.3468 140.09731 145.3578 148.1163 150.33571 152.08621 157.20271 159.42212 164.53862 169.25912 173.91663 176.50412 179.09161">EFLAGS[15:0] := Pop();</tspan><tspan y="-267.96121" x="59.520302 64.255203 66.362106">FI;</tspan><tspan y="-255.96152" x="59.520302 64.264206 70.133102 75.687004">END;</tspan><tspan y="-231.96121" x="46.020302 51.429302 56.136303 61.302303 66.972305 72.381302 78.213303 81.094208 85.775108 91.234512 96.932419 103.49342 106.37432 112.03532 114.11433 119.52333 124.74153 130.41153 136.05093 140.49693 143.31393 148.56093 153.80792 159.05492 164.30191 167.11891 173.67992 179.43811 184.95511 189.66211 191.39911">RETURN-FROM-VIRTUAL-8086-MODE: </tspan><tspan y="-219.96152" x="46.020302 48.615002 52.640701 54.8601 59.983799 63.253498 67.981201 71.8899 76.608597 80.570396 84.587097 89.314796 92.584496 94.803894 96.759598 100.7763 102.9957 104.9172 109.7196 111.939 116.58569 118.50719 121.77689 125.15459 129.93629 134.37599 136.30469 139.1424 144.4101 149.6301 154.8978 160.1655 162.3606 169.30139 174.0192 178.674 183.3828 185.6022 192.543 197.3148 202.02361 206.79541 209.01482 211.10461 216.52441 221.24222 226.41902 228.63843 230.58423 234.59103 236.81044 241.51924 246.30005 251.00885 254.96796 259.73975 263.10754 267.81635 272.47113 274.69052 279.15631 283.8606 288.52618 290.74557 294.76318 298.14178 302.61838 307.30197 311.31958 313.53897 315.49557 320.27817 322.49756 327.14517 329.10178 332.37238 335.75098 340.53357 345.01016 346.93976 349.77835 354.99832 360.26691 365.53552 370.75552 372.97491 379.92651 384.60742 389.27301 393.99261 396.21201 400.23862">(* Processor is in virtual-8086 mode when IRET is executed and stays in virtual-8086 mode *)</tspan><tspan y="-207.96182" x="59.520294 61.617294 66.342293 68.561691 70.658691 76.391693 81.512695 85.976692">IF IOPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-207.96001" x="88.199997 94.199471">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-207.96001" x="96.959999 102.2259 104.4453 107.0382 111.0621 113.2815 118.92271 120.90451 124.17241 127.54831 132.32822 136.76793 138.69482 140.91423 147.86313 152.58904 157.20874 161.94905 163.70496 165.92436 171.04626 175.77217">3 (* Virtual mode: PE </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-207.96001" x="177.96001 183.95947">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-207.96001" x="186.72 191.9904 193.8228 196.04219 201.72659 208.26689">1, VM </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-207.96001" x="210.48">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-207.96001" x="216.53999"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-207.96001" x="218.7603 224.0208 225.84329 228.0627 230.1552 235.8837 241.0002 245.4597">1, IOPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-207.96001" x="247.67999">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-207.96001" x="253.74001"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-207.96001" x="255.96031 261.23251 263.4519 267.48212">3 *)</tspan><tspan y="-195.96031" x="77.520004 82.738205 88.559402 93.300606 99.121803 101.3412 103.4193 108.16051 110.37991 116.09401 120.77311 125.47021 128.71831 133.21741 137.9595 142.6386 147.44099 149.37509 153.52319 158.26349">THEN IF OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-195.96001" x="160.44">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-195.96001" x="166.5 168.71939 173.9529"> 32</tspan><tspan y="-183.96031" x="95.519699 100.7289 106.55009 111.30029">THEN</tspan><tspan y="-171.96062" x="113.5197 118.2348 120.3219 125.433 127.6524 129.39749 134.55899 136.7784 141.8895 146.6046 151.2567 153.83881 156.42091">EIP := Pop();</tspan><tspan y="-159.96092" x="113.5197 118.2501 123.0345 125.2539 127.0143 132.1407 134.36009 139.4865 144.21689 148.88429 151.48169 154.07909 155.95648 158.17587 160.77327 164.80167 167.02106 172.29146 177.51146 180.35185 184.97156 186.92996 190.31036 192.52975 197.14946 201.89066 206.55806 208.39046 210.60985 215.39424 217.31575 221.98315 226.72525 229.56564 234.29605 237.56845 242.23586 246.95726 250.22966 252.44905 257.71945 262.93942 265.15881 269.8262 271.74771 275.12811 279.14752 281.36691 286.0343 287.95581 291.97522 295.88663 300.36502 303.63742 308.30481 312.98572 317.65311 319.8725 323.90091">CS := Pop(); (* 32-bit pop, high-order 16 bits discarded *)</tspan><tspan y="-147.96123" x="113.5197 118.2429 122.96609 127.4283 133.03349 138.30569 143.0829 145.30231 147.05551 152.17471 154.39412 159.51332 164.23653 168.89673 171.48692 174.07712">EFLAGS := Pop();</tspan><tspan y="-135.96153" x="113.5197 116.1207 120.15269 122.37209 128.01329 134.61389 136.44989 138.66928 140.77528 146.47319 151.6032 156.0762 157.9122 163.6002 165.70621 170.83621 173.0556 177.4953 182.2977 186.9174 189.1368 194.8248 196.9308 201.66479 203.88419 208.56508 213.30627 217.77928 223.39528 228.67828 230.89767 235.56868 237.49019 240.87419 244.83598 247.05537 251.84337 256.52426 259.90826 262.12766 269.02795 273.76917 278.44016 280.36166 283.70966 285.63116 290.35617 294.97586 297.19525 301.86624 306.55524 308.77463 313.39432 318.13553 322.80652 325.02591 329.05792">(* VM, IOPL,VIP and VIF EFLAG bits not modified by pop *)</tspan><tspan y="-123.96183" x="113.5197 115.6131 120.3345 122.55389 127.27529 129.3687 134.4861 136.70551 141.48091 146.20232 149.57372 151.79312 158.73752 160.68692 164.05832 168.83372 170.78313 175.55853 177.77794 182.49934 187.27475 189.49416 191.41655 193.36595 200.31035 202.25975">IF EIP not within CS limit</tspan><tspan y="-111.96213" x="131.5197 136.7001 142.54651 147.26791 153.11432 155.33372 161.09912 166.36952 171.48692 174.07532 179.33672 181.92511 183.7935 186.01291 190.73431 192.82771">THEN #GP(0); FI;</tspan><tspan y="-99.962425" x="95.519699 100.26089 104.69969 109.50209 114.24329 116.46268 119.02679 123.02189 125.24129 130.94638 135.62547 140.31357 143.61568 148.06078 152.86317 157.49727 162.29967 164.22476 168.42596 173.11406">ELSE (* OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-99.959999" x="175.32001">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-99.959999" x="181.38 183.59941 188.84821 194.12849 196.3479 200.35471"> 16 *)</tspan><tspan y="-87.960297" x="113.52 118.26121 120.36181 125.46301 127.68241 129.41762 134.57912 136.79852 141.89972 146.64091 151.28311 153.85532 156.42752 158.34723 160.56664 163.13884 167.14204 169.36145 174.60664 179.88693 182.70213 187.38123 189.31442 192.66962 194.88902 199.56812 204.30931 208.95151 210.80371 213.02312 216.90932 218.81552 223.55582 227.99551 231.29761 233.51701 238.27621 242.95531 247.5975 252.3378 255.58499 257.80438 263.08469 268.36499 270.58438 275.22659 277.2084 280.5636 284.58569 286.80508 290.80829">EIP := Pop(); (* 16-bit pop; clear upper 16 bits *)</tspan><tspan y="-75.960594" x="113.52 118.2432 123.0204 125.2398 126.993 132.1122 134.3316 139.45081 144.17401 148.83421 151.42441 154.0146 155.8848 158.1042 160.6944 164.71559 166.935 172.1982 177.4614 180.3423 184.96201 186.91321 190.28641 192.50581 197.16602 201.88922 206.54942 208.76883 212.79002">CS := Pop(); (* 16-bit pop *)</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="358.80228pt" height="644.68719pt" viewBox="0 0 358.80228 644.68719" sodipodi:docname="634.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.84082" inkscape:cy="423.76717" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg304" /><g transform="translate(-45.119385,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="112.68 117.4023 122.1246 126.5859 132.1902 137.4615 142.23781 144.99811 150.26041 155.52271 157.27501 162.53731 165.29761 167.51701 169.26932 174.38762 176.60703 181.72533 186.44763 191.10693 193.69623 196.28552 198.15482 200.37422 202.96352 206.98381 209.20322 211.29752 217.02782 222.14612 226.60742 228.82683 230.77713 235.50031 237.7197 242.45279 247.13368 251.60579 257.22089 262.50299 267.24509 269.46451 274.25162 278.98471 282.3678 284.58722 291.48752 296.2287 300.8988 302.82028 306.16739 308.08887 312.81296 317.43265 319.65207 324.32217 329.01028 331.22971 335.8494 340.59058 345.26068 347.4801 351.5112">EFLAGS[15:0] := Pop(); (* IOPL in EFLAGS not modified by pop *)</tspan><tspan y="-703.98029" x="112.68001 114.77341 119.4948 121.7142 126.4356 128.52901 133.64641 135.86581 140.64122 145.36263 148.73402 150.95343 157.89783 159.84723 163.21863 167.99403 169.94344 174.71884 176.93825 181.65965 186.43506 188.65446 190.57686 192.52626 199.47066 201.42006">IF EIP not within CS limit</tspan><tspan y="-691.98059" x="130.68001 135.85681 141.69962 146.41742 152.26022 154.47963 160.24142 165.50822 170.62202 173.20682 178.46461 181.04941 182.91422 185.13362 189.85143 191.94122">THEN #GP(0); FI;</tspan><tspan y="-679.9809" x="94.680008 99.414909 101.52181">FI;</tspan><tspan y="-667.9812" x="76.680008 81.413109 85.885208 90.67231 95.405411">ELSE </tspan><tspan y="-655.98151" x="94.680008 100.43011 105.68521 110.84671 113.42611 118.67221 121.24531 123.16501 125.38441 127.9575 131.96161 134.18102 139.34612 142.59421 147.09331 151.7364 153.95581 157.37581 162.0567 164.27611 168.90121 170.88301 174.1311 177.5511 182.3112 186.8103 188.71741 191.53351 196.7796 202.0257 207.27179 212.51788 214.73729 221.66638 226.37248 231.13258 233.11438 236.47047 241.17657 244.47867 246.22017 248.43958 253.54167">#GP(0); (* Trap to virtual-8086 monitor: PE</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cC7C7E1F8"><tspan y="-655.97998" x="258.23999"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-655.97998" x="261.30011">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-655.97998" x="267.29999"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-655.97998" x="269.57968 274.81049 276.66898 278.8884 284.5332 291.13379">1, VM </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-655.97998" x="293.34 299.33948">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-655.97998" x="302.10001 307.3605 309.18301 311.4024 313.4949 319.22339 324.33987 328.79938">1, IOPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-655.97998" x="331.01971 335.94">&lt; </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-655.97998" x="338.21973 343.46133 345.68073 349.68033">3 *)</tspan><tspan y="-643.98029" x="58.619415 63.354317 65.46122">FI;</tspan><tspan y="-631.98059" x="45.119415 49.813816 55.694416 61.198814">END;</tspan><tspan y="-607.98029" x="45.119415 50.225117 55.636818 61.354519 66.523216 71.232918 75.942619 81.16082 85.841721 91.36142 94.242325 100.80602 106.52372 112.04342 116.75312">PROTECTED-MODE:</tspan><tspan y="-595.98059" x="58.619415 60.720917 65.450417 67.669815 73.524315 78.712814">IF NT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-595.97998" x="80.940002">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-595.97998" x="86.940002 89.159401"> 1</tspan><tspan y="-583.98029" x="76.68 81.878403 87.699608 92.439011 98.260216 100.47962 105.76802 111.46592 116.66432 122.36222 124.58163 129.74043 135.37984 140.12193 145.40224 148.22284 153.62285 158.36224 163.52104 169.22345 174.62346 180.44466 182.36435 184.58374 187.16315 191.18524 193.40463 198.50584 203.24704">THEN GOTO TASK-RETURN; (* PE </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-583.97998" x="205.44 211.43947">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-583.97998" x="214.2 219.45959 221.28119 223.5006 229.1418 235.74239">1, VM </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-583.97998" x="237.96001">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-583.97998" x="244.02"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-583.97998" x="246.24031 251.50351 253.3287 255.54811 261.3963 266.57849">0, NT </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-583.97998" x="268.79999">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-583.97998" x="274.79999"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-583.97998" x="277.07968 282.32129 284.54068 288.54028">1 *)</tspan><tspan y="-571.98029" x="58.61998 63.354881 65.461784">FI;</tspan><tspan y="-559.98059" x="58.61998 60.71608 65.440178 67.659576 73.391678 78.05278 82.767883 86.033981 90.506081 95.28418 99.903885 104.70628 106.65839 110.82449">IF OperandSize</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cC7C7E1F8"><tspan y="-559.97998" x="115.5"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-559.97998" x="118.56013">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-559.97998" x="124.62"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-559.97998" x="126.8403 132.12061">32</tspan><tspan y="-547.98029" x="76.680603 81.889801 87.710999 92.461197">THEN</tspan><tspan y="-535.98059" x="94.680603 99.395706 101.4828 106.5939 108.8133 110.5584 115.7199 117.9393 123.0504 127.7655 132.4176 134.99971 137.58182">EIP := Pop();</tspan><tspan y="-523.9809" x="94.680603 99.411003 104.1954 106.4148 108.1752 113.30161 115.521 120.6474 125.3778 130.0452 132.64259 135.23999 137.11739 139.27647 141.87387 145.90227 148.12166 153.39206 158.61206 161.45245 166.07216 168.03056 171.41096 173.63036 178.25006 182.99127 187.65868 189.49107 191.71046 196.49486 198.41637 203.08377 207.82587 210.66626 215.39667 218.66907 223.33647 228.05788 231.33028 233.54967 238.82007 244.04007 246.25946 250.92686 252.84837 256.22876 260.24817 262.46756 267.13495 269.05646 273.07587 276.98727 281.46567 284.73807 289.40546 294.08636 298.75375 300.97314 305.00156">CS := Pop(); (* 32-bit pop, high-order 16 bits discarded *)</tspan><tspan y="-511.9812" x="94.680603 98.060104 102.741 109.6935 114.3132 119.0427 123.7722 128.24071 133.8522 139.13071 143.9142 146.13359 147.8931 153.0186 155.23799 160.36349 165.093 169.75951 172.356 174.9525">tempEFLAGS := Pop();</tspan><tspan y="-499.98151" x="76.680603 81.421799 85.860596 90.662994 95.40419 97.623589 100.18769 104.18279 106.40219 112.10729 116.78639 121.47449 124.7766 129.22169 134.02409 138.65819 143.46059 145.38568 149.58688 154.27498">ELSE (* OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-499.98001" x="156.42">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-499.98001" x="162.48 164.6994 169.9482 175.22849 177.44789 181.4547"> 16 *)</tspan><tspan y="-487.98032" x="94.680298 99.407997 101.5077 106.6314 108.8508 110.6085 115.7322 117.9516 123.0753 127.803 132.4227 135.0174 137.61209 139.48679 141.70618 144.30087 148.32657 150.54596 155.76596 161.04626 163.88397 168.54868 170.47018 173.82988 176.04927 180.71397 185.44168 190.06139 191.92168 194.14107 198.04977 199.97847 204.69717 209.13687 212.40657 214.62596 219.36806 224.03276 228.69746 233.37837 236.64807 238.86746 243.53217 245.48787 248.86557 252.82736 255.04675 259.07245">EIP := Pop(); (* 16-bit pop; clear upper bits *)</tspan><tspan y="-475.98062" x="94.680298 99.403496 104.18069 106.40009 108.15329 113.27249 115.49189 120.61109 125.33429 129.99449 132.58469 135.17488 136.97487 139.19427 141.78447 145.80566 148.02507 153.28827 158.55147 161.43237 166.05208 168.00328 171.37648 173.59589 178.25609 182.97929 187.6395 189.8589 193.8801">CS := Pop(); (* 16-bit pop *)</tspan><tspan y="-463.98093" x="94.680298 98.100296 102.7812 109.72469 114.38219 119.10269 123.82319 128.28268 133.88518 139.15468 143.92918 146.14859 147.89909 153.01559 155.235 160.3515 165.07201 169.72951 172.317 174.9045 176.70448 178.92389 181.51138 185.52988 187.74928 193.00978 198.27028 201.15118 205.7403 207.6978 211.0773 213.29669 217.9164 222.65761 227.32411 229.20061 231.42 235.33051 237.261 241.94191 246.44101 249.71251 251.9319 256.71539 261.33508 266.00159 270.68246 273.95398 276.1734 280.79309 282.77487 286.15436 290.17285 292.39227 296.41977">tempEFLAGS := Pop(); (* 16-bit pop; clear upper bits *)</tspan><tspan y="-451.98123" x="58.619995 63.354897 65.4618">FI;</tspan><tspan y="-439.98154" x="58.619995 60.716095 65.440193 67.659592 71.033691 75.748795 82.649094 87.328194 92.052292 96.733192 101.19629 106.80239 112.07549 116.85359 119.44469 125.1228 131.7009 134.29199">IF tempEFLAGS(VM) </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-439.98001" x="136.5">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-439.98001" x="142.55986"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-439.98001" x="145.25999 150.5412 152.76059 157.20029 162.00269 166.62239 168.84178 173.58298 178.72018 183.20038">1 and CPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-439.98001" x="185.39999">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-439.98001" x="191.39999"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-439.98001" x="193.67969">0</tspan><tspan y="-427.98032" x="76.679688 81.897888 87.719086 92.426987 98.259888 100.41899 105.67589 111.39178 116.60999 122.30788 124.52729 129.93719 134.6451 139.812 145.48289 150.89279 156.77339 159.59129 164.75819 170.51639 173.33699 178.99889 181.07878 186.48868 191.70688 197.37778 203.01718 207.46408 210.28198 215.52988 220.77777 226.02567 231.27356 234.09146 240.65337 246.41156 251.92946 256.63736 258.49225">THEN GOTO RETURN-TO-VIRTUAL-8086-MODE; </tspan><tspan y="-415.98062" x="76.679688 81.385788 85.830887 90.633286 95.374489 97.533592 102.7887 108.5469 113.712 119.4261 121.64551 126.80701 132.207 137.9211 143.1393 147.8454 152.5515 157.7166 162.4227 167.9388 170.7549 177.3555 183.05339 188.56949 193.27559 196.09169 201.49979 206.20589 211.37099 217.04008 222.44818 228.32878">ELSE GOTO PROTECTED-MODE-RETURN;</tspan><tspan y="-403.98093" x="58.619385 63.354286 65.461189">FI;</tspan><tspan y="-379.98062" x="45.119385 50.288086 55.879787 60.682186 65.902191 68.783096 74.18309 78.892792 84.061493 89.734192 95.145889 100.98059 102.72029 104.9397 107.5785 111.60059 113.82 118.9257 123.6354">TASK-RETURN: (* PE </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-379.98001" x="125.88">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-379.98001" x="131.88"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-379.98001" x="134.10031 139.37071 141.20311 143.4225 149.1069">1, VM</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-379.98001" x="155.7"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-379.98001" x="158.39998 164.39944">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-379.98001" x="167.16 172.4106 174.22321 176.44261 182.27821">0, NT</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-379.98001" x="187.5"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-379.98001" x="190.19998 196.19945">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-379.98001" x="198.96001 204.23221 206.4516 210.4818">1 *)</tspan><tspan y="-367.98032" x="58.620316 63.422714 70.742409 72.812408 77.969406 82.667404 88.548004 91.356003 96.513 102.1524 106.8945 112.1748 116.9169 119.1363 121.7013 128.6619 130.58789 134.0079 138.7599 143.5011 148.2531 151.67311 153.89252 158.64452 163.38481 167.37181 170.79182 172.71782 177.52022 182.15521 184.72021 186.93962 190.35963 195.04053 197.25993 202.41693 207.21933 212.02173 214.24113 218.22813 222.90723 227.59622 231.47522 233.45702 236.81581 238.74181 243.4821 248.1171 250.3365 252.3183 257.06042 259.27985 261.17883 263.16061 267.91263 272.23172 274.45114 277.76315 279.74493 284.43393 286.33292 291.01202 293.23145 297.92944 301.28827 303.50769 307.38669 312.18912 315.42911 318.6691 323.40939 328.16141 331.58139 333.80081 338.95782 343.70984 348.51227">SWITCH-TASKS (without nesting) to TSS specified in link field of current TSS;</tspan><tspan y="-355.98062" x="58.620316 65.196617 69.666916 72.969017 77.228722 79.44812 82.820419 87.596718 92.31002 94.529419 97.901718 102.37202 106.38332 110.66462 112.88402 114.83432 119.61062 123.62192 126.99422 129.21362 133.68393 138.30002 142.78831 147.53041 152.20772 156.88861 161.68291 166.36382 171.04112 173.26051 177.70021 181.72231 183.9417 189.80699 195.5049 200.70419 202.92358 208.25789 213.89908 218.69337 223.79457">Mark the task just abandoned as NOT BUSY;</tspan><tspan y="-343.98093" x="58.620316 60.712814 65.433311 67.65271 72.373207 74.465706 79.582207 81.801605 83.750107 87.759605 89.979004 94.753502 99.473999 102.8445 105.0639 112.00739 113.95589 117.32639 122.10089 124.04939 128.8239 131.0433 135.76381 140.53831 142.75772 144.67921 146.62772 153.57121 155.51971">IF EIP is not within CS limit</tspan><tspan y="-331.98123" x="76.680618 81.861015 87.707413 92.42881 98.275208 100.49461 106.26001 111.53041 116.64781 119.23621 124.49761 127.08601 128.95441 131.17381 135.89522 137.98862">THEN #GP(0); FI;</tspan><tspan y="-319.98154" x="45.120316 49.814716 55.695316 61.199715">END;</tspan><tspan y="-295.98123" x="45.120316 50.526615 55.230915 60.394215 66.061516 71.467819 77.297119 80.178017 85.336815 91.049118 93.930016 99.588318 101.66462 107.07092 112.28912 117.95642 123.59583 128.03912 130.85342 136.09772 141.34201 146.5863 151.8306 154.6449 161.2032 166.9614 172.47569 177.17999 178.9818">RETURN-TO-VIRTUAL-8086-MODE: </tspan><tspan y="-283.98154" x="58.620316 61.259117 65.281212 67.50061 69.580513 74.382912 77.740814 82.48111 85.73101 88.980911 93.78331 98.428207 101.78611 106.48501 111.12991 113.3493 117.9942 121.2963 126.0042 129.8931 134.63339 139.31248 144.07439 147.32428 152.06458 154.28398 161.21487 165.67078 169.66768 171.88708 173.82298 178.62538 180.84479 185.47169 187.45349 190.70338 194.06128 198.86368 203.30338 205.21228 208.03018 213.27808 218.52597 223.77386 229.02176 231.24117 238.17206 242.87996 247.52486 252.22375 254.02556 256.24493 261.34885 266.05673">(* Interrupted procedure was in virtual-8086 mode: PE </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-283.98001" x="268.26001">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-283.98001" x="274.32001"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-283.98001" x="276.54031 281.80353 283.62872 285.84811 290.57132 295.69052 300.15271 305.27191 310.53513 312.36032 314.57971 320.22092">1, CPL=0, VM</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cC7C7E1F8"><tspan y="-283.98001" x="326.82001"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-283.98001" x="329.88013 335.87961">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-283.98001" x="338.64001 343.92032 346.13971 348.07291 352.87531 355.0947 358.41391 360.3201 364.81918 369.49829 371.71768 373.65088 380.57907 385.03226 389.71136 394.40756 396.62695 400.63016">1 in flag image *)</tspan><tspan y="-271.98032" x="58.6203 61.259102 65.281204 67.500603 69.541801 72.900604 75.120003 79.1259 83.896797 88.361694 93.015594 97.732498 104.6724 106.8918 110.8977 114.2646 118.72949 122.6274 126.9033 129.1227 133.8396 137.0985 139.3179 141.2628 146.03371 150.68761 152.63251 155.8914 160.5993 164.55841 167.91811 170.13751 174.79141 178.05031 182.51521 187.3203 191.2182 195.98911 198.20851 201.57541 204.8343 209.29921 213.19711 217.47301 219.41791 224.18881 228.84271 231.06212 235.52702 238.89392 241.11333 245.83023 250.94313 255.39903 260.65594 262.87534 266.24225 271.01315 275.72104 280.49194 282.71133 288.47223 293.73813 298.85104 301.48984 306.74673 309.33063 311.55002 315.56491">(* If shadow stack or indirect branch tracking at CPL3 then #GP(0) *)</tspan><tspan y="-259.98062" x="58.6203 60.724499 65.456696 67.676094 72.408295 77.842499 83.1147 84.794998 89.527199 94.208099 99.3993 101.6187 107.23289 113.0901 118.63229 120.85169 123.45089 125.49209 131.10629 136.32629 141.5985 146.1597 151.8549 156.3558 161.08801 165.82022 171.01141 172.69171 177.43292 183.29013 188.8206 194.1396 199.5666 204.12061 208.84561 214.69562 216.91502 222.64803 228.07503 230.29443 232.39143 237.99843 243.26343 248.48343 253.03743 258.72543 263.27942 267.96033 272.68533 277.86932 279.57932 284.35831 290.20831 294.9873 300.1713 305.42731 309.98129 314.6622 320.51221">IF CR4.CET AND (IA32_U_CET.ENDBR_EN OR IA32_U_CET.SHSTK_EN)</tspan><tspan y="-247.98093" x="76.680603 81.861 87.707397 92.428795 98.275192 100.49459 106.25999 111.5304 116.6478 119.2362 124.4976 127.086 128.95439 131.1738 135.8952 137.9886">THEN #GP(0); FI;</tspan><tspan y="-235.98123" x="58.6203 62.652302 67.449303 71.889 76.5681 81.248993 88.209595 93.006592 96.39959 100.83929 104.73899 109.04099 113.72189 118.51889 122.95859 127.63859 129.58258 134.26347 138.94257 141.16196 146.30096 148.52036 153.31735 158.05945 162.55045 167.17014 171.91313 178.87914 183.62123 186.98094 191.47194 195.39594 199.65564 204.39684 209.13893 213.63803 218.25772 220.17921 224.91321 229.5329 232.1429 236.82379 241.9628 246.4016">shadowStackEnabled = ShadowStackEnabled(CPL)</tspan><tspan y="-223.98154" x="58.6203 60.713699 65.435097 67.654495 72.375893 74.469292 79.586693 81.806091 86.58149 91.302887 94.674286 96.893684 103.83808 105.78748 109.15888 113.93428 115.88368 120.65908 122.87848 127.59988 132.37527 134.59468 136.51707 138.46648 145.41087 147.36028">IF EIP not within CS limit</tspan><tspan y="-211.98184" x="76.680603 81.861 87.707397 92.428795 98.275192 100.49459 106.25999 111.5304 116.6478 119.2362 124.4976 127.086 128.95439 131.1738 135.8952 137.9886">THEN #GP(0); FI;</tspan><tspan y="-199.98215" x="58.6203 63.3489 68.077499 72.545097 78.155701 83.433304 88.215904 90.435303 92.193901 97.318504 99.537903 102.9165 107.63611 114.53641 119.21551 123.94411 128.62502 133.09262 138.70322 143.98082 148.72293">EFLAGS := tempEFLAGS;</tspan><tspan y="-187.98245" x="58.6203 63.339901 68.113503 73.229103 75.448502 77.198105 82.313705 84.533104 89.694603 94.375504 99.032104 101.61871 104.20531">ESP := Pop();</tspan><tspan y="-175.98276" x="58.6203 63.392101 68.163902 70.383301 72.131104 77.244904 79.464302 84.578102 89.295898 93.950699 96.5895 99.174301 101.0391 103.2585 105.8433 109.8591 112.0785 117.1923 121.9101 126.5649 128.7843 134.0421 136.26151 143.2023 147.9201 151.2222 155.8419 159.84871 161.71352 163.92029 167.27998 172.08238 175.33408 180.07527 187.03586 189.25526 193.71297 200.67355 205.13126 209.79596 212.01537 216.81776 218.73926 223.41835 228.16045 231.04135 235.72226 239.02435 243.64406 248.38435 251.62614 253.84555 260.80615 265.48703 268.78915 273.40884 275.62823 279.63593">SS := Pop(); (* Pop 2 words; throw away high-order word *)</tspan><tspan y="-163.98306" x="58.620293 63.363293 68.160294 70.379692 72.121193 77.222389 79.441788 84.542984 89.28418 93.96418 96.543579 99.122978 100.98328 103.20267 105.78207 109.80418 112.02357 117.12477 121.86597 126.54597 128.76537 133.98537 136.20476 143.17076 147.85165 151.13666 155.75635 159.78835 161.64865 163.86804 167.26105 172.00314 175.28815 179.96904 186.93504 189.15443 193.59413 200.55473 204.99443 209.67442 211.89381 216.69081 218.6123 223.2923 228.03439 230.88739 235.56828 238.85329 243.47298 248.20697 251.44878 253.66817 260.63416 265.31506 268.60007 273.21976 275.43915 279.48016">ES := Pop(); (* Pop 2 words; throw away high-order word *)</tspan><tspan y="-151.98337" x="58.620293 64.198494 68.94059 71.159988 72.910492 78.026993 80.246391 85.362892 90.083389 94.740891 97.328392 99.915894 101.78339 104.00279 106.64159 110.6637 112.88309 117.9996 122.72009 127.37759 129.597 134.8575 137.0769 144.0204 148.74091 152.0034 156.6609 160.67041 162.5379 164.70059 168.05849 172.86089 176.11078 180.81868 187.74957 189.96898 194.46808 201.36838 205.86748 210.54749 212.76689 217.52879 219.51059 224.15549 228.95789 231.77579 236.48369 239.73358 244.37848 249.07738 252.37947 254.59888 261.52979 266.23767 269.48758 274.13248 276.35187 280.35776">DS := Pop(); (* Pop 2 words; throw away high-order word *)</tspan><tspan y="-139.98367" x="58.620293 63.363293 68.160294 70.379692 72.121193 77.222389 79.441788 84.542984 89.28418 93.96418 96.543579 99.122978 100.98328 103.20267 105.78207 109.80418 112.02357 117.12477 121.86597 126.54597 128.76537 133.98537 136.20476 143.17076 147.85165 151.13666 155.75635 159.78835 161.64865 163.86804 167.26105 172.00314 175.28815 179.96904 186.93504 189.15443 193.59413 200.55473 204.99443 209.67442 211.89381 216.69081 218.6123 223.2923 228.03439 230.88739 235.56828 238.85329 243.47298 248.20697 251.44878 253.66817 260.63416 265.31506 268.60007 273.21976 275.43915 279.48016">FS := Pop(); (* Pop 2 words; throw away high-order word *)</tspan><tspan y="-127.98397" x="58.620293 63.887093 68.65889 70.878288 72.626091 77.739891 79.95929 85.07309 89.790894 94.445694 97.030495 99.615295 101.48009 103.69949 106.28429 110.30009 112.51949 117.63329 122.35109 127.00589 129.2253 134.48309 136.7025 143.6433 148.3611 151.6209 156.2757 160.2825 162.20221 164.4603 167.81549 172.57469 175.8768 180.55769 187.5183 189.7377 194.1909 201.1515 205.60471 210.26491 212.48431 217.28671 219.20821 223.8873 228.6897 231.5049 236.2101 239.51221 244.1319 248.87219 252.11398 254.33339 261.29401 266.03522 269.28241 273.92462 276.14401 280.14722">GS := Pop(); (* Pop 2 words; throw away high-order word *)</tspan><tspan y="-115.98427" x="58.620293 60.731693 65.471092 67.690498 71.718895 76.460999 80.948395 85.568092 90.307495 97.269897 102.012 105.3717 109.8591 113.7795 118.03921 122.78041 127.52251 132.02162 136.64133 138.56282 143.29323">IF shadowStackEnabled</tspan><tspan y="-103.98457" x="76.680595 79.319397 83.341499 85.560898 89.462395 94.236893 98.948395 102.84989 107.12939 109.34879 111.29729 114.6318 116.8512 122.11169 124.33109 128.98859 133.66409 137.03459 141.74609 143.9655 148.43401 150.3555 152.304 156.9615 161.73601 166.44751 171.10501 173.32442 177.34291">(* check if 8 byte aligned *)</tspan><tspan y="-91.984863" x="76.680595 78.779396 83.506195 85.725594 90.506393 95.248497 100.3713 102.5907 108.1995 114.0513 119.5881 121.8075 127.0743 131.81189 137.07869 139.2981 141.0459 146.1687 148.38809">IF SSP AND 0x7 != 0</tspan><tspan y="-79.985161" x="94.680595 99.860092 105.70559 110.42609 116.27158 118.49098 124.25549 128.97598 134.09248 136.67998 141.40048 147.00298 152.42548 155.25598 160.67848 165.39899 170.57849 173.70599 175.79849 181.22099 185.9415 191.121 193.7085 195.57599 197.79539 202.5159 204.6084">THEN #CP(FAR-RET/IRET); FI;</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="388.84192pt" height="644.40112pt" viewBox="0 0 388.84192 644.40112" sodipodi:docname="635.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="345.46814" inkscape:cy="423.83692" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg216" /><g transform="translate(-46.898895,-69.476563)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="59.52 64.254898 66.361801">FI;</tspan><tspan y="-691.97968" x="59.52 64.251297 69.378601 73.8489 76.068298 77.829597 82.956894 85.176292 90.447594">CPL := 3;</tspan><tspan y="-679.97998" x="59.52 62.158802 66.120605 68.340004 73.799408 78.480309 82.476311 87.278709 94.20871 98.949005 101.1684 105.8664 110.6364 115.3344 119.2224 124.0248 127.3845 129.3663 134.04721 138.84961 141.06902 143.00401 147.7803 149.99969 155.6409 157.62271 160.89421 164.27371 169.01581 173.51491 175.4454 178.2849 183.5049 188.7744 194.0439 199.2639 201.48329 208.43579 213.1653 217.785 222.52531 224.74471 228.7722">(* Resume execution in Virtual-8086 mode *)</tspan><tspan y="-667.98029" x="59.520004 62.940002 67.620903 74.581497 79.201202 84.959404 86.880905 91.514107 96.316505 101.0667 106.2282 108.4476 113.5398 115.7592 120.5094 125.3118 130.40399">tempOldSSP = SSP;</tspan><tspan y="-655.98059" x="59.520004 62.158802 66.120598 68.339996 74.220596 78.961792 85.88549 88.104889 92.783989 97.223686 101.24579 104.60549 106.82489 111.32399 113.22569 115.1274 117.34679 120.66149 125.16059 129.9153 131.817 135.237 137.15849 141.96089 146.58058 148.79999 153.47908 158.15997 160.14177 164.88387 168.30386 172.26567 174.18538 176.40479 180.39449 184.89359 188.20828 192.94858 195.16798 198.51868 203.25987 205.47928 208.79398 212.09608 216.78778 221.52808 223.74748 227.09818 231.78 236.51309 238.73248 242.12459 246.86668 251.12639 255.86668 260.6088 262.3494 264.56882 269.72763 274.46976 279.20285 281.42227 284.81436 289.55646 293.81613 298.49704 303.29315 305.51257 308.86868 312.11047 316.79138 321.53168 323.7511 325.67258 329.69467 331.91409 336.5932 341.27411 346.07022 350.80331 353.02274 357.76486 361.78696 363.70844 368.51083 373.13055 375.34998 378.74207 383.48419 388.21729 390.43671 395.11761 397.03912 401.71823 403.93765 408.73376 413.47589">(* Now past all faulting points; safe to free the token. The token free is done using the old SSP</tspan><tspan y="-643.9809" x="59.520004 61.739403 65.747101 67.966507 72.465607 77.20771 81.854408 84.073814 88.837517 92.83622 94.818016 99.56012 104.20682 106.42622 110.88393 113.10333 117.10204 121.90443 126.55113 131.29143 134.54312 139.17181 141.15361 145.15231 149.86201 153.16411 155.38351 160.09322 164.77232 169.47302 172.77512 176.02681 178.00861 182.6553 187.3956 189.61501 194.07271 198.07141 200.29082 205.00052 206.91122 211.55792 213.77733 218.48703 223.59273 228.04143 230.26083 237.19353 241.65123 245.64993 247.86934 252.36844 254.58784 258.58655 263.38895 268.03564 272.73636 275.98807 280.66718 282.60489 286.60358 291.31326 294.56497 296.78436 301.43106 304.68277 306.66458 311.28339 313.2211 315.13181 319.87213 324.55124 329.25195 331.47134 333.38205 338.12238 342.75107 347.45178 349.36249 351.58188 355.58957"> * and using a supervisor override as old CPL was a supervisor privilege level *)</tspan><tspan y="-631.9812" x="59.520004 61.631405 66.370804 68.590202 72.618599 77.360703 81.848099 86.467796 91.207199 98.169601 102.91171 106.2714 110.7588 114.67921 118.93891 123.68011 128.42221 132.92131 137.54102 139.46251 144.19292">IF shadowStackEnabled</tspan><tspan y="-619.98151" x="77.520004 82.2603 87.058205 91.696808 96.437103 100.3197 103.6713 108.36391 113.04301 117.57361 120.92521 125.6664 129.9261 134.6187 139.4211 143.95169 148.5723 153.0219 155.00279 159.75839 164.49869 166.71809 171.81569 174.0351 177.38669 182.07928 189.03989 193.71898 199.42857 201.33118 206.01027 210.75237 215.55476 220.65596 222.87537 224.85716 227.07657 232.37216 238.07365 242.82925 247.99075 252.52135 257.86285 259.93646 275.59467 277.81406 280.38266 284.4003 286.61969 291.23938 296.04178 300.05759 304.67728 306.89667 311.56046 313.51526 316.89206 319.11145 321.94824 324.16763 328.83142 330.75293 334.12973 336.34912 341.01291 345.69382 349.70963 351.66443 355.04123 357.00061 361.71841 366.4902 368.70959 373.96741 376.1868 379.01459 381.23398 388.17477 392.94656 396.90836 400.32834 402.54773 407.20251 411.91132 414.13071 418.13751 422.84631 426.21411 428.4335 432.44931">expected_token_value = tempOldSSP | BUSY_BIT (* busy bit - bit position 0 - must be set *)</tspan><tspan y="-607.98181" x="77.520905 82.308907 86.989807 93.946808 98.509811 101.89381 106.62782 110.88751 115.56841 120.35641 124.91942 129.53822 134.03732 135.97232 140.71442 145.43942 147.65881 152.78882 155.00821 158.39221 163.11722 170.01752 174.69662 180.39453 182.31602 186.98703 191.72913 196.51712 275.58121 277.8006 280.37909 284.38858 286.60797 290.50046 292.41296 297.11548 301.61459 304.8681 307.08749 310.44901 315.2514 319.95392 322.17331 326.85242 331.59451 335.595 340.26151 342.4809 347.16 349.08151 352.44302 354.66241 358.67191">new_token_value = tempOldSSP (* clear the busy bit *)</tspan><tspan y="-595.98212" x="77.520905 81.534004 86.312103 90.784203 95.445305 100.1694 107.1165 111.6696 115.6827 119.0568 123.5289 127.434 131.7171 136.218 138.1395 142.8636 146.76871 151.0518 155.6049 159.51001 166.45711 171.11821 175.9053 179.81041 184.58852 189.24962 194.51372 199.17482 201.72092 205.10762 209.78853 216.74823 221.42194 227.11984 229.04134 233.71504 238.45714 243.24783 248.38054 250.17964 252.39903 257.18973 261.87061 268.83029 273.396 276.78268 281.51938 285.77905 290.45993 295.25064 299.81635 304.43515 308.93427 310.87198 315.61407 320.34177 322.14087 324.36029 329.08798 333.82559 338.4993 343.18018 347.09787 350.48456 355.16544 359.84454 364.34546 367.76544 372.44635 376.76547 381.44635 386.24875 390.74966 395.42877 399.86847 401.78998 406.58069 411.26157">shadow_stack_lock_cmpxchg8b(tempOldSSP, new_token_value, expected_token_value)</tspan><tspan y="-583.98242" x="59.52092 64.255821 66.362724">FI;</tspan><tspan y="-571.98273" x="46.02092 50.715321 56.595921 62.100319">END;</tspan><tspan y="-547.98242" x="46.02092 51.12122 56.527519 62.239819 67.403122 72.107422 76.811722 82.029922 86.710823 92.225121 95.106018 101.66432 107.37663 112.95483 117.63573 120.45003 125.90943 130.61374 135.83194 141.49924 146.95863 152.78793 154.52223 156.74164 159.31294 163.31525 165.53465 170.69615 175.37704">PROTECTED-MODE-RETURN: (* PE </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-547.97998" x="177.60001 183.65987">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-547.97998" x="186.42 191.66159 193.881 197.8806">1 *)</tspan><tspan y="-535.98029" x="59.519997 61.611595 66.331192 68.550591 73.270187 78.043785 80.630386 86.051987 91.167587 95.62619 98.212791">IF CS(RPL) </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-535.98029" x="100.44029">&gt;</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-535.98029" x="105.41999 107.63939 112.34189 117.44039"> CPL</tspan><tspan y="-523.98059" x="77.519989 82.721092 88.542297 93.284401 99.105606 101.325 106.6161 112.314 117.51511 123.21301 125.4324 130.83241 135.57361 140.73241 146.4339 151.83391 157.71451 160.53511 165.69391 171.39182 174.29968 180.01828 185.69188 190.86148 195.57208 200.98468 203.80528 208.91188 214.37128 216.45387 222.11847 224.20107 228.65067 233.36127 238.62086 243.33147 246.21237 250.66197 255.37257 261.03717 265.74777 270.19739">THEN GOTO RETURN-TO-OUTER-PRIVILEGE-LEVEL;</tspan><tspan y="-511.9809" x="77.519989 82.250389 86.719788 91.504189 96.234589 98.453987 103.67488 109.43308 114.62248 120.32039 122.53979 127.97219 132.65309 137.8425 143.4837 148.91611 154.77151 157.61191 162.80132 168.49922 171.31981 176.1042 181.7166 188.2569 192.99811 195.8385 200.9649 206.39731 208.49971 214.14091 216.24152 220.71092 225.39182 230.67122 235.40161 238.242 242.71141 247.4418 253.08301 257.81342 262.28281 264.16022 266.37961 271.11002 273.2124">ELSE GOTO RETURN-TO-SAME-PRIVILEGE-LEVEL; FI;</tspan><tspan y="-499.9812" x="46.019989 50.71439 56.59499 62.099388">END;</tspan><tspan y="-475.9809" x="46.019989 51.426289 56.130589 61.293888 66.961189 72.367493 78.196793 81.07769 86.236488 91.948792 94.763092 100.52129 106.22279 111.38609 116.09039 121.5498 124.3704 129.4707 134.9301 137.00639 142.70789 144.78418 149.22748 153.93178 159.18507 163.88937 166.70367 171.20277 175.88367 181.58516 186.32635 190.76965">RETURN-TO-OUTER-PRIVILEGE-LEVEL:</tspan><tspan y="-463.9812" x="59.519989 61.589989 66.331184 68.550583 74.256584 78.935684 83.624687 86.926788 91.372787 96.175186 100.81019 105.61259 107.53859 111.73979">IF OperandSize</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cC7C7E1F8"><tspan y="-463.98001" x="116.4"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-463.98001" x="119.46013">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-463.98001" x="125.52"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-463.98001" x="127.7403 133.0206">32</tspan><tspan y="-451.98032" x="77.520294 82.729492 88.55069 93.300888">THEN</tspan><tspan y="-439.98062" x="95.520294 98.940292 103.62119 110.5629 115.2186 119.9373 124.71 129.82471 132.04411 133.79282 138.90752 141.12692 146.24162 150.96033 155.61603 158.20172 160.78741">tempESP := Pop();</tspan><tspan y="-427.98093" x="95.520294 98.940292 103.62119 110.58179 115.2015 120.0039 124.74599 126.96539 128.7672 133.86839 136.0878 141.18449 145.92569 150.56339 153.13109 155.7699 157.6302 159.84961 162.41731 166.41602 168.63542 173.87613 179.15643 181.96713 186.64622 188.57492 191.99493 194.21434 198.85204 203.59323 208.23093 210.08943 212.30884 217.06354 219.04533 223.68303 228.48543 231.29613 236.03732 239.28003 243.95912 248.65082 251.95293 254.17233 259.41302 264.69333 266.91272 271.59183 273.51334 276.86404 280.88614 283.10553 287.78464 289.70615 293.72824 297.62796 302.07666 305.37875 310.01645 314.75677 319.39447 321.61386 325.61255">tempSS := Pop(); (* 32-bit pop, high-order 16 bits discarded *)</tspan><tspan y="-415.98123" x="59.520294 64.26149 68.700294 73.502693 78.243896 80.463295 82.527893 87.269089 89.488487 95.189087 99.868187 104.60849 107.8503 112.29089 117.09329 121.77239 126.51449 128.49629 132.63719 137.32079">ELSE IF OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-415.98001" x="139.5">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-415.98001" x="145.56 147.77939 153.05339 158.27339"> 16 </tspan><tspan y="-403.98032" x="77.519997 82.729195 88.550392 93.300591">THEN</tspan><tspan y="-391.98062" x="95.519997 98.898598 103.5795 110.5311 115.1508 119.8794 124.662 129.78661 132.006 133.7646 138.88921 141.1086 146.2332 150.96181 155.62741 158.22301 160.8186 162.6942 164.91359 167.50919 171.53578 173.75517 179.02377 184.24377 187.08238 191.70209 193.65869 197.03729 199.25668 203.92229 208.6032 213.2688 215.14439 217.36378 221.27339 223.20299 227.8839 232.383 235.65359 237.87299 242.65558 247.27528 251.94089 256.66049 259.93109 262.15048 266.77017 268.75198 272.13058 276.14819 278.36758 282.3942">tempESP := Pop(); (* 16-bit pop; clear upper bits *)</tspan><tspan y="-379.98093" x="95.519997 98.939995 103.6209 110.5815 115.20119 120.00359 124.7457 126.9651 128.76691 133.8681 136.08751 141.18781 145.929 150.5703 153.1416 155.78041 157.64072 159.86012 162.43143 166.43373 168.65314 173.89743 179.17772 181.99202 186.67111 188.60341 192.02341 194.24281 198.88411 203.62531 208.2666 210.48601 214.48831">tempSS := Pop(); (* 16-bit pop *)</tspan><tspan y="-367.98123" x="77.519997 82.261192 86.699997 91.502396 96.243591 98.46299 101.02709 105.02219 107.24159 112.94669 117.62579 122.3139 125.616 130.0611 134.86349 139.49759 144.29999 146.22508 150.42628 155.11438">ELSE (* OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-367.98001" x="157.32001">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-367.98001" x="163.38 165.59941 170.84821 176.12849 178.3479 182.35471"> 64 *)</tspan><tspan y="-355.98032" x="95.520004 98.94001 103.62091 110.55451 115.20211 120.66151 125.40361 130.51021 132.72961 134.53142 139.63261 141.85202 146.95862 151.66922 156.31682 158.89442 161.53323">tempRSP := Pop();</tspan><tspan y="-343.98062" x="95.520004 98.940002 103.6209 110.5815 115.20121 120.00361 124.7457 126.9651 128.76691 133.8681 136.08751 141.1842 145.9254 150.5631 153.1308 155.76961 157.62991 159.84932 162.41702 166.41573 168.63513 173.87584 179.15614 181.96684 186.64594 188.57463 191.99463 194.21404 198.85173 203.59293 208.23062 210.08913 212.30853 217.06323 219.04503 223.68272 228.48512 231.29582 236.03702 239.27972 243.95882 248.65051 251.95262 254.17203 259.41272 264.69302 266.91241 271.59152 273.51303 276.86374 280.88583 283.10522 287.78433 289.70584 293.72794 297.62766 302.07635 305.37845 310.01614 314.75647 319.39417 321.61356 325.61224">tempSS := Pop(); (* 64-bit pop, high-order 48 bits discarded *)</tspan><tspan y="-331.98093" x="59.520004 64.254906 66.361809">FI;</tspan><tspan y="-319.98123" x="59.520004 61.621506 66.351006 68.570404 73.353905 78.074402 85.026901 87.2463 94.146599 98.887802 103.50751 108.2478">IF new mode </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-319.98001" x="110.46 116.51986">≠ </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-319.98001" x="119.22 124.4877 129.7554 132.59311 137.87431 139.85611 143.23381 145.4532 151.9935 156.73471 161.39941">64-Bit Mode</tspan><tspan y="-307.98032" x="77.520302 82.7295 88.550697 93.300896">THEN</tspan><tspan y="-295.98062" x="95.520302 97.612801 102.3333 104.5527 109.27319 111.36569 116.48219 118.70159 120.65009 124.65959 126.87899 131.65349 136.37399 139.74449 141.9639 148.90739 150.8559 154.22639 159.0009 160.9494 165.72391 167.94331 172.66382 177.43832 179.65773 181.57922 183.52773 190.47122 192.41972">IF EIP is not within CS limit</tspan><tspan y="-283.98093" x="113.5203 118.7007 124.5471 129.26849 135.1149 137.3343 143.0997 148.3701 153.4875 156.0759 161.3373 163.92569 165.79408 168.01349 172.73489 174.82829">THEN #GP(0); FI;</tspan><tspan y="-271.98123" x="77.520302 82.237206 86.693108 91.464005 96.180908 98.400307 100.98421 104.99911 107.21851 111.9894 116.6973 123.63721 125.85661 132.79651 137.51341 142.16731 146.87521 149.09462 154.20752 156.42693 161.68382 166.94072 169.76762 174.42152 176.36642 179.78642 182.00583 188.94572 193.66263 198.31653 203.02443 205.24384 209.25873">ELSE (* new mode = 64-bit mode *)</tspan><tspan y="-259.98154" x="95.520302 97.601105 102.34231 104.56171 109.97251 112.05331 117.15811 119.37752 121.35931 125.38142 127.60082 132.36362 137.10481 141.86761 144.74852 148.63832 153.09512 157.89752 162.57843 167.38083 169.30232 173.19212 177.69122">IF RIP is non-canonical</tspan><tspan y="-247.98184" x="131.52029 136.7007 142.5471 147.26851 153.11491 155.33432 161.09972 166.37012 171.48752 174.07591 179.33731 181.9257 183.7941 186.0135 190.73491 192.82831">THEN #GP(0); FI;</tspan><tspan y="-235.98215" x="59.520294 64.255196 66.362099">FI;</tspan><tspan y="-223.98245" x="59.520294 64.229996 68.939697 73.388397 78.980095 84.238792 89.041191 91.260597 93.837296 98.546997 103.2567 105.0684 107.2878 112.4493 117.1302 118.9887 121.20811 126.7998 131.50951 133.32121 135.54062 140.70932 145.41902 147.23073 149.45013 154.25253 158.99373 160.80544 163.02484 168.19354 172.90324 174.71495 176.93436 182.51256 187.19347 189.05197 191.27138 196.98907 201.69878 203.51048 205.72989 211.56459 216.78279 219.3595 221.5789 223.3186 228.4243 230.64371 234.0034 238.7437 245.67639 250.32309 255.03279 259.74249 264.24161 269.82162 275.08032 279.84402">EFLAGS (CF, PF, AF, ZF, SF, TF, DF, OF, NT) := tempEFLAGS;</tspan><tspan y="-211.98276" x="59.520294 61.589394 66.330589 68.549988 74.255089 78.934189 83.622292 86.924393 91.369492 96.17189 100.80599 105.60839 107.53349 111.7347 116.4228">IF OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-211.98" x="118.62 124.67986">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-211.98" x="127.44 132.67351 137.95381 140.1732 144.9144 148.1562 150.3756 156.0771 160.7562 165.44069 168.7428 173.1843 177.98669 182.61719 187.41959 189.34108 193.54228 198.22678 200.44617 205.53568 207.75507 213.03537">32 or OperandSize = 64</tspan><tspan y="-199.9803" x="77.519699 82.702797 88.551895 93.275993 99.125092 101.34449 106.06859 110.74949 115.21259 120.81869 126.09179 130.83389 133.42499 138.85109 143.532 145.39049 147.60989 153.21599 157.94009 159.76619 161.9856 164.0817 169.6158 172.20689 174.4263 176.1804 181.30051 183.51991 186.89401 191.57492 198.52202 203.18312 207.86403 212.60524 217.06834 222.67444 227.89534 232.69775 234.56885 236.78825 241.51236 243.60846">THEN EFLAGS(RF, AC, ID) := tempEFLAGS; FI;</tspan><tspan y="-187.98061" x="59.519699 61.611298 66.330902 68.550301 73.269897 78.385498 82.844101">IF CPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-187.98061" x="85.079697 90">≤ </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-187.98061" x="92.279694 94.372192 100.10069 105.21719 109.6767">IOPL </tspan><tspan y="-175.98091" x="77.519691 82.70639 88.55909 93.286789 99.139488 101.35889 106.08659 110.76749 115.23418 120.84389 126.12059 130.86269 133.45738 135.55708 140.28479 142.87949 145.09888 146.85658 151.98029 154.19968 157.57738 162.25829 169.20898 173.82869 178.5564 183.2841 187.75081 193.3605 198.63721 203.41891 205.29361 207.513 212.24071 214.28191">THEN EFLAGS(IF) := tempEFLAGS; FI;</tspan><tspan y="-163.98122" x="59.519691 61.61129 66.330887 68.550285 73.269882 78.385483 82.844086">IF CPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-163.98" x="85.080002">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cAF7646FE"><tspan y="-163.98" x="91.139862"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-163.98" x="93.839996">0</tspan><tspan y="-151.9803" x="77.520294 82.729492 88.55069 93.300888">THEN</tspan><tspan y="-139.98061" x="95.520294 100.24709 104.97389 109.43969 115.04849 120.3243 125.10509 127.6989 129.7977 135.49561 140.61841 145.08421 147.67801 149.8974 151.65421 156.77701 158.9964 162.3732 167.091 174.0408 178.66051 183.38731 188.06822 192.53403 198.14282 203.41862 208.16074">EFLAGS(IOPL) := tempEFLAGS;</tspan><tspan y="-127.9809" x="95.520294 97.589394 102.33059 104.54999 110.25509 114.93419 119.62229 122.92439 127.36949 132.17189 136.80598 141.60838 143.53348 147.73468 152.42278">IF OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-127.98" x="154.62 160.67986">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-127.98" x="163.44 168.67081 173.95111 176.1705 180.9117 184.1535 186.37289 192.0717 196.75081 201.43262 204.73473 209.17352 213.97592 218.60373 223.40613 225.32492 229.52612 234.20792 236.42731 241.58882 243.80821 249.03902">32 or OperandSize = 64</tspan><tspan y="-115.9803" x="113.5197 118.7055 124.5573 129.2841 135.13591 137.35532 142.08212 146.76303 151.22884 156.83763 162.11343 166.85553 169.44933 175.13013 177.22893 181.95573 183.78453 186.00394 191.64514 193.74574 198.86855 201.46234 203.68173 205.43854 210.56134 212.78073 216.15753 220.87534 227.77563 232.45474 237.18155 241.86246 246.32826 251.93706 257.21286 261.95496 263.82877 266.04816 270.77496 272.87375">THEN EFLAGS(VIF, VIP) := tempEFLAGS; FI;</tspan><tspan y="-103.9806" x="59.519699 64.254601 66.361504">FI;</tspan><tspan y="-91.980896" x="59.519699 61.627499 66.363297 68.582703 73.324806 78.127213 82.566917 87.246017 91.981819 98.882118 103.67192 107.05772 111.54153 115.45833 119.71803 124.39893 129.18872 133.62842 138.30122 140.23802 144.96483 149.58453 152.18733 156.92313 162.05493 166.52972">IF ShadowStackEnabled(CPL)</tspan><tspan y="-79.981194" x="77.519699 80.158501 84.180603 86.400002 90.301498 95.075996 99.787498 103.689 107.9685 110.1879 112.1364 115.4709 117.6903 122.9508 125.1702 129.8277 134.5032 137.8737 142.58521 144.80461 149.27312 151.19461 153.14311 157.80061 162.57512 167.28662 171.94412 174.16353 178.18202">(* check if 8 byte aligned *)</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="405.01215pt" height="644.28516pt" viewBox="0 0 405.01215 644.28516" sodipodi:docname="636.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="329.47713" inkscape:cy="423.50651" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg130" /><g transform="translate(-58.892151,-69.344727)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="76.68 78.778801 83.5056 85.724998 90.505798 95.247902 100.3707 102.5901 108.19891 114.0507 119.5875 121.8069 127.0737 131.81129 137.07809 139.29749 141.04529 146.16809 148.38748">IF SSP AND 0x7 != 0</tspan><tspan y="-703.98029" x="94.68 99.859497 105.70499 110.42549 116.27099 118.49039 124.25489 128.97539 134.09189 136.67938 141.39989 147.00238 152.42488 155.25539 160.67789 165.39839 170.5779 173.7054 175.7979 181.2204 185.9409 191.12041 193.7079 195.57539 197.7948 202.5153 204.6078">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-691.98059" x="76.68 78.772499 83.492996 85.712395 90.432892 95.20739 97.794891 103.21739 108.33389 112.7934 115.3809 117.6003 119.3418 124.5033 126.72269">IF CS(RPL) != 3</tspan><tspan y="-679.9809" x="94.68 99.889198 105.7104 110.46059">THEN</tspan><tspan y="-667.9812" x="112.68 116.1 120.7809 127.74149 132.36119 137.16359 141.18568 145.88458 150.68698 152.90639 158.00128 160.22069 164.24278 169.04518 173.49208 178.17117 182.87007 189.83067 194.39186 198.35367 201.77368 206.21338 210.09328 214.35118 218.91237 220.83388 225.57507 230.01477 234.69386 236.91327 242.19357 244.41298 249.04887 253.70277 257.05167 261.79199 265.81412 268.03351 271.34641 274.58731 279.32852 286.28912 288.50851 293.26141 298.06381 303.15872 308.30762 313.58792 318.80792">tempSsCS = shadow_stack_load 8 bytes from SSP+16;</tspan><tspan y="-655.98151" x="112.68 116.1 120.7809 127.7181 132.36931 137.13751 141.14072 145.59392 147.68011 152.79031 155.00972 160.11992 162.33932 166.34253 171.11073 175.57294 180.22414 184.93834 191.87553 196.41873 200.42194 203.78613 208.24834 212.14354 216.46263 221.00583 222.95969 227.70088 232.19998 236.83408 239.05348 244.33379 246.55319 251.18729 255.83939 259.18649 263.92679 267.94891 270.1683 273.4794 276.78149 281.47861 288.43921 290.6586 295.461 300.20309 305.2962 310.4433 315.7236">tempSsLIP = shadow_stack_load 8 bytes from SSP+8;</tspan><tspan y="-643.98181" x="112.67999 116.0631 120.744 127.7001 132.31979 137.10689 141.84898 146.97809 149.19748 154.32658 156.54597 160.56807 165.31017 169.79126 174.41096 179.14406 186.10016 190.60106 194.62315 198.00626 202.48735 206.40144 210.69354 215.25565 217.18974 221.92284 226.36253 231.03264 233.25203 238.47203 240.69142 245.36153 250.04962 253.43272 258.11362 262.13571 264.35513 267.70224 270.97733 275.71042 282.6665 284.88593 289.62802 294.43042 299.55951">tempSSP = shadow_stack_load 8 bytes from SSP;</tspan><tspan y="-631.98212" x="112.67999 117.45899 122.23799 127.35899 129.5784 134.6994 136.91881 141.69781 146.43993 151.56093 153.78033 158.95534 161.17474 166.43974 171.70474">SSP = SSP + 24;</tspan><tspan y="-619.98242" x="112.67999 115.31879 119.3409 121.5603 127.0863 131.80229 134.0217 139.27769 144.53369 146.7531 151.4061 153.3501 156.71609 158.9355 162.8325 167.54851 174.4875 179.1405 183.60451 186.9066 191.6136 193.83301 197.19901 201.91501 204.13441 208.78741 213.49442 216.86041 221.56741 225.46442 228.8403 231.05969 235.6794 237.66121 241.04251 245.06281 247.2822 251.9505 256.63138 261.31769 266.04898 270.79108 275.47018 277.68961 282.90961 288.18991 290.40933 295.07764 299.75851 301.7178 306.4599 311.1282 313.34763 317.36792 322.0488 325.43008 327.64951 331.6788">(* Do 64 bit compare to detect bits beyond 15 being set *)</tspan><tspan y="-607.98273" x="112.68 116.1 120.7809 127.7244 132.3819 137.1024 141.87691 144.09631 149.21281 151.43222 156.15273 160.92723 162.79472 165.01413 167.60162 171.62012 173.83952 178.00203 182.71353 185.97603 190.69653 192.91594 197.57344 202.04195 206.69945 211.35695 216.06845 220.72595 222.94536 226.36536 231.04626 233.26567 238.52617 243.78667 246.00607 250.66357 252.61208 255.98257 258.20197 262.22046">tempCS = CS; (* zero padded to 64 bit *)</tspan><tspan y="-595.98303" x="112.68 114.7698 119.48759 121.70699 125.07479 129.78358 136.72438 141.37918 146.09698 150.86879 153.0882 154.827 159.9408 162.1602 165.5802 170.26111 177.2019 181.8567 186.62851 190.63531 195.35312">IF tempCS != tempSsCS</tspan><tspan y="-583.98334" x="130.67999 135.85229 141.6906 146.4039 152.2422 154.46161 160.2189 164.93221 170.0415 172.62181 177.33511 182.93042 188.34572 191.22662 196.64192 201.35522 206.52753 209.64783 211.73312 217.14842 221.86172 227.03403 229.61433 231.53404 233.75345 238.46675 240.55205">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-571.98364" x="112.67999 115.27739 119.30579 121.52518 127.06558 131.74649 133.96588 139.23628 144.50668 146.72607 151.34578 153.32759 156.70799 158.92738 162.83879 167.56918 174.46948 179.14859 183.58829 186.89038 191.57129 193.43158 195.65097 200.31837 204.75807 209.42548 211.64487 216.37527 221.11737 226.44177 232.05417 236.79626 241.56 246.70979 252.16919 254.24098 259.4025 261.62192 268.54471 270.52649 273.87628 278.67871 280.89813 286.13794 288.35736 291.71619 296.39709 299.69919 301.91861 307.15842 312.43872 314.65814 319.33725 321.25876 324.60855 326.82797 331.32709 333.4277 338.5235 340.74292 344.74072">(* Do 64 bit compare; pad CSBASE+RIP with 0 for 32 bit LIP *)</tspan><tspan y="-559.98395" x="112.67999 114.78329 119.5146 121.73399 126.46529 131.2074 136.5327 142.1127 146.89799 151.5789 153.79829 158.9796 161.19899 166.63229 168.7356 173.8629 176.08229 177.83459 182.9619 185.18129 188.56259 193.2849 200.1852 204.8643 209.6496 213.61139 218.34268 220.44598">IF CSBASE + RIP != tempSsEIP</tspan><tspan y="-547.98425" x="130.67999 135.85229 141.6906 146.4039 152.2422 154.46161 160.2189 164.93221 170.0415 172.62181 177.33511 182.93042 188.34572 191.22662 196.64192 201.35522 206.52753 209.64783 211.73312 217.14842 221.86172 227.03403 229.61433 231.53404 233.75345 238.46675 240.55205">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-535.98456" x="112.67999 115.31879 119.3409 121.5603 125.46179 130.2363 134.9478 138.8493 143.1288 145.34821 147.29671 150.63121 152.85062 158.11111 160.33052 164.98802 169.66353 173.03403 177.74553 179.96494 184.43344 186.35493 188.30344 192.96094 197.73544 202.44695 207.10445 209.32385 213.34235">(* check if 4 byte aligned *)</tspan><tspan y="-523.98486" x="112.67999 114.77609 119.50019 121.71959 125.09369 129.80879 136.70909 141.3882 146.13031 150.93272 156.05283 158.27223 163.87833 169.72743 175.26154 177.48094 182.74504 187.48264 192.74673 194.96614 196.71124 201.83134 204.05075">IF tempSSP AND 0x3 != 0</tspan><tspan y="-511.98517" x="130.67999 135.85229 141.6906 146.4039 152.2422 154.46161 160.2189 164.93221 170.0415 172.62181 177.33511 182.93042 188.34572 191.22662 196.64192 201.35522 206.52753 209.64783 211.73312 217.14842 221.86172 227.03403 229.61433 231.53404 233.75345 238.46675 240.55205">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-499.98547" x="76.679993 81.414894 83.521797">FI;</tspan><tspan y="-487.98578" x="58.61969 63.354591 65.461494">FI;</tspan><tspan y="-475.98608" x="58.61969 62.039688 66.720589 73.651489 78.296387 84.012283 85.921181 90.566078 95.273979 100.37788 104.87698 107.09637 112.20027 114.41967 119.12757 124.28907 128.73598">tempOldCPL = CPL;</tspan><tspan y="-463.98639" x="58.61969 63.345589 68.467491 72.932388 75.151787 76.907684 82.029587 84.248985 88.974884 93.71698 96.309883 101.73779 106.85969 111.32458 113.91749">CPL := CS(RPL);</tspan><tspan y="-451.98669" x="76.679993 78.748192 83.489388 85.708786 91.412987 96.092087 100.83239 104.07419 108.51839 113.32079 117.95399 122.75639 124.73819 128.87909 133.56628 135.78569 140.94719 143.1666 148.4028">IF OperandSize = 64</tspan><tspan y="-439.987" x="94.679993 99.889191 105.71039 110.46059">THEN</tspan><tspan y="-427.9873" x="112.67999 118.1358 122.8779 128.02769 130.1868 131.9283 137.0295 139.2489 142.6086 147.34889 154.24919 158.92828 164.32828 169.13068 174.23187">RSP := tempRSP;</tspan><tspan y="-415.98761" x="112.67999 117.46439 122.24879 124.4079 126.1683 131.29469 133.51408 136.89449 141.61589 148.51619 153.1953 157.93739 162.73979">SS := tempSS;</tspan><tspan y="-403.98792" x="76.679993 81.414894 85.888794 90.677696">ELSE</tspan><tspan y="-391.98822" x="94.679993 99.417595 104.2092 109.3428 111.5019 113.2695 118.4031 120.62251 124.01011 128.69101 135.65161 140.27132 145.00891 149.75101 154.88461">ESP := tempESP;</tspan><tspan y="-379.98853" x="94.679993 99.464394 104.24879 106.4079 108.1683 113.29469 115.5141 118.8945 123.6159 130.5162 135.19531 139.93741 144.73981">SS := tempSS;</tspan><tspan y="-367.98883" x="76.679993 81.414894 83.521797">FI;</tspan><tspan y="-355.98914" x="76.679993 78.784195 83.516396 85.735794 90.521996 95.202896 102.1581 104.37749 111.27779 116.019 120.68819 125.36909 127.58849 129.34169 134.46989 136.68929 141.96149 147.23369 150.07588 155.35709 157.3389 160.7211 162.94049 169.52669 174.20758 178.87679">IF new mode != 64-Bit Mode</tspan><tspan y="-343.98944" x="94.679993 99.889191 105.71039 110.46059">THEN</tspan><tspan y="-331.98975" x="112.67999 114.77249 119.49299 121.71239 126.43288 128.52539 133.64189 135.8613 137.8098 141.81931 144.03871 148.81322 153.53372 156.90422 159.12363 166.06712 168.01562 171.38612 176.16063 178.10913 182.88364 185.10304 189.82355 194.59805 196.81746 198.73895 200.68745 207.63095 209.57945">IF EIP is not within CS limit</tspan><tspan y="-319.99005" x="130.67999 135.8568 141.6996 146.4174 152.26021 154.47961 160.24141 165.50821 170.62201 173.2068 178.4646 181.04939 182.9142 185.13361 189.85141 191.94121">THEN #GP(0); FI;</tspan><tspan y="-307.99036" x="76.679993 81.398697 85.8564 90.629097 95.347794 97.568092 100.15379 104.17049 106.39079 111.16349 115.87319 122.8149 125.03519 131.9769 136.6956 141.3513 146.061 148.28131 153.39601 155.61632 160.87502 166.13371 168.96242 173.61812 175.56482 178.93352 181.15382 188.09552 192.81422 197.46992 202.17963 204.39993 208.41663">ELSE (* new mode = 64-bit mode *)</tspan><tspan y="-295.99066" x="94.679993 96.783295 101.5146 103.73399 109.134 111.2346 116.36189 118.58129 120.54059 124.56089 126.78029 131.52238 136.2636 141.04889 143.89018 147.80249 152.24219 157.02748 161.70839 166.49368 168.41519 172.32748 176.80678">IF RIP is non-canonical</tspan><tspan y="-283.99097" x="112.67999 117.86039 123.70679 128.42819 134.2746 136.494 142.2594 147.5298 152.6472 155.2356 160.49699 163.08539 164.95378 167.17319 171.89459 173.98799">THEN #GP(0); FI;</tspan><tspan y="-271.99127" x="76.679993 81.414894 83.521797">FI;</tspan><tspan y="-259.99158" x="76.679993 80.063095 84.743996 91.700096 96.319794 102.06089 103.99499 108.61469 113.40179 118.18889 123.31799 125.53738 130.66649 132.88588 137.67297 142.41507 147.54417">tempOldSSP = SSP;</tspan><tspan y="-247.99188" x="76.679993 78.789597 83.527199 85.746605 90.538208 95.280312 99.765915 104.38561 109.12321 116.02351 120.81512 124.20272 128.68832 132.60692 136.86662 141.60782 146.34991 150.84901 155.46872 157.39021 162.11882 166.73853 169.34312 174.08072 179.21432 183.69092">IF ShadowStackEnabled(CPL)</tspan><tspan y="-235.99219" x="94.679993 96.76799 101.48399 103.70339 108.4194 113.53139 117.9864 120.2058 125.31779 127.53719">IF CPL = 3</tspan><tspan y="-223.99249" x="112.67999 117.88739 123.70859 128.45699 134.27818 136.49759 139.8573 144.5976 151.49789 156.17699 160.97939 165.72148 170.82268 173.04208 174.82048 179.92168 182.15999 184.26689 189.88379 195.15869 200.37869 204.9426 210.0735 214.54741 219.76741 224.33131 229.12021 233.9091 239.04001 240.92191 243.1413 247.82219 249.92279">THEN tempSSP := IA32_PL3_SSP; FI;</tspan><tspan y="-211.9928" x="76.679985 78.780586 83.509186 85.728584 88.324188 90.843285 92.943886 98.554489 103.77449 109.05479 113.6124 118.2933 123.0219 127.7505 133.18109 134.89468 139.36229 145.90259 151.48259 153.70198 159.31258 165.16618 170.70479 172.92418 177.65279 182.3949 184.10849 188.5761 191.17169 193.39108 198.51569 200.73508 205.95508 208.17447 213.78506 219.63867 225.17728 227.39667 230.77527 235.49487 242.39517 247.07428 251.81638 256.61877 261.74338 264.50998 269.77856 274.99857 276.75717 281.97714 287.24573 290.01233 292.23172 293.98132 299.10593 301.32532 306.59393 309.18954 311.40894 317.10684">IF ((IA32_EFER.LMA AND CS.L) = 0 AND tempSSP[63:32] != 0) OR</tspan><tspan y="-199.9931" x="86.699684 89.291687 91.88369 93.98069 99.587692 104.85269 110.11769 114.61859 119.34359 124.06859 128.7495 134.1765 135.85681 140.32082 146.89981 152.50681 154.72621 160.33321 166.18321 171.71822 173.93762 178.66263 183.40474 185.11475 189.57875 192.17075 194.39015 199.51115 201.73056 206.99556 209.21497 214.82196 220.67197 226.20697 228.42638 231.80138 236.51738 243.41768 248.09679 252.8389 257.6413 262.7623 264.98169 266.93469 270.89651 273.11591 277.8949 282.6199 285.9949 288.21429 292.1203 296.57968 301.35507 306.07648 310.85187 312.80127 316.70367 321.17307 323.09546 325.31485 328.57825 333.29065 335.21304 339.68243 343.05383 345.00323 349.64365 354.35605 356.57544 359.94684 364.66824 366.88763 370.25903 374.99939 379.72888 381.9483 385.8678 390.60989 393.89038 397.13217 401.86166 406.60376 409.99225 412.21167 416.88718 421.32687 426.00238 427.92386 432.71637 437.39188 439.6113 446.5116 451.25278 455.8725 460.61279">((IA32_EFER.LMA AND CS.L) = 1 AND tempSSP is not canonical relative to the current paging mode)</tspan><tspan y="-187.99341" x="94.679077 99.859474 105.70587 110.42727 116.27367 118.49306 124.25847 129.52887 134.64627 137.23466 142.49606 145.08446 146.95285 149.17226 153.89366 155.98706">THEN #GP(0); FI;</tspan><tspan y="-175.99371" x="76.679077 81.464378 86.24968 91.376984 93.536087 95.297386 100.42468 102.64409 106.02539 110.74769 117.70199 122.32169 127.10699 131.84909">SSP := tempSSP</tspan><tspan y="-163.99402" x="76.679077 81.413979 83.520882">FI;</tspan><tspan y="-151.99432" x="76.679077 79.281876 83.315674 85.53508 91.356285 96.097488 102.99779 105.21719 109.88999 114.3297 118.3545 121.7403 123.95971 128.44351 130.38031 132.31711 134.5365 137.83589 142.33499 147.07709 148.99858 152.38438 154.30589 159.09569 163.71539 165.93478 170.60759 175.28848 177.25229 182.04208 185.42789 189.45268 191.33548 193.55939 197.56439 202.0284 205.3584 210.0654 212.28481 215.6508 220.36681 222.58621 225.91621 229.21831 233.92531 238.63231 240.85172 244.21771 248.98772 253.69472 255.91412 259.28012 263.99612 268.27112 272.97812 277.74811 279.48871 281.7081 286.88309 291.65308 296.36008 298.57947 301.94547 306.66147 310.93646 315.65967 320.41528 322.63467 325.9935 329.23529 333.92789 338.66818 340.88757 342.81717 346.80777 349.02716 353.70627 358.44748 363.20306 367.94336 370.16275 374.91833 378.90894 380.83853 385.64093 390.32004 392.53943 395.89102 400.64661 405.3869 407.60629 412.30789 414.21048 418.88959 421.10898 425.91138 430.6535">(* Now past all faulting points; safe to free the token. The token free is done using the old SSP</tspan><tspan y="-139.99463" x="76.679962 78.899368 82.932266 85.151672 89.634575 94.376678 99.048576 101.26798 106.05688 110.01868 111.98158 116.72369 121.39558 123.61499 128.05469 130.27408 134.29797 139.08687 143.70657 148.44688 151.72379 156.37769 158.29919 162.32129 167.05618 170.33308 172.55247 177.28737 181.94127 186.62218 189.92429 193.20119 195.16409 199.7838 204.52411 206.7435 211.1832 215.20529 217.42468 222.15958 224.03967 228.65938 230.87878 235.60199 240.72119 245.1834 247.4028 254.349 258.82019 262.8324 265.05179 269.52298 271.74237 275.75458 280.53177 285.19196 289.90616 293.17136 297.81357 299.76477 303.77698 308.50018 311.69968 313.9191 318.59821 321.84 323.82178 328.44058 330.36298 332.34387 337.02927 341.70837 346.39377 348.61319 350.50858 355.24887 359.86227 364.54767 366.52856 368.74799 372.74039"> * and using a supervisor override as old CPL was a supervisor privilege level *)</tspan><tspan y="-127.99493" x="76.679977 78.790474 83.528976 85.748383 90.540886 95.28299 99.769493 104.38919 109.12769 116.02799 120.8205 124.209 128.6955 132.61499 136.87469 141.61589 146.35799 150.85709 155.47679 157.39828 162.12779 166.7475 169.353 172.7415 177.42241 184.38301 189.00272 194.76093 196.70042 201.32013 206.05862 211.19313 215.67062">IF ShadowStackEnabled(tempOldCPL)</tspan><tspan y="-115.99522" x="94.679977 99.399582 104.19118 108.81089 113.55119 117.46078 120.83939 125.52029 130.1994 134.757 138.1356 142.86421 147.15181 151.83272 156.63513 161.19273 165.84033 170.31693 172.24652 176.98862 181.72893 183.94832 189.07292 191.29231 194.67091 199.39052 206.29082 210.96992 216.66783 218.58932 223.25493 227.99704 232.77963 237.90424 240.12363 242.08023 244.29962 249.58083 255.28233 260.02444 265.18594 269.74353 275.02472 277.12531 282.3129 284.53229 287.1279 291.15451 293.3739 298.03949 302.82208 306.78391 311.4639 313.68329 318.34888 320.27039 323.64899 325.86838 328.70697 330.92636 335.54605 337.52786 340.90646 343.12585 347.79144 352.47235 356.48996 358.44656 361.82516 363.74667 368.47528 373.21738 375.43677 380.70538 382.92477 385.76337 387.98276 394.93436 399.67645 403.69406 407.07266 409.29205 413.95764 418.63855 420.85794 424.87555 429.59515 432.97375 435.19315 439.21976">expected_token_value = tempOldSSP | BUSY_BIT (* busy bit - bit position 0 - must be set *)</tspan><tspan y="-103.99552" x="94.679977 99.456276 104.16958 111.11488 115.66618 119.03848 123.76077 128.04207 132.75537 137.53168 142.08298 146.72427 151.19458 153.11787 157.89418 162.60748 164.82689 169.94519 172.1646 175.5369 180.2502 187.1955 191.8548 197.5851 199.50839 204.16769 208.944 213.72031 218.76028 220.97968 223.57617 227.60367 229.82306 233.73357 235.66406 240.38457 244.82426 248.09576 250.31516 253.69466 258.43674 263.15723 265.37665 270.04315 274.78525 278.80374 283.48825 285.70767 290.32736 292.30914 295.68863 297.90805 301.93555">new_token_value = tempOldSSP (* clear the busy bit *)</tspan><tspan y="-91.995819" x="94.679985 98.702087 103.48919 107.92889 112.60799 117.34109 124.24139 128.8035 132.82559 136.20869 140.64839 144.56248 148.85458 153.35548 155.33638 160.01727 163.91696 168.20906 172.70996 176.62405 183.58015 188.25026 192.98785 196.90195 201.68904 206.30875 211.58905 216.25916 218.85925 222.24236 226.92326 233.87936 238.54947 244.24738 246.16887 250.83897 255.58107 260.36816 265.49725 267.33237 269.55179 274.3389 279.06299 285.96329 290.52451 293.90759 298.64069 302.9328 307.65689 312.39899 316.96021 321.6123 326.09341 328.02753 332.76962 337.49371 339.32883 341.54825 346.27234 351.00995 355.68005 360.36093 364.27502 367.65811 372.33899 377.0181 381.51901 384.939 389.6199 393.93903 398.6199 403.4223 407.92322 412.60233 417.04202 418.96353 423.75064 428.43152">shadow_stack_lock_cmpxchg8b(tempOldSSP, new_token_value, expected_token_value)</tspan><tspan y="-79.996117" x="76.679985 81.414886 83.52179">FI;</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="479.09055pt" height="632.63599pt" viewBox="0 0 479.09055 632.63599" sodipodi:docname="637.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.63962" inkscape:cy="423.75745" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg166" /><g transform="translate(-46.020287,-81.182129)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-703.97998" x="59.52 64.263 69.960899 75.405899 77.625298 82.306198 86.805298 90.729301 95.471397 97.690796 102.48779 107.16869 111.84869 117.2487 121.9827 126.60239 128.82179 130.79279 135.53488 137.75427 140.36427 145.04517 149.84216 151.64127 153.86066 158.60365 163.34575 165.19075 167.41014 172.63104 177.43344 179.23254 181.45193 185.94293 190.68503 195.36502 197.58441 203.13741 207.9344">FOR each SegReg in (ES, FS, GS, and DS)</tspan><tspan y="-691.98029" x="77.520004 83.098206">DO</tspan><tspan y="-679.98059" x="95.520004 98.899506 103.58041 110.53291 115.1526 120.6921 125.4126 129.43109 133.3416 135.56099 137.3205 142.446 144.66539 149.33189 154.0128 158.0313 161.9418 165.2133 167.17081 171.83731 175.21681 179.89772 183.19981 185.4192 189.32971 193.76941 197.67992 202.46341 207.14432 209.36371 212.70721 217.43672 220.70822 222.92761 227.66971 232.41002 237.07652 242.50803 247.18893 251.86804 254.08743 256.68393 260.71143 262.93085 267.71436 269.63583 274.30234 278.92203 283.64252 288.38461 290.60403 295.27054 299.71024 302.98175 306.36124 308.58066 313.31015 316.60956 318.82898 322.84747 327.52835 332.19485 339.14737 343.82825 348.63065 352.01013 354.22955 357.50107 362.22156 366.84125 368.82303 372.84152 376.22101 380.90189 384.20401 386.42343 390.45093">tempDesc := descriptor cache for SegReg (* hidden part of segment register *)</tspan><tspan y="-667.9809" x="95.520004 97.597206 102.33841 104.55781 107.13 111.9324 116.6286 121.3077 128.2359 132.9762 137.7354 141.1554 145.9146 150.65489 152.5611 157.25729 161.14349 164.49869 169.23988 172.48169 174.7011 179.86259 184.96379 187.1832 193.0134 198.71489 203.15909 207.60329 210.2421 212.4615 218.1747 223.58189 225.8013 228.44011 231.7998 236.496 243.4566 248.0988 253.677 258.3732 262.3674 266.2536 268.82581 274.341 279.4422 283.94131 286.52072 288.74011 293.75131 295.9707 300.6759 305.7771 310.27621 312.49561 318.08279 323.91299 329.49118 331.71057 335.06577 339.76196 346.72256 351.34229 356.92047 361.60138 365.59558 369.48178 372.05399 377.2182 381.87839 386.5575 391.25369 393.8259 396.04529 398.0271 402.04919 404.26859 406.84079 411.483 415.98209 419.34177 423.84085 426.06024 430.76544 434.06754 436.28693 441.04611 445.78732 450.54651 453.36169 457.24789 461.98911 466.7915 470.09091 474.83212 478.07391 485.03452 486.95602 491.75842 496.43753 498.65692 502.54312 507.24832 511.92743 516.60834 519.18054 521.81934">IF (SegmentSelector == NULL) OR (tempDesc(DPL) &lt; CPL AND tempDesc(Type) is (data or non-conforming code)))</tspan><tspan y="-655.9812" x="113.52 118.7382 124.5594 129.2637 135.093 137.31241 139.88371 143.88602 146.10542 150.90782 155.58871 160.23001 167.15732 171.89761 176.70001 180.05431 182.27371 185.52002 190.26031 194.90161 196.88341 200.87671 204.29671 208.992 212.23831 214.45772 216.43951 221.24191 225.86522 230.31752 232.22282 234.20462 238.84592 241.06532 245.06763">THEN (* Segment register invalid *)</tspan><tspan y="-643.98151" x="131.52 136.3071 140.98801 145.65811 152.61421 157.29512 162.09752 165.48062 170.22272 174.94682 176.88092 181.60503 185.51912 188.90222 193.58311 196.85822 199.07761 200.84071 205.96982 208.18921 213.46231 215.34241 217.5618 220.1619 224.19299 228.98009 233.661 238.3311 245.2314 249.95551 254.6976 258.08069 260.30011 264.2619 269.0022 270.93631 275.61719 279.53128 282.91437 287.59528 290.89737 293.11679 297.73648 302.47678 306.39087 311.07178 318.02786 322.70874 326.73083 328.95026 333.73737 338.47946 340.41357 342.34769 346.37878">SegmentSelector := 0; (*Segment selector becomes null*)</tspan><tspan y="-631.98181" x="95.520004 100.25491 102.36181">FI;</tspan><tspan y="-619.98212" x="77.520004 83.257507 88.797005">OD;</tspan><tspan y="-607.98242" x="46.020004 50.714405 56.595005 62.099403">END;</tspan><tspan y="-583.98212" x="46.020004 51.434406 56.146805 61.318207 66.993607 72.408005 78.245407 81.126312 86.28511 92.005508 94.827911 99.630318 105.21032 111.81092 116.49182 119.37273 124.47392 129.88832 131.97272 137.67421 139.77481 144.22621 148.93861 154.20001 158.91241 161.73482 166.18622 170.89862 176.60011 181.31252 185.81161 187.55402 189.77342 192.35283 196.36324 198.58264 203.69104 208.40344">RETURN-TO-SAME-PRIVILEGE-LEVEL: (* PE </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-583.97998" x="210.60001 216.59947">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-583.97998" x="219.36 224.6178 226.43759 228.657 234.0768 239.1906 243.6474">1, RPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-583.97998" x="245.88 251.87947">= </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-583.97998" x="254.64 259.35599 264.46799 268.92297 271.14236 275.15637">CPL *)</tspan><tspan y="-571.98029" x="59.520004 61.621506 66.351006 68.570404 73.353905 78.074402 85.026901 87.2463 94.146599 98.887802 103.50751 108.2478">IF new mode </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-571.97998" x="110.46 116.51986">≠ </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-571.97998" x="119.22 124.4877 129.7554 132.59311 137.87431 139.85611 143.23381 145.4532 151.9935 156.73471 161.39941">64-Bit Mode</tspan><tspan y="-559.98029" x="77.520302 82.7295 88.550697 93.300896">THEN</tspan><tspan y="-547.98059" x="95.520302 97.612801 102.3333 104.5527 109.27319 111.36569 116.48219 118.70159 120.65009 124.65959 126.87899 131.65349 136.37399 139.74449 141.9639 148.90739 150.8559 154.22639 159.0009 160.9494 165.72391 167.94331 172.66382 177.43832 179.65773 181.57922 183.52773 190.47122 192.41972">IF EIP is not within CS limit</tspan><tspan y="-535.9809" x="113.5203 118.7007 124.5471 129.26849 135.1149 137.3343 143.0997 148.3701 153.4875 156.0759 161.3373 163.92569 165.79408 168.01349 172.73489 174.82829">THEN #GP(0); FI;</tspan><tspan y="-523.9812" x="77.520302 82.237206 86.693108 91.464005 96.180908 98.400307 100.98421 104.99911 107.21851 111.9894 116.6973 123.63721 125.85661 132.79651 137.51341 142.16731 146.87521 149.09462 154.20752 156.42693 161.68382 166.94072 169.76762 174.42152 176.36642 179.78642 182.00583 188.94572 193.66263 198.31653 203.02443 205.24384 209.25873">ELSE (* new mode = 64-bit mode *)</tspan><tspan y="-511.98151" x="95.520302 97.601105 102.34231 104.56171 109.97251 112.05331 117.15811 119.37752 121.35931 125.38142 127.60082 132.36362 137.10481 141.86761 144.74852 148.63832 153.09512 157.89752 162.57843 167.38083 169.30232 173.19212 177.69122">IF RIP is non-canonical</tspan><tspan y="-499.98181" x="131.52029 136.7007 142.5471 147.26851 153.11491 155.33432 161.09972 166.37012 171.48752 174.07591 179.33731 181.9257 183.7941 186.0135 190.73491 192.82831">THEN #GP(0); FI;</tspan><tspan y="-487.98212" x="59.520294 64.255196 66.362099">FI;</tspan><tspan y="-475.98242" x="59.520294 64.229996 68.939697 73.388397 78.980095 84.238792 89.041191 91.260597 93.837296 98.546997 103.2567 105.0684 107.2878 112.4493 117.1302 118.9887 121.20811 126.7998 131.50951 133.32121 135.54062 140.70932 145.41902 147.23073 149.45013 154.25253 158.99373 160.80544 163.02484 168.19354 172.90324 174.71495 176.93436 182.51256 187.19347 189.05197 191.27138 196.98907 201.69878 203.51048 205.72989 211.56459 216.78279 219.3595 221.5789 223.3186 228.4243 230.64371 234.0034 238.7437 245.67639 250.32309 255.03279 259.74249 264.24161 269.82162 275.08032 279.84402">EFLAGS (CF, PF, AF, ZF, SF, TF, DF, OF, NT) := tempEFLAGS;</tspan><tspan y="-463.98273" x="59.520294 61.589394 66.330589 68.549988 74.255089 78.934189 83.622292 86.924393 91.369492 96.17189 100.80599 105.60839 107.53349 111.7347 116.4228 118.6422">IF OperandSize =</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-463.98273" x="123.7803"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-463.98273" x="126.0006 131.2809 136.5009 138.72029 143.46059 146.70239 148.92178 154.67009 159.28979 164.02109 167.26289 171.75119 176.49329 181.17059 185.91269 187.881 192.0219 196.7532 198.9726 204.1089 206.32829 211.6086">32 or OperandSize = 64</tspan><tspan y="-451.98303" x="77.520294 82.703392 88.55249 93.276588 99.125687 101.34509 106.06918 110.75008 115.21318 120.81928 126.09238 130.83449 133.42558 138.85168 143.53259 145.39108 147.61049 153.21658 157.94069 159.76678 161.98619 164.08229 169.61639 172.20749 174.4269 176.181 181.3011 183.52051 186.89461 191.57552 198.52261 203.18372 207.86462 212.60583 217.06894 222.67503 227.89594 232.69835 234.56944 236.78885 241.51295 243.60905">THEN EFLAGS(RF, AC, ID) := tempEFLAGS; FI;</tspan><tspan y="-439.98334" x="59.520294 61.611893 66.331497 68.550896 73.270493 78.386093 82.844696">IF CPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-439.98334" x="85.080292 90.000595">≤ </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-439.98334" x="92.280289 94.359291 100.0743 105.17729">IOPL</tspan><tspan y="-427.98364" x="77.520287 82.706985 88.559685 93.287384 99.140083 101.35948 106.08718 110.76808 115.23478 120.84448 126.12119 130.8633 133.45799 135.55769 140.2854 142.8801 145.09949 146.85719 151.9809 154.20029 157.57799 162.2589 169.20959 173.8293 178.55701 183.28471 187.75142 193.36111 198.63782 203.41953 205.29422 207.51361 212.24132 214.28252">THEN EFLAGS(IF) := tempEFLAGS; FI;</tspan><tspan y="-415.98395" x="59.520287 61.612785 66.333282 68.552681 73.273178 78.389679 82.849182 85.068581 90.185081 92.40448 97.664978">IF CPL = 0 </tspan><tspan y="-403.98425" x="46.020287 77.519386 79.738785 84.942581 90.763779 95.508575 101.32977">  THEN </tspan><tspan y="-391.98456" x="95.520287 97.739685 102.46648 107.19328 111.65908 117.26788 122.54369 127.32449 129.91829 132.01709 137.715 142.8378 147.3036 149.8974 152.11679 153.8736 158.9964 161.21579 164.59259 169.31039 176.26019 180.8799 185.6067 190.28761 194.75342 200.36221 205.63802 210.38013"> EFLAGS(IOPL) := tempEFLAGS;</tspan><tspan y="-379.98486" x="95.520287 97.739685 99.806984 104.54818 106.76758 112.47088 117.14998 121.83628 125.13837 129.58168 134.38408 139.01637 143.81877 145.74207 149.94327 154.62956 156.84895 162.01045 164.22984 169.46515 174.74545 176.96484 181.66014 184.96225 187.18164 192.88493 197.56403 202.25032 205.55243 209.99573 214.79813 219.43042 224.23282 226.15611 230.35732 235.04361 237.263 242.35429 244.57368 249.85399"> IF OperandSize = 32 or OperandSize = 64</tspan><tspan y="-367.98517" x="113.52029 118.70609 124.55788 129.28468 135.13649 137.3559 142.0827 146.76361 151.22942 156.83821 162.11401 166.85611 169.44991 175.13071 177.22951 181.95631 183.78511 186.00452 191.64572 193.74632 198.86913 201.46292 203.68231 205.43912 210.56192 212.78131 216.15811 220.87592 227.77621 232.45532 237.18213 241.86304 246.32884 251.93764 257.21344 261.95554 263.82935 266.04874 270.77554 272.87433">THEN EFLAGS(VIF, VIP) := tempEFLAGS; FI;</tspan><tspan y="-355.98547" x="46.020287 59.519386 64.254288 66.361191"> FI;</tspan><tspan y="-343.98578" x="59.520287 61.628086 66.363884 68.58329 73.325394 78.1278 82.567505 87.246605 91.982407 98.882706 103.67251 107.05831 111.54211 115.45892 119.71861 124.39951 129.18932 133.62901 138.30182 140.23862 144.96542 149.58513 152.18793 156.92372 162.05553 166.53033">IF ShadowStackEnabled(CPL)</tspan><tspan y="-331.98608" x="77.520287 79.620888 84.349487 86.568886 91.310989 96.113388 101.23799 103.45739 109.06799 114.92159 120.46019 122.67959 127.94819 132.68579 137.95439 140.17378 141.92339 147.04799 149.26738 154.53598 156.75537 159.35097 163.37756 165.59695 169.50656 174.28915 178.97006 182.86977 187.15736 189.37675 191.33336 194.67596 196.89536 201.33505 203.25655 205.21315 209.83286 214.61545 219.29636 223.96196 226.18135 229.55995 234.28856 236.50795 241.72795 243.94734 248.61295 253.29654 256.67514 261.35605 265.37366 267.59305 271.61966">IF SSP AND 0x7 != 0 (* check if aligned to 8 bytes *)</tspan><tspan y="-319.98639" x="95.520287 100.69978 106.54528 111.26578 117.11127 119.33067 125.09518 129.81567 134.93217 137.51967 142.24017 147.84267 153.26517 156.09567 161.51817 166.23868 171.41818 174.54568 176.63818 182.06068 186.78119 191.96069 194.54819 196.41568 198.63509 203.35559 205.44809">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-307.98669" x="77.520287 80.90519 85.58609 92.543991 97.163689 101.95259 105.97649 110.65739 115.45979 117.6792 122.8101 125.0295 129.05341 133.7955 138.2784 142.8981 147.633 154.5909 159.1548 163.11659 166.5015 170.94119 174.85709 179.15099 183.71489 185.65079 190.38568 194.82538 199.49728 201.71667 206.93668 209.15607 213.82797 218.51787 221.90277 226.62868 230.59047 232.80986 236.15877 239.43567 244.17056 251.12846 253.34785 258.08994 262.89233 268.02322 273.20813 278.48303 283.70303">tempSsCS = shadow_stack_load 8 bytes from SSP+16;</tspan><tspan y="-295.987" x="77.520287 80.940285 85.621185 92.558388 97.209587 101.97778 105.98098 110.43418 112.52038 117.63058 119.84998 124.96017 127.17957 131.18277 135.95097 140.41318 145.06438 149.77858 156.71577 161.25897 165.26218 168.62637 173.08858 176.98378 181.30287 185.84607 187.79999 192.54118 197.04028 201.67258 203.89197 209.17227 211.39166 216.02396 220.67426 224.01956 228.75986 232.78195 235.00134 238.31064 241.61275 246.30804 253.26865 255.48804 260.23734 265.03973 270.13104 275.27634 280.55664">tempSsLIP = shadow_stack_load 8 bytes from SSP+8;</tspan><tspan y="-283.9873" x="77.520294 80.905197 85.586098 92.543999 97.163696 101.9526 106.6947 111.8256 114.04501 119.1759 121.39531 125.41921 130.16132 134.64421 139.26392 143.99881 150.95671 155.45761 159.47971 162.86461 167.3475 171.2634 175.5573 180.1212 182.0571 186.79199 191.23169 195.90359 198.12299 203.34299 205.56238 210.23428 214.92418 218.30908 222.98999 227.01389 229.23328 232.58218 235.85909 240.59398 247.49428 249.71367 254.50256 259.29147 264.42236">tempSSP = shadow_stack_load 8 bytes from SSP;</tspan><tspan y="-271.98761" x="77.520294 82.306496 87.048599 92.176796 94.396194 99.524391 101.74379 106.52999 111.27209 116.40029 118.61969 123.80189 126.02129 131.29349 136.56569">SSP = SSP + 24;</tspan><tspan y="-259.98792" x="77.520294 80.940292 85.621193 92.56649 97.225792 101.94809 106.72439 108.94379 114.06209 116.28149 121.00378 125.78008 127.64938 129.86879 132.45808 136.47838 138.69778 142.86209 147.57539 150.83969 155.562 157.73999 162.4146 166.85429 171.5289 176.14861 180.87721 185.49692 187.71631 191.10391 195.78481 198.0042 203.2818 208.5018 210.72119 215.3958 217.3614 220.74901 222.9684 227.004">tempCS = CS; (* zero padded to 64 bit *)</tspan><tspan y="-247.98822" x="77.520294 79.612793 84.33329 86.552689 89.923187 94.634689 101.57819 106.23569 110.95618 115.73068 117.95008 119.69158 124.80808 127.02748 130.44748 135.12839 142.07188 146.72939 151.50389 155.5134 160.2339 165.00841 167.22781 169.81531 173.8338 176.05321 181.31371 186.5742 188.79361 193.45111 195.39961 198.77011 200.98952 204.89102 209.61153 216.55502 221.16029 225.6288 228.8913 233.6028 235.47029 237.6897 242.4102 247.18471 249.40411 253.56662 258.27811 261.54062 266.26111 268.4805 273.138 277.60651 282.26401 286.92151 291.633 296.2905 298.50989 301.8804 306.60089 308.82028 314.08078 319.34128 321.56067 326.21817 328.16666 331.58667 335.54846 337.76785 341.78635">IF tempCS != tempSsCS (* 64 bit compare; CS zero padded to 64 bits *)</tspan><tspan y="-235.98853" x="95.520294 100.69979 106.54529 111.26579 117.11128 119.33068 125.09518 129.81569 134.93219 137.51968 142.24019 147.84268 153.26518 156.09569 161.51819 166.23869 171.4182 174.5457 176.6382 182.0607 186.7812 191.96071 194.5482 196.4157 198.6351 203.35561 205.4481">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-223.98883" x="77.520294 79.620895 84.349495 86.568893 91.297493 96.039597 101.3622 106.9422 111.7248 116.4057 118.6251 123.8037 126.02309 131.45369 133.55429 138.67889 140.89828 142.64789 147.77249 149.99188 153.37048 158.09009 164.99039 169.66949 174.45209 178.41388 182.88148 184.98209 190.10669 192.32608 194.92168 198.94827 201.1803 206.4003 211.6806 213.89999 218.5701 220.49161 223.87471 226.0941 230.00819 234.74129 241.69739 246.31709 250.79819 254.07329 258.79739 260.67749 262.89691 267.57782 272.38022 277.66141 283.30081 288.04291 292.78409 297.96719 303.40228 305.50739 310.63647 312.8559 317.03101 321.71188 324.98697 329.66788 331.8873 336.5574 340.9971 345.66721 350.33731 355.01819 359.68829 361.90771 365.2908 370.0239 372.24332 377.46332 382.74362 384.96304 389.58273 391.56451 394.9476 397.16702 400.51413 405.19504 408.47012 410.68954 415.90955 421.18985 423.40927 428.07938 430.00085 433.38394 435.60336 440.07547 442.11667 447.24576 449.46518 453.49628">IF CSBASE + RIP != tempSsLIP (* 64 bit compare; CSBASE+RIP zero padded to 64 bit for 32 bit LIP *)</tspan><tspan y="-211.98914" x="95.520302 100.6998 106.5453 111.26579 117.11129 119.33069 125.09519 129.81569 134.93219 137.51968 142.24019 147.84268 153.26518 156.09569 161.51819 166.23869 171.4182 174.5457 176.6382 182.0607 186.7812 191.96071 194.5482 196.4157 198.6351 203.35561 205.4481">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-199.98944" x="77.520302 79.620003 84.347702 86.567101 89.944801 94.663498 101.5638 106.2429 110.985 115.7874 120.9111 123.1305 128.7402 134.59291 140.13062 142.35001 147.61771 152.3553 157.623 159.84239 161.59109 166.7148 168.93419 174.20189 176.42128 179.01598 183.04167 185.26106 189.16977 193.95148 198.63239 202.53209 206.81879 209.03818 210.99388 214.29329 216.51268 220.98837 222.91707 224.83858 229.51768 234.29938 238.98029 243.64499 245.86438 249.24208 253.92299 256.1424 261.4101 263.62952 268.29422 272.97693 276.35461 281.03549 285.05219 287.27161 291.2973">IF tempSSP AND 0x3 != 0 (* check if aligned to 4 bytes *)</tspan><tspan y="-187.98975" x="95.520302 100.6998 106.5453 111.26579 117.11129 119.33069 125.09519 129.81569 134.93219 137.51968 142.24019 147.84268 153.26518 156.09569 161.51819 166.23869 171.4182 174.5457 176.6382 182.0607 186.7812 191.96071 194.5482 196.4157 198.6351 203.35561 205.4481">THEN #CP(FAR-RET/IRET); FI;</tspan><tspan y="-175.99005" x="77.520302 79.618202 84.344101 86.563499 89.156403 91.749306 93.847206 99.455109 104.72101 109.98691 114.54181 119.22271 123.96391 128.64481 134.1042 135.81511 140.28001 146.82031 152.40031 154.61972 160.22762 166.07852 171.61443 173.83383 178.55974 183.30185 185.01276 189.47766 192.07056 194.28996 199.41187 201.63127 206.89717 209.11658 214.72447 220.57538 226.11128 228.33069 231.70659 236.42349 243.32379 248.0029 252.74501 257.54739 262.66928 265.43317 270.69907 275.91907 277.67496 282.89496 288.16086 290.92474 293.14417 294.89105 300.01294 302.23236 307.49826 310.09116 312.31058 318.00845">IF ((IA32_EFER.LMA AND CS.L) = 0 AND tempSSP[63:32] != 0) OR</tspan><tspan y="-163.99036" x="87.300598 89.879097 92.457596 94.5411 100.1346 105.3861 110.6376 115.1781 119.8896 124.6011 129.31261 134.772 136.4523 140.9028 147.5034 153.09691 155.31631 160.90982 166.79042 172.31192 174.53133 179.24283 184.00833 185.74893 190.18773 192.76624 194.98564 200.09314 202.31255 207.56404 209.78345 215.37695 221.25755 226.77905 228.99846 232.35995 237.06245 243.99695 248.64545 253.41095 258.21335 263.32086 265.54025 267.47977 271.48026 273.69965 278.50204 283.18292 286.60294 288.82233 292.71481 297.1806 301.9686 306.64951 311.4375 313.35901 317.27402 321.75601 323.69101 325.9104 329.15219 333.89249 335.82748 340.26718 343.65118 345.61319 350.23199 354.97229 357.19168 360.57568 365.25659 367.47598 370.85999 375.60031 380.32532 382.54471 386.45972 391.20181 394.47781 397.75381 402.43472 407.23712 410.62112 412.84052 417.51151 421.9512 426.62219 428.5437 433.3317 437.95139 440.17078 447.12778 451.86179 456.48148 461.22177">((IA32_EFER.LMA AND CS.L) = 1 AND tempSSP is not canonical relative to the current paging mode)</tspan><tspan y="-151.99066" x="95.520294 100.70069 106.54709 111.26849 117.11488 119.33428 125.09969 130.37009 135.48749 138.07588 143.33728 145.92567 147.79407 150.01347 154.73488 156.82828">THEN #GP(0); FI;</tspan><tspan y="-139.99097" x="59.520294 64.255196 66.362099">FI;</tspan><tspan y="-127.99126" x="59.520294 61.628094 66.363892 68.583298 73.325401 78.127808 82.567513 87.246613 91.982414 98.882713 103.67252 107.05832 111.54212 115.45892 119.71862 124.39952 129.18932 133.62901 138.30182 140.23862 144.96542 149.58513 152.18793 156.92372 162.05553 166.53033">IF ShadowStackEnabled(CPL)</tspan><tspan y="-115.99156" x="77.520294 79.616394 84.340492 86.559891 88.655991 94.262093 99.526192 104.74619 109.29929 114.02339 118.74749 123.42839 128.85449 130.5636 135.0267 141.6048 147.21089 149.4303 154.5504 156.76981">IF IA32_EFER.LMA = 1</tspan><tspan y="-103.99186" x="77.520294 80.120392 84.151489 86.370888 88.412086 93.214485 95.433884 97.538986 103.11898 105.96208 111.23518 116.50829 121.18919 124.03229 130.98839 135.72148 140.34119 145.06529 147.28468 150.66779 155.40988 160.13399 162.35338 164.45848 169.85849 174.59158 179.75038 181.96977 188.92587 193.36557 198.05367 200.27306 204.94316 209.62407 211.84346 215.86555 222.82166 224.74316 228.10286 232.01695 236.80405 238.72556 243.52795 248.14766 250.36705 254.38914 257.76059 262.25967 266.15936 270.42715 274.42496 276.64435 278.62616 281.92557 284.14496 287.50375 292.30615 297.00595 299.22534 301.20715 305.94925 309.36923 314.05014 317.30093 320.60303 325.36581 330.01163 333.37042 336.48624 341.22653 345.96411 349.85391 354.59421 359.24002 362.66 364.5968 369.3056 374.06839 376.28778 383.21957 387.67636 391.67416 393.89355 398.53937 403.23917 405.14896 407.13077 411.75858 416.49887 419.74966 424.48996">(* In IA-32e-mode the IRET may be switching stacks if the interrupt/exception was delivered</tspan><tspan y="-91.992157" x="77.520294 79.739693 83.12999 87.872086 91.113892 95.855095 100.6494 105.2691 110.0634 112.2828 116.7225 121.5249 123.7443 125.8566 131.40689 136.56569 138.78508 145.74838 147.66989 151.0602 155.85449 158.07388 162.51358 164.73297 169.52727 174.26756 179.00966 181.83026 186.01256 190.69347 193.97577 198.65666 200.87605 202.98836 207.78265 212.94145 215.16084 219.19914"> through an IDT with a non-zero IST *)</tspan><tspan y="-79.992455" x="77.520294 80.159096 84.181198 86.400597 88.441795 93.244194 95.463593 97.555191 103.15679 105.98639 111.24599 116.50558 121.21619 123.43559 130.37819 135.09779 139.75439 144.465 146.6844 150.01801 154.73761 157.99921 160.21861 164.22722 168.6606 175.6212 180.30209 182.5215 187.2627 192.36389 196.86299 199.0824 201.15959 206.56679 211.30798 216.46678 218.68619 222.04138 226.84378 231.53998 234.78717 239.52747 241.74687 243.68007 247.67427 249.89368 254.39278 256.31427 263.24246 267.74155 272.40173 276.39594 278.61533 283.06851 285.2879 289.2821 292.6373 297.09048 300.97668 305.29578 307.51517 311.50937 318.43756 320.41937 323.77905 327.66525 332.42444 334.16504 336.38443 341.54865 346.35104 351.04724 353.26663 357.94574 362.62665 364.53284 369.27405 376.23465 378.45404 382.34024 387.09943 391.83972 395.73941 400.0036 402.22299 406.8472 411.58749 414.83469 416.8165 420.13571 422.11752 426.81372 430.80792 433.02731 435.00912 438.30853 440.52792 443.88312 448.68552 453.38171">(* In IA-32e mode for same CPL IRET there is always a stack switch. The below check verifies if the </tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="435.75519pt" height="632.50598pt" viewBox="0 0 435.75519 632.50598" sodipodi:docname="638.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.03762" inkscape:cy="407.52557" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg198" /><g transform="translate(-45.721786,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="76.68 78.899399 82.914299 86.290199 90.764099 94.670998 98.955894 101.17529 105.19019 112.13909 114.09299 117.46889 121.37579 126.15569 128.37509 135.32399 139.79788 143.81277 146.03218 149.40808 154.13399 156.35339 160.31519 165.0555 166.98239 170.3223 172.5417 176.50351 179.92351 184.3974 188.30431 192.5892 194.80861 199.2825 204.06241 208.72531 210.94472 212.89862 216.23853 218.45793 222.47284 227.15375 228.98164 231.20105 235.82076 240.56197 242.78137 247.56128 252.24219 255.61809 257.83749 261.21338 264.42001 269.09372 271.31311 274.68182 279.40051 281.6199 284.95261 288.25473 292.96442 297.6741 299.89349 303.26221 308.03491 312.7446 314.96399 318.3327 323.05139 327.3291 332.03879 336.81149 339.03088 343.74957 348.52228 350.74167 354.11038 358.85971 360.81091 364.82312 367.04251 371.05472 375.83191 380.3031 384.96329 389.6442 396.6048 398.82419 402.8364 406.20959 410.68079 414.58499 418.86719 420.57538 422.79477 424.88998 428.22717 430.44656 433.81976 438.59695 443.31116"> stack switch was to self stack and if so, do not try to free the token on this shadow stack. If the </tspan><tspan y="-703.98029" x="76.680023 78.899422 82.272621 86.986824 93.933022 98.552727 103.32993 108.10712 113.22633 115.44572 122.34602 126.84512 130.85733 133.07674 137.85394 142.57715 145.95035 148.16975 151.54295 156.26616 158.48557 162.49777 166.96898 173.91518 178.62938 180.84879 184.86099 188.23419 192.7054 196.6096 200.8918 203.11121 206.48441 211.25974 215.97304 220.74934 222.96875 226.34105 231.11736 235.83066 239.09496 243.80826 246.02766 252.92796 257.42706 261.43835 263.65778 268.12808 270.3475 274.3588 277.73111 282.20142 286.10471 290.38602 292.60544 296.61673 303.51703 305.46732 308.83963 312.74292 317.51923 319.73865 323.70044 328.44162 330.66003 335.31573 340.03442 342.25381 346.72052 350.08923 353.45795 358.16763 365.10934 369.76505 373.13376 375.35315 378.72186 383.44055 385.65994 388.99265 392.29477 397.00446 401.71414 403.93353 407.30225 412.07495 416.78464 419.00403 422.37274 427.09143 431.36914 436.07883 440.85153 443.07092 447.08762"> tempSSP was not to same stack then there was a stack switch so do attempt to free the token *)</tspan><tspan y="-691.98059" x="94.680038 96.75724 101.49844 103.71784 107.07304 111.81334 118.74154 123.42064 128.17984 132.98224 138.08344 140.30284 142.02904 147.19054 149.40994 154.16914 158.97154">IF tempSSP != SSP</tspan><tspan y="-679.9809" x="112.68004 117.88924 123.71043 128.46063 134.28183">THEN </tspan><tspan y="-667.9812" x="130.68004 135.37534 140.14264 144.78394 149.52423 153.40953 156.76382 161.45912 166.13821 170.67151 174.0258 178.767 183.0267 187.722 192.5244 197.05769 201.681 206.1801 208.10161 212.85991 217.6002 219.81961 224.91991 227.13931 231.89761 236.70001 241.80031 244.01971 246.00151 248.22092 253.51921 259.22073 263.97903 269.14053 273.67383 278.97214 281.04843 323.40692 325.97821 329.9805 332.19989 336.879 341.64005 345.65494 350.33585 352.55527 357.17496 359.15674 362.53265 364.75208 367.58798 369.8074 374.47031 376.42419 379.80011 382.01953 386.63922 391.3804 395.39529 397.34918 400.7251 402.67899 407.35986 412.16226 414.38168 419.64758 421.867 424.70291 426.92233 433.82263 438.62503 442.63992 446.01581 448.23523 452.89813 457.61502 459.83444 463.84933 468.56622 471.94214 474.16156 478.18546">expected_token_value = SSP | BUSY_BIT(* busy bit - bit position 0 - must be set *)</tspan><tspan y="-655.98151" x="130.68004 135.42213 140.16245 147.06274 151.62395 155.00705 159.74014 163.99985 168.74016 173.48225 178.04346 182.66226 187.16136 189.09546 193.83755 198.56166 200.78105 205.91016 208.12955 212.91664 217.65874 323.44025 326.01965 330.05075 332.27017 336.18427 338.11838 342.84247 347.28217 350.52396 352.74338 356.12646 360.86856 365.59265 367.81207 372.43176 377.23416 381.25626 385.87598 388.0954 392.7655 394.72659 398.10968 400.3291 404.3602">new_token_value = SSP(* clear the busy bit *)</tspan><tspan y="-643.98181" x="130.68004 134.64185 139.44424 143.91185 148.56845 153.28806 160.23065 164.77925 168.78786 172.15746 176.62506 180.52567 184.80426 189.35286 191.27345 195.99306 199.89366 204.17226 208.67316 212.57376 219.51636 224.17296 228.95557 232.85617 237.62978 242.28638 247.56033 252.23943 254.81883 259.57355 264.37595 269.47266 271.33115 273.55054 278.30524 283.04556 289.96927 294.49896 297.84967 302.59088 306.85059 311.59091 316.34561 320.87531 325.495 329.99411 331.89581 336.65051 341.39084 343.18994 345.40933 350.14966 354.88727 359.56638 364.24728 368.129 371.54901 376.24072 380.91983 385.44952 388.80023 393.50095 397.82004 402.51175 407.31415 411.84384 416.52292 420.97162 422.87332 427.67572 432.35663">shadow_stack_lock_cmpxchg8b(SSP, new_token_value, expected_token_value)</tspan><tspan y="-631.98212" x="94.680038 99.41494 101.52184">FI;</tspan><tspan y="-619.98242" x="76.680038 81.41494 83.521843">FI;</tspan><tspan y="-607.98273" x="76.680038 81.46534 86.250641 91.377945 93.537048 95.298347 100.42564 102.64505 106.02635 110.74865 117.70295 122.32265 127.10795 131.85005">SSP := tempSSP</tspan><tspan y="-595.98303" x="58.619736 63.354637 65.46154">FI;</tspan><tspan y="-583.98334" x="45.119736 49.848335 55.701935 61.240536">END;</tspan><tspan y="-559.98303" x="45.119736 47.221237 52.832737 55.672237 60.941738 66.211243 70.892143 73.731644 80.315147 86.013054 91.530952 96.260452">IA-32e-MODE:</tspan><tspan y="-547.98334" x="58.619736 60.714035 65.436333 67.655731 73.503029 78.684326 80.903725 86.022026 88.241425">IF NT = 1</tspan><tspan y="-535.98364" x="76.680038 81.877541 87.698746 92.437248 98.258453 100.47786 106.26036 111.54786 116.64906 119.22845 124.50696 127.08636">THEN #GP(0);</tspan><tspan y="-523.98395" x="58.619736 63.352837 67.824936 72.612038 77.345139 79.564537 81.605736 86.346939 88.566338 94.307434 98.927132 103.65123 106.92633 111.36604 116.16843 120.83853 125.58064 127.54173 131.71683">ELSE IF OperandSize</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cC7C7E1F8"><tspan y="-523.97998" x="136.44"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-523.97998" x="139.43974">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-523.97998" x="145.5"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-523.97998" x="147.72031 153.00061">32</tspan><tspan y="-511.98029" x="76.680603 81.889801 87.710999 92.461197">THEN</tspan><tspan y="-499.98059" x="94.680603 99.395706 101.4828 106.5939 108.8133 110.5584 115.7199 117.9393 123.0504 127.7655 132.4176 134.99971 137.58182">EIP := Pop();</tspan><tspan y="-487.9809" x="94.680603 99.403801 104.181 106.4004 108.15359 113.2728 115.4922 120.6114 125.33459 129.9948 132.58499 135.17519">CS := Pop();</tspan><tspan y="-475.9812" x="94.680603 98.060104 102.741 109.6935 114.3132 119.0427 123.7722 128.24071 133.8522 139.13071 143.9142 146.13359 147.8931 153.0186 155.23799 160.36349 165.093 169.75951 172.356 174.9525">tempEFLAGS := Pop();</tspan><tspan y="-463.98151" x="76.680603 81.4245 85.863304 90.661201 95.405106 97.624504 99.665703 104.40691 106.6263 112.3782 116.9979 121.7328 124.9746 129.41431 134.21671 138.8976 143.63969 145.61159 149.75249 154.48738">ELSE IF OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-463.98001" x="156.66">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-463.98001" x="162.66 164.87939 170.1534 175.3734"> 16 </tspan><tspan y="-451.98032" x="94.680305 99.889503 105.7107 110.4609">THEN</tspan><tspan y="-439.98062" x="112.68031 117.40891 119.50951 124.63411 126.85351 128.61211 133.73671 135.9561 141.0807 145.80931 150.42902 153.02461 155.62021 157.4958 159.71519 162.31079 166.33739 168.55678 173.77678 179.05708 181.89569 186.56129 188.4828 191.8425 194.06189 198.72749 203.4561 208.07581 209.9361 212.15549 216.06509 217.99469 222.6756 227.1153 230.38589 232.60529 237.34738 242.01299 246.67859 251.3595 254.6301 256.84949 261.51508 263.47168 266.85028 270.86789 273.08728 277.0491">EIP := Pop(); (* 16-bit pop; clear upper bits *)</tspan><tspan y="-427.98093" x="112.68031 117.4035 122.1807 124.4001 126.1533 131.27249 133.4919 138.6111 143.3343 147.99451 150.5847 153.1749 154.97488 157.19429 159.78448 163.80568 166.02509 171.28828 176.55148 179.43239 184.05209 186.0033 189.3765 191.5959 196.2561 200.97931 205.63951 207.85892 211.88011">CS := Pop(); (* 16-bit pop *)</tspan><tspan y="-415.98123" x="112.68031 116.1003 120.7812 127.7247 132.3822 137.10271 141.82321 146.28271 151.88521 157.15471 161.92921 164.14862 165.89912 171.01562 173.23503 178.35153 183.07204 187.72954 190.31703 192.90453 194.70451 196.92392 199.51141 203.52991 205.74931 211.00981 216.27031 219.15121 223.7403 225.6978 229.0773 231.29669 235.9164 240.65761 245.32411 247.20061 249.42 253.33051 255.261 259.94189 264.44101 267.71252 269.93195 274.71545 279.33514 284.00165 288.68253 291.95404 294.17346 298.79315 300.77493 304.15442 308.17291 310.39233 314.41983">tempEFLAGS := Pop(); (* 16-bit pop; clear upper bits *)</tspan><tspan y="-403.98154" x="94.680298 99.415199 101.5221">FI;</tspan><tspan y="-391.98184" x="76.680298 81.421494 85.860291 90.662689 95.403885 97.623283 100.18739 104.18249 106.40189 112.10699 116.78609 121.47419 124.77629 129.22139 134.02379 138.65788 143.46028 145.38538 149.58658 154.27467">ELSE (* OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-391.98001" x="156.42">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-391.98001" x="162.48 164.6994 169.9482 175.22849 177.44789 181.4547"> 64 *)</tspan><tspan y="-379.98032" x="94.680298 99.889496 105.71069 110.46089">THEN</tspan><tspan y="-367.98062" x="130.6803 136.0965 138.18269 143.29289 145.5123 147.2565 152.3667 154.58611 159.7476 164.42851 169.07971 171.66092 174.24213">RIP := Pop();</tspan><tspan y="-355.98093" x="130.6803 135.36121 140.1636 142.383 144.1425 149.26801 151.4874 156.6129 161.34241 166.00891 168.60541 171.2019 173.0784 175.29779 177.89429 181.92178 184.14117 189.41068 194.63068 197.47017 202.08987 204.04738 207.42688 209.64627 214.26598 219.00719 223.67369 225.50519 227.72458 232.50807 234.42958 239.09608 243.83818 246.67767 251.40718 254.67868 259.34518 264.06567 267.33719 269.55661 274.82611 280.04611 282.26553 286.93204 288.85352 292.233 296.2515 298.47092 303.13742 305.0589 309.07739 312.98788 317.46539 320.73691 325.40341 330.08429 334.75079 336.97021 340.99771">CS := Pop(); (* 64-bit pop, high-order 48 bits discarded *)</tspan><tspan y="-343.98123" x="130.6803 134.03999 138.72089 145.69859 150.31828 155.77498 160.45587 164.94957 170.52957 175.83327 180.57536 182.79477 184.57947 189.68066 191.90007 197.00127 201.74246 206.36215 208.94156 211.56326">tempRFLAGS := Pop();</tspan><tspan y="-331.98154" x="58.620003 63.354904 65.461807">FI;</tspan><tspan y="-319.98184" x="58.620003 60.718803 65.445602 67.665001 72.3918 77.1726 78.884399 84.313202 89.436005 93.901802">IF CS.RPL </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-319.98184" x="96.1203">&gt;</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-319.98184" x="101.0406 103.26 107.9544 113.1159"> CPL</tspan><tspan y="-307.98215" x="76.680305 81.898506 87.719711 92.433914 98.273117 100.49252 105.75571 111.47791 116.69611 122.39401 124.61341 130.02962 134.74382 139.91702 145.59422 151.01042 156.89102 159.71523 164.88843 170.64662 173.46722 179.18942 184.86662 190.03983 194.75403 200.17023 202.99443 208.10463 213.56403 215.65022 221.31842 223.40462 227.85782 232.57202 237.83522 242.54942 245.37363 249.82683 254.54103 260.20923 264.92343 269.37662">THEN GOTO RETURN-TO-OUTER-PRIVILEGE-LEVEL;</tspan><tspan y="-295.98245" x="76.680305 81.415207 85.889107 90.678009">ELSE</tspan><tspan y="-283.98276" x="94.680305 96.789902 101.5275 103.74691 105.71251 110.45461 114.48122 117.86882 121.11062 125.91302 129.83162 133.21922 135.18483 139.86572 144.65732 146.87671 151.49641 156.23672 160.91133 165.35103 170.14262 172.36201 174.28352 179.08592 181.30531 186.52531 191.80562 194.65321 199.98482 201.90633 205.26604 207.48543 214.07703 218.75792 223.43253">IF instruction began in 64-Bit Mode</tspan><tspan y="-271.98306" x="112.68031 117.8895 123.7107 128.46091">THEN</tspan><tspan y="-259.98337" x="130.6803 132.7359 137.4771 139.69649 145.38809 150.0672 154.80751 158.04932 162.48091 167.28331 171.96242 176.70451 178.68633 182.82722">IF OperandSize</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 cC7C7E1F8"><tspan y="-259.98001" x="187.5"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-259.98001" x="190.56012">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F c8037F88D"><tspan y="-259.98001" x="196.62"> </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-259.98001" x="198.8403 204.12061">32</tspan><tspan y="-247.98032" x="148.6806 153.85921 159.70381 164.42342">THEN</tspan><tspan y="-235.98062" x="166.6806 171.39481 176.16301 181.27321 183.49261 185.23682 190.34702 192.56642 197.72792 202.40883 207.06003 209.64124 212.22244">ESP := Pop();</tspan><tspan y="-223.98093" x="166.6806 171.4227 176.2251 178.44449 180.20399 185.3295 187.54889 192.67439 197.4039 202.0704 204.6669 207.2634 209.13989 211.35928 213.95578 217.98328 220.20267 225.47217 230.69217 233.53166 238.15137 240.10887 243.48837 245.70776 250.32747 255.06868 259.73517 261.56668 263.7861 268.56961 270.49109 275.15759 279.89969 282.7392 287.46869 290.7402 295.40671 300.1272 303.39871 305.61813 310.88763 316.10764 318.32706 322.99356 324.91504 328.29453 332.31302 334.53244 339.19894 341.12042 345.13892 349.04941 353.52692 356.79843 361.46494 366.14581 370.81232 373.03174 377.05923">SS := Pop(); (* 32-bit pop, high-order 16 bits discarded *)</tspan><tspan y="-211.98123" x="130.6806 135.3615 139.80029 144.59729 149.34029 151.55968 153.67468 158.35558 160.57497 166.32597 170.94566 175.67966 178.92146 183.41246 188.15456 192.83455 197.57664 199.54764 203.68854 208.42253">ELSE IF OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-211.98" x="210.66">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-211.98" x="216.66 218.87939 224.1534 229.3734"> 16 </tspan><tspan y="-199.9803" x="148.6803 153.8589 159.70351 164.42311">THEN</tspan><tspan y="-187.98061" x="166.6803 171.36121 176.1636 181.28641 183.5058 185.2626 190.38541 192.6048 197.7276 202.40851 207.07231 209.66611 212.2599 214.1337 216.35309 218.94688 222.97168 225.19107 230.45787 235.72467 238.56148 243.18118 245.16298 248.53978 250.75919 255.42299 260.10388 264.76767 266.64148 268.86087 272.76868 274.69647 279.41428 283.85397 287.12277 289.34216 294.08426 298.76334 303.38303 308.12332 311.39212 313.61151 318.2753 320.19681 323.57361 327.58942 329.80881 333.83362">ESP := Pop(); (* 16-bit pop; clear upper bits *)</tspan><tspan y="-175.98091" x="166.6803 171.4548 176.22931 178.44872 180.19922 185.31572 187.53513 192.65163 197.37213 202.02963 204.61713 207.20462 209.07211 211.29152 213.87901 217.89751 220.11691 225.37741 230.63791 233.51881 238.13852 240.08702 243.45752 245.67693 250.33443 255.05493 259.71243 261.93182 265.95032">SS := Pop(); (* 16-bit pop *)</tspan><tspan y="-163.98122" x="148.6803 153.3765 157.81169 162.61409 167.35529 169.57469 172.13789 176.1321 178.3515 184.05569 188.73479 193.42198 196.72409 201.16829 205.97069 210.60388 215.40628 217.33047 221.53168 226.21887">ELSE (* OperandSize </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="10.98" class="c33EE2981 c8037F88D"><tspan y="-163.98" x="228.42">=</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-163.98" x="234.48 236.6994 241.9482 247.22849 249.44789 253.4547"> 64 *)</tspan><tspan y="-151.9803" x="166.6803 172.0956 176.8629 182.0244 184.2438 185.98711 191.09641 193.31581 198.42511 203.13841 207.78871 210.36902 212.94933">RSP := Pop();</tspan><tspan y="-139.98061" x="166.6803 171.42239 176.22479 178.44418 180.20369 185.32919 187.54858 192.67409 197.40359 202.0701 204.6666 207.26309 209.13959 211.35898 213.95547 217.98297 220.20236 225.47186 230.69186 233.53136 238.15106 240.10857 243.48807 245.70746 250.32716 255.06837 259.73486 261.56638 263.7858 268.56931 270.49078 275.15729 279.89938 282.73889 287.46838 290.7399 295.4064 300.12689 303.39841 305.61783 310.88733 316.10733 318.32675 322.99326 324.91473 328.29422 332.31271 334.53214 339.19864 341.12012 345.13861 349.0491 353.52661 356.79813 361.46463 366.14551 370.81201 373.03143 377.05893">SS := Pop(); (* 64-bit pop, high-order 48 bits discarded *)</tspan><tspan y="-127.9809" x="130.6803 135.36121 137.46181">FI;</tspan><tspan y="-115.9812" x="94.680298 99.415199 101.5221">FI;</tspan><tspan y="-103.9815" x="94.680298 99.947098 105.6729 110.8497 116.5755 118.7949 124.2543 128.9352 134.1534 139.7946 145.254 151.0752 153.903 159.0798 164.8056 167.63341 172.40521 178.005 184.5768 189.2946 192.12241 197.28391 202.7037 204.7935 210.4653 212.5551 217.0119 221.72971 226.99651 231.71431 234.54211 238.99892 243.71672 249.38852 254.10632 258.56311 260.42792 262.64731 267.36511 269.45493">GOTO RETURN-TO-SAME-PRIVILEGE-LEVEL; FI;</tspan><tspan y="-91.981796" x="45.119999 49.8144 55.695 61.199398">END;</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="510.71817pt" height="604.74512pt" viewBox="0 0 510.71817 604.74512" sodipodi:docname="639.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.48766" inkscape:cy="370.41247" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg122" /><g transform="translate(-46.134258,-69.064216)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-715.31989" x="46.02 51.561745 54.075649 59.388313 65.028656 69.783562 72.303436 78.362106 82.260445 85.979507 91.618858 96.164604 100.14263 105.72421">Flags Affected</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-700.02002" x="46.02 52.161598 54.613197 57.064796 59.828697 63.360298 69.0429 74.392502 77.216705 80.370308 82.821907 88.216507 93.809105 98.483704 101.30791 106.70251 112.38511 118.02451 120.78841 123.94201 126.39361 131.74321 134.19481 139.78741 144.46202 147.28621 149.73781 155.42041 158.1843 161.7159 167.3985 172.74809 175.57228 181.24588 186.40648 191.40508 197.58897 204.54958 210.69118 213.51537 217.34396 222.69356 228.28616 230.73776 235.41237 238.94397 244.29356 248.12216 250.94635 256.34094 260.16956 265.51917 268.34335 273.93594 279.38455 282.91614 288.31885 294.00143 297.54028 299.99548 305.39368 307.84888 310.30408 315.62128 318.44547 327.19165 332.64386 338.24005 340.69525 343.85245 346.30765 351.66086 357.25705 360.52225 363.34644 368.94263 374.34534 379.94153 385.29474 390.98093 396.57712 399.03232 404.71851 410.3147 413.13889 418.59109 424.27728 427.04117 430.57635 436.26254 441.61575 444.43994 453.18616 458.63837 464.23456 469.58777 472.41196 477.86417 481.02136 483.78525 489.23746 494.83365 500.23636 503.89847 509.29666 512.83185 515.28705 520.73926 526.42548 529.18939 534.6416 537.79883 540.56274 544.16278 549.80487 555.20758">All the flags and fields in the EFLAGS register are potentially modified, depending on the mode of operation of the </tspan><tspan y="-688.97974" x="46.019989 51.62249 55.460991 60.919491 65.603989 70.963486 75.647987 80.332489 85.790993 88.373093 91.675194 94.49939 98.28389 101.44739 104.27158 109.87408 115.23358 119.07208 122.23558 127.63648 131.47858 140.23108 142.69258 148.38509 153.98758 156.87119 162.27568 165.09988 168.93839 174.29788 177.83939 183.53189 187.37039 193.0629 195.8871 199.0506 202.8891 208.3476 217.1001 219.9243 225.3288 228.2124 233.85451 239.2572 243.9417 247.4832 252.8427 258.44519 261.3288 264.8703 270.27481 274.95932 280.28281 283.10703 286.64853 292.01968 294.8439 300.3078 303.13202 308.72733 312.55862 317.96133 323.24344 325.69775 331.14905 336.83435 341.51166 344.33588 347.87018 353.26749 357.94479 363.26111 366.56323 369.38745 372.92175 378.60706 383.95935 386.84296 392.51926 397.68256 402.72617 408.84976 415.81305 421.99695 424.82117 428.65247 434.00476 439.64417 442.10028 446.77759 450.31189 455.66418 459.49548 462.3197 469.67001 472.12433 474.52106 476.97717 479.86078 485.45609 490.80838 493.69199 502.43729 507.88858 513.52802 515.92468 519.08099 521.53528 526.88757 532.48285">processor. If performing a return from a nested task to a previous task, the EFLAGS register will be modified </tspan><tspan y="-677.99976" x="46.019989 51.41729 56.094589 60.771889 66.22319 70.054489 75.649788 78.104088 83.789391 89.384689 92.207993 95.742294 101.1936 104.0763 107.6106 113.29591 118.64821 121.47151 127.14781 132.31111 137.35381 143.4765 150.4398 156.6228 159.44609 161.90039 170.64569 176.04298 181.63829 186.99059 189.87328 194.55058 198.08488 203.53618 207.36748 212.71977 218.31508 221.19777 223.59357 229.29417 232.17686 235.71117 241.39647 246.74876 249.57205 255.21056 259.05176 264.40405 269.72037 272.11618 277.57556 283.26086 287.93817 290.82089 294.35519 299.7525 304.42981 309.74612 311.90881 316.58792 319.41125 324.86884 330.93121 336.99359">according to the EFLAGS image stored in the previous task’s TSS.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-654.29999" x="46.02 52.081657 55.503914 60.903229 64.864326 70.469818 75.039467 79.000565 84.580154 90.205566 92.725449 100.42254 106.02803 111.65344 117.25893 119.77881 125.29765 130.58043 135.01959 140.59918 146.05927 150.02036 152.53824 158.14372 163.88866">Protected Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-640.02002" x="46.02 53.371201 60.3354 65.751602 69.826805 75.540009 138.1188 141.897 145.0542 147.8784 151.4136 157.09981 162.453 165.33661 169.16881 174.522 178.05721 183.74341 187.57561 193.26181 196.08601 200.76422 206.21642 211.81262 217.21532 220.03952 225.49171 229.32391 232.14812 236.82632 240.42633 245.82452 250.50273 255.81993 258.70352 263.38171 268.73492 274.33112 283.07733 288.43054 294.11673 297.65192 300.53549 305.21368 310.56689 313.02209 318.37531 323.0535 326.58868 332.04089 335.87311 338.6973 341.1525 345.83069 348.71426 355.43546 362.01266 367.01486 372.01706">#GP(0)If the return code or stack segment selector is NULL.</tspan><tspan y="-625.98004" x="138.11971 141.90421 145.0677 147.89189 151.4334 157.1259 162.4854 165.36899 169.20749 174.56699 178.10849 183.80099 187.6395 193.332 196.15619 198.61769 204.3102 208.99469 212.53619 216.37469 222.0168 226.7571 230.2968 232.6935 238.15379 243.8463 246.72989 252.33238 257.79089 260.18759 265.8891 269.4306 274.7901 278.6286 281.45282 283.91431 288.59882 291.42303 297.11554 302.57404 306.11554 308.99915 316.35666 318.81815 322.35965 328.05215 330.44885 336.15036 339.03397 342.57547 348.21756 353.57706 356.40128 360.23978 365.59927 369.14078 374.83328 378.67178 384.36429 387.24789 391.9324 397.3909 402.99341 408.35291 411.23651 415.92102 421.28052 426.88303 435.63553 440.99503 446.68753 450.22903 453.11264 455.50934 457.96542 466.71793 469.17941 472.72092">If the return instruction pointer is not within the return code segment limit.</tspan><tspan y="-612.00037" x="46.020004 53.372105 60.337204 65.754303 69.830406 74.509506 79.863609 82.31971 87.673813 92.352913 95.889015 101.34212 105.17522 138.11432 141.89522 145.05331 147.8775 153.2766 156.16019 160.83929 166.19339 171.7905 180.5376 185.89169 191.5788 195.1149 197.99849 202.67758 208.03168 210.48778 215.84187 220.52097 224.05707 229.51016 233.34326 236.16745 238.62355 244.31065 249.90776 255.31046 260.62854 263.51215 265.90884 270.58884 273.47244 278.92554 284.61264 288.14874 292.82785 295.22455 300.86395 306.21805 309.10165 311.49744 315.03714 319.71625 322.59985 328.19696 333.55106 338.23016 342.97046 346.75226 349.20834 354.80545 358.34155 363.74246 367.58456 370.46817 374.00427 379.40338 385.00049 387.45657 392.81067 395.69427 398.09006 400.54614 409.29324 411.74933 415.28543 419.96454">#GP(selector)If a segment selector index is outside its descriptor table limits.</tspan><tspan y="-598.02069" x="138.11971 141.9015 145.0623 147.88651 151.42531 157.11511 162.47191 165.35551 169.19131 174.54811 178.08691 183.77672 187.61252 193.30232 196.12653 200.80832 206.26411 211.86392 217.26662 220.09082 224.77261 230.12941 235.72922 244.47902 249.83582 255.52562 259.06442 261.88861 266.5704 271.92722 274.38602 279.74283 284.42462 287.96341 293.41922 297.255 300.13858 306.38638 311.80618 316.81198 319.63617 322.09497 326.77676 329.60095 332.05975 337.41656 342.09836 346.83865 349.66284 353.20163 358.89142 364.29321 369.983 372.80719 376.34598 382.03577 387.39258 390.27615 396.55096 401.97076 406.97656">If the return code segment selector RPL is less than the CPL.</tspan><tspan y="-583.98071" x="138.11971 141.90691 145.0731 147.89731 151.44151 157.13672 162.49892 165.38252 172.31972 177.74492 182.75612 185.58032 191.04152 194.20772 197.09132 202.49852 205.32272 210.00992 215.47112 221.16632 224.33252 229.79372 233.57552 242.33072 244.79492 250.49013 256.09534 260.17953 264.86673 270.32794 275.93314 281.29535 284.11954 288.80673 294.16895 299.77414 308.52933 313.89154 319.58673 323.13092 325.95511 328.41931 333.10651 335.93069 341.53589 345.29971 350.65561 356.05652 359.59442 364.95032 368.78522 371.66882 375.20673 380.89563 386.29654 391.93863 394.82224 398.36014 404.04904 409.40494 412.22916 416.06406 421.41995 424.95786 430.59995 434.43484 440.12375 443.00735 447.68826 453.14316 458.74207 464.09796 466.98157 471.66248 477.01837 482.61728 491.36618 496.72208 502.41098 505.94888 508.83249 513.51337 518.86926 521.32715 526.68304 531.36395 534.90186 540.35675 544.19165">If the DPL of a conforming-code segment is greater than the return code segment selector </tspan><tspan y="-573.00073" x="137.82001 144.0489 149.4498 154.43671">RPL.</tspan><tspan y="-559.02106" x="138.11971 141.90331 145.0659 147.89009 151.43069 157.1223 162.4809 165.36449 172.29808 177.71968 182.72728 185.55147 188.71407 194.17166 198.00926 200.89285 206.29645 209.12064 214.81224 220.26984 225.96144 230.64503 236.10263 241.74474 244.90733 250.36493 254.20253 262.95413 265.41473 271.05682 276.65842 280.73901 285.42261 290.88022 296.48181 301.84042 304.72403 309.40762 314.76624 320.36783 329.11942 334.47803 340.16962 343.71021 346.59381 348.99051 353.64001 356.52362 362.21521 367.67282 371.21341 374.03763 379.39624 384.99783 390.68942 396.09302 398.49063 401.37424 404.91483 410.37244 413.19666 416.73724 422.42883 427.78745 430.67105 436.92065 442.34225 447.34985 450.17407 455.63168 458.79428 461.6185 465.15909 470.85068 476.20929 479.0929 483.77649 489.2341 494.83569 500.19431 503.07791 507.76151 513.12012 518.72174 527.47333 532.83191 538.5235 542.06409">If the DPL for a nonconforming-code segment is not equal to the RPL of the code segment </tspan><tspan y="-547.98077" x="137.82002 142.49823 147.85143 150.30663 155.65982 160.33803 163.87323 169.32542 171.90752">selector.</tspan><tspan y="-534.0011" x="138.11972 141.90872 145.07672 147.90092 151.44693 157.14394 162.50793 165.39154 170.08054 173.62654 179.03554 183.72453 189.05254 191.87674 196.56573 201.92973 207.53673 216.23973 221.60373 227.30074 230.84674 233.67094 239.27794 244.64194 249.33093 254.01993 257.86292 260.25961 265.89902 269.44501 274.90802 278.75101 281.5752 288.51419 293.94119 298.95419 301.83777 304.30377 308.99277 311.81696 317.51395 322.97696 326.52295 329.34714 334.71115 340.19943 345.89374 351.30005 353.69583 356.57944 360.12274 365.58304 368.40726 371.95056 377.64487 383.00616 385.88977 392.14206 397.56635 402.57666 405.40088 410.86118 414.02649 416.85071 420.39401 426.08832 431.44962 434.33322 438.17352 443.53482 447.07812 452.77243 456.61273 462.30704 465.13126 469.81757 475.27786 480.88217 486.24347 489.06769 493.754 499.1153 504.7196 513.47388 518.83521 524.52948 528.07275">If the stack segment descriptor DPL is not equal to the RPL of the return code segment </tspan><tspan y="-522.96082" x="137.81914 142.49734 147.85054 150.30574 155.65894 160.33714 163.87234 169.32454 171.90663">selector.</tspan><tspan y="-508.98111" x="138.11884 141.90784 145.07584 147.90004 151.44604 157.14305 162.50705 165.39066 170.07965 173.62566 179.03465 183.72365 189.05165 191.87585 196.56485 201.92885 207.53584 216.23885 221.60284 227.29985 230.84586 233.67006 236.13606 240.82506 243.64926 249.34627 254.80927 258.35526 261.17944 266.58844 269.47202 276.83401 280.677 283.14301 286.689 292.09799 297.70499 300.10168 305.50439 308.32858 313.93558 319.34457 322.89056 328.29956 331.18314 335.87213 341.23615 346.84314 355.54614 360.91016 366.55225 370.09824">If the stack segment is not a writable data segment.</tspan><tspan y="-495.0014" x="138.11884 141.90154 145.06323 147.88744 151.42714 157.11784 162.47554 165.35915 170.04184 173.58154 178.98424 183.66693 188.98863 191.81284 196.49553 201.85323 207.45392 216.20462 221.60732 227.30882 230.84853 233.67273 238.35542 243.71312 246.17282 251.53052 256.21323 259.75293 265.20963 269.04633 271.92993 278.17862 283.59933 288.60605 291.43027 293.88995 298.57266 301.39688 307.08759 312.54428 316.08398 318.96759 324.32529 329.92599 335.6167 341.01941 343.4791 346.30331 349.84302 355.19885 358.08246 361.62576 367.26788 372.62918 375.4534 381.70569 387.12997 392.14029 395.0239 400.4248 403.60901 406.49261 410.03592 415.67804 421.03934 423.86356 427.70386 433.06516 436.60846 442.30276 446.14307 451.83737 454.72098 459.40729 464.8082 470.41251 475.7738 478.65741 483.34372 488.70502 494.30933 503.06363 508.42493 514.1192 517.66248 520.54608 525.23236 530.59369 533.05701 538.41833 543.10461 546.64789 552.10822 554.69031">If the stack segment selector RPL is not equal to the RPL of the return code segment selector.</tspan><tspan y="-480.9614" x="138.11885 141.90155 145.06325 147.88745 151.42715 157.11786 162.47556 165.35916 170.04185 175.39955 181.00024 189.75095 195.10864 200.79935 204.33905 207.22266 212.82336 218.18106 222.86375 227.54645 231.38315 233.84285 239.44354 242.98325 248.43994 252.27664 255.16025 258.32196 263.72287 267.55957 270.44318 275.84589 278.6701 283.35281 288.80951 294.41022 299.76791 302.59213 307.27484 312.67755 318.27826 327.02896 332.38666 338.07736 341.61707 344.44128 350.04199 355.49869 360.85638 365.53909 368.36331 374.05402 379.51071 383.05042 385.93402 388.33072 394.03223 399.63293 402.02963 406.71234 412.11505 415.65475 421.05746 423.88168 426.34137 429.88107 432.70529 435.16498 439.84769 442.73129 448.134 450.95822 455.64093 461.09763 466.69833 472.10104 474.92526 479.60797 484.96567 490.56638 499.31708 504.71979 510.4213 513.961">If the segment descriptor for a code segment does not indicate it is a code segment.</tspan><tspan y="-466.98169" x="138.11885 141.90425 145.06865 147.89285 151.43526 157.12866 162.48906 165.37267 170.05806 175.41846 181.02185 189.77525 195.13565 200.82906 204.37146 207.25507 211.94046 217.30086 219.76326 225.12366 229.80905 233.35146 238.81085 242.65025 245.47446 248.63885 254.09825 257.93765 260.82123 266.22662 269.05081 274.50931 280.5726 286.72501 289.54919 295.24258 300.64798 305.33337 308.15756 310.61996 314.16235 318.84775 321.73132 324.19373 329.59464 334.28003 339.74393 342.14062 346.21942 351.82281 354.21951 359.67892 365.28232 370.68771 373.08353 375.9671 381.5705 384.0329 387.57529 390.39948 395.08487 400.48758 404.02997 406.85416 410.01855 415.47797 419.31735 422.14154 424.60394 430.06335 434.74875 440.15414 442.61655">If the segment selector for a TSS has its local/global bit set for local.</tspan><tspan y="-453.00198" x="138.11885 141.89615 145.05244 147.87663 153.27393 156.15752 161.61601 167.67932 173.82362 176.70721 181.38452 186.73682 192.33212 201.07742 206.42972 212.11502 215.64932 218.53291 224.12822 229.48051 234.15782 238.83513 242.66643 245.12073 250.71603 254.25034 259.70163 263.53293 266.41653 271.09384 276.68915 282.04144 286.78174 289.17847 292.36267 294.81699 300.16928 304.84659 307.73019 311.2645 316.90659 322.30389 325.8382 328.7218 332.2561 337.94141 343.2937 346.11792 351.65021 357.7135 363.85779 366.74139 369.13812 373.81812 376.70172 382.38702 387.83832 391.37262 394.19684 399.79214 405.47745 410.15475 414.65656">If a TSS segment descriptor specifies that the TSS is not busy.</tspan><tspan y="-438.96198" x="138.11885 141.89615 145.05244 147.87663 153.27393 156.15752 161.61691 167.68112 173.82542 176.70901 181.38632 186.73862 192.33392 201.07922 206.43152 212.11682 215.65112 218.53471 224.13002 229.48232 234.15962 238.83693 242.66823 245.12253 250.71783 254.25214 259.70343 263.53473 266.41833 271.09564 276.69095 282.04324 286.78445 289.18207 292.36719 294.8215 300.1738 304.8511 307.73471 311.26901 316.91202 322.30933 325.84363 328.72723 332.26154 337.94684 343.29913 346.12335 351.65564 357.71982 363.86411 366.74771 369.14532 373.82623 376.70984 382.39514 387.84644 391.38074 394.20496 399.54916 404.71158 410.10889 412.5065 414.96082 420.35812 425.95343 428.40775 433.76004">If a TSS segment descriptor specifies that the TSS is not available.</tspan><tspan y="-424.98227" x="46.01915 53.374851 59.438152 65.587852 69.667557 75.385254 138.14406 141.92676 145.08846 147.91266 151.45236 157.14307 162.50076 165.38437 168.92407 174.38077 179.98148 182.80568 188.40637 193.72807 197.26778 202.62547 207.36577 210.18997 215.64667 218.80836 221.63257 226.31526 229.85497 235.25766 239.94035 245.26205 248.08626 253.48895 257.32565 262.68335 265.50757 271.19827 276.65497 280.19467 283.01889 290.3746 292.83429 296.37399 302.01608 304.47577 310.16647 312.99069 317.6734 321.27341 326.67612 331.35883 336.68051 339.56412 341.96082 344.4169 353.1676 355.62729 359.16699 363.8497">#SS(0)If the top bytes of stack are not within stack limits.</tspan><tspan y="-411.00256" x="138.11885 141.90515 145.07045 147.89465 151.43796 157.13226 162.49356 165.37717 169.21747 174.57877 178.12207 183.81638 187.65668 193.35098 196.17519 200.86148 204.40479 209.81108 214.49738 219.82268 222.64688 227.33318 232.69447 238.29877 247.05307 252.41437 258.10867 261.65198 264.4762 266.93948 271.62579 274.5094 280.15152 285.61182 289.15512 292.03873 297.64304 301.48334 306.84464 311.53094 316.89224 322.53436 326.13437">If the return stack segment is not present.</tspan><tspan y="-396.96255" x="46.01915 53.376648 60.104149 65.526649 68.350845 72.432343 77.116844 82.476341 84.937843 90.29734 94.981842 98.523346 103.92425 107.76275 138.12155 141.90605 145.06955 147.89375 151.43526 157.12776 162.48726 165.37086 169.20937 174.56886 178.11037 183.80287 187.64137 193.33388 196.15808 200.84258 206.30107 211.90356 217.26306 220.08727 224.77176 230.13126 235.73375 244.48625 249.84575 255.53825 259.07974 261.90396 264.36545 269.04996 271.87418 277.56668 283.02518 286.56668 289.45029 295.0528 298.8913 304.25079 308.9353 314.2948 319.9873 323.52881">#NP (selector)If the return code segment is not present.</tspan><tspan y="-382.98285" x="46.01915 53.36945 58.828854 63.992153 68.066452 71.222755 76.620056 82.305359 84.759659 88.119362 92.198166 96.875465 102.32677 107.92207 113.32477 138.16386 141.94476 145.10106 147.92525 153.32254 156.20613 161.80144 167.19873 172.79404 178.19673 181.02092 184.17722 189.57451 195.25981 197.71411 201.24841 204.132 209.5833 214.2606 218.93791 224.62321 228.45451 233.13182">#PF(fault-code)If a page fault occurs.</tspan><tspan y="-369.00314" x="46.01915 53.374851 59.524551 65.800255 69.879959 75.597656 138.11705 141.89975 145.06145 147.88564 153.28833 158.97903 161.80322 167.49393 173.18463 178.58733 181.04703 183.50673 189.10742 194.79813 200.15582 205.75653 208.64012 217.39082 222.74852 231.49922 236.95592 240.79262 246.11432 248.99791 252.83461 258.19232 261.35403 266.71173 270.54843 275.90613 281.59683 286.27954 291.63724 294.52084 299.97754 304.66025 309.34296 315.03366 318.87036 323.55307 326.27917 333.62497 339.30576 344.70847 350.35056 353.23416 356.76395 362.44473 367.79254 370.67615 376.94196 382.35275 387.39636 390.22058 392.67038 397.34317 400.22678 405.93457 408.75879 414.15158 419.83237 425.42316 428.30676 433.69955 436.14935 438.54605 444.18546 449.86624 458.60706 464.00977 469.65186 473.18164 476.06525 480.73804 486.41882 491.76663 496.43942 501.75122 504.20102 509.88181 515.52118 518.3454 520.79523 525.46802">#AC(0)If an unaligned memory reference occurs when the CPL is 3 and alignment checking is </tspan><tspan y="-357.96283" x="137.81917 143.16606 148.84596 154.23787 159.82777 162.27667 167.62357 173.21347">enabled.</tspan><tspan y="-343.98312" x="46.019173 53.367672 59.942173 66.867676 138.15128 141.92677 145.08127 147.90546 151.43796 157.12146 162.47195 165.35555 170.27853 177.35794 183.62643 189.84993 192.67412 198.31352 202.15562 207.50612 210.66061 213.05731 218.3988 221.28239 223.67909 228.3591 231.24269 236.92619 241.6017 246.95219 252.5457">#UD If the LOCK prefix is used.</tspan><tspan y="-330.00342" x="46.019173 53.365871 59.632572 65.044273 67.927879 71.998581 76.681282 82.074982 85.902679 89.973381 96.213081 101.88578 107.41448 111.48518 115.25888 121.49858 127.17128 132.69998 138.09908 141.87277 145.02547 147.84966 151.38036 157.06206 162.41075 165.29434 170.88605 174.71375 180.06244 185.37514 187.82584 193.27353 198.95523 203.69554 206.51973 212.58304 218.75888 224.21828 227.04248 230.20148 234.03548 239.48947 248.23747 251.12108 255.80109 261.48907 266.88907 272.48706 277.94107 285.29407 288.11826 292.79825 296.33524 301.73523 306.41522 311.73422 314.55841 318.63541 325.9884 331.67639 337.0314 342.71939 345.54358 349.37759 354.7326 358.26959 363.95758 367.7916 373.47958 375.93658 381.62457 387.22256 390.04675 393.58374 399.03775 401.92133 408.19434 413.65375 418.65775 421.54132 428.89432 434.60931 438.68631 441.56989 447.0239 450.85791 453.6821 456.84109 460.67511 466.12912 474.87711 477.70129 481.48129 487.66519 493.38019 499.09518 504.81018 510.26959 515.27362 520.98865 526.7514 532.75525 538.93915 544.33917">#CP (Far-RET/IRET)If the previous SSP from shadow stack (when returning to CPL &lt;3) or from IA32_PL3_SSP </tspan><tspan y="-318.9631" x="137.81918 141.89888 145.68068 151.03838 154.57808 160.26878 164.10548 169.74759 172.20369 177.89439 183.49509 186.37868 189.91838 195.37508 198.19926 204.47496 209.89566 214.90236 217.78595 223.50365 227.58334 230.46693 232.86363 237.54362 240.42722 246.11792 251.57462 255.11432 257.93854 263.65625 266.53986 272.14056 277.46225 281.00195 286.35965 289.18387 294.58658 297.04626 299.50595 305.10666 310.79736 316.15506 321.75577">(returning to CPL 3) is not 4 byte aligned.</tspan><tspan y="-304.9834" x="138.11888 141.90428 145.06868 147.89288 151.73228 157.09268 160.63509 166.32849 170.16789 175.8613 178.3237 184.01711 189.6205 192.4447 195.98711 201.4465 204.33011 210.05051 215.7709 219.8533 225.4567 227.85339 231.3958 234.2794 239.7388 243.5782 246.4024 251.0878 256.54721 265.3006 270.90399 276.30939 279.85178 282.31418 287.91757 290.37997 292.84238 295.30478 298.78418 304.10858 306.93277 315.68616 321.14557 326.74896 332.10938 334.99295 340.39835 346.09174 351.69513 354.51932 358.06171 363.7551 369.15781 371.98199 377.58539 381.42477 386.82748 392.10959 394.57199 400.0314 405.72479 410.41019 413.23438 419.29767 425.42126 430.84467 433.66885 436.83325 440.67264 446.13205 454.88544 457.70963 462.39502 468.08841 473.4938 479.0972 484.55661 491.91501 494.7392 499.42459 502.96698 508.37238 513.0578 518.3822 521.20642 525.28882 532.64722 538.34064 543.70105 549.39447">If returning to 32-bit or compatibility mode and the previous SSP from shadow stack (when </tspan><tspan y="-294.00339" x="137.81918 141.60098 147.00368 150.53798 156.22328 160.05458 165.69669 168.15099 173.83629 179.43159 182.31519 185.84949 191.30078 194.12497 200.39526 205.81056 210.81186 213.69545 221.04575 226.75804 230.83234 233.65652 239.10782 242.93912 245.82271 248.979 252.83917 258.28506 267.02496 269.84918 273.62109 279.80499 285.5119 291.21881 296.98151 302.39142 307.38733 313.15002 318.85245 324.91574 331.03934 336.49875 339.32297 343.39188 347.21777 352.56467 356.09357 361.77347 365.59937 371.27927 373.72818 379.40808 385.04749 387.8717 391.4006 396.8465 399.7301 405.995 411.45441 416.45032 419.27454 425.03723 429.11603 431.94025 434.38916 439.06107 441.88528 447.52469 452.8671 458.0889 463.54919 469.2291 474.819 477.70261 483.40952 490.3674 496.43158">returning to CPL &lt;3) or from IA32_PL3_SSP (returning to CPL 3) is beyond 4GB.</tspan><tspan y="-279.96338" x="138.11887 141.90517 145.07047 147.89467 151.73497 157.09627 160.63957 166.33388 170.17418 175.86848 178.75209 181.14879 186.8503 191.53659 195.0799 198.9202 204.6145 209.3008 212.8441 215.3074 220.7677 226.40981 229.29341 234.89771 240.358 242.8213 248.51561 252.05891 257.42023 261.26053 264.08475 267.25006 271.09036 276.55066 285.30496 288.12918 292.81549 296.3588 301.76511 306.45142 311.7767 314.66031 320.06662 325.70874 331.31305 334.13727 338.82358 344.51788 349.92419 355.5285 360.9888 368.34811 371.17233 375.85864 379.40195 384.80826 389.49457 394.81985 397.70346 403.30777 408.76807 411.59229 417.28659 422.74689 426.29019 429.1738 437.9281 443.33441 446.87772 451.56403 457.25833">If return instruction pointer from stack and shadow stack do not match.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-256.32001" x="46.02 52.198189 57.777782 63.078495 65.580444 68.650116 75.036469 80.676819 86.256416 89.738434 95.377785 100.12074 104.86369 107.38357 115.0448 120.68415 126.2737 131.91306 134.37317 139.95175 145.17378 149.61296 155.2523 160.65262 164.67346 167.15549 172.79483 178.50391">Real-Address Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-241.98" x="46.02 53.377502 60.348003 138.1674 141.9483 145.1118 147.93599 151.47749 157.17 162.5295 165.41309 169.25159 174.61108 178.15259 183.84509 187.68359 193.3761 196.20029 198.66179 204.35429 209.03879 212.58029 216.41879 222.0609 226.80119 230.3409 232.73759 238.19789 243.8904 246.77399 252.37648 257.83499 260.23169 265.9332 269.4747 274.8342 278.6727 281.49692 283.9584 288.64291 291.46713 297.15964 302.61813 306.15964 309.04324 316.40076 318.86224 322.40375 328.09625 330.49295 336.19446 339.07806 342.61957 348.26166 353.62115 356.44537 360.28387 365.64337 369.18488 374.87738 378.71588 384.40839 387.29199 391.9765 397.435 403.03751 408.397 411.28061 415.96512 421.32462 426.92712 435.67963 441.03912 446.73163 450.27313 453.15674 455.55344 458.00952 466.76202 469.22351 472.76501">#GPIf the return instruction pointer is not within the return code segment limit.</tspan><tspan y="-228.00029" x="46.02 53.375702 59.439003 138.1629 141.9438 145.1055 147.9297 151.46941 157.16011 162.51781 165.40141 168.94112 174.39781 179.9985 182.82271 188.4234 193.7451 197.28481 202.6425 207.3828 210.207 215.6637 218.82539 221.6496 226.33229 229.87199 235.27469 239.95738 245.27908 248.10329 253.50598 257.34268 262.70038 265.5246 271.2153 276.672 280.2117 283.03592 290.39163 292.85132 296.39102 302.03311 304.4928 310.1835 313.00772 317.69043 321.29044 326.69315 331.37585 336.69754 339.58115 341.97784 344.43393 353.18463 355.64432 359.18402 363.86673">#SSIf the top bytes of stack are not within stack limits.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-204.3" x="46.02 52.492008 54.980015 58.603462 62.624317 68.339363 73.646049 76.153976 79.229622 85.353027 91.53022 97.653625 103.77703 106.29691 113.96412 119.60347 125.199 130.83836 133.29849 138.83426 144.05629 148.49545 154.13481 159.53513 163.55597 166.04398 171.68333 177.39838">Virtual-8086 Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-189.96001" x="46.02 53.376602 60.346203 65.767807 69.848404 75.567001 138.1458 141.9294 145.092 147.91618 151.45679 157.14839 162.50699 165.39058 169.22818 174.58678 178.12738 183.81898 187.65659 193.34819 196.17238 198.63298 204.32458 209.00818 212.54878 216.38638 222.02849 226.76878 230.30849 232.70518 238.16548 243.85709 246.74068 252.34229 257.7999 260.19659 265.89807 269.43866 274.79727 278.63486 281.45908 283.91968 288.60327 291.42749 297.11908 302.57669 306.11728 309.00089 316.35748 318.81808 322.35867 328.05026 330.44696 336.14844 339.03204 342.57263 348.21472 353.57333 356.39755 360.23514 365.59375 369.13434 374.82593 378.66351 384.3551 387.23871 391.9223 397.37991 402.98151 408.34012 411.22372 415.90732 421.26593 426.86752 435.61911 440.97772 446.66931 450.2099 453.09351 455.4902 457.94632 466.69791 469.15851 472.6991">#GP(0)If the return instruction pointer is not within the return code segment limit.</tspan><tspan y="-175.9803" x="138.11971 141.8997 147.0657 149.9493 153.72929 160.8033 166.2213 171.2253 174.10889 179.79689 185.25089 188.78789 191.61208 196.96707 202.56508 208.20718 213.61078 216.06778 218.95137 222.48837 227.94237 230.76656 236.48155">IF IOPL not equal to 3.</tspan><tspan y="-162.0006" x="46.020004 53.370304 58.829708 63.993008 68.067307 71.22361 76.620911 82.306213 84.760513 88.120216 92.19902 96.87632 102.32762 107.92292 113.32562 138.16472 141.94562 145.10191 147.9261 153.32339 156.20699 161.80229 167.19958 172.79489 178.19759 181.02177 184.17807 189.57536 195.26067 197.71497 201.24927 204.13286 209.58415 214.26146 218.93877 224.62407 228.45537 233.13268">#PF(fault-code)If a page fault occurs.</tspan><tspan y="-147.9606" x="46.020004 53.375706 59.439007 65.588707 69.668411 75.386108 138.14491 141.92761 145.08931 147.91351 151.45322 157.14392 162.50162 165.38522 168.92493 174.38162 179.98233 182.80653 188.40723 193.72893 197.26863 202.62633 207.36662 210.19083 215.64752 218.80922 221.63342 226.31612 229.85582 235.25851 239.94121 245.26291 248.08711 253.48981 257.32651 262.6842 265.50842 271.19913 276.65582 280.19553 283.01974 290.37546 292.83514 296.37485 302.01694 304.47662 310.16733 312.99155 317.67426 321.27426 326.67697 331.35968 336.68137 339.56497 341.96167 344.41776 353.16846 355.62814 359.16785 363.85056">#SS(0)If the top bytes of stack are not within stack limits.</tspan><tspan y="-133.9809" x="46.020004 53.336105 59.519104 65.756111 69.834015 75.551712 138.07022 141.85292 145.01462 147.83791 153.2406 158.9313 161.75459 167.4453 173.136 178.5387 180.9984 183.4581 189.05881 194.74951 200.10721 205.70792 208.59061 217.34131 222.69901 231.44971 236.9064 240.7431 246.02431 248.907 252.7437 258.10141 261.26312 266.62082 270.45752 275.81522 281.50592 286.18863 291.54633 294.42905 299.88574 304.56845 309.25116 314.94186 318.77856 323.46127 326.28461 331.68732 337.37802 342.97873 345.86145 351.26416 353.65994 356.11963 361.72034 367.36154 376.12393 381.48163 387.17233 390.71204 393.59476 398.27747 403.96817 409.32587 414.00858 419.33026 421.72516 427.41586 433.01657 435.89929 438.35898 443.04169 445.86502 451.22272 456.91342 462.31613 467.91684 470.31262 475.71442 481.31512">#AC(0)If an unaligned memory reference occurs and alignment checking is enabled.</tspan><tspan y="-120.0012" x="46.020004 53.368504 59.943005 66.868507 138.15211 141.92761 145.08211 147.9063 151.4388 157.1223 162.47279 165.35638 170.27937 177.35878 183.62727 189.85077 192.67496 198.31436 202.15646 207.50696 210.66145 213.05815 218.39964 221.28323 223.67993 228.35994 231.24353 236.92703 241.60254 246.95303 252.54654">#UD If the LOCK prefix is used.</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="511.16821pt" height="505.69312pt" viewBox="0 0 511.16821 505.69312" sodipodi:docname="640.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.16617" inkscape:cy="238.40796" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg102" /><g transform="translate(-45.62537,-69.112849)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-715.31989" x="45.119999 50.603973 56.19751 64.480247 70.093704 75.41832 79.408295 81.868416 87.508766 90.014702 92.540558 95.000679 99.02153 104.55531 107.07519 114.76032 120.35386 125.96732 131.56085 134.08073 139.63443 144.91721 149.35637 154.93596 160.39603 164.35712 166.86305 172.45659 178.18956">Compatibility Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-700.97998" x="45.119999 52.437 59.393101 64.841698 68.920494 74.622894 137.20169 140.9826 144.16681 146.99101 152.70061 157.86301 162.84631 169.03021 175.98631 182.04961 185.34721 192.06662 197.58452 201.66333 207.24333 209.69943 213.26703 216.09123 221.83684 227.53925 231.61806 234.44226 241.82587 244.65007 250.39568">#GP(0)If EFLAGS.NT[bit 14] = 1.</tspan><tspan y="-687.00031" x="45.119999 52.2075 55.757999 61.459499 66.801903 70.649406 73.47361 78.84211 84.063904 88.757401 94.0998 99.679802 103.2195 105.68999 111.15749 116.85899 121.55249 124.37669 129.07019 134.48369 143.24519 148.5876 151.47121 156.8847 161.5782 164.4024 166.87291 172.57442 175.39862 180.83012 184.67763 190.14513 193.69563 199.03804 203.71803 207.26854 212.61095 218.22244 221.04665 228.60846 234.06876 239.68025 245.02266">Other exceptions same as in Protected Mode.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-663.29999" x="45.119999 51.264324 57.408649 60.505215 66.818863 69.327789 73.320755 75.780876 83.469002 89.065529 94.681976 100.2785 102.73862 108.29531 113.57809 117.9575 123.59686 128.99718 133.01804 135.52696 141.12349 146.85945">64-Bit Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-649.02002" x="45.119999 52.437 59.393101 64.841698 68.920494 74.622894 137.20169 140.9826 144.16681 146.99101 152.70061 157.86301 162.84631 169.03021 175.98631 182.04961 185.34721 192.06662 197.58452 201.66333 207.24333 209.69943 213.26703 216.09123 221.83684 227.53925 231.61806 234.44226 241.82587 244.65007 250.39568">#GP(0)If EFLAGS.NT[bit 14] = 1.</tspan><tspan y="-634.98004" x="137.2197 141.0042 144.16769 146.9919 150.5334 156.22591 161.5854 164.46901 168.30751 173.66701 177.20851 182.90102 186.73952 192.43202 195.25623 199.94072 205.39922 211.00171 216.36121 219.18541 223.8699 229.2294 234.83189 243.5844 248.94389 254.6364 258.17789 261.00211 265.68661 271.04611 273.5076 278.8671 283.60739 287.14709 292.548 296.39011 299.27371 301.7352 306.41971 309.24393 315.97144 322.55493 327.56345 332.57196">If the return code segment selector is NULL.</tspan><tspan y="-621.00037" x="137.2197 141.0006 144.16049 146.9847 150.5226 156.2115 161.5674 164.451 169.1319 172.6698 178.07069 182.75159 188.07149 190.89569 195.5766 200.9325 206.5314 215.2803 220.683 226.38451 229.92241 232.74661 237.42752 242.78342 245.24132 250.59721 255.27811 258.81601 264.2709 268.1058 270.98941 273.4473 278.1282 280.95242 287.67633 294.25623 299.26114 304.2597 307.08392 312.68283 318.13773 320.59561 326.28452 331.88342 334.76703 340.36594 345.76685 350.44775 355.76764 358.59186 362.12976 367.58466 370.46826 375.14917 380.60406 389.35297 394.95187 400.35278 403.89069 406.28738 411.92679 414.38467 416.78137 419.23926 422.71866 428.03857 430.86279 439.61169 445.06659 450.6655 456.06821">If the stack segment selector is NULL going back to compatibility mode.</tspan><tspan y="-607.02069" x="137.21971 141.00241 144.16411 146.98831 150.52802 156.21872 161.57642 164.46002 169.14272 172.68242 178.08511 182.76781 188.08951 190.91371 195.59641 200.9541 206.55481 215.30551 220.70821 226.40971 229.94942 232.77362 237.45631 242.81401 245.27371 250.63141 255.3141 258.85379 264.31049 268.14719 271.03079 273.49048 278.17319 280.99741 287.72311 294.30481 299.31152 304.31824 307.14246 312.74316 318.19986 320.65955 326.35025 331.95096 334.83456 340.43527 345.83798 350.52069 355.84238 358.6666 362.2063 367.66299 370.5466 376.8223 382.24301 387.24973 392.96744 395.85104 401.56876 407.28647 411.36618 416.96689 419.36267 422.90237 425.78598 434.53668 439.93759 445.5383 450.896">If the stack segment selector is NULL going back to CPL3 64-bit mode.</tspan><tspan y="-592.98071" x="137.21971 141.00151 144.16231 146.8065 152.2083 154.79219 161.517 168.09779 173.10359 178.10939 180.75359 185.43538 188.97418 194.37598 199.05777 204.37857 206.96246 211.64426 217.04695 222.64676 231.39656 236.75336 242.44316 245.98196 248.62616 253.30795 258.66476 261.12357 266.48038 271.16217 274.70096 280.15677 283.99255 286.63675 292.88455 298.30435 303.31015 305.89404 308.35284 313.03464 315.67883 321.36862 326.82443 330.36322 332.94711 338.34982 343.92981 349.6196 355.02139 357.48019 360.06409 363.60287 369.05869 371.70288 377.97769 383.39749 388.40329 391.04749 396.64728 402.10309 404.56189 410.25168 415.85147 418.49567 424.09546 429.49725 434.17905 439.49985 442.14404 445.68283 451.13864 453.78284 459.42493 464.88522 470.57501 474.65381 480.92862 486.34842 491.35422 497.07101 499.71521 505.43201 511.1488 515.2276 520.82739 523.28619 526.82501 529.46924 538.21906 543.67487 549.27466 554.63147">If a NULL stack segment selector RPL is not equal to CPL going back to non-CPL3 64-bit mode.</tspan><tspan y="-579.00104" x="137.21971 141.00511 144.16951 146.99371 150.53612 156.22952 161.58992 164.47353 168.31293 173.67332 177.21573 182.90913 186.74854 192.44194 195.26614 197.72855 203.42195 208.10735 211.64975 215.48915 221.18256 225.86795 229.41035 231.80705 237.26735 242.96075 245.84436 251.44775 256.90717 259.36957 265.01166 268.55405 273.91446 277.75385 280.57803 283.04044 287.72583 290.55002 296.24341 301.67941 305.2182 308.10181 315.4566 317.91541 321.45419 327.14398 329.54068 335.24216 338.12576 341.66455 347.35434 352.71115 355.53537 359.37115 364.72797 368.26675 373.90884 377.74463 383.43442 386.31802 390.99982 396.45563 402.05542 407.41223 410.29584 414.97763 420.33444 425.93423 434.68402 440.04083 445.73062 449.26941 452.15302 454.54971 457.00583 465.75562 468.21442 471.7532">If the return instruction pointer is not within the return code segment limit.</tspan><tspan y="-565.02136" x="137.21971 141.00511 144.16951 146.99371 150.53612 156.22952 161.58992 164.47353 168.31293 173.67332 177.21573 182.90913 186.74854 192.44194 195.26614 197.72855 203.42195 208.10735 211.64975 215.48915 221.18256 225.86795 229.41035 231.80705 237.26735 242.96075 245.84436 251.44775 256.90717 259.36957 265.01166 268.55405 273.91446 277.75385 280.57803 283.04044 287.72583 290.55002 296.24341 301.70282 307.39621 311.47861 316.164 321.5694 327.26279 332.7222 338.41559 340.81229 345.49768 350.90308 353.36548">If the return instruction pointer is non-canonical.</tspan><tspan y="-550.98138" x="45.12001 52.47121 59.43541 64.851608 68.926811 75.072014 80.474716 82.871414 88.274117 92.952316 96.487518 101.93972 105.77192 137.21072 140.99162 144.14882 146.97301 152.3712 155.25479 159.933 165.28619 170.8824 179.6286 184.9818 190.668 194.2032 197.08679 201.765 207.11819 209.57339 214.92659 219.6048 223.14 228.59219 232.42439 235.24858 237.70378 243.38998 248.98619 254.38889 259.70609 262.58969 264.98639 269.72668 272.5509 278.00311 283.6893 287.22449 291.90268 294.35788 299.95407 305.30728 308.19089 310.58759 314.12726 318.80545 321.68906 327.28525 332.63846 337.37875 342.05875 345.89096 348.28766 353.88385 357.41904 362.87125 366.70346 369.52768 373.06287 378.46106 384.05725 386.51245 391.86566 394.74927 397.20447 399.60117 408.34735 410.80255 414.33774 419.01593">#GP(Selector)If a segment selector index is outside its descriptor table limits.</tspan><tspan y="-537.00171" x="137.21971 141.00241 144.16411 146.9883 152.39099 155.27458 159.95728 165.31497 170.91568 179.66638 185.02408 190.71478 194.25449 197.13808 202.73877 208.09647 212.77916 217.46185 221.29855 223.75826 229.35895 232.89865 238.35535 242.19205 245.07564 253.82634 259.18405 267.93475 273.33566 277.17236 282.49405 285.37766 290.78036 296.38107 301.98178 305.81848 311.22119 315.9039 320.58661 323.41083 325.87051 330.55322 333.37744 339.06815 344.52484 350.21555 354.29526 358.97797 364.38068 370.07138 375.52808 381.21878 383.61548 388.29819 393.7009 396.16058">If a segment descriptor memory address is non-canonical.</tspan><tspan y="-522.96173" x="137.21971 141.00241 144.16411 146.9883 150.528 156.2187 161.5764 164.45999 169.14268 174.50038 180.10107 188.85178 194.20947 199.90018 203.43988 206.32347 211.92416 217.28186 221.96455 226.64725 230.48395 232.94365 238.54434 242.08405 247.48404 251.32074 254.20433 257.36603 262.82272 266.60364 269.48724 274.88995 277.71417 282.39688 287.85358 293.45428 298.81198 301.6362 306.37561 311.7171 317.31781 326.06851 331.42621 337.11691 340.65662 343.43939 349.04279 354.5022 359.86261 364.548 367.37219 373.06558 378.52499 382.06738 384.95096 387.34677 393.04825 398.65164 401.04834 405.73373 411.13913 414.68152 420.08423 422.90842 425.37082 428.91321 431.7374 434.1998 438.88519 441.76877 447.17416 449.99835 454.68375 460.14316 465.74655 471.14926 473.97345 478.65884 484.01926 489.62265 498.37604 503.73645 509.42984 512.97223">If the segment descriptor for a code segment does not indicate it is a code segment.</tspan><tspan y="-508.98203" x="137.2197 141.0042 144.16769 146.991 150.5325 156.22501 161.5845 164.46721 170.0697 173.9082 179.3667 184.96919 190.42769 195.11218 200.47168 206.07417 208.89748 214.58998 219.94948 227.30698 230.13028 234.87057 240.27147 245.87396 251.23346 254.05676 258.79706 264.13947 269.74197 278.49448 283.85397 289.54648 293.08798 295.91129 301.51379 306.87329 311.5578 316.24231 320.08081 322.5423 328.14481 331.68631 337.14481 340.98331 343.866 349.50809 354.91171 359.59622 362.47891 368.08142 373.53992 377.08142 382.77393 385.59723 389.13873 394.83124 400.19073 403.01404 409.94855 414.03006 419.63257 422.09406 425.63556 428.45886 433.86337 439.55588 445.15839 448.04108 452.30438 456.38321 461.98572 464.4472 467.98871 470.81201 475.49652 480.85602 484.39752">If the proposed new code segment descriptor has both the D-bit and L-bit set.</tspan><tspan y="-495.00232" x="137.2197 141.0024 144.16409 146.98828 150.52798 156.21869 161.57639 164.45998 171.39267 176.81337 181.82007 184.70366 187.82756 193.28786 197.12456 200.00815 205.41084 208.23503 213.92574 219.38243 225.07314 229.75583 235.21252 240.85463 244.01633 249.47302 253.30972 262.06042 264.52011 270.1622 275.76291 279.84262 284.52533 289.98203 295.58273 300.94043 303.82404 308.50674 313.86444 319.46515 328.21585 333.57355 339.26425 342.80396 345.68756 348.08426 352.79941 355.6236 361.31699 366.7764 370.31879 373.14297 378.50339 384.10678 389.80017 395.20557 397.60226 400.48584 404.02823 409.48764 412.31183 415.85422 421.54761 426.90802 429.7916 436.043 441.4664 446.4758 449.29999 454.7594 457.9238 460.74799 464.29037 469.98376 475.34418 478.22775 482.91315 488.37256 493.97595 499.33636 502.21994 506.90533 512.26575 517.86914 526.62256 531.98297 537.62512 541.16754">If the DPL for a nonconforming-code segment is not equal to the RPL of the code segment </tspan><tspan y="-483.96201" x="136.91911 141.59732 146.95052 149.40572 154.75891 159.43712 162.97232 168.42451 171.00661">selector.</tspan><tspan y="-469.9823" x="137.21881 141.00421 144.16861 146.99281 153.27121 158.69461 163.70401 166.52821 168.99062 173.67601 176.50021 182.10361 185.94301 191.30341 196.7088 200.25121 205.6116 209.451 212.33461 215.87701 221.51912 226.92451 232.61792 235.50153 239.04393 244.73734 250.09773 252.92194 259.17334 264.59674 269.60614 272.45911 277.914 281.07391 283.95752 287.49542 293.18433 298.54022 301.36444 306.04535 311.50024 317.09915 322.45505 325.27927 329.96017 335.36288 340.96179 349.71069 355.06659 360.75549 364.2934 367.11761 371.79852 377.20123 379.59793 385.00064 389.68155 393.21945 398.67435 401.19614">If CPL is greater than the RPL of the code segment selector.</tspan><tspan y="-456.00259" x="137.21881 141.00601 144.17221 146.99641 150.54062 156.23582 161.59802 164.48163 171.41882 176.84402 181.85522 184.73883 190.13972 193.32393 196.20753 201.61473 204.43893 209.12613 214.58733 220.28253 223.44873 228.90993 232.75113 241.45413 243.91023 249.60544 255.21063 259.29483 263.98203 269.44324 275.04843 280.41064 283.23483 287.92203 293.28424 298.88943 307.64462 313.00684 318.70203 322.24622 325.0704 327.53461 332.2218 335.04599 340.65118 344.3988 349.7547 355.15561 358.69351 364.04941 367.88431 370.76791 374.30582 379.99472 385.39563 391.03772 393.92133 397.45923 403.14813 408.50403 411.32825 415.16315 420.51904 424.05695 429.74585 433.52765 439.22916 442.11276 446.79367 452.24857 457.84747 463.20337 466.08698 470.76788 476.12378 481.72269 490.47159 495.82748 501.51639 505.05429 507.9379 512.61877 517.97467 520.43256 525.78845 530.46936 534.00726 539.46216 543.29706">If the DPL of a conforming-code segment is greater than the return code segment selector </tspan><tspan y="-444.96228" x="136.9191 143.14799 148.54889 153.5358">RPL.</tspan><tspan y="-430.98257" x="137.2188 141.0096 144.1794 147.0036 150.55141 156.25021 161.61601 164.49962 169.19041 172.73822 178.14902 182.83981 188.16962 190.99382 195.68462 201.05042 206.65921 215.36221 220.72801 226.42682 229.97462 232.79883 235.26663 239.95743 242.78163 248.48044 253.94524 257.49304 260.37662 265.78741 268.6116 275.9754 279.82019 282.21689 285.75659 291.16739 296.77618 299.17288 304.57559 307.39978 313.00858 318.41937 321.96716 327.37796 330.26154 334.95233 340.31815 345.92694 354.62994 359.99576 365.63785 369.18564">If the stack segment is not a writable data segment.</tspan><tspan y="-417.00287" x="137.2188 141.0069 144.174 146.9982 150.5433 156.23941 161.60251 164.48611 169.17421 172.71931 178.12741 182.81551 188.14261 190.96681 195.65491 201.01801 206.6241 215.3271 220.6902 226.38631 229.93141 232.75562 238.36171 243.72481 248.4129 253.101 256.94308 259.33978 264.97919 268.52429 273.98639 277.82849 280.65271 287.59082 293.01691 298.02899 300.9126 303.37769 308.0658 310.89001 316.58612 322.04822 325.59332 328.41754 333.78064 339.38675 345.08286 350.49097 352.95605 355.78027 359.32538 364.78748 367.61169 371.1568 376.85291 382.216 385.09961 391.3537 396.77979 401.79187 404.61609 410.07819 413.2453 416.06952 419.61462 425.31073 430.67383 433.49805 437.34015 442.70325 446.24835 451.94446 455.78656 461.48267 464.30688 468.995 474.45709 480.0632 485.4263 488.25052 492.93863 498.30173 503.90784 512.66394 518.02704 523.72314 527.26825">If the stack segment descriptor DPL is not equal to the RPL of the return code segment </tspan><tspan y="-405.96255" x="136.9191 141.59731 146.9505 149.4057 154.7589 159.4371 162.97231 168.4245 171.00659">selector.</tspan><tspan y="-391.98285" x="137.2188 141.0015 144.16319 146.9874 150.5271 156.2178 161.5755 164.45911 169.1418 172.6815 178.0842 182.76689 188.08859 190.9128 195.59549 200.95319 206.55389 215.3046 220.70729 226.4088 229.9485 232.77271 237.4554 242.8131 245.2728 250.63049 255.31319 258.85287 264.30957 268.14627 271.02988 277.27856 282.69928 287.70599 290.53021 292.9899 297.67261 300.49683 306.18753 311.64423 315.18393 318.06754 323.42523 329.02594 334.71664 340.11935 342.57904 345.40326 348.94296 354.2988 357.1824 360.71759 366.40378 371.75699 374.58121 380.82541 386.24161 391.2438 394.12741 399.52832 402.71252 405.59613 409.13132 414.8175 420.17072 422.99493 426.82715 432.18036 435.78033 441.42242 445.25464 450.94083 453.82443 458.50262 463.95483 469.55103 474.90424 477.78784 482.46603 487.81924 493.41544 502.16162 507.51483 513.20105 516.73627 519.61987 524.2981 529.65131 532.10651 537.45972 542.13794 545.67316 551.12537 553.70746">If the stack segment selector RPL is not equal to the RPL of the return code segment selector.</tspan><tspan y="-378.00314" x="45.11911 52.473911 58.537212 64.686012 68.764816 74.481613 137.24042 141.02222 144.18301 147.00722 152.40901 158.09882 160.98242 166.38422 169.92302 173.46182 178.81862 187.56842 193.16821 196.70702 199.53122 203.07002 208.52582 211.40942 217.00922 222.46501 228.06482 230.94843 236.35022 239.17442 244.33592 249.73952 252.19832 257.88812 263.24493 266.06912 271.52493 274.68573 277.84653 280.67072 284.2095 289.89929 295.2561 298.13968 302.82147 306.36026 311.76205 316.44385 321.76465 324.58884 329.90964 332.30634 337.76215 340.22095 345.62274 349.16153 354.51834 359.25864 362.08282 365.62161 371.3114 376.66821 379.55179 385.55569 391.73959 394.56378 397.02258 399.48138 408.23117 410.62787 414.16754">#SS(0)If an attempt to pop a value off the stack violates the SS limit.</tspan><tspan y="-363.96313" x="137.21881 141.00061 144.16141 146.98561 152.38741 158.07721 160.96082 166.36261 169.90141 173.44022 178.79701 187.54681 193.14661 196.68541 199.50961 203.04842 208.50421 211.38782 216.98761 222.44341 228.04321 230.92682 236.32861 239.15282 244.31432 249.71791 252.17671 257.86652 263.22333 266.04752 271.50333 274.66412 277.82492 280.64911 284.1879 289.87769 295.2345 298.11807 302.79987 306.33865 311.74045 316.42224 321.74304 324.56723 329.24902 334.65082 340.34061 345.0224 350.37921 355.061 357.94458 363.34637 366.17056 371.86035 377.31616 383.00595 387.08475 391.76654 397.16833 402.85812 408.31393 413.95602 416.41214 421.09393 426.49573 428.95453 431.77872 437.24261 442.82172 448.42151 452.25729 457.61411 462.2959 466.97769 469.86127 473.40005 478.85587 481.68005 487.27985 492.63666 495.46085 499.29663 504.69934 507.86014 513.26282 517.09863 522.45544 528.14526 532.82709 538.1839 543.78369">If an attempt to pop a value off the stack causes a non-canonical address to be referenced.</tspan><tspan y="-349.98343" x="137.21881 141.00421 144.16861 146.99281 150.53522 156.22862 161.58902 164.47263 168.31203 173.67242 177.21483 182.90823 186.74763 192.44104 195.26524 199.95064 203.49304 208.89844 213.58383 218.90823 221.73244 226.41783 231.77823 237.38162 246.13503 251.49542 257.18881 260.7312 263.55539 266.01779 270.70319 273.58676 279.22885 284.68915 288.23154 291.11511 296.71851 300.55789 305.9183 310.6037 315.96411 321.6575 325.19989">If the return stack segment is not present.</tspan><tspan y="-336.00372" x="45.11911 52.479309 59.209511 64.634712 67.458908 71.543106 76.230309 81.592506 83.989212 89.35141 94.038612 97.582809 103.04401 106.88521 137.1846 140.9718 144.138 146.9622 150.50641 156.20161 161.56381 164.44742 168.28862 173.65082 177.19502 182.89023 186.73143 192.42664 195.25084 199.93803 205.39923 211.00443 216.36662 219.19083 223.87802 229.24022 234.84541 243.60062 248.96281 254.65802 258.20221 261.0264 263.4906 268.1778 271.00198 276.69717 282.15839 285.70258 288.58615 294.19135 298.03253 303.39474 308.08194 313.44415 319.13934 322.68353">#NP (selector)If the return code segment is not present.</tspan><tspan y="-321.96371" x="45.11911 52.46941 57.928814 63.092113 67.166412 70.322716 75.720016 81.405319 83.859619 87.219322 91.298126 95.975426 101.42673 107.02203 112.42473 137.26382 141.04472 144.20102 147.02521 152.4225 155.30609 160.9014 166.29869 171.894 177.29669 180.12088 183.27718 188.67447 194.35977 196.81407 200.34837 203.23196 208.68326 213.36057 218.03787 223.72318 227.55447 232.23178">#PF(fault-code)If a page fault occurs.</tspan><tspan y="-307.98401" x="45.11911 52.473911 58.622711 64.897514 68.976318 74.693115 137.21251 140.99431 144.15511 146.97929 152.38109 158.07089 160.95448 166.59659 172.2981 177.69989 180.15869 182.61749 188.21729 193.90709 199.26389 204.86368 207.74727 216.49707 221.85387 230.60367 236.05946 239.89526 245.21606 248.09966 251.93546 257.29227 260.45306 265.80988 269.64566 275.00247 280.69226 285.37405 290.73087 293.61447 299.07028 303.75208 308.43387 314.12366 317.95944 322.64124 325.37912 332.72583 338.40753 343.81021 349.51172 352.33594 355.86664 361.54834 366.89703 369.78064 376.04733 381.45905 386.50266 389.32687 391.77759 396.45129 399.3349 405.04361 407.86783 413.26154 418.94324 424.58264 427.40686 432.80057 435.25128 437.64801 443.28741 448.96912 457.71082 463.11349 468.75558 472.28629 475.16989 479.8436 485.5253 490.87399 495.5477 500.86041 503.31113 508.99283 514.63226 517.45648 519.90717 524.58087">#AC(0)If an unaligned memory reference occurs when the CPL is 3 and alignment checking is </tspan><tspan y="-297.004" x="136.91911 142.26601 147.94591 153.33781 158.92772 161.37662 166.72351 172.31342">enabled.</tspan><tspan y="-282.96399" x="45.119118 52.468517 59.043919 66.008125 137.23233 141.00873 144.16412 146.98831 150.52171 156.20612 161.55751 164.4411 169.36411 176.44351 182.71291 188.9373 191.76149 197.40089 201.243 206.59439 209.74979 212.20319 217.51859 220.40218 222.79887 227.47888 230.36247 236.04688 240.72328 246.07468 251.66908">#UD If the LOCK prefix is used.</tspan><tspan y="-268.98428" x="45.119118 52.472118 58.745117 64.163116 67.046715 71.123718 75.866722 81.266724 84.98912 89.066124 95.312126 100.99113 106.52613 110.60313 114.38313 120.62914 126.30814 131.84314 137.24223 141.02223 144.18123 147.00543 150.54243 156.23044 161.58543 164.46904 170.06705 173.90105 179.25604 184.57504 187.03204 192.48604 198.17404 202.85403 205.67824 211.74155 217.86514 223.32454 226.14874 229.30774 233.14174 238.59573 247.34373 250.22734 254.90735 260.59534 265.99533 271.59332 277.04733 284.40033 287.22452 291.90451 295.43881 300.83612 305.51343 310.82974 313.65396 317.72827 325.07858 330.76389 336.11618 341.80148 344.6257 348.457 353.8093 357.4093 363.05139 366.88269 372.56799 375.02231 380.70761 386.30292 389.12714 392.66144 398.11273 400.99634 407.26663 412.72604 417.72736 420.61096 427.96127 433.67358 437.74789 440.6315 446.08279 449.91409 452.73831 455.89462 459.72592 465.17722 473.92252 476.74673 480.52405 486.70795 492.42026 498.13257 503.84488 509.30429 514.3056 520.01788 525.78058 531.84387 537.98816 543.40344">#CP (Far-RET/IRET)If the previous SSP from shadow stack (when returning to CPL &lt;3) or from IA32_PL3_SSP </tspan><tspan y="-258.00427" x="136.91911 141.00061 144.83911 150.19861 153.74011 159.43262 163.27112 168.91322 171.36932 177.06183 182.66432 185.54791 189.08942 194.54791 197.3721 203.6496 209.0721 214.0806 216.90479 222.62428 226.70578 229.58937 231.98607 236.66606 239.54965 245.24216 250.70065 254.24216 257.06638 262.78589 265.66949 271.272 276.59549 280.13699 285.49649 288.32071 293.72522 296.18671 298.64819 304.2507 309.94321 315.3027 320.90521">(returning to CPL 3) is not 4 byte aligned.</tspan><tspan y="-243.96428" x="137.21881 141.00151 144.16321 146.98741 150.82411 156.18181 159.78181 165.42392 169.26062 174.95132 177.41103 183.10173 188.70242 191.52663 195.06633 200.52303 203.40663 209.12433 214.84203 218.92172 224.52243 226.91913 230.45883 233.34244 238.79913 242.63583 245.46004 250.14273 255.59943 264.35013 269.95084 275.35355 278.89325 281.35294 286.95364 289.41333 291.87302 294.3327 297.8121 303.13379 305.95801 314.70871 320.16541 325.76611 331.12381 334.00742 339.41013 345.10083 350.70154 353.52576 357.06546 362.75616 368.15887 370.98309 376.5838 380.4205 385.82321 391.10529 393.56497 399.02167 404.71237 409.39508 412.2193 418.28259 424.46649 429.88721 432.71143 435.87314 439.70984 445.16653 453.91724 456.74146 461.42416 467.11487 472.51758 478.11829 483.57498 490.93069 493.75491 498.43762 501.97733 507.38004 512.06274 517.38446 520.26801 524.34772 531.70343 537.3941 542.75183 548.4425">If returning to 32-bit or compatibility mode and the previous SSP from shadow stack (when </tspan><tspan y="-232.98428" x="136.91911 140.75851 146.11891 149.66132 155.35472 159.19412 164.83623 167.29863 172.99203 178.59543 181.47903 185.02144 190.48083 193.30504 199.58344 205.00684 210.01624 212.84044 220.19884 225.91924 230.00163 232.82584 238.28523 242.12463 245.00824 248.17264 252.01204 257.47144 266.22482 269.04901 272.83441 278.98682 284.70721 290.42761 296.14801 301.57141 306.58081 312.30121 318.02161 324.0849 330.11942 335.54282 338.367 342.4494 346.28879 351.6492 355.19159 360.88498 364.72437 370.41776 372.88016 378.57355 384.17694 387.00113 390.54352 396.00293 398.88651 405.12442 410.58383 415.59323 418.41742 424.13782 428.22021 431.0444 433.50681 438.1922 441.01639 446.61978 451.98019 457.202 462.66229 468.35568 473.95908 476.84265 482.56305 489.53445 495.65897">returning to CPL &lt;3) or from IA32_PL3_SSP (returning to CPL 3) is beyond 4GB.</tspan><tspan y="-219.00458" x="137.21971 141.00331 144.16591 146.99011 150.82771 156.18631 159.78632 165.42842 169.26602 174.95763 177.84123 180.23793 185.93944 190.62303 194.16364 198.00124 203.69284 208.37643 211.91704 214.37764 219.83524 225.52684 228.35104 233.95264 239.41023 241.87083 247.56244 251.10304 256.46164 260.29922 263.1828 266.3454 270.18298 275.64059 284.39218 287.21637 291.89996 295.44055 300.84415 305.52774 310.85034 313.73392 319.13751 324.7796 330.3812 333.20538 337.88898 343.58057 348.98416 354.58575 360.04337 367.39996 370.22415 374.90775 378.44833 383.85193 388.59222 393.91483 396.7984 402.39999 407.8576 410.68179 416.37338 421.83099 425.37158 428.25516 437.00674 442.41034 445.95093 450.63452 456.32611">If return instruction pointer from stack and shadow stack do not match.</tspan></text></g></svg>     <hr />     <p class="not_instruction_page">         This <b>UNOFFICIAL</b> reference was generated from the official <a href="https://www.intel.com/content/www/us/en/developer/articles/technical/intel-sdm.html">Intel® 64 and IA-32 Architectures Software Developer’s Manual</a> by a dumb script.         There is no guarantee that some parts aren't mangled or broken and is distributed <b>WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE</b>.     </p> </body>  </html>
