<!DOCTYPE html> <html lang="en">  <head>     <meta charset="utf-8">     <title>PCONFIG</title>     <link rel="stylesheet" href="styles.css">     <link rel="stylesheet" href="../intel.css"> </head>  <body>     <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="513.59998pt" height="645.17438pt" viewBox="0 0 513.59998 645.17438" sodipodi:docname="989.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.76" inkscape:cy="423.99812" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg258" /><g transform="translate(-45.18,-68.824219)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="12" class="cA49CCA52 cD0BE81C2 c209E837B"><tspan y="-714" x="46.02 53.341202 59.6436 67.612801 75.893997 82.5672 85.7724 93.165604 96.165604 105.93481 108.93481 116.256 119.2812 125.67841 130.46761 134.84641 141.56522 145.93442 155.89561 158.89561 165.48482 172.20602 178.86363 183.54243 186.54364 193.28883 200.17804 204.26044 210.65764 215.44684 218.44804 225.16925">PCONFIG â€” Platform Configuration</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-616.32001" x="235.67999 238.36819 244.06631 248.74551 252.76637 256.3689 262.12677 266.69742 270.65851 273.1774 278.78387 284.52979 287.04968 293.6492 299.28955 304.89603 308.3183 313.65585 319.40176 324.98135 327.50125 333.0679 338.76599 343.20517 348.78476 354.41116 356.93005 362.62814">Instruction Operand Encoding</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2 c209E837B"><tspan y="-561" x="46.02 51.838501 56.865002 61.144501 65.235001 68.497498 70.734001 75.654305 79.255203 81.491707 86.518204">Description</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-545.99969" x="46.02 51.440701 57.7164 64.793098 71.518799 76.6875 80.4702 87.438904 90.202805 95.605507 98.065208 100.52491 105.98161 113.33731 118.02001 120.84422 125.52692 130.98361 134.14531 137.68501 144.94171 150.34531 154.18201 159.5397 162.3036 165.84331 171.3 174.12421 178.8069 184.2636 189.9543 193.116 195.5757 201.17639 206.8671 210.7038 216.06149 218.8857 223.56839 228.92609 232.76279 236.30249 241.70518 244.16489 249.85559 252.61949 258.22018 260.61688 266.01959 269.5593 272.72101 278.1777 282.0144 290.76511 293.52902 296.69073 302.04843 307.45114 310.91968 316.61487 320.45605 325.81827 330.50546 333.77966 336.54355 341.96875 348.24896 355.33017 362.06036 367.23355 371.02075 378.03717 380.80106 385.48825 391.18344 396.78864 402.39383 407.79474 411.63681 415.181 419.9213 422.68518 431.44037 437.13556 439.53226 443.07196 445.53616 451.14136 453.60556 458.96777 461.79196 464.25616 469.61838 475.02557 478.19177 480.95566 484.12186 489.81705 495.51224 500.19943 503.74362 506.14032 511.60153 517.29675 521.98395 525.25812 528.02203 535.38226 537.77893 541.32312 547.01831 549.84253 555.24976">PCONFIG allows software to configure certain platform features. PCONFIG supports multiple leaf functions, with a </tspan><tspan y="-535.01971" x="46.019989 48.483288 53.844589 59.250889 62.416191 65.000092 68.16539 73.807487 79.501785 84.188087 87.731384 90.194687 95.654984 101.34928 103.93318 106.39648 112.00079 117.36208 123.00418 126.54748 129.01077 132.17607 134.63937 140.00067 145.60497 148.24916 153.85345 159.17876 161.82295 165.36626 171.06056 176.42186 179.00575 184.16725 189.57085 192.03415 197.67625 203.03755 205.49998 207.95338 213.63779 216.22168 221.89708 228.04048 234.19289 237.45628 240.10048 245.63188 251.31628 256.66769 259.25159 263.082 268.48471 274.0791 276.5325 281.20889 284.74228 290.09369 293.9241 298.60049 301.18439 307.48169 313.6062 319.75861 323.022 325.6662 331.9086 338.17801 344.33041 347.63251 350.2164 355.61279 361.29718 366.89157 369.53577 375.77817 382.62 388.77509 391.35901 400.10611 405.50522 410.8233 413.40723 419.00433 422.83743 428.29053 433.60864 436.06473 441.66183 447.01593 449.66016 452.11624 457.80334 463.40045 469.08755 472.62366 475.26788 480.72098 484.55408 487.138 492.59109 498.2782 501.8143 507.41141 513.09851 516.63458 519.21844 521.67456 527.36163 530.51971 535.97284 539.80597 548.5531 553.95221">leaf function identified by the value in EAX. The registers RBX, RCX, and RDX may provide input or output informa-</tspan><tspan y="-523.97943" x="46.019989 49.557888 52.015789 57.416687 63.118187 65.942383 69.10228 74.557182 78.392082 81.216278 85.897179 91.253082 95.087982 98.625885 104.02679 106.48469 112.17359 114.99779 117.45569 122.81159 128.15489 133.37669 138.73259 143.41348 146.68138 149.50558 155.65349 158.11139 160.56929 163.39349 165.85139 171.20729 176.55058 181.77238 187.12828 191.86858 194.69278 202.04668 205.88158 208.33948 211.87738 217.23328 220.05748 224.73837 228.27628 233.67717 237.21507 242.90398 247.58487 250.40907 252.86697 258.55588 261.71579 267.17068 271.00558 279.75449 285.1554 288.6933 291.15118 296.51968 302.20947 305.03458 308.57336 314.02917 316.85428 322.53506 328.68387 334.84167 337.66678 343.26657 348.95636 352.49515 355.32025 360.92004 366.37585 369.20096 374.89075 380.34656 383.88535 386.71045 395.46024 400.86115 406.46094 408.91974 412.08054 417.40134 420.22644 426.47424 432.64105 438.79886 442.06766 444.89276 451.14056 457.41537 463.57318 466.84198 469.66708 475.12289 478.95868 481.78378 488.03159 494.96338 501.12119 503.94629 509.58838 515.28992 517.74872 523.10553 527.78735 532.46918 535.29431 538.83313 544.52295 549.87976 555.20056">tion for certain leaves. All leaves write status information to EAX but do not modify RBX, RCX, or RDX unless they </tspan><tspan y="-512.99945" x="46.019989 51.419991 55.25399 60.60899 63.492592 69.090591 74.445595 76.902596 82.590599 88.188599 91.012794 96.700798 101.3808 106.7358 112.3338 115.158 120.558 125.238 128.1216 130.5786 135.93359 141.33359 144.27748 148.35448 153.03448 158.63249 163.98749 168.66748 171.12448 174.28348 176.74048 181.42047 184.30406 189.70496 195.40646 198.94347 204.54147 210.18358 213.72328">are being used as leaf-specific output.</tspan><tspan y="-496.97946" x="46.019989 51.656693 57.060291 61.800591 67.442688 69.786285 75.206985 81.482689 88.559387 95.285088 100.45379 104.23649 111.20518 113.54878 115.94548 121.34818 126.75088 129.91258 132.25618 135.41788 141.10858 146.75069 151.43068 155.03069 157.42738 162.88408 168.57478 170.91838 176.32108 181.92178 187.52249 189.98219 192.44189 197.79959 202.48228 204.82588 208.36559 213.82228 216.10648 221.50917 223.85277 228.53546 234.13617 239.49387 244.17656 246.57326 249.75746 252.21716 256.89987 259.18408 264.87479 270.2775 274.1142 279.7149 286.97162 292.37521 296.21191 301.50031 303.78452 309.40323 311.85931 317.26022 322.00055 327.28265 329.62625 334.30627 339.7099 342.16599 344.56268 349.93839 355.5184 357.862 363.28271 365.56693 371.00562 377.24353 384.33823 391.05765 396.22006 400.00095 406.95703 409.30063 412.85834 418.27905 422.13376 427.71378 433.08948 436.64719 439.88898 442.23257 447.65326 453.36197 458.94199 461.2262 466.6019 472.02258 476.70261 482.40411 484.68832 490.12701 496.36493 503.45963 510.17905 515.34143 519.12238 526.07849 528.42206 531.97974 537.40045 541.25513 546.83514 552.21082 555.76849">Each PCONFIG leaf function applies to a specific hardware block called a PCONFIG target, and each PCONFIG target </tspan><tspan y="-485.99945" x="46.020004 48.482403 53.167801 55.992001 61.3974 66.082802 70.768204 76.2276 80.913002 83.375404 88.780807 92.323204 97.683601 103.287 106.1112 113.4696 115.932 119.4744 125.16779 128.05139 133.45679 136.28099 141.9744 147.6678 156.3708 161.7312 165.5706 167.9673 172.64729 178.05269 180.51509">is associated with a numerical </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c89C0ADDA"><tspan y="-485.99945" x="183.36 187.4559 193.45981 197.92471 204.20761 210.17551 214.27141 217.03351 220.10341 226.38631 232.3542 238.7541 242.85001 245.97211 249.76201 252.83191 258.7998">target identifier</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-485.99945" x="261.95972 265.22223 268.10583 274.24832 279.93182 285.52533 291.16473 296.61423 300.44373 303.97623 309.32672 314.92023 317.80383 321.33633 326.73184 330.56134 336.15485 341.50534 345.03784 347.92145 350.31818 355.95758 361.30807 366.99158 370.52408 372.97659 376.1311 378.58362 383.93411 387.76361 392.43912 395.32272 400.71823 404.54773 409.89822 412.78183 418.13232 423.81583 429.49933 438.24283 443.64551 447.30762 452.70312 456.23563 461.58612 467.17963 470.48175 473.30597 478.70148 481.15399 486.60349 492.28699 497.88049 500.7641 508.11261 510.56512 514.0976 519.78107 522.60529 528.05481 531.58728 537.27075 542.62128 546.45081">. Supported target identifiers are enumerated, along with other </tspan><tspan y="-474.95914" x="46.02002 51.439819 57.714619 64.790421 71.515221 76.683022 80.464821 87.432617 90.256813 94.938614 100.34042 105.94022 111.34202 116.94182 119.40062 121.85942 124.25612 127.79492 130.25372 135.61052 140.29231 143.56111 146.38531 148.84412 154.53392 157.35812 160.89693 166.58673 171.98943 174.81363 179.49542 185.18523 190.78503 194.86383 197.32263 202.67943 208.02272 213.24452 218.64722 223.32721 226.15141 231.60721 234.76801 237.59221 241.13101 246.82082 252.17761 255.06122 260.48102 266.75583 273.83163 280.55643 285.72421 289.50601 296.47382 300.54004 303.00153 308.69403 311.85754 317.31604 321.15454 329.90704 335.31155 338.85306 341.31454 346.77304 352.41513 355.29874 357.76022 363.11972 368.52423 371.68774 374.51196 379.97046 383.13397 385.95819 392.23569 397.65817 404.24167 408.02618 414.96069 417.8443 421.92581 427.60931 433.7608 439.9213 442.74551 450.10303 452.92725 458.64676 464.81625 471.57074 475.65225 478.92377 481.74799 487.89948 493.59198 496.4162 501.82071 505.36221 508.90372 514.26324 522.96625 528.60565 532.14716 534.97137 538.51288 543.97137">PCONFIG capabilities, in the sub-leaves of the PCONFIG-information leaf of CPUID (EAX = 1BH). An attempt to </tspan><tspan y="-463.97913" x="46.020035 51.375034 56.596836 61.951836 66.631836 72.319839 75.856842 81.211845 84.095451 89.495453 95.183456 98.007652 103.69566 109.38366 114.98166 120.33666 123.49567 125.95267 131.64067 136.99567 142.59367 145.47726 147.87396 153.27666 158.67665 161.83565 164.65984 167.81883 173.50684 179.19484 183.87485 187.41185 189.86885 195.32285 201.01085 204.27785 207.16144 212.61543 216.44943 219.27362 224.67361 227.55721 229.9539 235.3566 240.75659 243.91559 246.79918 249.95818 255.64618 261.33417 266.01416 269.55115 272.00815 277.46216 283.15015 285.97437 289.51135 295.19934 300.59933 304.07971 306.96332 312.36423 317.96313 323.56204 326.01993 328.47781 333.83371 338.51462 341.39822 344.93613 350.39102 353.21524 358.61615 364.30505 367.12927 372.81818 378.50708 383.18799 388.87689 394.4758 400.07471 405.5296 409.3645 412.9024 418.30511 423.88513 426.70935 430.24725 435.64816 439.48306 445.08197 450.43787 453.97577 456.85938 459.25516 464.89456 470.25046 475.93936 479.47726 481.87305 485.03296 487.49084 492.84674 495.42883 498.69675 501.58035 505.41525 510.77115 515.45203 521.14093 523.59882 527.13672 531.81763 534.64185 537.09973 542.78864 545.61285 551.01373">execute an undefined leaf function, or a leaf function that applies to an unsupported target identifier, results in a </tspan><tspan y="-452.99911" x="46.02002 51.624321 56.985622 62.679924 68.041222 71.763626 77.167229 79.630531 83.713829 89.31813 93.158432 98.618729 102.16203 107.52332 112.20963 115.75292 118.21622 123.67653 129.37083 132.19504 137.55634 142.83844 147.52473 152.88603 158.49033 162.03363 164.49693 169.95723 175.65154 178.47574 182.55904 189.91833 196.89064 202.31494 206.39824 209.67154 212.49574 216.57904 220.36534 226.05965 228.88385 232.42715 238.12146 243.48276 246.30696 249.47226 255.16656 258.70987 264.35199 268.19229 273.55359 276.8269 279.71051 283.25381 288.89594 294.25723 297.08145 302.50574 308.74362 315.82391 322.55322 327.72552 331.51181 338.4841 342.56741 345.0307 350.72501 353.89032 359.35062 363.13242 371.89572 377.30203 380.84534 383.30862 388.76892 394.46323 397.28745 399.75073 405.11203 410.51834 413.68365 416.50787 421.96817 425.13348 428.01709 434.25497 439.65497 446.24026 450.02655 456.96286 459.78708 468.54138 473.8847 479.16678 482.05038 487.41168 493.10599 498.80029 507.5546 512.91589 516.57794 521.98425 525.52753 530.88885">general-protection exception (#GP). (In the future, the PCONFIG-information leaf of CPUID may enumerate </tspan><tspan y="-441.9588" x="46.02002 51.439819 57.714619 64.790421 71.515221 76.683022 80.464821 87.432617 90.256813 94.938614 100.34042 105.94022 111.34202 116.94182 119.40062 121.85942 124.25612 127.79492 130.25372 135.61052 140.29231 143.1759 145.6347 151.27681 154.1604 159.56219 165.16199 170.76178 173.15848 176.69728 179.15608 184.61188 190.30168 193.12587 196.66467 202.12047 205.00406 208.54286 214.23267 219.58946 222.41365 227.09544 232.78525 238.38504 243.98483 249.44063 253.27643 256.81522 262.17203 267.77182 270.65543 274.19421 279.59601 283.43179 289.03159 294.3884 297.92719 300.81079 303.26959 308.86938 314.2262 319.91599 323.45477 325.91357 329.07437 331.53317 336.88998 340.67178 345.41208 348.65387">PCONFIG capabilities in addition to the supported target identifiers.)</tspan><tspan y="-426.9585" x="46.02002 52.162521 57.801918 63.395416 67.224915 72.575417 77.250916 81.926414 87.329117 92.004616 94.828819 100.22432 105.90782 111.50132 114.38493 119.83443 125.42793 130.77843 134.44052 139.83603 145.51953 151.15894 155.83894 158.66313 164.05862 167.88812 173.23862 176.12221 181.8327 187.5432 190.42679 196.02029 198.47279 202.00529 206.6808 209.50499 214.95448 220.63799 224.17049 228.84599 231.29849 236.892 242.29469 245.11888 250.82938 256.59207 260.66458 266.25809 268.7106 272.2431 275.06732 283.81082 289.26031 294.85382 300.20432 303.08792 308.48343 314.15973 319.73972 322.56393 327.99274 331.85553 337.23932 340.06354 345.76593 351.52863 354.35284 359.97964 362.37634 365.94214 370.62213 373.50574 375.96185 381.60394 384.48755 390.18994 395.89233 399.97113 405.59793 407.99463 411.56042 414.44403 423.22083 428.70361 434.2836 439.62598 442.92178 445.746 451.26392 456.96542 462.34921 465.17343 470.33493 475.73853 478.13522 483.83673 489.22052 492.04474 497.52753 500.71533 503.53955 509.84134 515.90466 519.14642 526.1106 528.93481 534.51392 539.97418 545.35797 550.03796">Addresses and operands are 32 bits outside 64-bit mode and are 64 bits in 64-bit mode. The value of CS.D does </tspan><tspan y="-415.97849" x="46.02002 51.707119 57.160217 60.696316 63.520515 68.919617 72.077713 75.235809 80.638512 85.317612 88.853714 91.67791 97.131012 102.72811 108.08221 111.74432 117.14342 122.83052 128.42763 131.31123 135.99033 138.44643 143.06253 148.46523 151.28943 156.74252 160.57562 163.39983 168.79892 174.39603 179.99313 183.82623 189.18033 193.85944 198.53854 201.42215 206.10126 208.55736 213.17346 218.57616 221.84225">not affect operand size or address size. </tspan><tspan y="-400.97818" x="46.02002 50.518219 55.921818 61.523418 63.98402 69.342621 72.166817 77.929512 82.008308 87.726906 93.445503 96.329102 101.0127 106.7043 112.1052 119.4816 124.1652 126.9894 130.53 136.2216 141.6243 144.4485 146.9091 152.2677 157.6713 160.83389 163.6581 169.06079 174.7029 179.38649 184.84409 190.44568 192.84238 198.53398 204.13559 208.81918 211.64339 214.80598 220.26358 224.10118 226.92538 232.34698 238.62358 245.70119 252.4278 257.59738 261.38098 268.35059 271.62119 274.44537 279.84897 285.54056 291.14215 293.99973 298.49792 303.90152 309.49771 311.95291 317.30612 320.13031 325.89301 329.9718 335.685 341.39819 344.28177 348.95996 354.64615 360.09836 367.44955 372.12775 375.01132 378.54651 384.2327 389.63541 392.45959 394.91479 400.26801 405.6662 408.82339 411.64758 415.4798 420.88251 426.4787 428.9339 433.61209 437.14728 442.50049 446.3327 449.15689 454.84308 459.52127 464.91946 470.55887 475.91208 478.73627 481.89346 487.34567 491.17789 494.00208 499.46149 505.6994 512.77161 519.4928 524.65698 528.43518 535.45154">Table 4-15 shows the leaf encodings for PCONFIG, and Table 4-16 shows the leaf register usage for PCONFIG.</tspan><tspan y="-206.99847" x="46.02002 51.548721 57.230423 62.579124 64.863327 72.435028 78.656731 84.185432 91.757133 97.429832 103.13853 109.36024 115.03294 120.55264 126.26134 131.67303 137.91273 144.98044 151.94014 158.23744 164.36104 171.93274 174.21693 176.66763 182.07033 187.46404 190.61673 192.84062 198.28833 201.44102 203.70003 209.11443 215.38382 222.45422 229.17363 234.33603 238.11243 245.07483 247.35902 252.95343 258.30484 262.13525 265.66864 271.06503 273.51843 279.20282 283.87921 286.10312 289.63651 295.08691 297.37112 300.90451 306.5889 311.99161 314.21552 321.78992 328.01431 333.54572 341.16782">The MKTME_KEY_PROGRAM leaf of PCONFIG pertains to the MKTME</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="7.2" class="cB46BCADE cECB6486A"><tspan y="-210.60001" x="346.79999">1</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-207" x="351.42001 353.64392 357.20071 362.62051 366.4743 372.05429 377.42908 380.98587 384.22766 386.51187 393.82889 399.5304 401.98651 406.6665 412.3743 414.59821 420.306 425.7258 430.40579 432.6297 436.18649 441.60629 445.46008 451.07788 456.42026 459.95996 462.18387 464.63998 470.21997 475.59476 481.30255 484.85934 487.25604 490.43484 492.89096 498.23334 502.07544 504.29935 510.03415 513.27594 515.56012 519.341 522.88074 525.10461 527.56073 532.24078 534.46466 540.17249 544.85254 550.22736 555.80646"> target, which has target identifier 1. It is used </tspan><tspan y="-195.9597" x="46.020325 51.618324 56.937325 59.820923 64.500923 69.954926 73.113922 76.650925 83.907623 89.311226 93.145226 98.547928 101.37212 104.90913 110.36313 113.18732 121.93533 127.33533 132.97743 138.38103 143.97903 149.33403 152.15823 155.69524 161.38324 166.73824 169.56244 174.78424 180.18694 185.50594 188.38954 193.78954 198.46954 203.14954 208.60353 213.28354 215.68024 221.08023 224.61723 230.01993 235.59993 238.42413 245.77713 248.17383 251.71083 257.39883 260.22302 265.62302 268.4472 274.38809 279.7305 285.0495 288.8295 295.55429 298.85638 301.68057 307.21558 312.84064 318.19205 321.01624 323.46964 328.82104 334.21744 337.37283 340.19702 343.35242 349.0368 354.72119 359.46149 362.99487 365.39157 370.84198 376.52637 379.35056 381.80396 386.48035 389.30453 391.75793 397.33972 402.56152 408.02182 413.33722 418.68863 424.28302 427.10721 432.7016 438.017 440.84119 445.51758 450.86899 454.40237 457.93576 460.38916 466.07355 471.66794 474.49213 478.02551 483.7099 489.06131 491.94489 494.34158 499.74429 505.14069 508.29608 511.12027 516.2818 521.68542 524.13885 529.82324 535.17462 537.99884 543.44922 546.60461 549.42883 555.14026">by software to manage the key associated with a KeyID. The leaf function is invoked by setting the leaf value of 0 </tspan><tspan y="-184.97971" x="46.020325 48.471924 54.154526 56.438725 62.112324 68.253922 74.404526 76.688728 82.083328 87.76593 93.358528 95.642731 99.174332 104.85693 110.20654 112.49074 117.88534 123.52473 129.11734 132.94594 138.29553 142.97014 147.64474 149.92894 155.37753 158.53113 160.81532 168.38792 174.61052 180.18872 187.75052 193.42412 199.18681 205.40941 211.08301 216.60361 222.3663 227.7789 234.0195 241.0881 248.04871 254.28931 260.47321 268.04581 273.7554 279.9393 285.45721 291.69781 298.27142 304.53903 310.06863 312.35284 314.80444 320.48703 322.74063 328.99112 335.16061 341.32111 344.59262 346.87683 353.02832 358.67041 363.35492 368.03943 373.44214 378.12665 382.81116 385.97467 391.61676 394.07285 396.35706 401.71655 406.93832 412.34103 417.02106 422.66315 426.20285 428.66434 434.12283 439.81534 442.09955 447.55804 450.72156 453.00577 456.54727 462.18936 467.59207 469.87628 472.33777 477.69727 483.10178 486.26529 488.5495 493.23401 495.63071 501.03342 506.43704 510.27554 514.96002 517.24426 523.49475 529.64624 535.80676 538.091 542.17249 546.85699 552.21649 555.758">in EAX and the address of MKTME_KEY_PROGRAM_STRUCT in RBX. Successful execution of the leaf clears RAX (set </tspan><tspan y="-173.99971" x="46.020325 49.571724 55.040123 57.804024 62.480423 67.822823 71.671219 77.139618 81.231018 83.994919 89.409317 95.111717 100.69172 103.51592 109.63503 113.53742 116.77923 119.60343 125.84133 129.68433 132.96573 135.72963 141.16203 145.00504 148.24684 151.07104 157.19466 161.03766 164.31906 167.08296 174.17136 178.01436 181.29576 184.05966 189.47406 195.17645 200.75645 203.58066 209.70427 214.86667 217.69087 223.10527 226.95367 232.29608 235.05998 239.75438 242.22578 247.56819 252.97179 256.82019 262.18958 267.76956 271.07166 273.83557 277.62997 283.33237 286.09628 290.79068 296.20508 300.89948 306.24185 308.88062 314.33731 317.49902 320.32324 323.48495 328.88766 331.28436 333.74045 339.43115 343.26785 348.62555 351.89526 354.65918 358.19888 363.88959 369.24728 372.0112 375.17291 380.57562 383.03531 385.495 391.1857 394.9675 400.37021 403.13412 406.97083 412.32852 417.73123 422.41394 427.87064 433.56134 436.32526 438.78494 443.46765 446.29187 448.68857 454.39008 459.99078 462.38748 467.07019 472.4729 476.0126 481.41531 487.01602 489.77994 492.23962 497.93033 500.69424 506.94293 513.09265 519.25134 522.0755 529.43121 531.89093 535.4306 541.12128 543.88513 550.04382 555.21252">to zero) and ZF, CF, PF, AF, OF, and SF are cleared. In case of failure, the failure reason is indicated in RAX with ZF </tspan><tspan y="-162.95941" x="46.020325 50.694023 56.042725 59.573425 62.457024 65.987724 71.435425 74.259628 79.96833 82.851936 88.245636 93.927338 99.519035 102.34324 108.60994 112.45294 115.75504 118.57924 123.99094 127.89333 131.15404 134.03763 140.17833 144.02133 147.32343 150.14761 157.21532 161.11772 164.37842 167.26201 172.65572 178.33742 183.97682 186.80101 192.98491 198.14731 200.9715 206.3652 210.1929 215.5416 218.42519 223.09889 225.54959 230.89828 236.29199 240.11969 245.46838 251.10779 254.34958 257.23318 262.76187 268.44357 273.79227 276.61649 284.23859 290.4801 296.00879 303.58047 309.25317 314.96188 321.18359 326.85629 332.43451 338.13693 343.54865 349.78836 356.85605 363.81573 370.05545 376.23935 383.81104 386.69464 389.09137 394.49405 399.88776 403.04047 405.92407 411.60577 416.27948 421.62817 426.30188 429.1261 432.6568 438.3385 443.74118">set to 1 and CF, PF, AF, OF, and SF are cleared. The MKTME_KEY_PROGRAM leaf uses the </tspan><tspan y="-151.97942" x="46.020325 53.592026 59.813725 65.342422 72.914124 78.586823 84.295525 90.517227 96.189926 101.70963 107.41833 112.87772 119.11472 126.18243 133.14212 139.38182 145.52252 153.14462 158.84702 164.98772 170.56592 176.80562 183.37833 189.64502 195.17372 198.05731 200.45401 206.15552 209.03911 217.78081 223.1835 231.9252 237.37289 241.20059 246.51329 249.33748 254.01118 259.69287 265.14056 272.48727 278.16898 280.99319 283.44391 289.12561 291.94983 296.44803 301.85162 307.44333 309.89404 315.24274 318.12634 323.83505 327.90576 333.61447 339.32318">MKTME_KEY_PROGRAM_STRUCT in memory shown in Table 4-17.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-700.97943" x="52.020626 57.977726 63.016827 67.036232 72.075333 77.114433 82.135536">Opcode/</tspan><tspan y="-691.0191" x="52.020626 54.418228 59.578827 63.778229 67.379128 70.649727 75.810326 79.908928 83.49453 85.739128 90.773727">Instruction</tspan><tspan y="-700.97943" x="184.32063 190.25974 195.36003">Op/</tspan><tspan y="-691.0191" x="184.32063 189.29944">En</tspan><tspan y="-700.97943" x="224.22034 229.73824 235.25613 238.67703 244.25523 249.77313">64/32 </tspan><tspan y="-691.0191" x="224.22034 229.25494 231.53464 235.10223 236.66193 243.56853 248.58513 253.61974 258.63632">bit Mode </tspan><tspan y="-680.99939" x="224.22034 229.21353 234.35973 239.46002 244.50003 249.52023 252.77643">Support</tspan><tspan y="-700.97937" x="272.22003 277.14752 282.66904 288.68555 291.07504 296.89355 299.11386 303.79208 308.83118 313.61469 317.1922 322.3447 325.4668 330.49329">CPUID Feature </tspan><tspan y="-691.01904" x="272.22003 277.22134 279.48663 284.28094">Flag</tspan><tspan y="-700.97937" x="353.94003 359.75854 364.78503 369.06454 373.15506 376.41757 378.65408 383.57437 387.17529 389.4118 394.43829">Description</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-665.99908" x="52.019745 57.867046 62.985348 65.20475 70.467049 75.189346 77.408745 82.671043 87.933342 90.15274 94.875038">NP 0F 01 C5</tspan><tspan y="-655.0191" x="52.019745 57.124546 61.625446 67.342247 73.176048 77.88485 79.965652 85.22345">PCONFIG </tspan><tspan y="-665.99908" x="184.31975 224.21945 229.86066 233.00616 272.18768 277.32217 281.82306 287.56955 293.39075 298.12924 300.23975 353.94006 359.09888 363.89139 365.81287 369.84036 372.05978 373.98126 378.78366 382.68515 386.04483 389.32532 394.06741 397.98691 401.3754 403.34189 408.0228 412.81531 415.03473 417.00122 420.96301 423.18243 427.97495 432.00244 436.68332 441.36243 443.58185 446.82184 451.56302 453.78244 458.28333 462.78152 467.51102 471.43051 476.17261 479.53229 484.26178 486.4812 489.78061 494.57312 499.36563 503.28513 506.67361 508.59509 513.33362 518.07568 522.10321 524.32263 527.5014 532.24261 535.48444">AV/VPCONFIGThis instruction is used to execute functions for </tspan><tspan y="-655.0191" x="353.94006 357.53918 362.2804 366.9028 370.2616 372.18491 376.86401 381.61331 384.91541 386.83871 391.64111 396.27341 398.4928 403.17191 405.09341 409.35312 412.77313 415.95193 420.63284 423.93494 430.83524 433.05463 436.23343 440.91434 445.23343 448.59314 453.34244 456.46454 461.15085 465.13516">configuring platform features.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-601.97943" x="53.40036 59.368259 64.418159 67.848061 72.843964 101.70156 106.61916 111.77706 116.82697 119.08687 166.90657 172.87447 177.92436 182.95627 186.01807 190.80696 195.96486 201.01476 203.29445 269.23206 275.17114 280.22104 285.25293 288.31476 293.11267 298.27057 303.37088 305.59122 377.34912 383.34851 388.39841 393.4303 396.49213 401.29004 406.44794 411.49783 413.77756 484.39514 490.33423 495.38412 500.41602 503.47784 508.27576 513.43365 518.48358 520.76324">Op/EnTupleOperand 1Operand 2Operand 3Operand 4</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-586.01971" x="62.940361 107.22036 113.04156 182.16156 188.04214 284.52216 290.40277 392.58246 398.46307 499.68246 505.56305">ANANANANANA</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-374.34" x="219.42 224.51753 229.85509 235.44763 237.95258 243.59192 246.05205 252.22925 255.28796 261.46515 267.58258 269.97797 272.49783 275.0177 281.08832 286.37012 293.02936 299.92966 305.46243 308.16159 314.29196 316.81183 321.73206 327.31165 332.61536 336.49478 338.9549 344.53348 350.2316 354.67078 360.31015 365.90268 368.3877 374.09976 379.74011">Table 4-15.  PCONFIG Leaf Encodings</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-358.98001" x="49.68 54.135902 59.113804 63.911705 170.77051 175.7493 180.9072 184.9491 189.9882 195.0282 197.24849 202.40639 289.28607 295.10638 300.14548 304.37637 308.45609 311.75818 313.97849 318.8988 322.49969 324.72 329.75909">LeafEncodingDescription</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-342.96002" x="49.68 56.271599 61.371899 66.568497 73.108795 77.846397 82.412994 87.393593 92.074493 97.217094 101.71799 106.85159 112.13099 117.82889 123.10918 128.54878 134.16838 170.76868 176.04628 181.26628 186.54388 191.82149 197.04149 202.31909 207.59669 212.8167 289.25729 294.41608 299.20767 301.12918 305.15579 307.37518 309.31378 313.99469 318.37408 321.67349 323.89288 325.85849 329.82031 332.0397 336.8313 340.85791 345.53882 350.2179 352.43729 355.67728 360.41849 362.63788 367.25757 370.37967 375.06058 379.73965 382.80145 387.30054 394.20084 396.42023 399.80783 404.59943 409.28033 411.49973 415.57944 420.13974 424.83234 427.05173 431.49142 436.29382 440.91351 443.1329 447.86151 452.60361 456.52222 459.80182 464.42151 468.86121 472.24881 474.17032 478.90793 483.65002 485.86942 492.83002 497.56763 502.18732 506.92761 509.147 513.58673 517.61334 521.63995 526.32086 530.23944 532.20502 536.46472 539.8847 544.56555 549.24469">MKTME_KEY_PROGRAM00000000HThis leaf is used to program the key and encryption mode associated </tspan><tspan y="-331.98001" x="289.26001 296.1828 298.16458 301.51437 306.3168 308.53622 312.98404 315.20346 320.12378 324.68408 329.36407 331.46469 336.97449">with a KeyID.</tspan><tspan y="-315.96002" x="49.680008 55.116909 59.85181 64.640709 69.321609 74.541603 80.002808 84.737709 170.77591 176.05081 181.27081 186.54572 191.82062 197.04062 202.31552 207.59042 212.81042 218.67032 220.88971 223.7346 225.95399 230.63489 235.36978 240.10468 244.78557 249.52046 254.25536 258.93628 263.67117 289.23206 294.51144 299.19232 303.21622 307.89709 311.17398 315.6731 320.35397 325.03308 327.2525 330.4313 335.11221 338.3891 340.60852 343.90793 348.71033 352.09521 356.83731 359.95941 364.64029 366.85971 371.64862 375.67252 380.35339 382.57281 385.17471 390.95361 396.23752 401.36841 403.97031 409.24521 411.84711 414.06653 416.02942 419.32883 421.54825 426.33716 430.36105 435.04193 439.72104 442.32294">RESERVED00000001H - FFFFFFFFHReserved for future use (#GP(0) if used).</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-279.29999" x="208.02 213.17729 218.45509 224.09544 226.61632 232.20488 234.72476 240.86111 243.94971 250.08606 256.26324 258.67456 261.13467 263.65454 269.77594 274.99799 281.65723 288.55753 294.10623 296.77652 302.95471 305.41483 310.33505 315.91464 321.23428 325.12964 327.64951 333.8277 339.40729 345.01578 347.51672 352.19592 356.21677 361.80533 365.44171 367.90182 374.62283 379.36279 384.68243 390.32278">Table 4-16.  PCONFIG Leaf Register Usage</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-264" x="50.459999 54.840298 59.879395 64.653893 176.61301 182.3235 187.845 304.60471 310.18292 315.10141 432.58112 438.29163 443.87164">LeafRBXRCXRDX</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-247.98" x="50.459999 57.015598 62.175301 67.335899 73.936501 78.6381 83.168701 88.148399 92.889595 97.996193 102.52679 107.6244 112.9038 118.662 123.8829 129.3423 134.9223 176.62291 178.7235 183.4791 188.15819 192.91379 196.26538 198.48479 203.22598 208.02838 209.93098 214.58759 304.5885 306.68912 311.4447 316.12381 320.87939 324.29938 326.51877 331.22037 336.02277 337.92535 342.58194 432.58286 434.68347 439.43909 444.11819 448.92059 452.28027 454.49966 459.20126 464.00366 465.90625 470.56284">MKTME_KEY_PROGRAMInput only.Input only.Input only.</tspan><tspan y="-231.95999" x="50.459999 55.862701 60.603901 65.358604 70.0998 75.259506 80.781006 85.481705 176.6796 181.8996 186.63989 190.62959 195.32129 198.6234 203.1225 207.81419 212.49329 214.71269 217.89149 222.57239 225.8745 228.0939 231.4086 236.211 239.56171 244.31641 247.43851 252.1194 254.33881 259.1412 263.1633 267.85501 304.69562 309.97504 314.65594 318.64563 323.33734 326.63943 331.13852 335.83023 340.50934 342.72873 345.90753 350.58844 353.89053 356.10992 359.42462 364.22702 367.57773 372.38013 375.44193 380.12283 382.34222 387.14462 391.16672 395.85843 432.69904 437.97845 442.65936 446.64905 451.38937 454.63208 459.13116 463.82288 468.50198 470.72137 473.90018 478.58109 481.88318 484.10257 487.41727 492.21967 495.57037 500.37277 503.43457 508.1749 510.39429 515.14899 519.13867 523.83038">RESERVEDReserved for future use.Reserved for future use.Reserved for future use.</tspan></text><clipPath><path transform="matrix(1,0,0,-1,0,792)" d="M 46.02,111.24 H 557.94 V 99.84 H 46.02 Z" inkscape:connector-curvature="0" class="cC2A381AD" /></clipPath><g clip-path="url(#cp312)"><clipPath><path transform="matrix(1,0,0,-1,0,792)" d="M 0,792.03 H 612 V 0.0300293 H 0 Z" inkscape:connector-curvature="0" /></clipPath><g clip-path="url(#cp313)"><path transform="matrix(1,0,0,-1,46.02,682.98)" d="M 0,0 V 0.48" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 46.02,109.02 h 144.24001 v 0.48001 H 46.02 Z" inkscape:connector-curvature="0" /></g></g><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-93.839996" x="46.02 51.2607 60.442501 65.143204 69.946503 73.189201 76.6101 81.364799 86.106003 89.348701 91.569 96.206703 100.64821 104.06911 108.5097 110.49241 112.41481 116.40451 118.62481 123.32551 128.12881 130.34912 136.90382 142.06442 147.22412 153.82562 158.52632 160.74663 165.54993 169.57292 174.02162 178.65932 183.35101 185.57132 189.45302 193.95302 198.70772 200.92802 205.56572 210.25742 212.47772 215.65742 220.39952 225.15422 229.95752 234.59521 236.81552 241.61882 246.30061 249.42361 254.10541">1.Further details on MKTME usage can be found here:</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE c209E837B"><tspan y="-79.860298" x="60.420002 65.042404 68.415604 71.788803 76.449005 80.461205 82.214401 85.093506 88.212006 92.224205 96.7854 100.1226 103.4958 110.442 114.9132 118.0353 122.7162 124.4244 126.3756 130.998 134.3577 139.0719 140.99609 142.7043 146.36371 151.08691 157.98721 161.11742 165.12962 167.08083 170.45403 175.16823 179.18044 182.31064 186.97084 191.53114 194.87999 199.31969 204.12209 206.06609 209.45909 212.60909 215.96608 217.88757 219.80907 224.54306 228.50485 231.65485 238.55515 243.04614 247.78824 252.27924 256.89893 261.63293 266.25262 269.40262 273.89362 279.11362 282.29242 287.51242 292.73969 295.86539 302.43808 307.21078 309.13049 312.49921 314.44589 317.2746 322.19489 326.75516 331.43515 334.26385 338.82236 343.32324 346.68295 351.14966 353.06937 355.95026 362.49054 367.20023 374.14194 378.86063 382.07999 386.75549 389.586 394.30649 399.08099 402.98248 406.245 410.9205 415.3602 418.73071 420.6792 425.39969 430.17419 433.0047 437.77921 442.43671 447.14819 451.04968 452.75519 457.41269 462.07019">https://software.intel.com/sites/default/files/managed/a5/16/Multi-Key-Total-Memory-Encryption-Spec.pdf</tspan></text><path transform="matrix(1,0,0,-1,0,792)" d="m 60.42,78.84 h 404.99999 v 0.59998 H 60.42 Z" inkscape:connector-curvature="0" class="c209E837B" /><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE c209E837B"><tspan y="-79.860001" x="465.42001"> </tspan></text><path transform="matrix(1,0,0,-1,0,792)" d="m 45.78,649.26 h 0.47998 v 60.48 H 45.78 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 178.08,648.72 h 0.48 v 61.5 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 217.98,648.72 h 0.48 v 61.5 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 265.98,648.72 h 0.48 v 61.5 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 347.7,648.72 h 0.48 v 61.5 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 557.1,649.26 h 0.47998 v 60.48 H 557.1 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.78,709.74 h 511.79998 v 0.48 H 45.78 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.78,674.76 h 511.79998 v 0.48 H 45.78 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.78,648.78 h 511.79998 v 0.4801 H 45.78 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.18,581.22 h 0.48001 v 31.5 H 45.18 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 85.8,580.74 h 0.480017 v 32.52 H 85.8 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 139.62,580.74 h 0.47999 v 32.52 H 139.62 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 235.74,580.74 h 0.48 v 32.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 344.22,580.74 h 0.48 v 32.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 451.92,580.74 h 0.48 v 32.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 558.3,581.22 h 0.48 v 31.5 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.18,612.78 h 513.59999 v 0.48 H 45.18 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.18,596.76 h 513.59999 v 0.48 H 45.18 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.18,580.74 h 513.59999 v 0.48 H 45.18 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.48,311.22 h 0.48001 v 58.5 H 45.48 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 166.5,310.74 h 0.48 v 59.51999 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 285,310.74 h 0.48 v 59.51999 H 285 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 558.06,311.22 h 0.48 v 58.5 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.42,369.72 h 513.12 v 0.48 H 45.42 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.42,353.76 h 513.12 v 0.48 H 45.42 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.42,326.76 h 513.12 v 0.48 H 45.42 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.42,310.74 h 513.12 v 0.48 H 45.42 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 46.2,227.22 h 0.48001 v 47.52 H 46.2 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 172.38,226.74 h 0.48002 v 48.48 H 172.38 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 300.36,226.74 h 0.47998 v 48.48 H 300.36 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 428.34,226.74 h 0.48 v 48.48 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 557.28,227.22 h 0.48 v 47.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 46.2,274.74 h 511.56 v 0.48 H 46.2 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 46.2,258.72 h 511.56 v 0.47999 H 46.2 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 46.2,242.76 h 511.56 v 0.47999 H 46.2 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 46.2,226.74 h 511.56 v 0.48 H 46.2 Z" inkscape:connector-curvature="0" /></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="512.46576pt" height="632.76678pt" viewBox="0 0 512.46576 632.76678" sodipodi:docname="990.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.68766" inkscape:cy="422.47932" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg212" /><g transform="translate(-45.234257,-80.092707)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-553.02002" x="45.119999 51.2715 54.155102 59.757603 65.117104 69.801605 74.486107 78.324608 80.78611 86.388611 89.988617 92.385323 97.843826 103.53632 106.36052 111.81902 114.98252 117.86612 123.22562 128.63011 133.31461 139.00711 141.83131 147.28981 150.45331 153.27751 156.81902 162.51152 167.87102 170.75462 173.91812 176.31482 181.67432 184.07101 189.67351 194.358 197.18221 199.64371 205.33621 208.16042 215.74292 221.94029 227.51849 235.08029 240.74939 246.45448 252.67258 258.34167 263.85779 269.62048 275.02859 281.26471 288.3288 295.28491 301.52103 307.70496 315.27307 320.97818 327.16211 332.67999 338.91611 345.4852 351.74829 357.3606 360.18481 362.6517 367.34161 370.16583 375.77374 379.61765 384.95825 390.29974 392.76663 398.37454 403.73944 409.34735 412.17157 417.77948 423.14438 425.61127 431.01218 438.37509">A description of each of the fields in MKTME_KEY_PROGRAM_STRUCT is provided below:</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-538.02002" x="45.119999">â€¢</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c89C0ADDA"><tspan y="-538.02002" x="62.099998 69.051598 75.1707 81.772202 86.693398 94.175995 97.806595">KEYID: </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-538.02002" x="100.5597 106.5006 111.84299 117.1665 119.99069 123.77519 129.37769 134.73718 140.37929 143.92079 146.38229 149.54579 152.00729 157.36679 161.20529 164.0295 169.63199 174.99149 177.45299 183.14549 188.74799 191.57219 197.17468 201.01318 206.47168 212.07417 215.73627 221.13986 229.89236 238.64487 244.00436 249.60686 252.49046 256.03195 261.49045 264.31467 267.85617 273.54868 278.90817 281.79178 289.37427 295.60678 301.14627 308.72876 314.41226 317.23648 322.59598 328.28848 333.89099 336.35248 341.99457 347.39728">Key Identifier being programmed to the MKTME engine.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-522.96002" x="45.119999">â€¢</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c89C0ADDA"><tspan y="-522.96002" x="62.099998 69.041702 75.160805 81.762306 86.68351 94.156212 100.51652 107.00011 113.18311 120.22382 125.92171 129.54242">KEYID_CTRL: </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-522.96002" x="132.36029 137.88989 143.57249 148.92209 151.74628 157.96887 163.64247 169.16307 172.93767 179.90187 185.60426 191.87186 197.45006 203.69066 208.68925 211.57285 214.72644 217.17804 222.52763 224.97923 230.57184 233.45543 238.13004 243.52463 247.35323 251.18182 253.63342 258.98303 263.65762 266.48181 270.0134 277.36099 282.8096 285.63379 290.30838 295.99097 301.63037 305.70917 308.86276 311.31436 316.66397 319.11557 324.70816 329.38275 332.26633 337.94891 342.6235 347.97311 353.58029 356.4639 362.06461 367.38629 370.2699 374.95261 380.4093 383.57101 387.11072 394.36743 399.77103 403.60773 408.96542 411.78964 415.32935 420.78604 423.66965 428.35236 433.80905 439.49976 443.03946 446.87616 452.33286 454.72955 457.61316 461.15286 466.84357 472.20126 475.02548 480.62619 485.98389 491.67459 497.01791 502.3396 504.79929 510.25598 514.09265 516.91687 522.3736 525.53528 528.3595 533.76221">The KEYID_CTRL field carries two sub-fields used by software to control the behavior of a </tspan><tspan y="-511.98001" x="62.100006 68.040909 73.383308 78.713104 82.503906 89.408707 93.487503 96.371101 102.609 108.0693 116.82809 125.5869 130.9977 136.6965 142.3053 145.1295 150.5403 156.1824 161.7912 164.6154 170.5563 175.8987 181.2285 185.0193 191.9241 194.80771 200.17351 205.87231 210.56311 214.40791 219.73772 225.34651 228.89432 231.36212 236.82692 242.46902 245.35263 250.76343 253.23123 258.84003 264.30484 268.14963 270.61743 274.16522 279.80731 288.5661 291.8439">KeyID: Command and KeyID encryption algorithm. </tspan><tspan y="-495.96002" x="62.100006 67.63501 73.323013 78.725716 81.849617 86.529617 91.98362 100.73162 109.47962 114.87962 120.56763 126.16563 129.34984 135.03784 139.77814 145.13313 150.73114 153.91534 158.59534 164.04933 169.73734 173.27434 177.10834 182.56233 184.95903 189.63904 192.82324 196.36024 202.04825 207.40324 210.58745 215.94244 221.63045 226.31046 230.14445 235.46346 241.06146 244.59846 247.05547 252.50946 258.19745 261.32135 270.06934 275.52335 281.12134 286.52405 289.64795 292.80695 298.26096 302.09497 305.27917 310.67917 313.80307 319.74396 325.08636 330.40536 334.18536 340.91016 344.21225 347.33615 351.83435 357.23795 362.83594 365.29294 370.64795 373.83215 379.54715 383.62415 389.38684 395.08923 398.27344 403.87143 407.70544 413.15945 418.47845 420.87515 426.51456 431.86957 436.54956 439.73376 445.13376 448.25766 452.93765 458.62564 467.37363 476.12161 481.52161 485.35562 490.67462 493.85883 499.31284 502.47183 505.65604 509.19302 514.88104 520.28375">The command used controls the encryption mode for a KeyID. Table 4-18 provides a summary of the </tspan><tspan y="-486.96002" x="62.100006 66.788109 72.250206 81.00631 89.762413 95.170517 100.86662 106.47272 111.16082 114.34502 119.03312 124.67522 130.28131 135.88741 141.3495 145.1916 148.73671 154.09981 159.7059">commands supported.</tspan><tspan y="-313.98004" x="62.100006 67.617905 73.319405 78.695107 81.398712 86.741112 92.442612 97.122612 100.96471 106.30441 111.88441 115.44211 117.89821 123.37291 129.0816 131.7852 137.2059 139.662 145.242 150.7023 154.55701 157.01311 160.5708 166.2795 174.9825 177.7464 180.9261 183.32281 188.69852 191.09523 196.71393 199.41753 203.49632 209.19333 215.91272 222.15062 227.88632 234.00992 238.93292 245.88902 249.96782 252.73172 258.1524 260.60849 263.00519 268.46548 275.83917 280.5192 283.22278 287.9028 293.3631 296.54279 300.10049 307.35718 312.7608 316.61551 321.95792 324.6597 328.19849 333.6543 336.35788 341.03967 346.39648 348.85529 354.2121 358.95239 362.49207 365.19565 370.65146 376.34125 381.69806 384.46194 389.86285 393.04706 395.81094 399.34973 404.99182 410.34863 413.05222 418.45401 423.1358 426.67459 429.13339 434.29489 439.69849 443.23727 448.59409 454.19388 456.95776 462.31458 468.00436 472.68616 476.52194 481.84274 487.44254 490.98132 493.44012 498.89594 504.53802 507.30191 512.70374 515.16254 520.76233 526.21814 530.05396 532.51276 536.05157 541.74139 550.4444 555.12445">The encryption algorithm field (ENC_ALG) allows software to select one of the activated encryption algorithms </tspan><tspan y="-303.00003" x="62.100006 65.267105 70.729202 74.571304 77.755508 81.300606 86.942703 92.305801 95.429703 101.37061 106.71301 112.04011 115.82821 122.55301 125.85511 128.97902 134.52213 140.16423 145.52733 148.65123 154.82433 158.61243 165.69453 171.84964 174.97354 179.66164 185.06973 190.76584 193.95004 199.35814 204.04623 207.59134 210.05644 215.15854 220.56213 224.10724 229.47034 232.59424 238.05814 241.18204 245.87013 251.23323 254.77834 257.90222 263.36432 266.53143 269.71564 275.12375 277.52045 283.12656 288.58865 292.43076 294.82745 298.37256 304.06866 312.82477 317.51288 320.69708 324.24219 329.70428 332.82819 338.2363 340.70139 343.16647 348.62857 355.98969 359.17389 362.341 367.8031 371.6452 374.82941 380.47153 385.15155 390.51465 393.63855 400.99966 406.69577 412.05887 417.75497 420.93918 426.54529 430.38739 435.84949 441.4556 445.11771 450.52133 459.27744 468.03354 470.49863 476.14075 481.78015 484.96436 490.18616 495.52856 500.85565 505.54376 508.66766 514.36377 519.05188 521.51697 527.21307 532.81915 536.00336 539.54846 545.24457 550.60767">for the KeyID. The BIOS can activate a set of algorithms to allow for use when programming keys using the </tspan><tspan y="-291.95972" x="62.100006 65.874603 72.058502 77.768105 83.477707 89.24041 94.770012 102.34261 108.01621 113.72581 119.86742 126.13502 131.66461 135.43921 141.32251 146.96642 152.49602 158.16962 161.23322 168.85532 174.97891 181.21951 184.34341 188.41501 194.00761 199.45621 204.8058 209.48041 212.60431 218.28691 223.7355 227.26711 230.39101 235.78561 241.37822 247.01762 249.41432 254.72792 257.79153 261.32312 266.77173 269.89563 275.77713 281.17984 286.49344 290.26804 297.23224 300.29584 306.05853 309.12213 316.46973 322.15231 324.60391 329.22 334.91251 337.9761 343.66861 348.35312 353.71262 358.45291 361.51651 365.05801 370.75052 376.11002 379.17361 384.7131 392.29559 397.9791 401.04269 406.6452 412.1037 414.56519 417.02667 421.71118 427.03467 430.09827 437.45578 443.14828 448.50778 454.14987 457.27377 462.81326 470.39575 476.07925 479.14285 484.50235 490.19485 494.87936 498.71786 504.04135 509.64386 513.18536 515.58203 521.04053 526.73303 529.79663 532.25812 536.94263 540.06653 545.70862 551.16888 554.71039">IA32_TME_ACTIVATE MSR (does not apply to KeyID 0 which uses the TME policy when TME encryption is not </tspan><tspan y="-280.97971" x="62.100006 67.699806 73.020607 78.620407 84.022209 88.70401 93.385811 98.788513 104.38831 108.46712 111.73592 114.92011 120.45691 126.14671 131.54941 134.67331 140.2731 144.1089 149.5647 154.24649 159.60329 164.28508 168.96687 174.42267 178.25847 181.44267 186.12447 191.76657 197.16927 201.84926 207.17006 211.85185 215.03606 218.57486 224.03065 227.21486 232.57166 238.26146 242.94325 248.63306 252.46886 257.82565 261.00986 264.54865 270.23843 275.64023 279.17902 282.30292 285.84171 291.53149 296.9342 300.05811 305.4599 307.9187 313.51849 318.9743 322.81009 325.26889 328.80768 334.49747 343.24725 346.37115 351.05295 356.45566 358.85236 364.25507 368.93686 372.47565 377.83246 383.43225 386.61646 392.21625 397.53705 400.66095 405.40125 410.80215 413.96295 417.50174 424.75842 430.16202 433.9978 439.40051 442.52441 444.98322 449.66501 452.84921 458.30502 463.94711 469.34982 472.53403 477.93494 481.11914 484.30334 487.84213 493.53192 498.88873 502.07294 507.47473 509.93353 515.53333 520.98914 524.82495 527.22168 530.7605 536.45032 545.20013 549.88196">bypassed). The processor checks to ensure that the algorithm selected by software is one of the algorithms </tspan><tspan y="-269.99969" x="62.100006 65.64061 71.332207 76.735809 80.276413 83.460609 89.152206 94.555809 99.23941 102.3633 107.9649 113.3235 118.6821 124.3737 127.55789 132.96149 137.64508 141.18568 143.64629 148.74838 154.15198 157.69258 163.05118 168.65277 171.83698 177.43857 182.76117 185.94537 189.48598 195.17758 200.53618 203.72038 209.88898 213.67258 220.75018 226.81349">that has been activated by the BIOS.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-255" x="45.119999">â€¢</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c89C0ADDA"><tspan y="-255" x="62.099998 69.0597 75.178802 81.780304 88.200905 94.017601 98.938805 105.05791 110.81611 118.25551 124.67611 131.03641">KEY_FIELD_1:</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-255" x="134.64 137.52359 143.05589 148.7412 151.1955 155.8728 158.69699 161.85329 164.30759 169.65988 172.11418 177.70949 180.53368 185.21098 190.60828 194.43958 198.27087 200.72517 206.07747 210.75478 213.63837 217.17267 222.85797 228.21027 231.09386 235.77116 241.22246 244.37875 247.91306 255.16975 260.57333 264.40463 269.80734 272.63156 277.30887 282.99417 288.58948 294.18478 296.6391 299.09341 304.44571 310.08511 312.90933 318.50464 323.90195 327.43625 332.83356 335.71716 340.93896 346.28137 351.59769 354.42191 358.02191 363.42279 366.3064 371.9017 377.254 380.1376 385.82291 390.50021 395.85251 401.44781 404.33142 407.48773 412.93903 416.77032 419.65393 423.18823 428.87354 434.22583 437.10944 442.99094 448.39365 453.70996 457.48727 464.45148 467.2757 469.73001 472.88632 475.71054 479.24484 484.93015 490.28244 493.16605 498.76135 501.21567 505.04697 510.39926 515.07654 518.61084 521.49445 526.71625 532.05865 537.37494"> This field carries the software supplied data key to be used for the KeyID if the direct key </tspan><tspan y="-243.9597" x="62.099998 67.707001 71.4888 76.951797 82.5588 86.220901 91.624496 100.3815 109.1385 111.53521 117.23221 122.83921 125.72281 131.18581 136.7928 140.33881 142.80481 148.26781 153.96481 156.78902 159.25502 163.94402 166.76822 172.46523 177.15422 182.51822 188.12521 190.94942 195.03542 201.27242 206.96042 212.49542 216.28442 223.13968 228.86638 235.02509 240.71579 246.2625 251.9892 258.22888 263.91959 269.45728 275.18399 282.1257 285.91739 292.17508 297.86578 304.10367 309.65036 313.73907 317.01776 319.84198 328.74567 334.38779 339.75449 345.39661 348.28021 351.82892 357.52863 362.89532 365.77893 369.44104 374.84467 380.54437 386.15408 391.61978 400.37949 403.07938 408.30115 413.70386 419.02197 421.90558 427.50269 431.33578 436.78888 442.38599 446.0481 451.45169 460.19879 468.94589 471.40198 477.08908 482.68619 485.51041 490.9635 496.56061 500.09671 502.49249 507.94559 513.63269 516.5163 518.91211 523.5921 526.47571 532.16278 536.84186 542.19598 547.79309">programming option is used (KEYID_SET_KEY_DIRECT). When the random key programming option is used </tspan><tspan y="-232.97971" x="62.099091 66.182388 72.416687 78.10199 83.634293 87.420593 94.356895 100.07819 106.23149 111.91679 117.45809 123.17939 129.4137 135.099 140.6313 146.3526 152.6049 158.75821 165.4875 172.4238 179.5041 187.08841 191.17171 194.44501 197.0289 200.5722 206.26651 208.66321 213.3432 215.92709 219.09239 221.55569 226.91699 229.38029 234.98459 237.56848 242.25478 247.66107 251.50137 255.34167 257.73837 263.09967 267.78598 270.3699 273.91321 279.55533 284.91663 287.44025 292.12656 297.58685 300.75217 304.29547 311.55219 316.95581 320.79611 326.0394 328.62332 333.30423 338.99313 344.59204 350.19095 352.58765 355.04373 360.39963 365.99854 368.58246 373.93835 379.62726 383.16516 387.00006 392.45496 398.05386 403.37378 405.9577 409.49561 414.9505 417.53442 423.13333 428.48923 431.07315 439.82205 442.27994 447.50174 452.84415 458.44305 461.02698 463.48486 469.12695 471.71088 475.24878 480.93768 486.29358 488.8775 495.1514 500.57031 507.15021 509.67383 515.27271 520.6286 526.3175 531.6734 535.33551 540.73907 544.27698 549.63287 555.23175">(KEYID_SET_KEY_RANDOM), this field carries the software supplied entropy to be mixed in the CPU generated </tspan><tspan y="-221.99971" x="62.099091 65.761192 71.164795 76.852798 82.450798 87.9048 96.652802 99.5364 105.1344 110.5344 114.0714 119.47141 122.355 127.57681 132.9192 137.42101 140.6628 143.54639 147.32639 150.86339 153.68758 156.14458 160.82458 163.70818 168.38818 173.84218 177.00117 180.53818 187.79488 193.19847 197.03247 202.43517 204.84717 209.52716 212.35135 216.18535 221.58804 226.26804 231.86604 237.32004 243.00804 247.68805 250.14505 255.74306 258.20004 260.59674 263.05286 266.53226 271.87375 274.75735 278.29434 283.69525 286.49878 291.85199 297.53818 302.21637 307.90256 311.73477 317.08798 319.97156 323.50674 329.19293 334.59113 338.12631 341.00989 344.54507 350.23126 355.58447 358.40866 363.72586 369.07907 374.39627 377.22046 381.89865 387.58484 393.18103 398.82043 401.21713 403.67322 409.02643 414.66583 417.49002 420.64722 426.09943 429.93164 432.75583 436.29102 441.9772 447.33041 450.21399 455.81018 458.26538 462.0976 467.45081 472.129 475.66418 478.54776 484.14395 487.97617 493.42838 499.02457 502.68668 508.09027 516.83649 525.5827 528.0379 533.72412 539.32031">random data key. It is software's responsibility to ensure that the key supplied for the direct programming </tspan><tspan y="-210.95941" x="62.099075 67.562973 73.170876 76.717773 79.184677 84.648575 90.346474 93.110374 98.574272 102.41817 105.18208 108.72897 114.42687 119.79177 122.55567 127.92057 133.56267 137.10957 140.95348 146.41737 152.02527 157.35417 160.11807 164.80797 170.50587 176.11377 181.72166 184.11836 186.57446 191.93936 197.54726 200.31116 203.48006 208.88095 212.72485 215.54906 219.09596 224.73807 230.10297 232.86687 236.52898 241.93257 247.63048 253.23837 258.70227 267.46017 270.22409 275.832 279.6759 285.1398 290.74771 294.40982 299.81345 308.57135 317.27435 319.74124 325.3194 330.91919 333.68307 339.13889 344.77829 348.31708 350.71378 356.16959 361.85938 364.62326 370.26266 375.66357 381.06628 385.74628 388.51016 394.19995 399.65576 403.19455 405.95844 409.79422 415.15103 419.83282 425.52261 427.98141 431.5202 434.28409 436.68079 442.38226 445.14615 452.50095 457.85776 463.25955 468.58035 471.34424 476.56604 481.90845 487.22925 491.91104 495.21313 497.97702 503.51382 509.20361 514.56042 518.39624 523.75305 526.57727 531.97906 535.81488 541.17169 543.93561 549.62543 555.08124">option or the entropy supplied for the random programming option does not result in weak keys. There are no </tspan><tspan y="-199.97942" x="62.099091 67.450493 72.765892 78.360291 80.81369 83.26709 87.943489 90.396889 93.93029 96.273888 100.95029 106.63469 112.03739 116.71739 122.03279 126.70919 129.1131 131.5665 137.2509 139.6548 143.1882 148.8726 154.224 156.6279 159.0813 164.7657 169.44211 172.97551 176.80591 182.49031 187.16672 190.70012 193.15352 198.60391 204.28831 206.63191 210.16531 215.61571 218.01961 223.61401 229.01671 232.55011 237.9015 242.57791 246.11131 248.51521 253.91611 257.75821 260.16211 265.7565 269.58691 274.98962 280.21143 285.56284 291.23907 294.76709 297.17099 304.51498 309.91769 315.30869 320.61868 323.02258 328.24438 333.58679 338.89679 343.56778 346.86987 349.21347 358.09647 363.77545 369.12146 374.80045 377.20435 383.34235 389.01236 395.15036 397.55426 403.70126 409.15976 415.29776 419.36575 425.12845 430.83444 436.54044 438.94434 441.39233 446.06332 448.40692 454.08591 458.7569 464.10291 469.74231 473.00031 475.40421 478.93222 484.61121 489.95721 492.36111 498.0401 503.6795 509.26849 514.6145 518.43951 520.84344 526.54944 532.31213 538.46814 540.87207 546.26306 550.08807 555.43408">explicit checks in the instruction to detect or prevent weak keys. When AES XTS-128 is used, the upper 48B are </tspan><tspan y="-188.99942" x="62.099091 65.629791 69.457489 74.80619 80.19989 83.730591 89.133293 94.724991 97.608597 103.0023 107.67599 110.5002 114.3279 119.6766 124.3503 129.75299 133.58069 138.80249 144.15118 149.79059 152.61478 158.00848 163.69019 169.28189 172.16548 180.90718 186.58888 191.26259 194.79329 197.67688 203.26859 208.61728 211.50087 216.21057 221.55927 225.38696 230.83466 236.18335 241.77505 244.65865 250.10635 255.78806 259.38806 262.1394 267.73651 273.05463 275.87885 280.55795 286.01105 289.16916 292.70526 299.96198 305.36557 309.19867 314.55276 317.43637 323.03348 328.38757 331.54568 336.99878 340.83188 346.18597 349.06958 354.42368 359.64545 364.99954 369.67865 375.36575 378.90186 381.35794 387.04504 392.68445 395.50867 399.04477 404.73187 410.08597 412.96957 415.42566 421.11276 425.79187 429.32797 433.16107 438.84818 443.52728 447.06339 449.51947 454.97256 460.65967">treated as reserved and must be zeroed out by software before executing the instruction.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-174" x="45.119999">â€¢</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" font-weight="bold" class="cC246365F c9256B18F c89C0ADDA"><tspan y="-174" x="62.099998 69.0597 75.178802 81.780304 88.200905 94.017601 98.938805 105.05791 110.81611 118.25551 124.67611 131.03641">KEY_FIELD_2:</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-174" x="134.64 137.52361 143.05771 148.74481 151.20091 155.88 158.70421 161.8623 164.31841 169.6725 172.1286 177.72571 180.54991 185.229 190.6281 194.4612 198.2943 200.7504 206.10449 210.7836 213.66721 217.20331 222.89041 228.24451 231.12811 235.80722 241.26031 244.41841 247.95451 255.21121 260.61481 264.44791 269.85062 272.67484 277.35394 283.04105 288.63815 294.23526 296.69135 299.14743 304.50153 310.14093 312.96515 316.50125 323.85336 329.20746 334.60657 339.92468 342.7489 347.9707 353.37341 358.69153 361.57513 365.11124 370.56433 373.38855 378.98566 384.38837 387.21259 392.89969 397.5788 402.93289 408.5723 411.39651 414.55463 420.00772 423.84082 426.66504 430.20114 435.88824 441.24234 444.12595 450.00745 455.41016 460.72827 464.50739 471.47159 474.29581 476.75189 479.91 482.73422 486.27032 491.95743 497.31152 500.19513 505.79224 508.24832 512.08142 517.43555 522.11462 525.6507 528.53424 533.75604 539.09845 544.41656"> This field carries the software supplied tweak key to be used for the KeyID if the direct key </tspan><tspan y="-162.9597" x="62.099998 67.707001 71.4888 76.951797 82.5588 86.220901 91.624496 100.3815 109.1385 111.53521 117.23221 122.83921 125.72281 131.18581 136.7928 140.33881 142.80481 148.26781 153.96481 156.78902 159.25502 163.94402 166.76822 172.46523 177.15422 182.51822 188.12521 190.94942 195.03542 201.27242 206.96042 212.49542 216.28442 223.13968 228.86638 235.02509 240.71579 246.2625 251.9892 258.22888 263.91959 269.45728 275.18399 282.1257 285.91739 292.17508 297.86578 304.10367 309.65036 313.73907 317.01776 319.84198 328.74567 334.38779 339.75449 345.39661 348.28021 351.82892 357.52863 362.89532 365.77893 369.44104 374.84467 380.54437 386.15408 391.61978 400.37949 403.07938 408.30115 413.70386 419.02197 421.90558 427.50269 431.33578 436.78888 442.38599 446.0481 451.45169 460.19879 468.94589 471.40198 477.08908 482.68619 485.51041 490.9635 496.56061 500.09671 502.49249 507.94559 513.63269 516.5163 518.91211 523.5921 526.47571 532.16278 536.84186 542.19598 547.79309">programming option is used (KEYID_SET_KEY_DIRECT). When the random key programming option is used </tspan><tspan y="-151.97971" x="62.099091 66.182388 72.416687 78.10199 83.634293 87.420593 94.356895 100.07819 106.23149 111.91679 117.45809 123.17939 129.4137 135.099 140.6313 146.3526 152.6049 158.75821 165.4875 172.4238 179.5041 187.08841 191.17171 194.44501 197.0289 200.5722 206.26651 208.66321 213.3432 215.92709 219.09239 221.55569 226.91699 229.38029 234.98459 237.56848 242.25478 247.66107 251.50137 255.34167 257.73837 263.09967 267.78598 270.3699 273.91321 279.55533 284.91663 287.44025 292.12656 297.58685 300.75217 304.29547 311.55219 316.95581 320.79611 326.0394 328.62332 333.30423 338.99313 344.59204 350.19095 352.58765 355.04373 360.39963 365.99854 368.58246 373.93835 379.62726 383.16516 387.00006 392.45496 398.05386 403.37378 405.9577 409.49561 414.9505 417.53442 423.13333 428.48923 431.07315 439.82205 442.27994 447.50174 452.84415 458.44305 461.02698 463.48486 469.12695 471.71088 475.24878 480.93768 486.29358 488.8775 495.1514 500.57031 507.15021 509.67383 515.27271 520.6286 526.3175 531.6734 535.33551 540.73907 544.27698 549.63287 555.23175">(KEYID_SET_KEY_RANDOM), this field carries the software supplied entropy to be mixed in the CPU generated </tspan><tspan y="-140.99971" x="62.099091 65.761192 71.164795 76.847397 82.439995 87.888596 96.631195 99.514801 103.0464 110.394 115.79671 121.20031 126.51391 129.39751 134.61931 139.9617 144.4635 147.70529 150.58888 154.36348 157.89508 160.71927 163.17087 167.84547 170.72906 175.40367 180.85226 184.00586 187.53746 194.79416 200.25806 204.03986 209.44255 211.84915 216.52376 219.40735 223.23595 228.58554 233.26015 238.85275 244.30135 249.98395 254.65855 257.11017 262.70276 265.15436 267.60596 270.00266 273.53424 278.84784 281.73145 285.26303 290.71164 293.5188 298.8765 304.5672 309.24991 314.94061 318.77731 324.13501 327.01862 330.55832 336.24902 341.65173 345.19144 348.01566 351.55536 357.24606 362.60376 365.48737 370.70914 376.05154 381.37323 384.19745 388.88016 394.57086 400.17157 405.77228 408.16898 410.62506 415.98276 421.58347 424.40768 427.5694 433.02609 436.86279 439.68701 443.22672 448.91742 454.27512 457.15872 462.75943 465.21912 469.05582 474.41351 479.09622 482.63593 485.51953 491.12024 494.95694 500.41364 506.01434 509.73676 515.14038 523.84332 532.60657 535.06628 540.75696 546.35767">random tweak key. It is software's responsibility to ensure that the key supplied for the direct programming </tspan><tspan y="-129.95941" x="62.099091 67.562988 73.170891 76.717789 79.184692 84.64859 90.346489 93.11039 98.574287 102.41819 105.18209 108.72899 114.42689 119.79179 122.55569 127.92059 133.56268 137.10959 140.95349 146.41739 152.02528 157.35419 160.11809 164.80798 170.50589 176.11378 181.72168 184.11838 186.57448 191.93938 197.54727 200.31117 203.48007 208.88097 212.72487 215.54907 219.09598 224.73808 230.10298 232.86688 236.52899 241.93259 247.63049 253.23839 258.7023 267.46021 270.22412 275.83203 279.67593 285.13983 290.74774 294.40985 299.81348 308.57138 317.27438 319.74127 325.3194 330.91919 333.68307 339.13889 344.77829 348.31708 350.71378 356.16959 361.85938 364.62326 370.26266 375.66357 381.06628 385.74628 388.51016 394.19995 399.65576 403.19455 405.95844 409.79422 415.15103 419.83282 425.52261 427.98141 431.5202 434.28409 436.68079 442.38226 445.14615 452.50095 457.85776 463.25955 468.58035 471.34424 476.56604 481.90845 487.22925 491.91104 495.21313 497.97702 503.51382 509.20361 514.56042 518.39624 523.75305 526.57727 531.97906 535.81488 541.17169 543.93561 549.62543 555.08124">option or the entropy supplied for the random programming option does not result in weak keys. There are no </tspan><tspan y="-118.97941" x="62.099091 67.450493 72.765892 78.360291 80.81369 83.26709 87.943489 90.396889 93.93029 96.273888 100.95029 106.63469 112.03739 116.71739 122.03279 126.70919 129.1131 131.5665 137.2509 139.6548 143.1882 148.8726 154.224 156.6279 159.0813 164.7657 169.44211 172.97551 176.80591 182.49031 187.16672 190.70012 193.15352 198.60391 204.28831 206.63191 210.16531 215.61571 218.01961 223.61401 229.01671 232.55011 237.9015 242.57791 246.11131 248.51521 253.91611 257.75821 260.16211 265.7565 269.58691 274.98962 280.21143 285.56284 291.23907 294.76709 297.17099 304.51498 309.91769 315.30869 320.61868 323.02258 328.24438 333.58679 338.89679 343.56778 346.86987 349.21347 358.09647 363.77545 369.12146 374.80045 377.20435 383.34235 389.01236 395.15036 397.55426 403.70126 409.15976 415.29776 419.36575 425.12845 430.83444 436.54044 438.94434 441.39233 446.06332 448.40692 454.08591 458.7569 464.10291 469.74231 473.00031 475.40421 478.93222 484.61121 489.95721 492.36111 498.0401 503.6795 509.26849 514.6145 518.43951 520.84344 526.54944 532.31213 538.46814 540.87207 546.26306 550.08807 555.43408">explicit checks in the instruction to detect or prevent weak keys. When AES XTS-128 is used, the upper 48B are </tspan><tspan y="-107.9994" x="62.099091 65.629791 69.457489 74.80619 80.19989 83.730591 89.133293 94.724991 97.608597 103.0023 107.67599 110.5002 114.3279 119.6766 124.3503 129.75299 133.58069 138.80249 144.15118 149.79059 152.61478 158.00848 163.69019 169.28189 172.16548 180.90718 186.58888 191.26259 194.79329 197.67688 203.26859 208.61728 211.50087 216.21057 221.55927 225.38696 230.83466 236.18335 241.77505 244.65865 250.10635 255.78806 259.38806 262.1394 267.73651 273.05463 275.87885 280.55795 286.01105 289.16916 292.70526 299.96198 305.36557 309.19867 314.55276 317.43637 323.03348 328.38757 331.54568 336.99878 340.83188 346.18597 349.06958 354.42368 359.64545 364.99954 369.67865 375.36575 378.90186 381.35794 387.04504 392.68445 395.50867 399.04477 404.73187 410.08597 412.96957 415.42566 421.11276 425.79187 429.32797 433.16107 438.84818 443.52728 447.06339 449.51947 454.97256 460.65967">treated as reserved and must be zeroed out by software before executing the instruction.</tspan><tspan y="-91.979401" x="62.099106 68.256004 70.65271 73.119614 76.30381 82.244713 87.587112 92.916016 96.705917 103.64582 108.33572 111.51992 117.12782 122.49272 125.66162 131.07152 136.76942 139.23633 142.78323 145.96744 149.51434 154.91524 158.09944 163.64435 171.23225 176.86896 180.05316 185.66106 191.02596 196.72386 202.00775 207.33665 209.80356 215.26746 219.11136 222.23526 226.32216 231.68706 237.38496 242.07486 245.91876 251.20087 256.80878 260.35568 263.47958 270.8425 273.30939 276.85629 282.49841 285.59882 291.14102 298.72623 304.36292 307.54712 312.76892 318.17163 323.49783 326.68204 332.14325 335.98444 339.16864 344.77383 350.10004 355.70523 361.11243 365.79962 370.48682 373.61072 378.97293 384.66812 389.35532 393.1965 398.52271 404.1279 407.67209 410.06879 415.53 421.22519 425.30939 428.49359 433.9548 439.64999 442.7739 450.3591 456.54031 462.08252 469.66772 475.35391 478.47781 483.88501 488.5722 492.11639 494.5806 499.7421 505.14569 508.68988 511.15408 516.6153 522.25739 525.53156">All KeyIDs default to TME behavior (encrypt with TME key or bypass encryption) on MKTME activation. </tspan><tspan y="-80.999397" x="62.099121 68.254219 73.716316 76.883415 80.428513 87.685211 93.088806 96.930908 102.29401 105.4179 110.106 115.5141 121.2102 124.39439 129.80249 133.3476 136.5318 141.9399 147.5217 152.8488 156.033 161.6391 167.1012 169.5663 175.2084 178.75351 181.93771 187.54381 192.90691 197.595 199.9917 205.59779 210.96089 214.1451 217.6902 223.1523 226.2762 231.01649 236.6586 242.0667 247.7628 253.3689 258.73199 261.9162 265.4613 271.10342 276.46652 279.59042 284.91751 290.28061 295.6077 298.61914 301.78085 307.23755 311.07425 314.25845 319.66116 322.78506 328.72598 334.06839 339.39008 343.17279 350.1055 353.2294 358.9201 363.60281 366.0625 371.7532 377.35391 380.53812 384.07782 389.76852 395.12622 398.31042 403.73114 410.00684 417.02594 423.74536 428.96805 432.74896 439.71765 442.84155 445.30124 450.99194 455.67465 459.21436 463.05106 468.74176 473.42447 476.96417 479.42386 484.88055 490.57126 493.84097 497.02518 503.30087 508.99158 514.39429 520.08496 525.68567 531.08838 534.21228 539.66901 542.83069">Software can at any point decide to change the key for a KeyID using the PCONFIG instruction. Change of </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-704.34003" x="183.17999 188.33728 193.67484 199.25443 201.7753 207.38776 209.90764 216.0679 219.12662 225.24405 230.34158 232.77681 235.29669 237.75682 245.46088 251.70181 257.39893 265.0791 270.65173 275.97534 281.85571 287.37457 293.47507 298.75784 304.86832 311.04651 317.69482 323.81226 330.19165 336.62082 344.32489 349.60767 355.19025 360.88837 367.26776 373.92902 379.43192 385.12903 387.64893 392.80722 398.38681 402.04712 410.34879 415.69232">Table 4-17.  MKTME_KEY_PROGRAM_STRUCT Format</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-688.97998" x="49.98 54.977699 57.221397 62.255096 64.475403 150.75571 156.7551 160.25879 163.67789 167.96458 172.88399 176.46869 178.68898 181.57169 186.49199 191.47169 195.0564 200.0361 204.35609 219.3582 224.33701 226.5807 230.6604 235.69411 237.9144 240.7971 245.71741 250.69711 254.28181 259.31552 263.60223 287.84372 292.82523 297.85892 305.32263 312.78635 317.82004 322.85825 326.39883">FieldOffset (bytes)Size (bytes)Comments</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-673.02026" x="49.98 54.960602 59.701801 64.803001 66.903603 150.7818 219.3618 287.88239 292.80267 297.42328 302.04297 304.26236 306.36295 311.04205 315.72296 320.40475 323.76447 325.68597 329.04477 330.96628 335.7066 338.7684">KEYID02Key Identifier.</tspan><tspan y="-657.00024" x="49.98 54.944401 59.6856 64.786804 66.887398 72.405296 76.966492 81.707695 86.866501 92.266502 150.76561 219.34561 287.86621 292.7865 297.4071 302.02679 304.12738 309.7056 311.92499 315.5394 320.28061 324.90302 328.26273 331.38483 336.06573 337.98724">KEYID_CTRL24KeyID control:</tspan><tspan y="-646.02026" x="287.8797 298.38181 303.7233 305.6655 309.08548 313.04727 315.26666 318.01886 323.27307 325.01727 330.27148 333.02368 334.76788 336.98727 341.48819 347.2464 353.81461 360.38281 365.979 371.81821 377.39639">â€¢Bits [7:0]: COMMAND.</tspan><tspan y="-636.00055" x="287.8797 298.38181 303.7233 305.64029 309.06027 313.03827 315.25769 317.98468 323.26498 328.54529 330.28677 335.51578 338.24277 340.04456 342.26398 346.95297 352.83356 357.52255 362.08377 367.54318 371.74258 377.02289">â€¢Bits [23:8]: ENC_ALG.</tspan><tspan y="-625.98083" x="287.8797 298.38181 303.7233 305.634 309.05402 313.02573 315.24512 318.00363 323.28391 328.56418 330.30569 335.52838 340.80865 343.56717 345.30869 347.52808 352.8075 357.54779 361.5195 366.2598 369.4845 373.98361 378.72391 383.3436 385.20209 387.42148 394.32718 399.12958 403.0311 406.39081 408.6102 413.28928 417.97018 420.18958 424.21078 428.95108 432.01288 436.75409">â€¢Bits [31:24]: Reserved, must be zero.</tspan><tspan y="-610.02112" x="49.979996 55.379993 60.121193 64.915497 69.596397 74.816399 80.277596 85.017899 150.77551 219.35551 224.57552 287.87613 293.15552 297.88681 301.8486 306.5799 309.82169 314.3208 319.0611 323.68082 325.53931 327.75873 334.65903 339.46143 343.36292 346.7226 348.94202 353.61932 358.3002 360.51962 364.54083 369.28113 372.34293 377.08411">RESERVED658Reserved, must be zero.</tspan><tspan y="-594.0011" x="49.979996 54.960598 59.701801 64.832703 69.387604 74.113503 76.154701 80.8806 85.345497 90.881393 95.382294 150.76289 156.0432 219.3438 224.5638 287.86438 292.66678 297.22797 300.58676 303.96265 310.91156 315.38547 318.4473 323.16418 325.38361 329.3985 334.17841 338.84131 343.50421 345.43112 347.38501 352.1019 356.7648 358.98422 363.90451 368.46481 373.14572 375.24362 380.77951 382.99893 387.66183 391.92154 395.29742 399.77133 401.99075 406.01016 410.57047 415.25137 417.47079 422.19669 425.4646 427.68402 432.40091 437.0827 440.45862 443.52045 448.24634 452.74545 457.42636 459.64578 462.82458 467.50546 470.77338 472.9928 477.91309 482.47339 487.1543 489.2522 494.78809 497.00751 501.67041 505.93011 509.30603 513.77991 515.99927 520.01868 524.57898 529.25989">KEY_FIELD_16464Software supplied KeyID data key or entropy for KeyID data key.</tspan><tspan y="-577.98108" x="49.979996 54.960598 59.701797 64.8246 69.371399 74.089203 76.130402 80.848206 85.305008 90.832809 95.33371 150.71431 155.99461 161.25241 219.33301 224.59081 287.89142 292.66321 297.22443 300.55621 303.92401 310.86481 315.3306 318.3924 323.13269 325.35208 329.35889 334.13068 338.78546 343.44025 345.35904 347.30484 352.01364 356.66843 358.88782 363.80814 368.36844 373.04123 375.13104 380.65884 382.87823 386.24603 393.08603 397.79483 402.26062 406.53741 408.75681 412.83649 417.39679 422.06958 424.28897 429.00677 432.26657 434.48596 439.19476 443.81714 447.18494 450.30704 455.02484 459.58423 464.25702 466.47641 469.59579 474.33701 477.5968 479.81619 484.73651 489.35712 493.97681 496.07742 501.60522 503.82462 507.19241 514.03241 518.74121 523.20703 527.48383 529.70325 533.72266 538.28296 542.95575">KEY_FIELD_212864Software supplied KeyID tweak key or entropy for KeyID tweak key.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-462.29999" x="183.48 188.63728 193.9151 199.55545 202.07632 207.66089 210.18077 216.31314 219.39775 225.53012 231.70731 234.11464 236.57477 239.09465 244.64934 250.37335 255.97784 261.61819 267.20276 270.83517 274.81619 280.40076 286.04111 288.59982 294.42044 299.87952 305.40833 307.92819 314.01474 317.43698 323.02554 328.63403 332.05627 337.39383 345.6716 353.94937 356.45032 362.17831 367.7868 370.30667 375.78568 381.37424 389.65201 397.92978 403.24942 408.97742 414.58591">Table 4-18.  Supported Key Programming Commands</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-447" x="49.439999 54.421501 59.460602 66.927002 74.393402 79.186806 84.349205 176.0889 181.08929 186.25169 190.2108 195.24989 200.30429 202.55069 207.71309 232.67279 238.50119 243.5376 247.827 251.9274 255.1998 257.4462 262.30621 265.9071 268.1535 273.13321">CommandEncodingDescription</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-430.98001" x="49.439999 54.419701 59.1609 64.268402 66.369003 71.8815 76.442703 81.245102 85.926003 91.144203 95.705406 100.6851 105.366 110.5275 115.0284 120.5409 122.6415 128.10091 132.7818 137.52299 176.0412 232.62149 237.42389 241.98509 245.28448 248.70448 255.60478 260.10388 263.16568 267.90601 270.1254 274.8819 278.90399 283.5975 287.6196 289.83899 293.1915 297.9939 299.92441 303.9465 306.16589 313.1265 317.86771 322.5072 327.24753 329.46692 332.70694 337.44815 339.66754 344.30704 346.28885 349.35065 354.09097 357.97449 361.327 363.2305 367.888 370.10739 374.74689 377.86899 382.5715 387.25061 390.31241 394.75211 401.71271 403.9321 408.43121 410.6506 414.67001 419.23032 423.88782 426.10721 429.28601 433.96692 437.26901 439.4884 444.2449 448.267 452.96051 455.1799 462.1405 464.12231 467.47482 472.23132 474.45071 479.371 483.9313 488.58881 490.68939 496.2019">KEYID_SET_KEY_DIRECT0Software uses this mode to directly program a key for use with KeyID.</tspan><tspan y="-414.96002" x="49.439999 54.419697 59.160896 64.2603 66.360901 71.865303 76.426506 81.228905 85.909805 91.127998 95.689201 100.66891 105.34981 110.51131 115.01221 120.47162 126.05162 131.87102 137.37541 143.13362 176.01422 232.59453 237.33572 242.42612 248.12761 250.347 254.97839 259.71869 264.4671 269.2074 272.2692 276.5289 279.87329 284.61359 288.63568 290.8551 295.29752 300.09991 304.73132 306.95074 311.44986 315.47195 319.45535 321.43713 326.06854 330.87094 334.89304 337.11246 341.55487 346.35727 348.57669 353.26208 357.89972 362.67331 367.38391 374.32651 379.03711 382.09891 386.59799 388.51859 390.73798 394.75739 399.31769 403.99228 406.21167 409.39047 414.07138 417.37347 419.59286 424.36646 428.37506 433.08566 435.30505 442.24765 444.19525 447.56485 452.33844 454.55783 459.02542 461.24481 466.16513 470.72543 475.40002 477.49164 483.02124 484.72583 486.94522 491.66483 496.13242 500.09152 504.83362 507.05301 510.42261 512.37018 519.31281 524.02338 526.24274 529.61237 534.38599 539.09656">KEYID_SET_KEY_RANDOM1CPU generates and assigns an ephemeral key for use with a KeyID. Each time the </tspan><tspan y="-403.98001" x="232.61972 234.58713 239.32922 243.23071 246.59042 249.87183 254.61392 258.53433 261.92374 263.84525 268.58646 273.32855 275.54794 277.51535 281.54376 283.76315 288.26407 292.76227 297.44318 301.3429 306.13629 309.5257 314.2561 318.87579 320.71719 322.93658 326.32599 331.06808 335.79849 338.01788 342.75729 347.8927 353.53391 355.7533 360.42969 365.1601 369.90219 374.64249 377.70428 381.96399 385.35339 390.0838 394.11221 396.3316 400.7713 402.99069 407.78409 412.40469 419.3671 421.58649 425.6059 430.1662 434.8606 437.07999 441.87338 445.90179 447.8233 452.6257 457.24539 459.46478 463.95218 466.17157 470.91367 475.41275 478.41425 483.09332 490.05573 494.49542 497.55722 502.29752 504.51691 507.5787 512.01837 516.81177 521.48816 526.16907 533.1297">instruction is executed, the CPU generates a new key using a hardware random </tspan><tspan y="-393" x="232.61972 237.40771 242.14981 249.10681 253.72652 258.45151 261.72751 263.9469 268.61789 273.2988 278.08679 282.7677 285.8295 290.14859 293.38858 298.12979 301.40579 303.62518 308.10718 312.84927 317.52026 319.73965 323.12366 327.91165 332.59256 334.81195 338.83136 343.39166 348.08066 352.10367 354.32306 358.76276 361.88486 366.56577 368.78516 373.45615 375.37766 379.40067 383.31567 387.79767 390.79916 395.47015 400.19516 404.81485 407.03424 411.76825 416.51035 418.72974 421.85184 426.53275 430.55576 435.05667 438.44067">number generator and the keys are discarded on reset.</tspan><tspan y="-376.98001" x="49.440018 54.419716 59.160915 64.271118 66.34832 71.863518 76.39772 81.138924 85.458023 90.163223 95.802628 101.20983 105.74403 110.72373 115.46494 176.00613 232.58643 237.32762 239.24913 243.94533 248.44443 251.69162 253.61133 256.96652 261.76892 266.46512 268.3848 270.957 274.9512 279.51239 282.87122 286.22641 293.18701 297.6402 300.7623 305.4585 307.37817 312.05728 315.11908 319.86029 324.48001 327.54181 332.04089 338.96909 345.92969 350.62589 355.30499 357.8772 359.79688 363.81625 368.37656 373.03674 374.95642 379.45551 383.4173 387.4115 392.15271 396.03891 397.97211 402.2912 405.65088 410.39117 415.01089 416.93057 423.89117 425.81268 429.16788 433.97028 435.88995 439.24515 444.04755 448.74374 450.66342 455.58374 460.14404 464.80423 466.88144 472.39664 474.08682 476.0065 481.76471 486.50681 488.42648 492.92737 497.48495 502.18115 506.06735 510.86975 514.22949 516.16272 520.90393 525.70636 527.62604 532.18726 535.48669 537.40637 540.7616 545.56403 547.49725 551.49146">KEYID_CLEAR_KEY2Clear the (software programmed) key associated with the KeyID. On execution of this </tspan><tspan y="-366" x="232.61972 236.27911 240.96001 247.92061 254.88121 259.32092 264.11252 268.73221 270.57181 272.7912 276.1788 280.9209 285.64951 287.8689 292.78922 297.34952 302.04211 304.1517 309.69931 311.9187 316.59329 321.03391 324.42151 328.38333 330.60272 335.79932 342.33963 347.07724 349.29663 353.91632 358.65662 363.44821 367.64761 372.3042 374.22571 378.96332 382.24292 384.46231 387.06693 391.79553 396.53763 400.43735 403.71695 408.40955 412.84924 416.20895 418.42834 425.32864 427.31046 430.69806 435.48965 437.70905 442.32874 444.25024 448.56934 451.92905 455.10785 459.78876 463.06836 469.96866 472.18805 477.38464 483.92496 488.66257 490.88196 494.90137 499.46167 504.15427 506.37366 511.11127 514.39087 516.61029 521.28491 525.97754 530.59729 535.09637 539.05817 543.08026">command, the KeyID gets TME behavior (encrypt with platform TME key or bypass </tspan><tspan y="-354.95969" x="232.61972 237.78842 244.38902 249.09872 251.31813 256.05844 260.86084 264.75153 268.00323 272.66794 277.10764 280.46735 282.40506 287.11475 291.91714 294.49384">TME encryption).</tspan><tspan y="-339" x="49.440018 54.419716 59.160915 64.273819 66.353722 71.87162 76.408524 82.289124 87.987022 92.523926 97.265129 103.09803 107.83923 112.93863 118.03983 123.14372 176.00253 232.58282 238.10072 242.84192 245.06133 249.82323 254.32413 257.74414 259.96353 264.66245 269.46484 273.35373 276.60364 281.26654 285.70624 289.06415 291.28354 298.24414 302.92505 309.88565 314.62683 317.87674 322.53964 324.75903 331.68994 336.49234 341.19125 345.99365 348.21304 351.57095 356.37335 358.30927 362.30615 364.52554 369.44583 374.00613 378.66904 380.74893 386.26685 388.48624 390.46805 394.42984 396.64923 398.63104 403.37314 405.59253 410.39493 414.41702 419.11594">KEYID_NO_ENCRYPT3Do not encrypt memory when this KeyID is in use.</tspan></text><path transform="matrix(1,0,0,-1,0,792)" d="m 45.72,573.24 h 0.47998 V 699.72 H 45.72 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 146.52,572.76 h 0.48002 v 127.5 H 146.52 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 215.1,572.76 h 0.48002 v 127.5 H 215.1 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 283.68,572.76 h 0.48 v 127.5 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 556.68,573.24 h 0.48006 V 699.72 H 556.68 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.72,699.78 h 511.44006 v 0.4801 H 45.72 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.72,683.76 h 511.44006 v 0.48 H 45.72 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.72,667.74 h 511.44006 v 0.48 H 45.72 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.72,620.76 h 511.44006 v 0.48 H 45.72 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.72,604.74 h 511.44006 v 0.48 H 45.72 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.72,588.78 h 511.44006 v 0.48 H 45.72 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.72,572.76 h 511.44006 v 0.48 H 45.72 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.24,334.26 h 0.480014 V 457.74003 H 45.24 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 171.78,333.72 h 0.48 v 124.5 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 228.36,333.72 h 0.48 v 124.5 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 557.22,334.26 h 0.47998 V 457.74003 H 557.22 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.24,457.74 H 557.7 v 0.48 H 45.24 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.24,441.72 H 557.7 v 0.48 H 45.24 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.24,425.76 H 557.7 v 0.48 H 45.24 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.24,387.72 H 557.7 v 0.48 H 45.24 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.24,349.74 H 557.7 v 0.48 H 45.24 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.24,333.72 H 557.7 v 0.48 H 45.24 Z" inkscape:connector-curvature="0" /></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="512.64001pt" height="651.1618pt" viewBox="0 0 512.64001 651.1618" sodipodi:docname="991.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.12" inkscape:cy="432.4" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg204" /><g transform="translate(-45.66,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-715.97998" x="63 68.221802 73.624504 78.944405 83.625305 86.809502 89.969398 95.424301 99.259201 102.38309 107.784 110.96819 116.90909 122.2515 127.5714 131.35229 138.2832 141.46741 147.06631 152.52121 157.9239 162.6039 165.7278 172.45171 179.3511 184.88701 188.07121 192.75211 198.44101 203.8419 209.48401 215.08292 220.43881 223.62302 227.16092 232.84982 238.20572 241.38992 246.07083 249.60873 255.00963 258.54752 263.90341 267.08762 272.54251 275.70242 278.88663 282.42453 288.11343 293.46933 296.65353 302.18942 307.19434 313.36023 316.54443 321.22534 326.62625 331.30716 336.99606 342.35196 347.03287 350.21707 355.67197 359.50687 362.69107 371.43997 376.79587 385.54477 390.99966 394.78146 400.12299 403.30719 408.9061 411.36398 416.96289 422.3656 424.7623 427.21838 432.90729 438.26318 441.5311 444.655 448.43591 451.97382 455.15802 457.61591 462.29681 465.48102 470.16193 475.61682 478.77673 482.31464 489.57135 495.03525 498.81705 504.21976 506.63266 511.31357 514.49774 518.33264 523.68854 528.36945 533.96832 539.42322 545.11212 549.79303 552.25092">keys for a KeyID does NOT change the state of the TLB caches or memory pipeline. It is software's responsi-</tspan><tspan y="-705" x="63 68.601601 71.062202 73.522804 75.983406 79.462807 84.785408 87.909302 91.449905 96.907509 100.09171 103.63231 109.03591 114.25771 119.66041 122.7843 128.1879 133.78949 139.39108 143.22868 148.68628 154.28787 158.12547 160.58607 165.98967 169.53027 174.88887 178.07307 183.47667 188.16026 191.70087 194.16147 199.61906 205.31067 209.99426 213.11816 216.65877 222.11636 225.30057 230.65916 236.35077 241.03436 246.72597 250.56357 255.92216 259.10638 263.78998 269.24759 273.08517 276.92276 282.28137 286.96497 290.50555 293.68976 299.29135 304.64996 310.34155 315.68484 321.00745 323.46805 328.86896 331.45105">bility to take appropriate actions to ensure correct behavior.</tspan><tspan y="-688.97998" x="63 67.498207 72.90181 78.481812 80.937912 86.280312 89.464508 95.166908 99.245712 104.98592 110.68832 113.87251 118.55251 124.19462 129.67381 137.05202 141.73201 144.91621 148.47841 154.1205 159.5007 162.6246 166.48381 171.86401 175.42621 181.1394 184.99861 190.6407 193.82491 198.9864 204.39 206.8461 212.48819 217.86839 222.54839 225.67229 231.09749 235.77748 240.48268 245.88359 250.56358 253.01968 258.44489 262.00708 267.38727 272.96725 276.15146 283.46848 285.92459 289.48679 295.19998 298.32388 301.88608 307.59927 312.97946 316.10336 323.70657 329.88779 335.448 343.0098 348.71399 354.41638 360.66959 366.30627 371.82419 377.58688 382.98688 389.22388 396.32309 403.27921 409.5162 415.7001 423.2619 426.44611 428.8428 434.24548 439.67068 442.85489 445.97879 451.45798 454.64218 457.82639 463.22638 469.52457 476.54367 483.26306 488.45425 492.23517 499.19128 502.43307 505.61728 512.71649 518.42969">Table 4-19 shows the return values associated with the MKTME_KEY_PROGRAM leaf of PCONFIG. On </tspan><tspan y="-678" x="63 65.457001 71.145004 75.825005 79.362007 83.196007 88.88401 93.564011 97.101013 99.497711 104.95802 110.64602 113.83022 119.18523 124.40703 129.76202 134.44202 140.13002 143.66702 146.12402 151.57802 157.26602 160.53302 163.71722 169.96323 176.11023 182.26624 185.45044 187.90744 192.58743 195.71133 201.30934 206.76334 212.36134 218.04935 220.44604 225.84964 229.44965 234.79204 240.39005 243.57425 250.92725 253.38425 256.92123 262.60922 265.79343 269.33041 275.0184 280.37341 283.55762 287.33945 292.74216 296.27914 301.96713 305.80115 311.48914 314.67334 319.83484 325.23843 327.69543 333.38342 338.78613">instruction execution, RAX is populated with the return value.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2 c209E837B"><tspan y="-514.98029" x="46.019699 51.490799 56.231998 62.2314 68.411697 73.396797 75.780899 81.306 83.585701 89.416801 91.696503 94.953606 98.525703 103.67281 108.4509 110.7 112.93111 117.25111 122.049 125.6211 127.9008 132.92191">PCONFIG Virtualization</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-499.97998" x="46.019699 52.173 57.633301 60.798599 64.341896 71.598595 77.002197 80.842499 86.203796 89.087395 91.4841 97.1856 100.0692 106.2225 113.80679 119.96909 122.85269 126.63449 132.09479 137.55508 141.09839 143.98199 149.44229 155.04659 160.40788 164.13028 169.53658 173.07988 175.47658 180.93687 186.63118 189.51479 194.20108 199.60738 205.24948 208.13309 212.81938 218.27968 223.97398 227.51729 231.35759 236.81789 239.21458 242.09819 245.64149 251.3358 256.69711 259.52133 264.88263 270.10443 275.46573 280.15204 285.84634 289.38965 291.78543 297.24573 302.94003 305.82364 311.28394 314.40784 317.29144 322.71573 328.99503 336.07532 342.80463 347.97693 351.76321 358.7355 361.55972 364.02301 369.71732 372.54153 378.69482 386.27911 392.44141 395.26562 400.95993 406.42023 412.11453 416.19785 420.03815 425.49844 430.95874 434.50204 437.32626 442.78656 448.39087 453.75217 457.41428 462.82059 466.36389 468.82718 474.28748 479.9296 482.8132 488.50751 493.19382 495.5896 501.29111 506.89542 509.71964 513.26294 518.95721 524.31854">Software in VMX root operation can control the execution of PCONFIG in VMX non-root operation using the </tspan><tspan y="-488.99997" x="46.019699 49.184998 54.585899 57.049198 59.512497 64.972794 72.289795 74.745895 80.440193 86.044495 88.928093 95.08139 102.66569 106.74899 112.11028 117.33208 122.67448 127.36079 133.05508 136.59839 139.06169 144.46259 150.16409 153.0477 157.73399 163.19429 168.8886 172.4319 176.2722 181.6731 184.1364 188.82269 191.7063 194.103 199.8045 203.34781 207.18811 212.64841 218.2527 223.94701 228.6333 233.9946 239.59889 242.4231 245.58839 251.04869 254.88899 257.7132 263.13748 269.37537 276.45566 283.18497 288.35727 292.19846 299.17075">following VM-execution controls introduced for PCONFIG:</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-474" x="46.02">â€¢</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-474" x="63 68.4207 74.696404 81.773102 88.498802 93.667503 97.450203 104.4189 110.18159 115.8633 122.589 128.73869 134.90639 139.91309 145.59479 149.67448 152.49869 158.03639 163.7271 166.1868 170.86949 173.6937 178.37639 183.83308 189.52379 193.06349 196.90019 202.35689 204.81659 207.64079 210.10049 214.78319 217.66679 223.06949 225.89369 230.57639 233.03609 238.72679 244.32748 246.78719 252.14488 254.96909 260.56979 262.96649 266.5062 269.3898 274.07251 279.52921 285.21991 288.75961 292.59631 298.05301 300.44971 303.29999 308.69998 314.38797 319.98596 322.81015 328.21286 333.91434 339.31433 344.91232 347.36932 352.72433 357.40433 360.22852 363.7655 369.45349 374.8562 377.68039 383.09839 389.3714 396.4454 403.1684 408.33441 412.11441 419.08041 421.96399 424.36069 430.06216 434.74216 438.27914 442.11316 447.80115 452.48114 456.01813 458.47513 463.92914 469.61713 472.44131 474.89832 480.5863 483.41049 489.5575 497.1355 503.2915 506.17508 511.86307 517.31708 522.95917 527.03796 530.87195 536.32593 541.77991 545.31689">PCONFIG_ENABLE: This control is a single bit control and enables the PCONFIG instruction in VMX non-root </tspan><tspan y="-462.95969" x="62.999985 68.449486 74.042984 79.445686 83.107788 88.503288 92.035789 94.488289 99.93779 105.62129 108.92339 111.74759 115.58878 118.71268 121.59629 127.30679 130.56929 133.45288 136.98538 142.66888 148.01938 150.90297 156.25346 161.47527 166.82576 171.50127 177.18477 180.71727 183.16977 188.61926 194.30276 197.18636 202.63585 205.79034 208.67393 214.08743 220.35593 227.42543 234.14394 239.30544 243.08093 250.04243 252.86662 255.31912 261.00262 263.82684 270.01074 277.57254 283.72403 286.54825 292.23175 297.68124 303.36475 307.44 311.29199 316.76398 322.23596 325.79095 328.61517 334.08716 339.66714 345.04013 348.70221 354.12021 357.6752 360.13132 365.59164 371.23373 374.11734 378.79733 384.20093 389.90692 394.58691 399.92929 404.60928 407.49289 414.80991 421.41052 428.13531 431.37711 434.26071 441.35272 444.90771 450.5498 455.95248 459.80447 467.12149 469.57761 474.2576 479.59998 482.90207 485.72629 491.09927 496.26077 501.63376 506.31375 512.01978 515.57477 517.97052 523.43079 529.13678 532.02039 537.42126 540.60547">operation. If 0, the execution of PCONFIG in VMX non-root operation causes #UD. Otherwise, execution of </tspan><tspan y="-451.97968" x="63 68.4207 74.696404 81.773102 88.498802 93.667503 97.450203 104.4189 107.3025 114.6582 120.1149 123.9516 129.2733 133.95599 136.7802 142.18289 146.86559 151.54828 157.00497 160.84167 166.44238 168.83908 174.54059 180.1413 182.9655 186.5052 191.9619 194.7861 200.2068 206.4825 213.5592 220.28491 225.45361 229.23631 236.20502 241.96771 247.64941 253.80812 257.59082 263.12851 266.91122 273.63693 280.65332">PCONFIG works according to PCONFIG_EXITING.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-436.98001" x="46.02">â€¢</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-436.98001" x="63 68.4198 74.694603 81.770401 88.495201 93.663002 97.444801 104.4126 110.17529 115.85609 122.01389 125.79569 131.33249 135.11429 141.83908 148.80688 152.88568 155.76929 161.30609 166.9959 169.4547 174.13649 176.96069 179.41949 184.10129 186.92549 192.32729 195.21089 200.92769 206.64449 212.24429 215.0685 219.75029 225.20609 230.89589 234.43469 238.27049 243.72629 246.18509 249.00929 254.41109 260.10089 265.70068 268.58426 273.98605 276.38275 278.84155 284.29736 291.65216 296.33395 299.15814 305.30695 312.84 319.0014 321.82559 325.66498 331.12439 336.5838 340.12619 342.95038 348.40979 354.01318 359.3736 363.03568 368.44107 371.98346 374.44586 379.90527 385.59866 388.42285 391.96524 397.42465 400.24884 404.98914 410.39273 416.03482 420.71481 426.07523 428.89941 434.30481 437.18839 443.34079 450.92419 455.00659 460.367 465.69141 468.15381 471.6962 474.57977 477.74417 483.20358 487.04297 489.92654 495.02866 500.43225 504.27164 506.73404 512.19342 517.88684 522.57227 525.39648 527.85889 533.2193 538.62469 541.78912">PCONFIG_EXITING: This is a 64b control and allows VMX root operation to cause a VM-exit for various leaf </tspan><tspan y="-426" x="63 66.159897 71.848801 77.537704 82.278008 85.81591 88.212608 93.667511 99.356415 104.03732 106.92091 112.32182 115.50601 118.38961 123.80851 130.08241 137.10152 143.82092 149.04362 152.82452 159.79143 163.05933 165.94293 171.47884 177.16774 179.62564 184.30655 187.13075 191.81165 197.26654 202.95544 206.49335 210.32825 215.78314 218.24104 221.06525 226.66415 232.11905 237.52174 242.20174 245.02594 250.71484 256.16974 259.70764 262.53186 268.22076 273.56409 278.78586 284.18857 287.01279 292.4137 297.99551 303.31543 306.13965 311.54236 314.66626 317.82617 323.18207 327.92236 331.46207 334.28629 336.74417 339.90408 342.78769 346.32559 352.0145 357.37039 360.19461 365.61353 371.88742 378.96231 385.68622 390.85312 394.69434 401.66122 407.37714 413.05704 419.78094 425.92883 432.09473 437.09964 442.77954 445.60376 450.28467 455.73956 461.42847 464.96637 468.80127 474.25616 476.71405 479.53827 481.99615 486.67706 489.56067 494.24158 496.63828 502.04099 507.44458 509.96637 513.26843 516.09265 519.87354 523.41144 526.29504 528.75293 533.43384">functions of PCONFIG. This control does not have any effect if the PCONFIG_ENABLE control is clear. It is </tspan><tspan y="-414.95969" x="63 66.8367 72.194397 76.877098 82.333801 91.084503 99.835205 105.1929 110.8836 116.4843 121.842 127.4427 130.26689 133.80659 139.4973 144.89999 148.4397 151.32329 157.47299 165.0537 172.6344 177.31709 180.14128 182.60098 188.29169 191.83139 197.18909 201.02579 205.70848 211.06618 216.66687 220.20657 223.03076 228.38846 233.61026 238.96796 243.65065 249.29276 252.83246 255.29216 260.74887 266.43958 269.26379 274.72049 277.8822 280.76581 286.16852 291.75034 297.07202 299.89624 305.31696 311.59265 318.66934 325.39505 330.56375 334.34647 341.31516 344.19876 346.59546 351.99817 357.28207 362.56415 367.92184 372.60455 375.48816 382.84387 385.30356 388.84326 394.53397 397.35818 404.7139 410.35599 412.81567 417.49838 423.18909 426.07269 429.6124 435.25449 440.61218 445.93387 448.81747 454.22018 458.05688 463.41458 466.29819 471.94028 477.40057 480.94028 483.82388 486.9856 492.38831 501.13901 503.59869 506.05838 508.45508 513.85779 517.69446 520.57806 525.98077 531.67145 537.27216">recommended that VMMs intercept execution of any PCONFIG leaves with which they are not familiar and </tspan><tspan y="-403.97968" x="63 67.671898 73.117798 78.6996 83.981697 89.328598 93.154495 96.683395 99.507599 104.24789 109.88999 114.56189 120.24179 123.1254 128.47229 133.69409 139.04099 143.71289 149.39279 152.92169 155.37059 160.8165 166.4964 171.23671 174.0609 176.5098 182.1897 185.7186 191.16451 194.0481 201.39299 208.40939 213.81929 217.88818 223.59508 227.66397">convert such executions into #GP(0).</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2 c209E837B"><tspan y="-380.99997" x="46.019699 51.496201 56.237404 62.199905 68.396408 73.386909 75.776413 81.306915 83.586617 88.514114 93.540611 98.693115 102.78362 107.93611 111.19861 114.3207 119.3598 124.5123 128.6028">PCONFIG Concurrency</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-365.99966" x="46.019699 49.796101 55.480499 58.304699 63.701099 66.584702 71.261101 75.9375 81.288902 86.973305 92.369705 96.200104 98.653503 104.1039 106.98751 114.33691 120.02132 125.42402 129.26613 134.61752 137.44171 140.97511 146.65952 152.01091 154.8945 162.4689 168.6933 174.2247 181.7991 187.4745 193.1859 199.41029 205.08569 210.60809 216.31949 221.77888 228.01588 235.08629 242.04869 248.29109 254.43449 262.05658 264.88077 267.33417 272.68558 278.08197 281.23737 284.06155 289.51196 292.66736 295.49155 300.95096 307.18887 314.27997 321.00208 326.16718 329.94629 336.91138 339.79498 342.25107 346.93018 349.75439 355.10849 360.33026 365.73297 370.41296 376.10007 379.63617 385.03888 390.6189 393.5025 398.18161 403.6347 409.32181 414.00092 419.68802 423.52112 427.35422 432.70831 438.39542 441.93152 444.3876 449.70569 452.52991 457.983 463.6701 466.49432 475.24142 480.92853 483.38461 486.92072 489.3165 494.9559 497.3526 502.75531 505.57953 508.03561 513.48871 519.08582 521.54193 526.22101 531.62012 534.07623">In a scenario where the MKTME_KEY_PROGRAM leaf of PCONFIG is executed concurrently on multiple logical </tspan><tspan y="-354.95935" x="46.019684 51.619484 55.455284 60.911083 65.59288 70.949677 75.631477 80.313278 85.769081 89.604881 94.286682 97.555481 100.37968 105.83548 111.52528 113.98409 119.30489 122.18848 127.64429 133.33409 138.69089 141.51509 143.97389 149.42969 155.02948 157.48828 162.17007 167.57187 170.03067 172.85487 178.45468 182.29048 187.74628 192.42807 197.78487 202.46666 207.14845 212.60425 216.44005 219.26425 226.61905 229.07785 231.47455 233.93065 236.81425 241.49605 247.13815 251.87845 256.55844 261.91525 267.27206 272.87186 275.75543 278.21423 283.85632 286.7399 292.42969 297.95938 303.55917 308.96097 312.49976 314.95856 320.64835 326.24814 329.13171 332.6705 338.36029 343.7171 346.54129 351.86209 357.2189 362.5397 365.36389 368.90268 374.30447 379.90427 382.36307 387.71988 390.98868 393.81287 399.23267 405.50748 412.58328 419.30807 424.47586 428.25766 435.22546 438.10904 443.46585 448.68765 454.04446 458.72626 464.41605 467.95483 470.41364 475.86945 481.55923 484.38342 491.73822 494.13492 496.59372 499.05252 501.87671 505.71249 511.06931 514.60809 520.25018 524.086 529.77582 532.65942 540.01422 542.47302 546.01184 551.70166">processors, only one logical processor will succeed in updating the key table. PCONFIG execution will return with </tspan><tspan y="-343.97934" x="46.019684 51.423283 57.114883 59.818485 65.177086 69.014687 72.852287 78.309891 82.147491 84.911392 89.594994 95.052597 100.6542 106.01279 108.7767 112.85729 119.79089 125.4735 131.6241 135.4077 141.6843 147.3669 153.08549 159.25409 165.79439 171.94499 177.47459 181.55519 184.25879 189.71638 195.40799 198.11159 203.56918 207.10979 212.80139 218.15999 221.99759 224.76149 227.22209 232.62299 238.22458 240.68518 245.36877 250.77237 253.16907 255.93297 261.53458 265.37216 270.82977 275.51337 280.87198 285.55557 290.23917 295.69678 299.53436 304.21796 306.89999 312.30359 317.99518 323.59677 326.30127 330.98486 336.44247 339.60507 343.14566 350.40326 355.80774 359.64532 365.00394 367.76874 376.52032 382.1633 386.84689 390.38748 393.15228 396.98987 402.34848 405.88907 409.72665 414.22937 417.47208 420.23688 424.02048 429.71207 432.41656 437.10016 442.50375 447.18735 452.59097 457.27457 459.97906 467.33566 472.97864 478.38226 482.22525 487.58386 490.28836 493.82895 499.52054 504.87915 507.64395 510.10455 515.74756 520.43115 523.97174 527.80933 533.50092 538.18451 541.7251 544.18567 549.64325 555.33484">an error code (DEVICE_BUSY) on other logical processors and software must retry. In cases where the instruction </tspan><tspan y="-332.99933" x="46.019684 51.375584 56.597385 61.953285 66.634186 72.32309 75.860992 78.318893 83.773796 89.4627 92.166298 95.326195 100.7271 103.185 105.6429 110.3238 113.0274 120.38129 122.77799 126.3159 132.00479 134.70839 140.10928 142.81288 149.77707 155.41377 161.59767 165.37857 171.65247 177.33237 183.04826 189.21416 195.79405 201.94196 207.46886 210.17245 215.57515 219.41005 223.24495 228.69984 232.53474 235.23834 239.91925 245.37415 250.97305 256.32895 259.63107 262.33469 265.87259 271.56149 276.91739 279.621 284.8428 290.18521 295.50513 298.20874 301.74664 307.14755 312.74646 315.11969 320.4711 323.23499 325.6308 330.31079 333.01437 338.69876 344.14917 347.68256 350.38614 356.07053 361.66492 367.30432 372.70792 376.2413 381.59271 387.1871 390.4892 393.19278 396.72617 402.41055 407.76196 411.59238 416.94379 422.53818 427.85358 430.55716 435.90857 441.59296 446.26935 451.95374 455.78415 458.23755 463.92194 469.56134 472.26492 475.79831 481.4827 486.87909 490.41248 493.11606 498.46747 500.92087 504.45425 510.13864 515.49005 519.32043 522.02405 525.55743 531.24182 536.5932 539.29681 544.51862 549.92126 555.23669">execution fails with a DEVICE_BUSY error code, the key table is not updated, thereby ensuring that either the key </tspan><tspan y="-321.95901" x="46.019684 49.561184 54.965683 60.568184 63.029686 68.389183 71.272781 73.669487 78.349487 81.233086 86.925583 92.528084 98.130585 103.53509 107.07659 112.43609 118.03859 120.86279 123.32429 129.01678 131.84099 134.30249 137.84399 142.52849 145.41209 150.77159 156.4641 160.0056 162.4671 166.3056 171.6651 175.1445 180.48601 183.31021 190.66771 193.12921 196.67072 202.31282 205.19643 208.73793 214.43044 219.78993 222.61414 225.07564 230.76814 233.93164 239.39014 243.22864 251.93164 257.33615 260.87766 263.33914 268.79764 274.49014 277.31436 280.47787 285.93637 289.77487 292.59909 298.0036 300.88721 306.82812 312.17053 317.49402 321.27853 328.00336 331.24518 334.0694 339.52789 343.36639 346.25 348.71149 352.25299 355.07721 357.5387 362.22321 365.04742 370.73993 376.19843 379.73993 382.62354 388.26562 393.90503 399.50754 404.91205 408.45355 413.81305 419.41556 422.23978 427.64429 431.18579 434.0694 439.47391 441.87061 444.33209 447.60361 450.42783 454.21234 459.90485 462.72906 468.18756 472.02606 477.62857 482.98807 486.82657 489.65079 493.19229 498.65079 501.53439 506.9389 511.62341 516.30792 521.76642 530.51892 536.1214 538.58289 540.97955 545.66406 551.35657">table is updated in its entirety with the information for a KeyID, or it is not updated at all. In order to accomplish </tspan><tspan y="-310.979" x="46.019684 49.564785 55.260887 57.657585 62.337585 65.612686 68.436882 71.981979 77.678078 83.041176 85.865372 93.451469 99.687569 105.23067 112.81676 118.50387 124.22697 130.40817 136.10518 141.63928 147.36238 152.78848 159.04259 166.12469 173.0988 179.35291 185.50801 193.09412 195.91832 198.38342 203.74652 209.15462 212.32172 215.14592 220.60802 223.77512 226.59932 232.02542 238.30652 245.38863 252.11972 257.29382 261.13501 268.1091 270.93332 279.68942 285.09753 287.56262 293.20474 296.74985 302.15796 304.62305 310.31915 315.00726 317.89087 323.29898 326.1232 333.48431 337.13998 339.59607 343.13217 348.53488 352.37698 355.2012 357.65729 363.11038 367.78949 373.1076 375.99121 379.14932 384.55023 388.38333 391.26694 396.95404 402.55115 408.14825 413.54736 417.08347 419.53955 425.22665 430.82376 433.70737 437.24347 442.93057 448.28467 451.10889 456.33069 461.7334 467.05151 469.93512 473.47122 478.87033 484.46744 486.92352 492.27762 495.54373 498.36795 503.90204 509.58914 512.04523 516.7243 519.60791 522.00372 527.46405 532.14313 537.46124 540.28546 542.74158 547.42065">this, the MKTME_KEY_PROGRAM leaf of PCONFIG maintains a writer lock for updating the key table. This lock is </tspan><tspan y="-299.99899" x="46.019684 49.862682 55.226685 58.394684 63.758682 67.601685 71.444687 76.808685 82.415688 85.179588 88.725586 94.188583 97.012787 102.42178 107.11079 109.93499 113.48099 119.17799 124.54198 127.36619 133.2477 138.65039 143.97839 146.8026 150.3486 155.7576 161.36459 163.76129 169.12529 171.88919 174.35519 179.81819 184.50719 189.83519 192.59909 198.06299 203.70509 209.31209 212.07599 217.68298 223.04698 228.74399 234.20699 237.75299 243.11699 248.72398 251.54819 254.01419 259.71118 262.47507 266.02106 271.71805 277.08206 279.84595 282.31195 288.00894 292.69794 296.09998 299.93399 305.62198 310.30197 313.83896 316.29596 321.74997 327.39206 330.21625 333.37524 335.83224 341.23315 348.60956 353.28955 356.11374 361.51373 366.19373 369.01791 375.1991 380.89609 386.42209 392.18478 397.16269 403.28629 409.45129 414.45529 420.13428 425.89697 430.81998 437.83908 444.11209 450.34009 453.60709 456.43127 461.96628 467.65427 473.00928 475.83347 478.29047 483.74448 488.42447 493.74347 496.50735 501.18735 506.58734 512.27533 515.09955 520.45453 522.9115 526.44849 532.13647 537.49146 541.32544 544.14966 549.74768 555.10266">referred to as the Key table lock and denoted in the instruction flows as KEY_TABLE_LOCK. The lock can either be </tspan><tspan y="-288.95868" x="46.019684 51.709484 57.399284 59.858086 65.313889 69.995689 75.217491 80.620193 86.200195 89.468994 92.052895 99.407692 105.09749 110.45428 116.14409 118.72799 124.41779 129.87358 132.45747 134.85417 140.31447 145.91428 148.31097 152.99277 158.45667 160.85336 163.43726 169.03705 172.87285 178.32864 183.01044 188.36723 193.04903 197.73082 203.18661 207.02242 209.60631 212.06511 216.7469 219.3308 225.0206 230.47639 232.9352 238.535 240.9938 246.68361 252.28342 254.86731 258.4061 264.09589 269.4527 272.03659 274.49539 279.9512 284.633 289.9538 292.53769 296.61649 302.01828 304.47708 309.15887 314.61469 317.15997 320.69336 326.37775 331.72916 334.31305 336.76645 342.45084 344.90424 348.43762 350.89102 356.28741 358.74081 361.32471 366.0011 369.53448 374.93088 378.46426 383.81567 386.39957 391.84998 395.00537 397.58926 401.12265 406.80704 412.15845 414.74234 417.19574 422.64615 427.32254 432.63794 436.71133 439.29523 444.74564 448.57605 451.15994 456.75433 462.10574 464.68964 467.14304 472.82742 475.41132 480.80771 486.4921 489.07599 494.4787 499.7005 504.37689 506.83029 512.51471 517.1911 519.64453 524.95996 530.31134 532.89526 537.57166 541.10504 546.50146 550.03485 555.38623">unlocked, when no logical processor is holding the lock (also the initial state of the lock) or be in an exclusive state </tspan><tspan y="-277.97867" x="46.019684 53.380783 59.076881 64.43998 68.282082 73.64518 76.109375 81.517471 83.981667 86.378372 91.838669 97.444771 99.841476 104.52958 109.93768 112.40279 114.86698 120.47308 124.25488 129.71698 134.40508 139.76817 144.45627 149.14436 154.60646 158.44856 160.91277 163.30946 167.98946 170.45366 173.99876 177.84087 183.16797 185.63307 191.32918 196.93527 199.39948 202.94458 208.40668 210.87088 216.56699 222.17308 227.77917 233.18727 236.73238 242.09547 244.55968 248.10478 253.80089 259.164 261.6282 266.85001 272.19241 277.5195 279.9837 283.52881 288.93692 294.54303 297.00812 302.37122 305.51938 307.98358 313.51947 319.20837 324.56427 328.39917 333.75507 336.21927 340.90018 346.30109 351.98999 354.45419 360.0531 365.409 367.8732 373.32809 379.017 381.4137 386.75519 389.21939 394.67429 400.36319 405.71909 408.18329 410.64117 416.09607 421.69498 424.15286 428.83377 434.23468 436.69257 439.15677 444.75568 448.59058 454.04547 458.72638 464.08228 468.76318 473.44409 478.89899 482.73389 485.19809 490.88699 496.34189 498.79977 504.39868 506.85657 512.54547 518.14435 520.60858 524.14648 529.83539 535.19128 537.65552 540.1134 545.5683 550.24921 555.56909">where a logical processor is trying to update the key table. There can be only one logical processor holding the lock </tspan><tspan y="-266.99866" x="46.019684 48.476685 54.164684 57.048286 62.403286 67.625092 72.305092 74.762093 80.450096 85.130096 87.587097 92.808899 98.163902 101.04751 105.72751 109.26451 114.66451 118.20152 123.55652 126.82352 129.64771 135.18271 140.87071 146.22571 149.1093 151.5663 157.02029 161.70029 167.01929 170.28629 173.11047 178.70848 184.06348 186.52048 192.20848 197.80649 200.63068 206.03337 211.25517 215.93518 218.39218 224.08018 228.76019 231.21719 236.439 241.84169 245.08348 247.96707 252.64706 258.04706 263.73505 266.55927 272.01328 277.61938 280.07278 285.38818 288.27179 293.86618 299.21759 302.1012 307.49759 312.17398 317.76837 323.45276 325.90616 329.73657 335.08798 340.68237 343.56598 350.91537 356.59976 361.95117 367.63556 370.51917 374.05255 379.73694 385.13965 387.96387 390.41727 395.86768 400.54407 405.85947 408.68369 411.13708 415.81348 418.6377 421.09109 426.77548 429.5997 435.28409 440.96848 443.42188 448.87228 453.54868 458.77048 464.11288 469.70728 472.59088 477.26727 480.80066 486.19705 489.73044 495.08185">in exclusive state. The lock, being exclusive, can only be acquired when the lock is in unlocked state.</tspan><tspan y="-251.99835" x="46.019684 51.437683 57.710682 64.784683 71.507683 76.673683 80.453682 87.419685 90.243889 95.931892 100.61189 105.9669 110.7072 113.53139 117.0684 122.7564 128.1114 130.99501 134.11891 139.57921 142.03621 144.49321 149.9472 157.26421 159.72031 165.40831 171.00632 173.88992 178.56992 183.85202 189.54002 193.07703 198.47702 203.79602 206.62022 210.15723 215.61122 218.49483 223.89482 228.57483 234.17284 239.86084 242.31784 246.15184 251.50684 254.33104 260.55905 266.23804 271.76404 277.47903 282.51724 288.65967 294.82468 299.82867 305.50766 311.22266 316.14566 323.22507 329.49808 335.67926 338.56287 341.01987 346.70786 349.59146 354.94647 360.16827 364.84827 367.30527 372.99326 377.67325 380.13025 385.35205 390.70706 393.59067 402.33865 407.69995 413.31955 418.66193 421.5455 426.9671 432.60919 438.22879 441.05298 444.90857 450.25095 452.72955 458.07193 463.49353 468.19513 473.53751 476.36169 479.92029 485.62988 490.97226 493.85583 496.33444 501.73532 506.43692 511.71902">PCONFIG uses the following syntax to acquire KEY_TABLE_LOCK in exclusive mode and release the lock:</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-237" x="46.02">â€¢</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-237" x="63 69.227097 74.905197 80.430298 86.144402 91.122307 97.306213 103.47031 108.47341 114.15151 119.86562 124.78861 131.86801 138.14011 144.3672 147.6333 153.7794 160.0515 167.1246 173.7027 177.4818 183.7269 189.405 193.48109 202.37219 208.61729 212.39639 217.97459 223.6113">KEY_TABLE_LOCK.ACQUIRE(WRITE)</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="13.98" class="c226444D3 c9DBAE658"><tspan y="-222" x="46.02">â€¢</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-222" x="63 69.243301 74.937599 80.478897 86.209198 91.187096 97.370995 103.55129 108.57059 114.26489 119.99519 124.9182 131.99759 138.23549 144.47699 147.75929 154.0206 159.7149 164.73421 170.42851 176.49182 182.65411 188.29082 192.38312">KEY_TABLE_LOCK.RELEASE()</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2 c209E837B"><tspan y="-198.96001" x="46.019699 51.977699 57.0177 62.0397 65.161797 69.940796 73.513794 75.793495 80.832596">Operation</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-651.29999" x="214.08 219.17754 224.51509 230.1405 232.67831 238.2838 240.80368 246.92111 250.04059 256.15802 262.33521 264.76346 267.22357 269.74344 275.31906 281.01718 286.64258 292.26797 297.87347 301.52679 305.48788 311.09338 316.71878 319.23865 325.05927 330.45859 336.0043 338.46442 344.03006 347.68338 351.04587 356.68524 360.28778 362.80765 368.30359 373.90909 379.48868 385.12805">Table 4-19.  Supported Key Error Codes</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-636" x="49.98 55.558201 60.417301 64.002899 69.163498 72.434097 77.594696 79.874397 85.275291 90.073196 92.3358 97.496399 176.5155 181.5537 186.71429 190.6734 195.70801 200.7606 203.0052 208.1658 233.1255 238.9458 243.98041 248.26801 252.36661 255.63721 257.88181 262.80212 266.38773 268.63232 273.66693">Return ValueEncodingDescription</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-619.97998" x="49.98 55.1064 60.385799 66.124199 71.345093 75.904495 80.688896 86.382294 90.943497 95.673897 100.3548 105.1392 176.48129 233.12189 238.04219 242.60249 247.28249 249.38489 254.92529 257.14468 264.09808 268.57648 272.59589 274.81528 278.83469 283.61908 287.53049 291.44189 296.1633 300.12512 304.08694 307.44574 312.23013 314.16153 316.09293 320.77832 322.99771 327.6651 330.7269 335.45731 340.077 343.13879 347.63788 354.59128 361.49158 366.21298 370.83267">PROG_SUCCESS0KeyID was successfully programmed.</tspan><tspan y="-604.02026" x="49.98 52.082401 57.783001 62.9445 68.4039 72.873299 74.9757 80.516098 85.0755 90.201904 95.481308 101.17921 106.45952 111.01892 115.74932 122.28962 176.58752 233.22812 235.32872 239.95111 244.38991 248.8683 250.7997 252.72121 257.4003 259.61969 264.54001 269.10031 273.78571 275.88809 281.4285 283.64789 288.31528 291.37708 296.10748 300.72717 303.78897 308.28806 315.18835 322.14896 324.07047 328.87286 333.54025 335.75964 339.35876 344.09998 351.05338 357.95367 362.43207 367.17416 371.84155">INVALID_PROG_CMD1Invalid KeyID programming command.</tspan><tspan y="-588.00024" x="49.98 54.705902 60.2868 65.471703 70.751106 76.485008 81.606911 86.737808 91.292709 96.018608 101.44651 106.72591 112.42381 176.56322 233.20383 235.30173 240.04384 244.05875 248.83865 252.13806 255.49687 257.41837 261.31805 263.27194 267.95282 272.57523 275.99521 278.21463 282.89551 287.51791 290.8938 294.0159 298.69678 303.2562 307.87592">ENTROPY_ERROR2Insufficient entropy.</tspan><tspan y="-571.98022" x="49.98 52.068001 57.7686 62.930103 68.389503 72.844505 74.932503 80.458504 85.003502 89.9832 94.724403 99.845406 101.9334 176.51102 233.15161 238.0719 242.6322 247.30321 249.3912 254.91721 257.1366 261.90659 266.4075 269.82748 272.04688 276.48569 280.98477 282.90176 284.84576 289.49878">INVALID_KEYID3KeyID not valid.</tspan><tspan y="-556.02051" x="49.98 52.080601 57.7812 62.942703 68.402107 72.869705 74.970306 80.508904 85.066505 89.795105 95.616302 100.3449 104.8458 110.30521 114.5046 176.5452 233.18579 235.28639 239.9088 244.3476 248.84669 250.77629 252.6978 257.3634 259.58279 264.2637 269.0661 272.97571 276.24631 280.9299 285.3696 288.7482 290.7048 295.38571 300.18811 302.4075 306.8472 308.82809 313.44778 318.189 321.45959 323.4162 326.7948 331.5369 338.48849 340.70789 344.61749 349.40009 354.08099 358.10309 362.82269 367.56479 369.78418 372.37979 377.16238 381.6633 385.02301 387.2424 391.26001 396.00211 400.66769 405.33328 410.01419 413.28479 416.66339 421.3443 426.02338 428.61899">INVALID_ENC_ALG4Invalid encryption algorithm chosen (not supported).</tspan><tspan y="-540.00049" x="49.98 55.521301 60.252602 65.893806 67.994408 72.725708 77.457008 81.957909 87.283211 92.977509 97.599907 176.5011 233.14169 237.82259 242.30188 244.22339 246.15569 250.94098 254.00278 258.74307 260.96249 264.20248 268.94366 271.16309 275.60278 279.51508 283.42737 288.14966 292.16995 296.13174 298.35117 302.43088 306.99118 311.67749 313.89691 317.2782 321.7179 326.3862 328.31851 332.99939">DEVICE_BUSY5Failure to access key table.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-172.32001" x="209.16 214.25754 219.59509 225.2205 227.75832 233.3638 235.88367 242.0011 245.12057 251.23801 257.41519 259.84344 262.30356 264.82343 270.92691 276.14896 282.79028 289.69058 295.25623 297.8956 304.05884 306.51895 313.16028 318.78568 324.39117 327.81342 333.14999 337.11108 339.62897 345.23447 350.9794 353.43951 359.50018 364.83777 368.44031 370.96017 376.29675 381.87634 384.41415 390.01965">Table 4-20.  PCONFIG Operation Variables</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-156.96001" x="49.919998 55.3209 60.118801 63.415501 65.635803 70.453506 75.532204 77.820908 82.881607 85.101906 91.282204 96.080109 103.57081 175.38992 180.24812 185.16663 190.24533 309.94443 314.97812 317.19839 321.33838 326.37747">Variable NameTypeSize </tspan><tspan y="-146.99971" x="309.90027 312.84238 318.48355 323.46146 327.06235 332.10147 336.36118">(Bytes)</tspan><tspan y="-156.96001" x="355.62027 361.45407 366.49588 370.79068 374.89648 378.17429 380.42609 385.2861 388.88699 391.13879 396.1806">Description</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-130.97971" x="49.919952 55.107552 61.690151 66.814751 71.372353 76.352051 81.032951 86.16655 90.66745 95.792053 101.07146 106.80806 112.08566 117.51627 123.12687 129.70947 134.26707 139.04968 144.23729 149.66789 155.3595 160.04041 175.39891 181.93921 187.09891 192.25772 198.84032 203.52122 208.07883 213.05852 217.78712 222.92073 227.47833 232.60294 237.88234 243.64055 248.86145 254.32085 259.93146 266.51407 271.01495 275.81735 281.00494 286.43555 292.12714 296.85574 310.05423 315.32281 320.59143 355.62027 360.12207 363.48175 366.76224 371.55475 375.47424 378.86273 383.65524 386.71704 391.44653 393.66595 398.40805 403.14923 405.08875 409.70847 411.67496 416.41705 421.09256 423.31198 426.70047 431.49298 436.17386 438.39328 442.41266 446.97296 451.66647 453.88589 458.5614 461.6232 466.36169 471.0372 474.099 478.5387 485.50018 492.40048 494.36697 499.10907 503.78458 506.004 509.90549 513.2652 516.54572 521.28778 525.20728 528.59576 533.38824 536.45007 541.17957">TMP_KEY_PROGRAM_STRUCTMKTME_KEY_PROGRAM_STRUCT192Structure holding the key programming structure.</tspan><tspan y="-114.9597" x="49.919952 55.110252 61.695553 66.822853 71.383156 76.81646 82.637657 88.178955 92.739258 98.137459 103.05686 107.61536 113.19537 117.75567 122.73627 127.41717 175.41867 181.05988 183.16048 188.80168 193.96049 199.1805 204.4608 310.0011 315.2814 355.72202 361.12201 365.60132 370.34341 375.01172 379.74301 386.64334 388.86276 393.53107 397.79077 401.17206 405.61176 407.83118 411.85059 416.41089 421.0972 423.31662 427.98492 432.6658 437.45111 442.13199 445.19379 449.51291 452.8942 457.57507 462.24338 464.4628 467.6416 472.38278 475.65607 477.87549 480.93729 485.37698 490.16229 494.8306 499.51147 506.47205 508.69147 512.71088 517.27118 521.95746">TMP_RND_DATA_KEYUINT12816Random data key generated for random key </tspan><tspan y="-103.9797" x="355.62027 360.30386 363.36566 368.11227 372.73196 375.79376 380.29285 387.26245 394.16275 396.13736 400.87946 405.56305 407.78244 412.46335 416.90305 420.29965 422.22116 426.96777 431.70987">programming option.</tspan><tspan y="-87.959702" x="49.919952 55.112953 61.700954 66.830956 71.393959 76.829956 82.688957 88.232956 92.795959 97.98896 105.24926 109.98326 115.59926 120.86426 125.36516 130.34486 135.08606 175.46727 181.10847 183.21448 188.85567 194.04866 199.26866 204.54266 310.08298 315.35696 355.79755 361.23355 365.71555 370.45764 375.13672 379.87073 386.77103 388.99042 392.37442 399.21442 403.93942 408.37912 412.67212 414.89151 418.91092 423.47122 428.16022 430.37961 434.9993 439.73959 444.48169 449.22198 452.28378 456.54349 459.92749 464.6084 469.27939 471.49878 474.61816 479.35938 482.63538 484.85477 487.91656 492.35626 497.14426 501.76395 506.49796 513.39825 515.61768 519.69739 524.25769 528.94672">TMP_RND_TWEAK_KEYUINT12816Random tweak key generated for random key </tspan><tspan y="-76.979698" x="355.62027 360.30386 363.36566 368.11227 372.73196 375.79376 380.29285 387.26245 394.16275 396.13736 400.87946 405.56305 407.78244 412.46335 416.90305 420.29965 422.22116 426.96777 431.70987">programming option.</tspan></text><path transform="matrix(1,0,0,-1,0,792)" d="m 45.78,535.26 h 0.47998 V 646.74 H 45.78 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 172.32,534.72 h 0.48 v 112.5 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 228.9,534.72 h 0.47999 v 112.5 H 228.9 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 557.76,535.26 h 0.48 v 111.48 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.72,646.74 h 512.52 v 0.48 H 45.72 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.72,630.78 h 512.52 v 0.48 H 45.72 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.72,614.76 h 512.52 v 0.48 H 45.72 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.72,598.74 h 512.52 v 0.48 H 45.72 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.72,582.78 h 512.52 v 0.48 H 45.72 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.72,566.76 h 512.52 v 0.48 H 45.72 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.72,550.74 h 512.52 v 0.48 H 45.72 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.72,534.78 h 512.52 v 0.48 H 45.72 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.66,72.24 h 0.47998 V 167.7 H 45.66 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 171.06,71.7 h 0.48 v 96.53999 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 305.64,71.7 h 0.48 v 96.53999 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 351.36,71.7 h 0.47998 v 96.53999 H 351.36 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 557.82,72.24 h 0.48 v 95.46 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.66,167.76 H 558.3 v 0.47999 H 45.66 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.66,141.72 H 558.3 v 0.48 H 45.66 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.66,125.76 H 558.3 v 0.48001 H 45.66 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.66,98.76 H 558.3 v 0.48001 H 45.66 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 45.66,71.76 H 558.3 v 0.48001 H 45.66 Z" inkscape:connector-curvature="0" /></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="498.14645pt" height="643.71497pt" viewBox="0 0 498.14645 643.71497" sodipodi:docname="992.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.83881" inkscape:cy="422.47087" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg108" /><g transform="translate(-45.120895,-69.138184)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="45.119999 47.694901 51.700802 53.9202 59.6721 65.373604 70.891502 73.110901 75.046799 78.405602 80.625 85.728897 90.4701 96.185997 102.0666 106.7745 108.8544 114.1113 116.3307 118.26659 122.2635 124.48289 129.28529 133.9662 137.3862 139.60561 144.3045 149.1069 153.8688 160.82939 165.52829 168.83038 173.28629 176.64418 181.38448 186.00417 188.22357 192.96477 196.20656 198.42596 203.16716 208.26836 212.76746 217.74716 223.02745 225.24686 229.25276">(* #UD if PCONFIG is not enumerated or CPL&gt;0 *)</tspan><tspan y="-703.98029" x="45.119999 47.224197 51.905098 54.1245 56.723701 61.404602 66.532799 72.227997 74.332199 79.874397 81.591599 86.8116 88.528801 93.748802 95.511002 100.1919 105.7341 111.4023 114.1725 119.4447 124.7169 127.48711 129.7065 134.8347 139.96291 142.1823 147.4545 149.67389 155.3718 160.83121 163.0506 167.73151 172.83272 177.30392 179.52332 184.50302 186.72241 191.99461 194.59381 196.8132 202.5894 208.28461 213.82681">IF (CPUID.7.0:EDX[18] == 0 OR CPL &gt; 0) #UD;</tspan><tspan y="-679.97998" x="45.119999 47.225998 51.906898 54.126297 56.727299 58.6488 63.436798 65.656197 71.297401 77.898003 83.568001 85.787399 90.529503 95.270706 100.05871 102.90271 106.14451 110.88571 115.56661 118.98662 121.20602 128.10631 132.8475 137.46721 142.20752">IF (in VMX non-root mode)</tspan><tspan y="-667.98029" x="45.119999">{</tspan><tspan y="-655.98059" x="58.619999 60.714298 65.4366 67.655998 70.2453 75.9216 82.497902 87.2202 91.996498 93.703796 98.822098 103.5444 109.2747 115.12199 119.84429 121.93859 127.20989 131.7612 136.48351 142.33081 147.9351 153.2514 157.71271 162.43501 164.65442 169.77272 174.89102 177.11043 182.37273">IF (VMCS.PCONFIG_ENABLE == 1)</tspan><tspan y="-643.9809" x="58.619999">{</tspan><tspan y="-631.9812" x="76.680298 78.780899 83.509499 85.728897 88.324493 90.92009 95.648689 101.25929 106.92389 109.14329 114.17789 116.39729 121.66589 126.88589 129.10529 134.71588 140.56949 146.10809 148.32748 154.01009 160.55038 165.27899 170.06158 171.74188 176.84308 181.57169 187.26059 193.12138 197.80228 199.91008 205.19489 209.75969 214.44058 220.11238 222.22018 227.37898 229.47958 235.30078 240.58109 243.35489 248.57489 253.85069 256.62448 258.84387 263.94507 269.10657 274.32657 276.90598 279.12537 284.86917 290.26917">IF ((EAX &gt; 62 AND VMCS.PCONFIG_EXITING[63] ==1) OR </tspan><tspan y="-619.98151" x="45.120895 47.340298 49.5597 51.779102 53.998505 56.217907 58.437309 60.656712 94.675812 96.89521 99.534012 104.21492 109.81652 115.47212 117.69152 122.71712 124.93652 130.19612 135.45572 137.67513 143.27673 149.12134 154.69954 156.90089 162.55289 169.15349 173.85149 178.65388 180.33688 185.49838 190.19638 195.95457 201.77757 206.51877 208.61937 213.84027 218.40147 223.14267 228.77667 230.87727 236.03427 238.13487 243.95787 249.23816 251.97415 256.71536 262.29535 267.92935 270.66534 272.88477 278.04626 283.14746 285.36688 290.60489 293.24368">         (EAX &lt; 63 AND VMCS.PCONFIG_EXITING[EAX] == 1))</tspan><tspan y="-607.98181" x="76.681198">{</tspan><tspan y="-595.98212" x="94.681198 99.4683 104.1924 107.5755 109.7949 115.4361 122.0367 126.7176 131.52 133.2003 137.9415 143.6106 145.7157 150.8745 155.4357 160.8708 165.5517 171.1317 175.9341 181.632 187.5009 189.72029 194.8215 197.04089 202.14211 206.8833 212.58121 218.46181 223.1427 225.2433 230.52721 232.4091 234.62849 237.7704 240.91231 246.7722 251.45309 253.67249 258.40738 263.20529 265.12677 268.48645 270.70587 275.37778 280.16669 284.60638 286.52789 288.49078 291.79019 293.75308 297.66898 302.10867 305.46835 307.43124 312.16614">Set VMCS.EXIT_REASON = PCONFIG; //No Exit qualification</tspan><tspan y="-583.98242" x="94.681198 100.24319 104.9241 106.8456 108.8274 113.4462 118.1271 121.4211 123.6405 129.28169 135.88229 140.56319 146.26379 148.38779 153.54659">Deliver VMEXIT;</tspan><tspan y="-571.98273" x="76.681198">}</tspan><tspan y="-559.98303" x="58.620895">}</tspan><tspan y="-547.98334" x="58.620895 63.355797 67.829697 72.618599">ELSE</tspan><tspan y="-535.98364" x="58.620895 61.562996">{ </tspan><tspan y="-523.98395" x="76.681198 82.451996 88.1418">#UD</tspan><tspan y="-511.98425" x="58.620895">}</tspan><tspan y="-499.98456" x="45.120895">}</tspan><tspan y="-475.98425" x="45.120895 47.719196 51.748497 53.967899 59.743198 65.023499 70.150803 72.7491 78.020401 80.618698 82.838097 86.137497 90.8787 94.120499 96.339897 100.8192 105.5613 107.7807 112.566 117.3513 121.3131 126.0984 130.76671 135.38641 140.12761 143.36942 146.72911 151.45142 156.07112 158.29051 160.22281 164.94511 169.38481 172.74362 174.96301 178.99231">(* #GP(0) for an unsupported leaf *)</tspan><tspan y="-463.98456" x="45.120895 47.214294 51.935696 54.155094 56.793896 61.474796 67.078194 72.735596 74.954994 76.697395 81.814796 84.034195 89.295593 91.883995 94.103394 99.868797 105.1392 110.2566 112.845 118.1064">IF (EAX != 0) #GP(0)</tspan><tspan y="-439.98425" x="45.120895 47.702995 51.716095 53.935497 59.181599 63.896698 69.0168 73.560898 78.671997 84.089096 89.812195 95.076294 100.49339 106.09049 112.65959 114.9006 116.8248 121.539 126.0102 129.3474 131.5668 134.90401 136.8282 141.55141 148.4976 150.71701 154.7382">(* KEY_PROGRAM leaf flow *)</tspan><tspan y="-427.98456" x="45.120895 47.206196 51.919495 54.138893 56.777691 61.458591 67.053894 72.754494 74.973892 80.083191 85.19249 87.411896 92.665199">IF (EAX == 0)</tspan><tspan y="-415.98486" x="45.120895">{</tspan><tspan y="-403.98517" x="58.620895 61.259697 65.281792 67.501198 73.253998 78.511795 83.673294 86.252693 91.501495 94.140297 96.359703 98.296501 101.6193 103.83871 109.00651 115.56931 120.27811 124.81591 130.40671 135.11551 140.28331 142.36411 148.0269 153.66631 158.83411 163.54291 165.76231 172.32512 177.12752 182.53831 184.75772 186.73952 190.70132 192.92073 197.72313 202.46432 205.82312 208.04253 209.95233 214.62059 218.50499 222.8241 227.51849 232.19759 234.41699 239.15819 242.39999 244.6194 249.2598 254.00099 258.7413 262.70309 264.92249 269.72488 274.46609 277.81949 280.03888 284.73328 289.53568 293.98706 298.66617 300.57056 305.26495 307.48434 312.28677 316.6806 319.96381 324.5835 331.5477 335.9874 339.2706 343.95151 346.1709 350.90311 355.6452 359.56741 362.85062 367.54681 372.1665 375.52621 377.50803 382.24924 386.99133 389.21072 393.95193 397.19373 399.41312 406.37732 411.11942 413.06161 416.45282 418.37433 423.05341 424.99561 429.67651 431.8959 436.19611 440.87701 445.57321 449.60342 451.82281 456.26251 459.56461 464.24551 466.4649 471.2601 475.94101 479.30072 481.52011 486.25232 490.99442 495.48361 500.1033 502.0455 506.72641 511.4046 513.62402 517.66321">(* #GP(0) if TME_ACTIVATE MSR is not locked or does not enable hardware encryption or multiple keys are not enabled *)</tspan><tspan y="-391.98547" x="58.620911 60.721512 65.450111 67.66951 70.265106 72.365707 77.976311 83.244911 88.513512 93.014412 98.202011 104.74232 109.47092 114.02852 119.63912 124.36772 129.55533 131.65593 137.29713 142.93652 148.12413 152.85274 154.56635 159.03395 164.77055 169.45146 174.71106 176.93045 178.68005 183.80466 186.02405 191.29265 193.51204 199.20995 204.66934 206.88873 208.92993 214.50092 219.72092 225.00122 229.55972 234.74823 241.33173 246.01263 250.57114 256.18265 260.91214 266.10065 268.20215 273.88565 279.49716 284.68567 289.41516 291.09546 295.82495 301.67944 307.29095 312.57214 317.04065 321.72153 323.94095 325.69144 330.78091 333.00034 338.22034 340.43976 346.17184 351.59793 353.81735 355.91345 361.51956 366.78366 372.00366 376.55676 381.73987 388.31796 393.04205 397.54297 403.18237 407.86325 413.08145 415.17755 420.85565 426.46176 431.64487 436.32574 438.06091 444.6012 449.8815 454.4292 459.6069 466.14719 470.88837 475.43607 480.68576 485.40445 490.52814 492.61884 498.14752 502.69522 508.00793 510.09863 515.27631 520.04901 522.26837 527.38306 532.49774 534.7171 539.97583 542.56152">IF (IA32_TME_ACTIVATE.LOCK != 1 OR IA32_TME_ACTIVATE.ENABLE != 1 OR IA32_TME_ACTIVATE.MK_TME_KEYID_BITS == 0) </tspan><tspan y="-381.00546" x="45.120911 50.889011 56.162109 61.282211 63.87331 69.137413">#GP(0)</tspan><tspan y="-357.00516" x="58.620911 61.259708 65.281807 67.501205 72.201904 77.004303 81.696007 85.577705 89.896805 92.116203 98.670906 103.9512 109.1109 115.6656 120.4068 124.968 130.19971 134.9409 140.0466 144.57629 149.67299 155.13239 160.84108 166.09077 171.49347 177.07617 183.67677 188.20647 192.96117 198.17937 203.57936 209.28085 213.96175 219.17995 221.39935 223.32805 227.31775 229.53716 234.77786 240.05817 245.33847 250.61967 252.83908 257.3382 259.2597 261.18842 265.86752 270.62222 275.36255 280.00024 282.21964 286.21832">(* Check MKTME_KEY_PROGRAM_STRUCT is 256B aligned *)</tspan><tspan y="-345.00546" x="58.620911 60.721512 65.450111 67.66951 70.265106 75.803703 80.586304 82.344902 87.744904 93.086403 98.751007 100.97041 102.927 106.8888 109.1082 113.8908 118.6194 121.998 124.2174 129.43739 134.70599 139.97459 145.2558 147.47519 151.95178 153.88138 155.80289 160.48199 165.22409 169.9644 174.58411 177.2229 179.44229 185.21489 190.43579 195.56039 198.15599 203.37599 206.01479">IF (DS:RBX is not 256B aligned) #GP(0);</tspan><tspan y="-321.00516" x="58.620911 61.259712 65.281807 67.501205 72.206406 77.008804 81.705002 85.591202 89.910301 92.1297 95.484901 100.2441 104.7432 108.10291 110.3223 116.8815 122.1618 127.326 133.92659 138.63179 143.16599 148.44629 153.12718 158.28868 162.78958 167.95108 173.35107 179.06427 184.31847 189.72566 195.36507 201.92427 206.45847 211.26086 216.41966 221.82686 227.52835 232.26955 237.42834 239.64775 241.58095 245.57515 247.79456 251.09665 255.77754 260.23074 264.90985 267.12924 271.62833 275.51453 279.40073 284.09692 288.09113 292.08533 294.01852 298.69763 300.61911 305.31531 307.5347 311.5379">(* Check that MKTME_KEY_PROGRAM_STRUCT is read accessible *)</tspan><tspan y="-309.00546" x="58.620911 63.649212 68.677513 74.209816 78.986115 80.738411 82.957809 88.382111 93.69841 99.356712 101.57611 105.58741 110.36371 115.08601 119.8623 121.78561 126.44491 128.66431 133.32361 138.00092 140.22032 143.48282 148.19432 152.66283 157.32033 159.53973 164.00824 167.90974 171.81125 176.52275 180.53226 184.54176 186.49026 191.14777 193.06926 197.78076 202.80727">&lt;&lt;DS: RBX should be read accessible&gt;&gt;</tspan><tspan y="-285.00516" x="58.620918 61.25972 65.281815 67.501213 72.209114 76.917015 81.561913 86.224815 88.444214 95.044807 100.26481 105.48301 112.02331 116.73121 121.26811 126.50701 131.2149 136.3278 140.8647 145.9686 151.37849 157.13669 162.41699 167.82689 173.41679 180.0174 184.55429 189.31619 194.48309 199.94249 205.61339 210.36093 215.53954 217.75894 221.12854 225.84814 228.06755 232.53516 234.75456 238.12416 242.83476 249.77736 254.43396 259.15356 262.41516 266.88275 270.14435 274.81894 277.03833 281.71744 286.15714 289.41873 291.36633 295.83392 300.49051 302.4111 307.1217 309.34109 313.3587">(* Copy MKTME_KEY_PROGRAM_STRUCT to a temporary variable *)</tspan><tspan y="-273.00546" x="58.620926 63.839127 70.379425 75.490524 80.034622 85.280724 89.995827 95.157326 99.718521 104.82962 110.24672 115.96982 121.23392 126.69331 132.27332 138.84242 143.38652 148.15562 153.32973 158.74683 164.42493 169.14003 174.31413 176.53354 181.64464 183.86404 189.38914 194.15825 195.90335 201.32045 206.62955 212.28064 214.02124 218.04335">TMP_KEY_PROGRAM_STRUCT = DS:RBX.*;</tspan><tspan y="-249.00516" x="58.620926 61.242626 65.264725 67.484123 72.884125 77.626228 83.33493 88.852829 91.072227 94.440926 96.362419 101.10812 103.02962 107.64931 109.86871 113.76841 118.57081 123.25171 127.15141 131.4651 133.68451 137.70662">(* RSVD field check *)</tspan><tspan y="-237.00546" x="58.620926 60.714325 65.435722 67.655121 70.243523 75.42392 81.999321 87.116722 91.667122 96.919525 101.64092 106.76733 111.31773 116.43513 121.85853 127.58793 132.85832 138.24123 143.86082 150.40112 154.96773 159.75932 164.91812 170.31813 176.01874 180.69963 185.89622 187.57652 193.01613 197.75822 203.44983 208.96774 211.18713 212.94574 218.04695 220.26634 225.54395 228.14854 230.36794 236.14954 241.43614 246.53735 249.11674 254.39435 256.99896">IF (TMP_KEY_PROGRAM_STRUCT.RSVD != 0) #GP(0);</tspan><tspan y="-213.00516" x="58.620926 60.716125 65.439323 67.658722 70.248924 75.431122 82.008324 87.127525 91.679726 96.933929 101.65713 106.78532 111.33752 116.45673 121.88193 127.61313 132.88533 138.31053 143.91573 150.42093 154.96503 159.73413 164.90823 170.32533 176.00343 180.71854 185.93674 187.61703 192.86313 197.57823 202.73973 204.84033 210.36543 214.90953 219.62463 224.79874 230.25813 234.69693 236.43753 241.83752 246.60663 252.27573 257.80081 260.0202 261.75632 266.86743 272.12253 274.70462 276.92401 282.68311 287.9472 293.05832 295.64041 300.89551 303.4776">IF (TMP_KEY_PROGRAM_STRUCT.KEYID_CTRL.RSVD !=0) #GP(0);</tspan><tspan y="-189.00485" x="58.620934 60.715233 65.437531 67.656929 70.246231 75.427528 82.00383 87.122131 91.673431 96.926735 101.64903 106.77634 111.32764 116.44594 121.87024 127.60054 132.87184 138.29614 143.90044 150.44073 154.99203 159.76834 164.94965 170.34064 176.03944 180.72034 185.91513 187.59543 192.86223 197.54312 202.68393 207.18483 211.92062 214.02843 218.76422 223.23901 228.78482 233.34962 238.62543 240.30573 245.63553 250.77634 255.97113 260.70694 265.44904 268.14093 273.40234 278.66376 280.41516 285.63516 290.91547 293.67487 295.89426 297.63666 302.75406 304.97345 310.23486 312.82327 315.04266 320.80807 326.07846 331.19586 333.78427 339.04568 341.63409">IF (TMP_KEY_PROGRAM_STRUCT.KEY_FIELD_1.BYTES[63:16] != 0) #GP(0);</tspan><tspan y="-165.00455" x="58.620926 60.714325 65.435722 67.654221 70.242622 75.423019 81.998421 87.115822 91.666222 96.918625 101.64002 106.76643 111.31683 116.43423 121.85763 127.58703 132.85742 138.28082 143.88422 150.42361 154.97401 159.74942 164.92982 170.34062 176.03943 180.72032 185.91512 187.59541 192.86221 197.54311 202.6839 207.1848 211.92059 214.0284 218.76419 223.23898 228.78479 233.34959 238.6254 240.30569 245.6355 250.77631 255.9711 260.70691 265.44901 268.14093 273.40234 278.66376 280.41516 285.63516 290.91547 293.67487 295.89426 297.63666 302.75406 304.97345 310.23486 312.82327 315.04266 320.80807 326.07846 331.19586 333.78427 339.04568 341.63409">IF (TMP_KEY_PROGRAM_STRUCT.KEY_FIELD_2.BYTES[63:16] != 0) #GP(0);</tspan><tspan y="-141.00424" x="58.620926 61.259727 65.281822 67.501221 72.209122 77.01152 81.710419 85.599319 89.918419 92.137817 95.459717 100.16762 103.41752 105.63692 110.13602 112.35542 116.98232 121.43822 123.34711 125.32891 129.97382 132.19322 136.15233 140.83324 147.76413 154.69502 159.19412 163.93622 168.58112 170.80052 174.80643">(* Check for a valid command *)</tspan><tspan y="-129.00455" x="58.620926 60.716125 65.439323 67.658722 70.248924 75.431122 82.008324 87.127525 91.679726 96.933929 101.65713 106.78532 111.33752 116.45673 121.88193 127.61313 132.88533 138.31053 143.91573 150.42093 154.96233 159.76472 164.93613 170.35052 176.02592 180.73833 185.95653 187.63683 189.85623 195.13654 199.81744 204.97894 207.07954 212.60194 217.14334 221.85574 227.02715 232.48654 236.92534 238.66594 243.34685 249.10504 255.64536 262.24597 267.82596 273.66336 279.18576 281.40515 283.38696 287.40906 289.62845 294.39484 299.10724 302.46964 304.68903 309.18811 311.4075 316.03891 320.4993 322.41269 324.3945 329.04391 331.26331 335.15671 339.86911 346.8045 353.7399 358.23898 362.98108 367.63049">IF (TMP_KEY_PROGRAM_STRUCT. KEYID_CTRL.COMMAND is not a valid command)</tspan><tspan y="-117.00484" x="58.620934">{</tspan><tspan y="-105.00514" x="76.681236 82.130737 86.811638 91.298141 96.878143 102.17464 106.91674 108.64924 113.80804 118.55553 120.77493 125.87614 128.09555 133.38306">RFLAGS.ZF = 1;</tspan><tspan y="-93.00544" x="76.681236 82.140633 87.720627 93.364525 95.583923 100.74542 102.96482 105.04472 110.92532 116.58723 122.22662 126.67352 128.75342 134.27132 138.80821 143.91211 149.32201 155.0379 160.2948 164.8317 169.5396 176.1015 181.6194">RAX = INVALID_PROG_CMD;</tspan><tspan y="-81.005737" x="76.681236 81.353134 86.088036 89.472939 94.20784 96.427246 101.10815 106.74934 108.85625 114.05015">goto EXIT;</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="387.53134pt" height="644.68433pt" viewBox="0 0 387.53134 644.68433" sodipodi:docname="993.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="328.02475" inkscape:cy="423.82194" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg122" /><g transform="translate(-59.981438,-69.182129)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="59.52">}</tspan><tspan y="-703.98029" x="59.52 62.158802 66.120605 68.340004 73.0812 77.883598 82.577103 86.460602 90.722099 92.941498 96.361496 101.1036 105.6027 108.9624 111.1818 114.5343 119.3367 124.0302 126.2496 131.52989 136.21078 141.37228 143.41348 148.99168 151.21109 155.85059 160.59088 162.52138 167.32378 171.96327 174.18268 178.92387 183.60297 188.29646 191.54097 196.04007 199.39977 204.14006 208.75975 210.97916 215.78156 220.40125 225.14244 229.88454 232.10394 234.08574 238.10783 240.32724 244.77774 246.99715 251.61865 256.11777 258.02127 260.00308 264.64258 266.86197 272.14227 276.82318 281.98468 284.08527 289.59778 291.81717 295.81766">(* Check that the KEYID being operated upon is a valid KEYID *)</tspan><tspan y="-691.98059" x="59.52 61.6134 66.334801 68.554199 71.142601 76.322998 82.898399 88.0158 92.5662 97.818604 102.54 107.6664 112.2168 117.33421 122.75761 128.487 133.7574 139.1403 144.77071 151.311 155.88841 160.63051 165.83791 171.2379 176.9493 181.63019 186.83759 188.51788 193.79729 198.47818 203.63158 205.75198 211.26988 213.48929 218.46898">IF (TMP_KEY_PROGRAM_STRUCT.KEYID &gt; </tspan><tspan y="-679.9809" x="113.52 118.7769 123.85381 125.9427 131.54161 136.79851 142.0554 146.6013 151.77721 158.37781 163.09471 167.64061 173.28001 177.96092 183.13683 185.22572 190.92722 196.50722 201.68312 206.40002 208.14062 214.68094 219.96123 224.46213 229.68033 236.22064 240.93755 245.48344 250.73134 255.44824 260.57013 262.65903 268.18591 272.73181 278.04272 280.13162 285.34982 290.09192 292.31131 295.13821 297.3576">2^IA32_TME_ACTIVATE.MK_TME_KEYID_BITS - 1</tspan><tspan y="-667.9812" x="77.520004 83.269203 88.669205 90.888603 96.047409 102.64801 107.78521 112.35541 117.57541 122.31661 127.41782 131.97902 137.11623 142.51624 148.21414 153.49445 158.89445 164.52031 171.06331 175.62451 180.42691 185.58571 190.97672 196.67822 201.36722 206.58542 208.25941 213.53972 218.22871 223.39021 225.49081 231.00871 233.2281 238.2231">OR TMP_KEY_PROGRAM_STRUCT.KEYID &gt; </tspan><tspan y="-655.98151" x="113.52001 115.61341 121.21681 126.43681 131.71712 136.26752 141.44792 147.98822 152.72943 157.27983 162.00124 167.60463 172.72203 178.32542 183.64082 185.73422 190.19463 192.28802 197.46843 202.59483 204.30124 210.87663 216.12903 220.67943 225.85983 232.43523 237.11613 241.66653 248.24193 253.84532 259.50272 264.05313 269.30554 273.98645 279.14795 283.92334">IA32_TME_CAPABILITY.MK_TME_MAX_KEYS </tspan><tspan y="-643.98181" x="77.520012 83.269211 88.669212 90.888611 96.047417 102.64802 107.78522 112.35542 117.57542 122.31662 127.41782 131.97902 137.11623 142.51624 148.21414 153.49445 158.89445 164.53386 171.07416 175.62001 180.42241 185.58121 190.9785 196.67999 201.37529 206.59349 208.27379 213.55409 218.24939 223.41089 225.51149 231.02939 233.24878 238.34007 243.43137 245.65076 250.93106 253.51047">OR TMP_KEY_PROGRAM_STRUCT.KEYID == 0) </tspan><tspan y="-631.98212" x="59.520012">{</tspan><tspan y="-619.98242" x="77.520012 82.969513 87.650414 92.136917 97.716919 103.01342 107.75552 109.48801 114.64681 119.39431 121.61371 126.71491 128.93433 134.22183">RFLAGS.ZF = 1;</tspan><tspan y="-607.98273" x="77.520012 82.979416 88.559418 94.199715 96.419113 101.58061 103.80001 105.87631 111.75691 117.41521 123.05461 127.49791 129.5742 135.0885 139.6218 144.8571 149.5614 154.6707 156.74699 162.26129">RAX = INVALID_KEYID;</tspan><tspan y="-595.98303" x="77.520012 82.185616 86.914215 90.292816 94.973717 97.193115 101.92171 107.58632 109.68692 114.87452">goto EXIT;</tspan><tspan y="-583.98334" x="59.520012">}</tspan><tspan y="-559.98303" x="59.520012 62.126411 66.088211 68.30761 73.047012 77.840416 82.521317 86.421021 90.719421 92.93882 96.328217 101.07032 105.55772 108.94712 111.16653 115.84743 120.64983 122.59023 127.28464 129.50403 134.24342 138.98552 143.71593 145.93532 150.37502 152.29651 156.97292 161.65381 164.93521 166.85672 170.24612 175.03952 182.00192 184.22131 186.14282 190.13971 192.35912 195.61261 200.35291 205.0014 209.8038 214.5063 218.50681 221.8683 226.6086 231.2571 233.4765 236.802 241.5135 244.767 246.9864 250.3479 255.1503 259.85281 262.0722 267.35251 272.03342 276.69992 278.78342 284.30493 286.52432 291.02344 295.76553 300.41403 302.63342 304.57294 307.93445 310.15384 312.13565 316.15775 318.36002 323.07782 327.84961 332.55841 334.7778 339.49561 342.82739 345.04678 348.41458 353.18637 357.89517 360.11456 364.58035 368.47916 371.89914 373.82065 378.45746 382.92325 386.29105 390.99985 395.65463 397.87402 402.33981 404.32071 408.97549 413.6933 416.95309 418.8989 422.26669 427.03848 433.97928 437.98608 440.20547 444.22128">(* Check that only one algorithm is requested for the KeyID and it is one of the activated algorithms *)</tspan><tspan y="-547.98334" x="59.52002 61.611618 66.331223 68.550621 71.137222 76.981827 82.664429 89.238029 93.73893 99.080429 101.17203 106.35063 111.12423 113.71083 118.88943 125.46304 130.57863 135.12723 140.37782 145.09743 150.22203 154.80032 159.90872 165.32312 171.08131 176.36162 181.77602 187.37042 193.97102 198.51242 203.27882 208.45023 213.90962 219.58502 224.29742 229.46883 231.20943 236.45282 241.16522 246.28262 248.36702 253.88942 258.43082 263.14322 268.31461 273.729 278.22809 279.92548 284.63788 290.47528 295.18768 299.7291 305.32349 309.77487 315.03629 317.61569 319.83508 321.56848 326.67688 328.89627 334.14868 336.36807 338.34988 340.27139">IF (NUM_BITS(TMP_KEY_PROGRAM_STRUCT.KEYID_CTRL.ENC_ALG) != 1 || </tspan><tspan y="-535.98364" x="77.52002 80.158821 85.317627 91.862427 97.023926 101.54372 106.82403 111.51483 116.67633 121.23753 126.33872 131.73152 137.48973 142.72954 148.18895 153.76175 160.36235 164.88216 169.68456 174.83435 180.29376 185.94756 190.68875 195.83855 197.57915 202.80095 207.54214 212.63794 214.73854 220.23933 224.80054 229.54173 234.70053 240.09334 244.52313 246.26373 251.00493 256.82074 261.56195 266.08176 271.72116 276.15097 281.43127 283.6507 289.56549">(TMP_KEY_PROGRAM_STRUCT.KEYID_CTRL.ENC_ALG &amp; </tspan><tspan y="-523.98395" x="95.52002 97.614319 103.21862 108.43862 113.71892 118.27022 123.45152 129.99182 134.73303 139.28433 144.88863 149.61093 154.79224 156.88654 162.56284 168.16713 173.34843 178.07074 179.77805 181.99745 188.57375 193.82704 198.37834 203.52002 210.10892 214.84381 219.34471 224.08591 229.48592 234.64743 239.77834 244.93713 250.68004 255.18094 260.79785 265.23666 270.52057 275.26266 277.48209 282.61298 287.74387 289.96329 295.18329 297.82208">IA32_TME_ACTIVATE. MK_TME_CRYPTO_ALGS == 0))</tspan><tspan y="-511.98425" x="59.52002">{</tspan><tspan y="-499.98456" x="77.52002 82.969521 87.650421 92.136925 97.716927 103.01343 107.75552 109.48802 114.64682 119.39432 121.61372 126.71492 128.93433 134.22183">RFLAGS.ZF = 1;</tspan><tspan y="-487.98486" x="77.52002 82.979416 88.559418 94.185318 96.404716 101.56622 103.78561 105.84751 111.72811 117.37201 123.01141 127.44031 129.54091 135.0408 139.60201 144.2919 150.1725 154.8624 159.4236 165.063 169.5018 174.7821">RAX = INVALID_ENC_ALG;</tspan><tspan y="-475.98517" x="77.52002 82.185623 86.914223 90.292824 94.973724 97.193123 101.92172 107.58632 109.68692 114.87452">goto EXIT;</tspan><tspan y="-463.98547" x="59.52002">}</tspan><tspan y="-451.98578" x="59.52002 62.126419 66.088219 68.307625 73.506027 76.747833 81.44223 83.661629 87.051025 91.790428 94.009834 98.449539 102.34924 107.02564 111.76775 113.73515 116.97695 121.70735 123.92675 128.60765 133.40555 137.32594 139.26634 144.05974 148.02153 149.98894 154.60774 159.33815 161.55754 163.49794 168.17883 172.09923 176.39763 178.61702 182.65442">(* Try to acquire exclusive lock *)</tspan><tspan y="-439.98608" x="59.52002 61.622421 66.352821 68.57222 71.169617 77.025017 82.76342 87.95282 90.172218 95.433617 100.11452 105.24992 109.75082 114.94022 120.55261 125.87701 130.34642 135.07681 139.57771 144.04712 149.74503 154.47543 159.69543 161.41083 167.02322 171.75363 177.51363 183.20703 185.30943 190.74184 195.47223 198.06963 205.38303 210.81543 212.91783 218.10724 222.83765 225.43504">IF (NOT KEY_TABLE_LOCK.ACQUIRE(WRITE))</tspan><tspan y="-427.98639" x="59.52002">{</tspan><tspan y="-415.98669" x="77.52002 80.673622 83.792122 88.893326 93.634521 99.33242 105.15362 109.90022 112.01881 117.31441 119.53381 122.83321 127.33231 129.25381 131.17532 135.97592 139.21773">//PCONFIG failure</tspan><tspan y="-403.987" x="77.52002 82.96862 87.648621 92.134224 97.713326 103.00893 107.75012 109.48172 114.63962 119.38622 121.60471 126.70502 128.92352 134.21013">RFLAGS.ZF = 1;</tspan><tspan y="-391.9873" x="77.52002 82.96862 88.547722 94.188026 96.406525 101.54913 103.76762 109.28463 113.96463 119.66523 121.78383 126.46383 131.20413 135.77974 141.06004 146.76964 151.57024 156.67053">RAX = DEVICE_BUSY;</tspan><tspan y="-379.98761" x="77.52002 82.185623 86.914223 90.292824 94.973724 97.193123 101.92172 107.58632 109.68692 114.87452">goto EXIT;</tspan><tspan y="-367.98792" x="59.52002">}</tspan><tspan y="-343.98761" x="59.52002 62.158821 66.120628 68.340027 72.839127 77.520027 81.403526 85.722626 87.942024 89.872528 93.89463 96.114029 100.61313 104.51283 109.15233 113.95473 115.88522 119.18732 123.88083 128.55992 130.77933 135.22983 140.03223 144.67172 146.89113 151.21024 155.89113 160.54863 162.76804 166.12053 170.61963 175.25912 177.16263 181.90292 184.12233 191.04784 193.02963 194.93314 196.83664 199.05605 203.73514 208.41603 210.63544 215.43784 220.05753 224.73662 229.17632 232.52881 237.2691 241.9086 244.12801 248.62711 252.6492 254.86861 259.50812 264.24844 267.49295 269.71234 273.06485 277.86725 282.56076 284.78015 288.66367 293.40488 300.36548 307.26578 311.76489 316.50699 321.1861">(* Lock is acquired and key table will be updated as per the command </tspan><tspan y="-331.98792" x="77.52002 82.83812 87.553223 90.891327 95.615425 98.881523 103.59663 105.81602 109.19012 113.96822 115.92033 119.93343 122.15282 126.81393 131.53802 133.49013 138.26823 141.64233 143.86174 148.63985 153.30002 155.51942 159.41913 164.22153 168.66122 173.46362 178.08331 182.82361 186.86101 189.08041 192.44012 197.12102 199.34042 202.73883 207.48093 212.22032 214.43973 218.69943 223.38033 228.08372 230.30313 233.70154 238.14124 242.82663 244.74814 249.42903 251.64844 256.14484 259.38663 264.06754 266.28693 273.25833 277.75473 282.37442 287.11472 289.33411 293.3562">Before this point no changes to the key table are made *)</tspan><tspan y="-307.98761" x="59.52002 63.534019 70.482018 72.43502 75.81002 79.716019 84.495018 87.087021 92.271019 98.811325 103.91253 108.46653 113.72253 118.40343 123.56493 128.06583 133.22733 138.65433 144.38733 149.66133 155.08833 160.69533 167.23563 171.78963 176.56863 181.75264 187.14001 192.83072 197.55843 202.74513 204.45784 209.71654 214.39745 219.53015 221.62985 227.16756 231.72426 236.40517 241.62337 247.05307 251.51978 253.23248 257.91336 263.64905 270.18933 276.77103 282.38074 288.23343 293.77112">switch(TMP_KEY_PROGRAM_STRUCT.KEYID_CTRL.COMMAND)</tspan><tspan y="-295.98792" x="59.520012">{</tspan><tspan y="-283.98822" x="59.520012 63.419712 67.886414 71.894112 76.603813 78.823212 84.072914 88.791611 93.953117 96.053719 101.58242 106.13012 110.90282 115.62152 120.79922 125.34692 130.59662 135.31532 140.43903 144.98672 150.51543 152.60612 158.02682 162.74553 167.46423 172.64194">case KEYID_SET_KEY_DIRECT:</tspan><tspan y="-271.98853" x="77.520012 82.548309 87.576607 94.881905 98.146202 100.0965 103.4688 108.18211">&lt;&lt;Write </tspan><tspan y="-259.98883" x="95.520012 101.05231 106.65662 111.83791 117.44221 121.99352 127.24682 131.92862 137.09102 142.20932 147.39062 153.96692 159.08522 163.63652 168.88982 173.61212 178.68001 183.25471 188.35591 193.80362 199.50151 204.7962 210.1962 215.8239 222.3642 226.9389 231.681 236.8857 242.28571 247.9944 252.67529 257.88 259.5603 264.83701 269.51791 274.66861 279.16953 283.91522 286.03293 290.77863 295.21744 300.73532 305.29654 310.51654">DATA_KEY=TMP_KEY_PROGRAM_STRUCT.KEY_FIELD_1,</tspan><tspan y="-247.98914" x="95.520012 100.72651 107.98681 112.73431 118.31431 123.59281 128.16931 133.38931 138.13051 143.2317 148.3329 153.5394 160.0797 165.18089 169.7421 175.0206 179.70149 184.85399 189.35489 194.49838 199.89838 205.59627 210.87656 216.32605 221.90605 228.44635 233.00755 237.80905 242.96785 248.36784 254.06934 258.81683 263.97565 265.65598 270.93628 275.61719 280.77869 285.35519 290.0361 292.15561 296.90311 301.34192 306.8598 311.43631 316.72382">TWEAK_KEY=TMP_KEY_PROGRAM_STRUCT.KEY_FIELD_2,</tspan><tspan y="-235.98944" x="95.520012 100.26122 106.08242 110.82362 116.22363 121.38512 126.48632 131.63072 133.73132 139.48953 145.31073 149.87193 156.41223 162.17044 167.68835 172.37375 177.53525 182.22064 188.10124 192.78664 198.23972 203.37062 208.49252 213.67743 218.17833 225.48723 227.58513 232.77003 238.62094 243.12184 248.40215 253.12805 258.25894 260.35684 265.89273 270.44763 275.66763 280.39352 285.52441">ENCRYPTION_MODE=ENCRYPT_WITH_KEYID_KEY,</tspan><tspan y="-223.98975" x="95.52002 98.940025 103.62093 105.84033 112.44093 117.66093 122.87914 129.41943 134.13004 136.34944 141.59103 146.33133 150.99693 153.21634 156.57693 161.03554 165.68314 167.59474 172.29634 174.51575 179.01485 182.37454 184.59395 186.53255 191.33495 195.98254 200.68414 205.45775 207.67715 212.84676 219.44736 224.55396 229.09355 234.33514 239.04575 244.16135 248.70094 253.80754 259.22015 264.97836 270.25867 275.67126 281.26385 287.86447 292.40408 297.16867 302.33826 307.79767 313.47128 318.18188 323.35147 325.09207 330.33368 335.04428 340.15988 342.24249">to MKTME Key table at index TMP_KEY_PROGRAM_STRUCT.KEYID</tspan><tspan y="-211.99005" x="77.52002 82.55912">&gt;&gt;</tspan><tspan y="-199.99036" x="77.52002 82.20092 85.486816 90.221718 94.661415 98.964317">break;</tspan><tspan y="-175.99005" x="59.52002 63.409821 67.90892 71.906723 76.606522 78.825928 84.106224 88.787125 93.948624 96.049225 101.56802 106.10583 110.90823 115.64943 120.81723 125.35503 130.59483 135.30363 140.41743 144.95523 150.36603 156.00543 161.83923 167.35803 173.11623 179.65652">case KEYID_SET_KEY_RANDOM:</tspan><tspan y="-163.99036" x="77.52002 82.719322 89.259621 94.39592 98.965218 104.40752 110.22872 115.77902 120.34832 125.89862 131.47862 136.67792 142.25792 146.82722 152.04723 156.78752 161.88872 164.10811 169.24442 171.46381 176.5101 181.5564 186.8457 191.5266 196.32899 201.0099 204.31201 208.75171 212.11142 216.84271 219.0621 223.5018 225.72119 229.00349 233.44319 238.23749 242.85719 247.59749 254.49779 256.71719 261.01648 265.69736 270.39267 272.61209 277.4064 281.36819 283.33649 288.07861 292.75592 294.97534 299.76965 304.20935 307.45114 312.13025 319.09354 323.53323 326.81552 331.4964 333.71582 339.11581 344.9964 350.21732 355.25641">TMP_RND_DATA_KEY = &lt;&lt;Generate a random key using hardware RNG&gt;&gt;</tspan><tspan y="-151.99066" x="77.52002 79.628723 84.365425 86.584831 89.18853 95.009735 100.75443 105.91323 108.13264 112.86934 118.69054 124.43524 130.07645 135.36215 141.18335 143.40274 148.13943 153.96063 159.15633 164.55634 170.25424 175.41574 180.51694">IF (NOT ENOUGH ENTROPY)</tspan><tspan y="-139.99097" x="77.52002">{</tspan><tspan y="-127.99126" x="95.52002 100.96952 105.65042 110.13692 115.71693 121.01343 125.75552 127.48802 132.64682 137.39432 139.61372 144.71492 146.93433 152.22183">RFLAGS.ZF = 1;</tspan><tspan y="-115.99156" x="95.52002 100.97942 106.55943 112.19792 114.41732 119.57883 121.79823 126.50072 132.38133 137.54283 142.94733 148.70552 153.80672 158.91422 163.44571 168.14821 173.5527 178.9572 184.71539 190.11989">RAX = ENTROPY_ERROR;</tspan><tspan y="-103.99186" x="95.52002 100.18562 104.91422 108.29282 112.97372 115.19312 119.92172 125.58632 127.68692 132.87453">goto EXIT;</tspan><tspan y="-91.992157" x="77.52002">}</tspan><tspan y="-79.992455" x="77.52002 82.722023 89.262321 94.401321 98.97332 104.41832 110.23952 115.79252 120.36452 125.52332 132.84302 137.52391 143.16331 148.38332 152.94452 158.16452 162.90572 168.05371 170.2731 175.41211 177.6315 182.61119 187.65028 192.94229 197.62318 202.42018 207.15417 210.39598 214.83568 218.22868 222.90958 225.12897 229.56866 231.78806 235.07306 239.51276 244.30975 248.92944 253.67244 260.63843 262.85782 267.11752 271.85782 276.47751 278.6969 283.4939 287.52591 289.44742 294.24982 298.86951 301.0889 305.88589 310.32559 313.6106 318.23029 325.19629 329.63599 332.92099 337.6019 339.82129 345.2663 351.08749 356.37949 361.4285">TMP_RND_TWEAK_KEY = &lt;&lt;Generate a random key using hardware RNG&gt;&gt;</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="313.57941pt" height="620.14709pt" viewBox="0 0 313.57941 620.14709" sodipodi:docname="994.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="347.21931" inkscape:cy="391.10563" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg112" /><g transform="translate(-45.585518,-69.182129)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-715.97998" x="76.68 78.7761 83.500198 85.719597 88.310699 94.159798 99.857697 105.01649 107.23589 111.95999 117.80909 123.54119 129.18239 134.45549 140.3046 142.524 147.24811 153.09721 158.28032 163.70642 169.43852 174.55862 179.68773">IF (NOT ENOUGH ENTROPY)</tspan><tspan y="-703.98029" x="76.68">{</tspan><tspan y="-691.98059" x="94.68 100.1295 104.8104 109.29691 114.87691 120.17341 124.9155 126.648 131.80681 136.55431 138.77371 143.87491 146.09431 151.38182">RFLAGS.ZF = 1;</tspan><tspan y="-679.9809" x="94.68 100.1394 105.71941 111.35791 113.57731 118.73882 120.95821 125.66071 131.54132 136.70282 142.10732 147.86551 152.96671 158.0742 162.6057 167.3082 172.71269 178.11719 183.87538 189.27988">RAX = ENTROPY_ERROR;</tspan><tspan y="-667.9812" x="94.68 99.351898 104.0868 107.4717 112.2066 114.42601 119.10691 124.74811 126.85501 132.0489">goto EXIT;</tspan><tspan y="-655.98151" x="76.68">}</tspan><tspan y="-643.98181" x="76.68 79.318794 83.340889 85.560287 92.119484 94.10128 98.869476 101.08887 105.89127 109.91338 114.60957 117.85677 120.07617 124.07037 128.87277 133.51497 138.19406 140.10027 142.08206 146.77826 151.45735 153.67676 158.37296 163.17535 166.53055 169.77774 174.51894 179.13863 183.79883 186.01823 189.43823 194.11913 196.33853 199.69373 204.49612 209.19232 211.41173 216.09082 220.53052 223.95052 228.39021 230.60962 234.87383 239.61412 244.27432 246.49373 250.94693 255.74933 260.39154 262.61093 266.03091 272.93121 277.67151 282.11121 286.3754 288.59479 292.91388 297.59479 302.25497 304.47437 308.47757">(* Mix user supplied entropy to the data key and tweak key *)</tspan><tspan y="-631.98212" x="76.68 81.891899 88.432205 93.533409 98.094612 103.54951 109.37071 114.88861 119.44981 124.96771 130.54771 135.75961 141.33961 145.92151 151.14151 155.89441 160.99561 163.21501 168.31621 170.53561 175.74751 182.28781 187.43671 191.93761 197.3925 203.2137 208.7316 213.29279 218.51279 223.25398 228.35518 230.57458 236.26349 241.96138 247.36137">TMP_RND_DATA_KEY = TMP_RND_KEY XOR </tspan><tspan y="-619.98242" x="94.68 99.898201 106.4385 111.5496 116.0937 121.3398 126.0549 131.2164 135.7776 140.8887 146.3058 152.0289 157.293 162.7524 168.3324 174.9015 179.4456 184.21471 189.38881 194.80591 200.48401 205.19911 210.37321 212.11382 217.32031 222.04532 227.17532 231.72932 236.41023 238.50723 243.23224 247.69624 253.23125 257.78525 263.05026 264.76025 270.07925 275.20926 280.39325 285.07416 289.87656 292.63956 297.85956 303.12457 304.87958 310.14459 312.90759">TMP_KEY_PROGRAM_STRUCT.KEY_FIELD_1.BYTES[15:0];</tspan><tspan y="-607.98273" x="76.680008 81.898209 88.438507 93.543304 98.081108 103.5405 109.3617 114.8805 119.4183 124.58611 131.8779 136.5867 142.2261 147.46591 152.00371 157.24352 161.95232 167.11382 169.33322 174.43802 176.65742 181.82523 188.46001 193.59361 198.16022 203.56023 209.38142 214.92902 219.49562 224.69221 231.95251 236.69011 242.27011 247.53871 252.03961 257.30823 262.04584 267.14703 269.36642 275.04004 280.78564 286.18564">TMP_RND_TWEAK_KEY = TMP_RND_TWEAK_KEY XOR </tspan><tspan y="-595.98303" x="94.680008 99.898209 106.43851 111.54961 116.0937 121.33981 126.05491 131.2164 135.7776 140.8887 146.3058 152.0289 157.293 162.7524 168.3324 174.9015 179.4456 184.21471 189.38881 194.80591 200.48401 205.19911 210.37321 212.11382 217.32031 222.04532 227.17532 231.72932 236.41023 238.50723 243.23224 247.69624 253.23125 257.78525 263.05026 264.76025 270.07925 275.20926 280.39325 285.07416 289.87656 292.63956 297.85956 303.12457 304.87958 310.14459 312.90759">TMP_KEY_PROGRAM_STRUCT.KEY_FIELD_2.BYTES[15:0];</tspan><tspan y="-571.98273" x="76.680008 81.708305 86.736603 94.041901 97.306198 99.2565 102.6288 107.3421">&lt;&lt;Write </tspan><tspan y="-559.98303" x="94.680008 100.23931 105.81931 110.97811 116.61752 121.11842 126.39871 131.07961 136.2411 141.3423 146.5011 153.1044 158.2056 162.78389 168.18031 174.05461 179.57161 184.1499 189.6669 195.246 200.4039 206.0352 210.5352 215.81551 220.4955 225.6498 227.448">DATA_KEY=TMP_RND_DATA_KEY, </tspan><tspan y="-547.98334" x="94.680008 99.898209 107.15851 111.8997 117.47971 122.76001 127.32121 132.55292 137.29411 142.39981 147.49651 152.71471 159.255 164.3517 168.88139 174.34079 180.16199 185.67268 190.20238 195.36208 202.68178 207.38248 213.02188 218.25359 222.78328 228.01498 232.75618 237.86188">TWEAK_KEY=TMP_RND_TWEAK_KEY,</tspan><tspan y="-535.98364" x="94.680008 99.404106 105.2532 109.9773 115.4034 120.5325 125.6526 130.83571 132.93181 138.66391 144.51302 149.06612 155.60641 161.33852 166.87262 171.59673 176.71683 181.39774 187.27834 191.95924 197.3997 202.53061 207.65251 212.83742 217.33832 224.64722 226.74512 231.93002 237.78093 242.28183 247.56213 252.28804 257.41895 259.51685 265.05273 269.60764 274.82764 279.55353 284.68442">ENCRYPTION_MODE=ENCRYPT_WITH_KEYID_KEY,</tspan><tspan y="-523.98395" x="94.680008 98.064911 102.74581 104.96522 111.55412 116.77412 121.96802 128.50832 133.24321 137.80711 143.02711 147.76831 152.90822 157.47212 162.66602 168.28291 173.61182 178.08572 182.82062 185.04001 189.47971 192.8997 195.11909 197.0406 201.843 206.46271 211.20302 215.94061 218.0997 223.29089 229.83119 234.9594 239.5206 244.7838 249.46469 254.6019 259.10278 264.23099 269.66519 275.3631 280.6434 286.07761 291.6918 298.23212 302.7933 307.5795 312.77069 318.2049 323.90009 328.63229 333.82349 335.50378 340.78409 345.5163 350.6535 352.75769">to MKTME_KEY_TABLE at index TMP_KEY_PROGRAM_STRUCT.KEYID</tspan><tspan y="-511.98425" x="76.680008 81.719109">&gt;&gt;</tspan><tspan y="-499.98456" x="76.680008 81.360909 84.646805 89.381706 93.821404 98.124306">break;</tspan><tspan y="-475.98425" x="58.619705 62.519405 66.986107 70.993805 75.703506 77.922905 83.172607 87.891312 93.015015 95.105713 100.63441 105.18211 109.90082 114.35852 119.07722 124.67793 130.09863 134.64633 139.89603 144.61473 149.73843">case KEYID_CLEAR_KEY:</tspan><tspan y="-463.98456" x="76.680008 81.720009 86.76001 94.077011 97.353012 99.31501 102.69901">&lt;&lt;Write</tspan><tspan y="-451.98486" x="76.680008 82.244705 87.824707 92.983505 98.62291 103.12381 108.40411 113.08501 118.24651 123.34771 124.9668 130.26151">DATA_KEY='0,</tspan><tspan y="-439.98517" x="76.680008 81.888306 89.148605 93.897903 99.477905 104.75821 109.33651 114.5565 119.2977 124.3989 129.50009 131.17139 136.39139">TWEAK_KEY='0,</tspan><tspan y="-427.98547" x="76.680008 81.405006 87.255005 91.980003 97.407005 102.537 107.658 112.842 114.939 120.672 126.522 131.076 137.6163 143.3493 148.88431 153.60931 155.82872 160.94972 163.16913 167.85004 173.73064 178.41154 183.87094 189.00095 194.12195 199.30595 203.76001 211.07071 213.17041 218.35712 224.20982 228.71072 233.92892 240.46922 245.21043 249.76714 255.02583 259.75354 264.79532 269.35202 275.08771 280.5174 285.01831 290.34 295.47269 300.59637 306.20609 310.98779 315.7695">ENCRYPTION_MODE = ENCRYPT_WITH_TME_KEY_OR_BYPASS,</tspan><tspan y="-415.98578" x="76.680008 80.067612 84.748512 86.967918 93.559517 98.779518 103.97612 110.51642 115.25402 119.75492 125.02352 129.76112 134.90372 139.47032 144.66692 150.28651 155.61812 160.09471 164.83231 167.0517 171.49139 174.8511 177.0705 179.0361 183.8277 188.4474 193.18771 197.92531 200.0997 205.3098 211.8501 216.95129 221.51248 226.79459 231.47548 236.63158 241.13248 246.27957 251.67957 257.37747 262.65778 268.11087 273.69086 280.23117 284.79239 289.5975 294.75632 300.15631 305.85782 310.60892 315.76773 317.44806 322.72836 327.40927 332.57077 334.69388">to MKTME_KEY_TABLE at index TMP_KEY_PROGRAM_STRUCT.KEYID</tspan><tspan y="-403.98608" x="76.68 81.719101">&gt;&gt;</tspan><tspan y="-379.98578" x="76.68 81.360901 84.646797 89.381699 93.821396 98.124298">break;</tspan><tspan y="-367.98608" x="58.619698 62.522999 66.993301 71.004601 75.685501 77.9049 83.158203 88.690506 93.241806 99.089104 104.787 109.34821 114.0705 119.9178 124.6401 130.06439 135.1917 140.31 145.4913">case KD_NO_ENCRYPT:</tspan><tspan y="-355.98639" x="76.68 81.708298 86.736595 94.041893 97.30619 99.256493 102.62879 107.34209">&lt;&lt;Write </tspan><tspan y="-343.98669" x="76.68 81.402298 87.249596 91.971893 97.396194 102.5235 107.6418 112.8231 114.9174 120.6477 126.495 131.0463 137.58749 143.31779 148.8501 153.5724 158.6907 164.53801 170.26831 174.77011 179.51222 185.35953 190.08183 195.50613 200.63344 205.75174 210.93304 213.02734 218.75764 224.60495">ENCRYPTION_MODE=NO_ENCRYPTION,</tspan><tspan y="-331.987" x="76.68 80.067604 84.748505 86.967911 93.559509 98.77951 103.97611 110.51641 115.25401 119.75491 125.02351 129.76111 134.9037 139.47031 144.6669 150.2865 155.6181 160.0947 164.83229 167.05168 171.49138 174.85109 177.07048 179.03609 183.82768 188.44739 193.1877 197.92529 200.0997 205.3098 211.8501 216.95129 221.51248 226.79459 231.47548 236.63158 241.13248 246.27957 251.67957 257.37747 262.65778 268.11087 273.69086 280.23117 284.79239 289.5975 294.75632 300.15631 305.85782 310.60892 315.76773 317.44806 322.72836 327.40927 332.57077 334.69388">to MKTME_KEY_TABLE at index TMP_KEY_PROGRAM_STRUCT.KEYID</tspan><tspan y="-319.9873" x="76.68 81.719101">&gt;&gt;</tspan><tspan y="-307.98761" x="76.68 81.360901 84.646797 89.381699 93.821396 98.124298">break;</tspan><tspan y="-295.98792" x="58.619698">}</tspan><tspan y="-271.98761" x="58.619698 64.083595 69.663589 75.304787 77.524193 82.682091 84.901497 90.121498">RAX = 0;</tspan><tspan y="-259.98792" x="58.619698 64.069199 68.750099 73.236603 78.816605 84.113106 88.855202 90.5877 95.746498 100.494 102.71339 107.8146 110.034 115.3215">RFLAGS.ZF = 0;</tspan><tspan y="-235.98761" x="58.619698 61.784096 64.902596 70.302597 75.042892 76.964386 81.645287 86.150688 90.112488 94.860886 97.080284 101.51908 106.26028 110.15999">//Release Lock</tspan><tspan y="-223.98792" x="58.619698 63.872997 68.595299 73.722603 78.273903 83.4552 89.059502 94.375801 98.837105 103.5594 108.1107 112.57201 118.26991 122.9922 128.2122 130.8015 136.2258 140.9481 145.40941 150.13171 155.73601 160.47812 165.21933 167.80862">KEY_TABLE_LOCK(RELEASE);</tspan><tspan y="-199.98761" x="58.619698 63.353699 69.023697 71.1297 76.322701">EXIT:</tspan><tspan y="-187.98792" x="58.619698 64.069199 68.750099 73.236603 78.816605 84.113106 88.855202 90.5877 95.2686 100.0161 105.1173 110.4048">RFLAGS.CF=0;</tspan><tspan y="-175.98822" x="58.619698 64.069199 68.750099 73.236603 78.816605 84.113106 88.855202 90.5877 95.688904 100.4364 105.53761 110.8251">RFLAGS.PF=0;</tspan><tspan y="-163.98853" x="58.619698 64.069199 68.750099 73.236603 78.816605 84.113106 88.855202 90.5877 96.167702 100.9152 106.0164 111.3039">RFLAGS.AF=0;</tspan><tspan y="-151.98883" x="58.619698 64.069199 68.750099 73.236603 78.816605 84.113106 88.855202 90.5877 96.285599 101.0331 106.1343 111.4218">RFLAGS.OF=0;</tspan><tspan y="-139.98914" x="58.619698 64.069199 68.750099 73.236603 78.816605 84.113106 88.855202 90.5877 95.329796 100.07729 105.1785 110.466">RFLAGS.SF=0;</tspan><tspan y="-127.98943" x="45.119698">}</tspan><tspan y="-103.98914" x="45.119698 49.823097 54.625496 59.274895 63.816296 68.557495 71.856895 76.398293 79.757095 81.670494 86.411697">end_of_flow</tspan></text></g></svg><br/><br/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="503.42581pt" height="577.20343pt" viewBox="0 0 503.42581 577.20343" sodipodi:docname="995.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.47141" inkscape:cy="333.75505" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg116" /><g transform="translate(-46.146446,-69.112849)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-715.31989" x="46.02 52.081657 55.503914 60.903229 64.864326 70.469818 75.039467 79.000565 84.580154 90.205566 92.725449 100.42254 106.02803 111.65344 117.25893 119.77881 125.29765 130.58043 135.01959 140.59918 146.05927 150.02036 152.53824 158.14372 163.88866">Protected Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-700.97998" x="46.02 53.371201 60.3354 65.7948 69.873604 75.586807 79.66201 138.16562 141.94382 145.10101 147.92522 150.38042 156.06662 161.66283 167.34903 170.88423 173.70844 178.86993 184.27353 186.72873 192.41493 197.76813 200.59233 203.04753 208.73373 211.55794 217.23514 223.41904 229.57324 232.45685 237.81004 243.49625 248.17445 253.62665 259.22284 264.57605 269.25424 272.13782 277.53601 283.2222 286.04639 291.73257 297.41876 302.09695 307.78314 313.37933 318.97552 324.42773 328.25995 331.79514 337.14835 342.78775 345.61194 348.06714 353.42035 358.81854 361.46274">#GP(0) If input value in EAX encodes an unsupported leaf.</tspan><tspan y="-687.00031" x="138.11971 141.8961 145.0515 147.87569 151.65208 157.83598 163.54738 169.25877 175.02147 180.55287 188.12727 193.80267 199.51407 205.65747 211.92686 217.45827 221.23466 227.11797 232.76187 238.29327 243.96867 246.85226 254.42667 260.57007 266.81247 269.69604 272.14944 276.82584 279.65002 285.33441 290.78482 294.31821 297.1424 299.59579 305.0462 309.7226 314.9444 320.29581 325.93521">If IA32_TME_ACTIVATE MSR is not locked.</tspan><tspan y="-673.02063" x="138.11971 141.9006 145.0605 147.8847 153.57361 158.9745 162.8094 168.40831 175.66501 181.0686 184.9035 190.3062 193.1304 198.4863 204.1752 208.85611 212.69101 218.01091 223.60982 227.14772 229.60562 235.06052 240.74942 243.57362 248.97452 254.66342 260.26233 263.14594 270.72482 276.95374 282.48962 290.06851 295.74841 298.63202 303.31293 308.71384 314.31274 319.71365 325.31256 327.77045 330.22833 332.68622 336.11969 341.4342 344.31781 349.71332 353.54282 358.89331 361.77692 367.46042 372.90991 376.44241 379.32602 384.67651 390.36002 395.75552 401.34903 403.80154 409.15204 414.79144 417.61566 420.06818 425.75168 428.5759 432.35141 438.4939 444.20441 449.91492 455.62543 461.20361 468.7771 474.4516 480.16211 486.3046 492.57309 498.10358 501.87909 507.76239 513.40631 518.92426 524.59875 527.42297 535.04504 541.16864 547.41016">If hardware encryption and MKTME capability are not enabled in IA32_TME_ACTIVATE MSR.</tspan><tspan y="-658.98065" x="138.11969 141.89609 145.05148 147.87567 151.40907 157.09348 162.44487 165.32846 174.07286 179.42426 188.16866 193.61905 197.44945 202.76485 205.64844 211.09883 216.73824 222.08963 225.75172 231.14812 236.83252 242.47192 245.29611 247.74951 252.42592 255.25011 260.93451 266.38492 269.9183 272.74249 278.50519 284.21658 289.92798 296.08939 298.91357 304.37747 306.77417 309.22757 314.82196 320.50635 325.85776 331.49716">If the memory operand is not 256B aligned.</tspan><tspan y="-645.00098" x="138.11969 141.90329 145.06589 147.89009 153.29369 158.93579 164.25839 167.142 172.59959 175.76219 178.6458 182.1864 187.87801 193.2366 196.06081 199.89841 205.257 209.9406 215.29919 219.1368 224.3586 229.71719 235.31879 238.14299 243.7446 246.1413 249.6819 254.36549 257.24908 259.70969 265.35178 268.1994 275.7702 281.991 287.5188 295.1409 300.81271 306.52051 312.7413 318.41312 323.93192 329.63971 335.09912 341.33612 348.40292 355.36172 361.60052 367.74033 375.36243 381.06482 387.20462 392.78284 399.02164 405.59344 411.85925 417.38705 420.27066 425.66345 429.49026 434.83807 437.66229 442.33508 447.73779 451.26758">If any of the reserved bits in MKTME_KEY_PROGRAM_STRUCT are set.</tspan><tspan y="-631.0213" x="138.11969 141.89609 145.05148 147.87567 153.27206 156.15565 164.90005 170.30275 179.04715 184.49754 188.32794 193.64334 196.46753 201.91792 207.55733 212.90872 216.57082 221.96721 227.65161 233.24602 236.12961 241.481 244.6364 247.79179 253.14319 257.81958 261.35297 263.80637 269.02817 274.37958 277.26318 282.65958 288.25397 293.84836 297.67877 303.06 307.73819 312.41638 315.24057 317.69577 322.37396 325.19815 330.65036 336.33655 339.87173 344.54993 347.00513 352.60132 358.00403 360.82822 364.3634 370.04959 375.4028 378.28638 385.21457 391.35977 394.18396 398.86215 404.21536 409.81155 418.55774 423.96045 429.66193 433.19711 436.0213 438.4765 440.9317 449.67792 452.13312 455.6683">If a memory operand effective address is outside the DS segment limit.</tspan><tspan y="-616.98132" x="46.019989 53.37569 58.796391 63.965092 68.044792 71.20649 76.609192 82.251289 84.70739 88.067093 92.145889 96.82859 102.28529 107.88599 113.2887 117.36839 138.13229 141.91499 145.07669 147.90089 153.30359 156.18719 161.7879 167.1906 172.79129 178.19398 181.01819 184.17989 189.58258 195.27328 197.66998 201.20969 204.09329 209.54999 214.23268 218.91537 224.60608 228.44278 233.12547 235.94968 238.40938 244.10008 246.92429 252.32698 257.00967 261.69238 267.09509 271.7778 276.46051 278.85721 284.54791 290.14862 292.97284 301.72354 307.08124 315.83194 321.28864 325.12534 330.44702 333.33063 338.78732 344.38803 349.74573 353.46814 358.87085 364.51294 370.11365 374.79636">#PF(fault-code) If a page fault occurs in accessing memory operands.</tspan><tspan y="-603.00165" x="46.019989 53.368488 59.942989 66.868492 138.1521 141.9276 145.08209 147.90628 153.30179 158.94389 164.25839 167.14198 172.59148 175.74597 178.62956 182.16206 187.84557 193.19606 196.02025 200.94324 208.02264 214.29114 220.51463 224.58713 230.82863 236.50313 241.91663 245.98912 253.08029 259.20389 262.98477 269.16687 274.80359 278.88239 285.06628 290.77139 296.8905 299.77408 305.3541 309.1962 314.5386 317.72281 320.17889 325.34039 330.7215 335.40152 338.22571 343.65179 347.5119 352.89301 355.71719 361.4313 366.1113 371.4537 377.03372">#UD If any of the LOCK/REP/OSIZE/VEX prefixes are used.</tspan><tspan y="-589.02197" x="138.12059 141.89969 145.05779 147.88199 152.5611 158.2482 162.0813 165.9144 171.26849 176.9556 180.4917 183.37531 188.97241 192.80551 195.26161 200.57971 203.03581 205.49191 210.84601 216.44312 221.84581 224.67001 227.12611 232.48021 237.70201 243.10471 245.5014 248.38501 250.84111 255.5202 258.34442 264.03152 269.48462 273.02072 275.84494 281.60767">If current privilege level is not 0.</tspan><tspan y="-574.98199" x="138.12059 141.89519 145.04878 147.87297 154.14056 159.55316 166.12675 169.90135 176.62616 179.86795 185.57755 188.87964 194.58923 198.66083 204.33443 211.25903 217.40964 221.48123 227.12064 229.51733 233.04893 235.93253 241.64212 247.35172 251.42331 254.3069 261.65451 264.53812">If CPUID.7.0:EDX[bit 18] = 0</tspan><tspan y="-561.00232" x="138.12059 141.91859 145.0956 147.9198 150.39481 156.1008 158.925 165.09 172.65179 178.82579 181.64999 187.35599 192.82799 198.53398 202.62898 206.48099 211.88188 217.35388 220.90887 223.79248 232.55849 238.03049 243.61049 248.9529 251.8365 257.25452 262.89661 268.5126 271.33679 277.5018 285.0636 291.35458 297.35849 300.64349 306.04349 312.33447 319.42648 326.16748 331.35147 335.14948 342.10559 347.80798 353.50497 360.24597 366.41098 372.53461 377.55661 383.1933 386.07687 393.39389 396.27747 401.97986">If in VMX non-root mode and VMCS.PCONFIG_ENABLE = 0.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-535.32001" x="46.02 52.198189 57.777782 63.078495 65.580444 68.650116 75.036469 80.676819 86.256416 89.738434 95.377785 100.12074 104.86369 107.38357 115.0448 120.68415 126.2737 131.91306 134.37317 139.95175 145.17378 149.61296 155.2523 160.65262 164.67346 167.15549 172.79483 178.50391">Real-Address Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-520.97998" x="46.02 53.373901 60.340801 65.759705 138.12331 141.90421 145.0641 147.88831 150.34621 156.03511 161.63402 167.32292 170.86082 173.68503 178.84653 184.25012 186.70802 192.39693 197.75282 200.57703 203.03493 208.72383 211.54803 217.22794 223.37584 229.53275 232.41635 237.77225 243.48001 248.15912 253.61221 259.20932 264.56342 269.24252 272.12613 277.52524 283.21234 286.03656 291.72366 297.41077 302.08987 307.77698 313.37408 318.97119 324.42429 328.25739 331.79349 337.14758 342.78699 345.61121 348.06729 353.42139 358.8205 361.46472">#GP If input value in EAX encodes an unsupported leaf.</tspan><tspan y="-507.00027" x="138.11971 141.8961 145.0515 147.87569 151.65208 157.83598 163.54738 169.25877 175.02147 180.55287 188.12727 193.80267 199.51407 205.65747 211.92686 217.45827 221.23466 227.11797 232.76187 238.29327 243.96867 246.85226 254.42667 260.57007 266.81247 269.69604 272.14944 276.82584 279.65002 285.33441 290.78482 294.31821 297.1424 299.59579 305.0462 309.7226 314.9444 320.29581 325.93521">If IA32_TME_ACTIVATE MSR is not locked.</tspan><tspan y="-492.96027" x="138.11971 141.9006 145.0605 147.8847 153.57361 158.9745 162.8094 168.40831 175.66501 181.0686 184.9035 190.3062 193.1304 198.4863 204.1752 208.85611 212.69101 218.01091 223.60982 227.14772 229.60562 235.06052 240.74942 243.57362 248.97452 254.66342 260.26233 263.14594 270.72482 276.95374 282.48962 290.06851 295.74841 298.63202 303.31293 308.71384 314.31274 319.71365 325.31256 327.77045 330.22833 332.68622 336.11969 341.4342 344.31781 349.71332 353.54282 358.89331 361.77692 367.46042 372.90991 376.44241 379.32602 384.67651 390.36002 395.75552 401.34903 403.80154 409.15204 414.79144 417.61566 420.06818 425.75168 428.5759 432.35141 438.4939 444.20441 449.91492 455.62543 461.20361 468.7771 474.4516 480.16211 486.3046 492.57309 498.10358 501.87909 507.76239 513.40631 518.92426 524.59875 527.42297 535.04504 541.16864 547.41016">If hardware encryption and MKTME capability are not enabled in IA32_TME_ACTIVATE MSR.</tspan><tspan y="-478.98056" x="138.11969 141.89699 145.05328 147.87747 153.27477 156.15836 164.90366 170.30635 179.05165 184.50294 188.33424 193.65054 196.47473 201.92603 207.56543 212.91772 216.57982 221.97711 227.66241 233.25772 236.14131 238.59561 243.27292 246.09711 251.78241 257.2337 260.76801 263.59222 269.35495 275.06726 280.77957 286.94186 289.76608 295.16339 297.61771 300.07202 305.66733 311.35263 316.70493 322.34433">If a memory operand is not 256B aligned.</tspan><tspan y="-465.00085" x="138.11969 141.90329 145.06589 147.89009 153.29369 158.93579 164.25839 167.142 172.59959 175.76219 178.6458 182.1864 187.87801 193.2366 196.06081 199.89841 205.257 209.9406 215.29919 219.1368 224.3586 229.71719 235.31879 238.14299 243.7446 246.1413 249.6819 254.36549 257.24908 259.70969 265.35178 268.1994 275.7702 281.991 287.5188 295.1409 300.81271 306.52051 312.7413 318.41312 323.93192 329.63971 335.09912 341.33612 348.40292 355.36172 361.60052 367.74033 375.36243 381.06482 387.20462 392.78284 399.02164 405.59344 411.85925 417.38705 420.27066 425.66345 429.49026 434.83807 437.66229 442.33508 447.73779 451.26758">If any of the reserved bits in MKTME_KEY_PROGRAM_STRUCT are set.</tspan><tspan y="-450.96085" x="46.019089 53.367588 59.942089 66.867592 138.1512 141.9267 145.08119 147.90538 153.30087 158.94298 164.25748 167.14107 172.59056 175.74506 178.62865 182.16115 187.84465 193.19514 196.01933 200.94232 208.02173 214.29022 220.51372 224.58621 230.82771 236.50221 241.91571 245.9882 253.07939 259.203 262.98389 269.16599 274.8027 278.8815 285.0654 290.77051 296.88962 299.77319 305.35321 309.19531 314.53772 317.72192 320.17801 325.33951 330.72061 335.4006 338.22479 343.65088 347.51099 352.89209 355.71628 361.43039 366.11038 371.45279 377.03281">#UD If any of the LOCK/REP/OSIZE/VEX prefixes are used.</tspan><tspan y="-436.98114" x="138.11969 141.89879 145.05688 147.88109 152.56018 158.24728 162.08038 165.91348 171.26758 176.95468 180.49078 183.37439 188.9715 192.8046 195.2607 200.5788 203.0349 205.491 210.84509 216.4422 221.84489 224.6691 227.1252 232.47929 237.7011 243.10379 245.50049 248.38409 250.84019 255.51929 258.34351 264.03061 269.4837 273.01981 275.84402 281.60675">If current privilege level is not 0.</tspan><tspan y="-423.00143" x="138.11969 141.89519 145.04968 147.87387 154.14236 159.55586 166.13036 169.90585 176.63066 179.87245 185.58295 188.88504 194.59554 198.66803 204.34253 211.26804 217.41954 220.72163 226.13513 232.40363 239.47313 246.19164 251.35313 255.12863 262.09012 266.16263 271.75613 274.20865 277.74115 280.56537 286.32806 292.03049 296.103 298.9866 306.33511 309.15933">If CPUID.7.0:EDX.PCONFIG[bit 18] = 0</tspan><tspan y="-408.96143" x="138.11969 141.91769 145.0947 147.9189 150.39391 156.0999 158.9241 165.0891 172.65089 178.82489 181.64909 187.35509 192.82709 198.53308 202.62808 206.48009 211.88098 217.35298 220.90797 223.79158 232.55759 238.02959 243.60959 248.952 251.8356 257.2536 262.89569 268.51169 271.33588 277.50089 285.06268 291.35367 297.35757 300.64258 306.04257 312.33356 319.42557 326.16656 331.35056 335.14856 342.10468 347.80707 353.50406 360.24506 366.41006 372.53369 377.55569 383.19238 386.07596 393.39297 396.27655 401.97894">If in VMX non-root mode and VMCS.PCONFIG_ENABLE = 0.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-383.34" x="46.02 52.492008 54.980015 58.603462 62.624317 68.339363 73.646049 76.153976 79.229622 85.353027 91.53022 97.653625 103.77703 106.29691 113.96412 119.60347 125.199 130.83836 133.29849 138.83426 144.05629 148.49545 154.13481 159.53513 163.55597 166.04398 171.68333 177.39838">Virtual-8086 Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-369" x="46.02 53.371201 59.948402 66.876602 138.16022 143.57642 149.84761 156.91982 163.64102 168.80522 172.58342 179.54762 182.43123 184.82793 190.52943 195.20764 198.74284 202.57504 208.26125 212.93945 216.47466 218.92986 224.38205 230.06825 232.95186 235.40706 240.08527 242.90947 248.59567 254.04787 257.58307 260.40726 264.23947 269.64218 274.32037 279.77258 285.36877 291.05496 293.45078 298.12717 303.52988 309.10986 311.93405 314.38925 320.07544 322.89963 328.21683 330.67203 334.50424 338.03943 343.72562 349.12381 351.52051 355.5993 361.362 367.0752 372.78839 378.50159 381.38516 390.13135 395.58356 401.17975 406.53296">#UD PCONFIG instruction is not recognized in virtual-8086 mode.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-343.32001" x="46.02 51.503975 57.097511 65.380249 70.993706 76.318321 80.308296 82.768417 88.408768 90.914703 93.440559 95.900681 99.921532 105.45531 107.97519 115.66032 121.25386 126.86732 132.46085 134.98073 140.53442 145.8172 150.25636 155.83595 161.29602 165.25711 167.76305 173.35658 179.08955">Compatibility Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-327" x="46.02 52.1679 57.568802 66.317703 71.673607 74.557205 79.913109 85.134911 89.815811 95.218513 100.81741 104.35532 106.81322 112.26812 117.95702 122.63792 125.52152 130.92242 135.60333 138.42754 140.88544 146.57434 149.39854 154.99745 158.83235 164.28725 167.82515 173.18105 177.86194 181.39984 186.75574 192.35464 195.17885 203.92775 209.38264 214.98155 220.33745">Same exceptions as in protected mode.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-301.32001" x="46.02 52.164326 58.308651 61.405216 67.718857 70.227783 74.220749 76.68087 84.368996 89.965523 95.58197 101.1785 103.63862 109.1953 114.47809 118.8575 124.49686 129.89717 133.91803 136.42696 142.02348 147.75945">64-Bit Mode Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-286.98001" x="46.02 53.371201 60.3354 65.7948 69.873604 75.586807 138.16562 141.94382 145.10101 147.92522 150.38042 156.06662 161.66283 167.34903 170.88423 173.70844 178.86993 184.27353 186.72873 192.41493 197.76813 200.59233 203.04753 208.73373 211.55794 217.23514 223.41904 229.57324 232.45685 237.81004 243.49625 248.17445 253.62665 259.22284 264.57605 269.25424 272.13782 277.53601 283.2222 286.04639 291.73257 297.41876 302.09695 307.78314 313.37933 318.97552 324.42773 328.25995 331.79514 337.14835 342.78775 345.61194 348.06714 353.42035 358.81854 361.46274">#GP(0)If input value in EAX encodes an unsupported leaf.</tspan><tspan y="-273.00031" x="138.11971 141.8961 145.0515 147.87569 151.65208 157.83598 163.54738 169.25877 175.02147 180.55287 188.12727 193.80267 199.51407 205.65747 211.92686 217.45827 221.23466 227.11797 232.76187 238.29327 243.96867 246.85226 254.42667 260.57007 266.81247 269.69604 272.14944 276.82584 279.65002 285.33441 290.78482 294.31821 297.1424 299.59579 305.0462 309.7226 314.9444 320.29581 325.93521">If IA32_TME_ACTIVATE MSR is not locked.</tspan><tspan y="-258.9603" x="138.11971 141.9006 145.0605 147.8847 153.57361 158.9745 162.8094 168.40831 175.66501 181.0686 184.9035 190.3062 193.1304 198.4863 204.1752 208.85611 212.69101 218.01091 223.60982 227.14772 229.60562 235.06052 240.74942 243.57362 248.97452 254.66342 260.26233 263.14594 270.72482 276.95374 282.48962 290.06851 295.74841 298.63202 303.31293 308.71384 314.31274 319.71365 325.31256 327.77045 330.22833 332.68622 336.11969 341.4342 344.31781 349.71332 353.54282 358.89331 361.77692 367.46042 372.90991 376.44241 379.32602 384.67651 390.36002 395.75552 401.34903 403.80154 409.15204 414.79144 417.61566 420.06818 425.75168 428.5759 432.35141 438.4939 444.20441 449.91492 455.62543 461.20361 468.7771 474.4516 480.16211 486.3046 492.57309 498.10358 501.87909 507.76239 513.40631 518.92426 524.59875 527.42297 535.04504 541.16864 547.41016">If hardware encryption and MKTME capability are not enabled in IA32_TME_ACTIVATE MSR.</tspan><tspan y="-244.98059" x="138.11969 141.89699 145.05328 147.87747 153.27477 156.15836 164.90366 170.30635 179.05165 184.50294 188.33424 193.65054 196.47473 201.92603 207.56543 212.91772 216.57982 221.97711 227.66241 233.25772 236.14131 238.59561 243.27292 246.09711 251.78241 257.2337 260.76801 263.59222 269.35495 275.06726 280.77957 286.94186 289.76608 295.16339 297.61771 300.07202 305.66733 311.35263 316.70493 322.34433">If a memory operand is not 256B aligned.</tspan><tspan y="-231.00089" x="138.11969 141.90329 145.06589 147.89009 153.29369 158.93579 164.25839 167.142 172.59959 175.76219 178.6458 182.1864 187.87801 193.2366 196.06081 199.89841 205.257 209.9406 215.29919 219.1368 224.3586 229.71719 235.31879 238.14299 243.7446 246.1413 249.6819 254.36549 257.24908 259.70969 265.35178 268.1994 275.7702 281.991 287.5188 295.1409 300.81271 306.52051 312.7413 318.41312 323.93192 329.63971 335.09912 341.33612 348.40292 355.36172 361.60052 367.74033 375.36243 381.06482 387.20462 392.78284 399.02164 405.59344 411.85925 417.38705 420.27066 425.66345 429.49026 434.83807 437.66229 442.33508 447.73779 451.26758">If any of the reserved bits in MKTME_KEY_PROGRAM_STRUCT are set.</tspan><tspan y="-216.96089" x="138.11969 141.90509 145.06949 147.89369 153.29909 156.18269 164.8857 170.28839 178.99139 184.45169 188.29109 193.61549 196.4397 201.89909 207.50249 212.86288 216.52498 221.93037 227.62378 233.22717 236.11078 238.57318 243.25858 246.08278 251.77618 257.2356 262.92899 267.01138 271.69678 277.10217 282.79556 288.25497 293.89706 296.35318 301.03857 306.44397 308.90637 311.73056 314.89496 320.35437 324.19376 332.94714">If a memory operand is non-canonical form.</tspan><tspan y="-202.98119" x="46.019989 53.37569 58.796391 63.965092 68.044792 71.20649 76.609192 82.251289 84.70739 88.067093 92.145889 96.82859 102.28529 107.88599 113.2887 117.36839 138.13229 141.91499 145.07669 147.90089 153.30359 156.18719 161.7879 167.1906 172.79129 178.19398 181.01819 184.17989 189.58258 195.27328 197.66998 201.20969 204.09329 209.54999 214.23268 218.91537 224.60608 228.44278 233.12547 235.94968 238.40938 244.10008 246.92429 252.32698 257.00967 261.69238 267.09509 271.7778 276.46051 278.85721 284.54791 290.14862 292.97284 301.72354 307.08124 315.83194 321.28864 325.12534 330.44702 333.33063 338.78732 344.38803 349.74573 353.46814 358.87085 364.51294 370.11365 374.79636">#PF(fault-code) If a page fault occurs in accessing memory operands.</tspan><tspan y="-189.00148" x="46.019989 53.336987 59.937588 138.12239 141.90329 145.06859 147.89279 153.29909 158.94119 164.2233 167.1069 172.5672 175.6911 178.57471 182.11801 187.81232 193.17361 195.99782 200.92082 208.00023 214.27953 220.51382 224.59712 230.84943 236.48613 241.94553 246.02882 253.10913 259.23273 262.98029 269.16238 274.7991 278.8779 285.0618 290.76691 296.88602 299.76959 305.34961 309.19171 314.53412 317.71832 320.17441 325.33591 330.71701 335.397 338.22119 343.64728 347.50739 352.88849 355.71268 361.42679 366.10678 371.44919 377.02921">#UDIf any of the LOCK/REP/OSIZE/VEX prefixes are used.</tspan><tspan y="-174.96149" x="138.12059 141.90149 145.06139 147.88559 151.42349 157.1124 162.46829 165.3519 170.03281 175.72171 179.55661 183.39151 188.74741 194.43631 197.97421 200.79842 206.39732 210.23222 212.69012 218.01003 220.46793 222.86462 228.26732 233.84732 239.20322 242.08682 244.48352 249.88622 255.10802 260.45044 262.90833 265.73254 268.19043 272.87134 275.75494 281.44385 286.84476 290.44476 293.26898 298.98489">If the current privilege level is not 0.</tspan><tspan y="-160.98178" x="138.12059 141.89609 145.05058 147.87477 154.14326 159.55676 166.13126 169.90675 176.63156 179.87335 185.58385 188.88594 194.59644 198.66893 204.34343 211.26894 217.42044 220.72253 226.13603 232.40453 239.47403 246.19254 251.35403 255.12953 262.09103 266.16354 271.75705 274.20956 277.74207 280.56628 286.32898 292.0314 296.10391 298.98752 306.33603 309.16025 314.92294">If CPUID.7.0:EDX.PCONFIG[bit 18] = 0.</tspan><tspan y="-147.00208" x="138.12059 141.91859 145.0956 147.9198 150.39481 156.1008 158.925 165.09 172.65179 178.82579 181.64999 187.35599 192.82799 198.53398 202.62898 206.48099 211.88188 217.35388 220.90887 223.79248 232.55849 238.03049 243.61049 248.9529 251.8365 257.25452 262.89661 268.5126 271.33679 277.5018 285.0636 291.35458 297.35849 300.64349 306.04349 312.33447 319.42648 326.16748 331.35147 335.14948 342.10559 347.80798 353.50497 360.24597 366.41098 372.53461 377.55661 383.1933 386.07687 393.39389 396.27747 401.97986">If in VMX non-root mode and VMCS.PCONFIG_ENABLE = 0.</tspan></text></g></svg>     <hr />     <p class="not_instruction_page">         This <b>UNOFFICIAL</b> reference was generated from the official <a href="https://www.intel.com/content/www/us/en/developer/articles/technical/intel-sdm.html">IntelÂ® 64 and IA-32 Architectures Software Developerâ€™s Manual</a> by a dumb script.         There is no guarantee that some parts aren't mangled or broken and is distributed <b>WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE</b>.     </p> </body>  </html>
