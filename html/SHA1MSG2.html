<!DOCTYPE html> <html lang="en">  <head>     <meta charset="utf-8">     <title>SHA1MSG2</title>     <link rel="stylesheet" href="styles.css">     <link rel="stylesheet" href="../intel.css"> </head>  <body>     <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" width="511.92001pt" height="549.18451pt" viewBox="0 0 511.92001 549.18451" sodipodi:docname="1339.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" showgrid="false" inkscape:zoom="0.22348485" inkscape:cx="346.96" inkscape:cy="296.01162" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg174" /><g transform="translate(-45.78,-68.824219)" class="c9D877B2B"><text xml:space="preserve" transform="translate(0,792)" font-size="12" class="cA49CCA52 cD0BE81C2 c209E837B"><tspan y="-714" x="46.02 52.700401 60.976803 68.6772 76.053604 85.290009 91.970413 99.35881 106.73521 116.49962 123.70082 130.41722 134.78162 139.22043 145.93922 150.30362 160.26003 163.26003 169.65242 172.65242 179.32082 182.31721 189.20161 195.59401 198.61441 201.61441 208.19881 214.5912 217.6116 223.08 229.9644 232.9848 239.3772 244.16159 247.15799 253.87439 260.75879 263.75879 268.19757 274.91638 279.28079 282.28079 287.06519 293.94958 300.66599 303.66599 311.94238 318.42117 324.78357 329.58478 332.58478 338.76358 345.48239 352.36679 356.7312 359.7312 366.41159 374.68799 382.3884 389.7648 392.7648 402.00119 408.71759 414.43799 420.15839 426.55078 433.29117 440.00757 443.00757 450.77997 460.37997 467.09637 471.2388 477.97919">SHA1MSG2—Perform a Final Calculation for the Next Four SHA1 Message Dwords</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9.96" class="cC28FA1AE cD0BE81C2 c209E837B"><tspan y="-607.32001" x="235.67999 238.36819 244.06631 248.74551 252.76637 256.3689 262.12677 266.69742 270.65851 273.1774 278.78387 284.52979 287.04968 293.6492 299.28955 304.89603 308.3183 313.65585 319.40176 324.98135 327.50125 333.0679 338.76599 343.20517 348.78476 354.41116 356.93005 362.62814">Instruction Operand Encoding</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2 c209E837B"><tspan y="-552" x="46.02 51.838501 56.865002 61.144501 65.235001 68.497498 70.734001 75.654305 79.255203 81.491707 86.518204">Description</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-536.99969" x="46.02 51.556801 57.246601 62.603401 65.187302 71.336105 78.087906 84.23671 89.999405 97.579208 103.72801 110.69582 116.45851 119.04241 121.43911 127.14061 131.8224 135.36121 139.19701 144.88681 149.5686 153.10741 155.56621 161.022 166.71181 169.2354 171.6942 176.37599 178.95988 184.41568 190.10548 195.46228 198.04617 203.50197 206.66277 209.24666 212.78546 220.14026 225.59605 228.17995 234.32875 241.08055 247.22935 252.94615 255.53006 264.27985 269.63666 274.31845 279.00024 284.40204 290.00183 295.40454 297.98843 302.67023 307.35202 312.99411 318.39682 323.97681 329.6666 332.1254 334.52209 340.22357 345.82336 348.34695 350.80576 356.49554 361.17734 364.71613 368.55191 374.2417 378.92349 382.46228 384.92108 390.32199 396.01178 400.69357 403.96237 406.54626 412.08307 417.77286 423.12967 425.71356 428.17236 433.81445 438.49625 442.09622 445.87802 451.5795 456.26129 459.80008 462.25888 467.71469 473.40448 475.98837 481.58817 486.94498 490.78076 493.94156 499.39737 503.23315 511.98294 516.66473 519.18835 522.72717 528.41699 533.8197 536.34332 539.50415 541.96295 547.65277 553.05457 555.45038">The SHA1MSG2 instruction is one of two SHA1 message scheduling instructions. The instruction performs the final </tspan><tspan y="-525.95941" x="46.02 50.695499 56.091 58.543499 63.218998 68.902496 71.354996 76.750496 80.282997 82.735497 88.184998 93.8685 96.692703 100.2252 105.67471 108.55831 114.15181 119.50231 123.33181 125.78431 131.00612 136.40881 139.233 142.7655 148.44901 153.7995 156.68309 162.36659 167.76929 173.08379 176.61629 179.49988 182.65437 188.10387 193.78737 197.61687 200.50046 206.64296 213.38846 219.53096 225.24146 228.12505 236.86855 242.21904 246.89455 251.57005 256.96555 262.55905 267.96173 270.78595 276.37946 283.72797 289.17746 293.00696 298.60046 303.27597">calculation to derive the next four SHA1 message dwords.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2 c209E837B"><tspan y="-502.97971" x="46.02 51.978001 57.018002 62.040001 65.162102 69.941101 73.514099 75.7938 80.832901">Operation</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-487.9794" x="46.02 51.006901 57.247501 62.999401 68.508301 75.412201 80.451302 85.9692 91.478104">SHA1MSG2 </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-463.9791" x="46.02 53.2803 58.5462 63.812099 66.031502 67.787399 72.909302 75.1287 79.9086 85.336502 90.062401 95.282402 98.046303 103.3122 108.5781 110.334 115.554 120.8343 123.5982 125.8176 127.6905">W13 := SRC2[95:64] ; </tspan><tspan y="-451.9794" x="46.02 53.2803 58.5462 63.812099 66.031502 67.787399 72.909302 75.1287 79.9086 85.336502 90.062401 95.282402 98.046303 103.3122 108.5781 110.334 112.5534 117.7734 123.0537 125.8176 128.037 129.9099">W14 := SRC2[63: 32] ; </tspan><tspan y="-439.97971" x="46.02 53.2803 58.553398 63.8265 66.045898 67.808998 72.938095 75.157494 79.944595 85.379692 90.112793 95.332794 98.103897 103.377 108.6501 110.4132 112.6326 117.8526 120.6111 122.8305 124.71059">W15 := SRC2[31: 0] ; </tspan><tspan y="-427.98001" x="46.02 53.2803 58.549801 63.819302 66.038696 67.798195 72.923698 75.143097 77.739594 82.523094 87.954597 92.684097 97.904099 100.6626 105.9321 111.2016 116.4216 118.1811 123.4011 128.67059 131.4381 133.65749 139.32298 145.02089 150.45239 152.67178 159.93208 165.20158 170.47108 172.69048 175.28697 177.50636 182.93787 188.67537 193.14388 195.36327 200.58327 202.50296">W16 := (SRC1[127:96] XOR W13 ) ROL 1; </tspan><tspan y="-415.98032" x="46.02 53.280304 58.544403 63.808502 66.027901 67.781998 72.9021 75.121498 77.712601 82.4907 87.916801 92.6409 97.860901 100.6194 105.8835 111.1476 112.9017 118.16579 123.3858 126.1479 128.36729 134.02739 139.75949 145.18559 147.405 154.7121 159.9321 165.1962 167.78729 170.0067 175.4328 181.1649 185.62801 187.84741 193.11151 194.9826">W17 := (SRC1[95:64] XOR W14) ROL 1; </tspan><tspan y="-403.98062" x="46.02 53.280304 58.544403 63.808502 66.027901 67.781998 72.9021 75.121498 77.712601 82.4907 87.916801 92.6409 97.860901 100.6194 105.8835 111.1476 112.9017 115.12109 120.38519 125.60519 128.36729 130.5867 136.2468 141.9789 147.405 149.6244 156.9315 162.1515 167.4156 170.0067 172.2261 177.65221 183.38431 187.84741 190.06682 195.33092 197.20201">W18 := (SRC1[63: 32] XOR W15) ROL 1; </tspan><tspan y="-391.98093" x="46.02 53.2803 58.553398 63.8265 66.045898 67.808998 72.938095 75.157494 77.757591 82.544693 87.97979 92.712891 97.932892 100.69139 105.96449 111.23759 113.00069 115.22009 120.49319 123.1923 125.4117 131.0808 136.7787 142.21381 144.4332 151.7493 157.0224 162.2424 164.82179 167.04118 172.47629 178.17419 182.6463 184.86569 190.08569 191.94598">W19 := (SRC1[31: 0] XOR W16) ROL 1; </tspan><tspan y="-367.98062" x="46.02 51.556801 56.2836 61.0257 66.184502 68.949303 74.216103 79.482903 84.702904 86.459702 91.726501 96.993301 99.758102 101.9775 103.7343 108.8571 111.0765 118.3863 123.6063 128.87311 130.7469">DEST[127:96] := W16; </tspan><tspan y="-355.98093" x="46.02 51.5289 56.2701 61.022999 66.180901 68.917801 74.198097 79.478394 81.219894 86.458794 91.73909 94.47599 96.695389 98.424286 103.58578 105.80518 113.08708 118.36738 123.60628 125.52598">DEST[95:64] := W17; </tspan><tspan y="-343.98123" x="46.02 51.5289 56.2701 61.022999 66.180901 68.917801 74.198097 79.478394 81.219894 86.458794 91.73909 94.47599 96.695389 98.424286 103.58578 105.80518 113.08708 118.36738 123.60628 125.52598">DEST[63:32] := W18; </tspan><tspan y="-331.98154" x="46.02 51.559502 56.289001 61.031101 66.189903 68.957405 74.226906 79.496407 81.255905 86.475906 89.234406 91.453804 93.213303 98.338806 100.5582 107.8707 113.09071 118.36021 120.23671">DEST[31:0] := W19; </tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2 c209E837B"><tspan y="-309.00183" x="46.02 48.404102 53.382 56.954102 61.975201 64.224304 66.444603 71.366699 74.8479 79.770004 85.205101 90.640198 92.919899 97.841995 102.8631 110.3142 115.3533 117.633 119.9136 124.93471 128.2368 130.45709 132.84119 137.87938 141.45148 144.70857 146.98827 152.14616 156.42026 158.69995 162.78505 165.00534 170.04355 175.08354 180.23064 182.46173 187.20203 191.99994 194.24904 199.27014 204.30833">Intel C/C++ Compiler Intrinsic Equivalent</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-290.64185" x="46.02 50.801701 56.6544 62.264099 67.531799 74.072105 78.874504 84.095406 89.37571 91.133408 93.352806 97.909508 102.46621 109.41691 114.63691 119.91721 125.13721 127.11902 129.33841 133.89511 140.79541 147.74611 152.30281 156.3195 161.1012 165.57689 170.79689 177.74759 181.76428 186.38399 191.66429 196.22099 200.9397 205.6044 210.38611 215.65381 220.92151 223.5162 228.07291 232.57381 239.52451 244.79221 250.01221 255.29251 257.2482 259.07791 261.29733 265.85403 270.35495 277.30566 282.57336 287.79337 293.07367 295.02936 297.62405">SHA1MSG2: __m128i _mm_sha1msg2_epu32(__m128i, __m128i);</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2 c209E837B"><tspan y="-268.68185" x="46.02 51.012302 53.2686 58.053902 63.100201 67.3815 69.661194 75.12059 78.599091 81.957886 86.996986 91.089287 94.668587 99.696884">Flags Affected</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-253.68155" x="46.02 52.750202 58.211403 63.906605">None</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2 c209E837B"><tspan y="-230.70184" x="46.02 51.036602 53.443203 60.376804 66.212402 68.432701 73.4403 75.711899 80.755501 85.556099 89.150696 91.404297 96.573898 101.6355 104.4201 109.7616 114.8052 117.0588 122.0367 125.6376 127.85789 132.86549 137.5473 141.56671 146.6058 151.46581 155.06671 157.32031 162.3 167.4696">SIMD Floating-Point Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-212.70184" x="46.02 52.750202 58.211403 63.906605">None</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2 c209E837B"><tspan y="-190.80214" x="46.02 51.978901 55.552803 60.701702 65.724602 68.983505 71.263206 76.250107 80.992203 84.951302 89.990395 94.910698 98.511597 100.7445 105.7674 110.9163">Other Exceptions</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cECB6486A"><tspan y="-175.80183" x="46.02 52.161598 57.564301 62.913902 65.738106 70.236305 75.639908 81.232506 83.684105 92.207108 97.909508 101.98111 107.74381 113.45341 116.71501 119.59862 123.71522 128.33311 133.64671 139.23932 144.64201 147.4662 153.1758 156.05939 162.32698 164.77858 170.17319 174.84779 179.5224 182.40599 188.07959 193.30139 197.976 203.37869 208.9713 212.5029 214.9545 220.40309 226.08569 228.90988 235.17747 240.62607 246.30867 251.94807 254.34477 257.88446 260.33606 265.78467 271.46725 276.14185 280.25845">See Table2-21, “Type 4 Class Exception Conditions”.</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cD0BE81C2"><tspan y="-700.98151" x="52.020302 57.977402 63.016502 67.035904 72.075005 77.114105 82.135208">Opcode/</tspan><tspan y="-690.00153" x="52.020302 54.4179 59.578499 63.777901 67.378799 70.649399 75.809998 79.9086 83.494202 85.7388 90.773399">Instruction</tspan><tspan y="-700.98151" x="174.7803 180.73651 185.77472 189.25592 194.23473 212.29233 217.80753 223.32272 226.74092 232.25612 237.77132">Op/En64/32 </tspan><tspan y="-690.00153" x="212.28061 217.3287 219.5688 223.1499 225.0696 231.9897 237.01981 242.0679 247.09801">bit Mode </tspan><tspan y="-679.02155" x="212.28061 217.26031 222.39302 227.41772 232.51804 237.52473 240.82684">Support</tspan><tspan y="-700.98157" x="261.00031 265.92511 271.44659 277.46039 279.8472 285.66299">CPUID </tspan><tspan y="-690.00159" x="261.00031 265.6785 270.71759 275.45609 279.05698 284.21487 287.33698 292.37607">Feature </tspan><tspan y="-679.02161" x="261.00031 266.02231 268.24261 273.05762">Flag</tspan><tspan y="-700.98163" x="305.2803 311.09882 316.12531 320.40482 324.49533 327.75784 329.99435 334.91464 338.51556 340.75208 345.77856">Description</tspan></text><text xml:space="preserve" transform="translate(0,792)" font-size="9" class="c9256B18F cAF7646FE"><tspan y="-666.00134" x="52.020309 57.862209 62.975109 65.194511 70.451416 75.16832 77.387718 82.644623 87.90152 90.120918 94.837822 100.43672 102.65612 105.78002 109.03893">NP 0F 38 CA /r </tspan><tspan y="-655.02136" x="52.020309 56.76601 62.64661 68.220306 73.500603 80.046303 84.848701 90.089401 95.369698 97.589096 102.38699 109.2873 116.2479 121.5282 123.3219">SHA1MSG2 xmm1, </tspan><tspan y="-643.98108" x="52.020309 56.757912 63.729313 70.700714 75.920715 79.076118 85.976418 91.264816 96.484818">xmm2/m128</tspan><tspan y="-666.0014" x="174.7803 180.18031 212.28061 217.92181 221.04033 261.00122 265.80362 271.62482 305.28482 310.26633 314.94724 318.22684 321.40564 326.08655 329.38864 336.28894 340.31107 342.53046 345.91806 350.70966 355.39056 357.60995 360.96155 362.88306 367.67465 372.11435 374.05295 376.27234 380.19095 384.67654 386.61514 390.53375 395.27585 397.19736 401.51645 404.87616 406.84177 411.52267 416.31427 418.53366 421.71246 426.39337 429.67297 431.89236 435.27997 440.02206 444.75067 446.97006 451.71216 456.27246 461.01007 464.36978 466.58917 469.76797 474.50919 479.30078 482.54257 484.76196 489.50406 495.38467 500.96466 506.24493 508.46432 515.36462 520.10492 524.13153 528.15814 532.59784 537.27246 541.95331">RMV/VSHAPerforms the final calculation for the next four SHA1 message </tspan><tspan y="-655.02142" x="305.2803 309.9126 316.75259 321.4938 324.4953 329.17441 333.19653 335.41592 340.16522 344.18735 346.16916 350.91125 355.59036 357.80975 359.73306 364.35547 367.77548 372.45639 375.6937 382.6543 387.39459 392.01428 393.99609 398.2558 401.6011 406.3414 408.56079 411.62259 416.36288 420.3472 425.1496 427.0459 430.3912 434.41333 436.63272 439.99152 443.05331 447.79453 454.69482 456.91422 461.71213 468.67273 475.59103 480.87134 483.09073 487.53403 492.33643 496.96872 499.18811 502.60812 507.35022 512.09052 514.30994 518.94226 522.06439 526.62469 531.24353 533.22528 537.90619 542.70862 546.73071">dwords using intermediate results from xmm1 and the previous </tspan><tspan y="-643.98114" x="305.2803 312.1806 316.9209 320.94299 324.96509 329.40479 334.07489 338.75577 340.97519 345.64529 352.42587 357.15897 360.22076 364.84045 368.86255 371.08197 374.42908 377.49088 382.22397 389.12427 391.34369 396.1398 403.09589 409.99619 415.27649 418.4166 425.37268 430.59268 435.86578 441.13889 442.974 445.19342 449.09491 452.3349 457.06799 460.34308 462.26456 467.06696 471.68665 473.90607 477.28915 482.07626 486.75714 488.97656 492.09863 496.77951 500.80161 505.58871 507.52283 510.90591 513.12531 515.04681 519.84924 522.0686 526.86469 533.76501 540.72113 545.9411">message dwords from xmm2/m128, storing the result in xmm1.</tspan><tspan y="-592.98083" x="69.180603 74.878502 79.557602 82.676109 87.35701 166.49942 172.19733 176.87643 181.61674 184.67854 189.11826 193.92067 198.54037 200.75978 311.76038 317.51859 322.13828 326.87857 329.94037 334.38007 339.18246 343.80215 346.02155 461.64185 467.33975 472.01883 476.75912 479.82092 484.26062 489.06302 493.68271 495.9021">Op/EnOperand 1Operand 2Operand 3</tspan><tspan y="-577.02112" x="74.6409 80.100304 154.50061 161.04811 165.78931 170.4198 175.87921 182.42671 184.2285 187.2903 191.97119 196.65028 198.86967 201.43018 204.49197 206.28748 208.50687 215.46747 304.68628 311.28687 316.02808 320.65857 326.05408 332.65466 334.39618 337.69827 340.81677 347.73328 349.95267 352.51315 355.81525 475.69434 481.51553">RMModRM:reg (r, w)ModRM:r/m (r)NA</tspan></text><path transform="matrix(1,0,0,-1,0,792)" d="m 45.78,640.26 h 0.47998 v 69.48 H 45.78 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 168.54,639.72 h 0.47999 v 70.5 H 168.54 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 206.04,639.72 h 0.48 v 70.5 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 254.76,639.72 h 0.47999 v 70.5 H 254.76 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 299.04,639.72 h 0.48 v 70.5 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 557.16,640.26 h 0.47998 v 69.48 H 557.16 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.78,709.74 h 511.86 v 0.48 H 45.78 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.78,674.76 h 511.86 v 0.48 H 45.78 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 45.78,639.78 h 511.86 v 0.48 H 45.78 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 46.26,572.22 h 0.48001 v 31.5 H 46.26 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 114.6,571.74 h 0.48 v 32.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 257.46,571.74 h 0.48 v 32.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 405.12,571.74 h 0.48 v 32.52 h -0.48 z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="m 557.22,572.22 h 0.47998 v 31.5 H 557.22 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 46.26,603.78 H 557.7 v 0.48 H 46.26 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 46.26,587.76 H 557.7 v 0.48 H 46.26 Z" inkscape:connector-curvature="0" /><path transform="matrix(1,0,0,-1,0,792)" d="M 46.26,571.74 H 557.7 v 0.48 H 46.26 Z" inkscape:connector-curvature="0" /></g></svg>     <hr />     <p class="not_instruction_page">         This <b>UNOFFICIAL</b> reference was generated from the official <a href="https://www.intel.com/content/www/us/en/developer/articles/technical/intel-sdm.html">Intel® 64 and IA-32 Architectures Software Developer’s Manual</a> by a dumb script.         There is no guarantee that some parts aren't mangled or broken and is distributed <b>WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE</b>.     </p> </body>  </html>
